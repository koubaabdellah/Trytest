function is_function(e){return!!(e&&e.constructor&&e.call&&e.apply)}function is_array(e){return"[object Array]"===Object.prototype.toString.call(e)}function is_number(e){return!isNaN(parseFloat(e))&&isFinite(e)}function is_dom_node(e){return"object"==typeof Node?e instanceof Node:e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName}function is_dom_element(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}function qsa(e,t){if(t=t||document,e.match(/:/)){var n=new RegExp(/^(\w+):(\w+)\((.*)\)$/,"g"),o=n.exec(e),r=o[3].split(/,\s/);return console.log(t,r),meta_selector.call(t,o[2],o[1],r[0],r[1])}return t.querySelectorAll(e)}function qs(e,t){return(t||document).querySelector(e)}function get_siblings(e,t){var n=[];e=e.parentNode.firstChild;do t&&!t(e)||n.push(e);while(e=e.nextSibling);return n}function get_next_siblings(e,t){for(var n=[];e=e.nextSibling;)t&&!t(e)||n.push(e);return n}function get_prev_siblings(e,t){for(var n=[];e=e.previousSibling;)t&&!t(e)||n.push(e);return n}function wrap(e,t){return e.parentNode.insertBefore(t,e),t.appendChild(e),t}function _extend_options(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var on_devel="true"===localStorage.getItem("on_devel");on_devel&&console.log("%c devel mode is enabled ","background:#21a7e0; color:#fff; font-weight:bold;");var meta_selector=function(e,t,n,o){var r={regex:function(e,t,n){n=new RegExp(n);var o=this.querySelectorAll(e),r=o.length,i=0,a=[];for(i=r;i--;){var s=o[i].getAttribute(t);s&&n.test(s)&&a.push(o[i])}return a}};return r[e].call(this,t,n,o)},has_class,add_class,remove_class;"classList"in document.documentElement?(has_class=function(e,t){return e.classList.contains(t)},add_class=function(e,t){e.classList.add(t)},remove_class=function(e,t){e.classList.remove(t)},toggle_class=function(e,t){return e.classList.toggle(t)},replace_class=function(e,t,n){return e.classList.replace(t,n)}):(has_class=function(e,t){return new RegExp("\\b"+t+"\\b").test(e.className)},add_class=function(e,t){has_class(e,t)||(e.className+=" "+t)},remove_class=function(e,t){e.className=e.className.replace(new RegExp("\\b"+t+"\\b","g"),"")},toggle_class=function(e,t){has_class(e,t)?remove_class(e,t):add_class(e,t)},replace_class=function(e,t,n){e.className=e.className.replace(new RegExp("\\b"+t+"\\b","g"),n)});var addEvent=function(e,t,n,o,r){r||(r=!1);var i=function(){return function(e){if(!e)var e=window.event;var t=e.target||e.srcElement;do if(n(t))return e.delegateTarget=t,o.apply(this,arguments),!1;while(t=t.parentNode)}},a={addEventListener:function(){return!!window.addEventListener}(),attachEvent:function(){return!!window.attachEvent}()};a.addEventListener?document.addEventListener(e,i.call(t),r):a.attachEvent?(t===window&&window.attachEvent("on"+e,i.call(t)),document.attachEvent("on"+e,i.call(t))):console.error("Hey! Your browser doesn't support any type of event                       listener. Are you using a browser?")},isBrowser={ie8:function(){return!!(document.documentElement.className&&document.documentElement.className.indexOf("ie8")>-1)},lte9:function(){return!!(document.documentElement.className&&document.documentElement.className.indexOf("lte9")>-1)},gt9:function(){return!!(document.documentElement.className&&document.documentElement.className.indexOf("gt9")>-1)}},Utils={extrema:{max:function(e){return this.calculate(e,Math.max)},min:function(e){return this.calculate(e,Math.min)},calculate:function(e,t){if(0===e.length)return NaN;var n=e.pop();return 1===e.length?"number"==typeof n?n:NaN:t(n,this.calculate(e,t))}},range:function(e,t){for(var n=[],o=t;o>=e;o--)n[o]=o;return n},dict:{length:function(e){var t=0;for(var n in e)e.hasOwnProperty(n)&&t++;return t},empty:function(e){return"undefined"!=typeof e.length?{}:{}}},absoluteOffset:function(e){var t=0,n=0;do t+=e.offsetTop||0,n+=e.offsetLeft||0,e=e.offsetParent;while(e);return{top:t,left:n}},makeId:function(e){var t,n="",o="ABCDEFGHIJKLMNÑOPQRSTUVWXYZabcdefghijklmnñopqrstuvwxyz0123456789",e=e||6;for(t=e;t--;)n+=o.charAt(Math.floor(Math.random()*o.length));return n},classes:{add:function(e,t){var n="string"==typeof t&&t.constructor===String,o="object"==typeof t&&t.constructor===Array,r=function(n){isBrowser.lte9()?e.className.indexOf(t)===-1&&(e.className+=" "+t):e.classList.contains(n)||e.classList.add(n)};if(n)return r(t);if(o&&(len=t.length)){var i;for(i=len;i--;)r(t[i])}},remove:function(e,t){var n="string"==typeof t&&t.constructor===String,o="object"==typeof t&&t.constructor===Array,r=function(n){isBrowser.lte9()?e.className.indexOf(t)>-1&&$(e).removeClass(t):e.classList.contains(n)&&e.classList.remove(n)};if(n)return r(t);if(o&&(len=t.length)){var i;for(i=len;i--;)r(t[i])}},contains:function(e,t){var n="string"==typeof t&&t.constructor===String,o=function(n){return isBrowser.lte9()?e.className.indexOf(t)>-1||!1:e.classList.contains(n)};return n?o(t):void console.warn("The class to use is not a string")}},events:{preventDefault:function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1}},isArray:function(e){return"object"==typeof e&&e.constructor===Array},isString:function(e){return"string"==typeof e&&e.constructor===String}},Request=function(){var e={async:!0,fdata:[],form:null,method:"GET",url:""},t={},n=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},o=[function(){return new ActiveXObject("MSXML2.XMLHTTP.6.0")},function(){return new ActiveXObject("MSXML2.XMLHTTP.3.0")},function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new XMLHttpRequest}],r=function(){var e;if(len=o.length){var t=0;for(t=len;t--;){try{e=o[t]()}catch(e){continue}break}return e}},i={"application/json":function(e){return"undefined"!==e.response?JSON.parse(e.response):void console.warn(e.response)},"text/html":function(e){return"undefined"!==e.response?e.responseText:void console.warn(e.responseText)}},a=function(){if(!(this instanceof Request))return new Request(arguments[0]);t=arguments[0]&&"object"==typeof arguments[0]?n(e,arguments[0]):e;var o=r();if("POST"===t.method||"post"===t.method){var a=window.FormData?new FormData:"";if((fdata=t.fdata)&&!t.form)if("object"==typeof fdata&&a)for(var s in fdata)a.append(fdata[s].name,fdata[s].value);else{var l=[];for(var s in fdata)l.push(encodeURIComponent(fdata[s].name)+"="+encodeURIComponent(fdata[s].value));a=l.join("&").replace(/%20/g,"+")}else console.warn("There is no data to post")}o.open(t.method,t.url,t.async),o.onreadystatechange=function(e){if(0===o.readyState,1===o.readyState,2===o.readyState,3===o.readyState,4===o.readyState){if(200===o.status)return contentType=o.getResponseHeader("Content-Type"),supportedResponse=i[contentType.split(";")[0]]||!1,supportedResponse?t.callback&&"function"==typeof t.callback?t.callback(supportedResponse(o)):(console.warn("Missing callback()"),!1):(console.warn("Response with contentType <%s> is not yet                                     supported",contentType.split(";")[0]),!1);if(404===o.status)return t.failback&&"function"==typeof t.failback?t.failback(supportedResponse(o.response)):(console.warn("Missing failback()"),!1)}},o.send(a)};return a}(),ButtonGroup=function(){var e={attrs:{class:"btn-group"},buttons:[]},t={},n=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},o=function(){var e=document.createElement("div");for(var n in t.attrs)n in e?e[n]=t.attrs[n]:e.setAttribute(n,t.attrs[n]);if(len=t.buttons.length){var o=0;for(t.buttons.reverse(),o=len;o--;)e.appendChild(t.buttons[o]);return e}return console.warn("There is no buttons to add to the ButtonGroup model"),!1},r=function(){return this instanceof ButtonGroup?arguments[0]&&"object"==typeof arguments[0]&&(t=n(e,arguments[0]),t.buttons&&t.buttons.constructor===Array&&!t.buttons.length)?(console.log("ButtonGroup.buttons is empty. There is no                                  buttons to add to the ButtonGroup model"),!1):(this.html=o.call(this),this.html):new ButtonGroup(arguments[0])};return r}(),Anchor=function(){var e={},t={},n=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},o=function(){var e=document.createElement("a");for(var n in t)n in e?e[n]=t[n]:e.setAttribute(n,t[n]);return e},r=function(){return this instanceof Anchor?(arguments[0]&&"object"==typeof arguments[0]&&(t=n(e,arguments[0])),o()):new Anchor(arguments[0])};return r}(),Button=function(){var e={},t={},n=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},o=function(){var e=document.createElement("button");for(var n in t)n in e?e[n]=t[n]:e.setAttribute(n,t[n]);return e},r=function(){return this instanceof Button?(arguments[0]&&"object"==typeof arguments[0]&&(t=n(e,arguments[0])),o()):new Button(arguments[0])};return r}(),Input=function(){var e={},t={},n=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},o=function(){var e=document.createElement("input");for(var n in t)n in e?e[n]=t[n]:e.setAttribute(n,t[n]);return e},r=function(){return this instanceof Input?(t=e,arguments[0]&&"object"==typeof arguments[0]&&(t=n(e,arguments[0])),o()):new Input(arguments[0])};return r}(),Icon=function(){var e={},t={},n=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},o=function(){var e=document.createElement("i");for(var n in t)n in e?e[n]=t[n]:e.setAttribute(n,t[n]);return e},r=function(){return this instanceof Icon?(arguments[0]&&"object"==typeof arguments[0]&&(t=n(e,arguments[0])),o()):new Icon(arguments[0])};return r}(),Select=function(e){var t={};_attrs=null;var n=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},o=function(e,t,n){var o=document.createElement("option");return o.value=e,o.innerText=t,o.selected=n,o},r=function(){var e=document.createElement("select");for(var t in _attrs)"options"===t&&_attrs[t].constructor===Array||(t in e?e[t]=_attrs[t]:e.setAttribute(t,_attrs[t]));var n=_attrs.options.length;if(!n)return e;for(var r=0;r<n;r++)if("undefined"!=typeof _attrs.options[r]){var i=r===_attrs.selectedIndex;e.appendChild(o(r,_attrs.options[r],i))}return e},i=function(){return this instanceof Select?(arguments[0]&&"object"==typeof arguments[0]?_attrs=n(t,arguments[0]):_attrs=t,r()):new Select(arguments[0])};return i}(),iFrame=function(){var e={frameBorder:0},t={},n=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},o=function(){var e=document.createElement("iframe");for(var n in t)n in e?e[n]=t[n]:e.setAttribute(n,t[n]);return e},r=function(){var e=this.iframe.contentWindow.document.body.clientHeight;e>this.iframe.height&&(e>window.innerHeight?this.iframe.height=window.innerHeight:this.iframe.height=e)},i=function(){r.call(this)},a=function(){if(!(this instanceof iFrame))return new iFrame(arguments[0]);t=e,arguments[0]&&"object"==typeof arguments[0]?t=n(e,arguments[0]):console.warn("There are no arguments to build create a Frame object"),this.iframe=o.call(this);var r=function(){var e=this;addEvent("load",this.iframe,function(e){return this.iframe===e},function(t){i.call(e,t)},!1)};return r.call(this),this.iframe};return a}(),ProgressBar=function(){var e={classes:{outer:"progress",inner:"progress-bar"},value:{max:100,min:0,now:0}},t={},n=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},o=function(){var e=document.createElement("span");return e.className="sr-only",e},r=function(){var e=document.createElement("div");return e.className="progress-bar",t.classes.inner&&(e.className+=" "+t.classes.inner),e.setAttribute("aria-valuenow",t.value.now),e.setAttribute("aria-valuemin",t.value.min),e.setAttribute("aria-valuemax",t.value.max),e.appendChild(o()),e},i=function(){var e=document.createElement("div");return e.className="progress",t.classes.outer&&(e.className+=" "+t.classes.outer),e.style.height="2px",e.appendChild(r()),e},a=function(){_node=i()},s=function(){return this instanceof ProgressBar?(arguments[0]&&"object"==typeof arguments[0]&&(t=n(e,arguments[0])),a(),_node):new ProgressBar(arguments[0])};return s}(),ModalDialog=function(){var e=null,n=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},o=function(e){if(e){var t=document.createElement("h4");return t.className="modal-title",t.textContent=e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;"),t}return console.warn("There is no string to _buildTitle()")," "},r=function(){var e=this,t=document.createElement("a");return t.className="close",t.href="",t.title="Close",t.innerText="×",t.textContent="×",addEvent("click",t,function(e){return t===e},function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,e.options.reload?(ajaxRequest(e.options.reload,function(){e.destroy({reload:!0})},function(){alert(s)}),!1):e.destroy()},!1),t},i=function(e){if(!e)return console.log("There is no content to render within a modal dialog"),!1;if("string"==typeof e){var t=document.createElement("p");return t.innerText=e,t}if("object"==typeof e){if(e.constructor===HTMLCollection){for(var n=document.createElement("div"),o=0;o<e.length;o++)n.appendChild(e[o].cloneNode(!0));return n}if(e.constructor===Array){for(var n=document.createElement("div"),o=0;o<e.length;o++)console.log(e[o]),n.appendChild(e[o].cloneNode(!0));return n}return e}},a=function(e){if(!e)return console.log("There are no args to build a Footer within a modal dialog"),!1;var t=document.createElement("div");if(t.className="modal-footer","object"==typeof e&&e.constructor===Array&&(len=e.length)){var n=0;for(n=len;n--;)t.appendChild(e[n])}return t},l=function(){this.options.footer&&(this.footer=a(this.options.footer));var e=document.createElement("div");e.className="modal-header",e.appendChild(r.call(this)),(t=this.options.title)&&e.appendChild(o(t));var n=document.createElement("div");n.className="modal-body",this.content&&n.appendChild(this.content);var i=document.createElement("div");i.className="modal-content",i.appendChild(e),i.appendChild(n),this.footer&&i.appendChild(this.footer);var s=document.createElement("div");s.className="modal-dialog",s.className+=this.options.className?" "+this.options.className:" modal-default",s.appendChild(i);var l=document.createElement("div");return l.id=this.options.id||"modal-dialog",l.className="modal fade in",l.appendChild(s),l},c=function(){if(!(this instanceof ModalDialog))return new ModalDialog(arguments[0]);var t={className:"",content:"",iframe:null};return this.modal=null,this.content=null,this.footer=null,arguments[0]&&"object"==typeof arguments[0]&&(this.options=n(t,arguments[0]),this.options.iframe&&"object"==typeof this.options.iframe?(this.content=iFrame({height:this.options.iframe.height||440,id:this.options.iframe.id||"modal-dialog",name:"iframe-"+Utils.makeId(6),src:this.options.iframe.src+"/env=help",width:"100%"}),e=this.options.id):this.content=i(this.options.content)),!0};return c.prototype={footer:function(e){return e?(this.footer=e,!0):this.footer},open:function(){this.modal=l.call(this),this.modal&&this.destroy({reload:!1}),$(this.modal).modal({backdrop:"static",keyboard:!1,show:!0})},destroy:function(t){if(this.modal&&(n=document.getElementById(this.modal.id)))$(n).modal("hide"),n.parentNode.removeChild(n),(t&&t.reload||this.options.reload)&&("string"==typeof t.reload&&t.reload.constructor===String?window.location.assign(t.reload):window.location.reload(this.options.reload));else if(this.modal){var n=document.querySelectorAll("modal"),o=0,r=n.length;for(o=r;o--;)n[o].parentNode.removeChild(n[o])}else{var i=document.getElementById(e);$(i).modal("hide"),i.parentNode.removeChild(i),(t&&t.reload||this.options.reload)&&("string"==typeof t.reload&&t.reload.constructor===String?window.location.pathname!==t.reload.split("#")[0]?window.location.assign(t.reload):window.location.reload(t.reload):window.location.reload(this.options.reload))}}},c}(),getSelection={asListIds:function(){var e=document.querySelectorAll(".checkboxFD");if(len=e.length){var t,n=[];for(t=len;t--;)e[t].checked&&(n[t]=e[t].id.substring(6))}return n}},addRow=function(e){var t=e,n=document.getElementById("box-items"),o=document.createElement("tbody");o.innerHTML=t;var r=o.children[0];return n.appendChild(r),!0},KEY={PRIMARY:1,MIDDLE:2,SECONDARY:3,BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPSLOCK:20,ESC:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122},ctrlIsPressed=!1,middleClick=!1,primaryClick=!1,primaryClickHolded=!1,secondaryClick=!1,secondaryClickHolded=!1,capsLocked=!1;document.onkeydown=function(e){var e=e||window.event,t=e.keyCode||e.which;t===KEY.CTRL&&(ctrlIsPressed=!0),t===KEY.SHIFT&&(shiftIsPressed=!0)},document.onkeyup=function(e){var e=e||window.event,t=e.keyCode||e.which;return t===KEY.CTRL?(ctrlIsPressed=!1,!1):t===KEY.SHIFT?(shiftIsPressed=!1,!1):(t!==KEY.HOME||ctrlIsPressed!==!0)&&((t!==KEY.INSERT||ctrlIsPressed!==!0)&&((t!==KEY.DELETE||ctrlIsPressed!==!0)&&void 0))},document.onkeypress=function(e){var e=e||window.event,t=e.keyCode||e.which,n=String.fromCharCode(t);n.toUpperCase()!==n||n.toLowerCase()===n||e.shiftKey?capsLocked&&(capsLocked=!1):capsLocked||(capsLocked=!0)};var FixPosition=function(){var e={zIndex:1,position:{left:"10px",top:"10px"}},t=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},n=function(){return this instanceof FixPosition?(arguments[0]&&"object"==typeof arguments[0]?this.opts=t(e,arguments[0]):this.opts=e,this.node=null,void(this.opts.target&&"string"==typeof this.opts.target?this.node=document.querySelector(this.opts.target):console.warn("There is no target!"))):new FixPosition(arguments[0])};return n.prototype={fix:function(){if(this.node){this.node.style.position="fixed",this.node.style.zIndex=this.opts.zIndex,this.node.style.padding="7px 0",this.node.style.top=this.opts.position.top,this.node.style.right=this.opts.position.right,this.node.style.bottom=this.opts.position.bottom,this.node.style.left=this.opts.position.left;var e=0,t=this.node.children.length;for(e=t;e--;){var n=this.node.children[e].querySelector(".btn");n&&n.className.indexOf("btn-xs")===-1&&(n.className+=" btn-xs")}}},unfix:function(){if(this.node){this.node.removeAttribute("style");var e=0,t=this.node.children.length;for(e=t;e--;){var n=this.node.children[e].querySelector(".btn");n&&!n.className.indexOf("btn-xs")>-1&&(n.className=n.className.replace(/(?:^|\s)btn-xs(?!\S)/g,""))}}}},n}();document.onscroll=function(e){var t=function(){var t=e.target.scrollTop||window.pageYOffset;return e.target.body&&(t=e.target.body.scrollTop),t}(),n=FixPosition({target:".fixed-top",position:{right:"0px",top:"50px"},zIndex:10});t>=53?n.fix():t<=0&&n.unfix()};var mapMouseClick=function(e){var e=e||window.event,t=e.keyCode||e.which||e.button;switch(t){case KEY.PRIMARY:primaryClick=!0;break;case KEY.MIDDLE:middleClick=!0;break;case KEY.SECONDARY:secondaryClick=!0;break;default:console.error("You've a strange mouse")}};document.onmousedown=function(e){return mapMouseClick(e)},document.onmouseup=function(){middleClick&&(middleClick=!1),primaryClick&&(primaryClick=!1),secondaryClick&&(secondaryClick=!1)};var Item=function(){var e="",t=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},n=function(){if(!(this instanceof Item))return new Item(arguments[0]);var n={};this.timeoutId=0,arguments[0]&&"object"==typeof arguments[0]?this.options=t(n,arguments[0]):this.options=n,this.node=this.options.node||null,_icon=this.node.querySelector("i"),e=_icon.className,this.SETTINGS={ICONS:{CHECK:"fa fa-check-circle",FOLDER:e||"fa fa-folder",FILE:e||"fa fa-file"}};var o=function(e){var t=e.target||e.srcElement;return!primaryClickHolded&&(!secondaryClickHolded&&(ctrlIsPressed||"I"===t.nodeName?(this.options.controller.handleMultipleSelection(this),!1):ctrlIsPressed?void 0:(this.options.controller.handleItem(this),!1)))},r=function(e){var t=this;mapMouseClick(e),this.timeoutId=setTimeout(function(){return primaryClick&&(primaryClickHolded=!0),secondaryClick&&(secondaryClickHolded=!0),t.options.controller.handleItem(t),!1},600),secondaryClick&&t.options.controller.handleItem(t)},i=function(){return primaryClickHolded&&(primaryClickHolded=!1),secondaryClickHolded&&(secondaryClickHolded=!1),clearTimeout(this.timeoutId),!1},a=function(){if(this.node){var e=this;addEvent("mousedown",this,function(t){return t===e.node&&!e.node.isProtected},function(t){return r.call(e,t),!1},!1),addEvent("contextmenu",this,function(t){return t===e.node},function(e){return e.preventDefault&&e.preventDefault(),!1},!1),addEvent("mouseup",this,function(t){return t===e.node},function(){return i.call(e),!1},!1),addEvent("click",this,function(t){return t===e.node&&!e.node.isProtected||t===e.node&&ctrlIsPressed},function(t){return o.call(e,t),!1},!1)}};a.call(this)};return n.prototype={highlightIn:function(){Utils.classes.add(this.node,"selected")},highlightOut:function(){Utils.classes.remove(this.node,"selected")},getIcon:function(){return this.node.querySelector("td > i.fa")},check:function(){$(this.getIcon()).removeClass().addClass(this.SETTINGS.ICONS.CHECK)},uncheck:function(){"d"===this.node.id.substr(0,1)?$(this.getIcon()).removeClass().addClass(this.SETTINGS.ICONS.FOLDER):"f"===this.node.id.substr(0,1)&&$(this.getIcon()).removeClass().addClass(this.SETTINGS.ICONS.FILE)},isProtected:function(){return"true"===this.node.getAttribute("data-protected")}},n}(),TableSorter=function(){function e(e,t){function n(e,t){var n={},o=0,r=t.length;for(o=r;o--;)n[t[o]]=!0;r=e.length;var i=[];for(o=r;o--;)n[e[o]]||i.push(e[o]);return i}function o(){var t=0,n=this.columns.length;for(t=n;t--;)this.columns[t]!==e&&(this.columns[t].hasAttribute("class")&&this.columns[t].removeAttribute("class"),(_icon=qs("i.active",this.columns[t]))&&remove_class(_icon,"active"))}function r(){return has_class(e,"sort-dsc")?"dsc":!!has_class(e,"sort-asc")&&"asc"}function a(t,n){var o=qs("tbody",c),r=0,i=n.length;if("initial"!==t){var a=this;for(n.sort(function(t,n){var o=t.children[e.cellIndex];cellB=n.children[e.cellIndex];var r=o?o.innerText.toLowerCase():"";return textB=cellB?cellB.innerText.toLowerCase():"",(f=a.options.column_format[e.cellIndex])?(console.log("sort by %s",f),d[f](r,textB)):"numeric"===e.getAttribute("data-type")?d.numeric(r,textB):"alphanum"===e.getAttribute("data-type")?d.alphanum(r,textB):"filesize"===e.getAttribute("data-type")?d.filesize(r,textB):"date"===e.getAttribute("data-type")?d.date(r,textB):d.base(t,n)}),"reverse"===t&&n.reverse(),r=i;r--;)o.appendChild(n[r])}else for(r=i;r--;)o.appendChild(this.initial_rows[r])}function s(t){function o(){var e=[],t=0,o=this.rows.length;for(t;t<o;t++){var r=n(this.options.groups,this.rows[t].className.split());if(r.length){var i=0;for(i;i<this.options.groups.length;i++)has_class(this.rows[t],this.options.groups[i])&&(e[i]||(e[i]=[]),e[i].push(this.rows[t]))}}return e.reverse()}{if(!has_class(e,"groups"))return a.call(this,t,this.rows);var r=o.call(this);if(l=r.length,!l)return void console.warn("There are no groups to sort.");for(i=l;i--;)a.call(this,t,r[i])}}var c=this.Table,d={base:function(e,t){return e===t?0:e>t?1:-1},numeric:function(e,t){var n=parseInt(e.replace(/[^0-9]/g,""),10),o=parseInt(t.replace(/[^0-9]/g,""),10);return d.base(n,o)},float:function(e,t){return d.base(e,t)},alphanum:function(e,t){var n=e.replace(/[^a-zA-Z]/g,""),o=t.replace(/[^a-zA-Z]/g,"");return n===o?d.numeric(e,t):d.base(n,o)},filesize:function(e,t){function n(e,t){var n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],o=n.indexOf(t.toUpperCase());return o===-1&&(o=0),e*Math.pow(1024,o)}return e=n.apply(null,e.split(" ")),t=n.apply(null,t.split(" ")),d.float(e,t)},date:function(e,t){return e=e.replace(/(\d{2})-(\d{2})-(\d{4}) (\d{2}):(\d{2})/g,"$3$2$1$4$5"),t=t.replace(/(\d{2})-(\d{2})-(\d{4}) (\d{2}):(\d{2})/g,"$3$2$1$4$5"),d.base(e,t)},undefined:function(e,t){return console.warn("The type of data which you want to sort is not yet supported."),d.base(e,t)}};o.call(this),"asc"===r()?(s.call(this),add_class(e,"sorted"),replace_class(e,"sort-asc","sort-dsc"),remove_class(t.up,"active"),add_class(t.down,"active")):"dsc"===r()?(s.call(this,"initial"),remove_class(e,"sorted"),remove_class(e,"sorted"),remove_class(e,"sort-dsc"),remove_class(t.up,"active"),remove_class(t.down,"active")):(s.call(this,"reverse"),add_class(e,"sorted"),add_class(e,"sort-asc"),add_class(t.up,"active"),remove_class(t.down,"active"))}function t(e){var t=document.createElement("div");t.style.display="inline-block",t.style.verticalAlign="middle",t.style.marginLeft="6px";var n=document.createElement("i");n.className=this.options.icons[0],n.style.float="left",n.style.width="100%",t.appendChild(n);var o=document.createElement("i");return o.className=this.options.icons[1],o.style.float="left",o.style.width="100%",t.appendChild(o),{wrapper:t,up:n,down:o}}function n(){var n=0,o=this.columns.length;for(n=o;n--;){var r=this.columns[n];if(r.textContent&&!has_class(r,this.options.ignore)){r.textContent=r.textContent.trim(),r.style.cursor="pointer";var i=t.call(this,r);r.insertBefore(i.wrapper,r.childNodes[1]),function(t,n,o){n.addEventListener("click",function(){e.call(t,n,o)},!1)}(this,r,i)}}}function o(){if(!this.Table.children.length)return void console.error("Table node doesn't have any thead, tbody or tfood.");var e=0,t=this.Table.children,o=t.length;for(e=o;e--;){if(t[e].constructor!==HTMLTableSectionElement)return void console.error("The node what you try to use as table section is invalid.                     It's means that your table have a wrong html markup.");var r=0,o=0;if("thead"===t[e].localName){var i=t[e].children[0].children,o=i.length;if(!o)return void console.error("No <th> found.");for(r=o;r--;)1===i[r].nodeType&&this.columns.push(i[r])}else if("tbody"===t[e].localName){var a=t[e].children,o=a.length;if(!o)return void console.error("No <tr> found.");for(r=o;r--;)1===a[r].nodeType&&this.rows.push(a[r]);this.initial_rows=this.rows.slice()}else{if("tfoot"!==t[e].localName)return void console.warn("You're using a very rare table...");console.warn("Sort function on tfoot is no yet supported, we ignore these rows right now")}}n.call(this)}var r={column_format:{},groups:[],icons:["fa fa-angle-up","fa fa-angle-down"],ignore:"unsortable"},a=function(){return this instanceof TableSorter?arguments?arguments.length>2?void console.error("TableSorter() have too many arguments"):"object"==typeof arguments[0]||arguments[0]instanceof HTMLTableElement?!arguments[1]||"object"==typeof arguments[1]&&arguments[1].constructor===Object?(this.Table=arguments[0],this.options=_extend_options(r,arguments[1]),this.columns=[],this.rows=[],this.initial_rows=[],o.call(this),this):void console.error("Invalid second argument given to TableSorter()"):void console.error("Missing context. TableSorter() should be invoked in a HTMLTableElement context"):void console.error("TableSorter() gets no arguments"):new TableSorter(arguments)};return a}(),TableCollapser=function(){function e(e){if(!is_number(e.column_index))return void console.error("You must to define an index where to put the collapser caret");if(!is_function(e.onclick))return void console.error("You must to define an onclick event as a callback when we click on the collapser icon");var t=this,n=qsa("tbody > tr",this.Table),o=0,r=n.length;for(o=r;o--;){var i=n[o],a=i.id;if(a){var s=i.cells;for(r=s.length,j=r;j--;)if(s[j].cellIndex===e.column_index){var l=document.createElement("i");l.className=this.icons[0],l.style.float="left",l.style.cursor="pointer",l.style.fontSize="16px",function(n){l.addEventListener("click",function(o){return e.onclick.call(t,o,n,e)},!1)}(i);var c=s[j].childNodes,d=s[j].children;if(d.length||1!==c.length||3!==c[0].nodeType)if(d.length&&c.length){var u=document.createElement("div");u.style.marginLeft="14px",s[j].appendChild(u),r=c.length;var f=0;for(f;f<r;f++)c[f]&&wrap(c[f],u);s[j].insertBefore(l,d[0])}else console.warn("Review the content of this cell."),s[j].insertBefore(l,d[0]);else{var h=document.createElement("span");h.style.marginLeft="14px",wrap(c[0],h),s[j].insertBefore(l,d[0])}}}else console.warn("row[%s] doesn't has id attribute",o)}}var t={icons:["fa fa-caret-right","fa fa-caret-down"],column_index:0},n=function(){if(!(this instanceof TableCollapser))return new TableCollapser(arguments);if(!arguments)return void console.error("TableCollapser have no arguments");if(arguments.length>2)return void console.error("TableCollapser() have too many arguments");if("object"!=typeof arguments[0]&&!(arguments[0]instanceof HTMLTableElement))return void console.error("Missing context. TableCollapser() should be invoked in a HTMLTableElement context");if(this.Table=arguments[0],arguments[1]&&("object"!=typeof arguments[1]||arguments[1].constructor!==Object))return void console.error("Invalid second argument given to TableCollapser()");var n=_extend_options(t,arguments[1]);return n.icons&&is_array(n.icons)&&(this.icons=n.icons),e.call(this,n),this};return n.prototype={},n}(),Sorter=function(){var e={selector:".sortable"},t=function(){if(!(this instanceof Sorter))return new Sorter(arguments);if(!arguments)return void console.error("Sorter() have no arguments");if(arguments.length>2)return void console.error("Sorter() gets too many arguments");this.node=arguments[0];var t=_extend_options(e,arguments[1]);return has_class(this.node,t.selector.substr(1))?(this.node.constructor===HTMLTableElement&&"table"===this.node.tagName.toLowerCase()&&new TableSorter(this.node,t),this):void console.log("node is not sortable.")};return t.prototype={},t}(),Collapser=function(){var e={selector:".collapsible"},t=function(){if(!(this instanceof Collapser))return new Collapser(arguments);if(!arguments)return void console.error("Collapser() have no arguments");if(arguments.length>2)return void console.error("Too many arguments");this.node=arguments[0];var t=_extend_options(e,arguments[1]);return has_class(this.node,t.selector.substr(1))?void(this.node.constructor===HTMLTableElement&&"table"===this.node.tagName.toLowerCase()&&new TableCollapser(this.node,t)):void console.log("node is not collapsible")};return t.prototpye={},t}(),Table=function(){var e={collapser:!1,sorter:!1},t=function(){if(!(this instanceof Table))return new Table(arguments);if(!arguments)return void console.error("No arguments");if(arguments.length>2)return void console.error("Too many arguments");if("string"!=typeof arguments[0]&&!(arguments[0]instanceof String))return void console.error("Missing selector.");this.selector=arguments[0];var t=qsa(this.selector),n=t.length;if(!n)return void console.log("No tables found");if("object"!=typeof arguments[1]||arguments[1].constructor!==Object)return void console.error();var o=_extend_options(e,arguments[1]),r=0;for(r=n;r--;)(o.sorter&&"boolean"==typeof o.sorter&&o.sorter.constructor===Boolean||"object"==typeof o.sorter&&o.sorter.constructor===Object)&&new Sorter(t[r],o.sorter),o.collapser&&"object"==typeof o.collapser&&o.collapser.constructor===Object&&new Collapser(t[r],o.collapser);return this};return t.prototype={},t}(),Collection=function(){var e={},t=function(e){if(Utils.dict.length(e)){var t=[];for(var n in e)t.push(e[n].node.id);return t}},n=function(e,t){var n=[];if(len=t.length)for(i=len;i--;)"_"!==t[i].parent_id&&~~t[i].parent_id===~~e&&n.push(t[i]);return n.reverse()},o=function(e,t,r){var i=document.createElement("ul");return(len=r.length)&&r.forEach(function(e){childOutput="",childResult=n(e.id,t,1),childResult.length&&(childOutput=o(e.id,t,childResult));var r=0==e.readonly,a=document.createElement("li");if(a.className="parent_li",r){var s=document.createElement("a");s.href="#",s.className="selectdir",s.id="mv_d_"+e.id,s.textContent=e.name,s.addEventListener("click",function(e){e.preventDefault&&e.preventDefault();var t=document.querySelectorAll("."+this.className);if(len=t.length)for(var n=len;n--;)t[n].parentNode.style.border="none";
this.parentNode.style.border="1px solid #7cb034";var o=this.id;if(o.indexOf("mv_d_")>-1){o=o.replace("mv_d_","");var r=document.getElementById("mvButtonConfirm");r.classList.contains("disabled")&&(r.classList.remove("disabled"),r.dataset.dismiss="modal"),r.setAttribute("dr_id",o)}else o.indexOf("cp_d_")>-1&&(o=o.replace("cp_d_",""));return!1},!1);var l=document.createElement("span");l.appendChild(s),a.appendChild(l)}else a.textContent=e.name;childOutput&&a.appendChild($(childOutput)[0]),i.appendChild(a)}),i},r=function(e,t){var n=[];if(len=t.length)for(i=len;i--;)~~t[i].id===~~e&&(n=t[i]);return n},a=function(e){return!Utils.classes.contains(e,"disabled")},s=function(e){return Request({method:"POST",url:window.location.pathname+"/mkdir",fdata:[e],callback:function(e){var t=document.getElementById("modal-createFolder");$(t).modal("hide"),addRow(e),window.location.reload()},failback:function(e){var t=document.createElement("div");return t.className="alert alert-danger",t.role="alert",t.textContent=e,form.parentNode.insertBefore(t,form),!1}})},l=function(){if(!(this instanceof Collection))return new Collection(arguments[0]);if(this.lastSelection=null,this.selection={},this.nodes=[],arguments[0]&&"object"==typeof arguments[0]?this.options=_extend_options(e,arguments[0]):this.options=e,len=this.options.nodes.length){var t=0;for(t=len;t--;){var n="true"===this.options.nodes[t].getAttribute("data-protected");n||this.nodes.push(new Item({controller:this,node:this.options.nodes[t]}))}}this.mkdirBtn=this.options.mkdirBtn||null,this.moveBtn=this.options.moveBtn||null,this.rmBtn=this.options.removeBtn||null,this.emptyTrashBtn=this.options.emptyTrashBtn||null,this.rnBtns=qsa(this.options.renameBtns)||null,this.shareBtns=qsa(this.options.shareBtns)||null,this.restoreBtns=qsa(this.options.restoreBtns)||null,this.selectAllBtn=this.options.selectAllBtn||null;var o=function(){var e=this;if(this.mkdirBtn&&addEvent("click",this,function(t){return a(e.mkdirBtn)&&e.mkdirBtn===t},function(){return e.handleMakeDir(e.mkdirBtn),!1},!1),this.selectAllBtn&&addEvent("click",this,function(t){return a(e.selectAllBtn)&&e.selectAllBtn===t},function(){return e.handleSelectAll(),!1},!1),this.moveBtn&&addEvent("click",this,function(t){return a(e.moveBtn)&&e.moveBtn===t},function(){return e.handleMove(e.moveBtn),!1},!1),this.rmBtn&&addEvent("click",this,function(t){return a(e.rmBtn)&&e.rmBtn===t},function(){e.handleRemove(e.rmBtn)},!1),this.emptyTrashBtn&&this.emptyTrashBtn.addEventListener("click",function(t){t.preventDefault&&t.preventDefault(),e.handleEmptyTrash(e.emptyTrashBtn)},!1),this.rnBtns&&(len=this.rnBtns.length)){var t=0;for(t=len;t--;)!function(t){addEvent("click",e.rnBtns[t],function(n){return n===e.rnBtns[t]},function(){e.handleRename(e.rnBtns[t])},!1)}(t)}if(this.shareBtns&&(len=this.shareBtns.length)){var t=0;for(t=len;t--;)!function(t){addEvent("click",e.shareBtns[t],function(n){return n===e.shareBtns[t]},function(){e.handleShare(e.shareBtns[t])},!1)}(t)}if(this.restoreBtns&&(len=this.restoreBtns.length)){var t=0;for(t=len;t--;)!function(t){addEvent("click",e.restoreBtns[t],function(n){return e.restoreBtns[t]===n},function(){e.handleRestore(e.restoreBtns[t])},!1)}(t)}};o.call(this)};return l.prototype={handleSelection:{isSelected:function(e,t){return t.node.id in e.selection},isLastSelected:function(e,t){return e.lastSelection&&e.lastSelection===t},add:function(e,t,n){e.selection[t.node.id]=t,n&&n.highlightOut(),t.highlightIn(),e.lastSelection=t},remove:function(e,t){delete e.selection[t.node.id],t.highlightOut(),e.lastSelection=null},empty:function(e){return Utils.dict.empty(e.selection)},length:function(e){return Utils.dict.length(e.selection)}},updateToolBar:function(){this.handleSelection.length(this)?(remove_class(this.moveBtn.parentNode,"hide"),remove_class(this.rmBtn.parentNode,"hide")):(add_class(this.moveBtn.parentNode,"hide"),add_class(this.rmBtn.parentNode,"hide"))},handleItem:function(e){if(!ctrlIsPressed&&e){var t=e.node.id;if(this.handleSelection.length(this)>1){for(var n in this.selection)this.selection[n].uncheck(),this.selection[t]!==this.selection[n]&&this.handleSelection.remove(this,this.selection[n]);this.handleSelection.add(this,e)}else this.handleSelection.isLastSelected(this,e)?this.handleSelection.isLastSelected(this,e)?this.handleSelection.remove(this,e):this.handleSelection.add(this,e):(this.selection={},this.handleSelection.add(this,e,this.lastSelection));this.updateToolBar()}},handleMultipleSelection:function(e){this.lastSelection&&this.lastSelection.check(),this.handleSelection.isSelected(this,e)?this.handleSelection.isSelected(this,e)?(this.handleSelection.remove(this,e),e.uncheck()):this.handleSelection.empty(this):(this.handleSelection.add(this,e),e.check()),this.updateToolBar()},handleMakeDir:function(e){var t=document.createElement("form");t.autocomplete="off",t.className="form-group",t.id="form-mkdir";var n=new Input({autofocus:!0,className:"form-control",form:t.id,id:"mkDirInputValue",name:"name",placeholder:lang.mkdir.input.placeholder});addEvent("keyup",n,function(e){return n===e},function(){var e=document.getElementById("mkDirSave");n.value?Utils.classes.remove(e,"disabled"):Utils.classes.add(e,"disabled")},!1),addEvent("keypress",t,function(e){return t===e},function(){if(13===event.which&&!n.value)return event.preventDefault&&event.preventDefault(),!1},!1),addEvent("submit",t,function(e){return t===e},function(e){return e.preventDefault&&e.preventDefault(),s(n)},!1),t.appendChild(n);var o=function(){var e=Button({"data-dismiss":"modal",className:"btn btn-sm btn-primary-dw disabled",id:"mkDirSave",textContent:lang.buttons.save,type:"button"});addEvent("click",e,function(t){return e===t},function(){return s(n)},!1);var t=Button({"data-dismiss":"modal",className:"btn btn-sm btn-default",id:"mkDirCancel",textContent:lang.buttons.cancel,type:"button"});return[e,t]},r=ModalDialog({className:"modal-sm",content:t,footer:o(),id:"modal-createFolder",title:e.title||e.name||""});r.open()},handleSelectAll:function(){if(len=this.nodes.length){var e=this,t=0;if(Utils.dict.length(this.selection)!==this.nodes.length)for(t=len;t--;)e.handleSelection.add(e,this.nodes[t]),this.nodes[t].check();else for(t=len;t--;)e.handleSelection.remove(e,this.nodes[t]),this.nodes[t].uncheck()}this.updateToolBar()},handleMove:function(e){var i=t(this.selection);ajaxRequest(window.location.pathname+"/dirlist="+i.join(),function(t){var a=JSON.parse(t),s=n(0,a,1);s=o(0,a,s);var l=r(0,a),c=0==l.readonly,d=function(){var e=document.createElement("div");e.className="view-tree";var t=document.createElement("ul"),n=document.createElement("li");if(n.className="parent_li",c){var o=document.createElement("a");o.href="#",o.className="selectdir",o.id="mv_d_0",o.textContent=l.name,n.appendChild(o)}else n.textContent=l.name;return n.appendChild($(s)[0]),t.appendChild(n),e.appendChild(t),e},u=function(){var e=new Button({"data-dismiss":"modal",className:"btn btn-default",textContent:lang.buttons.cancel,type:"button"});e.addEventListener("click",function(){var e=document.getElementById("mvItemsModal");return e.parentNode.removeChild(e),!1},!1);var t=new Button({"data-dismiss":"modal",className:"btn btn-primary-dw disabled",id:"mvButtonConfirm",textContent:lang.buttons.move,type:"button"});return t.addEventListener("click",function(){var e=this.getAttribute("dr_id");ajaxRequest(window.location.pathname+"/move="+e+"&"+i.join(),function(e){jsonResponse=JSON.parse(e);var t="";for(var n in jsonResponse)""!=jsonResponse[n]?(value=$("#"+n+"_name").html(),""!=value&&(t+="<li>"+value+": "+jsonResponse[n]+"</li>")):$("#"+n).remove()},function(e){console.log(e)})},!1),[t,e]},f=new ModalDialog({className:"modal-lg",id:"mvItemsModal",content:d(),footer:u(),title:e.title||e.name||""});f.open()},function(e){console.log(e)})},handleRemove:function(e){var n=t(this.selection),o=function(){var t=new Button({"data-dismiss":"modal",className:"btn btn-default",textContent:lang.buttons.cancel,type:"button"});t.addEventListener("click",function(){var e=document.getElementById("rmItemsModal");return e.parentNode.removeChild(e),!1},!1);var o=new Button({"data-dismiss":"modal",className:"btn btn-primary-dw",id:"rmButton",textContent:lang.buttons.remove,type:"button"});return o.addEventListener("click",function(){ajaxRequest(window.location.pathname+"/remove="+n.join(),function(t){Utils.classes.add(e,"btn-primary-dw"),Utils.classes.remove(e,"btn-danger"),result=JSON.parse(t),console.log(result);var n;for(n in result)if(result[n]){console.log(n),console.log(result[n]);var o=document.createElement("div");o.className="alert alert-danger",o.role="alert",name=document.getElementById(n+"_name").textContent,name&&(o.innerHTML+="<li><strong>"+name+"</strong>: "+result[n]+"</li>")}else $("#"+n).remove(),moreDeleted=!0;window.location.reload()},function(e){console.log(e)})},!1),[o,t]},r=new ModalDialog({className:"modal-lg",id:"rmItemsModal",content:lang.rm.areYouSure,footer:o(),title:e.title||e.name||""});r.open()},handleEmptyTrash:function(e){var n=t(this.selection);console.log(n);var o=function(){var e=new Button({"data-dismiss":"modal",className:"btn btn-default",textContent:lang.buttons.cancel,type:"button"});e.addEventListener("click",function(){var e=document.getElementById("rmItemsModal");return e.parentNode.removeChild(e),!1},!1);var t=new Button({"data-dismiss":"modal",className:"btn btn-primary-dw",id:"rmButton",textContent:lang.buttons.remove,type:"button"});return t.addEventListener("click",function(){Request({method:"POST",url:window.location.pathname+"/empty-trash",fdata:[{name:"selection",value:n}],callback:function(e){if(files=e.files){console.log(files);var t=files.length,n=0;for(n;n<t;n++){var o=qs("#f_"+files[n].id);o.parentNode.removeChild(o)}}if(directories=e.directories){var t=directories.length,n=0;for(n;n<t;n++){var o=qs("#d_"+directories[n].id);o.parentNode.removeChild(o)}}window.location.reload()},failback:function(e){console.error(e)}})},!1),[t,e]},r=new ModalDialog({className:"modal-lg",id:"rmItemsModal",content:lang.rm.areYouSure,footer:o(),title:e.title||e.name||""});r.open()},handleRename:function(e){var t=document.createElement("form");t.autocomplete="off",t.className="form-group",t.id="form-rename";var n=e.parentNode.parentNode.querySelector("td span.name").textContent,o=new Input({autofocus:!0,className:"form-control",form:t.id,id:"renameInputValue",placeholder:lang.mkdir.input.placeholder,value:n});o.addEventListener("keyup",function(){var e=document.getElementById("renameSave");o.value?Utils.classes.remove(e,"disabled"):Utils.classes.add(e,"disabled")},!1),t.appendChild(o),t.addEventListener("keypress",function(e){if(13===e.which&&!o.value)return e.preventDefault&&e.preventDefault(),!1},!1),t.addEventListener("submit",function(t){t.preventDefault&&t.preventDefault();var n=e.parentNode.parentNode.id;ajaxRequest(window.location.pathname+"/rename="+n+"/to="+o.value,function(){window.location.reload()},function(e){console.log(e)})},!1);var r=function(){var t=new Button({"data-dismiss":"modal",className:"btn btn-sm btn-primary-dw disabled",id:"renameSave",textContent:lang.buttons.save,type:"button"});t.addEventListener("click",function(){var t=e.parentNode.parentNode.id;ajaxRequest(window.location.pathname+"/rename="+t+"/to="+o.value,function(){window.location.reload()},function(e){console.log(e)})},!1);var n=new Button({"data-dismiss":"modal",className:"btn btn-sm btn-default",id:"renameCancel",textContent:lang.buttons.cancel,type:"button"});return[t,n]},i=ModalDialog({className:"modal-sm",content:t,footer:r(),id:"modal-rename",title:e.title||e.name||""});i.open()},handleShare:function(e){console.log(e);var t=e.parentNode.parentNode.id;e.classList.contains("active")?(ajaxRequest("/user/view5/private="+t,function(){console.log("good")},function(){console.log("bad")}),window.location=window.location.pathname):(ajaxRequest("/user/view5/public="+t,function(){console.log("good")},function(){console.log("bad")}),window.location=window.location.pathname)},handleRestore:function(e){var t=e.parentNode.parentNode.id;e.classList.contains("active")?(ajaxRequest("/user/view5/restore="+t,function(){console.log("good")},function(){console.log("bad")}),window.location=window.location.pathname):(ajaxRequest("/user/view5/restore="+t,function(){console.log("good")},function(){console.log("bad")}),window.location=window.location.pathname)}},l}(),Tray=function(){var e={id:Utils.makeId(6)},t=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},n=function(e){var t=document.createElement("h4");return t.className="tray-title",t.textContent=e,t},o=function(){return anchor=document.createElement("a"),anchor.className="close",anchor.title="Close",anchor.textContent="×",anchor},r=function(e){if(!e)return console.log("There is no content to render within a modal dialog"),!1;if("string"==typeof e){var t=document.createElement("p");return t.innerText=e,t}return"object"==typeof e?e:void 0},i=function(){var e=document.createElement("div");e.className="tray-header",e.appendChild(o.call(this)),e.appendChild(n(this.opts.title));var t=document.createElement("div");t.className="tray-body",this.opts.content&&t.appendChild(r(this.opts.content));var i=document.createElement("div");i.className="tray-content",i.appendChild(e),i.appendChild(t),this.opts.footer&&i.appendChild(this.opts.footer);var a=document.createElement("div");a.className="tray-inner",a.className+=this.opts.className?" "+this.opts.className:" tray-default",a.appendChild(i);var s=document.createElement("div");return s.id="tray-"+this.opts.id||"tray",s.className="tray animate fadeInUp",s.style.width="400px",s.style.maxHeight="400px",s.style.bottom="50px",s.style.right="20px",s.appendChild(a),s},a=function(){var e=document.querySelectorAll(".tray");if(len=e.length){var t=0;for(t=len;t--;)e[t].parentNode.removeChild(e[t]);return!0}return!1},s=function(){document.body.appendChild(this.tray)},l=function(){return this instanceof Tray?(this.opts={},this.tray=null,void(arguments[0]&&"object"==typeof arguments[0]?this.opts=t(e,arguments[0]):this.opts=e)):new Tray(arguments[0])};return l.prototype={open:function(){return this.tray=i.call(this),a(),s.call(this),!0},destroy:function(){return a(),!1}},l}(),Trash=function(){var e={btns:"#btn-trash"},t=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},n=function(e){if(len=Utils.dict.length(e)){var t=document.createElement("ul");t.className="list-unstyled";var n=null;for(var n in e){var o=document.createElement("li");o.style.padding="6px",o.textContent=e[n],t.appendChild(o)}return t}},o=function(){var e=this.opts.btns?document.querySelectorAll(this.opts.btns):[];if(len=e.length){var t=0;for(t=len;t--;)!function(t){addEvent("click",e[t],function(n){return n===e[t]},function(){Request({url:window.location.pathname+"/trash",async:!0,callback:function(e){console.log(e);var t=new Tray({title:"Trash",content:n(e)});t.open()},failback:function(e){console.log(e)}});return!1},!1)}(t)}},r=function(){return this instanceof Trash?(this.opts={},this.trash=null,arguments[0]&&"object"==typeof arguments[0]?this.opts=t(e,arguments[0]):this.opts=e,void o.call(this)):new Trash(arguments[0])};return r}(),trash=new Trash,Uploader=function(){var e={droparea:".droparea",failText:"Upload failed",form:"",formNodes:"",inputUploader:".btn-upload",postUrl:"/",succesText:"Upload successful"},t=[],n=document.querySelectorAll(e.droparea),o=document.querySelectorAll(e.inputUploader),r=0,i=0,a=null,s={},l=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e};arguments[0]&&"object"==typeof arguments[0]&&(this.options=l(e,arguments[0]),this.options.droparea&&"string"==typeof this.options.droparea&&(n=document.querySelectorAll(this.options.droparea)),this.options.inputUploader&&"string"==typeof this.options.inputUploader&&(o=document.querySelectorAll(this.options.inputUploader)),this.options.formNodes&&"string"==typeof this.options.formNodes&&(a=document.querySelectorAll(this.options.formNodes)));var c=function(e){return!!window[e]},d=function(e,t){t.innerHTML+='<p id="dndFail">'+e.name+" ("+(e.size?(e.size/1024|0)+"kB":"")+"): "+upload_fail_text+"</p>"},u=function(e,t){t.innerHTML+="<p>"+e.name+" ("+(e.size?(e.size/1024|0)+"kB":"")+"): "+upload_succes_text+"</p>"},f=function(e){if(!t.length)return!1;file=t.shift();var n=new FormData;if(n.append("Filedata",file),s)for(var o in s)n.append(s[o].key,s[o].value);var a=document.getElementById("prograssBar"),l=new XMLHttpRequest;return l.open("POST",upload_post_url,!0),l.onreadystatechange=function(){if(4!==l.readyState)return!1;r++,200===l.status?u(file,e):d(file,e);return f(e),!1},l.upload.onprogress=function(e){if(e.lengthComputable){var t=100*((r+e.loaded/e.total)/i);a.textContent=~~t+"%",a.setAttribute("aria-valuenow",~~t),a.style.width=~~t+"%"}},console.log("send"),l.send(n),!1},h=function(e,n){if(len=e.length){var o;for(o=len;o--;)t.push(e[o])}t.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}),r=0,i=t.length,f(n)},p=function(e){return e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),!1},m=function(){return!1},v=function(e,t){return e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),h(e.dataTransfer.files,t),!1},g=function(){var e=this;if(c("FileReader")){var t;if(len=a.length)for(t=len;t--;)1===a[t].nodeType&&(s[a[t].id]={key:a[t].name,value:a[t].value},a[t].addEventListener("change",function(){return s[this.id].key=this.name,s[this.id].value=this.value,!1},!1));if(len=n.length)for(t=len;t--;)1===n[t].nodeType&&n[t].addEventListener("dragover",function(t){return p.call(e,t),!0},!1),1===n[t].nodeType&&n[t].addEventListener("dragend",function(t){return m.call(e,t),!0},!1),1===n[t].nodeType&&n[t].addEventListener("drop",function(t){return v.call(e,t,this),!0},!1)}else console.warn("Your browser doesn't support the FileReader API");if(len=o.length)for(var t=len;t--;)1===o[t].nodeType&&o[t].addEventListener("change",function(e){var t=document.querySelector(".droparea");h(e.target.files,t)},!1)};g.call(this)},toolTip=function(){var e=null,t=function(t){if(console.log("_build()"),!document.getElementById(this.options.id)){var n=document.createElement("div");n.className="tooltip-arrow";var o=document.createElement("div");o.className="tooltip-inner",o.textContent=this.options.content;var r=document.createElement("div");r.id=this.options.id,r.className="tooltip right",r.appendChild(n),r.appendChild(o),document.body.appendChild(r);var i=Utils.absoluteOffset(t);r.style.opacity=1,r.style.top=i.top+t.clientHeight/6+"px",r.style.right=i.left-r.clientWidth+"px",e=r}return!0},n=function(){var e=document.querySelectorAll(".tooltip");if(len=e.length){var t;for(t=len;t--;)e[t].parentNode.removeChild(e[t])}return!0},o=function(){return!!e&&(e&&(e.parentNode.removeChild(e),e=null),!0)},r=function(){if(!(this instanceof toolTip))return new toolTip(arguments[0]);var e={},t=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e};arguments[0]&&"object"==typeof arguments[0]?this.options=t(e,arguments[0]):this.options=e};return r.prototype={reset:function(){return n.call(this),!1},destroy:function(){return o.call(this),!1},show:function(n){return t.call(this,n),e||!1}},r}(),check={capslock:function(){if(isBrowser.ie8())return!1;var e=document.querySelectorAll('input[type="text"],                                                   input[type="password"]');if(len=e.length){var t;for(t=len;t--;)!function(t){var n=Utils.makeId();addEvent("keypress",e[t],function(n){return e[t]===n},function(){var o=new toolTip({content:lang.warnings.capslock||"",id:n});capsLocked?(o.reset(),o.show(e[t])):o.reset()},!1)}(t)}}},AdvancedSearch=function(){var e=function(){if(!(this instanceof AdvancedSearch))return new AdvancedSearch(arguments[0]);var e=document.getElementById("search-advanced");if(e){var t=function(){var t=e.querySelector(".dropdown-toggle"),n=document.getElementById("ssp_id"),o=document.getElementById("sst_id");if(t){var r=t.parentNode;addEvent("click",this,function(e){return t===e},function(e){e.stopPropagation&&e.stopPropagation();var t="open";isBrowser.lte9()?r.className.indexOf(t)===-1?r.className+=" "+t:r.className.replace(/^'open'$/,""):r.classList.contains(t)?r.classList.remove(t):r.classList.add(t)},!1)}if(n&&o){var i=o.parentNode;addEvent("change",this,function(e){return n===e},function(e){Request({method:"POST",url:window.location.pathname+"/streams",async:!0,fdata:[{name:"sp",value:e.target.value}],callback:function(e){i.innerHTML=e},failback:function(e){console.log(e)}})},!1)}};t.call(this)}};return e}(),App={common:{init:function(){on_devel&&console.log("App.common.init()"),AdvancedSearch();var e=document.querySelectorAll("a.helpbox");if(isBrowser.ie8()){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);e=t}for(var o=e.length,n=0;n<o;n++)!function(t){var n=e[t],o=function(){return new ModalDialog({className:"modal-lg",id:n.id||Utils.makeId(6)||"#",title:n.title||n.name||"",reload:!!n.rel&&String(window.location).replace(/#.*$/,""),iframe:{src:n.href}}).open(),!1};return window.addEventListener?n.addEventListener("click",function(e){Utils.events.preventDefault(e),o()},!1):window.attachEvent?n.attachEvent("onclick",o):console.error("Hey! Your browser doesn't support any type of                                        event listener. Are you using a browser?"),!0}(n)}},box:{init:function(){on_devel&&console.log("App.box.init()"),new Collection({mkdirBtn:qs(".btn-mkdir"),moveBtn:qs(".btn-move"),nodes:qsa("#box-items > tr"),removeBtn:qs(".btn-remove"),emptyTrashBtn:qs("#btn-emptytrash"),renameBtns:".btn-rename",shareBtns:".btn-share",restoreBtns:".btn-restore",selectAllBtn:qs(".btn-selectall")})}}},Plugin={table:{init:function(){if(on_devel)return console.log("Plugin.table.init()"),void console.warn("The invokation of this plugin through body[data-plugins] is not yet supported")}},table_sorter:{init:function(){on_devel&&console.log("Plugin.table_sorter.init()");var e=qsa("table.table.sortable"),t=e.length;if(t){var n=0;for(n=t;n--;)new TableSorter(e[n])}}},table_collapser:{init:function(){on_devel&&console.log("Plugin.table_collapser.init()");var e=qsa("table.table.collapsible"),t=e.length;if(t){var n=0;for(n=t;n--;)new TableCollapser(e[n])}}}},INIT={fire:function(e,t,n){var o=this;t="undefined"==typeof t?"init":t,""!==e&&o[e]&&"function"==typeof o[e][t]&&o[e][t](n)},dispatcher:function(){INIT.fire.call(App,"common");var e=[];if((c=document.body.className)&&(e=c.replace(/-/g,"_").split(/\s+/).reverse(),l=e.length)){var t=0;for(t=l;t--;)INIT.fire.call(App,e[t])}var n=[];if((p=document.body.getAttribute("data-plugins"))&&(n=p.replace(/-/g,"_").split(/\s+/).reverse(),l=n.length)){var t=0;for(t=l;t--;)INIT.fire.call(Plugin,n[t])}}};document.addEventListener("DOMContentLoaded",function(e){return INIT.dispatcher()},!1);