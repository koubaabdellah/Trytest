/* Source and licensing information for the line(s) below can be found at https://www.consuwijzer.nl/themes/custom/consuwijzer/dist/js/patterns/molecules/search-bar/search-bar.js. */
!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";(Drupal=>{Drupal.SearchBar=class DrupalSearchBar{constructor(e,t){this.$el=e,this.$form=this.$el.querySelector(".m-search-bar__form"),this.$search=this.$el.querySelector(".m-search-bar__input"),this.$autocomplete=this.$el.querySelector(".m-search-bar__autocomplete"),this.timeout_id=null,this.request=null,this.options={url:`${this.$form.dataset.actionAutocomplete??this.$form.action}?zoekwoord=%`,min_length:3,...t},this.$search.addEventListener("focus",(()=>{this.$search.value.length>=this.options.min_length&&this.request&&this.$autocomplete.classList.add("m-search-bar__autocomplete--is-open")}),!1),this.$search.addEventListener("input",this.search.bind(this),!1),this.$search.addEventListener("keyup",(e=>{27===e.keyCode&&this.cancel()}),!1),this.$el.addEventListener("focusout",(t=>{!1===e.contains(t.relatedTarget)&&this.cancel()}),!1)}search(){const e=this.$search.value;if(this.$el.classList.remove("m-search-bar--is-loading"),this.timeout_id&&window.clearTimeout(this.timeout_id),this.request&&this.request.abort(),e.length<this.options.min_length)return;this.timeout_id=window.setTimeout((()=>{this.$el.classList.add("m-search-bar--is-loading"),this.request=new XMLHttpRequest,this.request.addEventListener("load",(()=>{if(this.$el.classList.remove("m-search-bar--is-loading"),200===this.request.status){const e=JSON.parse(this.request.response);let t=`<div class="m-search-bar__content"><em>${Drupal.t("No results")}</em></div>`;for(e.length>0&&(t=`<ul class="m-search-bar__list">\n                  ${e.map((e=>`<li class="m-search-bar__item">\n                          <a href="${e.url}" class="m-search-bar__link">${e.title}</a>\n                        </li>`)).join("")}\n                </ul>`);this.$autocomplete.firstChild;)this.$autocomplete.removeChild(this.$autocomplete.firstChild);this.$autocomplete.insertAdjacentHTML("afterbegin",t),this.$autocomplete.classList.add("m-search-bar__autocomplete--is-open")}}),!1),this.request.addEventListener("error",(()=>{this.$el.classList.remove("m-search-form--is-loading")}),!1),this.request.open("GET",this.options.url.replace("%",encodeURIComponent(e)),!0),this.request.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.request.send()}),300)}cancel(){this.$autocomplete.classList.remove("m-search-bar__autocomplete--is-open"),this.request&&this.request.abort()}},Drupal.behaviors.search_bar={attach(e){(e.parentNode||e).querySelectorAll(".js-search-bar").once("search-bar").forEach((e=>{new Drupal.SearchBar(e)}))}}})(Drupal)}));
/* Source and licensing information for the above line(s) can be found at https://www.consuwijzer.nl/themes/custom/consuwijzer/dist/js/patterns/molecules/search-bar/search-bar.js. */;
