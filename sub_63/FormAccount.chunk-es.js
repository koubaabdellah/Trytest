webpackJsonp([8],{246:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(9),r=i(153),o=i(158),a=i(154),n=i(240),l=i(239),u=i(155);const c="account-errors",h=document.querySelector(`[js-hook-${c}]`),m="[js-hook-form-streetname]",d="u-hidden";t.default=class FormAccount extends r.default{get formId(){return"account"}constructor(e){super(e),this.streetNameBlock=this.element.querySelector(m);let t=this.element.querySelectorAll(".form-item-UitroosterenVoorNachtelijkeUren");for(var i=0;i<t.length;i++)t[i].onclick=function(e){try{e.target.closest(".form-item__address").querySelector('[aria-controls="modal-edit-address"]').click()}catch(e){}}}onFormChange(e){"change"===e.eventType&&(o.b.telMobile(this.state.fields["account-phone"].value)?("account-phone"===e.name&&(this.inputs["GebruikersProfiel[CommunicatieViaSMS]"].value="true"),this.inputs["GebruikersProfiel[CommunicatieViaMobiel]"].value="true",this.inputs["GebruikersProfiel[TelefoonnrMobiel]"].value=this.state.fields["account-phone"].value,this.inputs["GebruikersProfiel[CommunicatieViaVast]"].value="false",this.inputs["GebruikersProfiel[TelefoonnrVast]"].value="",this.preferSpeech(this.state.fields.preferSpeechMessages.input.checked),this.inputs.hasOwnProperty("noSMSCheckbox")&&(this.inputs.noSMSCheckbox.checked="true"===this.inputs["GebruikersProfiel[CommunicatieViaVast]"].value,document.querySelector(".js-form-item-noSMSCheckbox").classList.remove(d))):o.b.telLandline(this.state.fields["account-phone"].value)&&(this.inputs["GebruikersProfiel[CommunicatieViaSMS]"].value="false",this.inputs["GebruikersProfiel[CommunicatieViaMobiel]"].value="false",this.inputs["GebruikersProfiel[TelefoonnrMobiel]"].value="",this.inputs["GebruikersProfiel[CommunicatieViaVast]"].value="true",this.inputs["GebruikersProfiel[TelefoonnrVast]"].value=this.state.fields["account-phone"].value,this.state.fields.preferSpeechMessages.input.removeAttribute("checked"),this.preferSpeech(!0),document.querySelector(".js-form-item-noSMSCheckbox").classList.add(d)),this.state.fields["GebruikersProfiel[Email]"].isValid&&(this.inputs.UserName.value=this.state.fields["GebruikersProfiel[Email]"].value),Object(l.a)(this.state,e).then(e=>!e||(this.loading=!0,Object(l.b)(this.element,this.state))).then(e=>{if(e){if(this.state.isValid&&(this.loading=!1),this.loading=!1,e.Adres){var t=e.Adres;const i=t.Gemeente,s=t.Huisnr,r=t.HuisnrToev,o=t.Plaatsnaam,a=t.Straatnaam;this.inputs["GebruikersProfiel[Adres][Straatnaam]"].value=a,this.inputs["GebruikersProfiel[Adres][Huisnr]"].value=s,this.inputs["GebruikersProfiel[Adres][HuisnrToev]"].value=r,this.inputs["GebruikersProfiel[Adres][Plaatsnaam]"].value=o,this.inputs["GebruikersProfiel[Adres][Gemeente]"].value=i,this.showStreetnameBlock(!0,`${a}, ${o}`)}}else this.loading=!1,this.disableSubmit=!0,this.showStreetnameBlock(!1)}).catch(()=>{this.loading=!1,this.disableSubmit=!0}))}onFormSubmit(){this.loading=!0,this.formSubmitTimeout&&clearTimeout(this.formSubmitTimeout),this.inputs.hasOwnProperty("noSMSCheckbox")&&o.b.telMobile(this.state.fields["account-phone"].value)&&(this.inputs["GebruikersProfiel[CommunicatieViaMobiel]"].value=this.inputs.noSMSCheckbox.checked?"true":"false",this.inputs["GebruikersProfiel[CommunicatieViaSMS]"].value="true"),this.formSubmitTimeout=setTimeout(()=>{const e=new FormData(this.element);this.changeAccountCall(e,window.EnvironmentSettings.api.changeProfile).then(e=>{e?window.location.reload():this.loading=!1})},500)}changeAccountCall(e,t){return this.loading=!0,Object(a.a)(c),e.set("method",t),e.set("GebruikersProfiel[InfoViaEmail]",this.inputs["GebruikersProfiel[InfoViaEmail]"].checked),e.delete("account-phone"),s.a.get(window.EnvironmentSettings.endpoint+Object(u.a)(e),{},!1,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(e=>this.checkRegistrationValidity(e)).catch(()=>(Object(a.b)(h,window.messages.validationRequestFailed,c),!1))}checkRegistrationValidity(e){const t=e.data;if(200===e.status&&t){if(t.success)return Object(a.a)(c),!0;if(!t.success&&t.error&&t.error.errors){const e=t.error.errors.VMVGebruikersProfiel||t.error.errors.VMeldingOfVGebruikersProfiel;if(e){const t=e.length?e.map(e=>e.Code):[e.Code],i=[];Object.keys(n.a).forEach(e=>{n.a[e].filter(e=>t.includes(e)).length&&i.push(window.messages[`validation${e}`])}),Object(a.b)(h,i,c)}return!1}return Object(a.b)(h,window.messages.validationRequestFailed,c),!1}return!1}preferSpeech(e){"false"===this.inputs["GebruikersProfiel[CommunicatieViaVast]"].value&&(this.inputs["GebruikersProfiel[CommunicatieViaMobiel]"].value=e)}showStreetnameBlock(e,t){this.streetNameBlock&&(e?(this.streetNameBlock.textContent=t,this.streetNameBlock.classList.remove(d)):this.streetNameBlock.classList.add(d))}}}});