(function(){var d=window.jQuery||window.Zepto||window.$;d.fn.fancySelect=function(g){null==g&&(g={});var h=d.extend({forceiOS:!1,includeBlank:!1,optionTemplate:function(d){return d.text()},triggerTemplate:function(d){return d.text()}},g);var k=!!navigator.userAgent.match(/iP(hone|od|ad)/i);return this.each(function(){var l;var a=d(this);if(!a.hasClass("fancified")&&"SELECT"===a[0].tagName){a.addClass("fancified");a.css({width:1,height:1,display:"block",position:"absolute",top:0,left:0,opacity:0});
a.wrap('<div class="fancy-select">');var f=a.parent();a.data("class")&&f.addClass(a.data("class"));f.append('<div class="trigger">');k&&!h.forceiOS||f.append('<ul class="options">');var c=f.find(".trigger");var e=f.find(".options");(l=a.prop("disabled"))&&f.addClass("disabled");var g=function(){var b=h.triggerTemplate(a.find(":selected"));return c.html(b)};a.on("blur.fs",function(){if(c.hasClass("open"))return setTimeout(function(){return c.trigger("close.fs")},120)});c.on("close.fs",function(){c.removeClass("open");
return e.removeClass("open")});c.on("click.fs",function(){if(!l)if(c.toggleClass("open"),k&&!h.forceiOS){if(c.hasClass("open"))return a.focus()}else{if(c.hasClass("open")){var b=c.parent();b.offsetParent();b.offset().top+b.outerHeight()+e.outerHeight()+20>d(window).height()+d(window).scrollTop()?e.addClass("overflowing"):e.removeClass("overflowing")}e.toggleClass("open");if(!k)return a.focus()}});a.on("enable",function(){a.prop("disabled",!1);f.removeClass("disabled");l=!1;return m()});a.on("disable",
function(){a.prop("disabled",!0);f.addClass("disabled");return l=!0});a.on("change.fs",function(b){return b.originalEvent&&b.originalEvent.isTrusted?b.stopPropagation():g()});a.on("keydown",function(b){var a=b.which;var d=e.find(".hover");d.removeClass("hover");if(e.hasClass("open")){if(38===a?(b.preventDefault(),d.length&&0<d.index()?d.prev().addClass("hover"):e.find("li:last-child").addClass("hover")):40===a?(b.preventDefault(),d.length&&d.index()<e.find("li").length-1?d.next().addClass("hover"):
e.find("li:first-child").addClass("hover")):27===a?(b.preventDefault(),c.trigger("click.fs")):13===a||32===a?(b.preventDefault(),d.trigger("mousedown.fs")):9===a&&c.hasClass("open")&&c.trigger("close.fs"),b=e.find(".hover"),b.length)return e.scrollTop(0),e.scrollTop(b.position().top-12)}else if(13===a||32===a||38===a||40===a)return b.preventDefault(),c.trigger("click.fs")});e.on("mousedown.fs","li",function(b){b=d(this);a.val(b.data("raw-value"));k||a.trigger("blur.fs").trigger("focus.fs");e.find(".selected").removeClass("selected");
b.addClass("selected");c.addClass("selected");return a.val(b.data("raw-value")).trigger("change.fs").trigger("blur.fs").trigger("focus.fs")});e.on("mouseenter.fs","li",function(){var a=d(this);e.find(".hover").removeClass("hover");return a.addClass("hover")});e.on("mouseleave.fs","li",function(){return e.find(".hover").removeClass("hover")});var m=function(){g();if(!k||h.forceiOS)return a.find("option"),a.find("option").each(function(a,c){c=d(c);if(!c.prop("disabled")&&(c.val()||h.includeBlank)){var b=
h.optionTemplate(c);return c.prop("selected")?e.append('<li data-raw-value="'+c.val()+'" class="selected">'+b+"</li>"):e.append('<li data-raw-value="'+c.val()+'">'+b+"</li>")}})};a.on("update.fs",function(){f.find(".options").empty();return m()});return m()}})}}).call(this);