//>>built
define("esri/urlUtils","dojo/_base/lang dojo/_base/array dojo/_base/url dojo/global dojo/io-query ./kernel ./lang ./config ./sniff dojo/i18n!./nls/jsapi".split(" "),function(l,u,r,m,v,n,w,g,x,y){var c={},p=g.defaults.io,C=/^[a-z][a-z0-9\+\-\.]*:/i,z=/^\s*http:/i,A=/^\s*https:/i,D=/:\d+$/,E=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i;c.isHTTP=function(a){var b=m.location.protocol;return null==a?"http:"===b||"https:"===b:a?"https:"===b:"http:"===b};c.getProtocolForWebResource=function(a){return c.isHTTP()?
m.location.protocol:a?"https:":"http:"};c.urlToObject=function(a){var b={},d=new r(a),e=a.indexOf("?");null===d.query?b={path:a,query:null}:(b.path=a.substring(0,e),b.query=v.queryToObject(d.query));d.fragment&&(b.hash=d.fragment,null===d.query&&(b.path=b.path.substring(0,b.path.length-(d.fragment.length+1))));return b};c.getProxyUrl=function(a,b){var d=l.isString(a)?0===l.trim(a).toLowerCase().indexOf("https:"):a,e=p.proxyUrl,f,h=y.io.proxyNotSet;l.isString(a)&&(f=c.getProxyRule(a))&&(e=f.proxyUrl);
if(!e)throw Error(h);if(d&&!1!==b&&0!==m.location.href.toLowerCase().indexOf("https:")&&(d=e,0!==d.toLowerCase().indexOf("http")&&(d=c.getAbsoluteUrl(d)),d=d.replace(/^http:/i,"https:"),c.canUseXhr(d))){e=d;var k=1}e=c.urlToObject(e);e._xo=k;return e};c.addProxy=function(a){var b=c.getProxyRule(a),d;b?d=c.urlToObject(b.proxyUrl):p.alwaysUseProxy&&(d=c.getProxyUrl());d&&(b=c.urlToObject(a),a=d.path+"?"+b.path,(d=v.objectToQuery(l.mixin(d.query||{},b.query)))&&(a+="?"+d));return a};c.addProxyRule=function(a){var b=
a.urlPrefix=c.urlToObject(a.urlPrefix).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),d=p.proxyRules,e,f=d.length,h=f;for(e=0;e<f;e++){var k=d[e].urlPrefix;if(0===b.indexOf(k)){if(b.length===k)return-1;h=e;break}else 0===k.indexOf(b)&&(h=e+1)}d.splice(h,0,a);return h};c.getProxyRule=function(a){var b=p.proxyRules,d=b.length,e=c.urlToObject(a).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase();for(a=0;a<d;a++)if(0===e.indexOf(b[a].urlPrefix)){var f=
b[a];break}return f};c.hasSameOrigin=function(a,b,d){a=a.toLowerCase();b=b.toLowerCase();var e=m.location.href.toLowerCase();a=0===a.indexOf("http")?new r(a):e=new r(e);b=0===b.indexOf("http")?new r(b):l.isString(e)?new r(e):e;return(d||a.scheme===b.scheme)&&a.host===b.host&&a.port===b.port};c.canUseXhr=function(a,b){var d=x("esri-phonegap")?!0:!1,e=c.hasSameOrigin,f=p.corsEnabledServers,h,k=-1;!d&&x("esri-cors")&&f&&f.length&&(d=u.some(f,function(t,B){var q=!t||"object"!==typeof t||t instanceof RegExp?
t:t.host;if(q instanceof RegExp){if(q.test(a))return k=B,!0}else if(q&&(h=0!==q.trim().toLowerCase().indexOf("http"),e(a,h?"http://"+q:q)||h&&e(a,"https://"+q)))return k=B,!0;return!1}));return b?k:d};c.getAbsoluteUrl=function(a){var b=c.getProtocolForWebResource();return l.isString(a)&&!C.test(a)?0===a.indexOf("//")?b+a:0===a.indexOf("/")?b+"//"+m.location.host+a:n._appBaseUrl+a:a};c.fixUrl=function(a){a=l.trim(a);a=c.getAbsoluteUrl(a);a=c.normalizeSlashes(a);a=a.replace(/^(https?:\/\/)(arcgis\.com)/i,
"$1www.$2");a=c.downgradeToHTTP(a);return a=c.upgradeToHTTPS(a)};c.normalize=function(a){return c.fixUrl(a)};c.normalizeSlashes=function(a){if(/^https?:\/\//i.test(a)){var b=a.indexOf("?");if(-1<b){var d=a.slice(0,b);var e=a.slice(b+1)}else d=a;a=d.replace(/\/{2,}/g,"/");a=a.replace("/","//");e&&(a+="?"+e)}return a};c.downgradeToHTTP=function(a){return c.isHTTP(!1)&&A.test(a)&&c.hasSameOrigin(m.location.href,a,!0)&&!c.canUseXhr(a)?a.replace(A,"http:"):a};c.upgradeToHTTPS=function(a){var b=p.httpsDomains,
d=c.isHTTP(!1),e=c.isHTTP(!0);if(!z.test(a))return a;a=l.trim(a);var f=a.indexOf("/",7);f=-1===f?a:a.slice(0,f);f=f.toLowerCase().slice(7);if(D.test(f))if(w.endsWith(f,":80"))f=f.slice(0,-3),a=a.replace(":80","");else return a;if(d&&f===m.location.host&&(!E.test(a)||!c.canUseXhr(a)))return a;d=!1;if(e&&f===m.location.host)d=!0;else if(b)for(var h=0;h<b.length;h++){var k=b[h];if(f===k||w.endsWith(f,"."+k)){d=!0;break}}d||!e||p.alwaysUseProxy||c.getProxyRule(a)||(d=!0);d&&(a=a.replace(z,"https:"));
return a};g=y.widgets.popup;var F=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,label:g.NLS_moreInfo},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"${hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"${hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,appName:"App Studio Player",label:g.NLS_openLinkInApp},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,appName:"Collector",label:g.NLS_openLinkInApp},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,appName:"Explorer",label:g.NLS_openLinkInApp},
{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,appName:"Navigator",label:g.NLS_openLinkInApp},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,appName:"Survey123",label:g.NLS_openLinkInApp},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,appName:"Trek2There",label:g.NLS_openLinkInApp},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,appName:"Workforce",label:g.NLS_openLinkInApp},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,appName:"iForm",label:g.NLS_openLinkInApp},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,
appName:"FlowFinity",label:g.NLS_openLinkInApp},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,appName:"Laserfische",label:g.NLS_openLinkInApp},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,appName:"Microsoft Power BI",label:g.NLS_openLinkInApp}];c.getURIInfo=function(a){var b;u.some(F,function(d){d.pattern.test(a)&&(b=d);return!!b});return b};c.isKnownURI=function(a){return!!c.getURIInfo(a)};c.base64UrlEncode=function(a){return btoa(String.fromCharCode.apply(null,a)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,
"")};l.mixin(n,c);n._getProxyUrl=c.getProxyUrl;n._getProxiedUrl=c.addProxy;n._hasSameOrigin=c.hasSameOrigin;n._canDoXOXHR=c.canUseXhr;n._getAbsoluteUrl=c.getAbsoluteUrl;n.fixUrl=c.fixUrl;return c});