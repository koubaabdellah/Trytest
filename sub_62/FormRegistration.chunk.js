webpackJsonp([7],{576:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(102),s=r(282),o=r(16),n=r(287),a=r(283),l=r(571),u=r(570),c=r(284),h=function(){function defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var f=document.querySelector("[js-hook-registration-errors]"),p="[js-hook-form-streetname]",m="[js-hook-mobile-speech]",d="[js-hook-landline-speech]",b="u-hidden",k="js-form-item",g="form__item--lap-active",v=function(e){function FormRegistration(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FormRegistration);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(FormRegistration.__proto__||Object.getPrototypeOf(FormRegistration)).call(this,e));return t.preferSpeechBlock=t.element.querySelector(m),t.getSpeechBlock=t.element.querySelector(d),t.streetNameBlock=t.element.querySelector(p),t.formItems=[].concat(_toConsumableArray(t.element.querySelectorAll("."+k))),o.a.$on("modal[modal-registration]::close",function(){t.steps.reset(),t.element.reset(),t.preferSpeechBlock.classList.add(b),t.getSpeechBlock.classList.add(b),t.formItems.forEach(function(e){e.classList.remove(g)}),t.streetNameBlock.parentNode.removeChild(t.streetNameBlock)}),t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(FormRegistration,s["default"]),h(FormRegistration,[{key:"formId",get:function get(){return"registration"}}]),h(FormRegistration,[{key:"onFormChange",value:function onFormChange(e){var t=this;this.steps&&!this.steps.loading&&this.steps.isValid(),"change"===e.eventType&&(n.b.telMobile(this.state.fields["registration-phone"].value)?("registration-phone"===e.name&&(this.inputs["GebruikersProfiel[CommunicatieViaSMS]"].value="true"),this.inputs["GebruikersProfiel[CommunicatieViaMobiel]"].value="true",this.inputs["GebruikersProfiel[TelefoonnrMobiel]"].value=this.state.fields["registration-phone"].value,this.inputs["GebruikersProfiel[CommunicatieViaVast]"].value="false",this.inputs["GebruikersProfiel[TelefoonnrVast]"].value="",this.showGetSpeechInput(!1),this.showPreferSpeechInput(!0),this.preferSpeech(this.state.fields.preferSpeechMessages.input.checked)):n.b.telLandline(this.state.fields["registration-phone"].value)?(this.inputs["GebruikersProfiel[CommunicatieViaSMS]"].value="false",this.inputs["GebruikersProfiel[CommunicatieViaMobiel]"].value="false",this.inputs["GebruikersProfiel[TelefoonnrMobiel]"].value="",this.inputs["GebruikersProfiel[CommunicatieViaVast]"].value="true",this.inputs["GebruikersProfiel[TelefoonnrVast]"].value=this.state.fields["registration-phone"].value,this.showGetSpeechInput(!0),this.showPreferSpeechInput(!1),this.preferSpeech(!0)):(this.showGetSpeechInput(!1),this.showPreferSpeechInput(!1),this.preferSpeech(!0)),this.state.fields["GebruikersProfiel[Email]"].isValid&&(this.inputs.UserName.value=this.state.fields["GebruikersProfiel[Email]"].value),Object(u.a)(this.state,e).then(function(e){return!e||(t.steps.loading=!0,Object(u.b)(t.element,t.state))}).then(function(e){if(e){if(t.steps.loading=!1,t.steps.disableStep=!t.steps.isValid(),e.Adres){var r=e.Adres,i=r.Gemeente,s=r.Huisnr,o=r.HuisnrToev,n=r.Plaatsnaam,a=r.Straatnaam;t.inputs["GebruikersProfiel[Adres][Straatnaam]"].value=a,t.inputs["GebruikersProfiel[Adres][Huisnr]"].value=s,t.inputs["GebruikersProfiel[Adres][HuisnrToev]"].value=o,t.inputs["GebruikersProfiel[Adres][Plaatsnaam]"].value=n,t.inputs["GebruikersProfiel[Adres][Gemeente]"].value=i,t.showStreetnameBlock(!0,a+", "+n)}}else t.steps.loading=!1,t.steps.disableStep=!0,t.showStreetnameBlock(!1)}).catch(function(e){console.log(e),t.steps.loading=!1,t.steps.disableStep=!0}))}},{key:"onFormSubmit",value:function onFormSubmit(){var e=this;this.steps.loading=!0,this.formSubmitTimeout&&clearTimeout(this.formSubmitTimeout),this.formSubmitTimeout=setTimeout(function(){var t=new FormData(e.element);e.registrationCall(t,window.EnvironmentSettings.api.registerParticipant).then(function(t){t?o.a.$trigger("form-steps[registration]::next"):e.steps.loading=!1})},500)}},{key:"registrationCall",value:function registrationCall(e,t){var r=this;return this.steps.loading=!0,Object(a.a)("registration-errors"),e.set("method",t),e.set("GebruikersProfiel[InfoViaEmail]",this.inputs["GebruikersProfiel[InfoViaEmail]"].checked),e.set("UitroosterenVoorNachtelijkeUren",this.inputs.UitroosterenVoorNachtelijkeUren.checked?"false":"true"),e.delete("registration-phone"),i.a.get(window.EnvironmentSettings.endpoint+Object(c.a)(e),{},!1,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},timeout:6e4}).then(function(e){return r.checkRegistrationValidity(e)}).catch(function(){return Object(a.b)(f,window.messages.validationRequestFailed,"registration-errors"),!1})}},{key:"checkRegistrationValidity",value:function checkRegistrationValidity(e){var t=e.data;if(200===e.status&&t){if(t.result&&t.success)return Object(a.a)("registration-errors"),!0;if(!t.success&&t.error&&t.error.errors){var r=t.error.errors.VMVGebruikersProfiel||t.error.errors.VMeldingOfVGebruikersProfiel;if(r){var i=r.length?r.map(function(e){return e.Code}):[r.Code],s=[];Object.keys(l.a).forEach(function(e){l.a[e].filter(function(e){return i.includes(e)}).length&&s.push(window.messages["validation"+e])}),Object(a.b)(f,s,"registration-errors")}return!1}return Object(a.b)(f,window.messages.validationRequestFailed,"registration-errors"),!1}return!1}},{key:"showPreferSpeechInput",value:function showPreferSpeechInput(e){var t=[].concat(_toConsumableArray(this.preferSpeechBlock.querySelectorAll("input")));e?(this.preferSpeechBlock.classList.remove(b),t.forEach(function(e){e.removeAttribute("disabled")})):(this.preferSpeechBlock.classList.add(b),t.forEach(function(e){e.setAttribute("disabled","")}))}},{key:"showGetSpeechInput",value:function showGetSpeechInput(e){e?this.getSpeechBlock.classList.remove(b):this.getSpeechBlock.classList.add(b)}},{key:"preferSpeech",value:function preferSpeech(e){"false"===this.inputs["GebruikersProfiel[CommunicatieViaVast]"].value&&(this.inputs["GebruikersProfiel[CommunicatieViaMobiel]"].value=e)}},{key:"showStreetnameBlock",value:function showStreetnameBlock(e,t){this.streetNameBlock&&(e?(this.streetNameBlock.textContent=t,this.streetNameBlock.classList.remove(b)):this.streetNameBlock.classList.add(b))}}]),FormRegistration}();t.default=v}});