// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.41/esri/copyright.txt for details.
// See https://www.arcgis.com/home/copyright.txt for further details.
//>>built
/*
 *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
*****************************************************************************/
require({cache:{"arcgisonline/sharing/dijit/AccountLinker_":function(){define("require exports tslib arcgisonline/telemetry arcgisonline/esriGeowConfig arcgisonline/pages/utils/signin dijit/_WidgetBase dijit/_WidgetsInTemplateMixin dijit/_TemplatedMixin dojo/debounce dojo/dom-construct dojo/dom-attr dojo/on dojo/string dojo/_base/kernel dojo/_base/config dojo/Deferred dojo/dom-style dojo/dom-class dojo/query dojo/Stateful dojo/_base/fx dojo/request/xhr esri/config esri/arcgis/Portal esri/IdentityManager esri/arcgis/OAuthInfo esri/request ../../tsutils/declareDecorator dojo/i18n!../../nls/arcgisonline dojo/text!./templates/AccountLinker.html ../../pages/utils/queryHandler".split(" "),
function(G,A,z,g,l,v,t,y,p,q,n,F,O,H,V,P,w,I,m,D,B,K,M,R,c,b,e,f,u,C,L,Q){g=z.__importDefault(g);l=z.__importDefault(l);v=z.__importDefault(v);t=z.__importDefault(t);y=z.__importDefault(y);p=z.__importDefault(p);q=z.__importDefault(q);n=z.__importDefault(n);F=z.__importDefault(F);O=z.__importDefault(O);H=z.__importDefault(H);V=z.__importDefault(V);P=z.__importDefault(P);w=z.__importDefault(w);I=z.__importDefault(I);m=z.__importDefault(m);D=z.__importDefault(D);B=z.__importDefault(B);K=z.__importDefault(K);
M=z.__importDefault(M);R=z.__importDefault(R);c=z.__importDefault(c);b=z.__importDefault(b);e=z.__importDefault(e);f=z.__importDefault(f);u=z.__importDefault(u);C=z.__importDefault(C);L=z.__importDefault(L);Q=z.__importStar(Q);var S=function(){function k(a){this.active=null;if(null===a||void 0===a?0:a.active)this.active=a.active}return k=z.__decorate([u["default"](B["default"])],k)}(),U=function(){function k(a){this.account=this.active=null;if(null===a||void 0===a?0:a.active)this.active=a.active;
if(null===a||void 0===a?0:a.account)this.account=a.account}return k=z.__decorate([u["default"](B["default"])],k)}(),N=b["default"];return function(){function k(a,d){this.templateString=L["default"];this.widgetsInTemplate=!0;this.baseClass="accountSwitcherContent";this.i18n=C["default"].accountSwitcher;this.defaultRedirectPath="/home/accountswitcher-callback.html";this.accountsPerPage=10;this.maxNumberOfAccounts=100;this.numberOfSignedInAccounts=0;this.successIcon='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"32" height\x3d"32" fill\x3d"#5a9359" viewBox\x3d"0 0 32 32" class\x3d"svg-icon green-icon"\x3e\x3cpath d\x3d"M27.8,16c0,6.5-5.3,11.8-11.8,11.8S4.2,22.5,4.2,16S9.5,4.2,16,4.2S27.8,9.5,27.8,16z M21.7,10l-8,8l-3.2-3.2 l-1.8,1.8l5,5l9.8-9.8C23.5,11.8,21.7,10,21.7,10z"/\x3e\x3c/svg\x3e';
this.warningIcon='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"32" height\x3d"32" fill\x3d"#d17e21" viewBox\x3d"0 0 32 32" class\x3d"svg-icon yellow-icon"\x3e\x3cpath d\x3d"M25.5,26.4c0.8,0,1.5-0.7,1.5-1.5c0-0.2-0.1-0.5-0.2-0.7L17.1,4.8c-0.4-0.8-1.3-1.1-2-0.7 c-0.3,0.1-0.5,0.4-0.7,0.7L4.7,24.2c-0.2,0.5-0.2,1,0.1,1.5C5,26.2,5.5,26.4,6,26.4H25.5L25.5,26.4z M6,24.9l9.7-19.4l9.7,19.4H6 L6,24.9z M14.2,12.1c0-0.5,0.4-0.9,0.9-0.9h1.2c0.5,0,0.9,0.4,0.9,0.9c0,0,0,0,0,0v5.8c0,0.5-0.4,0.9-0.9,0.9h0h-1.2 c-0.5,0-0.9-0.4-0.9-0.9l0,0C14.2,17.9,14.2,12.1,14.2,12.1z M17.3,22.5c0,0.5-0.4,0.9-0.9,0.9h-1.2c-0.5,0-0.9-0.4-0.9-0.9v-1.2 c0-0.5,0.4-0.9,0.9-0.9h1.2c0.5,0,0.9,0.4,0.9,0.9V22.5z"/\x3e\x3c/svg\x3e';
this.errorIcon='\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"32" height\x3d"32" fill\x3d"#de2900" viewBox\x3d"0 0 32 32" class\x3d"svg-icon red-icon"\x3e\x3cpath d\x3d"M14.5,10.9c0-0.5,0.4-0.9,0.9-0.9h1.2c0.5,0,0.9,0.4,0.9,0.9v5.7c0,0.5-0.4,0.9-0.9,0.9h-1.2 c-0.5,0-0.9-0.4-0.9-0.9C14.5,16.6,14.5,10.9,14.5,10.9z M17.5,19.9c0-0.5-0.4-0.9-0.9-0.9h-1.2c-0.5,0-0.9,0.4-0.9,0.9v1.2 c0,0.5,0.4,0.9,0.9,0.9h1.2c0.5,0,0.9-0.4,0.9-0.9V19.9z M27.8,16c0,6.5-5.3,11.8-11.8,11.8C9.5,27.8,4.2,22.5,4.2,16 S9.5,4.2,16,4.2C22.5,4.2,27.8,9.5,27.8,16z M25.9,16c0-5.5-4.5-9.9-9.9-9.9S6.1,10.5,6.1,16s4.5,9.9,9.9,9.9S25.9,21.5,25.9,16z"/\x3e\x3c/svg\x3e'}
k.prototype.postMixInProperties=function(){this.inherited(arguments);R["default"].defaults.io.corsEnabledServers.push("http://"+location.host);R["default"].defaults.io.corsEnabledServers.push("https://"+location.host);R["default"].defaults.io.proxyUrl=l["default"].proxyServer;this.oAuthDfd=new w["default"];this.signInStatus={};this.state={};this.arrayOfAccountsToUnlink=[];this.linkedAccounts=[];this.originsSent=[];this.originsReceived=[];this.originsSignedIn=[]};k.prototype.postCreate=function(){var a=
this;this.portal=new c["default"].Portal(l["default"].restBaseUrl.replace("http://","https://"));this.setHashResponseVariables();v["default"].checkSignInStatus().then(function(d){if(d||a.currentCredential){d&&(a.currentCredential=d);try{a.portal.signIn().then(function(h){l["default"].self=a.portal;a.portalUser=h;a.clientValues.signout?(a.setEventHandlers(),a.fetchAccountsForUser(d.userId,d.token,1,a.maxNumberOfAccounts).then(a.buildSignedInList.bind(a))):a.init()},a.initDefaultSignout)}catch(h){a.signInIfNoCurrentUser()}}else a.clientValues.signout?
(a.setEventHandlers(),a.initDefaultSignout()):a.signInIfNoCurrentUser()},function(d){"IdentityManagerBase.6"===d.code?a.signInIfNoCurrentUser():a.evtConnect=a.portal.on("load",function(){l["default"].self=a.portal;a.evtConnect.remove();a.init()})})};k.prototype.getCredential=function(){var a,d=V["default"].locale,h="";this.portalServer=h=(null===(a=l["default"].self)||void 0===a?0:a.portalHostname)?"https://"+l["default"].self.portalHostname:l["default"].restBaseUrl.substring(0,l["default"].restBaseUrl.indexOf("/sharing/rest")).replace("http://",
"https://");a=new e["default"]({appId:"arcgisonline",portalUrl:h,locale:d,popup:!1});N.registerOAuthInfos([a]);N.useSignInPage=!1;return N.getCredential(this.getIdMgmrServer(h),{prompt:!1})};k.prototype.init=function(){this.localStorageAvailable=this.checkIfLocalStorageIsAvailable();this.setHashResponseVariables();this.setupTextAndInterface();this.validateClientUri();this.telemetry=g["default"].init({config:l["default"].self});if(this.portalUser)return this.initAccountSwitcher();this.clientValues.signout?
this.redirectToClientUri():this.signInIfNoCurrentUser()};k.prototype.initAccountSwitcher=function(){var a=this;this.fetchLinkedAccounts(this.accountsPerPage,1).then(function(d){a.totalLinkedAccounts=d.total;a.linkedAccounts=d.linkedUsers;a.accountAccess=a.generateAccessObject(d.linkedUsers);a.onLastPageOfAccounts=a.totalLinkedAccounts<=a.accountsPerPage;a.setEventHandlers();a.setStates();if(a.clientValues.signout&&0===a.totalLinkedAccounts)return a.initDefaultSignout();a.clientValues.signout&&a.checkSignInStatusForAccounts(a.linkedAccounts);
a.totalLinkedAccounts>=a.maxNumberOfAccounts&&a.lockLinkAccountButton();a.setupInterfaceForRightToLeft();a.clientValues.signout?a.initSignout():a.initAccountLinker()})};k.prototype.fetchLinkedAccounts=function(a,d){var h=l["default"].restBaseUrl.replace("http://","https://");h+="community/users/"+this.portalUser.username+"/linkedUsers";return f["default"]({url:h,content:{f:"json",num:a,start:d}})};k.prototype.generateAccessObject=function(a){var d=this;void 0===a&&(a=[]);var h={numberOfUsersWithAccess:0,
users:{}};a.forEach(function(E){var x=!E.disabled;x&&(d.clientValues.usersToFilter||(d.clientValues.usersToFilter=[]),x=E.clientAppAccessAllowed&&-1===d.clientValues.usersToFilter.indexOf(E.username));x&&"esriapps"===d.clientValues.clientId&&(x="both"===E.userType);x&&d.clientValues.accountsToFilter&&(x="org"===d.clientValues.accountsToFilter?!E.orgName:!!E.orgName);h.numberOfUsersWithAccess+=x?1:0;h.users[E.username]=x});return h};k.prototype.setEventHandlers=function(){this.clientValues.signout||
(O["default"](this.cancelUnlinkAccountsBtn,"click, keyup",this.toggleUnlinkAccounts.bind(this)),O["default"](this.unlinkAccountsBtn,"click, keyup",this.toggleUnlinkAccounts.bind(this)),O["default"](this.linkAccountsBtn,"click, keyup",this.clickLinkAccounts.bind(this)),O["default"](this.unlinkAccountBtn,"click, keyup",this.deleteLinkedAccount.bind(this)),O["default"](this.signoutCheckbox,"click, keyup",this.clickSignoutCheckbox.bind(this)),O["default"](this.accountListContainer,"scroll",q["default"](this.fetchAccountsOnScroll.bind(this),
18)),this.hashChangeErrorListener=O["default"](window,"hashchange",this.errorHashChange.bind(this)));O["default"](this.closeAccountSwitcher,"click, keyup",this.closeWindow.bind(this));O["default"](this.closePushNotification,"click, keyup",this.closeAlertNotification.bind(this));O["default"](this.signoutOfAllAccountsBtn,"click, keyup",this.signoutOfAllAccounts.bind(this));O["default"](this.cancelSignoutBtn,"click, keyup",this.redirectToClientUri.bind(this));window.addEventListener("message",this.handleOrgUserCred.bind(this));
window.addEventListener("message",this.signInMessageListener.bind(this))};k.prototype.buildSignedInList=function(a){var d=this,h=a.linkedUsers;a=a.total;(null===h||void 0===h?0:h.length)?(this.totalLinkedAccounts=a,this.linkedAccounts=h,this.accountAccess=this.generateAccessObject(h),this.onLastPageOfAccounts=!0,this.linkedAccounts.forEach(function(E){d.initCheckSignInStatus(E)})):this.signOutOfCurrentAccount(!0,!0)};k.prototype.toggleUnlinkAccounts=function(a){a&&a.stopImmediatePropagation();if(!a||
this.verifyKeyPress(a.key))this.state.unlink.active?(this.showAndEnableTabindex([this.linkAccountsBtn,this.unlinkAccountsBtn]),this.unlinkAccountsBlockGroup.classList.add("hide"),this.setTabIndexTo([this.unlinkAccountBtn,this.cancelUnlinkAccountsBtn],"-1"),this.unlinkAccountBtn.classList.add("btn-disabled"),this.unCheckAllBoxes(),this.windowTitle.innerHTML=this.windowTitleText,this.state.unlink.set("active",!1)):(this.hideAndDisableTabindex([this.linkAccountsBtn,this.unlinkAccountsBtn]),this.unlinkAccountsBlockGroup.classList.remove("hide"),
this.setTabIndexTo([this.unlinkAccountBtn,this.cancelUnlinkAccountsBtn],"0"),this.windowTitle.innerHTML=this.i18n.selectAccountsToUnlink,this.state.unlink.set("active",!0))};k.prototype.checkBox=function(a,d){a.classList.remove("not-visible");a.parentElement.classList.add("circle-checkbox-checked");d.classList.add("row-is-checked");a.parentElement.setAttribute("aria-checked","true")};k.prototype.unCheckBox=function(a,d){a.parentElement.classList.remove("circle-checkbox-checked");d.classList.remove("row-is-checked");
a.parentElement.setAttribute("aria-checked","false");a.classList.add("not-visible")};k.prototype.unCheckAllBoxes=function(){this.arrayOfAccountsToUnlink=[];this.domNode.querySelectorAll(".circle-checkbox-checked").forEach(function(a){a.parentElement.parentElement.parentElement.classList.remove("row-is-checked");a.classList.remove("circle-checkbox-checked");a.childNodes[0].classList.add("not-visible")})};k.prototype.showAndEnableTabindex=function(a){a.forEach(function(d){d.classList.remove("hide");
d.setAttribute("tabindex","0")})};k.prototype.setTabIndexTo=function(a,d){a.forEach(function(h){h.setAttribute("tabindex",d)})};k.prototype.hideAndDisableTabindex=function(a){a.forEach(function(d){d.classList.add("hide");d.setAttribute("tabindex","-1")})};k.prototype.clickLinkAccounts=function(a){var d=this;if(!a||this.verifyKeyPress(a.key)){a.preventDefault();this.hashChangeListener&&this.hashChangeListener.remove();this.telemetry.logEvent({category:"account switcher",action:"start",label:"link accounts"});
this.hashChangeListener=O["default"](window,"hashchange",this.linkAccountHashChange.bind(this));var h="https://"+this.portal.portalHostname+"/sharing/rest/oauth2/authorize";this.getAuthorizeParameters().then(function(E){E.linkUserRequest=!0;E.parent=d.getSecureAccountBaseUrl(d.portal.urlKey);E.showSocialLogins=!0;E.hideEnterpriseLogins=!1;E.force_login=!0;E.redirect_uri=l["default"].baseUrl+"pages/Account/link_account_callback.html";h=h+"?"+Q.objectToQuery(E);d.generateCenteredWindow(h,"LinkAccount")})}};
k.prototype.getAuthorizeParameters=function(){var a=new w["default"],d=N.findOAuthInfo("https://"+this.portal.portalHostname),h=d._oAuthCred,E={client_id:d.appId,response_type:(null===h||void 0===h?0:h.codeVerifier)?"code":"token",expiration:d.expiration,locale:d.locale,display:"default"};d.forceLogin&&(E.force_login=!0);d.forceUserId&&d.userId&&(E.prepopulatedusername=d.userId);if(null===h||void 0===h?0:h.codeVerifier)return this.getCodeChallenge(h.codeVerifier).then(function(x){x?(E.code_challenge=
x,E.code_challenge_method="S256"):(E.code_challenge=h.codeVerifier,E.code_challenge_method="plain");return E});a.resolve(E);return a};k.prototype.linkAccountHashChange=function(){this.hashChangeListener.remove();if("#canceled"===window.location.hash)return this.resetUrlHash();var a=this.retrieveHashAsObject();this.resetUrlHash();if(a.username===this.portalUser.username)return a=this.i18n.youAreCurrentlySignedInto+" "+this.boldText(a.username),this.generateAccessibleNotification(this.warningIcon,a,
"yellow");if(this.userIsAlreadyLinked(a.username))return this.alertToDuplicateAccount(a.username);a.username&&!a.error&&(this.activateLoadingState(),this.fetchAndLinkNewAccounts(a))};k.prototype.fetchAndLinkNewAccounts=function(a){var d=this,h=a.username,E=a.access_token,x=a.expires_in,r={userId:h,token:E,ssl:"true"===a.ssl,expires:Date.now()+1E3*Number(x)};this.fetchAccountsForUser(h,E,1).then(function(J){var T=d.linkedAccounts.map(function(X){return X.username});T=0<J.total?-1===T.indexOf(J.linkedUsers[0].username):
!0;0<J.total&&T?d.showLinkAccountsDialog(r,J):d.linkAndCreateNewAccount(r,J.total,T)})};k.prototype.linkAndCreateNewAccount=function(a,d,h){var E=this;this.linkNewAccount(a.userId,a.token).then(function(x){if(x&&x.success){var r=0<d?E.accountsPerPage+1:1;E.fetchLinkedAccounts(r,1).then(function(J){E.state.tutorial.active&&0<J.linkedUsers.length&&E.state.tutorial.set("active",!1);r>E.accountsPerPage&&E.emptyAndResetAccountLists();E.linkedAccounts=E.linkedAccounts.concat(J.linkedUsers);a.server=E.getIdMgmrServer(J.linkedUsers[0].orgUrlKey);
N.registerToken(a);E.updateAccessObject(J.linkedUsers);0<E.accountAccess.numberOfUsersWithAccess&&E.accountsUlElement.classList.remove("no-accounts-with-access");E.totalLinkedAccounts=J.total;E.createLinkedAccountRows(J.linkedUsers,"first");E.alertToLinkedAccount(J.linkedUsers);E.deactivateLoadingState();E.totalLinkedAccounts>=E.maxNumberOfAccounts&&E.lockLinkAccountButton()})}else E.deactivateLoadingState()})};k.prototype.disableButtons=function(a,d){var h=d?"add":"remove";a.forEach(function(E){E.classList[h]("btn-disabled")})};
k.prototype.activateLoadingState=function(){var a=this;this.accountLoaderTimer=window.setTimeout(function(){a.disableButtons([a.cancelUnlinkAccountsBtn,a.linkAccountsBtn,a.unlinkAccountsBtn],!0);a.unlinkAccountsUlElement.classList.add("disabled-for-loading");a.accountsUlElement.classList.add("disabled-for-loading");a.accountRequestLoader.classList.add("is-active");a.accountRequestLoader.classList.remove("hide")},700)};k.prototype.deactivateLoadingState=function(){clearTimeout(this.accountLoaderTimer);
this.disableButtons([this.cancelUnlinkAccountsBtn,this.linkAccountsBtn,this.unlinkAccountsBtn],!1);this.unlinkAccountsUlElement.classList.remove("disabled-for-loading");this.accountsUlElement.classList.remove("disabled-for-loading");this.accountRequestLoader.classList.remove("is-active")};k.prototype.alertToLinkedAccount=function(a){var d=this.generateAccessObject(a),h=this.boldText(this.newLinkedUser)+this.i18n.hasBeenSuccessfully;h+=this.boldText(this.i18n.linkedPer);1<a.length&&(h=this.i18n.successfully+
" "+this.boldText(this.i18n.linked)+this.boldText(this.newLinkedUser),h+=" "+this.i18n.andAccountsLinkedToIt);d.numberOfUsersWithAccess===this.linkedAccounts.length||1===a.length&&d.users[a[0].username]?this.generateSuccessNotification(this.successIcon,h,"green"):1!==a.length||d.users[a[0].username]?a.filter(function(E){return d.users[E.username]}).length<a.length&&(h=h+" "+this.i18n.howeverSomeAccountsDoNotHaveAccess,this.generateAccessibleNotification(this.warningIcon,h,"yellow")):(h=h+" "+this.i18n.howeverTheAccountDoesNotHaveAccess,
this.generateAccessibleNotification(this.warningIcon,h,"yellow"))};k.prototype.generateSuccessNotification=function(a,d,h){var E=this;this.resetNoticationElementTo("-1","green",this.successIcon,d);K["default"].animateProperty({duration:300,node:this.topNotificationPanel,properties:{"margin-top":{end:16,start:-6},opacity:1},onEnd:function(){E.fadeNotification=K["default"].anim(E.topNotificationPanel,{opacity:0,"margin-top":{end:-6,start:16}},300,void 0,void 0,5E3).play()}}).play()};k.prototype.emptyAndResetAccountLists=
function(){this.linkedAccounts=[];this.onLastPageOfAccounts=!1;this.accountAccess={numberOfUsersWithAccess:0,users:{}};n["default"].empty(this.accountsUlElement);n["default"].empty(this.unlinkAccountsUlElement)};k.prototype.linkNewAccount=function(a,d){this.telemetry.logEvent({category:"account switcher",action:"finish",label:"link accounts"});var h={f:"json",user:a,userToken:d};this.newLinkedUser=a;var E=l["default"].restBaseUrl.replace("http://","https://")+"community/users/"+this.portalUser.username+
"/linkUser";return f["default"]({url:E,content:h},{usePost:!0}).then(this.linkAccountSuccess.bind(this),this.linkAccountError.bind(this,a))};k.prototype.linkAccountSuccess=function(a){a.success&&(this.accountListContainer.scrollTop=0);return a};k.prototype.linkAccountError=function(a,d){if("COM_1093"===d.messageCode)return this.alertToDuplicateAccount(a);this.alertToLinkAccountFailure();return d};k.prototype.alertToLinkAccountFailure=function(){this.generateAccessibleNotification(this.errorIcon,this.i18n.error.linkAccount,
"red")};k.prototype.alertToDuplicateAccount=function(a){a=this.boldText(a||this.newLinkedUser)+this.i18n.isAlreadyLinked;this.generateAccessibleNotification(this.warningIcon,a,"yellow")};k.prototype.showLinkAccountsDialog=function(a,d){this.linkAccountModal?(n["default"].empty(this.linkAccountModalContent),this.createLinkAccountModalContent(a,d.linkedUsers,this.linkAccountModalContent)):(this.linkAccountDialogAccountList=d.linkedUsers,this.linkAccountDialogAccountTotal=d.total,this.linkAccountModal=
this.createAcceptLinkAccountModal(a,d.linkedUsers));this.linkAccountModal.classList.add("is-active")};k.prototype.createAcceptLinkAccountModal=function(a,d){var h=n["default"].create,E=h("div",{"class":"modal-overlay z-index-a-thousand","data-modal":"linkAccountDialog"},this.containerNode),x=h("div",{"class":"modal-content column-12",role:"dialog","aria-labelledby":this.i18n.linking+" "+a.userId+" "+this.i18n.willAlsoLinkTheFollowing},E);h("a",{"class":"right icon-ui-close",href:"","aria-label":"close-modal",
tabindex:"0",onkeyup:this.cancelLinkAccountDialog.bind(this),onclick:this.cancelLinkAccountDialog.bind(this)},x);this.createLinkAccountModalContent(a,d,x);return E};k.prototype.createLinkAccountModalContent=function(a,d,h){var E=a.userId,x=n["default"].create;this.linkAccountModalContent=x("div",null,h);x("p",{"class":"trailer-half font-size-1",innerHTML:this.i18n.linking+" "+this.boldText(E)+" "+this.i18n.willAlsoLinkTheFollowing},this.linkAccountModalContent);this.ulElementForLinkAccountDialog=
x("ul",{"class":"list-plain link-accounts-dialog-ul",onscroll:this.onScrollLinkAccountModal.bind(this,a)},this.linkAccountModalContent);this.createAccountsForLinkAccountDialog(d);h=x("div",{"class":"text-right block-group block-group-2-up tablet-block-group-2-up phone-block-group-2-up display-block"},this.linkAccountModalContent);x("a",{href:"","class":"btn btn-fill block",innerHTML:this.i18n.linkAccounts,tabindex:"0",onkeyup:this.acceptLinkAccountDialog.bind(this,a,d.length),onclick:this.acceptLinkAccountDialog.bind(this,
a,d.length)},h);x("a",{"class":"btn btn-clear btn-fill block",href:"",innerHTML:this.i18n.cancel,tabindex:"0",onkeyup:this.cancelLinkAccountDialog.bind(this),onclick:this.cancelLinkAccountDialog.bind(this)},h)};k.prototype.createAccountsForLinkAccountDialog=function(a){var d=this;a.forEach(function(h){var E=n["default"].create("li",{"class":"account-row-link link-accounts-dialog-li default-cursor"},d.ulElementForLinkAccountDialog);d.createUserAccountDiv(h,E)})};k.prototype.onScrollLinkAccountModal=
function(a,d,h){var E=this;this.fetchingAccounts||this.linkAccountDialogAccountList.length===this.linkAccountModalTotal||(h=h.target,h.offsetHeight+h.scrollTop>h.scrollHeight-16&&(this.fetchingAccounts=!0,this.fetchAccountsForUser(a,d,this.linkAccountDialogAccountList.length+1).then(function(x){E.linkAccountDialogAccountList=E.linkAccountDialogAccountList.concat(x.linkedUsers);E.linkAccountDialogAccountTotal=x.total;E.createAccountsForLinkAccountDialog(x.linkedUsers);E.fetchingAccounts=!1})))};k.prototype.acceptLinkAccountDialog=
function(a,d,h){h.preventDefault();this.verifyKeyPress(h.key)&&(this.linkAccountModal.classList.remove("is-active"),this.linkAndCreateNewAccount(a,d,!0))};k.prototype.cancelLinkAccountDialog=function(a){a.preventDefault();this.verifyKeyPress(a.key)&&(this.linkAccountModal.classList.remove("is-active"),this.deactivateLoadingState())};k.prototype.fetchAccountsForUser=function(a,d,h,E){return f["default"]({url:"https://"+this.portal.portalHostname+"/sharing/rest/community/users/"+a+"/linkedUsers",content:{f:"json",
token:d,num:E||this.accountsPerPage,start:h||1}})};k.prototype.userIsAlreadyLinked=function(a){return this.linkedAccounts.some(function(d){return d.username===a})};k.prototype.boldText=function(a){return" \x3cb\x3e"+a+"\x3c/b\x3e "};k.prototype.retrieveHashAsObject=function(){return Q.queryToObject(window.location.hash.substring(1))};k.prototype.generateCenteredWindow=function(a,d){var h,E,x=null!==(h=window.screenLeft)&&void 0!==h?h:0;h=null!==(E=window.screenTop)&&void 0!==E?E:0;(E=window.open(a,
d,"scrollbars\x3dno, width\x3d582, height\x3d670, top\x3d"+((window.innerHeight||document.documentElement.clientHeight||screen.height)/2-335+h)+", left\x3d"+((window.innerWidth||document.documentElement.clientWidth||screen.width)/2-291+x)))&&window.focus&&E.focus()};k.prototype.fetchAccountsOnScroll=function(a){this.onLastPageOfAccounts||this.fetchingAccounts||(a=a.target,a.offsetHeight+a.scrollTop>a.scrollHeight-16&&this.fetchAndCreateNextPageOfAccounts())};k.prototype.errorHashChange=function(a){var d=
this;a=this.retrieveHashAsObject();a.error&&(this.resetUrlHash(),a.error_description&&this.parseOAuthErrorMessage(a.error_description).then(function(h){d.generateAccessibleNotification(d.errorIcon,d.i18n.oauth[h]||d.i18n.oauth.defaultError,"red");d.deactivateLoadingState()}))};k.prototype.parseOAuthErrorMessage=function(a){var d=new w["default"];a=a.replace(/\./g," ").split(" ").slice(0,8).map(function(h,E){return(0===E?h.charAt(0).toLowerCase():h.charAt(0).toUpperCase())+h.slice(1).toLowerCase().replace(".",
"").replace(",","")}).join("").trim();return d.resolve(a)};k.prototype.incrementNumberOfAccountsSignedIn=function(){this.numberOfSignedInAccounts+=1;this.clientValues.signout&&(this.topTutorialPanel.innerHTML=this.i18n.youAreSignedInto+" \x3cspan class\x3d'signed-in-number'\x3e"+(String(this.numberOfSignedInAccounts)+"\x3c/span\x3e ")+this.i18n.other+" "+(1<this.numberOfSignedInAccounts?this.i18n.accounts:this.i18n.account),1===this.numberOfSignedInAccounts&&(clearTimeout(this.insertSignedOutOfAllMessage),
m["default"].remove(this.signoutOfAllAccountsBtn,"hide"),m["default"].remove(this.cancelSignoutBtn,"margin-top-zero"),m["default"].replace(this.cancelSignoutBtn,"btn-transparent","btn-clear")))};k.prototype.setStates=function(){this.setupUnlinkState();this.setupTutorialState()};k.prototype.setupUnlinkState=function(){var a=this;this.state.unlink=new U({active:!1});this.state.unlink.watch("active",function(d,h,E){E?(a.telemetry.logEvent({category:"account switcher",action:"start",label:"unlink accounts"}),
a.accountsUlElement.classList.add("hide"),a.unlinkAccountsUlElement.classList.remove("hide"),a.topTutorialPanel.classList.add("not-visible"),a.signoutCheckboxWrapper.classList.add("hide")):(a.accountsUlElement.classList.remove("hide"),a.unlinkAccountsUlElement.classList.add("hide"),a.topTutorialPanel.classList.remove("not-visible"),a.signoutCheckboxWrapper.classList.remove("hide"),a.state.tutorial.active||a.accountAccess.numberOfUsersWithAccess!==a.linkedAccounts.length||(a.topTutorialPanel.innerHTML=
a.i18n.chooseAnAccount))})};k.prototype.setupTutorialState=function(){var a=this;this.state.tutorial=new S({active:!1});this.state.tutorial.watch("active",function(d,h,E){E?(a.linkAccountsBtn.classList.remove("btn-clear"),a.linkAccountsBtn.classList.remove("btn-half"),a.accountSwitcherWrapper.classList.add("no-linked-accounts"),a.topTutorialPanel.classList.remove("not-visible"),a.signoutCheckboxWrapper.classList.add("hide"),a.windowTitle.innerHTML=a.i18n.linkAccounts,a.topTutorialPanel.innerHTML=
a.i18n.switchAccountsTutorialMsg):(a.accountsContainer.style.height="",a.linkAccountsBtn.classList.add("btn-clear"),a.accountSwitcherWrapper.classList.remove("no-linked-accounts"),a.unlinkAccountsBtn.classList.remove("not-visible"),a.unlinkAccountsBtn.classList.remove("hide"),a.unlinkAccountsBtn.classList.remove("btn-disabled"),a.windowTitle.innerHTML=a.windowTitleText,a.topTutorialPanel.innerHTML=a.i18n.chooseAnAccount)})};k.prototype.checkSignInStatusForAccounts=function(a){var d=this;a.every(function(h){if(d.signedOutOfCurrentAccount)return!1;
d.initCheckSignInStatus(h);return!d.clientValues.signout})};k.prototype.userIsSignedIntoOrigin=function(a){var d=this.getSecureAccountBaseUrl(a.orgUrlKey).toLowerCase();a=a.username;return this.recentLinkedUsers&&this.recentLinkedUsers[a.toLowerCase()]?!0:this.signInStatus[d]?this.signInStatus[d][a]&&this.signInStatus[d][a].signedIn:!1};k.prototype.setUserRowToSignedIn=function(a,d){var h=this.getSecureAccountBaseUrl(a.orgUrlKey).toLowerCase();h=this.signInStatus[h][a.username].row;this.createSignedInDot(d||
h)};k.prototype.initCheckSignInStatus=function(a,d){var h,E=this.getSecureAccountBaseUrl(a.orgUrlKey).toLowerCase(),x=N.findCredential(this.getIdMgmrServer(a.orgUrlKey),a.username);this.signInStatus[E]?this.signInStatus[E][a.username]||(this.signInStatus[E][a.username]={provider:a.provider,row:d||null,signedIn:!!x}):this.signInStatus[E]=(h={},h[a.username]={provider:a.provider,row:d||null,signedIn:!!x},h);x||-1!==this.originsSent.indexOf(E)||(this.originsSent.push(E),n["default"].create("iframe",
{id:"iframe__for-"+E,src:E+"/home/pages/Account/check_sign_in_status.html#state\x3d"+JSON.stringify({origin:this.getOriginOfUrl(),server:E,orgKey:E}),"class":"hidden-iframe"},document.body))};k.prototype.handleOrgUserCred=function(a){a="string"===typeof a.data?JSON.parse(a.data):a.data;if(a.signout)this.handleSuccessfulSignout(a);else if(a.orgKey){-1===this.originsReceived.indexOf(a.orgKey)&&(this.originsReceived.push(a.orgKey),document.body.removeChild(document.getElementById("iframe__for-"+a.orgKey)));
if(a.success&&this.signInStatus[a.orgKey]){this.originsSignedIn.push(a.orgKey);var d=this.signInStatus[a.orgKey][a.userId];d&&!d.signedIn&&(d.signedIn=!0,a.server=this.getIdMgmrServer(a.server||a.orgKey),N.registerToken(a),this.incrementNumberOfAccountsSignedIn(),this.clientValues.signout||this.createSignedInDot(d.row))}else if(a.removed&&this.originsSent.length===this.originsReceived.length){a=this.clientValues.signoutRedirect||this.clientValues.callbackPage||l["default"].baseUrl+"index.html";"iframe"===
this.clientValues.display?window.parent.location.href=a:window.location.href=a;return}this.signOutIfAllOriginsAreProcessed()}};k.prototype.getSecureAccountBaseUrl=function(a){var d;return a&&0===a.indexOf("https")?a:a&&(null===(d=this.portal)||void 0===d?0:d.customBaseUrl)?"https://"+a+"."+this.portal.customBaseUrl:this.portal?"https://"+this.portal.portalHostname:l["default"].restBaseUrl.replace("/sharing/rest","")};k.prototype.getIdMgmrServer=function(a){return this.getSecureAccountBaseUrl(a)+"/sharing/rest"};
k.prototype.lockLinkAccountButton=function(){this.linkAccountsBtn.classList.add("btn-disabled");this.linkAccountsBtn.innerHTML="\x3cspan class\x3d'icon-ui-deny'\x3e\x3c/span\x3e"+this.i18n.maxLinkedAccountsReached};k.prototype.unlockLinkAccountButton=function(){this.linkAccountsBtn.classList.remove("btn-disabled");this.linkAccountsBtn.innerHTML="\x3cspan class\x3d'icon-ui-plus'\x3e\x3c/span\x3e"+this.i18n.linkAnAccount};k.prototype.setupInterfaceForRightToLeft=function(){l["default"].isRightToLeft&&
(this.closeAccountSwitcher.classList.remove("close-link-account-switcher"),this.closeAccountSwitcher.classList.add("close-link-account-switcher-RTL"),this.closePushNotification.classList.remove("close-link-notification"),this.closePushNotification.classList.add("close-link-notification-RTL"))};k.prototype.initAccountSwitcherFromLocalStorage=function(){this.accountAccess=this.generateAccessObject(this.linkedAccounts);this.setupInterfaceForRightToLeft();this.setEventHandlers();this.initSignout(!0)};
k.prototype.initAccountLinker=function(){this.telemetry.logEvent({category:"account switcher",action:"start",label:"switch accounts"});this.accountSwitcherWrapper.classList.remove("is-loading");this.topTutorialPanel.innerHTML=this.i18n.chooseAnAccount;this.setupDefaultDisplayAndMessages();this.state.tutorial.active||0===this.accountAccess.numberOfUsersWithAccess||(this.signoutCheckboxWrapper.classList.remove("hide"),this.keepCurrentAccountSignedIn=this.signoutCheckbox.checked);this.createCurrentAccountRow();
this.createLinkedAccountRows(this.linkedAccounts);this.fetchAccountsUntilUserCanScroll()};k.prototype.setupDefaultDisplayAndMessages=function(){if(0<this.linkedAccounts.length)if(this.state.unlink.active||m["default"].remove(this.unlinkAccountsBtn,"hide"),0===this.accountAccess.numberOfUsersWithAccess)this.displayToUserThatNoAccountsHaveAccess();else{if(this.accountAccess.numberOfUsersWithAccess<this.linkedAccounts.length){var a=this.i18n.ofYour+" "+this.totalLinkedAccounts+" "+this.i18n.linkedAccountsOnlyTheFollowing;
a+=" "+this.i18n.chooseAnAccount;this.topTutorialPanel.innerHTML=a}}else return m["default"].add(this.unlinkAccountsBtn,"btn-disabled not-visible"),this.state.tutorial.set("active",!0),!1};k.prototype.displayToUserThatNoAccountsHaveAccess=function(){this.topTutorialPanel.innerHTML=this.i18n.noneOfYour+" "+this.i18n.linkedAccountsHaveAccessTo;this.windowTitle.innerHTML=this.i18n.linkAccounts;this.accountsUlElement.classList.add("no-accounts-with-access")};k.prototype.createCurrentAccountRow=function(){var a=
n["default"].create,d="iframe"===this.clientValues.display;d=a("a",{"class":"account-row account-row-link"+(d?" default-cursor":""),tabindex:d?"-1":"0",onclick:this.closeOrRedirectWindow.bind(this,d),keyup:this.closeOrRedirectWindow.bind(this,d)},this.currentAccountLi);var h=a("div",{"class":"account-row-div"},d),E=a("div",{"class":"circle-user-icon-container"+(l["default"].isRightToLeft?" icon-container-to-right":"")},h);this.accountProviderIsSocial(this.portalUser.provider)&&a("img",{"class":"social-login-circle-large-logo"+
(l["default"].isRightToLeft?"-RTL":""),src:"./images/large_circle_"+this.portalUser.provider+".png",alt:this.i18n.signedInUsing+" "+this.portalUser.provider},d);a("span",{"class":"align-image-helper"},E);a("img",{"class":"large-circle-border-radius"+(l["default"].isRightToLeft?"-RTL":""),alt:"",src:this.getUserIconUrl(this.portalUser)},E);d=a("div",{"class":"username-container"},h);a("div",{innerHTML:this.portalUser.username,"class":"username font-size-1"},d);a("div",{innerHTML:this.portalUser.portal.name||
"\x3cbr\x3e","class":"text-darker-gray font-size--2"},d)};k.prototype.closeOrRedirectWindow=function(a,d){var h;d&&d.preventDefault();if(this.verifyKeyPress(d.key)&&!a)if(window.opener)window.close();else{var E=1<(null===(h=this.originalClientHash)||void 0===h?void 0:h.length)?-2:-1;window.history.go(E)}};k.prototype.accountProviderIsSocial=function(a){return-1<["facebook","google","github","apple"].indexOf(a)};k.prototype.getUserIconUrl=function(a){return a.thumbnailUrl?a.thumbnailUrl:a.thumbnail?
c["default"].PortalUtil.formatUrl(this.portal.portalUrl+"community/users/"+a.username+"/info/"+a.thumbnail+"?w\x3d100"):this.relativeToExplicitUrl("js/arcgisonline/css/images/no-user-thumb.jpg")};k.prototype.relativeToExplicitUrl=function(a){l["default"].cdnServerUrl=P["default"].baseUrl.substring(0,P["default"].baseUrl.indexOf("/js/"));return l["default"].cdnServerUrl.lastIndexOf("/")===l["default"].cdnServerUrl.length-1?l["default"].cdnServerUrl+a:l["default"].cdnServerUrl+"/"+a};k.prototype.createLinkedAccountRows=
function(a,d){var h=this;(d?a.reverse():a).forEach(function(E){(h.accountAccess.users[E.username]||h.portalUser.username===E.username)&&h.createAccountRow(E,d);h.clientValues.signout||h.createUnlinkAccountRow(E,d)})};k.prototype.swapSecureToken=function(a,d){window.addEventListener("message",this.swapMessageListener.bind(this));var h=this.getSecureAccountBaseUrl(d.orgUrlKey);h="https://"+this.portal.portalHostname+"/sharing/rest/oauth2/authorize/sso?client_id\x3d"+this.clientValues.clientId+"\x26token\x3d"+
a.token+"\x26redirect_uri\x3d"+h+"/home/pages/Account/secure_swap_callback.html";this.targetAccount=d;this.generateCenteredWindow(h,"Exchange Token")};k.prototype.handleSwitch=function(a,d){var h,E;d&&d.preventDefault();if(!d||this.verifyKeyPress(d.key)){this.telemetry.logEvent({category:"account switcher",action:"finish",label:"switch accounts"});var x=N.findCredential(this.getIdMgmrServer(a.orgUrlKey),a.username),r=N.findCredential(this.getIdMgmrServer(this.getSecureAccountBaseUrl(this.portal.urlKey)),
this.portalUser.username),J=l["default"].isDebug||(null===(h=this.portal.urlKey)||void 0===h?void 0:h.toLowerCase())===(null===(E=a.orgUrlKey)||void 0===E?void 0:E.toLowerCase());!r||this.keepCurrentAccountSignedIn&&!J||(this.signOutOfCurrentAccount(!1,!1),r.destroy());x&&!J?this.swapSecureToken(x,a):this.loginToAccount(a)}};k.prototype.loginToAccount=function(a){var d=this,h=this.getTypeOfAccountProvider(a.provider),E=this.getSecureAccountBaseUrl(a.orgUrlKey);this.generateBaseOAuthUrl(h,a).then(function(x){x+=
"social"===h?"\x26socialLoginProviderName\x3d"+a.provider:"";x+="\x26state\x3d"+JSON.stringify({user:a.username,server:E,portalUrl:E,origin:d.getOriginOfUrl()});x+="\x26redirect_uri\x3d"+E+"/home/pages/Account/signin_account_callback.html";d.generateCenteredWindow(x,"SignIn")})};k.prototype.getTypeOfAccountProvider=function(a){return this.accountProviderIsSocial(a)?"social":"enterprise"===a?"enterprise":-1<a.indexOf("oidc")?"oidc":"default"};k.prototype.generateBaseOAuthUrl=function(a,d,h){var E=
this,x=this.getSecureAccountBaseUrl(d.orgUrlKey).toLowerCase(),r="";switch(a){case "social":r="social/";break;case "enterprise":r="saml/";break;case "oidc":r="oidc/"+d.provider.split("_")[1]+"/"}var J=x+"/sharing/rest/oauth2/"+r+"authorize";return this.getAuthorizeParameters().then(function(T){T.socialLoginProviderName="social"===a?d.provider:void 0;T.prepopulatedusername=d.username;T.force_login=!(h||E.userIsSignedIntoOrigin(d));return J+"?"+Q.objectToQuery(T)})};k.prototype.getCallbackPageUrl=function(a){return this.getSecureAccountBaseUrl(a.orgUrlKey)+
"/home/pages/Account/callback.html?"+this.buildUriStateParams(a)};k.prototype.buildUriStateParams=function(a){var d=this.portalUser.portal.name===a.orgName||null===this.portalUser.portal.name&&void 0===a.orgName||this.keepCurrentAccountSignedIn,h="clientId\x3d"+this.clientValues.clientId;h+=this.clientValues.redirectToOrg?"\x26redirectToOrg\x3dtrue":"";h+=this.clientValues.noOAuthParams?"\x26noOAuthParams\x3dtrue":"";h+="\x26display\x3d"+("iframe"===this.clientValues.display?"iframe":"default");h+=
this.windowTitleText===this.i18n.manageAccounts?"\x26windowTitle\x3dmanageAccounts":"";a?(h+="\x26redirectUri\x3d"+encodeURIComponent(this.generateClientRedirectUri(a)),h+="\x26origin\x3d"+this.getOriginOfUrl(),h+="\x26provider\x3d"+("arcgis"===a.provider?"arcgis":"other"),h+=d||this.clientValues.signout?"":"\x26signout\x3dtrue"):h+="\x26redirectUri\x3d"+this.clientValues.callbackPage;return encodeURIComponent(h)};k.prototype.generateClientRedirectUri=function(a){var d=this.getSecureAccountBaseUrl(a.orgUrlKey);
return this.clientValues.redirectToOrg&&this.clientValues.callbackPage&&a.clientAppAccessAllowed?(a=document.createElement("a"),a.href=this.clientValues.callbackPage,d+("/"===a.pathname[0]?a.pathname:"/"+a.pathname)):this.clientValues.callbackPage&&a.clientAppAccessAllowed?this.clientValues.callbackPage:d+this.defaultRedirectPath};k.prototype.createAccountRow=function(a,d){var h=n["default"].create,E=h("li",{"data-username":a.username,"aria-label":this.i18n.switchToThisAccount,title:this.i18n.switchToThisAccount,
"class":"js__account-li-row"},this.accountsUlElement,d||"last");h=h("a",{"class":"account-row-link",tabindex:"0",onkeyup:this.handleSwitch.bind(this,a),onclick:this.handleSwitch.bind(this,a)},E);h=this.createUserAccountDiv(a,h);this.recentLinkedUsers&&this.recentLinkedUsers[a.username.toLowerCase()]?this.createSignedInDot(h):this.initCheckSignInStatus(a,h);return h};k.prototype.createSignedInDot=function(a){var d=document.createElementNS("http://www.w3.org/2000/svg","circle");d.setAttributeNS(null,
"cx","6");d.setAttributeNS(null,"cy","6");d.setAttributeNS(null,"r","6");d.setAttributeNS(null,"fill","#50AD4E");d.setAttributeNS(null,"viewBox","0 0 12 12");d.setAttributeNS(null,"width","12");var h=document.createElementNS("http://www.w3.org/2000/svg","svg");h.setAttributeNS(null,"class","green-signed-in-dot"+(l["default"].isRightToLeft?"-RTL":""));h.appendChild(d);a.appendChild(h);return a};k.prototype.checkBoxKeyPress=function(a){this.verifyKeyPress(a.key)&&this.checkboxIsClicked.bind(this)(a)};
k.prototype.checkboxIsClicked=function(a){var d=this.getCorrectTargetForIE(a.target),h=d.firstChild.firstChild.firstChild.firstChild,E=null;(E=m["default"].contains(h,"not-visible")?m["default"].contains(a.target,"circle-checkbox-checked")?1:0:1)?(a=this.arrayOfAccountsToUnlink.indexOf(d),this.arrayOfAccountsToUnlink.splice(a,1),this.unCheckBox(h,d),0===this.arrayOfAccountsToUnlink.length&&m["default"].add(this.unlinkAccountBtn,"btn-disabled")):(this.arrayOfAccountsToUnlink.push(d),m["default"].remove(this.unlinkAccountBtn,
"btn-disabled"),this.checkBox(h,d));return!1};k.prototype.getCorrectTargetForIE=function(a){for(var d=0;5>d;d++){if(a.parentElement===this.unlinkAccountsUlElement)return a;a=a.parentElement}};k.prototype.createUnlinkAccountRow=function(a,d){var h=n["default"].create,E=h("li",{"class":"js__account-li-row unlink-account-li","data-username":a.username,onkeyup:this.checkBoxKeyPress.bind(this),onclick:this.checkboxIsClicked.bind(this)},this.unlinkAccountsUlElement,d||"last");E=h("a",{"class":"account-row-link",
tabindex:"0"},E);var x=h("div",{"class":"account-row-div"},E);E=h("span",{role:"checkbox","aria-checked":"false","class":"circle-checkbox"+(l["default"].isRightToLeft?"-RTL":"")},x,"first");var r=h("div",{"class":"circle-user-icon-container"+(l["default"].isRightToLeft?" icon-container-to-right":"")},x);h("span",{"class":"align-image-helper"},r);h("img",{"class":"circle-border-radius"+(l["default"].isRightToLeft?"-RTL":""),alt:"",src:this.getUserIconUrl(a)},r);x=h("div",{"class":"username-container"},
x);h("div",{innerHTML:a.username,"class":"font-size-0"},x);h("div",{innerHTML:a.disabled?"\x3cmark class\x3d'label'\x3e"+this.i18n.disabled+"\x3c/mark\x3e":a.orgName||"\x3cbr\x3e","class":"text-darker-gray font-size--3"},x);this.accountProviderIsSocial(a.provider)&&h("img",{"class":"social-login-circle-logo"+(l["default"].isRightToLeft?"-RTL":""),src:"./images/small_circle_"+a.provider+".png",alt:this.i18n.signedInUsing+" "+a.provider},x);h("span",{"class":"icon-ui-check-mark not-visible circle-checkbox-checkmark"+
(l["default"].isRightToLeft?" checkmark-RTL":"")},E)};k.prototype.fetchAccountsUntilUserCanScroll=function(){var a=this;this.userCanScroll()||this.onLastPageOfAccounts?0!==this.totalLinkedAccounts&&this.onLastPageOfAccounts&&0===this.accountAccess.numberOfUsersWithAccess&&this.displayToUserThatNoAccountsHaveAccess():this.fetchAndCreateNextPageOfAccounts().then(function(d){d.success&&a.fetchAccountsUntilUserCanScroll()})};k.prototype.userCanScroll=function(){return this.accountsUlElement.clientHeight>
I["default"].get(this.accountListContainer,"max-height")};k.prototype.fetchAndCreateNextPageOfAccounts=function(a){var d=this,h=setTimeout(function(){d.accountLoadingText.classList.add("hide")},500),E=this.linkedAccounts.length+1;this.fetchingAccounts=!0;return this.fetchLinkedAccounts(this.accountsPerPage,E).then(function(x){clearTimeout(h);d.accountLoadingText.classList.add("hide");0<x.linkedUsers.length&&(d.linkedAccounts=d.linkedAccounts.concat(x.linkedUsers),d.updateAccessObject(x.linkedUsers),
a||d.createLinkedAccountRows(x.linkedUsers));a&&d.checkSignInStatusForAccounts(x.linkedUsers);d.totalLinkedAccounts=x.total;d.onLastPageOfAccounts=d.totalLinkedAccounts<=d.linkedAccounts.length;d.fetchingAccounts=!1;d.signOutIfAllOriginsAreProcessed();return{success:!0}},function(x){clearTimeout(h);d.accountLoadingText.classList.add("hide");d.alertToFetchAccountFailure();d.fetchingAccounts=!1;return{success:!1}})};k.prototype.updateAccessObject=function(a){a=this.generateAccessObject(a);this.accountAccess.users=
z.__assign(z.__assign({},this.accountAccess.users),a.users);this.accountAccess.numberOfUsersWithAccess+=a.numberOfUsersWithAccess};k.prototype.alertToFetchAccountFailure=function(){this.generateAccessibleNotification(this.errorIcon,this.i18n.error.fetchAccounts,"red")};k.prototype.generateAccessibleNotification=function(a,d,h){this.resetNoticationElementTo("0",h,a,d);this.topNotificationPanel.focus();K["default"].animateProperty({duration:300,node:this.topNotificationPanel,properties:{"margin-top":{end:16,
start:-6},opacity:1}}).play()};k.prototype.resetNoticationElementTo=function(a,d,h,E){this.fadeNotification&&this.fadeNotification.stop();this.topNotificationPanel.className="";this.topNotificationPanel.setAttribute("tabindex",a);this.topNotificationPanel.classList.add("top-notification-panel","link-notification","font-size--2","is-active","alert-"+d);this.topNotificationPanelText.innerHTML=h+'\x3cspan class\x3d"centered-alert-text"\x3e'+E+"\x3c/span\x3e"};k.prototype.signOutIfAllOriginsAreProcessed=
function(){this.clientValues.signout&&!this.signedOutOfCurrentAccount&&this.originsSent.length===this.originsReceived.length&&(0===this.numberOfSignedInAccounts?this.signOutOfCurrentAccount(!0,!0):(this.signOutOfCurrentAccount(!1,!1),this.initSignoutInterface()))};k.prototype.initSignout=function(a){void 0===a&&(a=!1);N.useSignInPage=!1;a?this.redirectToClientUri():this.fetchAllAccounts()};k.prototype.fetchAllAccounts=function(){var a=this,d=new w["default"];if(this.onLastPageOfAccounts)return d.resolve({success:!0});
this.fetchAndCreateNextPageOfAccounts(!0).then(function(h){if(h.success)a.fetchAllAccounts();else return d.resolve({success:!1})})};k.prototype.initSignoutInterface=function(){this.createAccountsForSignoutInterface();this.accountSwitcherWrapper.classList.remove("is-loading");this.setupSignoutDisplay()};k.prototype.createAccountsForSignoutInterface=function(){var a=this;this.linkedAccounts.forEach(function(d){var h=a.getSecureAccountBaseUrl(d.orgUrlKey).toLowerCase();h=a.signInStatus[h][d.username];
if(h.signedIn){h.displayed=!0;var E=n["default"].create("li",{"class":"account-row-link link-accounts-dialog-li default-cursor"},a.accountsUlElement);h.row=E;a.createUserAccountDiv(d,E)}})};k.prototype.accountIsSignedIntoOrigin=function(a,d){var h=d.toLowerCase();return this.signInStatus[h]&&!this.signInStatus[h][a.username].displayed?this.signInStatus[h][a.username]&&this.signInStatus[h][a.username].signedIn:!1};k.prototype.createUserAccountDiv=function(a,d){var h=n["default"].create,E=h("div",{"class":"account-row-div"},
d),x=h("div",{"class":"circle-user-icon-container"+(l["default"].isRightToLeft?" icon-container-to-right":"")},E);h("span",{"class":"align-image-helper"},x);h("img",{"class":"circle-border-radius"+(l["default"].isRightToLeft?"-RTL":""),alt:"",onload:this.clientValues.signout?this.imageHasLoaded():"",src:this.getUserIconUrl(a)},x);x=h("div",{"class":"username-container"},E);h("div",{innerHTML:a.username,"class":"font-size-0"},x);h("div",{innerHTML:a.orgName||"\x3cbr\x3e","class":"text-darker-gray font-size--3"},
x);this.accountProviderIsSocial(a.provider)&&h("img",{"class":"social-login-circle-logo"+(l["default"].isRightToLeft?"-RTL":""),src:"./images/small_circle_"+a.provider+".png",alt:this.i18n.signedInUsing+" "+a.provider},x);return E};k.prototype.imageHasLoaded=function(){var a=this;this.numberOfImagesLoaded=this.numberOfImagesLoaded?this.numberOfImagesLoaded+1:1;this.numberOfImagesLoaded===this.numberOfSignedInAccounts&&this.onLastPageOfAccounts&&setTimeout(function(){a.signOutOfCurrentAccount(!1,!1)},
800)};k.prototype.setupSignoutDisplay=function(){this.accountListContainer.classList.add("reset-background");m["default"].replace(this.accountsUlElement,"plain-list-accounts-ul","switch-accounts-ul");this.windowTitle.classList.add("hide");this.signOutHeader.classList.remove("hide");this.signOutHeaderText.innerHTML=H["default"].substitute(this.i18n.youHaveSignedOutOf,{username:"\x3cspan class\x3d'avenir-demi'\x3e"+this.currentCredential.userId+"\x3c/span\x3e"});this.defaultInterfaceBtns.classList.add("hide");
this.signoutInterfaceBtns.classList.remove("hide");this.isSAMLOnlyOrg()&&(this.closeAccountSwitcher.classList.add("hide"),this.cancelSignoutBtn.classList.add("hide"),this.setupSAMLSignInLink())};k.prototype.isSAMLOnlyOrg=function(){return l["default"].self&&!l["default"].self.canSignInArcGIS&&(l["default"].self.canSignInIDP||l["default"].self.canSignInOIDC)&&"private"===l["default"].self.access};k.prototype.setupSAMLSignInLink=function(){var a=this.getSecureAccountBaseUrl(this.portalUser.portal.urlKey).toLowerCase()+
"/sharing/rest/oauth2/authorize";this.getAuthorizeParameters().then(function(d){d.redirect_uri=(l["default"].baseUrl+"accountswitcher-callback.html").replace("http:","https:");a=a+"?"+Q.objectToQuery(d);Array.prototype.slice.call(document.querySelectorAll(".saml-signin-link")).forEach(function(h){h.setAttribute("href",a);h.classList.remove("hide")})})};k.prototype.initDefaultSignout=function(){this.signOutOfCurrentAccount(!0,!1)};k.prototype.signOutOfCurrentAccount=function(a,d){var h;this.signedOutOfCurrentAccount=
!0;l["default"].userInfo=null;l["default"].userPreferences=null;try{sessionStorage.removeItem("Esri_webmap")}catch(x){}if(l["default"].isDebug){var E=this.getSecureAccountBaseUrl(null===(h=this.portal)||void 0===h?void 0:h.urlKey);this.createSignoutIframe(E,a,d)}else this.createSignoutIframe(this.getOriginOfUrl(),a,d)};k.prototype.createSignoutIframe=function(a,d,h){a=this.getOriginOfUrl();var E=l["default"].restBaseUrl.replace("http://","https://")+"oauth2/signout";E=E+"?display\x3diframe"+(this.currentCredential?
"\x26token\x3d"+this.currentCredential.token:"");E=E+("\x26parent\x3d"+a)+("\x26client_id\x3d"+(this.clientValues&&this.clientValues.clientId||"arcgisonline"));E+="\x26redirect_uri\x3d"+l["default"].baseUrl+"pages/Account/check_sign_in_status.html";E+="%23state\x3d"+JSON.stringify({origin:a,signout:!0,redirectToClientUri:d,displaySignoutComplete:h});n["default"].create("iframe",{src:E,"class":"hidden-iframe"},document.body)};k.prototype.handleSuccessfulSignout=function(a){this.successfulSignOutHandled=
!0;this.isSAMLOnlyOrg()?this.displaySignoutCompleteForSAML():a.redirectToClientUri&&a.displaySignoutComplete?this.displaySignoutCompleteAndRedirect():a.redirectToClientUri&&this.redirectToClientUri()};k.prototype.displaySignoutCompleteAndRedirect=function(){m["default"].add(this.accountSwitcherWrapper,"hide");D["default"]("#account-switcher-wrapper",this.domNode).removeClass("is-loading");m["default"].remove(this.completeSignoutMessage,"hide");setTimeout(this.redirectToClientUri.bind(this),2E3)};
k.prototype.displaySignoutCompleteForSAML=function(){m["default"].add(this.accountSwitcherWrapper,"hide");D["default"]("#account-switcher-wrapper",this.domNode).removeClass("is-loading");m["default"].remove(this.completeSignoutMessage,"hide");m["default"].add(this.closeAccountSwitcher,"hide");this.setupSAMLSignInLink()};k.prototype.revokeToken=function(a){var d=new w["default"],h=new FormData;h.append("auth_token",a);h.append("token_type_hint","access_token");h.append("client_id",this.clientValues.clientId);
h.append("f","json");M["default"].post("https://"+this.portal.portalHostname+"/sharing/rest/oauth2/revokeToken",{data:h,handleAs:"json",headers:{"X-Requested-With":""}}).then(function(E){d.resolve(E)},function(E){d.reject(E)});return d};k.prototype.closeAlertNotification=function(a){this.verifyKeyPress(a.key)&&(a=a.target.parentElement)&&m["default"].add(a,"not-visible")};k.prototype.closeWindow=function(a){var d;a&&a.preventDefault();if(!a||this.verifyKeyPress(a.key))this.clientValues.signout||this.telemetry.logEvent({category:"account switcher",
action:"cancel",label:"switch accounts"}),this.clientValues.signout?this.redirectToClientUri():window.opener?window.close():(a=1<(null===(d=this.originalClientHash)||void 0===d?void 0:d.length)?-2:-1,window.history.go(a))};k.prototype.signoutOfAllAccounts=function(a,d){var h=this;a&&a.preventDefault();if(!a||this.verifyKeyPress(a.key)){var E;this.originsReceived=[];this.originsSent=[];this.originsSignedIn.forEach(function(x){h.originsSent.push(x);h.removeRemoteCredentials(x);Object.keys(h.signInStatus[x]).some(function(r){return E=
N.findCredential(h.getIdMgmrServer(x),r)});E&&h.revokeToken(E.token).then(function(){},function(r){})})}};k.prototype.removeRemoteCredentials=function(a){n["default"].create("iframe",{id:"iframe__for-"+a,src:a+"/home/pages/Account/check_sign_in_status.html#state\x3d"+JSON.stringify({origin:this.getOriginOfUrl(),server:a,remove:!0}),"class":"hidden-iframe"},document.body)};k.prototype.getOriginOfFirstSignedInAccount=function(){var a=0,d;for(d in this.signInStatus)for(var h in this.signInStatus[d]){if(this.signInStatus[d][h].signedIn&&
("enterprise"===this.signInStatus[d][h].provider||-1<this.signInStatus[d][h].provider.indexOf("oidc")))return d;if(this.signInStatus[d][h].signedIn&&!a){var E=d;a=1}}return E};k.prototype.deleteLinkedAccount=function(a){var d=this;a.preventDefault();if(this.verifyKeyPress(a.key)&&0!==this.arrayOfAccountsToUnlink.length){this.activateLoadingState();var h=this.portal.portalUrl.replace("http://","https://")+"community/users/"+this.portalUser.username+"/unlinkUser",E={f:"json"},x=this.arrayOfAccountsToUnlink.length,
r=1===x||!1;this.arrayOfAccountsToUnlink.forEach(function(J,T){var X=F["default"].get(J,"data-username");E.user=X;f["default"]({url:h,content:E},{usePost:!0}).then(function(da){--x;d.arrayOfAccountsToUnlink.splice(T,1);--d.totalLinkedAccounts;0===x&&d.fetchCurrentAccountListAndReset().then(function(){d.telemetry.logEvent({category:"account switcher",action:"finish",label:"unlink accounts"});d.alertToDeletedAccount(r?X:!1);d.toggleUnlinkAccounts();d.totalLinkedAccounts<d.maxNumberOfAccounts&&d.unlockLinkAccountButton();
d.setupDefaultDisplayAndMessages();d.fetchAccountsUntilUserCanScroll()})},function(da){d.fetchCurrentAccountListAndReset().then(function(){d.alertToDeletedAccountFailure(da)})})})}};k.prototype.alertToDeletedAccountFailure=function(a){this.generateAccessibleNotification(this.errorIcon,"COM_1091"===a.messageCode?this.i18n.cannotUnlinkUsersThatShareCredentials:this.i18n.error.unlinkAccount,"red")};k.prototype.alertToDeletedAccount=function(a){var d=this.i18n.accountsSuccessfully+this.boldText(this.i18n.unlinked);
a&&(d=this.boldText(a)+this.i18n.hasBeenSuccessfully,d+=this.boldText(this.i18n.unlinked));this.generateSuccessNotification(this.successIcon,d,"green")};k.prototype.fetchCurrentAccountListAndReset=function(){var a=this;return this.fetchLinkedAccounts(this.accountsPerPage,1).then(function(d){a.emptyAndResetAccountLists();a.linkedAccounts=a.linkedAccounts.concat(d.linkedUsers);a.accountAccess=a.generateAccessObject(d.linkedUsers);a.totalLinkedAccounts=d.total;a.createLinkedAccountRows(d.linkedUsers,
"first");a.deactivateLoadingState()})};k.prototype.clickSignoutCheckbox=function(a){this.verifyKeyPress(a.key)&&(this.keepCurrentAccountSignedIn=a.target.checked)};k.prototype.getOriginOfUrl=function(a){a=a||window.location;return a.protocol+"//"+a.hostname+(a.port?":"+a.port:"")};k.prototype.signInIfNoCurrentUser=function(){this.setEventHandlers();this.generateConfirmActionModal("sign-in-dialog",this.i18n.youMustBeSignedIn,this.i18n.clickSignInToLogin,this.i18n.signIn,this.directUserToSignIn.bind(this),
this.i18n.cancel,this.closeOrRedirectWindow.bind(this,!1))};k.prototype.directUserToSignIn=function(a){var d=this,h;a&&a.preventDefault();if(!a||this.verifyKeyPress(a.key)){a=l["default"].restBaseUrl;var E="https://www.arcgis.com";-1<a.indexOf("devext")?E="https://devext.arcgis.com":-1<a.indexOf("qaext")&&(E="https://qaext.arcgis.com");this.makeAuthorizeUrl(E,!0,E+"/home/pages/Account/signin_account_callback.html",null===(h=this.clientValues)||void 0===h?void 0:h.redirectToOrg).then(function(x){d.generateCenteredWindow(x,
"SignIn")})}};k.prototype.makeAuthorizeUrl=function(a,d,h,E){var x=this,r={portalUrl:a,origin:this.getOriginOfUrl(),server:a+"/sharing"};return this.getAuthorizeParameters().then(function(J){J=z.__assign(z.__assign({},J),{client_id:x.clientValues.clientId||"arcgisonline",state:JSON.stringify(r),redirect_uri:h,force_login:d,hideCancel:!0,showSignupOption:!0,canHandleCrossOrgSignIn:!0,showSocialLogins:!0,hideEnterpriseLogins:!1,signuptype:"esri",redirectToUserOrgUrl:E});return a+"/sharing/rest/oauth2/authorize?"+
Q.objectToQuery(J)})};k.prototype.swapMessageListener=function(a){var d=this;a="string"===typeof a.data?JSON.parse(a.data):a.data;if(!a.error&&"success"===a.status&&this.targetAccount){var h=this.targetAccount;a=this.getTypeOfAccountProvider(h.provider);this.generateBaseOAuthUrl(a,h,!0).then(function(E){E+="\x26state\x3d"+JSON.stringify({user:h.username,portalUrl:d.getSecureAccountBaseUrl(h.orgUrlKey)});E+="\x26redirect_uri\x3d"+d.generateClientRedirectUri(h);window.opener?(window.opener.location.href=
E,d.closeWindow()):window.location.href=E})}};k.prototype.signInMessageListener=function(a){var d=this,h="string"===typeof a.data?JSON.parse(a.data):a.data;if("canceled"===h.status)return this.resetUrlHash();if(!h.error&&"success"===h.status&&h.credential){N.registerToken(h.credential);var E;this.linkedAccounts.some(function(x){return x.username===h.credential.userId?(E=x,!0):!1});E?(a=this.getTypeOfAccountProvider(E.provider),this.generateBaseOAuthUrl(a,E,!0).then(function(x){x=x+"\x26redirect_uri\x3d"+
d.generateClientRedirectUri(E);window.opener?(window.opener.location.href=x,d.closeWindow()):window.location.href=x})):(window.location.hash=this.originalClientHash,this.closeConfirmActionModal("js__confirmationModal-sign-in-dialog"),this.currentCredential=h.credential,this.postCreate())}};k.prototype.closeConfirmActionModal=function(a,d){d&&d.preventDefault();d&&!this.verifyKeyPress(d.key)||document.getElementById(a).classList.remove("is-active")};k.prototype.generateConfirmActionModal=function(a,
d,h,E,x,r,J){var T=this,X=n["default"].create,da=X("div",{"class":"modal-overlay",id:"js__confirmationModal-"+a,"data-modal":"linkAccountDialog"},this.containerNode),fa=X("div",{"class":"modal-content column-12",role:"dialog","aria-labelledby":d},da);X("a",{"class":"right icon-ui-close",href:"","aria-label":"close-modal",tabindex:"0",onkeyup:J||function(ba){T.closeConfirmActionModal("js__confirmationModal-"+a,ba)},onclick:J||function(ba){T.closeConfirmActionModal("js__confirmationModal-"+a,ba)}},
fa);X("h3",{"class":"trailer-half",innerHTML:d},fa);h&&X("p",{innerHTML:h},fa);d=X("div",{"class":"text-right block-group block-group-2-up tablet-block-group-2-up phone-block-group-2-up display-block"},fa);E&&x?(X("a",{href:"","class":"btn btn-fill block",innerHTML:E,tabindex:"0",onkeyup:x,onclick:x},d),X("a",{"class":"btn btn-clear btn-fill block",href:"",innerHTML:r||this.i18n.cancel,tabindex:"0",onclick:J||function(ba){T.closeConfirmActionModal("js__confirmationModal-"+a,ba)},onkeyup:J||function(ba){T.closeConfirmActionModal("js__confirmationModal-"+
a,ba)}},d)):(X("a",{"class":"btn btn-clear-white btn-half btn-disabled block",href:""},d),X("a",{"class":"btn btn-half block",href:"",innerHTML:this.i18n.close,tabindex:"0",onclick:J||function(ba){T.closeConfirmActionModal("js__confirmationModal-"+a,ba)},onkeyup:J||function(ba){T.closeConfirmActionModal("js__confirmationModal-"+a,ba)}},d));m["default"].add(da,"is-active");return da};k.prototype.checkIfLocalStorageIsAvailable=function(){if("object"===typeof localStorage)try{return localStorage.setItem("testLocalStorage",
"1"),localStorage.removeItem("testLocalStorage"),!0}catch(a){return!1}};k.prototype.setHashResponseVariables=function(){this.originalClientHash=window.location.hash;this.clientValues=this.getHashParameters()||{}};k.prototype.getHashParameters=function(){return window.location.hash&&"#"!==window.location.hash||!this.localStorageAvailable?this.getOAuthResponseHash(window.location.hash):this.getParametersFromLocalStorage()};k.prototype.getParametersFromLocalStorage=function(){return JSON.parse(sessionStorage.getItem("ACSW_params"))};
k.prototype.setLocalStorageParameters=function(a){this.localStorageAvailable&&sessionStorage.setItem("ACSW_params",JSON.stringify(a))};k.prototype.getOAuthResponseHash=function(a){var d;clearInterval(this.oAuthIntervalId);"#"===a.charAt(0)&&(a=a.substring(1));a=Q.queryToObject(a);var h=this.getQueryResponseObject();if(!a.err)return a={callbackPage:encodeURIComponent(a.redirect_uri?a.redirect_uri:h.redirectUri||""),signout:"true"===a.signout?!0:null,signoutRedirect:a.signout_redirect_uri||null,accountsToFilter:a.filtered_accounts||
null,usersToFilter:a.filtered_users?JSON.parse(decodeURIComponent(a.filtered_users)):[],clientId:a.client_id||h.clientId||(null===(d=this.clientValues)||void 0===d?void 0:d.clientId)||"arcgisonline",windowTitle:a.window_title||h.windowTitle,redirectToOrg:a.redirect_to_org||h.redirectToOrg,noOAuthParams:a.no_oauth_params||h.noOAuthParams,display:a.display?a.display:h.display},!a.signout&&this.setLocalStorageParameters(a),this.resetUrlHash(),a};k.prototype.getQueryResponseObject=function(){if(-1<window.location.href.search(/\?/)){var a=
{};window.location.search.substring(1).split("\x26").forEach(function(d){d=d.split("\x3d");a[d[0]]=d[1]});return a}return{}};k.prototype.resetUrlHash=function(){window.location.hash=this.localStorageAvailable?"":this.originalClientHash};k.prototype.setupTextAndInterface=function(){"iframe"===this.clientValues.display&&this.setupIframeInterface();this.clientValues.signout?document.title=this.i18n.signedOut:"manageAccounts"===this.clientValues.windowTitle?this.setupManageAccountsInterface():(document.title=
this.i18n.switchAccounts,this.windowTitleText=this.windowTitle.innerHTML=this.i18n.switchAccounts)};k.prototype.setupIframeInterface=function(){this.closeAccountSwitcher.classList.add("hide")};k.prototype.setupManageAccountsInterface=function(){document.title=this.i18n.manageAccounts;this.windowTitleText=this.windowTitle.innerHTML=this.i18n.manageAccounts};k.prototype.validateClientUri=function(){var a=this.clientValues.callbackPage||"https://"+l["default"].self.portalHostname+this.defaultRedirectPath;
f["default"]({url:this.portal.portalUrl.replace("http://","https://")+"oauth2/validateRedirectUri",content:{client_id:this.clientValues.clientId,redirect_uri:this.getAbsoluteUrl(a),f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(d){d.valid||(document.body.innerHTML="\x3ch4 style\x3d'color:#ee2525'\x3eError: Invalid redirect_uri\x3c/h4\x3e")},function(d){document.body.innerHTML="\x3ch4 style\x3d'color:#ee2525'\x3e"+d+"\x3c/h4\x3e"})};k.prototype.getAbsoluteUrl=function(a){if(a){var d=
document.createElement("a");d.href=a;return d.href}};k.prototype.redirectToClientUri=function(a){if(l["default"].isDebug)try{sessionStorage.removeItem("esriJSAPIOAuth"),localStorage.removeItem("esriJSAPIOAuth"),sessionStorage.removeItem("portalAppClientId"),localStorage.removeItem("portalAppClientId")}catch(d){}else{N.destroyCredentials();try{sessionStorage.removeItem("portalAppClientId"),localStorage.removeItem("portalAppClientId")}catch(d){}}a&&a.preventDefault();if(!a||this.verifyKeyPress(a.key))a=
"",a=this.clientValues?"geoanalyticsengine"===this.clientValues.clientId?this.getGeodeHome():decodeURIComponent(this.clientValues.signoutRedirect||this.clientValues.callbackPage):(a=window.location.hash.length&&Q.queryToObject(window.location.hash.slice(1)))&&a.redirect_uri,window.location.href=a?a:l["default"].baseUrl+(this.orgIsPrivate()&&!l["default"].isDebug?"signin.html?useLandingPage\x3dtrue":"index.html")};k.prototype.verifyKeyPress=function(a){return!a||"Enter"===a};k.prototype.orgIsPrivate=
function(){var a;return(null===(a=l["default"].self)||void 0===a?void 0:a.id)&&"private"===l["default"].self.access};k.prototype.getGeodeHome=function(){return"https://geoanalytics.arcgis.com"};k.prototype.getCodeChallenge=function(a){var d=this,h=new w["default"];a&&window.isSecureContext&&(a=(new TextEncoder).encode(a),crypto.subtle.digest("SHA-256",a).then(function(E){h.resolve(d.base64UrlEncode(new Uint8Array(E)))}));h.resolve(null);return h};k.prototype.base64UrlEncode=function(a){return btoa(String.fromCharCode.apply(null,
a)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")};return k=z.__decorate([u["default"](t["default"],p["default"],y["default"])],k)}()})},"tslib/tslib":function(){var G,A,z,g,l,v,t,y,p,q,n,F,O,H,V,P,w,I,m,D,B,K,M,R;(function(c){function b(f,u){f!==e&&("function"===typeof Object.create?Object.defineProperty(f,"__esModule",{value:!0}):f.__esModule=!0);return function(C,L){return f[C]=u?u(C,L):L}}var e="object"===typeof global?global:"object"===typeof self?self:"object"===typeof this?this:{};
"function"===typeof define&&define.amd?define("tslib",["exports"],function(f){c(b(e,b(f)))}):"object"===typeof module&&"object"===typeof module.exports?c(b(e,b(module.exports))):c(b(e))})(function(c){var b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,u){f.__proto__=u}||function(f,u){for(var C in u)Object.prototype.hasOwnProperty.call(u,C)&&(f[C]=u[C])};G=function(f,u){function C(){this.constructor=f}if("function"!==typeof u&&null!==u)throw new TypeError("Class extends value "+
String(u)+" is not a constructor or null");b(f,u);f.prototype=null===u?Object.create(u):(C.prototype=u.prototype,new C)};A=Object.assign||function(f){for(var u,C=1,L=arguments.length;C<L;C++){u=arguments[C];for(var Q in u)Object.prototype.hasOwnProperty.call(u,Q)&&(f[Q]=u[Q])}return f};z=function(f,u){var C={},L;for(L in f)Object.prototype.hasOwnProperty.call(f,L)&&0>u.indexOf(L)&&(C[L]=f[L]);if(null!=f&&"function"===typeof Object.getOwnPropertySymbols){var Q=0;for(L=Object.getOwnPropertySymbols(f);Q<
L.length;Q++)0>u.indexOf(L[Q])&&Object.prototype.propertyIsEnumerable.call(f,L[Q])&&(C[L[Q]]=f[L[Q]])}return C};g=function(f,u,C,L){var Q=arguments.length,S=3>Q?u:null===L?L=Object.getOwnPropertyDescriptor(u,C):L,U;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)S=Reflect.decorate(f,u,C,L);else for(var N=f.length-1;0<=N;N--)if(U=f[N])S=(3>Q?U(S):3<Q?U(u,C,S):U(u,C))||S;return 3<Q&&S&&Object.defineProperty(u,C,S),S};l=function(f,u){return function(C,L){u(C,L,f)}};v=function(f,u){if("object"===
typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(f,u)};t=function(f,u,C,L){function Q(S){return S instanceof C?S:new C(function(U){U(S)})}return new (C||(C=Promise))(function(S,U){function N(d){try{a(L.next(d))}catch(h){U(h)}}function k(d){try{a(L["throw"](d))}catch(h){U(h)}}function a(d){d.done?S(d.value):Q(d.value).then(N,k)}a((L=L.apply(f,u||[])).next())})};y=function(f,u){function C(a){return function(d){return L([a,d])}}function L(a){if(S)throw new TypeError("Generator is already executing.");
for(;Q;)try{if(S=1,U&&(N=a[0]&2?U["return"]:a[0]?U["throw"]||((N=U["return"])&&N.call(U),0):U.next)&&!(N=N.call(U,a[1])).done)return N;if(U=0,N)a=[a[0]&2,N.value];switch(a[0]){case 0:case 1:N=a;break;case 4:return Q.label++,{value:a[1],done:!1};case 5:Q.label++;U=a[1];a=[0];continue;case 7:a=Q.ops.pop();Q.trys.pop();continue;default:if(!(N=Q.trys,N=0<N.length&&N[N.length-1])&&(6===a[0]||2===a[0])){Q=0;continue}if(3===a[0]&&(!N||a[1]>N[0]&&a[1]<N[3]))Q.label=a[1];else if(6===a[0]&&Q.label<N[1])Q.label=
N[1],N=a;else if(N&&Q.label<N[2])Q.label=N[2],Q.ops.push(a);else{N[2]&&Q.ops.pop();Q.trys.pop();continue}}a=u.call(f,Q)}catch(d){a=[6,d],U=0}finally{S=N=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var Q={label:0,sent:function(){if(N[0]&1)throw N[1];return N[1]},trys:[],ops:[]},S,U,N,k;return k={next:C(0),"throw":C(1),"return":C(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};p=function(f,u){for(var C in f)"default"===C||Object.prototype.hasOwnProperty.call(u,
C)||R(u,f,C)};R=Object.create?function(f,u,C,L){void 0===L&&(L=C);Object.defineProperty(f,L,{enumerable:!0,get:function(){return u[C]}})}:function(f,u,C,L){void 0===L&&(L=C);f[L]=u[C]};q=function(f){var u="function"===typeof Symbol&&Symbol.iterator,C=u&&f[u],L=0;if(C)return C.call(f);if(f&&"number"===typeof f.length)return{next:function(){f&&L>=f.length&&(f=void 0);return{value:f&&f[L++],done:!f}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.");};n=function(f,u){var C=
"function"===typeof Symbol&&f[Symbol.iterator];if(!C)return f;var L=C.call(f),Q,S=[];try{for(;(void 0===u||0<u--)&&!(Q=L.next()).done;)S.push(Q.value)}catch(N){var U={error:N}}finally{try{Q&&!Q.done&&(C=L["return"])&&C.call(L)}finally{if(U)throw U.error;}}return S};F=function(){for(var f=[],u=0;u<arguments.length;u++)f=f.concat(n(arguments[u]));return f};O=function(){for(var f=0,u=0,C=arguments.length;u<C;u++)f+=arguments[u].length;f=Array(f);var L=0;for(u=0;u<C;u++)for(var Q=arguments[u],S=0,U=Q.length;S<
U;S++,L++)f[L]=Q[S];return f};H=function(f,u){for(var C=0,L=u.length,Q=f.length;C<L;C++,Q++)f[Q]=u[C];return f};V=function(f){return this instanceof V?(this.v=f,this):new V(f)};P=function(f,u,C){function L(h){k[h]&&(a[h]=function(E){return new Promise(function(x,r){1<d.push([h,E,x,r])||Q(h,E)})})}function Q(h,E){try{var x=k[h](E);x.value instanceof V?Promise.resolve(x.value.v).then(S,U):N(d[0][2],x)}catch(r){N(d[0][3],r)}}function S(h){Q("next",h)}function U(h){Q("throw",h)}function N(h,E){(h(E),
d.shift(),d.length)&&Q(d[0][0],d[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var k=C.apply(f,u||[]),a,d=[];return a={},L("next"),L("throw"),L("return"),a[Symbol.asyncIterator]=function(){return this},a};w=function(f){function u(Q,S){C[Q]=f[Q]?function(U){return(L=!L)?{value:V(f[Q](U)),done:"return"===Q}:S?S(U):U}:S}var C,L;return C={},u("next"),u("throw",function(Q){throw Q;}),u("return"),C[Symbol.iterator]=function(){return this},C};I=function(f){function u(S){Q[S]=
f[S]&&function(U){return new Promise(function(N,k){U=f[S](U);C(N,k,U.done,U.value)})}}function C(S,U,N,k){Promise.resolve(k).then(function(a){S({value:a,done:N})},U)}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var L=f[Symbol.asyncIterator],Q;return L?L.call(f):(f="function"===typeof q?q(f):f[Symbol.iterator](),Q={},u("next"),u("throw"),u("return"),Q[Symbol.asyncIterator]=function(){return this},Q)};m=function(f,u){Object.defineProperty?Object.defineProperty(f,
"raw",{value:u}):f.raw=u;return f};var e=Object.create?function(f,u){Object.defineProperty(f,"default",{enumerable:!0,value:u})}:function(f,u){f["default"]=u};D=function(f){if(f&&f.__esModule)return f;var u={};if(null!=f)for(var C in f)"default"!==C&&Object.prototype.hasOwnProperty.call(f,C)&&R(u,f,C);e(u,f);return u};B=function(f){return f&&f.__esModule?f:{"default":f}};K=function(f,u,C,L){if("a"===C&&!L)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof u?
f!==u||!L:!u.has(f))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===C?L:"a"===C?L.call(f):L?L.value:u.get(f)};M=function(f,u,C,L,Q){if("m"===L)throw new TypeError("Private method is not writable");if("a"===L&&!Q)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof u?f!==u||!Q:!u.has(f))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===L?Q.call(f,
C):Q?Q.value=C:u.set(f,C),C};c("__extends",G);c("__assign",A);c("__rest",z);c("__decorate",g);c("__param",l);c("__metadata",v);c("__awaiter",t);c("__generator",y);c("__exportStar",p);c("__createBinding",R);c("__values",q);c("__read",n);c("__spread",F);c("__spreadArrays",O);c("__spreadArray",H);c("__await",V);c("__asyncGenerator",P);c("__asyncDelegator",w);c("__asyncValues",I);c("__makeTemplateObject",m);c("__importStar",D);c("__importDefault",B);c("__classPrivateFieldGet",K);c("__classPrivateFieldSet",
M)})},"arcgisonline/telemetry":function(){define(["require","exports","tslib","./esriGeowConfig","telemetry/telemetry.dojo.min"],function(G,A,z,g,l){Object.defineProperty(A,"__esModule",{value:!0});g=z.__importDefault(g);l=z.__importDefault(l);G=function(){function v(){}v.init=function(t,y){var p;if(this._instance)return this._instance;this._envCredentials=JSON.parse(atob(g["default"].telemetryConfig||"Int9Ig\x3d\x3d"));if(JSON.stringify(this._envCredentials)!==JSON.stringify("{}")){var q=new l["default"]({disabled:!(g["default"].usageTrackingEnabled&&
!t.disabled&&!t.config.isPortal),portal:t.config,amazon:this._getAmazonCredentials(t)});"logPageView"in t&&!0!==t.logPageView||q.logPageView(null===(p=null===window||void 0===window?void 0:window.location)||void 0===p?void 0:p.href);return this._instance=q}};v._getAmazonCredentials=function(t){var y=this._getEnvironment(t.config.portalHostname);return{userPoolID:this._envCredentials[y].userPoolID,app:{name:t.name||"Arcgis Online",id:this._envCredentials[y].appId,version:t.config.currentVersion||"5.2"}}};
v._getEnvironment=function(t){t=t.replace("www.","");return"arcgis.com"===t&&"production"||"qaext.arcgis.com"===t&&"qa"||"dev"};return v}();A["default"]=G})},"arcgisonline/esriGeowConfig":function(){define(["require","exports"],function(G,A){return window.esriGeowConfig||{}})},"telemetry/telemetry.dojo.min":function(){define(function(){function G(x,r){var J=new XMLHttpRequest;J.addEventListener("load",function(){r(J.responseText)});J.open(x.method,x.url);Object.keys(x.headers).forEach(function(T){J.setRequestHeader(T,
x.headers[T])});J.send(x.body)}function A(x,r){var J=B.get(b);if(J&&Date.now()/1E3<J.Expiration)return r(J);z(x,function(T){B.set(b,T);r(T)})}function z(x,r){var J=c({},e);J.headers["X-Amz-Target"]="AWSCognitoIdentityService.GetId";J.body=JSON.stringify({IdentityPoolId:x});G(J,function(T){g(JSON.parse(T),r)})}function g(x,r){var J=c({},e);J.headers["X-Amz-Target"]="AWSCognitoIdentityService.GetCredentialsForIdentity";J.body=JSON.stringify({IdentityId:x.IdentityId});G(J,function(T){T=JSON.parse(T);
r(T.Credentials)})}function l(){var x=void 0,r=B.get(u);var J=((!r||Date.now()>r.expiration)&&(x=!0,r={id:Math.floor(17592186044416*(1+Math.random())).toString(16),startTimestamp:(new Date).toISOString()}),r.expiration=Date.now()+f,B.set(u,r),x&&(r["new"]=!0),r);r=B.get(C);x=(r||(r=v()+v()+"-"+v()+"-"+v()+"-"+v()+"-"+v()+v()+v(),B.set(C,r)),r);return{session:J,id:x}}function v(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function t(x,r){var J={host:r.uri.host,"content-type":x.config.defaultContentType,
accept:x.config.defaultAcceptType,"x-amz-date":p(r.signDate)};r.request.method=r.request.method.toUpperCase();r.request.body?r.payload=r.request.body:r.request.data&&x.payloadSerializer?r.payload=x.payloadSerializer(r.request.data):delete J["content-type"];r.request.headers=q(J,Object.keys(r.request.headers||{}).reduce(function(T,X){return T[X.toLowerCase()]=r.request.headers[X],T},{}));r.sortedHeaderKeys=Object.keys(r.request.headers).sort();r.request.headers["content-type"]&&(r.request.headers["content-type"]=
r.request.headers["content-type"].split(";")[0]);"object"===K(r.request.params)&&q(r.uri.queryParams,r.request.params)}function y(x,r){r.signedHeaders=r.sortedHeaderKeys.map(function(J){return J.toLowerCase()}).join(";");r.canonicalRequest=String(r.request.method).toUpperCase()+"\n"+encodeURI(r.uri.path)+"\n"+Object.keys(r.uri.queryParams).sort().map(function(J){return encodeURIComponent(J)+"\x3d"+encodeURIComponent(r.uri.queryParams[J])}).join("\x26")+"\n"+r.sortedHeaderKeys.map(function(J){return J.toLocaleLowerCase()+
":"+r.request.headers[J]}).join("\n")+"\n\n"+r.signedHeaders+"\n"+x.hasher.hash(r.payload?r.payload:"")}function p(x,r){var J=x.toISOString().replace(/[:\-]|\.\d{3}/g,"").substr(0,17);return r?J.substr(0,8):J}function q(x){return[].slice.call(arguments,1).forEach(function(r){r&&"object"===(void 0===r?"undefined":K(r))&&Object.keys(r).forEach(function(J){var T=r[J];void 0!==T&&(null!==T&&"object"===(void 0===T?"undefined":K(T))?(x[J]=Array.isArray(T)?[]:{},q(x[J],T)):x[J]=T)})}),x}function n(x){var r=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},J=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},T=l().session;return{eventType:"pageView",timestamp:(new Date).toISOString(),session:{id:T.id,startTimestamp:T.startTimestamp},attributes:c({referrer:document.referrer,hostname:window.location.hostname,path:x||window.location.pathname,pageUrl:x||window.location.pathname,pageName:document.title,previousPageUrl:r.pageUrl,previousPageName:r.pageName},F(J)),metrics:O(J)}}function F(x){var r=
c({},x);return delete r.workflow,U.forEach(function(J){return delete r[J]}),Object.keys(r).forEach(function(J){r[J]="json"===J?r[J]?JSON.stringify(r[J]):"null":void 0!==r[J]?r[J].toString():"null"}),r}function O(x){var r={};return U.forEach(function(J){x[J]&&(r[J]=x[J])}),r}function H(){var x=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];return(new S({region:"us-east-1",service:"mobileanalytics",accessKeyId:x.AccessKeyId,secretAccessKey:x.SecretKey,sessionToken:x.SessionToken})).sign(r)}
function V(x,r,J){var T=l();x=Array.isArray(x)?x:[x];var X=P(x);A(r,function(da){try{X.headers=H(da,X),X.headers["x-amz-Client-Context"]=JSON.stringify({client:{client_id:T.id,app_title:J.name,app_version_name:J.version||"unknown"},services:{mobile_analytics:{app_id:J.id}}})}catch(fa){return}G(X,function(fa){})})}function P(x){return{url:1<arguments.length&&void 0!==arguments[1]?arguments[1]:N,method:"POST",body:JSON.stringify({events:x})}}function w(x){window.ga&&window.ga(function(){x(window.ga.getAll())})}
function I(x,r){return D({hitType:"pageview",page:x||window.location.pathname},r,2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},3<arguments.length&&void 0!==arguments[3]?arguments[3]:{})}function m(x){return D({hitType:"event",eventCategory:x.category||"none",eventAction:x.action,eventLabel:x.label},x,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},2<arguments.length&&void 0!==arguments[2]?arguments[2]:{})}function D(x,r,J,T){return Object.keys(J).forEach(function(X){x["dimension"+
J[X]]=r[X]}),Object.keys(T).forEach(function(X){x["metric"+T[X]]=r[X]}),x}var B={storage:{},memory:!0,get:function(x){var r=void 0;try{r=window.localStorage&&window.localStorage.getItem(x)||this.storage[x]}catch(J){r=this.storage[x]}if(r)try{return JSON.parse(r)}catch(J){}},set:function(x,r){r=JSON.stringify(r);try{window.localStorage.setItem(x,r)}catch(J){this.memory||(this.memory=!0),this.storage[x]=r}},"delete":function(x){try{window.localStorage.removeItem(x)}catch(r){this.memory||(this.memory=
!0),delete this.storage[x]}}},K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(x){return typeof x}:function(x){return x&&"function"==typeof Symbol&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},M=function(x,r){if(!(x instanceof r))throw new TypeError("Cannot call a class as a function");},R=function(){function x(r,J){for(var T=0;T<J.length;T++){var X=J[T];X.enumerable=X.enumerable||!1;X.configurable=!0;"value"in X&&(X.writable=!0);Object.defineProperty(r,X.key,
X)}}return function(r,J,T){return J&&x(r.prototype,J),T&&x(r,T),r}}(),c=Object.assign||function(x){for(var r=1;r<arguments.length;r++){var J=arguments[r],T;for(T in J)Object.prototype.hasOwnProperty.call(J,T)&&(x[T]=J[T])}return x},b="TELEMETRY_COGNITO_CREDENTIALS",e={method:"POST",url:"https://cognito-identity.us-east-1.amazonaws.com/",headers:{"Content-type":"application/x-amz-json-1.1"}},f=18E5,u="TELEMETRY_SESSION",C="TELEMETRY_CLIENT_ID",L=function(x,r){var J={},T=J.lib={},X=function(){},da=
T.Base={extend:function(W){X.prototype=this;var Y=new X;return W&&Y.mixIn(W),Y.hasOwnProperty("init")||(Y.init=function(){Y.$super.init.apply(this,arguments)}),Y.init.prototype=Y,Y.$super=this,Y},create:function(){var W=this.extend();return W.init.apply(W,arguments),W},init:function(){},mixIn:function(W){for(var Y in W)W.hasOwnProperty(Y)&&(this[Y]=W[Y]);W.hasOwnProperty("toString")&&(this.toString=W.toString)},clone:function(){return this.init.prototype.extend(this)}},fa=T.WordArray=da.extend({init:function(W,
Y){W=this.words=W||[];this.sigBytes=void 0!=Y?Y:4*W.length},toString:function(W){return(W||ka).stringify(this)},concat:function(W){var Y=this.words,Z=W.words,aa=this.sigBytes;if(W=W.sigBytes,this.clamp(),aa%4)for(var ia=0;ia<W;ia++)Y[aa+ia>>>2]|=(Z[ia>>>2]>>>24-ia%4*8&255)<<24-(aa+ia)%4*8;else if(65535<Z.length)for(ia=0;ia<W;ia+=4)Y[aa+ia>>>2]=Z[ia>>>2];else Y.push.apply(Y,Z);return this.sigBytes+=W,this},clamp:function(){var W=this.words,Y=this.sigBytes;W[Y>>>2]&=4294967295<<32-Y%4*8;W.length=x.ceil(Y/
4)},clone:function(){var W=da.clone.call(this);return W.words=this.words.slice(0),W},random:function(W){for(var Y=[],Z=0;Z<W;Z+=4)Y.push(4294967296*x.random()|0);return new fa.init(Y,W)}}),ba=J.enc={},ka=ba.Hex={stringify:function(W){var Y=W.words;W=W.sigBytes;for(var Z=[],aa=0;aa<W;aa++){var ia=Y[aa>>>2]>>>24-aa%4*8&255;Z.push((ia>>>4).toString(16));Z.push((15&ia).toString(16))}return Z.join("")},parse:function(W){for(var Y=W.length,Z=[],aa=0;aa<Y;aa+=2)Z[aa>>>3]|=parseInt(W.substr(aa,2),16)<<24-
aa%8*4;return new fa.init(Z,Y/2)}},la=ba.Latin1={stringify:function(W){var Y=W.words;W=W.sigBytes;for(var Z=[],aa=0;aa<W;aa++)Z.push(String.fromCharCode(Y[aa>>>2]>>>24-aa%4*8&255));return Z.join("")},parse:function(W){for(var Y=W.length,Z=[],aa=0;aa<Y;aa++)Z[aa>>>2]|=(255&W.charCodeAt(aa))<<24-aa%4*8;return new fa.init(Z,Y)}},ca=ba.Utf8={stringify:function(W){try{return decodeURIComponent(escape(la.stringify(W)))}catch(Y){throw Error("Malformed UTF-8 data");}},parse:function(W){return la.parse(unescape(encodeURIComponent(W)))}},
ha=T.BufferedBlockAlgorithm=da.extend({reset:function(){this._data=new fa.init;this._nDataBytes=0},_append:function(W){"string"==typeof W&&(W=ca.parse(W));this._data.concat(W);this._nDataBytes+=W.sigBytes},_process:function(W){var Y=this._data,Z=Y.words,aa=Y.sigBytes,ia=this.blockSize,na=aa/(4*ia);na=W?x.ceil(na):x.max((0|na)-this._minBufferSize,0);if(W=na*ia,aa=x.min(4*W,aa),W){for(var qa=0;qa<W;qa+=ia)this._doProcessBlock(Z,qa);qa=Z.splice(0,W);Y.sigBytes-=aa}return new fa.init(qa,aa)},clone:function(){var W=
da.clone.call(this);return W._data=this._data.clone(),W},_minBufferSize:0});T.Hasher=ha.extend({cfg:da.extend(),init:function(W){this.cfg=this.cfg.extend(W);this.reset()},reset:function(){ha.reset.call(this);this._doReset()},update:function(W){return this._append(W),this._process(),this},finalize:function(W){return W&&this._append(W),this._doFinalize()},blockSize:16,_createHelper:function(W){return function(Y,Z){return(new W.init(Z)).finalize(Y)}},_createHmacHelper:function(W){return function(Y,Z){return(new ea.HMAC.init(W,
Z)).finalize(Y)}}});var ea=J.algo={};return J}(Math);!function(x){var r=L.lib,J=r.WordArray,T=r.Hasher;r=L.algo;for(var X=[],da=[],fa=function(W){return 4294967296*(W-(0|W))|0},ba=2,ka=0;64>ka;){a:{var la=ba;for(var ca=x.sqrt(la),ha=2;ha<=ca;ha++)if(!(la%ha)){la=!1;break a}la=!0}la&&(8>ka&&(X[ka]=fa(x.pow(ba,.5))),da[ka]=fa(x.pow(ba,1/3)),ka++);ba++}var ea=[];r=r.SHA256=T.extend({_doReset:function(){this._hash=new J.init(X.slice(0))},_doProcessBlock:function(W,Y){for(var Z=this._hash.words,aa=Z[0],
ia=Z[1],na=Z[2],qa=Z[3],ra=Z[4],ta=Z[5],va=Z[6],wa=Z[7],oa=0;64>oa;oa++){if(16>oa)ea[oa]=0|W[Y+oa];else{var sa=ea[oa-15],ua=ea[oa-2];ea[oa]=((sa<<25|sa>>>7)^(sa<<14|sa>>>18)^sa>>>3)+ea[oa-7]+((ua<<15|ua>>>17)^(ua<<13|ua>>>19)^ua>>>10)+ea[oa-16]}sa=wa+((ra<<26|ra>>>6)^(ra<<21|ra>>>11)^(ra<<7|ra>>>25))+(ra&ta^~ra&va)+da[oa]+ea[oa];ua=((aa<<30|aa>>>2)^(aa<<19|aa>>>13)^(aa<<10|aa>>>22))+(aa&ia^aa&na^ia&na);wa=va;va=ta;ta=ra;ra=qa+sa|0;qa=na;na=ia;ia=aa;aa=sa+ua|0}Z[0]=Z[0]+aa|0;Z[1]=Z[1]+ia|0;Z[2]=Z[2]+
na|0;Z[3]=Z[3]+qa|0;Z[4]=Z[4]+ra|0;Z[5]=Z[5]+ta|0;Z[6]=Z[6]+va|0;Z[7]=Z[7]+wa|0},_doFinalize:function(){var W=this._data,Y=W.words,Z=8*this._nDataBytes,aa=8*W.sigBytes;return Y[aa>>>5]|=128<<24-aa%32,Y[14+(aa+64>>>9<<4)]=x.floor(Z/4294967296),Y[15+(aa+64>>>9<<4)]=Z,W.sigBytes=4*Y.length,this._process(),this._hash},clone:function(){var W=T.clone.call(this);return W._hash=this._hash.clone(),W}});L.SHA256=T._createHelper(r);L.HmacSHA256=T._createHmacHelper(r)}(Math);(function(){var x=L.enc.Utf8;L.algo.HMAC=
L.lib.Base.extend({init:function(r,J){r=this._hasher=new r.init;"string"==typeof J&&(J=x.parse(J));var T=r.blockSize,X=4*T;J.sigBytes>X&&(J=r.finalize(J));J.clamp();for(var da=this._oKey=J.clone(),fa=this._iKey=J.clone(),ba=da.words,ka=fa.words,la=0;la<T;la++)ba[la]^=1549556828,ka[la]^=909522486;da.sigBytes=fa.sigBytes=X;this.reset()},reset:function(){var r=this._hasher;r.reset();r.update(this._iKey)},update:function(r){return this._hasher.update(r),this},finalize:function(r){var J=this._hasher;return r=
J.finalize(r),J.reset(),J.finalize(this._oKey.clone().concat(r))}})})();var Q={region:"eu-west-1",service:"execute-api",defaultContentType:"application/json",defaultAcceptType:"application/json",payloadSerializerFactory:function(){return function(x){return JSON.stringify(x)}},uriParserFactory:function(){function x(J){return/^\??(.*)$/.exec(J)[1].split("\x26").reduce(function(T,X){return X=/^(.+)=(.*)$/.exec(X),X&&(T[X[1]]=X[2]),T},{})}var r=document?document.createElement("a"):{};return function(J){return r.href=
J,{protocol:r.protocol,host:r.host.replace(/^(.*):((80)|(443))$/,"$1"),path:("/"!==r.pathname.charAt(0)?"/":"")+r.pathname,queryParams:x(r.search)}}},hasherFactory:function(){return{hash:function(x,r){r=q({hexOutput:!0,textInput:!0},r);var J=L.SHA256(x);return r.hexOutput?J.toString(L.enc.Hex):J},hmac:function(x,r,J){J=q({hexOutput:!0,textInput:!0},J);x=L.HmacSHA256(r,x,{asBytes:!0});return J.hexOutput?x.toString(L.enc.Hex):x}}}},S=function(){function x(r){M(this,x);this.config=q({},Q,r);this.payloadSerializer=
this.config.payloadSerializer||this.config.payloadSerializerFactory();this.uriParser=this.config.uriParserFactory();this.hasher=this.config.hasherFactory();r=this.config.accessKeyId;if(void 0===r||!r)throw Error("AwsSigner requires AWS AccessKeyID");r=this.config.secretAccessKey;if(void 0===r||!r)throw Error("AwsSigner requires AWS SecretAccessKey");}return R(x,[{key:"sign",value:function(r,J){var T={request:q({},r),signDate:J||new Date,uri:this.uriParser(r.url)};t(this,T);y(this,T);T.credentialScope=
[p(T.signDate,!0),this.config.region,this.config.service,"aws4_request"].join("/");T.stringToSign="AWS4-HMAC-SHA256\n"+p(T.signDate)+"\n"+T.credentialScope+"\n"+this.hasher.hash(T.canonicalRequest);var X=this.hasher.hmac,da=X(X(X(X("AWS4"+this.config.secretAccessKey,p(T.signDate,!0),{hexOutput:!1}),this.config.region,{hexOutput:!1,textInput:!1}),this.config.service,{hexOutput:!1,textInput:!1}),"aws4_request",{hexOutput:!1,textInput:!1});T.signature=X(da,T.stringToSign,{textInput:!1});T.authorization=
"AWS4-HMAC-SHA256 Credential\x3d"+this.config.accessKeyId+"/"+T.credentialScope+", SignedHeaders\x3d"+T.signedHeaders+", Signature\x3d"+T.signature;return{Accept:T.request.headers.accept,Authorization:T.authorization,"Content-Type":T.request.headers["content-type"],"x-amz-date":T.request.headers["x-amz-date"],"x-amz-security-token":this.config.sessionToken||void 0}}}]),x}(),U=["size","duration","position","number","count"],N="https://mobileanalytics.us-east-1.amazonaws.com/2014-06-05/events",k=function(){function x(r){M(this,
x);this.name="amazon";c(this,r);l().session["new"]&&!r.test&&this.logEvent({eventType:"_session.start"})}return R(x,[{key:"logPageView",value:function(r,J){var T=n(r,this.previousPage,J);V(T,this.userPoolID,this.app);this.previousPage=T.attributes}},{key:"logEvent",value:function(r){var J=l().session;r={eventType:r.eventType||"other",timestamp:(new Date).toISOString(),session:{id:J.id,startTimestamp:J.startTimestamp},attributes:c({referrer:document.referrer,hostname:window.location.hostname,path:window.location.pathname},
F(r)),metrics:O(r)};V(r,this.userPoolID,this.app)}}]),x}(),a=function(){function x(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};M(this,x);this.name="google";c(this,r)}return R(x,[{key:"logPageView",value:function(r,J){var T=I(r,J,this.dimensions,this.metrics);w(function(X){X.forEach(function(da){da.send(T)})})}},{key:"logEvent",value:function(r){var J=m(r,this.dimensions,this.metrics);w(function(T){T.forEach(function(X){X.send(J)})})}}]),x}(),d=function(x){if(x)return L.SHA256(x).toString(L.enc.Hex)},
h="esri.com esriuk.com esri.de esri.ca esrifrance.fr esri.nl esri-portugal.pt esribulgaria.com esri.fi esri.kr esrimalaysia.com.my esri.es esriaustralia.com.au esri-southafrica.com esri.cl esrichina.com.cn esri.co esriturkey.com.tr geodata.no esriitalia.it esri.pl".split(" "),E=function(){var x=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=x.portal||{};return!x.disabled&&"1"!==navigator.doNotTrack&&"1"!==window.doNotTrack&&(void 0===r.eueiEnabled||!1!==r.eueiEnabled)&&(!(!r.eueiEnabled||
!r.user||r.user.orgId!==r.id)||!(!r.user||r.user.orgId||"US"!==r.ipCntryCode)||!r.user&&"US"===r.ipCntryCode||!(0<Object.keys(r).length))};return function(){function x(r){M(this,x);try{(this.trackers=[],this.workflows={},this.test=r.test,this.debug=r.debug,this.disabled=!E(r),r.portal&&r.portal.user)?this.setUser(r.portal.user,(r.portal.subscriptionInfo||{}).type):r.user&&this.setUser(r.user),this.disabled||this._initTrackers(r)}catch(J){this.disabled=!0}}return R(x,[{key:"_initTrackers",value:function(r){if(r.amazon){var J=
new k(r.amazon);this.trackers.push(J)}r.google&&(r=new a(r.google),this.trackers.push(r))}},{key:"setUser",value:function(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},J=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"Public";this.user=r="string"==typeof r?{username:r}:r;this.user.accountType=J;var T=void 0;if(r.email&&r.email.split){var X=r.email.split("@")[1];T=0<h.filter(function(da){return X===da}).length}(T||-1<["In House","Demo and Marketing"].indexOf(J))&&(this.user.internalUser=
!0)}},{key:"logPageView",value:function(r){var J=this.preProcess(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{});return this.debug||!this.test||this.disabled?!this.trackers.length||this.disabled?!1:(this.trackers.forEach(function(T){try{T.logPageView(r,J)}catch(X){}}),!0):J}},{key:"logEvent",value:function(){var r=this.preProcess(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});return!this.debug&&this.test?r:!this.trackers.length||this.disabled?!1:(this.trackers.forEach(function(J){try{J.logEvent(r)}catch(T){}}),
!0)}},{key:"logError",value:function(){var r=c({eventType:"error"},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});this.logEvent(r)}},{key:"startWorkflow",value:function(r){var J=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},T={name:r,start:Date.now(),steps:[],workflowId:Math.floor(17592186044416*(1+Math.random())).toString(16)};this._saveWorkflow(T);J=c({name:r,step:"start"},J);return this._logWorkflow(J),T}},{key:"stepWorkflow",value:function(r,J){var T=2<arguments.length&&
void 0!==arguments[2]?arguments[2]:{};T=c({name:r,step:J,details:"string"==typeof options?T:T.details},T);this._logWorkflow(T)}},{key:"endWorkflow",value:function(r){var J=c({name:r,step:"finish"},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{});this._logWorkflow(J)}},{key:"cancelWorkflow",value:function(r){var J=c({name:r,step:"cancel"},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{});this._logWorkflow(J)}},{key:"getWorkflow",value:function(r){if(r=B.get("TELEMETRY-WORKFLOW:"+
r)){if(18E5>Date.now()-r.start)return r;this._deleteWorkflow(r)}}},{key:"_saveWorkflow",value:function(r){B.set("TELEMETRY-WORKFLOW:"+r.name,r)}},{key:"_deleteWorkflow",value:function(r){B["delete"]("TELEMETRY-WORKFLOW:"+r.name)}},{key:"_logWorkflow",value:function(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r=this.preProcess(r);var J=this.getWorkflow(r.name);J||(this.startWorkflow(r.name),J=this.getWorkflow(r.name));J.steps.push(r.step);J.duration=(Date.now()-J.start)/1E3;-1<
["cancel","finish"].indexOf(r.step)?this._deleteWorkflow(J):this._saveWorkflow(J);r=c(r,{eventType:"workflow",category:r.name,action:r.step,label:r.details,duration:J.duration,workflowId:J.workflowId});this.logEvent(r)}},{key:"preProcess",value:function(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},J={};return this.user&&(J={user:d(this.user.username),orgId:d(this.user.orgId),lastLogin:this.user.lastLogin,userSince:this.user.created,internalUser:this.user.internalUser||!1,accountType:this.user.accountType}),
c({},r,J)}}]),x}()})},"arcgisonline/pages/utils/signin":function(){define("require exports tslib ../../esriGeowConfig ./storage esri/IdentityManager esri/arcgis/OAuthInfo dojo/_base/kernel dojo/Deferred".split(" "),function(G,A,z,g,l,v,t,y,p){g=z.__importDefault(g);l=z.__importDefault(l);v=z.__importDefault(v);t=z.__importDefault(t);y=z.__importDefault(y);p=z.__importDefault(p);return function(){function q(){}q.getPortalUrl=function(){var n,F=g["default"].restBaseUrl.substring(0,g["default"].restBaseUrl.indexOf("/sharing/rest")).replace("http://",
"https://");if(null===(n=g["default"].self)||void 0===n?0:n.portalHostname)F="https://"+g["default"].self.portalHostname;return F};q.setupOAuthInfo=function(n){var F={appId:q.getClientId(),portalUrl:q.getPortalUrl(),locale:y["default"].locale,popup:!1};n&&(F.forceLogin=n);n=new t["default"](F);q.esriId.registerOAuthInfos([n]);q.esriId.useSignInPage=!1};q.checkSignInStatus=function(){var n=new p["default"];q.setupOAuthInfo(!1);var F=q.getPortalUrl()+"/sharing";q.esriId.checkSignInStatus(F).then(function(O){O&&
(g["default"].userInfo=z.__assign(z.__assign({},g["default"].userInfo||{}),{username:O.userId,token:O.token,credential:O}));n.resolve(O)},function(){n.resolve(null)});return n};q.getCredential=function(n,F){var O=new p["default"];q.setupOAuthInfo(n);var H=q.getPortalUrl()+"/sharing";q.esriId.getCredential(H,F).then(function(V){O.resolve(V)},function(){O.resolve(null)});return O};q.isValidReturnUrl=function(n,F){return n?this.isValidPortalReturnUrl(F):this.isValidOnlineReturnUrl(F)};q.isValidOnlineReturnUrl=
function(n){var F=decodeURI(n),O=q.getHostName(window.location.href);n=this.getHostName(F);var H=0===F.indexOf("http://")||0===F.indexOf("https://"),V=H&&n?n.lastIndexOf(".arcgis.com"):-1,P=H&&n?n.lastIndexOf(".esri.com"):-1,w=H&&n?n.lastIndexOf(O):-1;F=-1<F.indexOf("/sharing/proxy");V=-1<V&&V+11-1===n.length-1;P=-1<P&&P+9-1===n.length-1;O=-1<w&&w+O.length-1===n.length-1;return H&&n&&(V||P||O)&&!F};q.isValidPortalReturnUrl=function(n){n=decodeURI(n);var F=q.getDomainName(window.location.hostname),
O=q.getDomainName(this.getHostName(n));return(0===n.indexOf("http://")||0===n.indexOf("https://"))&&O&&O===F};q.getHostName=function(n){n=n.match(/:\/\/(.[^/:]+)/i);return null!==n&&1<n.length&&"string"===typeof n[1]&&0<n[1].length?n[1]:null};q.getDomainName=function(n){return n.substring(n.lastIndexOf(".",n.lastIndexOf(".")-1)+1)};q.getClientId=function(){try{return l["default"].getLocalStorageItem("portalAppClientId")||l["default"].getSessionStorageItem("portalAppClientId")||"arcgisonline"}catch(n){return"arcgisonline"}};
q.checkForOrgUserOnOnlineBaseHostAndRedirect=function(n){var F=g["default"].isDebug,O=n.isPortal,H=n.user,V=n.urlKey,P=n.customBaseUrl;H=null===H||void 0===H?void 0:H.orgId;n=window.location.host===n.portalHostname;var w=!!V,I="arcgisonline"===q.getClientId();!F&&!O&&H&&n&&w&&I&&(window.location.href=window.location.href.replace(window.location.host,V+"."+P))};q.esriId=v["default"];return q}()})},"arcgisonline/pages/utils/storage":function(){define(["require","exports","tslib","./strings"],function(G,
A,z,g){g=z.__importDefault(g);return function(){function l(){}l.setCookie=function(v,t,y,p){this.writeCookie(v,p?JSON.stringify(t):t,y)};l.getCookie=function(v,t){var y=this.readCookie(v);return y&&t?JSON.parse(y):y};l.setLocalStorageItem=function(v,t,y){try{window.localStorage.setItem(v,y?JSON.stringify(t):t)}catch(p){}};l.getLocalStorageItem=function(v,t){try{var y=window.localStorage.getItem(v);return y&&t?JSON.parse(y):y}catch(p){}};l.removeLocalStorageItem=function(v){try{window.localStorage.removeItem(v)}catch(t){}};
l.setSessionStorageItem=function(v,t,y){try{window.sessionStorage.setItem(v,y?JSON.stringify(t):t)}catch(p){}};l.getSessionStorageItem=function(v,t){try{var y=window.sessionStorage.getItem(v);return y&&t?JSON.parse(y):y}catch(p){}};l.removeSessionStorageItem=function(v){try{window.sessionStorage.removeItem(v)}catch(t){}};l.readCookie=function(v){var t=document.cookie;v=new RegExp("(?:^|; )"+g["default"].escapeRegExp(v)+"\x3d([^;]*)");return(t=t.match(v))?decodeURIComponent(t[1]):void 0};l.writeCookie=
function(v,t,y){y=y||{};var p=null===y||void 0===y?void 0:y.expires;if("number"===typeof p){var q=new Date;p*=864E5;q.setTime(Date.now()+p);p=y.expires=q}"string"!==typeof p&&(null===p||void 0===p?0:p.toUTCString)&&(y.expires=p.toUTCString());v=v+"\x3d"+encodeURIComponent(t);for(var n in y)v+="; "+n,t=y[n],!0!==t&&(v+="\x3d"+t);document.cookie=v};return l}()})},"arcgisonline/pages/utils/strings":function(){define(["require","exports"],function(G,A){return function(){function z(){}z.isString=function(g){return(null===
g||void 0===g?void 0:g.constructor)===String};z.startsWith=function(g,l){return l&&0===(null===g||void 0===g?void 0:g.indexOf(l))};z.endsWith=function(g,l){if(g&&l){var v=g.lastIndexOf(l);return-1<v&&g.length>=l.length&&v===g.length-l.length}return!1};z.includes=function(g,l){return l&&-1<(null===g||void 0===g?void 0:g.indexOf(l))};z.isSet=function(g){return!!(0<(null===g||void 0===g?void 0:g.length))};z.areEqual=function(g,l){var v=this.isSet(g),t=this.isSet(l);return!v&&!t||v&&t&&g.trim()===l.trim()};
z.replaceAll=function(g,l,v){return g.replace(new RegExp(this.escapeRegExp(l),"g"),v)};z.escapeRegExp=function(g){return g.replace(/[.*+?^${}()|[\]\\]/g,"\\$\x26")};z.escapeQuestionMarks=function(g){return g.replace(/[?\\]/g,"\\$\x26")};z.stringToArray=function(g,l,v){g=g instanceof Array?g:g.split(l);return v?g.map(function(t){return t.trim()}):g};z.isValidHex=function(g){return/[0-9A-Fa-f]{6}/g.test(g)};z.stringToHex=function(g){for(var l=0,v=0;v<g.length;v++)l=g.charCodeAt(v)+((l<<5)-l);g="#";
for(v=0;3>v;v++)g+=("00"+(l>>8*v&255).toString(16)).substr(-2);return g};z.hexToRgb=function(g){g=g.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(l,v,t,y){return v+v+t+t+y+y});return(g=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(g))?{r:parseInt(g[1],16),g:parseInt(g[2],16),b:parseInt(g[3],16)}:null};z.htmlDecode=function(g){var l=document.createElement("textarea");l.innerHTML=g;return l.value};z.encodeWhitespace=function(g){return g?g.replace(/\s/g,"%20"):""};z.encodeAngleBrackets=function(g){var l;
return null!==(l=null===g||void 0===g?void 0:g.replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;"))&&void 0!==l?l:""};z.decodeAngleBrackets=function(g){var l;return null!==(l=null===g||void 0===g?void 0:g.replace(/&lt;/g,"\x3c").replace(/&gt;/g,"\x3e"))&&void 0!==l?l:""};z.escapeHTML=function(g){var l={"\x26":"\x26#x38;","\x3c":"\x26#x3C;","\x3e":"\x26#x3E;",'"':"\x26#x22;","'":"\x26#x27;","/":"\x26#x2F;"};return String(g).replace(/[&<>"'/]/gm,function(v){return l[v]})};z.shouldStripHTML=function(g){var l;
if(!g)return!1;g=null!==(l=null===g||void 0===g?void 0:g.split("\x3c"))&&void 0!==l?l:[];return 1<g.length&&g.some(function(v){return-1<v.search(/^[A-Za-z\/]+.*[>]+.*$/m)})};z.stripHTML=function(g){if(!g)return"";var l=document.createElement("div");l.innerHTML=g;return l.textContent};z.addHyperlinks=function(g){return g.replace(/(https?:\/\/[^\s]+)/g,function(l){return'\x3ca href\x3d"'+l+'" target\x3d"_blank"\x3e'+l+"\x3c/a\x3e"})};z.escapeNewlines=function(g){return null===g||void 0===g?void 0:g.replace(/(?:\r)/g,
"\x26#10;").replace(/(?:\n)/g,"\x26#13;")};z.restoreNewlines=function(g){return null===g||void 0===g?void 0:g.replace(/(?:&#10;)/g,"\r").replace(/(?:&#13;)/g,"\n")};z.insertHTMLLineBreaks=function(g){return null===g||void 0===g?void 0:g.replace(/(?:"&#10;&#13;|&#10;|&#13;|\r\n|\r|\n")/g,"\x3cbr\x3e")};z.containsHTTPProtocol=function(g){var l;return-1<(null!==(l=null===g||void 0===g?void 0:g.toLowerCase())&&void 0!==l?l:"").indexOf("http://")};return z}()})},"esri/IdentityManager":function(){define(["./IdentityManagerDialog",
"./kernel","./OAuthSignInHandler","dojo/_base/declare"],function(G,A,z,g){G=new G;A.id=g.safeMixin(G,z);return A.id})},"esri/IdentityManagerDialog":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/has dojo/dom-attr dojo/keys dijit/registry dijit/Dialog ./kernel ./lang ./domUtils ./Credential ./IdentityManagerBase dojo/i18n!./nls/jsapi dojo/query dijit/form/Button dijit/form/Form dijit/form/ValidationTextBox".split(" "),function(G,A,
z,g,l,v,t,y,p,q,n,F,O,H,V,P){A=A([V],{declaredClass:"esri.IdentityManager",_eventMap:{"dialog-cancel":["info"]},constructor:function(w){l.mixin(this,w);this.registerConnectEvents()},_dialogContent:"\x3cdiv data-dojo-type\x3d'dijit.form.Form' data-dojo-props\x3d'\"class\":\"esriIdForm\"'\x3e\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3ctable style\x3d'width: 100%;'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblUser}\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"text\", \"class\":\"esriIdUser\", required:true, trim:true, style:\"width: 100%;\", autocapitalize:\"none\", autocorrect:\"off\", spellcheck:false' /\x3e\x3c/label\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblPwd}\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"password\", \"class\":\"esriIdPwd\", required:true, style:\"width: 100%;\"' /\x3e\x3c/label\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e",
onDialogCreate:function(){},onDialogCancel:function(){},signIn:function(w,I,m){this._nls||(this._nls=P.identity);this._loginDialog||(this._loginDialog=this.dialog=this._createLoginDialog(),this.onDialogCreate());var D=this._loginDialog,B=m&&m.error,K=m&&m.token,M=new g(function(){D.onCancel()});if(D.open)return w=Error("BUSY"),w.name="identity-manager:busy",w.code="IdentityManager.1",w.log=!!z.isDebug,M.errback(w),M;O.hide(D.errMsg_);B&&403==B.code&&K&&(t.set(D.errMsg_,"innerHTML",this._nls.forbidden),
O.show(D.errMsg_));D.dfd_=M;D.serverInfo_=I;D.resUrl_=w;D.admin_=m&&m.isAdmin;t.set(D.resLink_,{title:w,innerHTML:"("+(this.getResourceName(w)||this._nls.lblItem)+")"});t.set(D.serverLink_,{title:I.server,innerHTML:(-1!==I.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":I.server)+" "});D.txtPwd_.set("value","");D.show();return M},_createLoginDialog:function(){var w=this._nls,I=F.substitute(w,this._dialogContent);I=F.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",
server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},I);var m=new q({title:w.title,content:I,"class":"esriSignInDialog",style:"width: 18em;",esriIdMgr_:this,keypressed_:function(D){D.charOrCode===y.ENTER&&this.execute_()},execute_:function(){var D=this.txtUser_.get("value"),B=this.txtPwd_.get("value"),K=this.dfd_,M=this;if(this.form_.validate()&&D&&B){this.btnSubmit_.set("label",w.lblSigning);var R=n.id.findCredential(M.resUrl_,D),c=function(b){M.btnSubmit_.set("label",
w.lblOk);M.btnSubmit_.set("disabled",!1);O.hide(M.errMsg_);M.hide();q._DialogLevelManager.hide(M);var e=M.serverInfo_;M.dfd_=M.serverInfo_=M.generateDfd_=M.resUrl_=null;var f=R;if(b){var u=b.token;var C=F.isDefined(b.expires)?Number(b.expires):null;var L=!!b.ssl;f?(f.userId=D,f.token=u,f.expires=C,f.validity=b.validity,f.ssl=L,f.creationTime=(new Date).getTime()):f=new H({userId:D,server:e.server,token:u,expires:C,ssl:L,isAdmin:M.admin_,validity:b.validity})}K.callback(f)};R&&!R._enqueued?c():(M.btnSubmit_.set("disabled",
!0),M.generateDfd_=n.id.generateToken(this.serverInfo_,{username:D,password:B},{isAdmin:this.admin_}).addCallback(c).addErrback(function(b){M.btnSubmit_.set("disabled",!1);M.generateDfd_=null;M.btnSubmit_.set("label",w.lblOk);t.set(M.errMsg_,"innerHTML",b&&b.code?w.invalidUser:w.noAuthService);O.show(M.errMsg_)}))}},cancel_:function(){m.generateDfd_&&m.generateDfd_.cancel();var D=m.dfd_,B=m.resUrl_,K=m.serverInfo_;m.btnSubmit_.set("disabled",!1);m.dfd_=m.serverInfo_=m.generateDfd_=m.resUrl_=null;
O.hide(m.errMsg_);q._DialogLevelManager.hide(m);m.esriIdMgr_.onDialogCancel({resourceUrl:B,serverInfo:K});B=Error("ABORTED");B.name="identity-manager:user-aborted";B.code="IdentityManager.2";B.log=!!z.isDebug;D.errback(B)}});I=m.domNode;m.form_=p.byNode(G.query(".esriIdForm",I)[0]);m.txtUser_=p.byNode(G.query(".esriIdUser",I)[0]);m.txtPwd_=p.byNode(G.query(".esriIdPwd",I)[0]);m.btnSubmit_=p.byNode(G.query(".esriIdSubmit",I)[0]);m.btnCancel_=p.byNode(G.query(".esriIdCancel",I)[0]);m.resLink_=G.query(".resLink",
I)[0];m.serverLink_=G.query(".serverLink",I)[0];m.errMsg_=G.query(".esriErrorMsg",I)[0];m.connect(m.txtUser_,"onKeyPress",m.keypressed_);m.connect(m.txtPwd_,"onKeyPress",m.keypressed_);m.connect(m.btnSubmit_,"onClick",m.execute_);m.connect(m.btnCancel_,"onClick",m.onCancel);m.connect(m,"onCancel",m.cancel_);return m}});return n.IdentityManagerDialog=n.IdentityManager=A})},"dijit/Dialog":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/ready dojo/sniff dojo/touch dojo/window dojo/dnd/Moveable dojo/dnd/TimedMoveable ./focus ./_base/manager ./_Widget ./_TemplatedMixin ./_CssStateMixin ./form/_FormMixin ./_DialogMixin ./DialogUnderlay ./layout/ContentPane ./layout/utils dojo/text!./templates/Dialog.html ./a11yclick dojo/i18n!./nls/common".split(" "),
function(G,A,z,g,l,v,t,y,p,q,n,F,O,H,V,P,w,I,m,D,B,K,M,R,c,b,e,f,u,C,L){function Q(){}var S=new l;S.resolve(!0);K=g("dijit._DialogBase"+(P("dojo-bidi")?"_NoBidi":""),[R,b,e,c],{templateString:L,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!1,duration:K.defaultDuration,refocus:!0,autofocus:!0,_firstFocusItem:null,_lastFocusItem:null,draggable:!0,_setDraggableAttr:function(a){this._set("draggable",a)},maxRatio:.9,
closable:!0,_setClosableAttr:function(a){this.closeButtonNode.style.display=a?"":"none";this._set("closable",a)},postMixInProperties:function(){var a=n.getLocalization("dijit","common");O.mixin(this,a);this.inherited(arguments)},postCreate:function(){p.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);z.after(this,"onExecute",O.hitch(this,"hide"),!0);z.after(this,"onCancel",O.hitch(this,"hide"),!0);H(this.closeButtonNode,
w.press,function(a){a.stopPropagation()});this._modalconnects=[]},onLoad:function(){this.resize();this._position();this.autofocus&&N.isTop(this)&&(this._getFocusItems(),B.focus(this._firstFocusItem));this.inherited(arguments)},focus:function(){this._getFocusItems();B.focus(this._firstFocusItem)},_endDrag:function(){var a=y.position(this.domNode),d=I.getBox(this.ownerDocument);a.y=Math.min(Math.max(a.y,0),d.h-a.h);a.x=Math.min(Math.max(a.x,0),d.w-a.w);this._relativePosition=a;this._position()},_setup:function(){var a=
this.domNode;this.titleBar&&this.draggable?(this._moveable=new (6==P("ie")?D:m)(a,{handle:this.titleBar}),z.after(this._moveable,"onMoveStop",O.hitch(this,"_endDrag"),!0)):t.add(a,"dijitDialogFixed");this.underlayAttrs={dialogId:this.id,"class":A.map(this["class"].split(/\s/),function(d){return d+"_underlay"}).join(" "),_onKeyDown:O.hitch(this,"_onKey"),ownerDocument:this.ownerDocument}},_size:function(){this.resize()},_position:function(){if(!t.contains(this.ownerDocumentBody,"dojoMove")){var a=
this.domNode,d=I.getBox(this.ownerDocument),h=this._relativePosition,E=y.position(a);p.set(a,{left:Math.floor(d.l+(h?Math.min(h.x,d.w-E.w):(d.w-E.w)/2))+"px",top:Math.floor(d.t+(h?Math.min(h.y,d.h-E.h):(d.h-E.h)/2))+"px"})}},_onKey:function(a){if(a.keyCode==F.TAB){this._getFocusItems();var d=a.target;this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):d==this._firstFocusItem&&a.shiftKey?(B.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):d!=this._lastFocusItem||
a.shiftKey||(B.focus(this._firstFocusItem),a.stopPropagation(),a.preventDefault())}else this.closable&&a.keyCode==F.ESCAPE&&(this.onCancel(),a.stopPropagation(),a.preventDefault())},show:function(){if(this.open)return S.promise;this._started||this.startup();this._alreadyInitialized||(this._setup(),this._alreadyInitialized=!0);this._fadeOutDeferred&&(this._fadeOutDeferred.cancel(),N.hide(this));var a=I.get(this.ownerDocument);this._modalconnects.push(H(a,"scroll",O.hitch(this,"resize",null)));this._modalconnects.push(H(this.domNode,
"keydown",O.hitch(this,"_onKey")));p.set(this.domNode,{opacity:0,display:""});this._set("open",!0);this._onShow();this.resize();this._position();this._fadeInDeferred=new l(O.hitch(this,function(){d.stop();delete this._fadeInDeferred}));this._fadeInDeferred.then(void 0,Q);a=this._fadeInDeferred.promise;var d=q.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:O.hitch(this,function(){N.show(this,this.underlayAttrs)}),onEnd:O.hitch(this,function(){this.autofocus&&N.isTop(this)&&(this._getFocusItems(),
B.focus(this._firstFocusItem));this._fadeInDeferred.resolve(!0);delete this._fadeInDeferred})}).play();return a},hide:function(){if(!this._alreadyInitialized||!this.open)return S.promise;this._fadeInDeferred&&this._fadeInDeferred.cancel();this._fadeOutDeferred=new l(O.hitch(this,function(){d.stop();delete this._fadeOutDeferred}));this._fadeOutDeferred.then(void 0,Q);this._fadeOutDeferred.then(O.hitch(this,"onHide"));var a=this._fadeOutDeferred.promise;var d=q.fadeOut({node:this.domNode,duration:this.duration,
onEnd:O.hitch(this,function(){this.domNode.style.display="none";N.hide(this);this._fadeOutDeferred.resolve(!0);delete this._fadeOutDeferred})}).play();this._scrollConnected&&(this._scrollConnected=!1);for(var h;h=this._modalconnects.pop();)h.remove();this._relativePosition&&delete this._relativePosition;this._set("open",!1);return a},resize:function(a){if("none"!=this.domNode.style.display){this._checkIfSingleChild();if(!a){this._shrunk&&(this._singleChild&&"undefined"!=typeof this._singleChildOriginalStyle&&
(this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle,delete this._singleChildOriginalStyle),A.forEach([this.domNode,this.containerNode,this.titleBar,this.actionBarNode],function(x){x&&p.set(x,{position:"static",width:"auto",height:"auto"})}),this.domNode.style.position="absolute");var d=I.getBox(this.ownerDocument);d.w*=this.maxRatio;d.h*=this.maxRatio;var h=y.position(this.domNode);this._shrunk=!1;h.w>=d.w&&(a={w:d.w},y.setMarginBox(this.domNode,a),h=y.position(this.domNode),this._shrunk=
!0);h.h>=d.h&&(a||(a={w:h.w}),a.h=d.h,this._shrunk=!0);a&&(a.w||(a.w=h.w),a.h||(a.h=h.h))}if(a){y.setMarginBox(this.domNode,a);d=[];this.titleBar&&d.push({domNode:this.titleBar,region:"top"});this.actionBarNode&&d.push({domNode:this.actionBarNode,region:"bottom"});h={domNode:this.containerNode,region:"center"};d.push(h);var E=C.marginBox2contentBox(this.domNode,a);C.layoutChildren(this.domNode,E,d);this._singleChild?(d=C.marginBox2contentBox(this.containerNode,h),this._singleChild.resize({w:d.w,h:d.h})):
(this.containerNode.style.overflow="auto",this._layoutChildren())}else this._layoutChildren();P("touch")||a||this._position()}},_layoutChildren:function(){A.forEach(this.getChildren(),function(a){a.resize&&a.resize()})},destroy:function(){this._fadeInDeferred&&this._fadeInDeferred.cancel();this._fadeOutDeferred&&this._fadeOutDeferred.cancel();this._moveable&&this._moveable.destroy();for(var a;a=this._modalconnects.pop();)a.remove();N.hide(this);this.inherited(arguments)}});P("dojo-bidi")&&(K=g("dijit._DialogBase",
K,{_setTitleAttr:function(a){this._set("title",a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",this.title))}}));var U=g("dijit.Dialog",[u,K],{});U._DialogBase=K;var N=U._DialogLevelManager={_beginZIndex:950,show:function(a,d){k[k.length-1].focus=B.curNode;var h=k[k.length-1].dialog?k[k.length-1].zIndex+2:U._DialogLevelManager._beginZIndex;p.set(a.domNode,"zIndex",h);f.show(d,h-1);
k.push({dialog:a,underlayAttrs:d,zIndex:h})},hide:function(a){if(k[k.length-1].dialog==a){k.pop();var d=k[k.length-1];1==k.length?f.hide():f.show(d.underlayAttrs,d.zIndex-1);if(a.refocus&&(a=d.focus,!d.dialog||a&&v.isDescendant(a,d.dialog.domNode)||(d.dialog._getFocusItems(),a=d.dialog._firstFocusItem),a))try{a.focus()}catch(h){}}else d=A.indexOf(A.map(k,function(h){return h.dialog}),a),-1!=d&&k.splice(d,1)},isTop:function(a){return k[k.length-1].dialog==a}},k=U._dialogStack=[{dialog:null,focus:null,
underlayAttrs:null}];B.watch("curNode",function(a,d,h){a=k[k.length-1].dialog;if(h&&a&&!a._fadeOutDeferred&&h.ownerDocument==a.ownerDocument){do if(h==a.domNode||t.contains(h,"dijitPopup"))return;while(h=h.parentNode);a.focus()}});P("dijit-legacy-requires")&&V(0,function(){G(["dijit/TooltipDialog"])});return U})},"dojo/dnd/TimedMoveable":function(){define(["../_base/declare","./Moveable"],function(G,A){var z=A.prototype.onMove;return G("dojo.dnd.TimedMoveable",A,{timeout:40,constructor:function(g,
l){l||(l={});l.timeout&&"number"==typeof l.timeout&&0<=l.timeout&&(this.timeout=l.timeout)},onMoveStop:function(g){g._timer&&(clearTimeout(g._timer),z.call(this,g,g._leftTop));A.prototype.onMoveStop.apply(this,arguments)},onMove:function(g,l){g._leftTop=l;if(!g._timer){var v=this;g._timer=setTimeout(function(){g._timer=null;z.call(v,g,g._leftTop)},this.timeout)}}})})},"dijit/form/_FormMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/on dojo/window".split(" "),
function(G,A,z,g,l,v){return A("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(t){var y=[];G.forEach(t||this.getChildren(),function(p){"value"in p?y.push(p):y=y.concat(this._getDescendantFormWidgets(p.getChildren()))},this);return y},reset:function(){G.forEach(this._getDescendantFormWidgets(),function(t){t.reset&&t.reset()})},validate:function(){var t=!1;return G.every(G.map(this._getDescendantFormWidgets(),function(y){y._hasBeenBlurred=!0;var p=y.disabled||!y.validate||
y.validate();p||t||(v.scrollIntoView(y.containerNode||y.domNode),y.focus(),t=!0);return p}),function(y){return y})},setValues:function(t){z.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",t)},_setValueAttr:function(t){var y={};G.forEach(this._getDescendantFormWidgets(),function(F){F.name&&(y[F.name]||(y[F.name]=[])).push(F)});for(var p in y)if(y.hasOwnProperty(p)){var q=y[p],n=g.getObject(p,!1,t);void 0!==n&&(n=[].concat(n),
"boolean"==typeof q[0].checked?G.forEach(q,function(F){F.set("value",-1!=G.indexOf(n,F._get("value")))}):q[0].multiple?q[0].set("value",n):G.forEach(q,function(F,O){F.set("value",n[O])}))}},getValues:function(){z.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},_getValueAttr:function(){var t={};G.forEach(this._getDescendantFormWidgets(),function(y){var p=y.name;if(p&&!y.disabled){var q=y.get("value");"boolean"==typeof y.checked?
/Radio/.test(y.declaredClass)?!1!==q?g.setObject(p,q,t):(q=g.getObject(p,!1,t),void 0===q&&g.setObject(p,null,t)):(y=g.getObject(p,!1,t),y||(y=[],g.setObject(p,y,t)),!1!==q&&y.push(q)):(y=g.getObject(p,!1,t),"undefined"!=typeof y?g.isArray(y)?y.push(q):g.setObject(p,[y,q],t):g.setObject(p,q,t))}});return t},isValid:function(){return""==this.state},onValidStateChange:function(){},_getState:function(){var t=G.map(this._descendants,function(y){return y.get("state")||""});return 0<=G.indexOf(t,"Error")?
"Error":0<=G.indexOf(t,"Incomplete")?"Incomplete":""},disconnectChildren:function(){},connectChildren:function(t){this._descendants=this._getDescendantFormWidgets();G.forEach(this._descendants,function(y){y._started||y.startup()});t||this._onChildChange()},_onChildChange:function(t){t&&"state"!=t&&"disabled"!=t||this._set("state",this._getState());t&&"value"!=t&&"disabled"!=t&&"checked"!=t||(this._onChangeDelayTimer&&this._onChangeDelayTimer.remove(),this._onChangeDelayTimer=this.defer(function(){delete this._onChangeDelayTimer;
this._set("value",this.get("value"))},10))},startup:function(){this.inherited(arguments);this._descendants=this._getDescendantFormWidgets();this.value=this.get("value");this.state=this._getState();var t=this;this.own(l(this.containerNode,"attrmodified-state, attrmodified-disabled, attrmodified-value, attrmodified-checked",function(y){y.target!=t.domNode&&t._onChildChange(y.type.replace("attrmodified-",""))}));this.watch("state",function(y,p,q){this.onValidStateChange(""==q)})},destroy:function(){this.inherited(arguments)}})})},
"dijit/_DialogMixin":function(){define(["dojo/_base/declare","./a11y"],function(G,A){return G("dijit._DialogMixin",null,{actionBarTemplate:"",execute:function(){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"))},_getFocusItems:function(){var z=A._getTabNavigable(this.domNode);this._firstFocusItem=z.lowest||z.first||this.closeButtonNode||this.domNode;this._lastFocusItem=z.last||z.highest||this._firstFocusItem}})})},"dijit/DialogUnderlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/dom-attr dojo/dom-style dojo/on dojo/window ./_Widget ./_TemplatedMixin ./BackgroundIframe ./Viewport ./main".split(" "),
function(G,A,z,g,l,v,t,y,p,q,n,F){var O=G("dijit.DialogUnderlay",[y,p],{templateString:"\x3cdiv class\x3d'dijitDialogUnderlayWrapper'\x3e\x3cdiv class\x3d'dijitDialogUnderlay' tabIndex\x3d'-1' data-dojo-attach-point\x3d'node'\x3e\x3c/div\x3e\x3c/div\x3e",dialogId:"","class":"",_modalConnects:[],_setDialogIdAttr:function(H){g.set(this.node,"id",H+"_underlay");this._set("dialogId",H)},_setClassAttr:function(H){this.node.className="dijitDialogUnderlay "+H;this._set("class",H)},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);
this.own(v(this.domNode,"keydown",A.hitch(this,"_onKeyDown")));this.inherited(arguments)},layout:function(){var H=this.node.style,V=this.domNode.style;V.display="none";var P=t.getBox(this.ownerDocument);V.top=P.t+"px";V.left=P.l+"px";H.width=P.w+"px";H.height=P.h+"px";V.display="block"},show:function(){this.domNode.style.display="block";this.open=!0;this.layout();this.bgIframe=new q(this.domNode);var H=t.get(this.ownerDocument);this._modalConnects=[n.on("resize",A.hitch(this,"layout")),v(H,"scroll",
A.hitch(this,"layout"))]},hide:function(){this.bgIframe.destroy();delete this.bgIframe;for(this.domNode.style.display="none";this._modalConnects.length;)this._modalConnects.pop().remove();this.open=!1},destroy:function(){for(;this._modalConnects.length;)this._modalConnects.pop().remove();this.inherited(arguments)},_onKeyDown:function(){}});O.show=function(H,V){var P=O._singleton;!P||P._destroyed?P=F._underlay=O._singleton=new O(H):H&&P.set(H);l.set(P.domNode,"zIndex",V);P.open||P.show()};O.hide=function(){var H=
O._singleton;H&&!H._destroyed&&H.hide()};return O})},"dijit/layout/ContentPane":function(){define("dojo/_base/kernel dojo/_base/lang ../_Widget ../_Container ./_ContentPaneResizeMixin dojo/string dojo/html dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-construct dojo/_base/xhr dojo/i18n dojo/when dojo/i18n!../nls/loading".split(" "),function(G,A,z,g,l,v,t,y,p,q,n,F,O,H,V,P){return p("dijit.layout.ContentPane",[z,g,l],{href:"",content:"",extractContent:!1,parseOnLoad:!0,
parserScope:G._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"\x3cspan class\x3d'dijitContentPaneLoading'\x3e\x3cspan class\x3d'dijitInline dijitIconLoading'\x3e\x3c/span\x3e${loadingState}\x3c/span\x3e",errorMessage:"\x3cspan class\x3d'dijitContentPaneError'\x3e\x3cspan class\x3d'dijitInline dijitIconError'\x3e\x3c/span\x3e${errorState}\x3c/span\x3e",isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:function(w,
I,m){var D=new m(w,I);return!D.href&&D._contentSetter&&D._contentSetter.parseDeferred&&!D._contentSetter.parseDeferred.isFulfilled()?D._contentSetter.parseDeferred.then(function(){return D}):D},create:function(w,I){if(!(w&&w.template||!I||"href"in w||"content"in w)){I=n.byId(I);for(var m=I.ownerDocument.createDocumentFragment();I.firstChild;)m.appendChild(I.firstChild);w=A.delegate(w,{content:m})}this.inherited(arguments,[w,I])},postMixInProperties:function(){this.inherited(arguments);var w=V.getLocalization("dijit",
"loading",this.lang);this.loadingMessage=v.substitute(this.loadingMessage,w);this.errorMessage=v.substitute(this.errorMessage,w)},buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.domNode.removeAttribute("title")},startup:function(){this.inherited(arguments);this._contentSetter&&y.forEach(this._contentSetter.parseResults,function(w){w._started||w._destroyed||!A.isFunction(w.startup)||(w.startup(),w._started=!0)},this)},_startChildren:function(){y.forEach(this.getChildren(),
function(w){w._started||w._destroyed||!A.isFunction(w.startup)||(w.startup(),w._started=!0)});this._contentSetter&&y.forEach(this._contentSetter.parseResults,function(w){w._started||w._destroyed||!A.isFunction(w.startup)||(w.startup(),w._started=!0)},this)},setHref:function(w){G.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.","","2.0");return this.set("href",w)},_setHrefAttr:function(w){this.cancel();this.onLoadDeferred=new q(A.hitch(this,"cancel"));this.onLoadDeferred.then(A.hitch(this,
"onLoad"));this._set("href",w);this.preload||this._created&&this._isShown()?this._load():this._hrefChanged=!0;return this.onLoadDeferred},setContent:function(w){G.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",w)},_setContentAttr:function(w){this._set("href","");this.cancel();this.onLoadDeferred=new q(A.hitch(this,"cancel"));this._created&&this.onLoadDeferred.then(A.hitch(this,"onLoad"));this._setContent(w||"");this._isDownloaded=
!1;return this.onLoadDeferred},_getContentAttr:function(){return this.containerNode.innerHTML},cancel:function(){this._xhrDfd&&-1==this._xhrDfd.fired&&this._xhrDfd.cancel();delete this._xhrDfd;this.onLoadDeferred=null},destroy:function(){this.cancel();this.inherited(arguments)},destroyRecursive:function(w){this._beingDestroyed||this.inherited(arguments)},_onShow:function(){this.inherited(arguments);if(this.href&&!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow))return this.refresh()},
refresh:function(){this.cancel();this.onLoadDeferred=new q(A.hitch(this,"cancel"));this.onLoadDeferred.then(A.hitch(this,"onLoad"));this._load();return this.onLoadDeferred},_load:function(){this._setContent(this.onDownloadStart(),!0);var w=this,I={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text"};A.isObject(this.ioArgs)&&A.mixin(I,this.ioArgs);var m=this._xhrDfd=(this.ioMethod||H.get)(I),D;m.then(function(B){D=B;try{return w._isDownloaded=!0,w._setContent(B,!1)}catch(K){w._onError("Content",
K)}},function(B){m.canceled||w._onError("Download",B);delete w._xhrDfd;return B}).then(function(){w.onDownloadEnd();delete w._xhrDfd;return D});delete this._hrefChanged},_onLoadHandler:function(w){this._set("isLoaded",!0);try{this.onLoadDeferred.resolve(w)}catch(I){}},_onUnloadHandler:function(){this._set("isLoaded",!1);try{this.onUnload()}catch(w){}},destroyDescendants:function(w){this.isLoaded&&this._onUnloadHandler();var I=this._contentSetter;y.forEach(this.getChildren(),function(m){m.destroyRecursive?
m.destroyRecursive(w):m.destroy&&m.destroy(w);m._destroyed=!0});I&&(y.forEach(I.parseResults,function(m){m._destroyed||(m.destroyRecursive?m.destroyRecursive(w):m.destroy&&m.destroy(w),m._destroyed=!0)}),delete I.parseResults);w||O.empty(this.containerNode);delete this._singleChild},_setContent:function(w,I){w=this.preprocessContent(w);this.destroyDescendants();var m=this._contentSetter;m&&m instanceof t._ContentSetter||(m=this._contentSetter=new t._ContentSetter({node:this.containerNode,_onError:A.hitch(this,
this._onError),onContentError:A.hitch(this,function(K){K=this.onContentError(K);try{this.containerNode.innerHTML=K}catch(M){}})}));var D=A.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!w.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:!1,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{});D=m.set(A.isObject(w)&&w.domNode?w.domNode:w,D);var B=this;return P(D&&D.then?D:m.parseDeferred,function(){delete B._contentSetterParams;
I||(B._started&&(B._startChildren(),B._scheduleLayout()),B._onLoadHandler(w))})},preprocessContent:function(w){return w},_onError:function(w,I,m){this.onLoadDeferred.reject(I);w=this["on"+w+"Error"].call(this,I);m||w&&this._setContent(w,!0)},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})},"dijit/layout/_ContentPaneResizeMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/query ../registry ../Viewport ./utils".split(" "),
function(G,A,z,g,l,v,t,y,p,q){return A("dijit.layout._ContentPaneResizeMixin",null,{doLayout:!0,isLayoutContainer:!0,startup:function(){if(!this._started){var n=this.getParent();this._childOfLayoutWidget=n&&n.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._isShown()&&this._onShow();this._childOfLayoutWidget||this.own(p.on("resize",v.hitch(this,"resize")))}},_checkIfSingleChild:function(){if(this.doLayout){var n=[],F=!1;t("\x3e *",this.containerNode).some(function(O){var H=
y.byNode(O);H&&H.resize?n.push(H):!/script|link|style/i.test(O.nodeName)&&O.offsetHeight&&(F=!0)});this._singleChild=1!=n.length||F?null:n[0];z.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild)}},resize:function(n,F){this._resizeCalled=!0;this._scheduleLayout(n,F)},_scheduleLayout:function(n,F){this._isShown()?this._layout(n,F):(this._needLayout=!0,this._changeSize=n,this._resultSize=F)},_layout:function(n,F){delete this._needLayout;this._wasShown||!1===this.open||this._onShow();
n&&g.setMarginBox(this.domNode,n);var O=this.containerNode;if(O===this.domNode){var H=F||{};v.mixin(H,n||{});"h"in H&&"w"in H||(H=v.mixin(g.getMarginBox(O),H));this._contentBox=q.marginBox2contentBox(O,H)}else this._contentBox=g.getContentBox(O);this._layoutChildren()},_layoutChildren:function(){this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){var n=this._contentBox||g.getContentBox(this.containerNode);this._singleChild.resize({w:n.w,h:n.h})}else{n=this.getChildren();for(var F,
O=0;F=n[O++];)F.resize&&F.resize()}},_isShown:function(){if(this._childOfLayoutWidget)return this._resizeCalled&&"open"in this?this.open:this._resizeCalled;if("open"in this)return this.open;var n=this.domNode,F=this.domNode.parentNode;return"none"!=n.style.display&&"hidden"!=n.style.visibility&&!z.contains(n,"dijitHidden")&&F&&F.style&&"none"!=F.style.display},_onShow:function(){this._wasShown=!0;this._needLayout&&this._layout(this._changeSize,this._resultSize);this.inherited(arguments)}})})},"dijit/layout/utils":function(){define(["dojo/_base/array",
"dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang"],function(G,A,z,g,l){function v(p){return p.substring(0,1).toUpperCase()+p.substring(1)}function t(p,q){var n=p.resize?p.resize(q):z.setMarginBox(p.domNode,q);n?l.mixin(p,n):(l.mixin(p,z.getMarginBox(p.domNode)),l.mixin(p,q))}var y={marginBox2contentBox:function(p,q){var n=g.getComputedStyle(p),F=z.getMarginExtents(p,n),O=z.getPadBorderExtents(p,n);return{l:g.toPixelValue(p,n.paddingLeft),t:g.toPixelValue(p,n.paddingTop),w:q.w-
(F.w+O.w),h:q.h-(F.h+O.h)}},layoutChildren:function(p,q,n,F,O){q=l.mixin({},q);A.add(p,"dijitLayoutContainer");n=G.filter(n,function(H){return"center"!=H.region&&"client"!=H.layoutAlign}).concat(G.filter(n,function(H){return"center"==H.region||"client"==H.layoutAlign}));G.forEach(n,function(H){var V=H.domNode,P=H.region||H.layoutAlign;if(!P)throw Error("No region setting for "+H.id);var w=V.style;w.left=q.l+"px";w.top=q.t+"px";w.position="absolute";A.add(V,"dijitAlign"+v(P));V={};F&&F==H.id&&(V["top"==
H.region||"bottom"==H.region?"h":"w"]=O);"leading"==P&&(P=H.isLeftToRight()?"left":"right");"trailing"==P&&(P=H.isLeftToRight()?"right":"left");"top"==P||"bottom"==P?(V.w=q.w,t(H,V),q.h-=H.h,"top"==P?q.t+=H.h:w.top=q.t+q.h+"px"):"left"==P||"right"==P?(V.h=q.h,t(H,V),q.w-=H.w,"left"==P?q.l+=H.w:w.left=q.l+q.w+"px"):"client"!=P&&"center"!=P||t(H,q)})}};l.setObject("dijit.layout.utils",y);return y})},"dojo/html":function(){define("./_base/kernel ./_base/lang ./_base/array ./_base/declare ./dom ./dom-construct ./parser".split(" "),
function(G,A,z,g,l,v,t){var y=0,p={_secureForInnerHtml:function(q){return q.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,"")},_emptyNode:v.empty,_setNodeContent:function(q,n){v.empty(q);if(n)if("number"==typeof n&&(n=n.toString()),"string"==typeof n&&(n=v.toDom(n,q.ownerDocument)),!n.nodeType&&A.isArrayLike(n))for(var F=n.length,O=0;O<n.length;O=F==n.length?O+1:0)v.place(n[O],q,"last");else v.place(n,q,"last");return q},_ContentSetter:g("dojo.html._ContentSetter",null,{node:"",
content:"",id:"",cleanContent:!1,extractContent:!1,parseContent:!1,parserScope:G._scopeName,startup:!0,constructor:function(q,n){A.mixin(this,q||{});n=this.node=l.byId(this.node||n);this.id||(this.id=["Setter",n?n.id||n.tagName:"",y++].join("_"))},set:function(q,n){void 0!==q&&(this.content=q);"number"==typeof q&&(q=q.toString());n&&this._mixin(n);this.onBegin();this.setContent();var F=this.onEnd();return F&&F.then?F:this.node},setContent:function(){var q=this.node;if(!q)throw Error(this.declaredClass+
": setContent given no node");try{q=p._setNodeContent(q,this.content)}catch(F){var n=this.onContentError(F);try{q.innerHTML=n}catch(O){}}this.node=q},empty:function(){this.parseDeferred&&(this.parseDeferred.isResolved()||this.parseDeferred.cancel(),delete this.parseDeferred);this.parseResults&&this.parseResults.length&&(z.forEach(this.parseResults,function(q){q.destroy&&q.destroy()}),delete this.parseResults);v.empty(this.node)},onBegin:function(){var q=this.content;if(A.isString(q)&&(this.cleanContent&&
(q=p._secureForInnerHtml(q)),this.extractContent)){var n=q.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);n&&(q=n[1])}this.empty();this.content=q;return this.node},onEnd:function(){this.parseContent&&this._parse();return this.node},tearDown:function(){delete this.parseResults;delete this.parseDeferred;delete this.node;delete this.content},onContentError:function(q){return"Error occurred setting content: "+q},onExecError:function(q){return"Error occurred executing scripts: "+q},_mixin:function(q){var n=
{},F;for(F in q)F in n||(this[F]=q[F])},_parse:function(){var q=this.node;try{var n={};z.forEach(["dir","lang","textDir"],function(O){this[O]&&(n[O]=this[O])},this);var F=this;this.parseDeferred=t.parse({rootNode:q,noStart:!this.startup,inherited:n,scope:this.parserScope}).then(function(O){return F.parseResults=O},function(O){F._onError("Content",O,"Error parsing in _ContentSetter#"+F.id)})}catch(O){this._onError("Content",O,"Error parsing in _ContentSetter#"+this.id)}},_onError:function(q,n,F){q=
this["on"+q+"Error"].call(this,n);F||q&&p._setNodeContent(this.node,q,!0)}}),set:function(q,n,F){void 0==n&&(n="");"number"==typeof n&&(n=n.toString());return F?(new p._ContentSetter(A.mixin(F,{content:n,node:q}))).set():p._setNodeContent(q,n,!0)}};A.setObject("dojo.html",p);return p})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),
function(G,A,z,g,l,v,t,y,p,q,n,F,O,H,V,P){function w(K){return eval("("+K+")")}function I(K){var M=K._nameCaseMap,R=K.prototype;if(!M||M._extendCnt<D){M=K._nameCaseMap={};for(var c in R)"_"!==c.charAt(0)&&(M[c.toLowerCase()]=c);M._extendCnt=D}return M}function m(K,M){M||(M=G);var R=M._dojoParserCtorMap||(M._dojoParserCtorMap={}),c=K.join();if(!R[c]){for(var b=[],e=0,f=K.length;e<f;e++){var u=K[e];b[b.length]=R[u]=R[u]||z.getObject(u)||~u.indexOf("/")&&M(u)}e=b.shift();R[c]=b.length?e.createSubclass?
e.createSubclass(b):e.extend.apply(e,b):e}return R[c]}new Date("X");var D=0;p.after(z,"extend",function(){D++},!0);var B={_clearCache:function(){D++;_ctorMap={}},_functionFromScript:function(K,M){var R="",c="",b=K.getAttribute(M+"args")||K.getAttribute("args"),e=K.getAttribute("with");b=(b||"").split(/\s*,\s*/);e&&e.length&&g.forEach(e.split(/\s*,\s*/),function(f){R+="with("+f+"){";c+="}"});return new Function(b,R+K.innerHTML+c)},instantiate:function(K,M,R){M=M||{};R=R||{};var c=(R.scope||A._scopeName)+
"Type",b="data-"+(R.scope||A._scopeName)+"-",e=b+"type",f=b+"mixins",u=[];g.forEach(K,function(C){var L=c in M?M[c]:C.getAttribute(e)||C.getAttribute(c);if(L){var Q=C.getAttribute(f);L=Q?[L].concat(Q.split(/\s*,\s*/)):[L];u.push({node:C,types:L})}});return this._instantiate(u,M,R)},_instantiate:function(K,M,R,c){function b(e){M._started||R.noStart||g.forEach(e,function(f){"function"!==typeof f.startup||f._started||f.startup()});return e}K=g.map(K,function(e){var f=e.ctor||m(e.types,R.contextRequire);
if(!f)throw Error("Unable to resolve constructor for: '"+e.types.join()+"'");return this.construct(f,e.node,M,R,e.scripts,e.inherited)},this);return c?q(K).then(b):b(K)},construct:function(K,M,R,c,b,e){function f(T){k&&z.setObject(k,T);for(U=0;U<E.length;U++)p[E[U].advice||"after"](T,E[U].method,z.hitch(T,E[U].func),!0);for(U=0;U<x.length;U++)x[U].call(T);for(U=0;U<r.length;U++)T.watch(r[U].prop,r[U].func);for(U=0;U<J.length;U++)V(T,J[U].event,J[U].func);return T}var u=K&&K.prototype;c=c||{};var C=
{};c.defaults&&z.mixin(C,c.defaults);e&&z.mixin(C,e);if(O("dom-attributes-explicit"))var L=M.attributes;else O("dom-attributes-specified-flag")?L=g.filter(M.attributes,function(T){return T.specified}):(e=(/^input$|^img$/i.test(M.nodeName)?M:M.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),L=g.map(e.split(/\s+/),function(T){var X=T.toLowerCase();return{name:T,value:"LI"==M.nodeName&&"value"==T||"enctype"==X?M.getAttribute(X):
M.getAttributeNode(X).value}}));var Q=c.scope||A._scopeName;e="data-"+Q+"-";var S={};"dojo"!==Q&&(S[e+"props"]="data-dojo-props",S[e+"type"]="data-dojo-type",S[e+"mixins"]="data-dojo-mixins",S[Q+"type"]="dojotype",S[e+"id"]="data-dojo-id");var U=0,N;Q=[];for(var k,a;N=L[U++];){var d=N.name,h=d.toLowerCase();N=N.value;switch(S[h]||h){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":a=N;break;case "data-dojo-id":case "jsid":k=N;break;case "data-dojo-attach-point":case "dojoattachpoint":C.dojoAttachPoint=
N;break;case "data-dojo-attach-event":case "dojoattachevent":C.dojoAttachEvent=N;break;case "class":C["class"]=M.className;break;case "style":C.style=M.style&&M.style.cssText;break;default:if(d in u||(d=I(K)[h]||d),d in u)switch(typeof u[d]){case "string":C[d]=N;break;case "number":C[d]=N.length?Number(N):NaN;break;case "boolean":C[d]="false"!=N.toLowerCase();break;case "function":""===N||-1!=N.search(/[^\w\.]+/i)?C[d]=new Function(N):C[d]=z.getObject(N,!1)||new Function(N);Q.push(d);break;default:h=
u[d],C[d]=h&&"length"in h?N?N.split(/\s*,\s*/):[]:h instanceof Date?""==N?new Date(""):"now"==N?new Date:n.fromISOString(N):h instanceof y?A.baseUrl+N:w(N)}else C[d]=N}}for(L=0;L<Q.length;L++)S=Q[L].toLowerCase(),M.removeAttribute(S),M[S]=null;if(a)try{a=w.call(c.propsThis,"{"+a+"}"),z.mixin(C,a)}catch(T){throw Error(T.toString()+" in data-dojo-props\x3d'"+a+"'");}z.mixin(C,R);b||(b=K&&(K._noScript||u._noScript)?[]:H("\x3e script[type^\x3d'dojo/']",M));var E=[],x=[],r=[],J=[];if(b)for(U=0;U<b.length;U++)S=
b[U],M.removeChild(S),R=S.getAttribute(e+"event")||S.getAttribute("event"),c=S.getAttribute(e+"prop"),a=S.getAttribute(e+"method"),Q=S.getAttribute(e+"advice"),L=S.getAttribute("type"),S=this._functionFromScript(S,e),R?"dojo/connect"==L?E.push({method:R,func:S}):"dojo/on"==L?J.push({event:R,func:S}):C[R]=S:"dojo/aspect"==L?E.push({method:a,advice:Q,func:S}):"dojo/watch"==L?r.push({prop:c,func:S}):x.push(S);K=(b=K.markupFactory||u.markupFactory)?b(C,M,K):new K(C,M);return K.then?K.then(f):f(K)},scan:function(K,
M){function R(E){if(!E.inherited){E.inherited={};var x=E.node,r=R(E.parent);x={dir:x.getAttribute("dir")||r.dir,lang:x.getAttribute("lang")||r.lang,textDir:x.getAttribute(L)||r.textDir};for(var J in x)x[J]&&(E.inherited[J]=x[J])}return E.inherited}var c=[],b=[],e={},f=(M.scope||A._scopeName)+"Type",u="data-"+(M.scope||A._scopeName)+"-",C=u+"type",L=u+"textdir";u+="mixins";var Q=K.firstChild,S=M.inherited;if(!S){S=function J(x,r){return x.getAttribute&&x.getAttribute(r)||x.parentNode&&J(x.parentNode,
r)};S={dir:S(K,"dir"),lang:S(K,"lang"),textDir:S(K,L)};for(var U in S)S[U]||delete S[U]}S={inherited:S};for(var N,k;;)if(Q)if(1!=Q.nodeType)Q=Q.nextSibling;else if(N&&"script"==Q.nodeName.toLowerCase())(a=Q.getAttribute("type"))&&/^dojo\/\w/i.test(a)&&N.push(Q),Q=Q.nextSibling;else if(k)Q=Q.nextSibling;else{var a=Q.getAttribute(C)||Q.getAttribute(f);U=Q.firstChild;if(a||U&&(3!=U.nodeType||U.nextSibling)){k=null;if(a){var d=Q.getAttribute(u);N=d?[a].concat(d.split(/\s*,\s*/)):[a];try{k=m(N,M.contextRequire)}catch(E){}k||
g.forEach(N,function(E){~E.indexOf("/")&&!e[E]&&(e[E]=!0,b[b.length]=E)});d=k&&!k.prototype._noScript?[]:null;S={types:N,ctor:k,parent:S,node:Q,scripts:d};S.inherited=R(S);c.push(S)}else S={node:Q,scripts:N,parent:S};N=d;k=Q.stopParser||k&&k.prototype.stopParser&&!M.template;Q=U}else Q=Q.nextSibling}else{if(!S||!S.node)break;Q=S.node.nextSibling;k=!1;S=S.parent;N=S.scripts}var h=new F;b.length?(M.contextRequire||G)(b,function(){h.resolve(g.filter(c,function(E){if(!E.ctor)try{E.ctor=m(E.types,M.contextRequire)}catch(J){}for(var x=
E.parent;x&&!x.types;)x=x.parent;var r=E.ctor&&E.ctor.prototype;E.instantiateChildren=!(r&&r.stopParser&&!M.template);E.instantiate=!x||x.instantiate&&x.instantiateChildren;return E.instantiate}))}):h.resolve(c);return h.promise},_require:function(K,M){var R=w("{"+K.innerHTML+"}"),c=[],b=[],e=new F,f=M&&M.contextRequire||G,u;for(u in R)c.push(u),b.push(R[u]);f(b,function(){for(var C=0;C<c.length;C++)z.setObject(c[C],arguments[C]);e.resolve(arguments)});return e.promise},_scanAmd:function(K,M){var R=
new F,c=R.promise;R.resolve(!0);var b=this;H("script[type\x3d'dojo/require']",K).forEach(function(e){c=c.then(function(){return b._require(e,M)});e.parentNode.removeChild(e)});return c},parse:function(K,M){!K||"string"==typeof K||"nodeType"in K||(M=K,K=M.rootNode);var R=K?v.byId(K):t.body();M=M||{};var c=M.template?{template:!0}:{},b=[],e=this,f=this._scanAmd(R,M).then(function(){return e.scan(R,M)}).then(function(u){return e._instantiate(u,c,M,!0)}).then(function(u){return b=b.concat(u)}).otherwise(function(u){throw u;
});z.mixin(b,f);return b}};A.parser=B;l.parseOnLoad&&P(100,B,"parse");return B})},"dojo/promise/all":function(){define(["../_base/array","../_base/lang","../Deferred","../when"],function(G,A,z,g){var l=G.some;return function(v){var t,y;A.isArray(v)?y=v:v&&"object"===typeof v&&(t=v);var p=[];if(t){y=[];for(var q in t)Object.hasOwnProperty.call(t,q)&&(p.push(q),y.push(t[q]));var n={}}else y&&(n=[]);if(!y||!y.length)return(new z).resolve(n);var F=new z;F.promise.always(function(){n=p=null});var O=y.length;
l(y,function(H,V){t||p.push(V);g(H,function(P){F.isFulfilled()||(n[p[V]]=P,0===--O&&F.resolve(n))},F.reject);return F.isFulfilled()});return F.promise}})},"esri/kernel":function(){define(["dojo/_base/kernel","dojo/_base/config","dojo/has"],function(G,A,z){G=function(){return this}();var g=G.location,l=g.pathname;z=g.protocol;g={version:"3.41",_appBaseUrl:z+"//"+g.host+l.substring(0,l.lastIndexOf(l.split("/")[l.split("/").length-1]))};A.noGlobals||(G.esri=g);(g.dijit=g.dijit||{})._arcgisUrl=("http:"===
z||"https:"===z?z:"http:")+"//www.arcgis.com/sharing/rest";return g})},"esri/lang":function(){define("dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/_base/lang dojo/date dojo/has dojo/number dojo/date/locale ./kernel".split(" "),function(G,A,z,g,l,v,t,y,p){function q(I,m,D,B){(m=m&&m[I])?m={formatType:m.formatType,options:m}:B&&-1!==G.indexOf(B.properties||"",I)?m={formatType:B.formatter||"DateString",options:null}:D&&-1!==G.indexOf(D.properties||"",I)&&(m={formatType:D.formatter||"NumberFormat",
options:null});return m}function n(I,m,D){return[g.isString(I)?I.split(""):I,m||z.global,g.isString(D)?new Function("item","index","array",D):D]}function F(I){return void 0!==I&&null!==I}function O(I){return F(I)?I:""}function H(I,m,D,B){var K=D.match(/([^\(]+)(\([^\)]+\))?/i);D=g.trim(K[1]);var M=K[2]?g.trim(K[2]):null;K=m[I];B=B||(M?A.fromJson(M.replace(/^\(/,"({").replace(/\)$/,"})")):{});M=B.utcOffset;if(-1===G.indexOf(P,D))D=g.getObject(D),g.isFunction(D)&&(K=D(K,I,m,B));else if("number"===typeof K||
"string"===typeof K&&K&&!isNaN(Number(K)))switch(K=Number(K),D){case "NumberFormat":return t.format(K,B);case "DateString":I=new Date(K);if(B.local||B.systemLocale)return B.systemLocale?I.toLocaleDateString()+(B.hideTime?"":" "+I.toLocaleTimeString()):I.toDateString()+(B.hideTime?"":" "+I.toTimeString());I=I.toUTCString();B.hideTime&&(I=I.replace(/\s+\d\d:\d\d:\d\d\s+(utc|gmt)/i,""));return I;case "DateFormat":return I=new Date(K),F(M)&&(I=l.add(I,"minute",I.getTimezoneOffset()-M)),y.format(I,B)}return O(K)}
function V(I,m){var D;if(m)for(D in I)I.hasOwnProperty(D)&&(void 0===I[D]?delete I[D]:I[D]instanceof Object&&V(I[D],!0));else for(D in I)I.hasOwnProperty(D)&&void 0===I[D]&&delete I[D];return I}var P=["NumberFormat","DateString","DateFormat"],w=/<\/?[^>]+>/g;v={valueOf:function(I,m){for(var D in I)if(I[D]==m)return D;return null},stripTags:function(I){if(I){var m=typeof I;if("string"===m)I=I.replace(w,"");else if("object"===m)for(var D in I)(m=I[D])&&"string"===typeof m&&(m=m.replace(w,"")),I[D]=
m}return I},substitute:function(I,m,D){if(F(D))if(g.isObject(D)){var B=D.first;var K=D.dateFormat;var M=D.numberFormat;var R=D.format}else B=D;if(m&&"${*}"!==m)return g.replace(m,g.hitch({obj:I},function(b,e){var f=e.split(":"),u;return 1<f.length?(e=f[0],f.shift(),(u=R&&R[f[0]])?f=u.formatType:(f=f.join(":"),u=null),H(e,this.obj,f,u)):(u=q(e,R,M,K))?H(e,this.obj,u.formatType,u.options):O(this.obj[e])}),/\$\{([^\}]+)\}/g);m=[];for(var c in I)if(D=(D=q(c,R,M,K))?H(c,I,D.formatType,D.options):I[c],
m.push(c+" \x3d "+O(D)+"\x3cbr/\x3e"),B)break;return m.join("")},filter:function(I,m,D){m=n(I,D,m);D={};var B;I=m[0];for(B in I)m[2].call(m[B],I[B],B,I)&&(D[B]=I[B]);return D},startsWith:function(I,m,D){D=D||0;return I.indexOf(m,D)===D},endsWith:function(I,m,D){if("number"!==typeof D||!isFinite(D)||Math.floor(D)!==D||D>I.length)D=I.length;D-=m.length;I=I.indexOf(m,D);return-1!==I&&I===D},isDefined:F,fixJson:V,isObject:function(I){return I&&"object"===typeof I},isString:function(I){return"string"===
typeof I},mixin:function(I,m){for(var D in m)m.hasOwnProperty(D)&&(I[D]=m[D]);return I},clone2DArray:function(I){if(I=I?I.slice(0):null){var m,D=I.length;for(m=0;m<D;m++)I[m]=I[m]?I[m].slice(0):null}return I},clone3DArray:function(I){if(I=I?I.slice(0):null){var m,D=I.length;for(m=0;m<D;m++){I[m]=I[m]?I[m].slice(0):null;var B=I[m];if(B){var K,M=B.length;for(K=0;K<M;K++)B[K]=B[K]?B[K].slice(0):null}}}return I}};g.mixin(p,v);p._isDefined=F;p._getParts=n;p._sanitize=V;return v})},"esri/domUtils":function(){define(["./kernel",
"dojo/_base/connect","dojo/_base/lang","dojo/dom-style","dojo/has"],function(G,A,z,g,l){var v={show:function(t){if(t=v.getNode(t))t.style.display="block"},getNode:function(t){return t&&t.domNode||t},hide:function(t){if(t=v.getNode(t))t.style.display="none"},toggle:function(t){if(t=v.getNode(t))t.style.display="none"===t.style.display?"block":"none"},documentBox:8>=l("ie")?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:window.innerWidth,h:window.innerHeight},setScrollable:function(t){if(t=
this.getNode(t)){var y=0,p=0,q=0,n=0,F=0,O=0;return[A.connect(t,"ontouchstart",function(H){y=H.touches[0].screenX;p=H.touches[0].screenY;q=t.scrollWidth;n=t.scrollHeight;F=t.clientWidth;O=t.clientHeight}),A.connect(t,"ontouchmove",function(H){H.preventDefault();var V=t.firstChild;V instanceof Text&&(V=t.childNodes[1]);var P=V._currentX||0,w=V._currentY||0;P+=H.touches[0].screenX-y;0<P?P=0:0>P&&Math.abs(P)+F>q&&(P=-1*(q-F));V._currentX=P;w+=H.touches[0].screenY-p;0<w?w=0:0>w&&Math.abs(w)+O>n&&(w=-1*
(n-O));V._currentY=w;g.set(V,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+P+"px, "+w+"px)"});y=H.touches[0].screenX;p=H.touches[0].screenY})]}}};z.mixin(G,v);return v})},"esri/Credential":function(){define(["dojo/_base/declare","dojo/has","./kernel","./IdentityManagerBase"],function(G,A,z,g){G=G(g.Credential,{});return z.Credential=G})},"esri/IdentityManagerBase":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/url dojo/sniff dojo/io-query dojo/on ./kernel ./config ./lang ./ServerInfo ./urlUtils ./deferredUtils ./request ./Evented ./OAuthCredential ./arcgis/OAuthInfo".split(" "),
function(G,A,z,g,l,v,t,y,p,q,n,F,O,H,V,P,w,I,m){var D={},B=function(b){var e=(new v(b.owningSystemUrl)).host;b=(new v(b.server)).host;var f=/.+\.arcgis\.com$/i;return f.test(e)&&f.test(b)},K=function(b,e){return!!(B(b)&&e&&g.some(e,function(f){return f.test(b.server)}))},M=null,R=null;try{M=window.localStorage,R=window.sessionStorage}catch(b){}t=G(w,{declaredClass:"esri.IdentityManagerBase",constructor:function(){this._portalConfig=z.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=
[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=[];this._getOAuthLocationParams();p(window,"pageshow",z.hitch(this,this._pageShowHandler))},defaultOAuthInfo:null,defaultTokenValidity:60,tokenValidity:null,normalizeWebTierAuth:!1,_appUrlObj:H.urlToObject(window.location.href),_postMessageAuthHandle:null,_busy:null,_rejectOnPersistedPageShow:!1,_oAuthLocationParams:null,_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/(https?:\/\/[^\/]+\/[^\/]+)\/admin\/?(\/.*)?$/i,
_adminSvcs:/\/rest\/admin\/services(\/|$)/i,_gwDomains:[{regex:/^https?:\/\/www\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},{regex:/^https?:\/\/(?:dev|[a-z\d-]+\.mapsdev)\.arcgis\.com/i,customBaseUrl:"mapsdev.arcgis.com",tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},{regex:/^https?:\/\/(?:devext|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,customBaseUrl:"mapsdevext.arcgis.com",tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},
{regex:/^https?:\/\/(?:qaext|[a-z\d-]+\.mapsqa)\.arcgis\.com/i,customBaseUrl:"mapsqa.arcgis.com",tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/^https?:\/\/[a-z\d-]+\.maps\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],_regexSDirUrl:/http.+\/rest\/services\/?/ig,_regexServerType:/(\/(FeatureServer|GPServer|GeoDataServer|GeocodeServer|GeoenrichmentServer|GeometryServer|GlobeServer|ImageServer|KnowledgeGraphServer|MapServer|MobileServer|NAServer|NetworkDiagramServer|OGCFeatureServer|ParcelFabricServer|RelationalCatalogServer|SceneServer|StreamServer|UtilityNetworkServer|ValidationServer|VectorTileServer|VersionManagementServer)).*/ig,
_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],_createDefaultOAuthInfo:!0,_hasTestedIfAppIsOnPortal:!1,registerServers:function(b){var e=this.serverInfos;e?(b=g.filter(b,function(f){return!this.findServerInfo(f.server)},this),this.serverInfos=e.concat(b)):
this.serverInfos=b;g.forEach(b,function(f){f.owningSystemUrl&&this._portals.push(f.owningSystemUrl);if(f.hasPortal){this._portals.push(f.server);var u=n.defaults.io.corsEnabledServers,C=this._getOrigin(f.tokenServiceUrl);H.canUseXhr(f.server)||u.push(f.server.replace(/^https?:\/\//i,""));H.canUseXhr(C)||u.push(C.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:function(b){var e=this.oAuthInfos;e?(g.forEach(b,function(f){(f=this.findOAuthInfo(f.portalUrl))&&e.splice(e.indexOf(f),1)},this),
this.oAuthInfos=e.concat(b)):this.oAuthInfos=b},registerToken:function(b){b=F.mixin({},b);var e=this._sanitizeUrl(b.server),f=this.findServerInfo(e),u=!0,C;f||(f=new O,f.server=this._getServerInstanceRoot(e),f.tokenServiceUrl=this._getTokenSvcUrl(e),f.hasPortal=!0,this.registerServers([f]));(C=this.findCredential(e,b.userId))?(delete b.server,z.mixin(C,b),u=!1):(C=new c({userId:b.userId,server:f.server,token:b.token,expires:b.expires,ssl:b.ssl,scope:this._isServerRsrc(e)?"server":"portal"}),C.resources=
[e],this.credentials.push(C));C.onTokenChange(!1);u||C.refreshServerTokens()},toJson:function(){return F.fixJson({serverInfos:g.map(this.serverInfos,function(b){return b.toJson()}),oAuthInfos:g.map(this.oAuthInfos,function(b){return b.toJson()}),credentials:g.map(this.credentials,function(b){return b.toJson()})})},initialize:function(b){if(b){z.isString(b)&&(b=JSON.parse(b));var e=b.serverInfos,f=b.oAuthInfos;b=b.credentials;if(e){var u=[];g.forEach(e,function(L){L.server&&L.tokenServiceUrl&&u.push(L.declaredClass?
L:new O(L))});u.length&&this.registerServers(u)}if(f){var C=[];g.forEach(f,function(L){L.appId&&C.push(L.declaredClass?L:new m(L))});C.length&&this.registerOAuthInfos(C)}b&&g.forEach(b,function(L){L.userId&&L.server&&L.token&&L.expires&&L.expires>(new Date).getTime()&&(L=L.declaredClass?L:new c(L),L.onTokenChange(),this.credentials.push(L))},this)}},findServerInfo:function(b){var e;b=this._sanitizeUrl(b);g.some(this.serverInfos,function(f){this._hasSameServerInstance(f.server,b)&&(e=f);return!!e},
this);return e},findOAuthInfo:function(b){var e;b=this._sanitizeUrl(b);g.some(this.oAuthInfos,function(f){this._hasSameServerInstance(f.portalUrl,b)&&(e=f);return!!e},this);return e},findCredential:function(b,e){var f;b=this._sanitizeUrl(b);var u=this._isServerRsrc(b)?"server":"portal";e?g.some(this.credentials,function(C){this._hasSameServerInstance(C.server,b)&&e===C.userId&&C.scope===u&&(f=C);return!!f},this):g.some(this.credentials,function(C){this._hasSameServerInstance(C.server,b)&&-1!==this._getIdenticalSvcIdx(b,
C)&&C.scope===u&&(f=C);return!!f},this);return f},getCredential:function(b,e){var f=!0;if(F.isDefined(e))if(z.isObject(e)){var u=!!e.token;var C=e.error;f=!1!==e.prompt}else u=e;b=this._sanitizeUrl(b);var L=new l(V._dfdCanceller),Q=this._isAdminResource(b);if((u=u?this.findCredential(b):null)&&C&&498===C.code)u.destroy();else if(u)return f=Error("You are currently signed in as: '"+u.userId+"'. You do not have access to this resource: "+b),f.name="identity-manager:not-authorized",f.code="IdentityManagerBase.1",
f.httpCode=C&&C.httpCode,f.messageCode=C?C.messageCode:null,f.subcode=C?C.subcode:null,f.details=C?C.details:null,f.log=!!A.isDebug,L.errback(f),L;if(C=this._findCredential(b,e))return L.callback(C),L;var S=this.findServerInfo(b);if(S)!S.hasServer&&this._isServerRsrc(b)&&(S._restInfoDfd=this._getTokenSvcUrl(b,!0),S.hasServer=!0);else{C=this._getTokenSvcUrl(b);if(!C)return f=Error("Unknown resource - could not find token service endpoint."),f.name="identity-manager:unknown-resource",f.code="IdentityManagerBase.2",
f.log=!!A.isDebug,L.errback(f),L;S=new O;S.server=this._getServerInstanceRoot(b);z.isString(C)?(S.tokenServiceUrl=C,S.hasPortal=!0):(S._restInfoDfd=C,S.hasServer=!0);this.registerServers([S])}S.hasPortal&&void 0===S._selfReq&&(f||H.hasSameOrigin(S.tokenServiceUrl,window.location.origin)||this._gwDomains.some(function(U){return U.tokenServiceUrl===S.tokenServiceUrl}))&&(S._selfReq={owningTenant:e&&e.owningTenant,selfDfd:this._getPortalSelf(S.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),
b)});return this._enqueue(b,S,e,L,Q)},getResourceName:function(b){return this._isRESTService(b)?b.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(b)&&b.replace(this._gwUser,"$1")||this._gwItem.test(b)&&b.replace(this._gwItem,"$1")||this._gwGroup.test(b)&&b.replace(this._gwGroup,"$1")||""},generateToken:function(b,e,f){var u=this._rePortalTokenSvc.test(b.tokenServiceUrl),C=new v(window.location.href.toLowerCase()),L=!e;var Q=b.shortLivedTokenValidity;if(e){var S=
q.id.tokenValidity||Q||q.id.defaultTokenValidity;S>Q&&(S=Q)}if(f){var U=f.isAdmin;var N=f.serverUrl;var k=f.token;var a=f.ssl;b.customParameters=f.customParameters}if(U)Q=b.adminTokenServiceUrl;else{Q=b.tokenServiceUrl;var d=new v(Q.toLowerCase());b.webTierAuth&&f&&f.serverUrl&&!a&&"http"===C.scheme&&(H.hasSameOrigin(C.uri,Q,!0)||"https"===d.scheme&&C.host===d.host&&"7080"===C.port&&"7443"===d.port)&&(Q=Q.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));L&&u&&(Q=Q.replace(/\/rest/i,""))}U=z.mixin({url:Q,
content:z.mixin({request:"getToken",username:e&&e.username,password:e&&e.password,serverUrl:N,token:k,expiration:S,referer:U||u?window.location.host:null,client:U?"referer":null,f:"json"},b.customParameters),handleAs:"json",callbackParamName:L?"callback":void 0},f&&f.ioArgs);f={usePost:!L,disableIdentityLookup:!0,useProxy:this._useProxy(b,f)};u||(U.withCredentials=!1);u=P(U,f);u.addCallback(function(h){if(!h||!h.token)return h=Error("Unable to generate token"),h.name="identity-manager:authentication-failed",
h.code="IdentityManagerBase.3",h.log=!!A.isDebug,h;var E=b.server;D[E]||(D[E]={});e&&(D[E][e.username]=e.password);h.validity=S;return h});u.addErrback(function(h){});return u},isBusy:function(){return!!this._busy},checkSignInStatus:function(b){var e=new l;this.checkAppAccess(b,"").then(function(f){e.resolve(f.credential)})["catch"](function(f){e.reject(f)});return e},checkAppAccess:function(b,e,f){var u=this,C=!1;return this.getCredential(b,{prompt:!1}).then(function(L){var Q={f:"json"};if("portal"===
L.scope)if(e&&(u._doPortalSignIn(b)||f&&f.force)){var S=L.server+"/sharing/rest/oauth2/validateAppAccess";Q.client_id=e}else if(L.token)S=L.server+"/sharing/rest";else return{credential:L};else if(L.token)S=L.server+"/rest/services";else return{credential:L};L.token&&(Q.token=L.token);return P({url:S,content:Q,callbackParamName:"callback"},{disableIdentityLookup:!0}).then(function(U){if(!1===U.valid){var N=Error("You are currently signed in as: '"+L.userId+"'.  You do not have access to this app: '"+
e+"'.");N.name="identity-manager:not-authorized";N.code="IdentityManagerBase.1";N.log=!!A.isDebug;N.details=U;throw N;}C=!!U.viewOnlyUserTypeApp;return{credential:L}})["catch"](function(U){if("IdentityManagerBase.1"===U.code||400===U.code)throw 400===U.code&&(U.name="identity-manager:invalid-request"),U;if(498===U.code)throw L.destroy(),U=Error("User is not signed in."),U.name="identity-manager:not-authenticated",U.code="IdentityManagerBase.6",U.log=!!A.isDebug,U;return{credential:L}})}).then(function(L){return{credential:L.credential,
viewOnly:C}})},setProtocolErrorHandler:function(b){this._protocolFunc=b},signIn:function(){},oAuthSignIn:function(){},onCredentialCreate:function(){},onCredentialsDestroy:function(){},destroyCredentials:function(){if(this.credentials){var b=this.credentials.slice();g.forEach(b,function(e){e.destroy()})}this.onCredentialsDestroy()},enablePostMessageAuth:function(b){b||(b="https://www.arcgis.com/sharing/rest");this._postMessageAuthHandle&&this._postMessageAuthHandle.remove();this._postMessageAuthHandle=
p(window,"message",function(e){(e.origin===window.location.origin||F.endsWith(e.origin,".arcgis.com"))&&e.data&&"arcgis:auth:requestCredential"===e.data.type&&this.getCredential(b).then(function(f){e.source.postMessage({type:"arcgis:auth:credential",credential:{expires:f.expires,server:f.server,ssl:f.ssl,token:f.token,userId:f.userId}},e.origin)})["catch"](function(f){e.source.postMessage({type:"arcgis:auth:error",error:{name:f.name,message:f.message}},e.origin)})}.bind(this))},disablePostMessageAuth:function(){this._postMessageAuthHandle&&
(this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=null)},_getOAuthLocationParams:function(){var b=window.location.hash;if(b){"#"===b.charAt(0)&&(b=b.substring(1));b=y.queryToObject(b);var e=!1;if(b.access_token&&b.expires_in&&b.state&&b.hasOwnProperty("username"))try{b.state=JSON.parse(b.state),b.state.portalUrl&&(this._oAuthLocationParams=b,e=!0)}catch(u){}else if(b.error&&b.error_description&&"access_denied"===b.error&&(e=!0,b.state))try{b.state=JSON.parse(b.state)}catch(u){}e&&
(window.location.hash=b.state&&b.state.hash||"")}if(b=window.location.search){"?"===b.charAt(0)&&(b=b.substring(1));b=y.queryToObject(b);e=!1;if(b.code&&b.state)try{b.state=JSON.parse(b.state),b.state.portalUrl&&b.state.uid&&(this._oAuthLocationParams=b,e=!0)}catch(u){}else if(b.error&&b.error_description&&"access_denied"===b.error&&(e=!0,b.state))try{b.state=JSON.parse(b.state)}catch(u){}if(e){var f=F.mixin({},b);"code error error_description message_code persist state".split(" ").forEach(function(u){delete f[u]});
e=y.objectToQuery(f);window.history.replaceState(window.history.state,"",window.location.pathname+(e?"?"+e:"")+(b.state&&b.state.hash||""))}}},_getOAuthToken:function(b,e,f,u,C){b=b.replace(/^http:/i,"https:");return P({url:b+"/sharing/rest/oauth2/token",content:u&&C?{grant_type:"authorization_code",code:e,redirect_uri:u,client_id:f,code_verifier:C}:{grant_type:"refresh_token",refresh_token:e,client_id:f}},{disableIdentityLookup:!0,usePost:!0})},_pageShowHandler:function(b){b.persisted&&this.isBusy()&&
this._rejectOnPersistedPageShow&&(b=Error("ABORTED"),b.name="identity-manager:user-aborted",b.code="IdentityManager.2",b.log=!!A.isDebug,this._errbackFunc(b))},_findCredential:function(b,e){var f=-1,u,C,L=e&&e.token;var Q=e&&e.resource;var S=this._isServerRsrc(b)?"server":"portal",U=g.filter(this.credentials,function(d){return this._hasSameServerInstance(d.server,b)&&d.scope===S},this);b=Q||b;if(U.length)if(1===U.length){Q=U[0];var N=(u=(C=this.findServerInfo(Q.server))&&C.owningSystemUrl)&&this.findCredential(u,
Q.userId);f=this._getIdenticalSvcIdx(b,Q);if(L)-1!==f&&(Q.resources.splice(f,1),this._removeResource(b,N));else return-1===f&&Q.resources.push(b),this._addResource(b,N),Q}else{var k,a;g.some(U,function(d){a=this._getIdenticalSvcIdx(b,d);return-1!==a?(k=d,N=(u=(C=this.findServerInfo(k.server))&&C.owningSystemUrl)&&this.findCredential(u,k.userId),f=a,!0):!1},this);if(L)k&&(k.resources.splice(f,1),this._removeResource(b,N));else if(k)return this._addResource(b,N),k}},_findOAuthInfo:function(b){var e=
this.findOAuthInfo(b);e||g.some(this.oAuthInfos,function(f){this._isIdProvider(f.portalUrl,b)&&(e=f);return!!e},this);return e},_addResource:function(b,e){e&&-1===this._getIdenticalSvcIdx(b,e)&&e.resources.push(b)},_removeResource:function(b,e){var f=-1;e&&(f=this._getIdenticalSvcIdx(b,e),-1<f&&e.resources.splice(f,1))},_useProxy:function(b,e){return e&&e.isAdmin&&!H.hasSameOrigin(b.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(b.tokenServiceUrl)&&10.1==b.currentVersion&&!H.hasSameOrigin(b.tokenServiceUrl,
window.location.href)},_getOrigin:function(b){b=new v(b);return b.scheme+"://"+b.host+(F.isDefined(b.port)?":"+b.port:"")},_getServerInstanceRoot:function(b){var e=b.toLowerCase(),f=e.indexOf(this._agsRest);-1===f&&this._isAdminResource(b)&&(f=this._agsAdmin.test(b)?b.replace(this._agsAdmin,"$1").length:b.search(this._adminSvcs));-1===f&&(f=e.indexOf("/sharing"));-1===f&&"/"===e.substr(-1)&&(f=e.length-1);return-1<f?b.substring(0,f):b},_hasSameServerInstance:function(b,e){"/"===b.substr(-1)&&(b=b.slice(0,
-1));b=b.toLowerCase();e=this._getServerInstanceRoot(e).toLowerCase();b=this._normalizeAGOLorgDomain(b);e=this._normalizeAGOLorgDomain(e);b=b.substr(b.indexOf(":"));e=e.substr(e.indexOf(":"));return b===e},_normalizeAGOLorgDomain:function(b){var e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,f=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,u=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;e.test(b)?b=b.replace(e,"https://www.arcgis.com"):f.test(b)?b=b.replace(f,"https://devext.arcgis.com"):
u.test(b)&&(b=b.replace(u,"https://qaext.arcgis.com"));return b},_sanitizeUrl:function(b){var e=(n.defaults.io.proxyUrl||"").toLowerCase(),f=e?b.toLowerCase().indexOf(e+"?"):-1;-1!==f&&(b=b.substring(f+e.length+1));b=H.normalize(b);return H.urlToObject(b).path},_isRESTService:function(b){return-1<b.indexOf(this._agsRest)},_isAdminResource:function(b){return this._agsAdmin.test(b)||this._adminSvcs.test(b)},_isServerRsrc:function(b){return this._isRESTService(b)||this._isAdminResource(b)},_isIdenticalService:function(b,
e){if(this._isRESTService(b)&&this._isRESTService(e)){var f=this._getSuffix(b).toLowerCase(),u=this._getSuffix(e).toLowerCase();var C=f===u;C||(C=/(.*)\/(MapServer|FeatureServer).*/ig,C=f.replace(C,"$1")===u.replace(C,"$1"))}else this._isAdminResource(b)&&this._isAdminResource(e)?C=!0:this._isServerRsrc(b)||this._isServerRsrc(e)||!this._isPortalDomain(b)||(C=!0);return C},_isPortalDomain:function(b){var e=new v(b.toLowerCase()),f=this._portalConfig;b=g.some(this._gwDomains,function(u){return u.regex.test(e.uri)});
!b&&f&&(b=this._hasSameServerInstance(this._getServerInstanceRoot(f.restBaseUrl),e.uri));b||(!this._arcgisUrl&&(f=z.getObject("esri.arcgis.utils.arcgisUrl"))&&(this._arcgisUrl=(new v(f)).authority),this._arcgisUrl&&(b=this._arcgisUrl.toLowerCase()===e.authority));b||(b=g.some(this._portals,function(u){return this._hasSameServerInstance(u,e.uri)},this));return b=b||this._agsPortal.test(e.path)},_isIdProvider:function(b,e){var f=-1,u=-1;g.forEach(this._gwDomains,function(S,U){-1===f&&S.regex.test(b)&&
(f=U);-1===u&&S.regex.test(e)&&(u=U)});var C=!1;if(-1<f&&-1<u)if(0===f||4===f){if(0===u||4===u)C=!0}else if(1===f){if(1===u||2===u)C=!0}else 2===f?2===u&&(C=!0):3===f&&3===u&&(C=!0);if(!C){var L=this.findServerInfo(e),Q=L&&L.owningSystemUrl;Q&&B(L)&&this._isPortalDomain(Q)&&this._isIdProvider(b,Q)&&(C=!0)}return C},_isPublic:function(b){b=this._sanitizeUrl(b);return g.some(this._publicUrls,function(e){return e.test(b)})},_getIdenticalSvcIdx:function(b,e){var f=-1;g.some(e.resources,function(u,C){return this._isIdenticalService(b,
u)?(f=C,!0):!1},this);return f},_getSuffix:function(b){return b.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")},_getTokenSvcUrl:function(b){if(this._isRESTService(b)||this._isAdminResource(b)){var e=this._getServerInstanceRoot(b);var f=e+"/admin/generateToken";b=e+"/rest/info";e=P({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"});e.adminUrl_=f;return e}if(this._isPortalDomain(b)){var u="";g.some(this._gwDomains,function(C){C.regex.test(b)&&(u=C.tokenServiceUrl);
return!!u});u||g.some(this._portals,function(C){this._hasSameServerInstance(C,b)&&(u=C+this._gwTokenUrl);return!!u},this);u||(f=b.toLowerCase().indexOf("/sharing"),-1!==f&&(u=b.substring(0,f)+this._gwTokenUrl));u||(u=this._getOrigin(b)+this._gwTokenUrl);u&&(f=(new v(b)).port,/^http:\/\//i.test(b)&&"7080"===f&&(u=u.replace(/:7080/i,":7443")),u=u.replace(/http:/i,"https:"));return u}if(-1!==b.toLowerCase().indexOf("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"},_exchangeToken:function(b,
e,f){return P({url:b+"/sharing/rest/oauth2/exchangeToken",content:{f:"json",client_id:e,token:f}},{disableIdentityLookup:!0,usePost:!0}).then(function(u){return u.token})},_getPlatformSelf:function(b,e){b=b.replace(/^http:/i,"https:");return P({url:b+"/sharing/rest/oauth2/platformSelf",content:{f:"json",expiration:30},headers:{"X-Esri-Auth-Client-Id":e,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")},withCredentials:!0},{disableIdentityLookup:!0,usePost:!0})},_getPortalSelf:function(b,
e){var f="";g.some(this._gwDomains,function(C){C.regex.test(b)&&(f=C.customBaseUrl);return!!f});if(f){var u=new l;u.resolve({allSSL:!0,currentVersion:"8.4",customBaseUrl:f,portalMode:"multitenant",supportsOAuth:!0});return u}"https:"===window.location.protocol?b=b.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(e)&&(b=b.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));return P({url:b,content:{f:"json"},callbackParamName:"callback",withCredentials:!0},{disableIdentityLookup:!0})},
_doPortalSignIn:function(b){var e=this._portalConfig,f=window.location.href,u=this.findServerInfo(b);return(e||this._isPortalDomain(f))&&(u?u.hasPortal||u.owningSystemUrl&&this._isPortalDomain(u.owningSystemUrl):this._isPortalDomain(b))&&(this._isIdProvider(f,b)||e&&(this._hasSameServerInstance(this._getServerInstanceRoot(e.restBaseUrl),b)||this._isIdProvider(e.restBaseUrl,b))||H.hasSameOrigin(f,b,!0))?!0:!1},_checkProtocol:function(b,e,f,u){var C=!0;u=u?e.adminTokenServiceUrl:e.tokenServiceUrl;0!==
z.trim(u).toLowerCase().indexOf("https:")||0===window.location.href.toLowerCase().indexOf("https:")||n.defaults.io.useCors&&(H.canUseXhr(u)||H.canUseXhr(H.getProxyUrl(!0).path))||(C=this._protocolFunc?!!this._protocolFunc({resourceUrl:b,serverInfo:e}):!1,C||(b=Error("Aborted the Sign-In process to avoid sending password over insecure connection."),b.name="identity-manager:aborted",b.code="IdentityManagerBase.4",b.log=!!A.isDebug,f(b)));return C},_enqueue:function(b,e,f,u,C,L){u||(u=new l(V._dfdCanceller));
u.resUrl_=b;u.sinfo_=e;u.options_=f;u.admin_=C;u.refresh_=L;this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(b),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(u)):this._xoReqs.push(u):this._doSignIn(u);return u},_doSignIn:function(b){this._busy=b;this._rejectOnPersistedPageShow=!1;var e=this,f=function(N){var k=b.options_&&b.options_.resource,a=b.resUrl_,d=b.refresh_,h=!1;-1===g.indexOf(e.credentials,N)&&(d&&-1!==
g.indexOf(e.credentials,d)?(d.userId=N.userId,d.token=N.token,d.expires=N.expires,d.validity=N.validity,d.ssl=N.ssl,d.creationTime=N.creationTime,h=!0,N=d):e.credentials.push(N));N.resources||(N.resources=[]);-1===N.resources.indexOf(k||a)&&N.resources.push(k||a);N.scope=e._isServerRsrc(a)?"server":"portal";N.onTokenChange();k=e._soReqs;var E={};e._soReqs=[];g.forEach(k,function(x){if(!this._isIdenticalService(a,x.resUrl_)){var r=this._getSuffix(x.resUrl_);E[r]||(E[r]=!0,N.resources.push(x.resUrl_))}},
e);b.callback(N);g.forEach(k,function(x){this._hasSameServerInstance(this._getServerInstanceRoot(a),x.resUrl_)?x.callback(N):this._soReqs.push(x)},e);e._busy=b.resUrl_=b.sinfo_=b.refresh_=null;if(!h)e.onCredentialCreate({credential:N});e._soReqs.length?e._doSignIn(e._soReqs.shift()):e._xoReqs.length&&e._doSignIn(e._xoReqs.shift())},u=function(N){b.errback(N);e._busy=b.resUrl_=b.sinfo_=b.refresh_=null;e._soReqs.length?e._doSignIn(e._soReqs.shift()):e._xoReqs.length&&e._doSignIn(e._xoReqs.shift())},
C=function(N,k,a,d){var h=b.sinfo_,E=!b.options_||!1!==b.options_.prompt,x=h.hasPortal&&e._findOAuthInfo(b.resUrl_);if(N)f(new c({userId:N,server:h.server,token:a||null,expires:F.isDefined(d)?Number(d):null,ssl:!!k}));else if(window!==window.parent&&e._appUrlObj.query&&e._appUrlObj.query["arcgis-auth-origin"]&&e._appUrlObj.query["arcgis-auth-portal"]&&e._hasSameServerInstance(e._getServerInstanceRoot(e._appUrlObj.query["arcgis-auth-portal"]),b.resUrl_)){window.parent.postMessage({type:"arcgis:auth:requestCredential"},
e._appUrlObj.query["arcgis-auth-origin"]);var r=p(window,"message",function(ba){if(ba.source===window.parent&&ba.data)if("arcgis:auth:credential"===ba.data.type&&ba.data.credential.expires<Date.now()&&(ba.data.type="arcgis:auth:error",ba.data.error={name:"tokenExpiredError"}),"arcgis:auth:credential"===ba.data.type)r.remove(),f(new c(ba.data.credential));else if("arcgis:auth:error"===ba.data.type){r.remove();ba=ba.data.error;switch(ba.name){case "identity-manager:busy":case "identity-manager:not-authorized":var ka=
"IdentityManager.1";break;case "identity-manager:server-identification-failed":case "identity-manager:unknown-resource":case "identity-manager:user-aborted":ka="IdentityManager.2";break;case "identity-manager:authentication-failed":case "identity-manager:credential-request-failed":case "tokenExpiredError":ka="IdentityManager.3";"tokenExpiredError"===ba.name&&(ba.name="identity-manager:credential-request-failed",ba.message="Parent application's token has expired.");break;case "identity-manager:aborted":ka=
"IdentityManager.4";break;case "identity-manager:not-authenticated":ka="IdentityManager.6";break;case "identity-manager:invalid-request":ka=400}var la=Error(ba.message);la.name=ba.name;la.code=ka;la.log=!!A.isDebug;u(la)}})}else if(x){var J=x._oAuthCred;J||(N=new I(x,M),k=new I(x,R),N.isValid()&&k.isValid()?N.expires>k.expires?(J=N,k.destroy()):(J=k,N.destroy()):J=N.isValid()?N:k,x._oAuthCred=J);if(J.isValid()){var T=new c({userId:J.userId,server:h.server,token:J.token,expires:J.expires,ssl:J.ssl,
_oAuthCred:J});var X=x.appId!==J.appId&&e._doPortalSignIn(b.resUrl_);X||J.refreshToken?(J.refreshToken?b._pendingDfd=e._getOAuthToken(h.server,J.refreshToken,J.appId).then(function(ba){T.expires=Date.now()+1E3*ba.expires_in;T.token=ba.access_token;return T}):(N=new l,N.resolve(T),b._pendingDfd=N),b._pendingDfd.then(function(ba){return X?e._exchangeToken(ba.server,x.appId,ba.token).then(function(ka){ba.token=ka;return ba})["catch"](function(){return ba}):ba}).then(function(ba){f(ba)})["catch"](function(){J.destroy();
C()})):f(T)}else if(e._oAuthLocationParams&&e._hasSameServerInstance(x.portalUrl,e._oAuthLocationParams.state.portalUrl)&&(e._oAuthLocationParams.access_token||e._oAuthLocationParams.code&&e._oAuthLocationParams.state.uid===J.stateUID&&J.codeVerifier))N=e._oAuthLocationParams,e._oAuthLocationParams=null,b._pendingDfd=e._processOAuthResponseParams(N,x,h).then(function(ba){f(ba)})["catch"](u);else{var da=function(){E?b._pendingDfd=e.oAuthSignIn(b.resUrl_,h,x,b.options_).addCallbacks(f,u):(fa=Error("User is not signed in."),
fa.name="identity-manager:not-authenticated",fa.code="IdentityManagerBase.6",fa.log=!!A.isDebug,u(fa))};e._doPortalSignIn(b.resUrl_)?b._pendingDfd=e._getPlatformSelf(h.server,x.appId).then(function(ba){var ka=ba.portalUrl;!ka||H.hasSameOrigin(ka,window.location.origin,!0)?(T=new c({userId:ba.username,server:h.server,expires:Date.now()+1E3*ba.expires_in,token:ba.token}),f(T)):da()})["catch"](da):da()}}else if(E)e._checkProtocol(b.resUrl_,h,u,b.admin_)&&(N=b.options_,b.admin_&&(N=N||{},N.isAdmin=!0),
b._pendingDfd=e.signIn(b.resUrl_,h,N).addCallbacks(f,u));else{var fa=Error("User is not signed in.");fa.name="identity-manager:not-authenticated";fa.code="IdentityManagerBase.6";fa.log=!!A.isDebug;u(fa)}},L=function(){var N=b.sinfo_,k=N.owningSystemUrl,a=b.options_,d;if(a){var h=a.token;var E=a.error;var x=a.prompt}(d=e._findCredential(k,{token:h,resource:b.resUrl_}))||g.some(e.credentials,function(r){this._isIdProvider(k,r.server)&&(d=r);return!!d},e);d?(a=e.findCredential(b.resUrl_,d.userId))?f(a):
K(N,e._legacyFed)?(a=d.toJson(),a.server=N.server,a.resources=null,f(new c(a))):(b._pendingDfd=e.generateToken(e.findServerInfo(d.server),null,{serverUrl:b.resUrl_,token:d.token,ssl:d.ssl})).addCallbacks(function(r){f(new c({userId:d.userId,server:N.server,token:r.token,expires:F.isDefined(r.expires)?Number(r.expires):null,ssl:!!r.ssl,isAdmin:b.admin_,validity:r.validity}))},u):(e._busy=null,h&&(b.options_.token=null),(b._pendingDfd=e.getCredential(k.replace(/\/?$/,"/sharing"),{resource:b.resUrl_,
owningTenant:N.owningTenant,token:h,error:E,prompt:x})).addCallbacks(function(r){e._enqueue(b.resUrl_,b.sinfo_,b.options_,b,b.admin_)},function(r){u(r)}))};this._errbackFunc=u;var Q=b.sinfo_.owningSystemUrl,S=this._isServerRsrc(b.resUrl_),U=b.sinfo_._restInfoDfd;U?U.addCallbacks(function(N){var k=b.sinfo_;k._restInfoDfd&&(k.adminTokenServiceUrl=k._restInfoDfd.adminUrl_,k._restInfoDfd=null,k.tokenServiceUrl=z.getObject("authInfo.tokenServicesUrl",!1,N)||z.getObject("authInfo.tokenServiceUrl",!1,N)||
z.getObject("tokenServiceUrl",!1,N),k.shortLivedTokenValidity=z.getObject("authInfo.shortLivedTokenValidity",!1,N),k.currentVersion=N.currentVersion,k.owningTenant=N.owningTenant,(N=k.owningSystemUrl=N.owningSystemUrl)&&e._portals.push(N));S&&k.owningSystemUrl?L():C()},function(){b.sinfo_._restInfoDfd=null;var N=Error("Unknown resource - could not find token service endpoint.");N.name="identity-manager:server-identification-failed";N.code="IdentityManagerBase.2";N.log=!!A.isDebug;u(N)}):S&&Q?L():
b.sinfo_._selfReq?b.sinfo_._selfReq.selfDfd.then(function(N){var k={};if(N){var a=N.user&&N.user.username;k.username=a;k.allSSL=N.allSSL;var d=N.supportsOAuth;var h=parseFloat(N.currentVersion);if("multitenant"===N.portalMode)var E=N.customBaseUrl;b.sinfo_.currentVersion=h}b.sinfo_.webTierAuth=!!a;return a&&e.normalizeWebTierAuth?e.generateToken(b.sinfo_,null,{ssl:k.allSSL}).addBoth(function(x){k.portalToken=x&&x.token;k.tokenExpiration=x&&x.expires;return k}):!a&&d&&4.4<=h&&!e._findOAuthInfo(b.resUrl_)?
e._generateOAuthInfo({portalUrl:b.sinfo_.server,customBaseUrl:E,owningTenant:b.sinfo_._selfReq.owningTenant}).always(function(){return k}):k}).always(function(N){b.sinfo_._selfReq=null;N?C(N.username,N.allSSL,N.portalToken,N.tokenExpiration):C()}):C()},_generateOAuthInfo:function(b){var e=this,f=b.portalUrl,u=b.customBaseUrl,C=b.owningTenant;if(b=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal){var L=window.location.href;var Q=L.indexOf("?");-1<Q&&(L=L.slice(0,
Q));Q=L.search(/\/(apps|home)\//);L=-1<Q?L.slice(0,Q):null}b&&L?(this._hasTestedIfAppIsOnPortal=!0,b=P({url:L+"/sharing/rest",content:{f:"json"},handleAs:"json"}).then(function(){e.defaultOAuthInfo=new m({appId:"arcgisonline",popupCallbackUrl:L+"/home/oauth-callback.html"})})):(b=new l,b.resolve(),b=b.promise);return b.then(function(){if(e.defaultOAuthInfo)return f=f.replace(/^http:/i,"https:"),P({url:f+"/sharing/rest/oauth2/validateRedirectUri",content:{accountId:C,client_id:e.defaultOAuthInfo.appId,
redirect_uri:H.getAbsoluteUrl(e.defaultOAuthInfo.popupCallbackUrl),f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(S){if(S.valid){var U=e.defaultOAuthInfo.clone();U.portalUrl=S.urlKey&&u?"https://"+S.urlKey.toLowerCase()+"."+u:f;U.popup=window!==window.top||!(H.hasSameOrigin(f,window.location.origin)||e._gwDomains.some(function(N){return N.regex.test(f)&&N.regex.test(window.location.origin)}));e.oAuthInfos.push(U)}})})}});var c=G(w,{declaredClass:"esri.Credential",tokenRefreshBuffer:2,
constructor:function(b){z.mixin(this,b);this.resources=this.resources||[];F.isDefined(this.creationTime)||(this.creationTime=(new Date).getTime())},_oAuthCred:null,refreshToken:function(){var b=this,e=this.resources&&this.resources[0],f=q.id.findServerInfo(this.server),u=f&&f.owningSystemUrl,C=!!u&&"server"===this.scope,L=C&&K(f,q.id._legacyFed),Q=C&&q.id.findServerInfo(u),S,U=(S=f.webTierAuth)&&q.id.normalizeWebTierAuth,N=D[this.server];N=N&&N[this.userId];var k={username:this.userId,password:N};
if(!S||U)if(C&&!Q&&g.some(q.id.serverInfos,function(h){q.id._isIdProvider(u,h.server)&&(Q=h);return!!Q}),S=Q&&q.id.findCredential(Q.server,this.userId),!C||S)if(L)S.refreshToken();else{if(C)var a={serverUrl:e,token:S&&S.token,ssl:S&&S.ssl};else if(U)k=null,a={ssl:this.ssl};else if(N)this.isAdmin&&(a={isAdmin:!0});else{if(e){e=q.id._sanitizeUrl(e);this._enqueued=1;var d=q.id._enqueue(e,f,null,null,this.isAdmin,this);d.addCallback(function(){b._enqueued=0;b.refreshServerTokens()}).addErrback(function(){b._enqueued=
0})}return d}return q.id.generateToken(C?Q:f,C?null:k,a).addCallback(function(h){b.token=h.token;b.expires=F.isDefined(h.expires)?Number(h.expires):null;b.creationTime=(new Date).getTime();b.validity=h.validity;b.onTokenChange();b.refreshServerTokens()}).addErrback(function(){})}},refreshServerTokens:function(){"portal"===this.scope&&g.forEach(q.id.credentials,function(b){var e=q.id.findServerInfo(b.server),f=e&&e.owningSystemUrl;b!==this&&b.userId===this.userId&&f&&"server"===b.scope&&(q.id._hasSameServerInstance(this.server,
f)||q.id._isIdProvider(f,this.server))&&(K(e,q.id._legacyFed)?(b.token=this.token,b.expires=this.expires,b.creationTime=this.creationTime,b.validity=this.validity,b.onTokenChange()):b.refreshToken())},this)},onTokenChange:function(b){clearTimeout(this._refreshTimer);var e=this.server&&q.id.findServerInfo(this.server),f=(e=e&&e.owningSystemUrl)&&q.id.findServerInfo(e);!1!==b&&(!e||"portal"===this.scope||f&&f.webTierAuth&&!q.id.normalizeWebTierAuth)&&(F.isDefined(this.expires)||F.isDefined(this.validity))&&
this._startRefreshTimer()},onDestroy:function(){},destroy:function(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);var b=g.indexOf(q.id.credentials,this);-1<b&&q.id.credentials.splice(b,1);this.onTokenChange();this.onDestroy()},toJson:function(){return this._toJson()},_toJson:function(){var b=F.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,
validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),e=this.resources;e&&0<e.length&&(b.resources=e.slice());return b},_startRefreshTimer:function(){clearTimeout(this._refreshTimer);var b=6E4*this.tokenRefreshBuffer,e=Math.pow(2,31)-1,f=(this.validity?this.creationTime+6E4*this.validity:this.expires)-(new Date).getTime();0>f?f=0:f>e&&(f=e);this._refreshTimer=setTimeout(z.hitch(this,this.refreshToken),f>b?f-b:f)}});t.Credential=c;return q.IdentityManagerBase=
t})},"esri/config":function(){define(["dojo/_base/config","dojo/topic","dojo/has","./kernel"],function(G,A,z,g){z=function(){return this}();var l={defaults:{screenDPI:96,geometryService:null,kmlService:null,map:{width:400,height:400,layerNamePrefix:"layer",graphicsLayerNamePrefix:"graphicsLayer",slider:{left:"30px",top:"30px",width:null,height:"200px"},sliderLabel:{tick:5,labels:null,style:"width:2em; font-family:Verdana; font-size:75%;"},sliderChangeImmediate:!0,zoomSymbol:{color:[0,0,0,64],outline:{color:[255,
0,0,255],width:1.25,style:"esriSLSSolid"},style:"esriSFSSolid"},zoomDuration:500,zoomRate:25,zoomAnimationThrottled:!1,panDuration:350,panRate:25,logoLink:"http://www.esri.com"},autoSpatialIndexing:z.Worker&&!1,io:{errorHandler:function(v,t){A.publish("esri.Error",[v])},proxyUrl:null,alwaysUseProxy:!1,useCors:"with-credentials",corsEnabledServers:[/^https?:\/\/.+\.arcgis\.com(\/|$)/i,"server.arcgisonline.com","services.arcgisonline.com","www.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com",
"tiles.arcgis.com","tiles1.arcgis.com","tiles2.arcgis.com","tiles3.arcgis.com","tiles4.arcgis.com","basemaps.arcgis.com","basemapsbeta.arcgis.com","basemaps-api.arcgis.com","elevation3d.arcgis.com","services.arcgis.com","services1.arcgis.com","services2.arcgis.com","services3.arcgis.com","services4.arcgis.com","services5.arcgis.com","services6.arcgis.com","services7.arcgis.com","services8.arcgis.com","services9.arcgis.com","cdn.arcgis.com","cdn-a.arcgis.com","cdn-b.arcgis.com","static.arcgis.com",
"utility.arcgis.com","utility.arcgisonline.com","geocode.arcgis.com","geoenrich.arcgis.com","qaext.arcgis.com","staticqa.arcgis.com","tilesqa.arcgis.com","servicesqa.arcgis.com","servicesqa1.arcgis.com","servicesqa2.arcgis.com","servicesqa3.arcgis.com","geocodeqa.arcgis.com","geoenrichqa.arcgis.com","dev.arcgis.com","devext.arcgis.com","localvtiles.arcgis.com","staticdev.arcgis.com","tilesdevext.arcgis.com","elevation3ddev.arcgis.com","servicesdev.arcgis.com","servicesdev1.arcgis.com","servicesdev2.arcgis.com",
"servicesdev3.arcgis.com","geocodedev.arcgis.com","geoenrichdev.arcgis.com","basemapsdev.arcgis.com","basemapsdev-api.arcgis.com","basemapsbetadev.arcgis.com"],corsDetection:z.cordova?!1:!0,corsDetectionTimeout:15,corsStatus:{},crossOriginNoCorsDomains:null,webTierAuthServers:[],proxyRules:[],postLength:2E3,timeout:6E4,useWorkers:"on-request",maxRequestWorkers:5,httpsDomains:"arcgis.com arcgisonline.com esrikr.com premiumservices.blackbridge.com esripremium.accuweather.com gbm.digitalglobe.com firstlook.digitalglobe.com msi.digitalglobe.com".split(" ")},
workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}}}};g.config=l;G.noGlobals||(z.esriConfig=l);return l})},"esri/ServerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(G,A,z,g,l){G=G(null,{declaredClass:"esri.ServerInfo",constructor:function(v){A.mixin(this,v)},toJson:function(){return l.fixJson({server:this.server,tokenServiceUrl:this.tokenServiceUrl,adminTokenServiceUrl:this.adminTokenServiceUrl,shortLivedTokenValidity:this.shortLivedTokenValidity,
owningSystemUrl:this.owningSystemUrl,owningTenant:this.owningTenant,currentVersion:this.currentVersion,hasPortal:this.hasPortal,hasServer:this.hasServer,webTierAuth:this.webTierAuth})}});return g.ServerInfo=G})},"esri/urlUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/url dojo/global dojo/io-query ./kernel ./lang ./config ./sniff dojo/i18n!./nls/jsapi".split(" "),function(G,A,z,g,l,v,t,y,p,q){var n={},F=y.defaults.io,O=/^[a-z][a-z0-9\+\-\.]*:/i,H=/^\s*http:/i,V=/^\s*https:/i,
P=/:\d+$/,w=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i;n.isHTTP=function(m){var D=g.location.protocol;return null==m?"http:"===D||"https:"===D:m?"https:"===D:"http:"===D};n.getProtocolForWebResource=function(m){return n.isHTTP()?g.location.protocol:m?"https:":"http:"};n.urlToObject=function(m){var D={},B=new z(m),K=m.indexOf("?");null===B.query?D={path:m,query:null}:(D.path=m.substring(0,K),D.query=l.queryToObject(B.query));B.fragment&&(D.hash=B.fragment,null===B.query&&(D.path=D.path.substring(0,
D.path.length-(B.fragment.length+1))));return D};n.getProxyUrl=function(m,D){var B=G.isString(m)?0===G.trim(m).toLowerCase().indexOf("https:"):m,K=F.proxyUrl,M,R=q.io.proxyNotSet;G.isString(m)&&(M=n.getProxyRule(m))&&(K=M.proxyUrl);if(!K)throw Error(R);if(B&&!1!==D&&0!==g.location.href.toLowerCase().indexOf("https:")&&(B=K,0!==B.toLowerCase().indexOf("http")&&(B=n.getAbsoluteUrl(B)),B=B.replace(/^http:/i,"https:"),n.canUseXhr(B))){K=B;var c=1}K=n.urlToObject(K);K._xo=c;return K};n.addProxy=function(m){var D=
n.getProxyRule(m),B;D?B=n.urlToObject(D.proxyUrl):F.alwaysUseProxy&&(B=n.getProxyUrl());B&&(D=n.urlToObject(m),m=B.path+"?"+D.path,(B=l.objectToQuery(G.mixin(B.query||{},D.query)))&&(m+="?"+B));return m};n.addProxyRule=function(m){var D=m.urlPrefix=n.urlToObject(m.urlPrefix).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),B=F.proxyRules,K,M=B.length,R=M;for(K=0;K<M;K++){var c=B[K].urlPrefix;if(0===D.indexOf(c)){if(D.length===c)return-1;R=K;break}else 0===c.indexOf(D)&&(R=
K+1)}B.splice(R,0,m);return R};n.getProxyRule=function(m){var D=F.proxyRules,B=D.length,K=n.urlToObject(m).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase();for(m=0;m<B;m++)if(0===K.indexOf(D[m].urlPrefix)){var M=D[m];break}return M};n.hasSameOrigin=function(m,D,B){m=m.toLowerCase();D=D.toLowerCase();var K=g.location.href.toLowerCase();m=0===m.indexOf("http")?new z(m):K=new z(K);D=0===D.indexOf("http")?new z(D):G.isString(K)?new z(K):K;return(B||m.scheme===D.scheme)&&m.host===
D.host&&m.port===D.port};n.canUseXhr=function(m,D){var B=p("esri-phonegap")?!0:!1,K=n.hasSameOrigin,M=F.corsEnabledServers,R,c=-1;!B&&p("esri-cors")&&M&&M.length&&(B=A.some(M,function(b,e){var f=!b||"object"!==typeof b||b instanceof RegExp?b:b.host;if(f instanceof RegExp){if(f.test(m))return c=e,!0}else if(f&&(R=0!==f.trim().toLowerCase().indexOf("http"),K(m,R?"http://"+f:f)||R&&K(m,"https://"+f)))return c=e,!0;return!1}));return D?c:B};n.getAbsoluteUrl=function(m){var D=n.getProtocolForWebResource();
return G.isString(m)&&!O.test(m)?0===m.indexOf("//")?D+m:0===m.indexOf("/")?D+"//"+g.location.host+m:v._appBaseUrl+m:m};n.fixUrl=function(m){m=G.trim(m);m=n.getAbsoluteUrl(m);m=n.normalizeSlashes(m);m=m.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2");m=n.downgradeToHTTP(m);return m=n.upgradeToHTTPS(m)};n.normalize=function(m){return n.fixUrl(m)};n.normalizeSlashes=function(m){if(/^https?:\/\//i.test(m)){var D=m.indexOf("?");if(-1<D){var B=m.slice(0,D);var K=m.slice(D+1)}else B=m;m=B.replace(/\/{2,}/g,
"/");m=m.replace("/","//");K&&(m+="?"+K)}return m};n.downgradeToHTTP=function(m){return n.isHTTP(!1)&&V.test(m)&&n.hasSameOrigin(g.location.href,m,!0)&&!n.canUseXhr(m)?m.replace(V,"http:"):m};n.upgradeToHTTPS=function(m){var D=F.httpsDomains,B=n.isHTTP(!1),K=n.isHTTP(!0);if(!H.test(m))return m;m=G.trim(m);var M=m.indexOf("/",7);M=-1===M?m:m.slice(0,M);M=M.toLowerCase().slice(7);if(P.test(M))if(t.endsWith(M,":80"))M=M.slice(0,-3),m=m.replace(":80","");else return m;if(B&&M===g.location.host&&(!w.test(m)||
!n.canUseXhr(m)))return m;B=!1;if(K&&M===g.location.host)B=!0;else if(D)for(var R=0;R<D.length;R++){var c=D[R];if(M===c||t.endsWith(M,"."+c)){B=!0;break}}B||!K||F.alwaysUseProxy||n.getProxyRule(m)||(B=!0);B&&(m=m.replace(H,"https:"));return m};y=q.widgets.popup;var I=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,label:y.NLS_moreInfo},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"${hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"${hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,
appName:"App Studio Player",label:y.NLS_openLinkInApp},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,appName:"Collector",label:y.NLS_openLinkInApp},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,appName:"Explorer",label:y.NLS_openLinkInApp},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,appName:"Navigator",label:y.NLS_openLinkInApp},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,appName:"Survey123",label:y.NLS_openLinkInApp},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,
appName:"Trek2There",label:y.NLS_openLinkInApp},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,appName:"Workforce",label:y.NLS_openLinkInApp},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,appName:"iForm",label:y.NLS_openLinkInApp},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,appName:"FlowFinity",label:y.NLS_openLinkInApp},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,appName:"Laserfische",label:y.NLS_openLinkInApp},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,appName:"Microsoft Power BI",label:y.NLS_openLinkInApp}];
n.getURIInfo=function(m){var D;A.some(I,function(B){B.pattern.test(m)&&(D=B);return!!D});return D};n.isKnownURI=function(m){return!!n.getURIInfo(m)};n.base64UrlEncode=function(m){return btoa(String.fromCharCode.apply(null,m)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")};G.mixin(v,n);v._getProxyUrl=n.getProxyUrl;v._getProxiedUrl=n.addProxy;v._hasSameOrigin=n.hasSameOrigin;v._canDoXOXHR=n.canUseXhr;v._getAbsoluteUrl=n.getAbsoluteUrl;v.fixUrl=n.fixUrl;return n})},"esri/sniff":function(){define(["dojo/_base/sniff",
"dojo/global","./kernel"],function(G,A,z){var g=G("ff"),l=G("ie"),v=void 0===l&&7<=G("trident"),t=G("edge"),y=G("webkit"),p=G("opera"),q=G("chrome"),n=G("safari"),F=navigator.userAgent,O;(O=F.match(/(iPhone|iPad|CPU)\s+OS\s+(\d+_\d+)/i))&&G.add("esri-iphone",parseFloat(O[2].replace("_",".")));(O=F.match(/Android\s+(\d+(\.\d+)*)/i))&&G.add("esri-android",parseFloat(O[1]));(O=F.match(/Fennec\/(\d+\.\d+)/i))&&G.add("esri-fennec",parseFloat(O[1]));0<=F.indexOf("BlackBerry")&&0<=F.indexOf("WebKit")&&G.add("esri-blackberry",
1);G.add("esri-touch",G("esri-iphone")||G("esri-android")||G("esri-blackberry")||6<=G("esri-fennec")||(g||y)&&(document.createTouch||"ontouchstart"in A||A.TouchEvent&&0<navigator.maxTouchPoints)?!0:!1);(O=F.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i))&&G.add("esri-mobile",!!O);G.add("esri-pointer",!g&&(navigator.pointerEnabled||navigator.msPointerEnabled||!!A.PointerEvent));z._getDOMAccessor=function(V){var P="";g?P="Moz":y?P="Webkit":l?P="ms":p&&(P="O");return P+V.charAt(0).toUpperCase()+
V.substr(1)};G.add("esri-phonegap",!!A.cordova);G.add("esri-cors",G("esri-phonegap")||A.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest);G.add("esri-file-upload",A.FormData&&A.FileList?!0:!1);G.add("esri-script-sandbox",function(){return"MessageChannel"in A&&"HTMLIFrameElement"in A&&"sandbox"in HTMLIFrameElement.prototype});G.add("esri-secure-context",function(){if("isSecureContext"in A)return A.isSecureContext;if(A.location&&A.location.origin)return 0===A.location.origin.indexOf("https:")});
G.add("esri-wasm","WebAssembly"in A);G.add("esri-workers",A.Worker?!0:!1);G.add("esri-featurelayer-webgl",!1);if(F=G("esri-featurelayer-webgl")){var H=G("esri-mobile");O=H?1:2;H=H?1:3;"object"===typeof F?(F.maxDrillLevel=null==F.maxDrillLevel?O:F.maxDrillLevel,F.maxRecordCountFactor=null==F.maxRecordCountFactor?H:F.maxRecordCountFactor,F.enablePBFQuery=null==F.enablePBFQuery?!0:F.enablePBFQuery):G.add("esri-featurelayer-webgl",{maxDrillLevel:O,maxRecordCountFactor:H,enablePBFQuery:!0},null,!0)}G.add("esri-featurelayer-webgl-labeling",
!1);G.add("esri-pbf",!l||10<=l);G.add("esri-featurelayer-pbf",!0);G.add("esri-transforms",v||t||9<=l||3.5<=g||4<=q||3.1<=n||10.5<=p||3.2<=G("esri-iphone")||2.1<=G("esri-android"));G.add("esri-transitions",v||t||10<=l||4<=g||4<=q||3.1<=n||10.5<=p||3.2<=G("esri-iphone")||2.1<=G("esri-android"));G.add("esri-transforms3d",v||t||10<=g||12<=q||4<=n||3.2<=G("esri-iphone")||3<=G("esri-android"));G.add("esri-url-encodes-apostrophe",function(){if(!A.document)return!1;var V=A.document.createElement("a");V.href=
"?'";return-1<V.href.indexOf("?%27")});3>G("esri-android")&&(G.add("esri-transforms",!1,!1,!0),G.add("esri-transitions",!1,!1,!0),G.add("esri-transforms3d",!1,!1,!0));G.add("esri-will-change",G("esri-transforms")&&(52<=q||11.1<=n));z._css=function(V){var P=G("esri-transforms3d");void 0!==V&&null!==V?P=V:P&&(q||n&&!G("esri-iphone"))&&(P=!1);var w=P?"translate3d(":"translate(",I=P?q?",-1px)":",0px)":")",m=P?"scale3d(":"scale(",D=P?",1)":")",B=P?"rotate3d(0,0,1,":"rotate(",K=P?"matrix3d(":"matrix(",
M=P?",0,0,":",",R=P?",0,0,0,0,1,0,":",",c=P?",0,1)":")";return{names:{transition:y&&"-webkit-transition"||g&&"MozTransition"||p&&"OTransition"||l&&"msTransition"||"transition",transform:y&&"-webkit-transform"||g&&"MozTransform"||p&&"OTransform"||l&&"msTransform"||"transform",transformName:y&&"-webkit-transform"||g&&"-moz-transform"||p&&"-o-transform"||l&&"-ms-transform"||"transform",origin:y&&"-webkit-transform-origin"||g&&"MozTransformOrigin"||p&&"OTransformOrigin"||l&&"msTransformOrigin"||"transformOrigin",
endEvent:y&&"webkitTransitionEnd"||g&&"transitionend"||p&&"oTransitionEnd"||l&&"MSTransitionEnd"||"transitionend"},translate:function(b,e){return w+b+"px,"+e+"px"+I},scale:function(b){return m+b+","+b+D},rotate:function(b){return B+b+"deg)"},matrix:function(b){return K+b.xx+","+b.xy+M+b.yx+","+b.yy+R+b.dx.toFixed(10)+(g&&59>=g?"px,":",")+b.dy.toFixed(10)+(g&&59>=g?"px":"")+c},getScaleFromMatrix:function(b){if(!b)return 1;b=b.toLowerCase();var e=-1<b.indexOf("matrix3d")?"matrix3d(":"matrix(";return Number(b.substring(e.length,
b.indexOf(",")))}}};z.isiPhone=G("esri-iphone");z.isAndroid=G("esri-android");z.isFennec=G("esri-fennec");z.isBlackBerry=G("esri-blackberry");z.isTouchEnabled=G("esri-touch");z.isPointerEnabled=G("esri-pointer");z._hasCors=G("esri-cors");z._hasFileUpload=G("esri-file-upload");z._hasTransforms=G("esri-transforms");z._hasTransitions=G("esri-transitions");z._has3DTransforms=G("esri-transforms3d");return G})},"esri/deferredUtils":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(G,
A,z){A={_dfdCanceller:function(g){g.canceled=!0;var l=g._pendingDfd;if(!g.isFulfilled()&&l&&!l.isFulfilled()){l.cancel();var v=l.results&&l.results[1]}g._pendingDfd=null;return v},_fixDfd:function(g){var l=g.then;g.then=function(v,t,y){if(v){var p=v;v=function(q){return q&&q._argsArray?p.apply(null,q):p(q)}}return l.call(this,v,t,y)};return g},_resDfd:function(g,l,v){var t=l.length;1===t?v?g.errback(l[0]):g.callback(l[0]):1<t?(l._argsArray=!0,g.callback(l)):g.callback()}};G.mixin(z,A);return A})},
"esri/request":function(){define("require dojo/_base/array dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/_base/url dojo/_base/xhr dojo/request/xhr ./core/request/script dojo/request/iframe dojo/dom-construct dojo/io-query ./kernel ./config ./sniff ./lang ./urlUtils ./deferredUtils ./support/requestUtils".split(" "),function(G,A,z,g,l,v,t,y,p,q,n,F,O,H,V,P,w,I,m){function D(k){k=new v(k);return(k.host+(k.port?":"+k.port:"")).toLowerCase()}function B(k){return this._xhr?this._xhr.getResponseHeader(k):
null}function K(k,a){var d=F.objectToQuery(k.content);d&&(k.url+=(-1===k.url.indexOf("?")?"?":"\x26")+d);if(2E3<k.url.length){if("data:"!==k.url.toLowerCase().slice(0,5))return d=new g,d.reject(l.mixin(Error(),{message:"When using responseType 'image', URL length cannot exceed 2000 characters."})),d;if(3E6<k.url.length)return d=new g,d.reject(l.mixin(Error(),{message:"When using responseType 'image', data URL length cannot exceed 3000000 characters."})),d}var h=new Image;a.allowImageDataAccess&&(h.crossOrigin=
k.withCredentials?"use-credentials":"anonymous");var E=!1,x=new g(function(r){E=!0;h.onload=h.onerror=h.onabort=null;h.src=""});d=function(r){h.onload=h.onerror=h.onabort=null;E||x.reject(Error("Unable to load the resource"))};h.onload=function(){h.onload=h.onerror=h.onabort=null;E||x.resolve(this)};h.onerror=d;h.onabort=d;h.alt="";h.src=k.url;return x}function M(k,a,d,h){var E=!1,x=!1,r=!1,J;if(P.isDefined(a))if(l.isObject(a)){E=!!a.useProxy;x=!!a.usePost;r=!!a.returnProgress;var T=a.crossOrigin}else E=
!!a;k=l.mixin({},k);delete k._credential;k._ssl&&(k.url=k.url.replace(/^http:/i,"https:"));10>V("ie")&&!U.test(k.url)&&(k.url=encodeURI(k.url));var X=k.content,da=k.url,fa=d&&k.form,ba=L;T=P.isDefined(T)?T:ba.useCors;k.load=function(ja){if(ja){if(ja.error){var pa=l.mixin(Error(),ja.error);pa.log=!!z.isDebug}else"error"===ja.status&&(pa=l.mixin(Error(),ja),pa.log=!!z.isDebug);pa&&(k.failOk=!pa.log,P.isDefined(pa.httpCode)||(pa.httpCode=pa.code))}return pa||ja};k.error=function(ja,pa){pa&&pa.xhr&&pa.xhr.abort();
ja instanceof Error||(ja=l.mixin(Error(),ja));ja.log=!!z.isDebug;k.failOk=!ja.log;ba.errorHandler(ja,pa);return ja};k._token&&(k.content=k.content||{},k.content.token=k._token);var ka=0;if(X&&da){var la=F.objectToQuery(X);ka=la.length+da.length+1;V("esri-url-encodes-apostrophe")&&(ka=la.replace(/'/g,"%27").length+da.length+1)}k.timeout=P.isDefined(k.timeout)?k.timeout:ba.timeout;k.handleAs=k.handleAs||"json";try{var ca=T&&w.canUseXhr(k.url)&&!/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i.test(k.url),
ha=w.hasSameOrigin(k.url,window.location.href)||ca,ea=x||d||ka>ba.postLength?!0:!1,W=ha||-1===k.handleAs.indexOf("json")||!k.callbackParamName||d?!1:!0,Y=w.getProxyRule(k.url)||ba.alwaysUseProxy||E||!("image"===k.handleAs&&!a.allowImageDataAccess||W&&!ea||ha)?!0:!1;d&&!V("esri-file-upload")&&!Y&&ca&&(Y=!0);if(Y){var Z=w.getProxyUrl(da,T);var aa=Z.path;Z._xo&&(ca=!0);!ea&&aa.length+1+ka>ba.postLength&&(ea=!0);k.url=aa+"?"+da;if(ea)k.content=l.mixin(Z.query||{},X);else{var ia=F.objectToQuery(l.mixin(Z.query||
{},X));ia&&(k.url+="?"+ia);k.content=null}}if(!W||ea||Y){var na=k.headers;!ca||na&&na.hasOwnProperty("X-Requested-With")||(na=k.headers=na||{},na["X-Requested-With"]=null);if(d){var qa=k.callbackParamName||"callback.html",ra=k.callbackElementName||"textarea",ta,va,wa=fa.elements?fa.elements.length:0;if(X=k.content)for(ta in X.token&&/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(da)&&(da+=(-1===da.indexOf("?")?"?":"\x26")+"token\x3d"+X.token,k.url=Y?aa+"?"+da:da,delete X.token),X){var oa=X[ta];
if(P.isDefined(oa)){var sa=null;for(va=0;va<wa;va++){var ua=fa.elements[va];if(ua.name===ta){sa=ua;break}}sa?sa.value=oa:h?fa.append(ta,oa):fa.appendChild(n.create("input",{type:"hidden",name:ta,value:oa}))}}if(V("esri-file-upload")){A.forEach(fa.elements,function(ja){ja.name===qa&&fa.removeChild(ja)});var xa=h?fa:new FormData(fa);if(11<=V("safari")&&"entries"in xa&&"delete"in xa){h=[];for(var Ba=xa.entries(),ya=Ba.next();!ya.done;){var za=ya.value;za[1]instanceof File&&""===za[1].name&&h.push(za[0]);
ya=Ba.next()}h.forEach(function(ja){xa["delete"](ja)})}k.contentType=!1;k.postData=xa;delete k.form}else{fa.enctype="multipart/form-data";9>V("ie")&&(fa.encoding="multipart/form-data");fa.method="post";A.some(fa.elements,function(ja){return ja.name===qa})||fa.appendChild(n.create("input",{type:"hidden",name:qa,value:ra}));if(-1!==da.toLowerCase().indexOf("addattachment")||-1!==da.toLowerCase().indexOf("updateattachment"))da+=(-1===da.indexOf("?")?"?":"\x26")+qa+"\x3d"+ra,k.url=Y?aa+"?"+da:da;delete k.content}}if(ca&&
!k.hasOwnProperty("withCredentials")&&"with-credentials"===L.useCors){aa=Y?aa:da;var Ca=w.canUseXhr(aa,!0),Aa=-1<Ca?L.corsEnabledServers[Ca]:null;if(Aa&&Aa.hasOwnProperty("withCredentials"))Aa.withCredentials&&(k.withCredentials=!0);else if(O.id){var Da=O.id.findServerInfo(aa);Da&&Da.webTierAuth&&(k.withCredentials=!0)}}k=C?C(k):k;var Ea=function(){if("image"===k.handleAs)return K(k,a);if(ea){if(d&&!V("esri-file-upload")){J=new g(function(){ja.cancel()});var ja=q.post(k.url,k).then(function(ma){J.resolve(ma)}).otherwise(function(ma){J.reject(ma)});
J.addCallback(function(ma){return k.load(ma)});J.addErrback(function(ma){return k.error(ma)});return J}!Y&&V("safari")&&(k.url+=(-1===k.url.indexOf("?")?"?":"\x26")+"_ts\x3d"+(new Date).getTime()+S++);if(r){k.uploadProgress=!0;k.data=k.postData;k.query=k.content;J=new g(function(){pa.cancel()});var pa=y.post(k.url,k).then(function(ma){J.resolve(ma)},function(ma){J.reject(ma)},function(ma){J.progress({transferType:ma.transferType,loaded:ma.loaded,total:ma.total})});J.addCallback(function(ma){return k.load(ma)});
J.addErrback(function(ma){return k.error(ma)});return J}return t.post(k)}return t.get(k)};return k.withCredentials&&m.isNoCorsRequestRequired(da)?J=m.sendNoCorsRequest(da,X).addBoth(function(){var ja=Ea();J.ioArgs=ja.ioArgs;return ja}):Ea()}k=C?C(k):k;k.jsonp=k.callbackParamName;k.query=k.content;J=new g(function(){Fa.cancel()});var Fa=p.get(k.url,k).then(function(ja){J.resolve(ja)}).otherwise(function(ja){J.reject(ja)});J.addCallback(function(ja){return k.load(ja)});J.addErrback(function(ja){return k.error(ja)});
return J}catch(ja){return J=new g,J.errback(k.error(ja)),J}}function R(k){var a=L.corsStatus,d=w.canUseXhr(k,!0);-1<d&&L.corsEnabledServers.splice(d,1);var h=new g;h.reject({log:!!z.isDebug});a[D(k)]=h.promise;return d}function c(k){var a=L.corsStatus;try{var d=D(k);if(L.corsDetection&&L.useCors&&V("esri-cors")&&k&&-1!==k.toLowerCase().indexOf("/rest/services")&&!w.hasSameOrigin(k,window.location.href)&&!w.canUseXhr(k)){if(a[d]&&!a[d].isCanceled())return a[d];var h=new g(I._dfdCanceller);a[d]=h.promise;
var E=t.get({url:k.substring(0,k.toLowerCase().indexOf("/rest/")+6)+"info",content:{f:"json"},failOk:!0,handleAs:"json",headers:{"X-Requested-With":null},timeout:1E3*L.corsDetectionTimeout});h._pendingDfd=E;E.then(function(x){x?(w.canUseXhr(k)||L.corsEnabledServers.push(d),h.resolve()):h.reject()},function(x){h.reject(x)});return h.promise}}catch(x){}return N}function b(k){C=k}function e(k,a,d,h){function E(ca){ca._pendingDfd=M(d,h,fa,da);if(!ca._pendingDfd){ca.ioArgs=ca._pendingDfd&&ca._pendingDfd.ioArgs;
var ha=Error("Deferred object is missing");ha.log=!!z.isDebug;ca.errback(ha);ca._pendingDfd=null;return ca}ca._pendingDfd.addCallback(function(ea){if(!ea)return ea;var W=ca._pendingDfd&&ca._pendingDfd.ioArgs&&ca._pendingDfd.ioArgs.xhr;if(!W)return ea;if(W=W.getResponseHeader("Content-Type"))if(W=W.toLowerCase(),-1===W.indexOf("text/plain")&&-1===W.indexOf("application/json"))return ea;if(ea instanceof ArrayBuffer&&750>=ea.byteLength)W=new Blob([ea]);else if(ea instanceof Blob&&750>=ea.size)W=ea;else return ea;
var Y=new g,Z=new FileReader;Z.readAsText(W);Z.onloadend=function(){if(!Z.error)try{var aa=JSON.parse(Z.result);if(aa.error)var ia=aa.error}catch(na){}ia?(ia=l.mixin(Error(),ia),ia.log=!!z.isDebug,null==ia.httpCode&&(ia.httpCode=ia.code),Y.reject(ia)):Y.resolve(ea)};return Y.promise}).addCallback(function(ea){ca.ioArgs=ca._pendingDfd&&ca._pendingDfd.ioArgs;h.returnFullResponse&&(ea={data:ea,_xhr:ca.ioArgs&&ca.ioArgs.xhr,getHeader:B});ca.callback(ea);ca._pendingDfd=null}).addErrback(function(ea){if(ea){var W=
ea.code;var Y=ea.subcode;var Z=(Z=ea.messageCode)&&Z.toUpperCase()}if(ea&&403==W&&(4==Y||ea.message&&-1<ea.message.toLowerCase().indexOf("ssl")&&-1===ea.message.toLowerCase().indexOf("permission"))){if(!d._ssl){d._ssl=d._sslFromServer=!0;e(ca,!0,d,h);return}}else if(ea&&415==ea.status){if(R(d.url),!d._err415){d._err415=1;e(ca,!0,d,h);return}}else if(O.id&&-1!==A.indexOf(O.id._errorCodes,W)&&!O.id._isPublic(d.url)&&!r&&(403!=W||-1===A.indexOf(Q,Z)&&(!P.isDefined(Y)||2==Y&&d._token))){ca._pendingDfd=
O.id.getCredential(d.url,{token:d._token,error:ea});ca._pendingDfd.addCallback(function(aa){d._token=aa.token;d._credential=aa;d._ssl=d._sslFromServer||aa.ssl;e(ca,!0,d,h)}).addErrback(function(aa){ca.errback(aa);ca._pendingDfd=null});return}ca.ioArgs=ca._pendingDfd&&ca._pendingDfd.ioArgs;ca.isFulfilled()||ca.errback(ea);ca._pendingDfd=null}).then(null,null,function(ea){ca.progress(ea)})}var x=d.form,r=h.disableIdentityLookup,J=h._preLookup,T=!1;if(V("esri-workers")&&!1!==L.useWorkers)if(!0===h.useWorkers||
!0===L.useWorkers)T=!0;else if(h.workerOptions){var X=h.workerOptions;if(X.callback||X.worker&&X.worker.worker instanceof Worker)T=!0}var da=x&&V("esri-file-upload")&&x instanceof FormData,fa=x&&(x.elements?A.some(x.elements,function(ca){return"file"===ca.type}):da),ba=-1!==d.url.toLowerCase().indexOf("token\x3d")||d.content&&d.content.token||fa&&A.some(x.elements,function(ca){return"token"===ca.name})?1:0;if(!a){k.addCallback(function(ca){if(ca&&(/\/sharing\/rest\/accounts\/self/i.test(d.url)||/\/sharing\/rest\/portals\/self/i.test(d.url))){if(!ba&&
!d._token&&ca.user&&ca.user.username){L.webTierAuthServers.push(D(d.url));var ha=L.corsEnabledServers,ea=w.canUseXhr(d.url,!0),W={host:D(d.url),withCredentials:!0};if(-1===ea)ha.push(W);else{var Y=ha[ea];Y instanceof RegExp?(W.host=Y,ha.splice(ea,1,W)):"object"===typeof Y?Y.withCredentials=!0:ha.splice(ea,1,W)}}Array.isArray(ca.authorizedCrossOriginNoCorsDomains)&&m.registerNoCorsDomains(ca.authorizedCrossOriginNoCorsDomains)}if(ca=d._credential)if(ha=(ha=O.id.findServerInfo(ca.server))&&ha.owningSystemUrl)ha=
ha.replace(/\/?$/,"/sharing"),(ca=O.id.findCredential(ha,ca.userId))&&-1===O.id._getIdenticalSvcIdx(ha,ca)&&ca.resources.splice(0,0,ha)});k.addBoth(function(ca){delete d._credential;!ca||V("ie")&&ca.nodeType||(ca._ssl=d._ssl)});var ka=d.load,la=d.error;ka&&k.addCallback(function(ca){var ha=k._pendingDfd;ha=ha&&ha.ioArgs;return ka.call(ha&&ha.args,ca,ha)});la&&k.addErrback(function(ca){var ha=k._pendingDfd;ha=ha&&ha.ioArgs;return la.call(ha&&ha.args,ca,ha)})}!O.id||ba||d._token||O.id._isPublic(d.url)||
r&&!J||!(a=O.id.findCredential(d.url))||(d._token=a.token,d._ssl=a.ssl);T?h.workerOptions&&h.workerOptions.worker?(u||(u=t),t=h.workerOptions.worker,E(k)):G(["./workers/RequestClient"],function(ca){u||(u=t);if(h.workerOptions){var ha=h.workerOptions;t=ca.getClient(ha.callback,ha.cbFunction)}else t=ca.getClient();E(k)}):(u&&(t=u,u=null),E(k));return k}function f(k,a){k.url=w.fixUrl(k.url);a=a||{};var d=new g(I._dfdCanceller),h=c(k.url);d._pendingDfd=h;h.always(function(E){E&&"cancel"===E.dojoType?
d.reject(E):e(d,!1,k,a)});return d}var u=null,C,L=H.defaults.io,Q=["COM_0056","COM_0057","SB_0008"],S=0,U=/%[0-9A-F]{2}/i,N=function(){var k=new g;k.resolve();return k.promise}();f._makeRequest=M;f._processRequest=e;f._disableCors=R;f._detectCors=c;f.setRequestPreCallback=b;O.request=f;O._makeRequest=M;O._processRequest=e;O._disableCors=R;O._detectCors=c;O.setRequestPreCallback=b;return f})},"esri/core/request/script":function(){define("require exports dojo/Deferred dojo/request/script dojo/text!./iframe.html ../sniff".split(" "),
function(G,A,z,g,l,v){function t(){var w=document.createElement("iframe");w.name="esri_core_jsonp_iframe";w.style.display="none";w.setAttribute("sandbox","allow-scripts");if(!v("ff")&&"srcdoc"in w){var I=G.toUrl("dojo/dojo.js"),m=l.replace("../../../dojo/dojo.js",I);I=I.slice(0,-7);m=m.replace("../../../dojo/",I);w.srcdoc=m}else m=G.toUrl("./iframe.html"),"http:"===window.location.protocol&&0===m.indexOf("https:")&&(m=m.replace("https:","http:")),w.src=m;document.body.appendChild(w);return w}function y(){var w=
new MessageChannel;w.port1.addEventListener("message",p);w.port1.start();return w}function p(w){var I=w.data;if("ready"===I){I=0;for(var m=V;I<m.length;I++)w=m[I],n(w,O);V=null}else if(w=P[I.id])delete P[I.id],I.isError?w.dfd.reject(Error(I.message)):w.dfd.resolve(I.response)}function q(w,I){w.addEventListener("load",function(){w.contentWindow.postMessage("init","*",[I.port2])})}function n(w,I){P[w.message.id]=w;I.port1.postMessage(w.message)}Object.defineProperty(A,"__esModule",{value:!0});var F,
O,H=0,V=[],P={};A.get=function(w,I){if(!v("esri-script-sandbox"))return g.get(w,I);var m=null;I&&(m={jsonp:I.jsonp,preventCache:I.preventCache,query:I.query,timeout:I.timeout});var D=new z(function(){if(V){var K=V.indexOf(B);-1<K&&V.splice(K,1)}else B.message.id in P&&delete P[B.message.id]}),B={dfd:D,message:{id:"id"+(++H+Math.random()),url:w,options:m}};F||(F=t(),O=y(),q(F,O));V?V.push(B):n(B,O);return D.promise}})},"dojo/request/script":function(){define("module ./watch ./util ../_base/kernel ../_base/array ../_base/lang ../on ../dom ../dom-construct ../has ../_base/window".split(" "),
function(G,A,z,g,l,v,t,y,p,q,n){function F(R,c){R.canDelete&&w._remove(R.id,c.options.frameDoc,!0)}function O(R){M&&M.length&&(l.forEach(M,function(c){w._remove(c.id,c.frameDoc);c.frameDoc=null}),M=[]);return R.options.jsonp?!R.data:!0}function H(R){return!!this.scriptLoaded}function V(R){return(R=R.options.checkString)&&eval("typeof("+R+') !\x3d\x3d "undefined"')}function P(R,c){if(this.canDelete){var b=this.response.options;M.push({id:this.id,frameDoc:b.ioArgs?b.ioArgs.frameDoc:b.frameDoc});b.ioArgs&&
(b.ioArgs.frameDoc=null);b.frameDoc=null}c?this.reject(c):this.resolve(R)}function w(R,c,b){var e=z.parseArgs(R,z.deepCopy({},c));R=e.url;c=e.options;var f=z.deferred(e,F,O,c.jsonp?null:c.checkString?V:H,P);v.mixin(f,{id:I+m++,canDelete:!1});c.jsonp&&((new RegExp("[?\x26]"+c.jsonp+"\x3d")).test(R)||(R+=(~R.indexOf("?")?"\x26":"?")+c.jsonp+"\x3d"+(c.frameDoc?"parent.":"")+I+"_callbacks."+f.id),f.canDelete=!0,K[f.id]=function(L){e.data=L;f.handleResponse(e)});z.notify&&z.notify.emit("send",e,f.promise.cancel);
if(!c.canAttach||c.canAttach(f)){var u=w._attach(f.id,R,c.frameDoc,function(L){if(!(L instanceof Error)){var Q=Error("Error loading "+(L.target?L.target.src:"script"));Q.source=L;L=Q}f.reject(L);w._remove(f.id,c.frameDoc,!0)});if(!c.jsonp&&!c.checkString)var C=t(u,D,function(L){if("load"===L.type||B.test(u.readyState))C.remove(),f.scriptLoaded=L})}A(f);return b?f:f.promise}q.add("script-readystatechange",function(R,c){return"undefined"!==typeof c.createElement("script").onreadystatechange&&("undefined"===
typeof R.opera||"[object Opera]"!==R.opera.toString())});var I=G.id.replace(/[\/\.\-]/g,"_"),m=0,D=q("script-readystatechange")?"readystatechange":"load",B=/complete|loaded/,K=g.global[I+"_callbacks"]={},M=[];w.get=w;w._attach=function(R,c,b,e){b=b||n.doc;var f=b.createElement("script");if(e)t.once(f,"error",e);f.type="text/javascript";try{f.src=c}catch(u){e&&e(f)}f.id=R;f.async=!0;f.charset="utf-8";return b.getElementsByTagName("head")[0].appendChild(f)};w._remove=function(R,c,b){p.destroy(y.byId(R,
c));K[R]&&(b?K[R]=function(){delete K[R]}:delete K[R])};w._callbacksProperty=I+"_callbacks";return w})},"esri/core/sniff":function(){define(["../sniff"],function(G){return G})},"dojo/request/iframe":function(){define("module require ./watch ./util ./handlers ../_base/lang ../io-query ../query ../has ../dom ../dom-construct ../_base/window ../NodeList-dom ../NodeList-manipulate".split(" "),function(G,A,z,g,l,v,t,y,p,q,n,F){function O(B){return!this.isFulfilled()}function H(B){return!!this._finished}
function V(B,K){if(!K)try{var M=B.options,R=w.doc(w._frame),c=M.handleAs;if("html"!==c){if("xml"===c)if("html"===R.documentElement.tagName.toLowerCase()){y("a",R.documentElement).orphan();var b=R.documentElement.innerText||R.documentElement.textContent;b=b.replace(/>\s+</g,"\x3e\x3c");B.text=v.trim(b)}else B.data=R;else B.text=R.getElementsByTagName("textarea")[0].value;l(B)}else B.data=R}catch(e){K=e}K?this.reject(K):this._finished?this.resolve(B):this.reject(Error("Invalid dojo/request/iframe request state"))}
function P(B){this._callNext()}function w(B,K,M){var R=g.parseArgs(B,g.deepCreate(D,K),!0);B=R.url;K=R.options;if("GET"!==K.method&&"POST"!==K.method)throw Error(K.method+" not supported by dojo/request/iframe");w._frame||(w._frame=w.create(w._iframeName,m+"();"));B=g.deferred(R,null,O,H,V,P);B._callNext=function(){this._calledNext||(this._calledNext=!0,w._currentDfd=null,w._fireNextRequest())};B._legacy=M;w._dfdQueue.push(B);w._fireNextRequest();z(B);return M?B:B.promise}var I=G.id.replace(/[\/\.\-]/g,
"_"),m=I+"_onload";F.global[m]||(F.global[m]=function(){var B=w._currentDfd;if(B){var K=q.byId(B.response.options.form)||B._tmpForm;if(K){for(var M=B._contentToClean,R=0;R<M.length;R++)for(var c=M[R],b=0;b<K.childNodes.length;b++){var e=K.childNodes[b];if(e.name===c){n.destroy(e);break}}B._originalAction&&K.setAttribute("action",B._originalAction);B._originalMethod&&(K.setAttribute("method",B._originalMethod),K.method=B._originalMethod);B._originalTarget&&(K.setAttribute("target",B._originalTarget),
K.target=B._originalTarget)}B._tmpForm&&(n.destroy(B._tmpForm),delete B._tmpForm);B._finished=!0}else w._fireNextRequest()});var D={method:"POST"};w.create=function(B,K,M){if(F.global[B])return F.global[B];if(F.global.frames[B])return F.global.frames[B];M||(p("config-useXDomain")&&p("config-dojoBlankHtmlUrl"),M=p("config-dojoBlankHtmlUrl")||A.toUrl("dojo/resources/blank.html"));K=n.place('\x3ciframe id\x3d"'+B+'" name\x3d"'+B+'" src\x3d"'+M+'" onload\x3d"'+K+'" style\x3d"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden"\x3e',
F.body());return F.global[B]=K};w.doc=function(B){if(B.contentDocument)return B.contentDocument;var K=B.name;if(K){var M=F.doc.getElementsByTagName("iframe");if(B.document&&M[K].contentWindow&&M[K].contentWindow.document)return M[K].contentWindow.document;if(F.doc.frames[K]&&F.doc.frames[K].document)return F.doc.frames[K].document}return null};w.setSrc=function(B,K,M){B=F.global.frames[B.name];B.contentWindow&&(B=B.contentWindow);try{M?B.location.replace(K):B.location=K}catch(R){}};w._iframeName=
I+"_IoIframe";w._notifyStart=function(){};w._dfdQueue=[];w._currentDfd=null;w._fireNextRequest=function(){try{if(!w._currentDfd&&w._dfdQueue.length){do var B=w._currentDfd=w._dfdQueue.shift();while(B&&(B.canceled||B.isCanceled&&B.isCanceled())&&w._dfdQueue.length);if(!B||B.canceled||B.isCanceled&&B.isCanceled())w._currentDfd=null;else{var K=B.response,M=K.options,R=B._contentToClean=[],c=q.byId(M.form),b=g.notify,e=M.data||null;if(!B._legacy&&"POST"===M.method&&!c)c=B._tmpForm=n.create("form",{name:I+
"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},F.body());else if("GET"===M.method&&c&&-1<K.url.indexOf("?")){var f=K.url.slice(K.url.indexOf("?")+1);e=v.mixin(t.queryToObject(f),e)}if(c){if(!B._legacy){var u=c;do u=u.parentNode;while(u&&u!==F.doc.documentElement);u||(c.style.position="absolute",c.style.left="-1000px",c.style.top="-1000px",F.body().appendChild(c));c.name||(c.name=I+"_form")}if(e){u=function(k,a){n.create("input",{type:"hidden",name:k,value:a},c);R.push(k)};for(var C in e){var L=
e[C];if(v.isArray(L)&&1<L.length)for(f=0;f<L.length;f++)u(C,L[f]);else{var Q=y("input[name\x3d'"+C+"']",c);-1==Q.indexOf()?u(C,L):Q.val(L)}}}var S=c.getAttributeNode("action"),U=c.getAttributeNode("method"),N=c.getAttributeNode("target");K.url&&(B._originalAction=S?S.value:null,S?S.value=K.url:c.setAttribute("action",K.url));B._legacy?U&&U.value||(U?U.value=M.method:c.setAttribute("method",M.method)):(B._originalMethod=U?U.value:null,U?U.value=M.method:c.setAttribute("method",M.method));B._originalTarget=
N?N.value:null;N?N.value=w._iframeName:c.setAttribute("target",w._iframeName);c.target=w._iframeName;b&&b.emit("send",K,B.promise.cancel);w._notifyStart(K);c.submit()}else M="",K.options.data&&(M=K.options.data,"string"!==typeof M&&(M=t.objectToQuery(M))),u=K.url+(-1<K.url.indexOf("?")?"\x26":"?")+M,b&&b.emit("send",K,B.promise.cancel),w._notifyStart(K),w.setSrc(w._frame,u,!0)}}}catch(k){B.reject(k)}};g.addCommonMethods(w,["GET","POST"]);return w})},"dojo/NodeList-manipulate":function(){define("./query ./_base/lang ./_base/array ./dom-construct ./dom-attr ./NodeList-dom".split(" "),
function(G,A,z,g,l){function v(p){for(;p.childNodes[0]&&1==p.childNodes[0].nodeType;)p=p.childNodes[0];return p}function t(p,q){"string"==typeof p?(p=g.toDom(p,q&&q.ownerDocument),11==p.nodeType&&(p=p.childNodes[0])):1==p.nodeType&&p.parentNode&&(p=p.cloneNode(!1));return p}var y=G.NodeList;A.extend(y,{_placeMultiple:function(p,q){for(var n="string"==typeof p||p.nodeType?G(p):p,F=[],O=0;O<n.length;O++)for(var H=n[O],V=this.length,P=V-1,w;w=this[P];P--)0<O&&(w=this._cloneNode(w),F.unshift(w)),P==V-
1?g.place(w,H,q):H.parentNode.insertBefore(w,H),H=w;F.length&&(F.unshift(0),F.unshift(this.length-1),Array.prototype.splice.apply(this,F));return this},innerHTML:function(p){return arguments.length?this.addContent(p,"only"):this[0].innerHTML},text:function(p){if(arguments.length){for(var q=0,n;n=this[q];q++)1==n.nodeType&&l.set(n,"textContent",p);return this}var F="";for(q=0;n=this[q];q++)F+=l.get(n,"textContent");return F},val:function(p){if(arguments.length){for(var q=A.isArray(p),n=0,F;F=this[n];n++){var O=
F.nodeName.toUpperCase(),H=F.type,V=q?p[n]:p;if("SELECT"==O)for(O=F.options,H=0;H<O.length;H++){var P=O[H];P.selected=F.multiple?-1!=z.indexOf(p,P.value):P.value==V}else"checkbox"==H||"radio"==H?F.checked=F.value==V:F.value=V}return this}if((F=this[0])&&1==F.nodeType){p=F.value||"";if("SELECT"==F.nodeName.toUpperCase()&&F.multiple){p=[];O=F.options;for(H=0;H<O.length;H++)P=O[H],P.selected&&p.push(P.value);p.length||(p=null)}return p}},append:function(p){return this.addContent(p,"last")},appendTo:function(p){return this._placeMultiple(p,
"last")},prepend:function(p){return this.addContent(p,"first")},prependTo:function(p){return this._placeMultiple(p,"first")},after:function(p){return this.addContent(p,"after")},insertAfter:function(p){return this._placeMultiple(p,"after")},before:function(p){return this.addContent(p,"before")},insertBefore:function(p){return this._placeMultiple(p,"before")},remove:y.prototype.orphan,wrap:function(p){if(this[0]){p=t(p,this[0]);for(var q=0,n;n=this[q];q++){var F=this._cloneNode(p);n.parentNode&&n.parentNode.replaceChild(F,
n);v(F).appendChild(n)}}return this},wrapAll:function(p){if(this[0]){p=t(p,this[0]);this[0].parentNode.replaceChild(p,this[0]);p=v(p);for(var q=0,n;n=this[q];q++)p.appendChild(n)}return this},wrapInner:function(p){if(this[0]){p=t(p,this[0]);for(var q=0;q<this.length;q++){var n=this._cloneNode(p);this._wrap(A._toArray(this[q].childNodes),null,this._NodeListCtor).wrapAll(n)}}return this},replaceWith:function(p){p=this._normalize(p,this[0]);for(var q=0,n;n=this[q];q++)this._place(p,n,"before",0<q),n.parentNode.removeChild(n);
return this},replaceAll:function(p){p=G(p);for(var q=this._normalize(this,this[0]),n=0,F;F=p[n];n++)this._place(q,F,"before",0<n),F.parentNode.removeChild(F);return this},clone:function(){for(var p=[],q=0;q<this.length;q++)p.push(this._cloneNode(this[q]));return this._wrap(p,this,this._NodeListCtor)}});y.prototype.html||(y.prototype.html=y.prototype.innerHTML);return y})},"esri/support/requestUtils":function(){define(["dojo/_base/Deferred","dojo/_base/url","../config","../urlUtils"],function(G,A,
z,g){function l(t){t=new A(t);return t.scheme+"://"+t.authority}var v=z.defaults.io;return{registerNoCorsDomains:function(t){v.crossOriginNoCorsDomains||(v.crossOriginNoCorsDomains={});for(var y=v.crossOriginNoCorsDomains,p=0;p<t.length;p++){var q=t[p];q=q.toLowerCase();/^https?:\/\//.test(q)?y[l(q)]=0:(y[l("http://"+q)]=0,y[l("https://"+q)]=0)}},isNoCorsRequestRequired:function(t){var y=v.crossOriginNoCorsDomains;return y?(t=l(t),t=t.toLowerCase(),!g.hasSameOrigin(t,window.location.origin)&&y[t]<
Date.now()-36E5):!1},sendNoCorsRequest:function(t,y){var p=new G,q=v.crossOriginNoCorsDomains;q&&(q[l(t).toLowerCase()]=Date.now());q=g.urlToObject(t);t=q.path;if(q.query&&"json"===q.query.f||y&&"json"===y.f)t+="?f\x3djson";fetch(t,{mode:"no-cors",credentials:"include"}).then(p.resolve,p.resolve);return p}}})},"esri/Evented":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/Evented dojo/has ./kernel".split(" "),function(G,A,z,g,l,v){G=G([g],{declaredClass:"esri.Evented",registerConnectEvents:function(){var t=
this.constructor,y=this.constructor._meta.parents,p=[{}],q={},n,F=function(H,V){A.isArray(H)||(H=[H]);for(var P=0;P<H.length;P++){var w=H[P];w._meta&&w._meta.parents&&F(w._meta.parents,V);w.prototype._eventMap&&V.push(A.mixin({},w.prototype._eventMap))}return V};if(!t._onMap){F(y,p);p.push(this._eventMap);y=A.mixin.apply(this,p);for(O in this)/^on\w/.test(O)&&A.isFunction(this[O])&&(p=this._hyphenLower(O).toLowerCase(),y[p]||(q[p]={method:O}));for(n in y){var O=this._onCamelCase(n);q[n]={method:O,
argKeys:y[n]}}t._onMap=q;return t._onMap}},on:function(t,y){if(-1<t.indexOf(",")){for(var p=t.split(/\s*,\s*/),q=p.length,n=[];q--;)n.push(this.on(p[q],y));n.remove=function(){for(var H=0;H<n.length;H++)n[H].remove()};return n}p=this.constructor._onMap||this.registerConnectEvents();q="string"==typeof t&&t.toLowerCase();var F=this._onCamelCase(q),O=p&&p[q];return(F=O&&O.method||this[F]&&A.isFunction(this[F])&&F)?O&&A.isArray(O.argKeys)?(p=this._onArr2Obj(y,p[q].argKeys),z.after(this,F,p,!0)):z.after(this,
F,function(H){H=H||{};H.target||(H.target=this);y.call(this,H)},!0):this.inherited(arguments)},emit:function(t,y){var p,q,n=t.toLowerCase();var F=this._onCamelCase(t);var O=this.constructor._onMap||this.registerConnectEvents();F=(q=O&&O[n]&&O[n].method||A.isFunction(this[F])&&F)&&this[q];q&&O&&O[n]&&this._onObj2Arr(function(){p=Array.prototype.slice.call(arguments)},O[n].argKeys)(y);y=y||{};y.target||(y.target=this);if(F){var H=p&&p.length?p:[y];H=F.apply(this,H)}this.inherited(arguments,[t,y]);return H},
_onObj2Arr:function(t,y){if(y){var p=this;return function(q){var n,F=[],O=y.length;for(n=0;n<O;n++)F[n]=q[y[n]];t.apply(p,F)}}return t},_onArr2Obj:function(t,y){if(y){var p=this;return function(){var q,n={},F=arguments.length;for(q=0;q<F;q++)n[y[q]]=arguments[q];n.target||(n.target=p);t.call(p,n)}}return t},_hyphenLower:function(t){return t.replace(/^on/,"").replace(/[A-Z](?=[a-z])/g,function(y,p){return(p?"-":"")+y.toLowerCase()})},_onCamelCase:function(t){return"on"+t.substr(0,1).toUpperCase()+
t.substr(1).replace(/\-([a-z])/g,function(y,p){return p.toUpperCase()})}});return v.Evented=G})},"esri/OAuthCredential":function(){define(["./kernel","dojo/_base/declare","dojo/has"],function(G,A,z){A=A(null,{declaredClass:"esri.OAuthCredential",oAuthInfo:null,storage:null,appId:null,codeVerifier:null,expires:null,refreshToken:null,ssl:null,stateUID:null,token:null,userId:null,constructor:function(g,l){this.oAuthInfo=g;this.storage=l;this._init()},isValid:function(){var g=!1;if(this.oAuthInfo&&this.userId&&
(this.refreshToken||this.token))if(null==this.expires&&this.refreshToken)g=!0;else{var l=Date.now();this.expires>l&&(this.expires-l)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&(g=!0)}return g},save:function(){if(!this.storage)return!1;var g=this._load(),l=this.oAuthInfo;if(l&&l.authNamespace&&l.portalUrl){var v=g[l.authNamespace];v||(v=g[l.authNamespace]={});this.appId||(this.appId=l.appId);v[l.portalUrl]={appId:this.appId,codeVerifier:this.codeVerifier,expires:this.expires,refreshToken:this.refreshToken,
ssl:this.ssl,stateUID:this.stateUID,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",JSON.stringify(g))}catch(t){return!1}return!0}return!1},destroy:function(){var g=this._load(),l=this.oAuthInfo;if(l&&l.appId&&l.portalUrl&&(null==this.expires||this.expires>Date.now())&&(this.refreshToken||this.token)){var v=l.portalUrl.replace(/^http:/i,"https:")+"/sharing/rest/oauth2/revokeToken",t=new FormData;t.append("f","json");t.append("auth_token",this.refreshToken||this.token);
t.append("client_id",l.appId);t.append("token_type_hint",this.refreshToken?"refresh_token":"access_token");if("function"===typeof navigator.sendBeacon)navigator.sendBeacon(v,t);else{var y=new XMLHttpRequest;y.open("POST",v);y.send(t)}}if(l&&l.authNamespace&&l.portalUrl&&this.storage&&(v=g[l.authNamespace])){delete v[l.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",JSON.stringify(g))}catch(p){}}l&&(this.oAuthInfo=l._oAuthCred=null)},_init:function(){var g=this._load(),l=this.oAuthInfo;l&&l.authNamespace&&
l.portalUrl&&(g=g[l.authNamespace])&&(g=g[l.portalUrl])&&(this.appId=g.appId,this.codeVerifier=g.codeVerifier,this.expires=g.expires,this.refreshToken=g.refreshToken,this.ssl=g.ssl,this.stateUID=g.stateUID,this.token=g.token,this.userId=g.userId)},_load:function(){var g={};if(this.storage){var l=this.storage.getItem("esriJSAPIOAuth");if(l)try{g=JSON.parse(l)}catch(v){}}return g}});return G.OAuthCredential=A})},"esri/arcgis/OAuthInfo":function(){define(["../kernel","../lang","dojo/_base/declare","dojo/_base/lang",
"dojo/has"],function(G,A,z,g,l){var v=z(null,{declaredClass:"esri.arcgis.OAuthInfo",constructor:function(t){g.mixin(this,{expiration:20160,minTimeUntilExpiration:30,portalUrl:"https://www.arcgis.com",authNamespace:"/",forceLogin:!1,popup:!1,popupCallbackUrl:"oauth-callback.html",popupWindowFeatures:"height\x3d490,width\x3d800,resizable,scrollbars,status",preserveUrlHash:!1,flowType:"auto"},t)},_oAuthCred:null,toJson:function(){return A.fixJson({appId:this.appId,expiration:this.expiration,locale:this.locale,
minTimeUntilExpiration:this.minTimeUntilExpiration,portalUrl:this.portalUrl,authNamespace:this.authNamespace,forceLogin:this.forceLogin,popup:this.popup,popupCallbackUrl:this.popupCallbackUrl,popupWindowFeatures:this.popupWindowFeatures,preserveUrlHash:this.preserveUrlHash,flowType:this.flowType})},clone:function(){return new v(this.toJson())}});g.setObject("arcgis.OAuthInfo",v,G);return v})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),
function(G,A,z,g,l,v,t,y){return G("dijit.form.Form",[l,v,t,y],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(p){A.set(this.domNode,
"encType",p);g("ie")&&(this.domNode.encoding=p);this._set("encType",p)},reset:function(p){var q={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:p?p.target:this.domNode,target:p?p.target:this.domNode};!1!==this.onReset(q)&&q.returnValue&&this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(p){this.reset(p);p.stopPropagation();p.preventDefault();return!1},_onSubmit:function(p){var q=this.constructor.prototype;if(this.execute!=
q.execute||this.onExecute!=q.onExecute)z.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(p)&&(p.stopPropagation(),p.preventDefault())},onSubmit:function(){return this.isValid()},submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"esri/OAuthSignInHandler":function(){define("./Credential ./domUtils ./lang ./urlUtils dijit/Dialog dijit/registry dojo/_base/config dojo/_base/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!./nls/jsapi dojo/io-query ./core/events dijit/form/Button dojo/query".split(" "),
function(G,A,z,g,l,v,t,y,p,q,n,F,O){var H=null,V=null;try{H=window.localStorage,V=window.sessionStorage}catch(w){}var P=window.crypto||window.msCrypto;return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${oAuthInfo}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(w){this._oAuthRedirectFunc=w},oAuthSignIn:function(w,I,m,D){var B=this._oAuthDfd=new y;B.resUrl_=w;B.sinfo_=I;B.oinfo_=m;var K=m._oAuthCred;if(K.storage&&("authorization-code"===m.flowType||"auto"===m.flowType&&!m.popup&&8.4<=I.currentVersion)){var M=P.getRandomValues(new Uint8Array(32));var R=g.base64UrlEncode(M);K.codeVerifier=R;M=P.getRandomValues(new Uint8Array(32));K.stateUID=g.base64UrlEncode(M);K.save()||(K.codeVerifier=R=null)}else K.codeVerifier=null;var c=
this;this._getCodeChallenge(R).then(function(b){var e=!D||!1!==D.oAuthPopupConfirmation;if(!m.popup||!e)return c._doOAuthSignIn(w,I,m,b),B;B.codeChallenge_=b;c._nls||(c._nls=n.identity);c.oAuthDialog||(c.oAuthDialog=c._createOAuthDialog());b=c.oAuthDialog;e=D&&D.error;var f=D&&D.token;A.hide(b.errMsg_);e&&403==e.code&&f&&(q.set(b.errMsg_,"innerHTML",c._nls.forbidden),A.show(b.errMsg_));q.set(b.serverLink_,{title:I.server,innerHTML:-1!==I.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":
I.server});b.show()});return B},setOAuthResponseHash:function(w){w&&("#"===w.charAt(0)&&(w=w.substring(1)),this._processOAuthPopupParams(F.queryToObject(w)))},_createOAuthDialog:function(){var w=this._nls,I=z.substitute(w,this._oAuthDialogContent);I=z.substitute({server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},I);var m=new l({title:w.title,content:I,"class":"esriOAuthSignInDialog",style:"min-width: 18em;",esriIdMgr_:this,execute_:function(){var D=m.esriIdMgr_._oAuthDfd;
m.hide_();m.esriIdMgr_._doOAuthSignIn(D.resUrl_,D.sinfo_,D.oinfo_,D.codeChallenge_)},cancel_:function(){var D=m.esriIdMgr_._oAuthDfd;m.esriIdMgr_._oAuthDfd=null;m.hide_();var B=Error("ABORTED");B.code="IdentityManager.2";B.log=!!t.isDebug;D.errback(B)},hide_:function(){A.hide(m.errMsg_);m.hide();l._DialogLevelManager.hide(m)}});w=m.domNode;m.btnSubmit_=v.byNode(p.query(".esriIdSubmit",w)[0]);m.btnCancel_=v.byNode(p.query(".esriIdCancel",w)[0]);m.serverLink_=p.query(".serverLink",w)[0];m.errMsg_=p.query(".esriErrorMsg",
w)[0];m.connect(m.btnSubmit_,"onClick",m.execute_);m.connect(m.btnCancel_,"onClick",m.onCancel);m.connect(m,"onCancel",m.cancel_);return m},_doOAuthSignIn:function(w,I,m,D){var B=this,K=m._oAuthCred,M={portalUrl:m.portalUrl};!m.popup&&m.preserveUrlHash&&window.location.hash&&(M.hash=window.location.hash);K.stateUID&&(M.uid=K.stateUID);M={client_id:m.appId,response_type:K.codeVerifier?"code":"token",state:JSON.stringify(M),expiration:m.expiration,locale:m.locale,redirect_uri:this._getRedirectURI(m,
!!K.codeVerifier)};m.forceLogin&&(M.force_login=!0);m.forceUserId&&m.userId&&(M.prepopulatedusername=m.userId);!m.popup&&this._doPortalSignIn(w)&&(M.redirectToUserOrgUrl=!0);K.codeVerifier&&(M.code_challenge=D||K.codeVerifier,M.code_challenge_method=D?"S256":"plain");D=m.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize";K=D+"?"+F.objectToQuery(M);if(m.popup){var R=window.open(K,"esriJSAPIOAuth",m.popupWindowFeatures);R?(R.focus(),this._oAuthDfd.oAuthWin_=R,this._oAuthIntervalId=setInterval(function(){if(R.closed){clearInterval(B._oAuthIntervalId);
B._oAuthOnPopupHandle.remove();var c=B._oAuthDfd;if(c){var b=Error("ABORTED");b.code="IdentityManager.2";b.log=!!t.isDebug;c.errback(b)}}},500),B._oAuthOnPopupHandle=O.on(window,["arcgis:auth:hash","arcgis:auth:location:search"],function(c){"arcgis:auth:hash"===c.type?B.setOAuthResponseHash(c.detail):B._setOAuthResponseQueryString(c.detail)})):(w=Error("ABORTED"),w.name="identity-manager:user-aborted",w.code="IdentityManager.2",w.log=!!t.isDebug,this._oAuthDfd.errback(w))}else this._rejectOnPersistedPageShow=
!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:M,authorizeUrl:D,resourceUrl:w,serverInfo:I,oAuthInfo:m}):window.location.href=K},_getCodeChallenge:function(w){if(w&&window.isSecureContext)return w=(new TextEncoder).encode(w),P.subtle.digest("SHA-256",w).then(function(I){return g.base64UrlEncode(new Uint8Array(I))});w=new y;w.resolve(null);return w},_getRedirectURI:function(w,I){var m=window.location.href.replace(/#.*$/,"");if(w.popup)return g.getAbsoluteUrl(w.popupCallbackUrl);
if(I){var D=g.urlToObject(m);if(D.query)return"code error error_description message_code persist state".split(" ").forEach(function(B){delete D.query[B]}),(m=F.objectToQuery(D.query))?D.path+"?"+m:D.path}return m},_processOAuthPopupParams:function(w){var I=this._oAuthDfd;this._oAuthDfd=null;if(I)if(clearInterval(this._oAuthIntervalId),this._oAuthOnPopupHandle&&this._oAuthOnPopupHandle.remove(),w.error){var m="access_denied"===w.error;w=Error(m?"ABORTED":"OAuth: "+w.error+" - "+w.error_description);
w.name=m?"identity-manager:user-aborted":"identity-manager:authentication-failed";w.code="IdentityManagerBase."+(m?2:3);w.log=!!t.isDebug;I.errback(w)}else this._processOAuthResponseParams(w,I.oinfo_,I.sinfo_).then(function(D){I.resolve(D)})["catch"](function(D){I.reject(D)})},_processOAuthResponseParams:function(w,I,m){var D=I._oAuthCred;if(w.code){var B=D.codeVerifier;D.codeVerifier=null;D.stateUID=null;D.save();return this._getOAuthToken(m.server,w.code,I.appId,this._getRedirectURI(I,!0),B).then(function(M){var R=
new G({userId:M.username,server:m.server,token:M.access_token,expires:Date.now()+1E3*M.expires_in,ssl:M.ssl,oAuthState:w.state,_oAuthCred:D});I.userId=R.userId;D.storage=M.persist?H:V;D.refreshToken=M.refresh_token;D.token=null;D.expires=M.refresh_token_expires_in?Date.now()+1E3*M.refresh_token_expires_in:null;D.userId=R.userId;D.ssl=R.ssl;D.save();return R})}B=new G({userId:w.username,server:m.server,token:w.access_token,expires:Date.now()+1E3*Number(w.expires_in),ssl:"true"===w.ssl,oAuthState:w.state,
_oAuthCred:D});I.userId=B.userId;D.storage=w.persist?H:V;D.refreshToken=null;D.token=B.token;D.expires=B.expires;D.userId=B.userId;D.ssl=B.ssl;D.save();var K=new y;K.resolve(B);return K},_setOAuthResponseQueryString:function(w){w&&("?"===w.charAt(0)&&(w=w.substring(1)),this._processOAuthPopupParams(F.queryToObject(w)))}}})},"esri/core/events":function(){define([],function(){return{on:function(G,A,z){if(!G||"function"!==typeof G.on&&"function"!==typeof G.addEventListener)throw new TypeError("target is not a Evented or EventTarget object");
if("on"in G)return G.on(A,z);if(Array.isArray(A)){for(var g=A.slice(),l=0;l<g.length;l++)G.addEventListener(g[l],z);return{remove:function(){for(var v=0;v<g.length;v++)G.removeEventListener(g[v],z)}}}G.addEventListener(A,z);return{remove:function(){G.removeEventListener(A,z)}}}}})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(G,A,z,g,l){return z("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:!1,
contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var v=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);l.parse(v,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(g.hitch(this,function(t){this._startupWidgets=t;for(var y=0;y<t.length;y++)this._processTemplateNode(t[y],
function(p,q){return p[q]},function(p,q,n){return q in p?p.connect(p,q,n):p.on(q,n,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}},_processTemplateNode:function(v,t,y){return t(v,"dojoType")||t(v,"data-dojo-type")?
!0:this.inherited(arguments)},startup:function(){G.forEach(this._startupWidgets,function(v){v&&!v._started&&v.startup&&v.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dojo/debounce":function(){define([],function(){return function(G,A){var z;return function(){z&&clearTimeout(z);var g=this,l=arguments;z=setTimeout(function(){G.apply(g,l)},A)}}})},"esri/arcgis/Portal":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/kernel dojo/_base/Deferred dojo/_base/array dojo/_base/sniff require ../config ../kernel ../lang ../request ../urlUtils ../Evented ../IdentityManager".split(" "),
function(G,A,z,g,l,v,t,y,p,q,n,F,O){var H={options:{disableIdentityLookup:!0},requestParams:{f:"json"}},V=function(c){function b(e){c[e]||(c[e]=function(){var f=arguments;return g.when(c,function(u){Array.prototype.unshift.call(f,u.results||u);return V(l[e].apply(l,f))})})}if(!c)return c;c.then&&(c=A.delegate(c));c.total||(c.total=g.when(c,function(e){return q.isDefined(e.total)?e.total:e.length||0}));b("forEach");b("filter");b("map");b("some");b("every");return c},P={useSSL:function(c,b){var e=H&&
H.self||{};if(e&&!e.isPortal)return-1!==c.indexOf("https:")||e.allSSL?b.replace("http:","https:"):b;var f=P.getLocation(b);if(-1<e.portalHostname.toLowerCase().indexOf(f.hostname.toLowerCase())&&f.port&&"80"!==f.port&&"443"!==f.port){var u=f.pathname;u=0===u.indexOf("/")?u:"/"+u;return e.allSSL||-1<c.indexOf("https:")?"https://"+f.hostname+(e.httpsPort&&"443"!==e.httpsPort?":"+e.httpsPort:"")+u+f.search:"http://"+f.hostname+(e.httpPort&&"80"!==e.httpPort?":"+e.httpPort:"")+u+f.search}return-1!==c.indexOf("https:")||
e.allSSL?b.replace("http:","https:"):b},formatUrl:function(c){var b=H.currentToken;return-1!==c.indexOf("null")?null:P.useSSL(window.location.protocol,b?c+(-1!==c.indexOf("?")?"\x26":"?")+("token\x3d"+b):c)},getLocation:function(c){var b=document.createElement("a");b.href=c;return{protocol:b.protocol,hostname:b.hostname,port:b.port,pathname:b.pathname,search:b.search,hash:b.hash,host:b.host}},resultsToTypedArray:function(c,b,e){e=e?e.listings||e.notifications||e.userInvitations||e.tags||e.items||
e.groups||e.comments||e.provisions||e.results||e:[];return l.map(e,function(f){f=A.mixin(f,b||{});return c?new c(f):f})},clearFieldsFromObject:function(c,b){var e,f=c.length;if(A.isArray(c))for(e=0;e<f;e++)delete b[c[e]];else for(e in c)delete b[e];return b},requestToTypedArray:function(c,b,e,f,u){return V(P.request(c,b,e).then(A.partial(P.resultsToTypedArray,f,u)))},request:function(c,b,e){if(b){b.portal&&delete b.portal;if(b.form){var f=b.form;delete b.form}if(b.hasOwnProperty("withCredentials")){var u=
b.withCredentials;delete b.withCredentials}}b=A.mixin(A.mixin({},b||{}),H.requestParams);c={url:P.useSSL(window.location.protocol,c.url||c),content:b,callbackParamName:"callback",timeout:C&&C.timeout||0,form:f};null!=u&&(c.withCredentials=u);var C=A.mixin(e||{},H.options);return n(c,C)},formatQueryParams:function(c,b,e){c=A.mixin(A.mixin({},c),A.isString(b)?{q:b}:b||{});c.q=!e&&H.extraQuery?"("+c.q+")"+H.extraQuery:c.q;return c}},w=G([],{declaredClass:"esri.arcgis.PortalComment",constructor:function(c){A.mixin(this,
c);this.url=this.item.itemUrl+"/comments/"+this.id;this.created=this.created?new Date(this.created):null}}),I=G([],{declaredClass:"esri.arcgis.PortalRating",constructor:function(c){A.mixin(this,c);this.url=this.item.itemUrl+"/rating";this.created=this.created?new Date(this.created):null}}),m=G([],{declaredClass:"esri.arcgis.PortalItem",constructor:function(c){A.mixin(this,c);this.folderId=this.ownerFolder||this.folderId;this.itemUrl=(this.portal&&this.portal.portalUrl)+"content/items/"+this.id;this.userItemUrl=
this.hasOwnProperty("ownerFolder")?this.itemUrl.replace("/content/","/content/users/"+this.owner+(this.folderId?"/"+this.folderId:"")+"/"):null;this.itemDataUrl=P.formatUrl(this.itemUrl+"/data");this.thumbnailUrl=P.formatUrl(this.itemUrl+"/info/"+this.thumbnail);this.displayName=this._getDisplayName();this.iconUrl=this._getIconUrl();this.isPremiumContent=this._getIsPremiumContent();this.created=this.created?new Date(this.created):null;this.uploaded=this.uploaded?new Date(this.uploaded):null;this.modified=
this.modified?new Date(this.modified):null},getTypeInfo:function(){var c=this.type;return{source:-1<l.indexOf(this.typeKeywords||[],"ArcGIS Server")||"Feature Collection"===c?c:null,displayName:this.displayName,iconUrl:this.iconUrl,isPremiumContent:this.isPremiumContent,premiumIconUrl:this._getPremiumIconUrl()}},addComment:function(c){var b=A.isString(c)?{comment:c}:c;return P.request(this.itemUrl+"/addComment",b,{usePost:!0}).then(A.hitch(this,function(e){return new w(A.mixin(b,{id:e.commentId,item:this}))}))},
updateComment:function(c){if(c&&c.url&&c.comment)return P.request(c.url+"/update",{comment:c.comment},{usePost:!0}).then(function(b){c.id=b.commentId;return c});throw Error();},getComments:function(){return P.requestToTypedArray(this.itemUrl+"/comments",null,null,w,{item:this})},deleteComment:function(c){if(c&&c.url)return P.request(c.url+"/delete",null,{usePost:!0});throw Error();},addRating:function(c){var b=A.isObject(c)?c:{rating:parseFloat(c)};return P.request(this.itemUrl+"/addRating",b,{usePost:!0}).then(A.hitch(this,
function(e){return new I(A.mixin(b,{id:e.ratingId,item:this}))}))},getRating:function(){return P.request(this.itemUrl+"/rating").then(A.hitch(this,function(c){return new I(A.mixin(c,{item:this}))}))},deleteRating:function(){return P.request(this.itemUrl+"/deleteRating",null,{usePost:!0})},_getDisplayName:function(){var c=this.type,b=this.typeKeywords||[],e=c;"Feature Service"===c||"Feature Collection"===c?e=-1<l.indexOf(b,"Table")?"Table":-1<l.indexOf(b,"Route Layer")?"Route Layer":-1<l.indexOf(b,
"Markup")?"Markup":"Feature Layer":"Image Service"===c?e=-1<l.indexOf(b,"Elevation 3D Layer")?"Elevation Layer":-1<l.indexOf(b,"Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===c?e="Scene Layer":"Video Service"===c?e="Video Layer":"Scene Package"===c?e="Scene Layer Package":"Stream Service"===c?e="Feature Layer":"Geoprocessing Service"===c&&this.portal&&this.portal.isPortal?e=-1<l.indexOf(b,"Web Tool")?"Tool":"Geoprocessing Service":"Geoenrichment Service"===c?e="GeoEnrichment Service":
"Geocoding Service"===c?e="Locator":"Microsoft Powerpoint"===c?e="Microsoft PowerPoint":"GeoJson"===c?this.type=e="GeoJSON":"Globe Service"===c?e="Globe Layer":"Vector Tile Service"===c?e="Tile Layer":"netCDF"===c?e="NetCDF":"Map Service"===c?e=-1===l.indexOf(b,"Spatiotemporal")&&(-1<l.indexOf(b,"Hosted Service")||-1<l.indexOf(b,"Tiled"))&&-1===l.indexOf(b,"Relational")?"Tile Layer":"Map Image Layer":c&&-1<c.toLowerCase().indexOf("add in")?e=c.replace(/(add in)/ig,"Add-In"):"datastore catalog service"===
c?e="Big Data File Share":"Compact Tile Package"===c?e="Tile Package (tpkx)":"Raster function template"===c?e="Raster Function Template":"OGCFeatureServer"===c?e="OGC Feature Layer":"web mapping application"===c&&-1<l.indexOf(b,"configurableApp")&&(e="Instant App");return e},_getIconUrl:function(){var c=this.type&&this.type.toLowerCase()||"",b=this.typeKeywords||[],e=!1,f=!1,u=!1,C=!1,L=!1,Q=!1;f=!1;0<c.indexOf("service")||"feature collection"===c||"kml"===c||"wms"===c||"wmts"===c||"wfs"===c?(e=-1<
l.indexOf(b,"Hosted Service"),"feature service"===c||"feature collection"===c||"kml"===c||"wfs"===c?(C=-1<l.indexOf(b,"Table"),f=-1<l.indexOf(b,"Route Layer"),u=-1<l.indexOf(b,"Markup"),L=-1!==l.indexOf(b,"Spatiotemporal"),Q=-1!==l.indexOf(b,"UtilityNetwork"),c=L&&C?"spatiotemporaltable":C?"table":f?"routelayer":u?"markup":L?"spatiotemporal":Q?"utilitynetwork":e?"featureshosted":"features"):"map service"===c||"wms"===c||"wmts"===c?(L=-1!==l.indexOf(b,"Spatiotemporal"),f=-1!==l.indexOf(b,"Relational"),
c=L||f?"mapimages":e||-1<l.indexOf(b,"Tiled")||"wmts"===c?"maptiles":"mapimages"):c="scene service"===c?-1<l.indexOf(b,"Line")?"sceneweblayerline":-1<l.indexOf(b,"3DObject")?"sceneweblayermultipatch":-1<l.indexOf(b,"Point")?"sceneweblayerpoint":-1<l.indexOf(b,"IntegratedMesh")?"sceneweblayermesh":-1<l.indexOf(b,"PointCloud")?"sceneweblayerpointcloud":-1<l.indexOf(b,"Polygon")?"sceneweblayerpolygon":-1<l.indexOf(b,"Building")?"sceneweblayerbuilding":-1<l.indexOf(b,"Voxel")?"sceneweblayervoxel":"sceneweblayer":
"image service"===c?-1<l.indexOf(b,"Elevation 3D Layer")?"elevationlayer":-1<l.indexOf(b,"Tiled Imagery")?"tiledimagerylayer":"imagery":"stream service"===c?"streamlayer":"vector tile service"===c?"vectortile":"datastore catalog service"===c?"datastorecollection":"geocoding service"===c?"geocodeservice":"video service"===c?"mediaservice":"geoprocessing service"===c?-1<l.indexOf(b,"Web Tool")&&this.portal&&this.portal.isPortal?"tool":"layers":"geodata service"===c?"geodataservice":"layers"):c="web map"===
c||"cityengine web scene"===c?"maps":"web scene"===c?-1<l.indexOf(b,"ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===c&&-1<l.indexOf(b,"configurableApp")?"instantapps":"web mapping application"===c||"mobile application"===c||"application"===c||"operation view"===c||"desktop application"===c?"apps":"map document"===c||"map package"===c||"published map"===c||"scene document"===c||"globe document"===c||"basemap package"===c||"mobile basemap package"===c||"mobile map package"===
c||"project package"===c||"project template"===c||"pro map"===c||"layout"===c||"layer"===c&&-1<l.indexOf(b,"ArcGIS Pro")||"explorer map"===c&&l.indexOf(b,"Explorer Document")?"mapsgray":"service definition"===c||"csv"===c||"shapefile"===c||"cad drawing"===c||"geojson"===c||"360 vr experience"===c||"netcdf"===c||"administrative report"===c?"datafiles":"explorer add in"===c||"desktop add in"===c||"windows viewer add in"===c||"windows viewer configuration"===c?"appsgray":"arcgis pro add in"===c||"arcgis pro configuration"===
c?"addindesktop":"rule package"===c||"file geodatabase"===c||"sqlite geodatabase"===c||"csv collection"===c||"kml collection"===c||"windows mobile package"===c||"map template"===c||"desktop application template"===c||"gml"===c||"arcpad package"===c||"code sample"===c||"form"===c||"document link"===c||"earth configuration"===c||"operations dashboard add in"===c||"rules package"===c||"image"===c||"workflow manager package"===c||"explorer map"===c&&-1<l.indexOf(b,"Explorer Mapping Application")||-1<
l.indexOf(b,"Document")?"datafilesgray":"network analysis service"===c||"geoprocessing service"===c||"geodata service"===c||"geometry service"===c||"geoprocessing package"===c||"locator package"===c||"geoprocessing sample"===c||"workflow manager service"===c?"toolsgray":"layer"===c||"layer package"===c||"explorer layer"===c?"layersgray":"scene package"===c?"scenepackage":"mobile scene package"===c?"mobilescenepackage":"tile package"===c||"compact tile package"===c?"tilepackage":"task file"===c?"taskfile":
"report template"===c?"report-template":"statistical data collection"===c?"statisticaldatacollection":"insights workbook"===c?"workbook":"insights model"===c?"insightsmodel":"insights page"===c?"insightspage":"insights theme"===c?"insightstheme":"hub initiative"===c?"hubinitiative":"hub page"===c?"hubpage":"hub site application"===c?"hubsite":"hub event"===c?"hubevent":"hub project"===c?"hubproject":"relational database connection"===c?"relationaldatabaseconnection":"big data file share"===c?"datastorecollection":
"image collection"===c?"imagecollection":"desktop style"===c?"desktopstyle":"style"===c?"style":"dashboard"===c?"dashboard":"raster function template"===c?"rasterprocessingtemplate":"vector tile package"===c?"vectortilepackage":"ortho mapping project"===c?"orthomappingproject":"ortho mapping template"===c?"orthomappingtemplate":"solution"===c?"solutions":"geopackage"===c?"geopackage":"deep learning package"===c?"deeplearningpackage":"real time analytic"===c?"realtimeanalytics":"big data analytic"===
c?"bigdataanalytics":"feed"===c?"feed":"excalibur imagery project"===c?"excaliburimageryproject":"notebook"===c?"notebook":"storymap"===c?"storymap":"survey123 add in"===c?"survey123addin":"mission"===c?"mission":"mission report"===c?"missionreport":"quickcapture project"===c?"quickcaptureproject":"pro report"===c?"proreport":"urban model"===c?"urbanmodel":"web experience"===c?"experiencebuilder":"web experience template"===c?"webexperiencetemplate":"experience builder widget"===c?"experiencebuilderwidget":
"experience builder widget package"===c?"experiencebuilderwidgetpackage":"workflow"===c?"workflow":"kernel gateway connection"===c?"kernelgatewayconnection":"insights script"===c?"insightsscript":"hub initiative template"===c?"hubinitiativetemplate":"storymap theme"===c?"storymaptheme":"knowledge graph"===c?"knowledgegraph":"native application"===c?"nativeapp":"native application installer"===c?"nativeappinstaller":"link chart"===c?"linkchart":"investigation"===c?"investigation":"ogcfeatureserver"===
c?"features":"pro project"===c?"proproject":"insights workbook package"===c?"insightsworkbookpackage":"apache parquet"===c?"apacheparquet":"notebook code snippets"===c?"notebookcodesnippets":"suitability model"===c?"suitabilitymodel":"esri classifier definition"===c?"classifierdefinition":"esri classification schema"===c?"classificationschema":"insights data engineering workbook"===c?"dataengineeringworkbook":"insights data engineering model"===c?"dataengineeringmodel":"deep learning studio project"===
c?"deeplearningproject":"maps";return c?t.toUrl("../css/images/item_type_icons/"+c+"16.png"):null},_getIsPremiumContent:function(){var c=this.typeKeywords,b=!1;if(-1<l.indexOf(c,"Requires Subscription")||-1<l.indexOf(c,"Requires Credits"))b=!0;return b},_getPremiumIconUrl:function(){var c=this.typeKeywords,b;this.isPremiumContent&&(b=-1<l.indexOf(c,"Requires Credits")?"premiumcredits":"premiumitem");return b?t.toUrl("../css/images/item_type_icons/"+b+"16.png"):null},getThumbnailUrl:function(c){var b=
this.thumbnailUrl;b&&c&&(b+=(-1===b.indexOf("?")?"?":"\x26")+"w\x3d"+c);return b}}),D=G([],{declaredClass:"esri.arcgis.PortalListing",constructor:function(c){A.mixin(this,c);this.id=this.itemId;this.url=(this.portal&&this.portal.portalUrl)+"content/"+(this.userItemUrl?"items/":"listings/")+this.itemId;this.commentsUrl=this.url+"/comments";this.created=this.created?new Date(this.created):null;this.banner=this.banner?P.formatUrl(this.url+"/info/"+this.banner):"";this.thumbnail=this.thumbnail?P.formatUrl(this.url+
"/info/"+this.thumbnail):"";this.largeThumbnail=this.largeThumbnail?P.formatUrl(this.url+"/info/"+this.largeThumbnail):"";this.avgRating=this.avgRating||0;this.numRatings=this.numRatings||0;this.numComments=this.numComments||0;this.listingProperties=this.listingProperties||{priceDesc:"",creditsPerTransaction:0,licenseType:"free",trialSupported:!1,trialDuration:0,listingAccess:"private"};for(var b in this.listingProperties)this[b]&&(this.listingProperties[b]=this[b]);this.properties=this.properties||
{systemRequirements:"",termsAndConditions:"",version:"1.0"};this.screenshots=l.map(this.screenshots,A.hitch(this,function(e){return P.formatUrl(this.url+"/info/"+e)}));this.vendorName=this.vendor.name;this.vendor.thumbnail=this.vendor.thumbnail?this.userItemUrl?P.formatUrl(this.portal.portalUrl+"/portals/self/resources/"+this.vendor.thumbnail):P.formatUrl(this.url+"/vendorinfo/"+this.vendor.thumbnail):""},getComments:function(){return P.requestToTypedArray(this.commentsUrl,null,null,w,{item:this})},
getVendor:function(){return this.vendor}}),B=G([],{declaredClass:"esri.arcgis.PortalProvision",constructor:function(c){A.mixin(this,c);this.created=this.created?new Date(this.created):null;this.startDate=this.startDate?new Date(this.startDate):null;this.endDate=this.endDate&&-1!==this.endDate?new Date(this.endDate):null;this.listing=c.listing?new D(A.mixin(c.listing,{portal:this.portal})):null}}),K=G([],{declaredClass:"esri.arcgis.PortalGroup",constructor:function(c){A.mixin(this,c);this.url=(this.portal&&
this.portal.portalUrl)+"community/groups/"+this.id;this.thumbnailUrl=P.formatUrl(this.url+"/info/"+this.thumbnail);this.modified=this.modified?new Date(this.modified):null;this.created=this.created?new Date(this.created):null},getMembers:function(){return P.request(this.url+"/users")},queryItems:function(c,b){c=P.formatQueryParams({},c,b);c.q="group:"+this.id+(c.q?" "+c.q:"");return this.portal.queryItems(c)},getThumbnailUrl:function(c){var b=this.thumbnailUrl;b&&c&&(b+=(-1===b.indexOf("?")?"?":"\x26")+
"w\x3d"+c);return b}}),M=G([],{declaredClass:"esri.arcgis.PortalFolder",constructor:function(c){A.mixin(this,c);this.url=(this.portal&&this.portal.portalUrl)+"content/users/"+this.username+"/"+this.id;this.created=this.created?new Date(this.created):null},getItems:function(){return P.requestToTypedArray(this.url,null,null,m,{portal:this.portal,folderId:this.id})}}),R=G([],{declaredClass:"esri.arcgis.PortalUser",constructor:function(c){A.mixin(this,c);this.url=(this.portal&&this.portal.portalUrl)+
"community/users/"+this.username;this.userContentUrl=(this.portal&&this.portal.portalUrl)+"content/users/"+this.username;this.thumbnailUrl=this.thumbnail?P.formatUrl(this.url+"/info/"+this.thumbnail):null;this.modified=this.modified?new Date(this.modified):null;this.created=this.created?new Date(this.created):null},getGroups:function(){return V(P.request(this.url).then(A.hitch(this,function(c){return P.resultsToTypedArray(K,{portal:this.portal},c.groups)})))},getNotifications:function(){return P.requestToTypedArray(this.url+
"/notifications",null,null,null,{portal:this.portal})},getGroupInvitations:function(){return P.requestToTypedArray(this.url+"/invitations",null,null,null,{portal:this.portal})},getTags:function(){return P.requestToTypedArray(this.url+"/tags",null,null,null,{portal:this.portal})},getFolders:function(){return V(this.getContent(null,{num:1}).then(function(c){return c.folders}))},getItems:function(c){return V(this.getContent(c).then(function(b){return b.items}))},getItem:function(c){return P.request(this.portal.portalUrl+
"content/items/"+c).then(A.hitch(this,function(b){return new m(A.mixin(b,{portal:this.portal}))}))},getContent:function(c,b){var e=this.url.replace("/community/","/content/")+(c?"/"+c:"");return P.request(e,b).then(A.hitch(this,function(f){f.folders=P.resultsToTypedArray(M,{portal:this.portal},f.folders);f.items=P.resultsToTypedArray(m,{portal:this.portal,folderId:c},f.items);return f}))},getThumbnailUrl:function(c){var b=this.thumbnailUrl;b&&c&&(b+=(-1===b.indexOf("?")?"?":"\x26")+"w\x3d"+c);return b}});
G={Portal:G([O],{declaredClass:"esri.arcgis.Portal",onLoad:function(){},onError:function(){},constructor:function(c){c=A.isObject(c)?c:{url:c};this.registerConnectEvents();H={options:{disableIdentityLookup:!0},requestParams:{f:"json"}};c.self?(H.self=c.self,A.mixin(this,{url:c.url||F.getProtocolForWebResource()+"//"+(c.self.urlKey?c.self.urlKey+"."+c.self.customBaseUrl:c.self.portalHostname)}),this.portalUrl=-1!==this.url.indexOf("/sharing")?this.url+"/":this.url+"/sharing/rest/",c=c.self.user?this.signIn():
this.init(this.url)):(c.url&&A.mixin(this,{url:c.url}),c=this.init(this.url));c.then(A.hitch(this,function(){this.emit("ready",this);this.onLoad(this)}))},init:function(c,b){c=(c||this.portalUrl).replace(/\/+$/,"");this.portalUrl=-1!==c.indexOf("/sharing")?c+"/":c+"/sharing/rest/";F.canUseXhr(this.portalUrl)||y.defaults.io.corsEnabledServers.push(this.portalUrl.replace(/^https?:\/\//i,""));return this._getSelf(this.portalUrl).then(A.hitch(this,function(e){H.self=A.mixin({},e);(e=e.user)&&b&&(H.currentToken=
b&&b.token,H.loggedInUser=new R(A.mixin(e,{portal:this,credential:b})));H.self.id&&!1===H.self.canSearchPublic&&(H.extraQuery=" AND orgid:"+H.self.id);A.mixin(this,H.self);this.thumbnailUrl=P.formatUrl(this.portalUrl+"portals/self/resources/"+this.thumbnail);this.isOrganization=this.access&&this.access.length?!0:!1;this.created=this.created?new Date(this.created):null;this.modified=this.modified?new Date(this.modified):null;return this}),A.hitch(this,function(e){this.onError(e);throw e;}))},signIn:function(){var c=
new g,b=A.hitch(this,function(){this._onSignIn().then(A.hitch(this,function(){c.resolve(H.loggedInUser)}),A.hitch(this,function(e){c.reject(e)}))});if(H&&H.self)H&&H.loggedInUser?setTimeout(function(){c.resolve(H.loggedInUser)},0):b();else this.on("load",A.hitch(this,function(){b()}));return c},signOut:function(){H.loggedInUser.credential&&H.loggedInUser.credential.destroy();H.loggedInUser=null;H.options.disableIdentityLookup=!0;P.clearFieldsFromObject(H.self,this);H.self=null;return this.init(this.url)},
getPortalUser:function(){return H.loggedInUser},addResource:function(c,b){return P.request(this.portalUrl+"portals/self/addResource",{key:c,text:b},{usePost:!0})},update:function(c){return P.request(this.portalUrl+"portals/self/update",c,{usePost:!0})},queryGroups:function(c,b){return this._queryPortal(this.portalUrl+"community/groups",P.formatQueryParams({},c,b),K)},queryItems:function(c,b){return this._queryPortal(this.portalUrl+"search",P.formatQueryParams({},c,b),m)},queryListings:function(c){c=
P.formatQueryParams({},c,!0);var b="";c.q&&-1<c.q.toLowerCase().indexOf("mylistings:true")?(c.q=c.q.toLowerCase().replace("mylistings:true",""),b="?mylistings\x3dtrue"):c.q||(c.q='""');return this._queryPortal(this.portalUrl+"content/listings"+b,c,D)},queryCustomerList:function(c,b){var e=P.formatQueryParams({},c,!0);return this._queryPortal(this.portalUrl+"portals/self/customersList",e)},getProvisions:function(){return this.getCustomers().then(A.hitch(this,function(c){return c.purchases}))},getInterests:function(){return this.getCustomers().then(A.hitch(this,
function(c){return c.interests}))},getTrials:function(){return this.getCustomers().then(A.hitch(this,function(c){return c.trials}))},getCustomers:function(c){return P.request(this.portalUrl+"portals/self/customers",{status:c||"all"})},getMyPurchases:function(){return this.getPurchases().then(function(c){return c.purchases})},getMyInterests:function(){return this.getPurchases().then(function(c){return c.interests})},getPurchases:function(){return P.request(this.portalUrl+"portals/self/purchases").then(A.hitch(this,
function(c){c.interests=l.map(c.interests,function(b){return A.mixin(b.provision,{listing:b.listing})});c.purchases=l.map(c.purchases,function(b){return A.mixin(b.provision,{listing:b.listing})});c.trials=l.map(c.trials,function(b){return A.mixin(b.provision,{listing:b.listing})});c.interests=P.resultsToTypedArray(B,{portal:this},c.interests);c.trials=P.resultsToTypedArray(B,{portal:this},c.trials);c.purchases=P.resultsToTypedArray(B,{portal:this},c.purchases);return c}))},queryUsers:function(c,b){return this._queryPortal(this.portalUrl+
"community/users",P.formatQueryParams({sortField:"username"},c,b),R)},_onSignIn:function(){H.options.disableIdentityLookup=!1;H.self=null;return p.id.getCredential(this.portalUrl).then(A.hitch(this,"init",this.url)).then(function(){return H.loggedInUser},A.hitch(this,function(c){H.options.disableIdentityLookup=!0;this.onError(c);throw c;}))},_getSelf:function(c){c+="portals/self";if(H.self){var b=new g;setTimeout(function(){b.resolve(H.self)},0)}else b=P.request(c,{culture:z.locale,withCredentials:!0});
return b},_queryPortal:function(c,b,e){var f=A.mixin({num:10,start:0,sortField:"title",sortOrder:"asc"},b),u=["start","query","num","nextStart"];c=P.request(c,f).then(A.hitch(this,function(C){C.results=P.resultsToTypedArray(e,{portal:this},C);C.queryParams=A.mixin({},f);C.nextQueryParams=A.mixin(f,{start:C.nextStart});return P.clearFieldsFromObject(u,C)}));c=A.delegate(c);c.queryParams=A.mixin({},f);c.nextQueryParams=g.when(c,function(C){return C.nextQueryParams});return V(c)}}),PortalFolder:M,PortalGroup:K,
PortalItem:m,PortalUser:R,PortalComment:w,PortalRating:I,PortalUtil:P,PortalResult:V,PortalListing:D};A.mixin(A.getObject("arcgis",!0,p),G);return G})},"arcgisonline/tsutils/declareDecorator":function(){define(["require","exports","tslib","dojo/_base/declare"],function(G,A,z,g){Object.defineProperty(A,"__esModule",{value:!0});g=z.__importDefault(g);A["default"]=function(){for(var l=[],v=0;v<arguments.length;v++)l[v]=arguments[v];return function(t){return g["default"](l,t.prototype)}}})},"arcgisonline/pages/utils/queryHandler":function(){define(["require",
"exports"],function(G,A){Object.defineProperty(A,"__esModule",{value:!0});A.queryToObject=A.objectToQuery=void 0;A.objectToQuery=function(z){var g=new URLSearchParams,l=function(y,p){void 0!==p&&null!==p&&(Array.isArray(p)?0<p.length&&p.forEach(function(q){return g.append(y,q)}):g.append(y,String(p)))},v=0;for(z=Object.entries(z);v<z.length;v++){var t=z[v];l(t[0],t[1])}return g.toString()};A.queryToObject=function(z,g){var l=new URLSearchParams(z);l=Array.from(l.entries());if(g){for(var v={},t=0;t<
l.length;t++){var y=l[t],p=y[0];y=y[1];var q=v[p];Array.isArray(q)?q.push(y):v[p]="string"===typeof v[p]?[v[p],y]:y}return v}v={};for(t=0;t<l.length;t++)y=l[t],p=y[0],y=y[1],v[p]=v[p]?v[p]+(","+y):y;return v}})},"dijit/_base":function(){define("./main ./a11y ./WidgetSet ./_base/focus ./_base/manager ./_base/place ./_base/popup ./_base/scroll ./_base/sniff ./_base/typematic ./_base/wai ./_base/window".split(" "),function(G){return G._base})},"dijit/WidgetSet":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/_base/kernel","./registry"],function(G,A,z,g){var l=A("dijit.WidgetSet",null,{constructor:function(){this._hash={};this.length=0},add:function(v){if(this._hash[v.id])throw Error("Tried to register widget with id\x3d\x3d"+v.id+" but that id is already registered");this._hash[v.id]=v;this.length++},remove:function(v){this._hash[v]&&(delete this._hash[v],this.length--)},forEach:function(v,t){t=t||z.global;var y=0,p;for(p in this._hash)v.call(t,this._hash[p],y++,this._hash);
return this},filter:function(v,t){t=t||z.global;var y=new l,p=0,q;for(q in this._hash){var n=this._hash[q];v.call(t,n,p++,this._hash)&&y.add(n)}return y},byId:function(v){return this._hash[v]},byClass:function(v){var t=new l,y;for(y in this._hash){var p=this._hash[y];p.declaredClass==v&&t.add(p)}return t},toArray:function(){var v=[],t;for(t in this._hash)v.push(this._hash[t]);return v},map:function(v,t){return G.map(this.toArray(),v,t)},every:function(v,t){t=t||z.global;var y=0,p;for(p in this._hash)if(!v.call(t,
this._hash[p],y++,this._hash))return!1;return!0},some:function(v,t){t=t||z.global;var y=0,p;for(p in this._hash)if(v.call(t,this._hash[p],y++,this._hash))return!0;return!1}});G.forEach("forEach filter byClass map every some".split(" "),function(v){g[v]=l.prototype[v]});return l})},"dijit/_base/focus":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/topic dojo/_base/window ../focus ../selection ../main".split(" "),function(G,A,z,g,l,v,t,y){v.focus=function(p){if(p){var q="node"in p?
p.node:p,n=p.bookmark;p=p.openedForWindow;var F=n?n.isCollapsed:!1;if(q){var O="iframe"==q.tagName.toLowerCase()?q.contentWindow:q;if(O&&O.focus)try{O.focus()}catch(H){}v._onFocusNode(q)}if(n&&l.withGlobal(p||l.global,y.isCollapsed)&&!F){p&&p.focus();try{l.withGlobal(p||l.global,y.moveToBookmark,null,[n])}catch(H){}}}};v.watch("curNode",function(p,q,n){y._curFocus=n;y._prevFocus=q;n&&g.publish("focusNode",n)});v.watch("activeStack",function(p,q,n){y._activeStack=n});v.on("widget-blur",function(p,
q){g.publish("widgetBlur",p,q)});v.on("widget-focus",function(p,q){g.publish("widgetFocus",p,q)});z.mixin(y,{_curFocus:null,_prevFocus:null,isCollapsed:function(){return y.getBookmark().isCollapsed},getBookmark:function(){return(l.global==window?t:new t.SelectionManager(l.global)).getBookmark()},moveToBookmark:function(p){return(l.global==window?t:new t.SelectionManager(l.global)).moveToBookmark(p)},getFocus:function(p,q){var n=!v.curNode||p&&A.isDescendant(v.curNode,p.domNode)?y._prevFocus:v.curNode;
return{node:n,bookmark:n&&n==v.curNode&&l.withGlobal(q||l.global,y.getBookmark),openedForWindow:q}},_activeStack:[],registerIframe:function(p){return v.registerIframe(p)},unregisterIframe:function(p){p&&p.remove()},registerWin:function(p,q){return v.registerWin(p,q)},unregisterWin:function(p){p&&p.remove()}});return y})},"dijit/_base/place":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/window","../place","../main"],function(G,A,z,g,l){var v={getViewport:function(){return z.getBox()}};
v.placeOnScreen=g.at;v.placeOnScreenAroundElement=function(t,y,p,q){if(A.isArray(p))var n=p;else{n=[];for(var F in p)n.push({aroundCorner:F,corner:p[F]})}return g.around(t,y,n,!0,q)};v.placeOnScreenAroundNode=v.placeOnScreenAroundElement;v.placeOnScreenAroundRectangle=v.placeOnScreenAroundElement;v.getPopupAroundAlignment=function(t,y){var p={};G.forEach(t,function(q){var n=y;switch(q){case "after":p[y?"BR":"BL"]=y?"BL":"BR";break;case "before":p[y?"BL":"BR"]=y?"BR":"BL";break;case "below-alt":n=
!n;case "below":p[n?"BL":"BR"]=n?"TL":"TR";p[n?"BR":"BL"]=n?"TR":"TL";break;case "above-alt":n=!n;default:p[n?"TL":"TR"]=n?"BL":"BR",p[n?"TR":"TL"]=n?"BR":"BL"}});return p};A.mixin(l,v);return l})},"dijit/_base/popup":function(){define(["dojo/dom-class","dojo/_base/window","../popup","../BackgroundIframe"],function(G,A,z){var g=z._createWrapper;z._createWrapper=function(v){v.declaredClass||(v={_popupWrapper:v.parentNode&&G.contains(v.parentNode,"dijitPopup")?v.parentNode:null,domNode:v,destroy:function(){},
ownerDocument:v.ownerDocument,ownerDocumentBody:A.body(v.ownerDocument)});return g.call(this,v)};var l=z.open;z.open=function(v){if(v.orient&&"string"!=typeof v.orient&&!("length"in v.orient)){var t=[],y;for(y in v.orient)t.push({aroundCorner:y,corner:v.orient[y]});v.orient=t}return l.call(this,v)};return z})},"dijit/_base/scroll":function(){define(["dojo/window","../main"],function(G,A){A.scrollIntoView=function(z,g){G.scrollIntoView(z,g)}})},"dijit/_base/sniff":function(){define(["dojo/uacss"],
function(){})},"dijit/_base/typematic":function(){define(["../typematic"],function(){})},"dijit/_base/wai":function(){define(["dojo/dom-attr","dojo/_base/lang","../main","../hccss"],function(G,A,z){A.mixin(z,{hasWaiRole:function(g,l){var v=this.getWaiRole(g);return l?-1<v.indexOf(l):0<v.length},getWaiRole:function(g){return A.trim((G.get(g,"role")||"").replace("wairole:",""))},setWaiRole:function(g,l){G.set(g,"role",l)},removeWaiRole:function(g,l){var v=G.get(g,"role");v&&(l?(v=A.trim((" "+v+" ").replace(" "+
l+" "," ")),G.set(g,"role",v)):g.removeAttribute("role"))},hasWaiState:function(g,l){return g.hasAttribute?g.hasAttribute("aria-"+l):!!g.getAttribute("aria-"+l)},getWaiState:function(g,l){return g.getAttribute("aria-"+l)||""},setWaiState:function(g,l,v){g.setAttribute("aria-"+l,v)},removeWaiState:function(g,l){g.removeAttribute("aria-"+l)}});return z})},"dijit/_base/window":function(){define(["dojo/window","../main"],function(G,A){A.getDocumentWindow=function(z){return G.get(z)}})},"dijit/TooltipDialog":function(){define("dojo/_base/declare dojo/dom-class dojo/has dojo/keys dojo/_base/lang dojo/on ./focus ./layout/ContentPane ./_DialogMixin ./form/_FormMixin ./_TemplatedMixin dojo/text!./templates/TooltipDialog.html ./main".split(" "),
function(G,A,z,g,l,v,t,y,p,q,n,F,O){G=G("dijit.TooltipDialog",[y,n,q,p],{title:"",doLayout:!1,autofocus:!0,baseClass:"dijitTooltipDialog",_firstFocusItem:null,_lastFocusItem:null,templateString:F,_setTitleAttr:"containerNode",postCreate:function(){this.inherited(arguments);this.own(v(this.domNode,"keydown",l.hitch(this,"_onKey")))},orient:function(H,V,P){H={"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft",
"TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft","BR-TL":"dijitTooltipBelow dijitTooltipABLeft","BL-TR":"dijitTooltipBelow dijitTooltipABRight","TL-BR":"dijitTooltipAbove dijitTooltipABRight","TR-BL":"dijitTooltipAbove dijitTooltipABLeft"}[V+"-"+P];A.replace(this.domNode,H,this._currentOrientClass||"");this._currentOrientClass=H},focus:function(){this._getFocusItems();
t.focus(this._firstFocusItem)},onOpen:function(H){this.orient(this.domNode,H.aroundCorner,H.corner);var V=H.aroundNodePos;"M"==H.corner.charAt(0)&&"M"==H.aroundCorner.charAt(0)?(this.connectorNode.style.top=V.y+(V.h-this.connectorNode.offsetHeight>>1)-H.y+"px",this.connectorNode.style.left=""):"M"==H.corner.charAt(1)&&"M"==H.aroundCorner.charAt(1)&&(this.connectorNode.style.left=V.x+(V.w-this.connectorNode.offsetWidth>>1)-H.x+"px");this._onShow()},onClose:function(){this.onHide()},_onKey:function(H){if(H.keyCode==
g.ESCAPE)this.defer("onCancel"),H.stopPropagation(),H.preventDefault();else if(H.keyCode==g.TAB){var V=H.target;this._getFocusItems();this._firstFocusItem==this._lastFocusItem?(H.stopPropagation(),H.preventDefault()):V==this._firstFocusItem&&H.shiftKey?(t.focus(this._lastFocusItem),H.stopPropagation(),H.preventDefault()):V!=this._lastFocusItem||H.shiftKey?H.stopPropagation():(t.focus(this._firstFocusItem),H.stopPropagation(),H.preventDefault())}}});z("dojo-bidi")&&G.extend({_setTitleAttr:function(H){this.containerNode.title=
this.textDir&&this.enforceTextDirWithUcc?this.enforceTextDirWithUcc(null,H):H;this._set("title",H)},_setTextDirAttr:function(H){this._created&&this.textDir==H||(this._set("textDir",H),this.textDir&&this.title&&(this.containerNode.title=this.enforceTextDirWithUcc(null,this.title)))}});return G})},"dijit/form/ComboButton":function(){define("dojo/_base/declare dojo/keys ../focus ./DropDownButton dojo/text!./templates/ComboButton.html ../a11yclick".split(" "),function(G,A,z,g,l){return G("dijit.form.ComboButton",
g,{templateString:l,_setIdAttr:"",_setTabIndexAttr:["focusNode","titleNode"],_setTitleAttr:"titleNode",optionsTitle:"",baseClass:"dijitComboButton",cssStateNodes:{buttonNode:"dijitButtonNode",titleNode:"dijitButtonContents",_popupStateNode:"dijitDownArrowButton"},_focusedNode:null,_onButtonKeyDown:function(v){v.keyCode==A[this.isLeftToRight()?"RIGHT_ARROW":"LEFT_ARROW"]&&(z.focus(this._popupStateNode),v.stopPropagation(),v.preventDefault())},_onArrowKeyDown:function(v){v.keyCode==A[this.isLeftToRight()?
"LEFT_ARROW":"RIGHT_ARROW"]&&(z.focus(this.titleNode),v.stopPropagation(),v.preventDefault())},focus:function(v){this.disabled||z.focus("start"==v?this.titleNode:this._popupStateNode)}})})},"url:dijit/templates/Dialog.html":'\x3cdiv class\x3d"dijitDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title"\r\n\t\t\t\trole\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"-1"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\x3c/div\x3e\r\n\t${!actionBarTemplate}\r\n\x3c/div\x3e\r\n\r\n',
"url:esri/core/request/iframe.html":'\x3c!DOCTYPE html\x3e\r\n\x3chtml\x3e\r\n\x3chead\x3e\r\n  \x3cmeta http-equiv\x3d"Content-Security-Policy" content\x3d"default-src \'none\'; script-src * \'unsafe-inline\'"\x3e\r\n\r\n  \x3cscript\x3e\r\n    var dojoConfig \x3d {\r\n      async: true,\r\n      baseUrl: "../../../dojo/",\r\n      has: {\r\n        "csp-restrictions": true,\r\n        "dojo-preload-i18n-Api": false\r\n      }\r\n    };\r\n  \x3c/script\x3e\r\n  \x3c!--\r\n  This src is relative to this page and assumes dojo is a sibling to esri.\r\n  It is updated when this file is set as the iframe\'s `srcdoc` value.\r\n  --\x3e\r\n  \x3cscript src\x3d"../../../dojo/dojo.js"\x3e\x3c/script\x3e\r\n\r\n  \x3cscript\x3e\r\n    function windowMessageHandler(event) {\r\n      window.removeEventListener("message", windowMessageHandler);\r\n\r\n      var port \x3d event.ports[0];\r\n\r\n      require([\r\n        "dojo/request/script"\r\n      ], function(script) {\r\n        port.postMessage("ready");\r\n\r\n        port.addEventListener("message", function(event) {\r\n          var data \x3d event.data;\r\n          script.get(data.url, data.options)\r\n              .then(function(response) {\r\n                port.postMessage({\r\n                  id: data.id,\r\n                  response: response\r\n                });\r\n              })\r\n              .otherwise(function(error) {\r\n                port.postMessage({\r\n                  id: data.id,\r\n                  isError: true,\r\n                  message: error.message\r\n                });\r\n              });\r\n        });\r\n        port.start();\r\n      });\r\n    }\r\n\r\n    window.addEventListener("message", windowMessageHandler);\r\n  \x3c/script\x3e\r\n\x3c/head\x3e\r\n\x3cbody\x3e\r\n\x3c/body\x3e\r\n\x3c/html\x3e\r\n',
"url:arcgisonline/sharing/dijit/templates/AccountLinker.html":'\x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\r\n  \x3cdiv id\x3d"account-switcher-wrapper" data-dojo-attach-point\x3d"accountSwitcherWrapper" class\x3d"wrapper is-loading"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"topNotificationPanel" role\x3d"alert" tabindex\x3d"-1" class\x3d"top-notification-panel link-notification not-visible"\x3e\r\n      \x3cspan class\x3d"icon-ui-close close-link-notification" data-dojo-attach-point\x3d"closePushNotification"\x3e\x3c/span\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"topNotificationPanelText" class\x3d"top-notification-panel-text"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"panel-white" id\x3d"link-account-panel"\x3e\r\n      \x3ca href\x3d"#" data-dojo-attach-point\x3d"closeAccountSwitcher" title\x3d"${i18n.closeAccountSwitcher}" class\x3d"close-link-account-switcher hide-while-loading"\x3e\x3cspan class\x3d"icon-ui-close"\x3e\x3c/span\x3e\x3c/a\x3e\r\n      \x3ch4 data-dojo-attach-point\x3d"windowTitle" class\x3d"avenir-regular account-switcher-title"\x3e\x3c/h4\x3e\r\n      \x3c!-- Sign out page header --\x3e\r\n      \x3cdiv class\x3d"ease-in-out-900 hide" data-dojo-attach-point\x3d"signOutHeader"\x3e\r\n        \x3ch4 class\x3d"avenir-regular font-size-5 account-switcher-title"\x3e${i18n.signedOut}\x3c/h4\x3e\r\n        \x3cp class\x3d"font-size-0" data-dojo-attach-point\x3d"signOutHeaderText"\x3e\x3c/p\x3e\r\n        \x3ca class\x3d"font-size-0 saml-signin-link hide"\x3e${i18n.signIn}\x3c/a\x3e\r\n        \x3chr\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"current-account-row" data-dojo-attach-point\x3d"currentAccountLi"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"loader padding-leader-3 padding-trailer-3"\x3e\r\n        \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"topTutorialPanel" class\x3d"font-size--2 top-tutorial-panel"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"accountsContainer" id\x3d"accounts-container"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"accountListContainer" id\x3d"account-list-container" class\x3d"tall-max-height"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"accountRequestLoader" class\x3d"loader padding-leader-3 padding-trailer-3 account-request-loader hide"\x3e\r\n            \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"overflow-wrapper"\x3e\r\n            \x3cul data-dojo-attach-point\x3d"accountsUlElement" class\x3d"switch-accounts-ul"\x3e\x3c/ul\x3e\r\n          \x3c/div\x3e\r\n          \x3cul data-dojo-attach-point\x3d"unlinkAccountsUlElement" class\x3d"unlink-account-ul hide"\x3e\x3c/ul\x3e\r\n          \x3cp class\x3d"account-loading-text hide" data-dojo-attach-point\x3d"accountLoadingText"\x3e${i18n.loadingMoreAccounts}\x3c/p\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n        \x3c!-- Link Accounts and Unlink Accounts --\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d\'defaultInterfaceBtns\'\x3e\r\n          \x3ca href\x3d"#" data-dojo-attach-point\x3d"linkAccountsBtn" class\x3d"link-accounts-btn btn btn-fill btn-clear"\x3e\x3cspan class\x3d"icon-ui-plus"\x3e\x3c/span\x3e${i18n.linkAnAccount}\x3c/a\x3e\r\n          \x3ca class\x3d"unlink-accounts-btn btn btn-small btn-fill btn-transparent hide" tabindex\x3d"0" data-dojo-attach-point\x3d"unlinkAccountsBtn"\x3e${i18n.unlinkAnAccount}\x3c/a\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Sign Out and Cancel Sign Out --\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d\'signoutInterfaceBtns\' class\x3d"hide"\x3e\r\n          \x3ca href\x3d"#" data-dojo-attach-point\x3d"signoutOfAllAccountsBtn" class\x3d"link-accounts-btn btn btn-clear btn-fill hide padding-trailer-half"\x3e\r\n            \x3cp class\x3d"font-size-1 avenir-medium trailer-half"\x3e${i18n.signOutOfAllAccounts}\x3c/p\x3e\r\n            \x3cspan class\x3d"font-size--1"\x3e${i18n.closeBrowserWindow}\x3c/span\x3e\r\n          \x3c/a\x3e\r\n          \x3ca class\x3d"unlink-accounts-btn btn btn-small btn-fill btn-transparent margin-top-zero" tabindex\x3d"0" data-dojo-attach-point\x3d"cancelSignoutBtn"\x3e${i18n.close}\x3c/a\x3e\r\n        \x3c/div\x3e\r\n      \x3c!-- Unlink Account Buttons --\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"unlinkAccountsBlockGroup" class\x3d"display-flex-box hide"\x3e\r\n        \x3ca data-dojo-attach-point\x3d"unlinkAccountBtn" class\x3d"btn btn-disabled btn-half" tabindex\x3d"-1"\x3e${i18n.unlinkAccount}\x3c/a\x3e\r\n        \x3ca data-dojo-attach-point\x3d"cancelUnlinkAccountsBtn" class\x3d"btn btn-clear btn-half" tabindex\x3d"-1"\x3e${i18n.cancel}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- Signout Checkbox --\x3e\r\n      \x3clabel data-dojo-attach-point\x3d"signoutCheckboxWrapper" class\x3d"signout-checkbox-wrapper ease-in-out-900 hide"\x3e\r\n        \x3cinput data-dojo-attach-point\x3d"signoutCheckbox" class\x3d"signout-checkbox" type\x3d"checkbox" checked\x3e${i18n.staySignedInToCurrentAccount}\r\n      \x3c/label\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!-- Complete Signout Message --\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"completeSignoutMessage" class\x3d"text-center padding-leader-3 hide padding-trailer-3 completed-checkmark"\x3e\r\n    \x3cdiv class\x3d"icon-ui-check-mark icon-ui-green font-size-7 completed-checkmark-icon"\x3e\x3c/div\x3e\r\n    \x3ch4 class\x3d"avenir-demi"\x3e${i18n.success}\x3c/h4\x3e\r\n    \x3cdiv\x3e\r\n      ${i18n.youAreNowSignedOut}\r\n    \x3c/div\x3e\r\n    \x3cbr\x3e\r\n    \x3ca class\x3d"font-size-0 saml-signin-link hide"\x3e${i18n.signIn}\x3c/a\x3e\r\n  \x3cdiv\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/TooltipDialog.html":'\x3cdiv role\x3d"alertdialog" tabIndex\x3d"-1"\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"contentsNode" class\x3d"dijitTooltipContents dijitTooltipFocusNode"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\t\t\t${!actionBarTemplate}\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipConnector" role\x3d"presentation" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/form/templates/ComboButton.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tcellspacing\x3d\'0\' cellpadding\x3d\'0\' role\x3d"presentation"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonNode" data-dojo-attach-point\x3d"buttonNode" data-dojo-attach-event\x3d"ondijitclick:__onClick,onkeydown:_onButtonKeyDown"\r\n\t\t\x3e\x3cdiv id\x3d"${id}_button" class\x3d"dijitReset dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInline dijitButtonText" id\x3d"${id}_label" data-dojo-attach-point\x3d"containerNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd id\x3d"${id}_arrow" class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton\'\r\n\t\t\tdata-dojo-attach-point\x3d"_popupStateNode,focusNode,_buttonNode"\r\n\t\t\tdata-dojo-attach-event\x3d"onkeydown:_onArrowKeyDown"\r\n\t\t\ttitle\x3d"${optionsTitle}"\r\n\t\t\trole\x3d"button" aria-haspopup\x3d"true"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitArrowButtonInner" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitArrowButtonChar" role\x3d"presentation"\x3e\x26#9660;\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd style\x3d"display:none !important;"\r\n\t\t\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" data-dojo-attach-point\x3d"valueNode"\r\n\t\t\t\tclass\x3d"dijitOffScreen" aria-hidden\x3d"true" data-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\t/\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
"*now":function(G){G(['dojo/i18n!*preload*arcgisonline/nls/accountLinker*["ar","bg","bs","ca","cs","da","de","de-ch","el","en-au","en-ca","en-gb","en-us","es","es-mx","et","fi","fr","fr-ch","he","hr","hu","id","it","it-ch","ja","ko","lt","lv","nl","nb","pl","pt","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});define("arcgisonline/accountLinker",["require","exports","./sharing/dijit/AccountLinker_"],function(G,A){return{}});