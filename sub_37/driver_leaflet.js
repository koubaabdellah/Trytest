(function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define("build/map/js/driver_leaflet",[],o):"object"==typeof exports?exports["build/map/js/driver_leaflet"]=o():e["build/map/js/driver_leaflet"]=o()}(this,function(){
var __EXPORTS__=(()=>{var C=Object.defineProperty,_t=Object.defineProperties,Mt=Object.getOwnPropertyDescriptor,Bt=Object.getOwnPropertyDescriptors,Rt=Object.getOwnPropertyNames,Pe=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,Nt=Object.prototype.propertyIsEnumerable;var ke=(t,e,r)=>e in t?C(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,w=(t,e)=>{for(var r in e||(e={}))Oe.call(e,r)&&ke(t,r,e[r]);if(Pe)for(var r of Pe(e))Nt.call(e,r)&&ke(t,r,e[r]);return t},_=(t,e)=>_t(t,Bt(e));var Wt=(t,e)=>{for(var r in e)C(t,r,{get:e[r],enumerable:!0})},Dt=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Rt(e))!Oe.call(t,s)&&s!==r&&C(t,s,{get:()=>e[s],enumerable:!(o=Mt(e,s))||o.enumerable});return t};var Ft=t=>Dt(C({},"__esModule",{value:!0}),t);var x=(t,e,r)=>new Promise((o,s)=>{var f=p=>{try{n(r.next(p))}catch(d){s(d)}},i=p=>{try{n(r.throw(p))}catch(d){s(d)}},n=p=>p.done?o(p.value):Promise.resolve(p.value).then(f,i);n((r=r.apply(t,e)).next())});var $a={};Wt($a,{default:()=>Ua});var a={};var Ut=typeof a=="object"&&a&&a.Object===Object&&a,M=Ut;var $t=typeof self=="object"&&self&&self.Object===Object&&self,Gt=M||$t||Function("return this")(),P=Gt;var Zt=P.Symbol,h=Zt;var ze=Object.prototype,Kt=ze.hasOwnProperty,Vt=ze.toString,T=h?h.toStringTag:void 0;function Ht(t){var e=Kt.call(t,T),r=t[T];try{t[T]=void 0;var o=!0}catch(f){}var s=Vt.call(t);return o&&(e?t[T]=r:delete t[T]),s}var Ie=Ht;var Jt=Object.prototype,Xt=Jt.toString;function Yt(t){return Xt.call(t)}var Se=Yt;var Qt="[object Null]",er="[object Undefined]",Te=h?h.toStringTag:void 0;function tr(t){return t==null?t===void 0?er:Qt:Te&&Te in Object(t)?Ie(t):Se(t)}var u=tr;function rr(t){return t!=null&&typeof t=="object"}var c=rr;var or="[object Symbol]";function ar(t){return typeof t=="symbol"||c(t)&&u(t)==or}var Ee=ar;function sr(t,e){for(var r=-1,o=t==null?0:t.length,s=Array(o);++r<o;)s[r]=e(t[r],r,t);return s}var B=sr;var nr=Array.isArray,R=nr;var fr=1/0,je=h?h.prototype:void 0,Le=je?je.toString:void 0;function Ae(t){if(typeof t=="string")return t;if(R(t))return B(t,Ae)+"";if(Ee(t))return Le?Le.call(t):"";var e=t+"";return e=="0"&&1/t==-fr?"-0":e}var Ce=Ae;function ir(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var g=ir;function lr(t){return t}var N=lr;var pr="[object AsyncFunction]",mr="[object Function]",dr="[object GeneratorFunction]",ur="[object Proxy]";function cr(t){if(!g(t))return!1;var e=u(t);return e==mr||e==dr||e==pr||e==ur}var W=cr;var xr=P["__core-js_shared__"],D=xr;var _e=function(){var t=/[^.]+$/.exec(D&&D.keys&&D.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function hr(t){return!!_e&&_e in t}var Me=hr;var gr=Function.prototype,yr=gr.toString;function br(t){if(t!=null){try{return yr.call(t)}catch(e){}try{return t+""}catch(e){}}return""}var Be=br;var vr=/[\\^$.*+?()[\]{}|]/g,wr=/^\[object .+?Constructor\]$/,Pr=Function.prototype,kr=Object.prototype,Or=Pr.toString,zr=kr.hasOwnProperty,Ir=RegExp("^"+Or.call(zr).replace(vr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Sr(t){if(!g(t)||Me(t))return!1;var e=W(t)?Ir:wr;return e.test(Be(t))}var Re=Sr;function Tr(t,e){return t==null?void 0:t[e]}var Ne=Tr;function Er(t,e){var r=Ne(t,e);return Re(r)?r:void 0}var We=Er;function jr(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var F=jr;var Lr=800,Ar=16,Cr=Date.now;function _r(t){var e=0,r=0;return function(){var o=Cr(),s=Ar-(o-r);if(r=o,s>0){if(++e>=Lr)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var De=_r;function Mr(t){return function(){return t}}var Fe=Mr;var Br=function(){try{var t=We(Object,"defineProperty");return t({},"",{}),t}catch(e){}}(),k=Br;var Rr=k?function(t,e){return k(t,"toString",{configurable:!0,enumerable:!1,value:Fe(e),writable:!0})}:N,qe=Rr;var Nr=De(qe),Ue=Nr;var Wr=9007199254740991,Dr=/^(?:0|[1-9]\d*)$/;function Fr(t,e){var r=typeof t;return e=e==null?Wr:e,!!e&&(r=="number"||r!="symbol"&&Dr.test(t))&&t>-1&&t%1==0&&t<e}var q=Fr;function qr(t,e,r){e=="__proto__"&&k?k(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var U=qr;function Ur(t,e){return t===e||t!==t&&e!==e}var O=Ur;var $r=Object.prototype,Gr=$r.hasOwnProperty;function Zr(t,e,r){var o=t[e];(!(Gr.call(t,e)&&O(o,r))||r===void 0&&!(e in t))&&U(t,e,r)}var $e=Zr;function Kr(t,e,r,o){var s=!r;r||(r={});for(var f=-1,i=e.length;++f<i;){var n=e[f],p=o?o(r[n],t[n],n,r,t):void 0;p===void 0&&(p=t[n]),s?U(r,n,p):$e(r,n,p)}return r}var Ge=Kr;var Ze=Math.max;function Vr(t,e,r){return e=Ze(e===void 0?t.length-1:e,0),function(){for(var o=arguments,s=-1,f=Ze(o.length-e,0),i=Array(f);++s<f;)i[s]=o[e+s];s=-1;for(var n=Array(e+1);++s<e;)n[s]=o[s];return n[e]=r(i),F(t,this,n)}}var Ke=Vr;function Hr(t,e){return Ue(Ke(t,e,N),t+"")}var $=Hr;var Jr=9007199254740991;function Xr(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Jr}var G=Xr;function Yr(t){return t!=null&&G(t.length)&&!W(t)}var z=Yr;function Qr(t,e,r){if(!g(r))return!1;var o=typeof e;return(o=="number"?z(r)&&q(e,r.length):o=="string"&&e in r)?O(r[e],t):!1}var Z=Qr;function eo(t){return $(function(e,r){var o=-1,s=r.length,f=s>1?r[s-1]:void 0,i=s>2?r[2]:void 0;for(f=t.length>3&&typeof f=="function"?(s--,f):void 0,i&&Z(r[0],r[1],i)&&(f=s<3?void 0:f,s=1),e=Object(e);++o<s;){var n=r[o];n&&t(e,n,o,f)}return e})}var Ve=eo;var to=Object.prototype;function ro(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||to;return t===r}var K=ro;function oo(t,e){for(var r=-1,o=Array(t);++r<t;)o[r]=e(r);return o}var He=oo;var ao="[object Arguments]";function so(t){return c(t)&&u(t)==ao}var ae=so;var Je=Object.prototype,no=Je.hasOwnProperty,fo=Je.propertyIsEnumerable,io=ae(function(){return arguments}())?ae:function(t){return c(t)&&no.call(t,"callee")&&!fo.call(t,"callee")},Xe=io;function lo(){return!1}var Ye=lo;var tt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Qe=tt&&typeof module=="object"&&module&&!module.nodeType&&module,po=Qe&&Qe.exports===tt,et=po?P.Buffer:void 0,mo=et?et.isBuffer:void 0,uo=mo||Ye,rt=uo;var co="[object Arguments]",xo="[object Array]",ho="[object Boolean]",go="[object Date]",yo="[object Error]",bo="[object Function]",vo="[object Map]",wo="[object Number]",Po="[object Object]",ko="[object RegExp]",Oo="[object Set]",zo="[object String]",Io="[object WeakMap]",So="[object ArrayBuffer]",To="[object DataView]",Eo="[object Float32Array]",jo="[object Float64Array]",Lo="[object Int8Array]",Ao="[object Int16Array]",Co="[object Int32Array]",_o="[object Uint8Array]",Mo="[object Uint8ClampedArray]",Bo="[object Uint16Array]",Ro="[object Uint32Array]",l={};l[Eo]=l[jo]=l[Lo]=l[Ao]=l[Co]=l[_o]=l[Mo]=l[Bo]=l[Ro]=!0;l[co]=l[xo]=l[So]=l[ho]=l[To]=l[go]=l[yo]=l[bo]=l[vo]=l[wo]=l[Po]=l[ko]=l[Oo]=l[zo]=l[Io]=!1;function No(t){return c(t)&&G(t.length)&&!!l[u(t)]}var ot=No;function Wo(t){return function(e){return t(e)}}var at=Wo;var st=typeof exports=="object"&&exports&&!exports.nodeType&&exports,E=st&&typeof module=="object"&&module&&!module.nodeType&&module,Do=E&&E.exports===st,se=Do&&M.process,Fo=function(){try{var t=E&&E.require&&E.require("util").types;return t||se&&se.binding&&se.binding("util")}catch(e){}}(),ne=Fo;var nt=ne&&ne.isTypedArray,qo=nt?at(nt):ot,ft=qo;var Uo=Object.prototype,$o=Uo.hasOwnProperty;function Go(t,e){var r=R(t),o=!r&&Xe(t),s=!r&&!o&&rt(t),f=!r&&!o&&!s&&ft(t),i=r||o||s||f,n=i?He(t.length,String):[],p=n.length;for(var d in t)(e||$o.call(t,d))&&!(i&&(d=="length"||s&&(d=="offset"||d=="parent")||f&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||q(d,p)))&&n.push(d);return n}var V=Go;function Zo(t,e){return function(r){return t(e(r))}}var H=Zo;var Ko=H(Object.keys,Object),it=Ko;var Vo=Object.prototype,Ho=Vo.hasOwnProperty;function Jo(t){if(!K(t))return it(t);var e=[];for(var r in Object(t))Ho.call(t,r)&&r!="constructor"&&e.push(r);return e}var lt=Jo;function Xo(t){return z(t)?V(t):lt(t)}var pt=Xo;function Yo(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var mt=Yo;var Qo=Object.prototype,ea=Qo.hasOwnProperty;function ta(t){if(!g(t))return mt(t);var e=K(t),r=[];for(var o in t)o=="constructor"&&(e||!ea.call(t,o))||r.push(o);return r}var dt=ta;function ra(t){return z(t)?V(t,!0):dt(t)}var ut=ra;var oa=Ve(function(t,e,r,o){Ge(e,ut(e),t,o)}),fe=oa;function aa(t){return t==null?"":Ce(t)}var I=aa;var sa=H(Object.getPrototypeOf,Object),ct=sa;var na="[object Object]",fa=Function.prototype,ia=Object.prototype,xt=fa.toString,la=ia.hasOwnProperty,pa=xt.call(Object);function ma(t){if(!c(t)||u(t)!=na)return!1;var e=ct(t);if(e===null)return!0;var r=la.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&xt.call(r)==pa}var ht=ma;var da="[object DOMException]",ua="[object Error]";function ca(t){if(!c(t))return!1;var e=u(t);return e==ua||e==da||typeof t.message=="string"&&typeof t.name=="string"&&!ht(t)}var J=ca;var xa=$(function(t,e){try{return F(t,void 0,e)}catch(r){return J(r)?r:new Error(r)}}),gt=xa;function ha(t){return function(e){return t==null?void 0:t[e]}}var yt=ha;var ga={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ya=yt(ga),bt=ya;var vt=/[&<>"']/g,ba=RegExp(vt.source);function va(t){return t=I(t),t&&ba.test(t)?t.replace(vt,bt):t}var wt=va;function wa(t,e){return B(e,function(r){return t[r]})}var Pt=wa;var kt=Object.prototype,Pa=kt.hasOwnProperty;function ka(t,e,r,o){return t===void 0||O(t,kt[r])&&!Pa.call(o,r)?e:t}var ie=ka;var Oa={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function za(t){return"\\"+Oa[t]}var Ot=za;var Ia=/<%=([\s\S]+?)%>/g,X=Ia;var Sa=/<%-([\s\S]+?)%>/g,zt=Sa;var Ta=/<%([\s\S]+?)%>/g,It=Ta;var Ea={escape:zt,evaluate:It,interpolate:X,variable:"",imports:{_:{escape:wt}}},le=Ea;var ja="Invalid `variable` option passed into `_.template`",La=/\b__p \+= '';/g,Aa=/\b(__p \+=) '' \+/g,Ca=/(__e\(.*?\)|\b__t\)) \+\n'';/g,_a=/[()=,{}\[\]\/\s]/,Ma=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Y=/($^)/,Ba=/['\n\r\u2028\u2029\\]/g,Ra=Object.prototype,St=Ra.hasOwnProperty;function Na(t,e,r){var o=le.imports._.templateSettings||le;r&&Z(t,e,r)&&(e=void 0),t=I(t),e=fe({},e,o,ie);var s=fe({},e.imports,o.imports,ie),f=pt(s),i=Pt(s,f),n,p,d=0,v=e.interpolate||Y,m="__p += '",re=RegExp((e.escape||Y).source+"|"+v.source+"|"+(v===X?Ma:Y).source+"|"+(e.evaluate||Y).source+"|$","g"),oe=St.call(e,"sourceURL")?"//# sourceURL="+(e.sourceURL+"").replace(/\s/g," ")+`
`:"";t.replace(re,function(ye,be,A,Ct,ve,we){return A||(A=Ct),m+=t.slice(d,we).replace(Ba,Ot),be&&(n=!0,m+=`' +
__e(`+be+`) +
'`),ve&&(p=!0,m+=`';
`+ve+`;
__p += '`),A&&(m+=`' +
((__t = (`+A+`)) == null ? '' : __t) +
'`),d=we+ye.length,ye}),m+=`';
`;var S=St.call(e,"variable")&&e.variable;if(!S)m=`with (obj) {
`+m+`
}
`;else if(_a.test(S))throw new Error(ja);m=(p?m.replace(La,""):m).replace(Aa,"$1").replace(Ca,"$1;"),m="function("+(S||"obj")+`) {
`+(S?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(n?", __e = _.escape":"")+(p?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+m+`return __p
}`;var L=gt(function(){return Function(f,oe+"return "+m).apply(void 0,i)});if(L.source=m,J(L))throw L;return L}var j=Na;var Wa=0;function Da(t){var e=++Wa;return I(t)+e}var pe=Da;var me=class{constructor(e={}){this.options=w({id:pe("z-placemark_"),sid:"",name:"",type:"",lonlat:[],premium:!1,active:!1,visible:!0,info:!1,extra:{},preset:"z#marker"},e),this.marker=null}set(e,r){this.options[e]=r}get(e){return this.options[e]}getId(){return this.get("id")}getSid(){return`${this.get("id")}.${this.get("sid")}`}getLatLng(){let[e,r]=this.get("lonlat");return[r,e]}getData(){let e=this.get("type"),{rating:r,no_rating:o,reviews:s="",count_text:f="",workhours:i="",price:n="",service:p="",cost:d="",cpa:v}=this.get("extra"),m=[],re=i.indexOf("\u041E\u0442\u043A\u0440\u043E\u0435\u0442\u0441\u044F")>=0||i.indexOf("\u0417\u0430\u043A\u0440\u044B\u0442\u043E")>=0,oe=(()=>{if(!Object.keys(this.get("extra")).length)return"";if(p&&d)return`${p} ${d}`;switch(e){case"medical":return`${s} ${f}`;case"shops":return i;case"restaurants":return n;default:return""}})();return v&&m.push("_cpa"),this.isVisited()&&m.push("_visited"),m.push(re?"_closed":"_opened"),{name:new DOMParser().parseFromString(this.get("name"),"text/html").body.innerText,rating:Number(r)?String(r).replace(".",","):o,content:oe,classList:m.join(" "),shape:""}}setVisited(){let e=JSON.parse(sessionStorage.getItem("visited"))||{};e[this.get("id")]=!0,this.toggleClass("_visited",!0),sessionStorage.setItem("visited",JSON.stringify(e))}isVisited(){let e=JSON.parse(sessionStorage.getItem("visited"))||{};return Boolean(e[this.get("id")])}on(e,r){throw Error("add events method undefined")}fire(e){throw Error("trigger event method undefined")}setPreset(e){throw Error("set preset method undefined")}setZIndex(e){throw Error("set zIndex method undefined")}getNode(){return x(this,null,function*(){throw Error("get node method undefined")})}toggleClass(e,r){return x(this,null,function*(){(yield this.getNode()).classList.toggle(e,r)})}setVisible(e){this.set("visible",e),this.toggleClass("_hide",!e)}setActive(e){this.set("active",e),this.toggleClass("_active",e)}showInfo(e){let r=this.get("preset")==="z#normal"?100:101;this.toggleClass("_info",e),this.set("info",e),this.setZIndex(e?150:r)}createBalloon(){throw Error("create balloon method undefined")}getBalloon(){throw Error("get balloon method undefined")}setBalloonContent(e){this.set("balloonContent",e)}openBalloon(){throw Error("open balloon method undefined")}closeBalloon(){throw Error("close balloon method undefined")}getBalloonNode(){return x(this,null,function*(){throw Error("get balloon node method undefined")})}},Q=me;var de=class{on(e,r){throw Error("add events method undefined")}setPreset(e){throw Error("set preset method undefined")}add(e){throw Error("create method undefined")}remove(e){throw Error("remove method undefined")}removeAll(){throw Error("removeAll method undefined")}},ee=de;var Tt=`<div class="z-map-marker-info">
						<div class="z-map-marker-info-title"><%= name %></div>
						<div class="z-map-marker-info-extra">
							<svg class="z-map-marker-info-rating-star" width="12" height="12"><use xlink:href='/build/map/icons.svg#star'></use></svg>
							<span class="z-map-marker-info-rating"><%= rating %></span>
							<span class="z-map-marker-info-content"><%= content %></span>
						</div>
					</div>`,Fa=[{name:"z#marker",html:'<div class="z-map-marker"><svg class="z-map-marker-icon" width="32" height="32"><use xlink:href="/build/map/icons.svg#default"></use></svg></div>',href:"",shape:{type:"Circle",coordinates:[16,16],radius:16},size:[32,32],offset:[-16,-16],zIndex:100,zIndexActive:200},{name:"z#cluster",html:'<div class="z-map-marker z-map-marker--cluster"><svg class="z-map-marker-icon" width="32" height="32"><use xlink:href="/build/map/icons.svg#default"></use></svg><div class="z-map-marker-cluster-count"><%= count %></div></div>',href:"",shape:{type:"Circle",coordinates:[16,16],radius:16},size:[32,32],offset:[-16,-16],zIndex:100,zIndexActive:200},{name:"z#dot",html:'<div class="z-map-marker"><svg class="z-map-marker-icon" width="12" height="12"><use xlink:href="/build/map/icons.svg#dot"></use></svg></div>',href:"",shape:{type:"Circle",coordinates:[6,6],radius:6},size:[12,12],offset:[-6,-6],zIndex:100,zIndexActive:200},{name:"z#dot-medium",html:'<div class="z-map-marker"><svg class="z-map-marker-icon" width="16" height="16"><use xlink:href="/build/map/icons.svg#dot-medium"></use></svg></div>',href:"",shape:{type:"Circle",coordinates:[8,8],radius:8},size:[16,16],offset:[-8,-8],zIndex:100,zIndexActive:200},{name:"z#normal",html:`<div class="z-map-marker z-map-marker--normal z-map-marker <%- classList %>" data-shape="<%- shape %>">
					<svg class="z-map-marker-icon" width="12" height="12"><use xlink:href="/build/map/icons.svg#dot"></use></svg>
					<svg class="z-map-marker-icon z-map-marker-icon--active" width="16" height="16"><use xlink:href="/build/map/icons.svg#dot-medium"></use></svg>
					${Tt}
				</div>`,href:"",shape:{type:"Circle",coordinates:[6,6],radius:6},size:[12,12],offset:[-6,-6],zIndex:100,zIndexActive:200},{name:"z#premium",html:`<div class="z-map-marker z-map-marker--premium z-map-marker <%- classList %>" data-shape="<%- shape %>">
					<svg class="z-map-marker-icon" width="28" height="36"><use xlink:href="/build/map/icons.svg#premium"></use></svg>
					<svg class="z-map-marker-icon z-map-marker-icon--active" width="32" height="38"><use xlink:href="/build/map/icons.svg#premium-active"></use></svg>
					${Tt}
				</div>`,href:"",shape:{type:"Polygon",coordinates:[[[0,0],[28,0],[28,36],[0,36]]]},size:[28,36],offset:[-14,-36],zIndex:101,zIndexActive:202},{name:"z#lego",html:'<div class="z-map-marker z-map-marker--lego"><svg class="z-map-marker-icon" width="32" height="40"><use xlink:href="/build/map/icons.svg#lego"></use></svg></div>',href:"",shape:{type:"Rectangle",coordinates:[[0,0],[32,40]]},size:[32,40],offset:[-16,-40],zIndex:100,zIndexActive:200},{name:"z#profile",html:'<div class="z-map-marker z-map-marker--profile"><svg class="z-map-marker-icon" width="32" height="32"><use xlink:href="/build/map/icons.svg#profile"></use></svg></div>',href:"",shape:{type:"Circle",coordinates:[32,32],radius:16},size:[32,32],offset:[-16,-16],zIndex:200,zIndexActive:300}],ue=Fa;var ce=class{constructor(e={}){this.loaded=!1,this.map=null,this.collection=null,this.options=e,this.queue=[],this.load(()=>{this.initPresetStorage()})}loadScript(e){return document.querySelector(`head script[src="${e}"]`)?Promise.resolve():new Promise(o=>{let s=document.createElement("script");s.src=e,s.type="text/javascript",s.async=!0,s.readyState?s.onreadystatechange=()=>{(s.readyState==="loaded"||s.readyState==="complete")&&(s.onreadystatechange=null,o(e))}:s.onload=()=>o(e),document.getElementsByTagName("head")[0].appendChild(s)})}load(e){this.ready(e)}ready(e){this.loaded?e&&e.call(this):this.queue.length?this.queue.push(e):(this.loaded=!1,this.queue=[e],this.onMapLoaded=()=>{this.loaded=!0,this.queue.forEach(r=>{r&&r.call(this)}),this.queue=[],this.onMapLoaded=null})}tilesReady(){return Promise.resolve()}createMap(e){throw Error("create map method undefined")}destroyMap(){this.map=null}initPresetStorage(){ue.forEach(e=>this.createPreset(e))}createPlacemark(e){return new Q(e)}createClusterer(){return new ee}createPreset(){throw Error("create preset method undefined")}addPlacemark(e){throw Error("add to map method undefined")}addPlacemarks(e){e.forEach(r=>this.addPlacemark(r))}removePlacemark(e){throw Error("remove placemark method undefined")}removePlacemarks(e){e.forEach(r=>this.removePlacemark(r))}addClusterer(e){throw Error("addCluster method undefined")}fitToViewport(e){throw Error("fit to viewport method undefined")}getBounds(){throw Error("get bounds method undefined")}setBounds(){throw Error("set bounds method undefined")}getCenter(){throw Error("get center method undefined")}getZoom(){throw Error("get zoom method undefined")}getCenterAndZoom(){throw Error("get center and zoom method undefined")}setCenter(e,r,o){throw Error("set center method undefined")}moveTo(e,r,o){throw Error("move to method undefined")}addRoute(e,r){throw Error("add route method undefined")}addRouteControl(e,r){throw Error("add route control method undefined")}addControl(e){throw Error("add controls method undefined")}removeControl(e){throw Error("remove controls method undefined")}enableScrollZoom(){throw Error("enable scroll zoom method undefined")}disableScrollZoom(){throw Error("disable scroll zoom method undefined")}on(e,r){throw Error("add events method undefined")}fire(e){throw Error("trigger event method undefined")}getNode(){throw Error("get node method undefined")}getDistance(e){throw Error("get distance method undefined")}toPixelsMercator(e,r){throw Error("toPixelsMercator method undefined")}fromPixelsMercator(e,r){throw Error("fromPixelsMercator method undefined")}},Et=ce;var qa={mouseenter:"mouseover",mouseleave:"mouseout",balloonopen:"popupopen",balloonclose:"popupclose",boundschange:"moveend",click:"click",actionbegin:"movestart"},y=qa;var jt=new Map;Object.freeze(jt);var b=jt;var xe=class extends Q{constructor(e){super(e);let{id:r,preset:o,visible:s,draggable:f}=this.options,{zIndexOffset:i,riseOffset:n}=b.get(o);this.marker=new window.L.marker(this.getLatLng(),{zoon_id:r,icon:this.createIcon(o),visible:s,draggable:f,riseOnHover:!0,riseOffset:n,zIndexOffset:i})}set(e,r){super.set(e,r),this.marker.options[e]=r}on(e,r){return this.marker.on(y[e],r.bind(this)),this}fire(e){this.marker.fire(y[e])}createIcon(e){let r=b.get(e),o=e==="z#premium"||e==="z#normal"?j(r.html)(this.getData()):r.html;return window.L[r.href?"icon":"divIcon"](_(w({},r),{html:o}))}setPreset(e){this.marker.setIcon(this.createIcon(e))}setZIndex(e){this.marker.setZIndexOffset(e)}getNode(){return x(this,null,function*(){var e;return(e=this.marker)==null?void 0:e._icon})}setActive(e){super.setActive(e)}createBalloon(e={}){var o;window.is_phone&&Object.assign(e,{pane:"fixedPopupPane"}),(o=e.autoPanMargins)!=null&&o.length&&Object.assign(e,{autoPan:!window.is_phone,autoPanPaddingTopLeft:[e.autoPanMargins[3],e.autoPanMargins[0]],autoPanPaddingBottomRight:[e.autoPanMargins[1],e.autoPanMargins[2]]});let r=window.L.popup(e);this.marker.bindPopup(r,{maxWidth:"auto",className:"z-map-balloon"})}getBalloon(){return this.marker.getPopup()}setBalloonContent(e){super.setBalloonContent(e),this.getBalloon().setContent(e)}openBalloon(){this.marker.openPopup(this.getLatLng())}closeBalloon(){this.marker.closePopup()}getBalloonNode(){return x(this,null,function*(){return this.getBalloon().getElement()})}},Lt=xe;var he=class extends ee{constructor(){let e={maxClusterRadius:32,spiderfyOnMaxZoom:!1,showCoverageOnHover:!1,zoomToBoundsOnClick:!1,iconCreateFunction:r=>this.createIcon("z#cluster",r.getChildCount())};super(),this.clusterer=new window.L.markerClusterGroup(e)}on(e,r){this.clusterer.on(y.cluster[e],o=>{let s=o.layer.getAllChildMarkers();r(s.map(f=>f.options.zoon_id))})}createIcon(e,r){let o=b.get(e),s=e==="z#cluster"?j(o.html)({count:r<100?r:"99+"}):o.html;return window.L[o.href?"icon":"divIcon"](_(w({},o),{html:s}))}setPreset(e){this.clusterer.setIcon(this.createIcon(e))}getNode(){}add(e){this.clusterer.addLayers(e.map(r=>r.marker))}remove(e){this.clusterer.removeLayers(e.map(r=>r.marker))}removeAll(){this.clusterer.clearLayers()}},At=he;var ge=class extends Et{constructor(e={}){["/lib/leaflet/leaflet-1.7.1z.min.css","/lib/leaflet/leaflet-routing-machine-3.2.12.css","/lib/leaflet/maplibre-gl.css"].forEach(o=>{let s=document.createElement("link");s.rel="stylesheet",s.type="text/css",s.href=o,document.head.appendChild(s)}),window.requirejs.config({paths:{leaflet:"lib/leaflet/leaflet-1.7.1z.min","leaflet.markercluster":"lib/leaflet/leaflet.markercluster","mapbox-gl":"lib/leaflet/maplibre-gl","leaflet.mapbox-gl":"lib/leaflet/leaflet-mapbox-gl.min","leaflet-routing-machine":"lib/leaflet/leaflet-routing-machine-3.2.12.min"},shim:{"leaflet.markercluster":{deps:["leaflet"]},"leaflet.mapbox-gl":{deps:["leaflet","mapbox-gl"]},"leaflet-routing-machine":{deps:["leaflet"]}}}),window.define("L",["leaflet","leaflet.mapbox-gl","leaflet-routing-machine"],o=>o),super(e)}load(e){super.ready(e),window.requirejs(["L"],()=>this.onMapLoaded())}createMap(e){let{el:r,center:o,zoom:s}=e,f={center:o,zoom:s,trackResize:!1,zoomControl:!1,scrollWheelZoom:!1,maxZoom:19};this.map=new window.L.map(r,f),this.map.createPane("fixedPopupPane",r),window.L.mapboxGL({crossOrigin:!0,attribution:'<a href="https://www.maptiler.com/copyright/" target="_blank">\xA9 MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">\xA9 OpenStreetMap contributors</a>',style:`${window.mapDriverTileDomain}/api/maps/bright4/style.json`}).addTo(this.map),this.collection=window.L.layerGroup().addTo(this.map)}destroyMap(){var e;(e=this.map)==null||e.remove(),super.destroyMap()}createPlacemark(e){return new Lt(e)}createClusterer(){return new At}addPlacemark(e){e.marker.addTo(this.map)}addPlacemarks(e){e.forEach(r=>{this.collection.addLayer(r.marker)})}removePlacemark(e){e.marker.remove()}removePlacemarks(e){e.forEach(r=>{this.collection.removeLayer(r.marker)})}addClusterer(e){this.map.addLayer(e.clusterer)}on(e,r){this.map.on(y[e],r.bind(this))}fire(e){this.map.fire(y[e])}createPreset(e){b.set(e.name,{iconUrl:e.href,html:e.html,shadowUrl:"",iconSize:e.size,iconAnchor:e.offset.map(r=>-r),popupAnchor:[0,0],zIndexOffset:e.zIndex,riseOnHover:!0,riseOffset:e.zIndexActive,className:"leaflet-div-icon-nostyle"})}getBounds(){let e=this.map.getBounds();return[[e.getSouth(),e.getWest()],[e.getNorth(),e.getEast()]]}setBounds(e,r){this.map.fitBounds(e,r)}getCenter(){let e=this.map.getCenter();return[e.lat,e.lng]}getZoom(){var e;return(e=this.map)==null?void 0:e.getZoom()}getCenterAndZoom(e,r){let o=[window.L.CRS.EPSG3857.project(window.L.latLng(e[0])),window.L.CRS.EPSG3857.project(window.L.latLng(e[1]))].map(m=>[m.x,m.y]),{lat:s,lng:f}=window.L.CRS.EPSG3857.unproject(window.L.point([(o[0][0]+o[1][0])/2,(o[0][1]+o[1][1])/2])),i=[Math.abs(o[0][0]-o[1][0]),Math.abs(o[0][1]-o[1][1])],n=[window.L.Projection.SphericalMercator.bounds.max.x-window.L.Projection.SphericalMercator.bounds.min.x,window.L.Projection.SphericalMercator.bounds.max.y-window.L.Projection.SphericalMercator.bounds.min.y],p=Math.floor(Math.log(r[0]*n[0]/i[0]/256)/Math.log(2)),d=Math.floor(Math.log(r[1]*n[1]/i[1]/256)/Math.log(2)),v=Math.min(p,d);return{center:[s,f],zoom:v}}setCenter(e,r,o){this.map.setView(e,r,o)}moveTo(s,f){return x(this,arguments,function*(e,r,o={}){let{duration:i=750}=o;return this.map.setView(e,r,{duration:i/1e3,easeLinearity:.4}),new Promise(n=>{setTimeout(n,i)})})}addRoute(e,r){window.L.Routing.control({waypoints:[e,r]}).addTo(this.map)}addRouteControl(e,r){window.L.Routing.control({waypoints:[e,r],routeWhileDragging:!0}).addTo(this.map)}addControl(e){switch(e){case"zoomControl":window.L.control.zoom().addTo(this.map);break;default:}}removeControl(e){switch(e){case"zoomControl":window.L.control.zoom().remove();break;default:}}enableScrollZoom(){this.map.scrollWheelZoom.enable()}disableScrollZoom(){this.map.scrollWheelZoom.disable()}getNode(){return this.map.getContainer()}getDistance(e,r){return this.map.distance(e,r)}fitToViewport(e){this.map.invalidateSize((e==null?void 0:e.animate)||!1)}toPixelsMercator(e,r){let o=window.L.CRS.EPSG3857.latLngToPoint(window.L.latLng(e),r);return[o.x,o.y]}fromPixelsMercator(e,r){let o=window.L.CRS.EPSG3857.pointToLatLng(window.L.point(e),r);return[o.lat,o.lng]}},te=ge;window.ZMapDriver=te;var Ua=te;return Ft($a);})();
/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
return __EXPORTS__ ? __EXPORTS__.default : null;}));
