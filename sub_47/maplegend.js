//>>built
/*
 *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
*****************************************************************************/
require({cache:{"tslib/tslib":function(){var E,J,K,t,l,O,A,D,P,M,H,d,h,n,u,p,S,Q,B,x,b,q,C,c;(function(m){function w(y,f){y!==T&&("function"===typeof Object.create?Object.defineProperty(y,"__esModule",{value:!0}):y.__esModule=!0);return function(F,g){return y[F]=f?f(F,g):g}}var T="object"===typeof global?global:"object"===typeof self?self:"object"===typeof this?this:{};"function"===typeof define&&define.amd?define("tslib",["exports"],function(y){m(w(T,w(y)))}):"object"===typeof module&&"object"===
typeof module.exports?m(w(T,w(module.exports))):m(w(T))})(function(m){var w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,f){y.__proto__=f}||function(y,f){for(var F in f)Object.prototype.hasOwnProperty.call(f,F)&&(y[F]=f[F])};E=function(y,f){function F(){this.constructor=y}if("function"!==typeof f&&null!==f)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");w(y,f);y.prototype=null===f?Object.create(f):(F.prototype=f.prototype,new F)};J=Object.assign||
function(y){for(var f,F=1,g=arguments.length;F<g;F++){f=arguments[F];for(var k in f)Object.prototype.hasOwnProperty.call(f,k)&&(y[k]=f[k])}return y};K=function(y,f){var F={},g;for(g in y)Object.prototype.hasOwnProperty.call(y,g)&&0>f.indexOf(g)&&(F[g]=y[g]);if(null!=y&&"function"===typeof Object.getOwnPropertySymbols){var k=0;for(g=Object.getOwnPropertySymbols(y);k<g.length;k++)0>f.indexOf(g[k])&&Object.prototype.propertyIsEnumerable.call(y,g[k])&&(F[g[k]]=y[g[k]])}return F};t=function(y,f,F,g){var k=
arguments.length,V=3>k?f:null===g?g=Object.getOwnPropertyDescriptor(f,F):g,G;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)V=Reflect.decorate(y,f,F,g);else for(var N=y.length-1;0<=N;N--)if(G=y[N])V=(3>k?G(V):3<k?G(f,F,V):G(f,F))||V;return 3<k&&V&&Object.defineProperty(f,F,V),V};l=function(y,f){return function(F,g){f(F,g,y)}};O=function(y,f){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(y,f)};A=function(y,f,F,g){function k(V){return V instanceof
F?V:new F(function(G){G(V)})}return new (F||(F=Promise))(function(V,G){function N(I){try{v(g.next(I))}catch(Y){G(Y)}}function e(I){try{v(g["throw"](I))}catch(Y){G(Y)}}function v(I){I.done?V(I.value):k(I.value).then(N,e)}v((g=g.apply(y,f||[])).next())})};D=function(y,f){function F(v){return function(I){return g([v,I])}}function g(v){if(V)throw new TypeError("Generator is already executing.");for(;k;)try{if(V=1,G&&(N=v[0]&2?G["return"]:v[0]?G["throw"]||((N=G["return"])&&N.call(G),0):G.next)&&!(N=N.call(G,
v[1])).done)return N;if(G=0,N)v=[v[0]&2,N.value];switch(v[0]){case 0:case 1:N=v;break;case 4:return k.label++,{value:v[1],done:!1};case 5:k.label++;G=v[1];v=[0];continue;case 7:v=k.ops.pop();k.trys.pop();continue;default:if(!(N=k.trys,N=0<N.length&&N[N.length-1])&&(6===v[0]||2===v[0])){k=0;continue}if(3===v[0]&&(!N||v[1]>N[0]&&v[1]<N[3]))k.label=v[1];else if(6===v[0]&&k.label<N[1])k.label=N[1],N=v;else if(N&&k.label<N[2])k.label=N[2],k.ops.push(v);else{N[2]&&k.ops.pop();k.trys.pop();continue}}v=f.call(y,
k)}catch(I){v=[6,I],G=0}finally{V=N=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}var k={label:0,sent:function(){if(N[0]&1)throw N[1];return N[1]},trys:[],ops:[]},V,G,N,e;return e={next:F(0),"throw":F(1),"return":F(2)},"function"===typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e};P=function(y,f){for(var F in y)"default"===F||Object.prototype.hasOwnProperty.call(f,F)||c(f,y,F)};c=Object.create?function(y,f,F,g){void 0===g&&(g=F);Object.defineProperty(y,g,{enumerable:!0,
get:function(){return f[F]}})}:function(y,f,F,g){void 0===g&&(g=F);y[g]=f[F]};M=function(y){var f="function"===typeof Symbol&&Symbol.iterator,F=f&&y[f],g=0;if(F)return F.call(y);if(y&&"number"===typeof y.length)return{next:function(){y&&g>=y.length&&(y=void 0);return{value:y&&y[g++],done:!y}}};throw new TypeError(f?"Object is not iterable.":"Symbol.iterator is not defined.");};H=function(y,f){var F="function"===typeof Symbol&&y[Symbol.iterator];if(!F)return y;y=F.call(y);var g,k=[];try{for(;(void 0===
f||0<f--)&&!(g=y.next()).done;)k.push(g.value)}catch(G){var V={error:G}}finally{try{g&&!g.done&&(F=y["return"])&&F.call(y)}finally{if(V)throw V.error;}}return k};d=function(){for(var y=[],f=0;f<arguments.length;f++)y=y.concat(H(arguments[f]));return y};h=function(){for(var y=0,f=0,F=arguments.length;f<F;f++)y+=arguments[f].length;y=Array(y);var g=0;for(f=0;f<F;f++)for(var k=arguments[f],V=0,G=k.length;V<G;V++,g++)y[g]=k[V];return y};n=function(y,f,F){if(F||2===arguments.length)for(var g=0,k=f.length,
V;g<k;g++)!V&&g in f||(V||(V=Array.prototype.slice.call(f,0,g)),V[g]=f[g]);return y.concat(V||Array.prototype.slice.call(f))};u=function(y){return this instanceof u?(this.v=y,this):new u(y)};p=function(y,f,F){function g(Y){e[Y]&&(v[Y]=function(ea){return new Promise(function(ba,L){1<I.push([Y,ea,ba,L])||k(Y,ea)})})}function k(Y,ea){try{var ba=e[Y](ea);ba.value instanceof u?Promise.resolve(ba.value.v).then(V,G):N(I[0][2],ba)}catch(L){N(I[0][3],L)}}function V(Y){k("next",Y)}function G(Y){k("throw",
Y)}function N(Y,ea){(Y(ea),I.shift(),I.length)&&k(I[0][0],I[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=F.apply(y,f||[]),v,I=[];return v={},g("next"),g("throw"),g("return"),v[Symbol.asyncIterator]=function(){return this},v};S=function(y){function f(k,V){F[k]=y[k]?function(G){return(g=!g)?{value:u(y[k](G)),done:"return"===k}:V?V(G):G}:V}var F,g;return F={},f("next"),f("throw",function(k){throw k;}),f("return"),F[Symbol.iterator]=function(){return this},
F};Q=function(y){function f(V){k[V]=y[V]&&function(G){return new Promise(function(N,e){G=y[V](G);F(N,e,G.done,G.value)})}}function F(V,G,N,e){Promise.resolve(e).then(function(v){V({value:v,done:N})},G)}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var g=y[Symbol.asyncIterator],k;return g?g.call(y):(y="function"===typeof M?M(y):y[Symbol.iterator](),k={},f("next"),f("throw"),f("return"),k[Symbol.asyncIterator]=function(){return this},k)};B=function(y,f){Object.defineProperty?
Object.defineProperty(y,"raw",{value:f}):y.raw=f;return y};var T=Object.create?function(y,f){Object.defineProperty(y,"default",{enumerable:!0,value:f})}:function(y,f){y["default"]=f};x=function(y){if(y&&y.__esModule)return y;var f={};if(null!=y)for(var F in y)"default"!==F&&Object.prototype.hasOwnProperty.call(y,F)&&c(f,y,F);T(f,y);return f};b=function(y){return y&&y.__esModule?y:{"default":y}};q=function(y,f,F,g){if("a"===F&&!g)throw new TypeError("Private accessor was defined without a getter");
if("function"===typeof f?y!==f||!g:!f.has(y))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===F?g:"a"===F?g.call(y):g?g.value:f.get(y)};C=function(y,f,F,g,k){if("m"===g)throw new TypeError("Private method is not writable");if("a"===g&&!k)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof f?y!==f||!k:!f.has(y))throw new TypeError("Cannot write private member to an object whose class did not declare it");
return"a"===g?k.call(y,F):k?k.value=F:f.set(y,F),F};m("__extends",E);m("__assign",J);m("__rest",K);m("__decorate",t);m("__param",l);m("__metadata",O);m("__awaiter",A);m("__generator",D);m("__exportStar",P);m("__createBinding",c);m("__values",M);m("__read",H);m("__spread",d);m("__spreadArrays",h);m("__spreadArray",n);m("__await",u);m("__asyncGenerator",p);m("__asyncDelegator",S);m("__asyncValues",Q);m("__makeTemplateObject",B);m("__importStar",x);m("__importDefault",b);m("__classPrivateFieldGet",q);
m("__classPrivateFieldSet",C)})},"esri/widgets/Legend":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Handles ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(E,J,K,t,l,O,A,D,P,M,H,d,h,n,u,p,S,Q){A=function(B){function x(q,C){q=B.call(this,q,C)||this;q._handles=new K;q.activeLayerInfos=null;q.basemapLegendVisible=!1;q.groundLegendVisible=!1;q.headingLevel=3;q.hideLayersNotInCurrentView=!1;q.keepCacheOnDestroy=!1;q.respectLayerVisibility=!0;q.iconClass="esri-icon-layer-list";q.label=void 0;q.layerInfos=null;q.messages=null;q.style=new u;q.view=null;q.viewModel=new h;return q}E._inheritsLoose(x,B);var b=x.prototype;b.initialize=function(){this.own([l.on(()=>
this.view,"resize",()=>this.scheduleRender()),l.on(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),l.watch(()=>this.headingLevel,q=>{const {style:C}=this;C&&(C.headingLevel=q)}),l.watch(()=>this.style,(q,C)=>{C&&q!==C&&C.destroy();q&&(q.activeLayerInfos=this.activeLayerInfos,"card"===q.type&&(q.view=this.view),q.headingLevel=this.headingLevel)},l.initial)])};b.destroy=function(){this._handles=t.destroyMaybe(this._handles)};b.castStyle=function(q){if(q instanceof
n||q instanceof u)return q;if("string"===typeof q)return"card"===q?new n:new u;if(q&&"string"===typeof q.type){const C={...q};delete C.type;return new ("card"===q.type?n:u)(C)}return new u};b.render=function(){return Q.tsx("div",{class:this.classes("esri-legend","esri-widget",this.style instanceof u?"esri-widget--panel":null)},this.style.render())};b._refreshActiveLayerInfos=function(q){this._handles.removeAll();q.forEach(C=>this._renderOnActiveLayerInfoChange(C));this.scheduleRender()};b._renderOnActiveLayerInfoChange=
function(q){var C=l.watch(()=>q.version,()=>this.scheduleRender());this._handles.add(C,`version_${q.layer.uid}`);C=l.on(()=>q.children,"change",()=>q.children.forEach(c=>this._renderOnActiveLayerInfoChange(c)),l.initial);this._handles.add(C,`children_${q.layer.uid}`);q.children.forEach(c=>this._renderOnActiveLayerInfoChange(c))};return x}(d);J.__decorate([O.aliasOf("viewModel.activeLayerInfos")],A.prototype,"activeLayerInfos",void 0);J.__decorate([O.aliasOf("viewModel.basemapLegendVisible")],A.prototype,
"basemapLegendVisible",void 0);J.__decorate([O.aliasOf("viewModel.groundLegendVisible")],A.prototype,"groundLegendVisible",void 0);J.__decorate([M.property()],A.prototype,"headingLevel",void 0);J.__decorate([O.aliasOf("viewModel.hideLayersNotInCurrentView")],A.prototype,"hideLayersNotInCurrentView",void 0);J.__decorate([O.aliasOf("viewModel.keepCacheOnDestroy")],A.prototype,"keepCacheOnDestroy",void 0);J.__decorate([O.aliasOf("viewModel.respectLayerVisibility")],A.prototype,"respectLayerVisibility",
void 0);J.__decorate([M.property()],A.prototype,"iconClass",void 0);J.__decorate([M.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],A.prototype,"label",void 0);J.__decorate([O.aliasOf("viewModel.layerInfos")],A.prototype,"layerInfos",void 0);J.__decorate([M.property(),S.messageBundle("esri/widgets/Legend/t9n/Legend")],A.prototype,"messages",void 0);J.__decorate([M.property()],A.prototype,"style",void 0);J.__decorate([P.cast("style")],A.prototype,"castStyle",null);J.__decorate([O.aliasOf("viewModel.view")],
A.prototype,"view",void 0);J.__decorate([M.property()],A.prototype,"viewModel",void 0);return A=J.__decorate([H.subclass("esri.widgets.Legend")],A)})},"esri/widgets/Legend/LegendViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./support/ActiveLayerInfo ../../intl/locale".split(" "),
function(E,J,K,t,l,O,A,D,P,M,H,d,h,n){const u=l.ofType(h),p="esri.layers.BuildingSceneLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.TileLayer esri.layers.VoxelLayer esri.layers.WFSLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer".split(" "),
S=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];K=function(Q){function B(b){b=Q.call(this,b)||this;b._handles=new O;b._layerViewByLayerId={};b._layerInfosByLayerViewId={};b._activeLayerInfosByLayerViewId={};b._activeLayerInfosWithNoParent=new l;b.activeLayerInfos=new u;b.basemapLegendVisible=!1;b.groundLegendVisible=!1;b.hideLayersNotInCurrentView=!1;b.keepCacheOnDestroy=!1;b.respectLayerVisibility=!0;b.layerInfos=[];b.view=
null;return b}E._inheritsLoose(B,Q);var x=B.prototype;x.initialize=function(){this._handles.add(A.watch(()=>this.view,()=>this._viewHandles(),A.initial),"view");this._handles.add(n.onLocaleChange(()=>this._refresh()))};x.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();this.view=this._handles=null};x._viewHandles=function(){this._handles.remove("state");this.view&&this._handles.add(A.watch(()=>this.state,()=>this._stateHandles(),A.initial),"state")};x._stateHandles=function(){this._resetAll();
"ready"===this.state&&this._watchPropertiesAndAllLayerViews()};x._resetAll=function(){this._handles.remove(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};x._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};x._destroyViewActiveLayerInfo=function(b){this._handles.remove(b);const q=this._activeLayerInfosByLayerViewId[b];delete this._activeLayerInfosByLayerViewId[b];
q&&q.parent&&q.parent.children.remove(q)};x._watchPropertiesAndAllLayerViews=function(){const {allLayerViews:b}=this.view;b.length&&this._refresh();this._handles.add(b.on("change",q=>this._allLayerViewsChangeHandle(q)),"all-layer-views");this._handles.add(A.watch(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),"legend-properties")};x._allLayerViewsChangeHandle=function(b){b.removed.forEach(q=>this._destroyViewActiveLayerInfo(q.uid));this._refresh()};
x._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos();this._refresh()};x._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};x._sortActiveLayerInfos=function(b){if(!(2>b.length)){var q=[];b.forEach(c=>{if(!c.parent){var m=c.layer.parent;
(m=(m=m&&"uid"in m&&this._layerViewByLayerId[m.uid])&&this._activeLayerInfosByLayerViewId[m.uid])&&b.includes(m)&&(q.push(c),c.parent=m,m.children.add(c),this._sortActiveLayerInfos(m.children))}});b.removeMany(q);var C={};this.view.allLayerViews.forEach((c,m)=>C[c.layer.uid]=m);b.sort((c,m)=>(C[m.layer.uid]||0)-(C[c.layer.uid]||0))}};x._generateLayerViews=function(){const b=[];S.filter(this._filterLayerViews,this).map(this.get,this).filter(q=>null!=q).forEach(this._collectLayerViews("layerViews",
b));return b};x._filterLayerViews=function(b){const q=!this.groundLegendVisible&&"view.groundView.layerViews"===b;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===b||"view.basemapView.referenceLayerViews"===b))&&!q};x._collectLayerViews=function(b,q){const C=c=>{c&&c.forEach(m=>{q.push(m);C(m[b])});return q};return C};x._filterLayerViewsByLayerInfos=function(b){const q=this.layerInfos;return q&&q.length?q.some(C=>this._hasLayerInfo(C,b)):!0};x._hasLayerInfo=function(b,q){const C=
this._isLayerUIDMatching(b.layer,q.layer.uid);C&&(this._layerInfosByLayerViewId[q.uid]=b);return C};x._isLayerUIDMatching=function(b,q){return b&&(b.uid===q||this._hasLayerUID(b.layers,q))};x._hasLayerUID=function(b,q){return b&&b.some(C=>this._isLayerUIDMatching(C,q))};x._isLayerViewSupported=function(b){return p.includes(b.layer.declaredClass)?(this._layerViewByLayerId[b.layer.uid]=b,!0):!1};x._generateActiveLayerInfo=function(b){this._isLayerActive(b)?this._buildActiveLayerInfo(b):(this._handles.remove(b.uid),
this._handles.add(A.watch(()=>{var q;return[b.legendEnabled,null==(q=b.layer)?void 0:q.legendEnabled]},()=>this._layerActiveHandle(b)),b.uid))};x._layerActiveHandle=function(b){this._isLayerActive(b)&&(this._handles.remove(b.uid),this._buildActiveLayerInfo(b))};x._isLayerActive=function(b){return this.respectLayerVisibility?b.legendEnabled&&b.get("layer.legendEnabled"):!0};x._buildActiveLayerInfo=function(b){var q;const C=b.layer,c=b.uid;var m=this._layerInfosByLayerViewId[c];let w=this._activeLayerInfosByLayerViewId[c];
w||(w=new h({layer:C,layerView:b,title:m&&void 0!==m.title&&m.layer.uid===C.uid?m.title:C.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:m&&m.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[c]=w);m=C.parent&&"uid"in C.parent&&this._layerViewByLayerId[null==(q=C.parent)?void 0:q.uid];w.parent=this._activeLayerInfosByLayerViewId[null==m?void 0:m.uid];if(!this._handles.has(c)){q=
A.watch(()=>C.title,F=>this._titleHandle(F,w));m=A.watch(()=>[C.opacity,"renderer"in C&&C.renderer,"pointSymbol"in C&&C.pointSymbol,"lineSymbol"in C&&C.lineSymbol,"polygonSymbol"in C&&C.polygonSymbol],()=>this._constructLegendElements(w));var T=A.when(()=>{var F;return!0===(null==(F=this.view)?void 0:F.stationary)},()=>this._scaleHandle(w),A.initial);const y=A.watch(()=>b._effectiveRenderer,()=>this._constructLegendElements(w)),f=A.watch(()=>"effect"in C&&C.effect,()=>this._constructLegendElements(w));
q=[q,m,T,y,f];this.respectLayerVisibility&&(m=A.watch(()=>b.legendEnabled,F=>this._legendEnabledHandle(F,w)),T=A.watch(()=>C.legendEnabled,F=>this._legendEnabledHandle(F,w)),q.push(m,T));this._handles.add(q,c)}w.isScaleDriven||this._constructLegendElements(w);this._addActiveLayerInfo(w)};x._titleHandle=function(b,q){q.title=b;this._constructLegendElements(q)};x._legendEnabledHandle=function(b,q){b?this._addActiveLayerInfo(q):this._removeActiveLayerInfo(q)};x._scaleHandle=function(b){(b.isScaleDriven||
b.hideLayersNotInCurrentView)&&this._constructLegendElements(b)};x._addActiveLayerInfo=function(b){const {layerView:q,layer:C}=b;if(this._isLayerActive(q)&&!this.activeLayerInfos.includes(b)){var c=b.parent;if(c)c.children.includes(b)||c.children.push(b),this._sortActiveLayerInfos(c.children);else{var m;c=null==(m=this.layerInfos)?void 0:m.some(w=>w.layer.uid===C.uid);C.parent&&"uid"in C.parent&&!c?this._activeLayerInfosWithNoParent.add(b):(this.activeLayerInfos.add(b),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const w=
[];this._activeLayerInfosWithNoParent.forEach(T=>{var y=T.layer.parent;y=y&&"uid"in y&&this._layerViewByLayerId[null==y?void 0:y.uid];if(y=this._activeLayerInfosByLayerViewId[null==y?void 0:y.uid])w.push(T),T.parent=y});w.length&&(this._activeLayerInfosWithNoParent.removeMany(w),w.forEach(T=>this._addActiveLayerInfo(T)))}}};x._removeActiveLayerInfo=function(b){const q=b.parent;q?q.children.remove(b):this.activeLayerInfos.remove(b)};x._constructLegendElements=function(b){var q;const C=b.layer;"featureCollections"in
C&&C.featureCollections?b.buildLegendElementsForFeatureCollections(C.featureCollections):"featureReduction"in C&&"binning"===(null==(q=C.featureReduction)?void 0:q.type)&&"renderer"in C.featureReduction?b.buildLegendElementsForRenderer(C.featureReduction.renderer):"renderer"in C&&C.renderer?b.buildLegendElementsForRenderer(C.renderer):"url"in C&&C.url?b.buildLegendElementsForTools():b.children.forEach(c=>this._constructLegendElements(c))};E._createClass(B,[{key:"state",get:function(){return this.get("view.ready")?
"ready":"disabled"}}]);return B}(t);J.__decorate([D.property({type:u})],K.prototype,"activeLayerInfos",void 0);J.__decorate([D.property()],K.prototype,"basemapLegendVisible",void 0);J.__decorate([D.property()],K.prototype,"groundLegendVisible",void 0);J.__decorate([D.property()],K.prototype,"hideLayersNotInCurrentView",void 0);J.__decorate([D.property()],K.prototype,"keepCacheOnDestroy",void 0);J.__decorate([D.property()],K.prototype,"respectLayerVisibility",void 0);J.__decorate([D.property()],K.prototype,
"layerInfos",void 0);J.__decorate([D.property({readOnly:!0})],K.prototype,"state",null);J.__decorate([D.property()],K.prototype,"view",void 0);return K=J.__decorate([d.subclass("esri.widgets.Legend.LegendViewModel")],K)})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../kernel ../../../request ../../../symbols ../../../core/Accessor ../../../core/Collection ../../../core/Handles ../../../core/jsonMap ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/PropertyOrigin ../../../layers/effects/EffectView ../../../layers/effects/jsonUtils ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../renderers/support/jsonUtils ../../../renderers/support/rendererConversion ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../symbols/support/cimSymbolUtils ../../../symbols/support/previewUtils ../../../symbols/support/renderUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils ../../smartMapping/support/utils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleFillSymbol".split(" "),
function(E,J,K,t,l,O,A,D,P,M,H,d,h,n,u,p,S,Q,B,x,b,q,C,c,m,w,T,y,f,F,g,k,V,G,N,e,v,I,Y,ea,ba,L,R,Z){function ca(ua){return"esri.renderers.SimpleRenderer"===ua.declaredClass}function ja(ua){return"esri.renderers.ClassBreaksRenderer"===ua.declaredClass}function pa(ua){return"esri.renderers.UniqueValueRenderer"===ua.declaredClass}function na(ua){return"esri.renderers.HeatmapRenderer"===ua.declaredClass}function ma(ua){return"esri.renderers.PointCloudClassBreaksRenderer"===ua.declaredClass}function ya(ua){return"esri.renderers.PointCloudStretchRenderer"===
ua.declaredClass}function fa(ua){return"esri.renderers.PointCloudUniqueValueRenderer"===ua.declaredClass}function za(ua){return"esri.renderers.DotDensityRenderer"===ua.declaredClass}function ka(ua){return"esri.renderers.PieChartRenderer"===ua.declaredClass}function qa(ua){return"esri.layers.BuildingSceneLayer"===ua.declaredClass}function sa(ua){ua="authoringInfo"in ua&&(null==ua?void 0:ua.authoringInfo);return"univariate-color-size"===(null==ua?void 0:ua.type)}function Ba(ua){ua="authoringInfo"in
ua&&(null==ua?void 0:ua.authoringInfo);return"univariate-color-size"===(null==ua?void 0:ua.type)&&"above-and-below"===(null==ua?void 0:ua.univariateTheme)}const ta=d.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),Ea=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,Fa=new H.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Ka={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,
127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4*1E39,3.4*1E39],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]},Ia=new R({size:6,outline:{color:[128,128,128,.5],width:.5}}),Oa=new Z({style:"solid"}),Pa=new R({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Ha={};A=function(ua){function Ja(r){r=ua.call(this,r)||this;r._handles=new M;r._hasColorRamp=!1;r._hasOpacityRamp=!1;r._hasSizeRamp=!1;r._webStyleSymbolCache=
new Map;r._dotDensityUrlCache=new Map;r._scaleDrivenSizeVariable=null;r._hasClusterSizeVariable=!1;r.children=new P;r.layerView=null;r.layer=null;r.legendElements=[];r.parent=null;r.hideLayersNotInCurrentView=!1;r.keepCacheOnDestroy=!1;r.respectLayerVisibility=!0;r.sublayerIds=[];r.title=null;r.view=null;return r}J._inheritsLoose(Ja,ua);var ia=Ja.prototype;ia.initialize=function(){const r=()=>this.notifyChange("ready");this._handles.add([u.on(()=>this.children,"change",a=>{const {added:z,removed:U}=
a,W=this._handles;z.forEach(X=>{const aa=`activeLayerInfo-ready-watcher-${X.layer.uid}`;W.add(u.watch(()=>X.ready,r,u.initial),aa)});U.forEach(X=>W.remove(X.layer.uid));r()})]);this.keepCacheOnDestroy||(Ha={})};ia.destroy=function(){this._handles.destroy();this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=this._handles=null;this.keepCacheOnDestroy||(Ha=null)};ia.buildLegendElementsForFeatureCollections=function(){var r=J._asyncToGenerator(function*(a){if(this.hideLayersNotInCurrentView&&
!(yield this._isLayerInCurrentView()))this.legendElements=[],this.notifyChange("ready");else{a=Array.from(a,z=>{if("esri.layers.FeatureLayer"===z.declaredClass)return this._getRendererLegendElements(z.renderer,{title:z.title});if(z.featureSet&&z.featureSet.features.length){var U=z.layerDefinition,W=U&&U.drawingInfo;W=W&&y.fromJSON(W.renderer);U=Fa.read(U.geometryType);return W?this._getRendererLegendElements(W,{title:z.name,geometryType:U}):(ta.warn("drawingInfo not available!"),null)}return null});
try{const z=[];yield n.eachAlways(a).then(U=>{U.forEach(({value:W})=>W&&z.push(...W))});this.legendElements=z;this.notifyChange("ready")}catch(z){ta.warn("error while building legend for layer!",z)}}});return function(a){return r.apply(this,arguments)}}();ia.buildLegendElementsForRenderer=function(){var r=J._asyncToGenerator(function*(a){try{this.legendElements=(this.hideLayersNotInCurrentView?yield this._isLayerInCurrentView():1)?yield this._getRendererLegendElements(a):[],this.notifyChange("ready")}catch(z){ta.warn("error while building legend for layer!",
z)}});return function(a){return r.apply(this,arguments)}}();ia.buildLegendElementsForTools=function(){var r=J._asyncToGenerator(function*(){var a=this;const z=this.layer;if("esri.layers.VoxelLayer"===z.declaredClass)this._constructLegendElementsForVoxellayer();else if("esri.layers.WMTSLayer"===z.declaredClass)this._constructLegendElementsForWMTSlayer();else if("esri.layers.WMSLayer"===z.declaredClass)yield this._constructLegendElementsForWMSSublayers();else if(qa(z))yield this._constructLegendElementsForBuildingSceneLayer();
else if("esri.layers.MapImageLayer"===z.declaredClass||"esri.layers.TileLayer"===z.declaredClass||qa(z))yield this._constructLegendElementsForSublayers();else{this._handles.remove("imageryLayers-watcher");var U="default";if("esri.layers.ImageryLayer"===z.declaredClass){var W,X;U=(null==z?void 0:null==(W=z.renderingRule)?void 0:W.functionName)||"default";W=null!=(X=z.bandIds)&&X.length?z.bandIds.join(""):"###";U=U+"_"+W}yield this._getLegendLayers(`${z.uid}-${U}`).then(function(){var aa=J._asyncToGenerator(function*(da){a.legendElements=
[];a.notifyChange("ready");da=da.map(function(){var la=J._asyncToGenerator(function*(va){if("esri.layers.ImageryLayer"===z.declaredClass||"esri.layers.ImageryTileLayer"===z.declaredClass){const wa=u.watch(()=>["renderingRule"in z&&z.renderingRule,z.bandIds],()=>n.debounce(J._asyncToGenerator(function*(){Ha["default"]=null;z.renderer?yield a.buildLegendElementsForRenderer(z.renderer):yield a.buildLegendElementsForTools()}))());a._handles.add(wa,"imageryLayers-watcher")}(va=a._generateSymbolTableElementForLegendLayer(va))&&
va.infos.length&&("esri.layers.ImageryLayer"===z.declaredClass&&(va.title=z.title),a.legendElements.push(va));a.notifyChange("ready")});return function(va){return la.apply(this,arguments)}}());yield n.eachAlways(da)});return function(da){return aa.apply(this,arguments)}}()).catch(aa=>{ta.warn("Request to server for legend has failed!",aa)})}});return function(){return r.apply(this,arguments)}}();ia._isLayerInCurrentView=function(){var r=J._asyncToGenerator(function*(){const a=this.layer,z=this.layerView,
U=z&&"createQuery"in z&&"queryFeatureCount"in z;if(!(U||z&&"createQuery"in a&&"queryFeatureCount"in a))return!0;yield u.whenOnce(()=>!z.updating);const W=U?"createQuery"in z&&z.createQuery():"createQuery"in a&&a.createQuery();W.geometry=this.view.extent;return 0!==(U?"queryFeatureCount"in z&&(yield z.queryFeatureCount(W)):"queryFeatureCount"in a&&(yield a.queryFeatureCount(W)))});return function(){return r.apply(this,arguments)}}();ia._getParentLayerOpacity=function(r){let a=1;const z=r.parent;z&&
"uid"in z&&(a=this._getParentLayerOpacity(z));return r.opacity*a};ia._isGroupActive=function(){const r=this.children;return r.length?r.some(a=>a.ready):!1};ia._isRendererScaleDriven=function(r){return"dot-density"===r.type||Ea.test("valueExpression"in r&&r.valueExpression)?!0:(r="visualVariables"in r&&r.visualVariables)?r.some(a=>this._isScaleDrivenSizeVariable(a)):!1};ia._isScaleDrivenSizeVariable=function(r){if(r&&"size"!==r.type)return!1;const a=r.minSize,z=r.maxSize;return"object"===typeof a&&
a?this._isScaleDrivenSizeVariable(a):"object"===typeof z&&z?this._isScaleDrivenSizeVariable(z):!!r.expression||Ea.test(r.valueExpression)};ia._isLayerScaleDriven=function(r){if("minScale"in r&&0<r.minScale||"maxScale"in r&&0<r.maxScale)return!0;if("sublayers"in r&&r.sublayers)return r.sublayers.some(z=>this._isLayerScaleDriven(z));const a=r.parent;if(!1===r.loaded&&a&&"esri.layers.MapImageLayer"===a.declaredClass&&"source"in r&&r.source&&"map-layer"===r.source.type)for(const z of a.sourceJSON.layers)if(z.id===
r.source.mapLayerId&&(0<z.minScale||0<z.maxScale))return!0;return!1};ia._constructLegendElementsForVoxellayer=function(){var r=J._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("voxel-style-watcher");const a=this.layer;this._handles.add(u.watch(()=>a.currentVariableId,()=>this._constructLegendElementsForVoxellayer()),"voxel-style-watcher");var z=h.unwrap(a.getVariableStyle(null));const U=[];if(z){var W;if(null!=(W=z.uniqueValues)&&W.length){const aa=[];z.uniqueValues.forEach(da=>
{da.enabled&&aa.push({label:da.label||`${da.value}`,value:da.value,symbol:new Z({color:da.color,outline:null})})});aa.length&&U.push({type:"symbol-table",title:z.label,infos:aa})}else if(z.transferFunction){const {colorStops:aa,stretchRange:da}=z.transferFunction;W=aa.toArray().reverse();const la=da.map((wa,ha)=>`${0===ha?ba.SPECIAL_CHARS_LESS_THAN:ba.SPECIAL_CHARS_GREATER_THAN} ${L.formatNumberLabel(wa)}`).reverse(),va=W.map(wa=>({color:wa.color,value:null,label:null}));va[0].label=la[0];va[va.length-
1].label=la[1];U.push({type:"color-ramp",title:z.label,infos:va,preview:G.renderColorRampPreviewHTML(W.map(wa=>wa.color))})}}const X=a.opacity;z=U.reduce((aa,da)=>aa.concat(this._getAllInfos(da)),[]).filter(aa=>!(null==aa||!aa.symbol)).map(aa=>this._getSymbolPreview(aa,X));yield n.eachAlways(z);this.legendElements=U;this.notifyChange("ready")});return function(){return r.apply(this,arguments)}}();ia._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this._handles.remove("wmts-activeLayer-watcher");
const r=this.layer.activeLayer;this._handles.add(u.watch(()=>{const {layer:a}=this;return a&&"activeLayer"in a&&a.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");if(r.styleId&&r.styles){let a=null;r.styles.some(z=>r.styleId===z.id?(a=z.legendUrl,!0):!1);a&&(this.legendElements=[{type:"symbol-table",title:r.title,infos:[{src:a,opacity:this.opacity}]}])}this.notifyChange("ready")};ia._constructLegendElementsForWMSSublayers=function(){var r=J._asyncToGenerator(function*(){this.legendElements=
[];this._handles.remove("wms-sublayers-watcher");const a=this.layer;let z=null;if(a.customParameters||a.customLayerParameters)z={...a.customParameters,...a.customLayerParameters};this._handles.add(u.watch(()=>{const {layer:U}=this;return U&&"sublayers"in U&&U.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");this.legendElements=yield this._generateLegendElementsForWMSSublayers(a.sublayers,z);this.notifyChange("ready")});return function(){return r.apply(this,arguments)}}();
ia._generateLegendElementsForWMSSublayers=function(){var r=J._asyncToGenerator(function*(a,z){const U=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");a=a.toArray();for(const W of a)a=u.watch(()=>[W.title,W.visible,W.legendEnabled],()=>this._constructLegendElementsForWMSSublayers()),this._handles.add(a,"wms-sublayers-watcher"),(!this.respectLayerVisibility||W.visible&&W.legendEnabled)&&(a=yield this._generateSymbolTableElementForWMSSublayer(W,
z))&&a.infos.length&&U.unshift(a);return U});return function(a,z){return r.apply(this,arguments)}}();ia._generateSymbolTableElementForWMSSublayer=function(){var r=J._asyncToGenerator(function*(a,z){return!a.legendUrl&&a.sublayers?(z=(yield this._generateLegendElementsForWMSSublayers(a.sublayers,z)).filter(U=>U),{type:"symbol-table",title:a.title,infos:z}):this._generateSymbolTableElementForLegendUrl(a,z)});return function(a,z){return r.apply(this,arguments)}}();ia._generateSymbolTableElementForLegendUrl=
function(){var r=J._asyncToGenerator(function*(a,z){var U;let W=a.legendUrl;if(W){var X={type:"symbol-table",title:a.title||a.name||a.id&&a.id+"",infos:[]};z&&(W=S.addQueryParameters(W,z));z=null;a=null==(U=a.layer)?void 0:U.opacity;try{if(z=(yield O(W,{responseType:"image"})).data)z.style.opacity=a}catch{}X.infos.push({src:W,preview:z,opacity:a});return X}});return function(a,z){return r.apply(this,arguments)}}();ia._getLegendLayers=function(r,a){const z=Ha&&Ha[r];return z?Promise.resolve(z):this._legendRequest(a).then(U=>
{U=U.layers;return Ha[r]=U})};ia._legendRequest=function(r){var a=this.layer;r={f:"json",dynamicLayers:r};if("esri.layers.ImageryLayer"===a.declaredClass){var z=a.exportImageServiceParameters.renderingRule;z&&(r.renderingRule=JSON.stringify(z.rasterFunctionDefinition||z.toJSON()));a.bandIds&&(r.bandIds=a.bandIds.join());if(a.raster||a.viewId||a.customParameters){const {raster:U,viewId:W,customParameters:X}=a;r={raster:U,viewId:W,...r,...X}}}z=a.url.replace(/(\/)+$/,"");"version"in a&&10.01<=a.version?
(a=z.indexOf("?"),z=-1<a?z.substring(0,a)+"/legend"+z.substring(a):z+"/legend"):(a=z.toLowerCase().indexOf("/rest/"),a=z.substring(0,a)+z.substring(a+5,z.length),z="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(a)+"\x26returnbytes\x3dtrue");return O(z,{query:r}).then(U=>U.data)};ia._constructLegendElementsForBuildingSceneLayer=function(){var r=J._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("sublayers-watcher");const a=this.layer;this._handles.add(u.watch(()=>
a.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=yield this._generateLegendElementsForBuildingSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(z){ta.warn("Request to server for legend has failed!",z)}});return function(){return r.apply(this,arguments)}}();ia._generateLegendElementsForBuildingSublayers=function(){var r=J._asyncToGenerator(function*(a,z){let U=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),
"sublayers-watcher");a=a.toArray();for(const X of a)if(a=u.watch(()=>["renderer"in X&&X.renderer,X.opacity,X.title,X.visible],()=>this._constructLegendElementsForBuildingSceneLayer()),this._handles.add(a,"sublayers-watcher"),!this.respectLayerVisibility||X.visible){a=X&&null!=X.opacity?X.opacity:null;var W=null!=a?a*z:z;"building-group"===X.type?(a={type:"symbol-table",title:X.title,infos:[]},W=yield this._generateLegendElementsForBuildingSublayers(X.sublayers,W),a.infos.push(...W),U=[a,...U]):X.renderer&&
(U=[...yield this._getRendererLegendElements(X.renderer,{title:X.title,opacity:W,sublayer:X}),...U])}return U.filter(X=>!!X&&("infos"in X?0<X.infos.length:!0))});return function(a,z){return r.apply(this,arguments)}}();ia._constructLegendElementsForSublayers=function(){var r=J._asyncToGenerator(function*(){this.legendElements=[];this._handles.remove("sublayers-watcher");const a=this.layer;this._handles.add(u.watch(()=>a.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");
try{this.legendElements=yield this._generateLegendElementsForSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(z){ta.warn("Request to server for legend has failed!",z)}});return function(){return r.apply(this,arguments)}}();ia._generateLegendElementsForSublayers=function(){var r=J._asyncToGenerator(function*(a,z,U){const W=this.layer;let X=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");a=a.toArray();!U&&this.sublayerIds&&
this.sublayerIds.length&&(a=this.sublayerIds.map(aa=>W.findSublayerById(aa)).filter(Boolean));for(const aa of a)if(a=u.watch(()=>[aa.renderer,aa.opacity,aa.title,aa.visible,aa.legendEnabled],()=>this._constructLegendElementsForSublayers()),this._handles.add(a,"sublayers-watcher"),!this.respectLayerVisibility||aa.visible&&aa.legendEnabled&&this._isSublayerInScale(aa))a=aa&&null!=aa.opacity?aa.opacity:null,a=null!=a?a*z:z,aa.renderer&&!aa.sublayers&&aa.originIdOf("renderer")>C.OriginId.SERVICE?(yield aa.load(),
X=[...yield this._getRendererLegendElements(aa.renderer,{title:aa.title,opacity:a,sublayer:aa}),...X]):(a=yield this._generateSymbolTableElementForSublayer(aa,a,U))&&X.unshift(a);return X.filter(aa=>!!aa&&("infos"in aa?0<aa.infos.length:!0))});return function(a,z,U){return r.apply(this,arguments)}}();ia._generateSymbolTableElementForSublayer=function(){var r=J._asyncToGenerator(function*(a,z,U){if(!U){U=new Map;var W=this.layer,X=a.source;let aa=null;if(X&&("map-layer"!==X.type||X.mapLayerId!==a.id||
X.gdbVersion&&X.gdbVersion!==("gdbVersion"in W&&W.gdbVersion))||a.originIdOf("renderer")>C.OriginId.SERVICE||a.originIdOf("labelingInfo")>C.OriginId.SERVICE||a.originIdOf("labelsVisible")>C.OriginId.SERVICE)X=new w.ExportImageParameters({layer:this.layer}),aa=X.hasDynamicLayers?X.dynamicLayers:null,X.destroy();(yield this._getLegendLayers(aa||`${W.uid}-default`,aa)).forEach(da=>U.set(da.layerId,da))}W=U.get(a.id);return(!W||null!=W&&W.subLayerIds&&W.defaultVisibility)&&a.sublayers?(z=yield this._generateLegendElementsForSublayers(a.sublayers,
z,U),{type:"symbol-table",title:a.title,infos:z}):this._generateSymbolTableElementForLegendLayer(W,a,z)});return function(a,z,U){return r.apply(this,arguments)}}();ia._generateSymbolTableElementForLegendLayer=function(r,a,z){var U;if(!r||!r.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(r,a))return null;var W=null==a?void 0:a.renderer;let X=(null==a?void 0:a.title)||r.layerName;W&&(!a||(null==a?void 0:a.originIdOf("renderer"))>C.OriginId.SERVICE)&&(W=(null==a?void 0:a.title)||this._getRendererTitle(W,
a))&&(X&&"string"!==typeof W&&"title"in W&&(W.title=X),X=W);const aa={type:"symbol-table",title:X,legendType:r.legendType?r.legendType:null,infos:[]},da=a?this._sanitizeLegendForSublayer(r.legend.slice(),a):r.legend;0<(null==(U=r.legendGroups)?void 0:U.length)?r.legendGroups.forEach(la=>{var va;const wa={type:"symbol-table",title:la.heading,legendType:r.legendType?r.legendType:null,infos:this._generateSymbolTableElementInfosForLegendLayer(da.filter(ha=>ha.groupId===la.id),r.layerId,z)};0<(null==(va=
wa.infos)?void 0:va.length)&&aa.infos.push(wa)}):aa.infos=this._generateSymbolTableElementInfosForLegendLayer(da,r.layerId,z);return 0<aa.infos.length?aa:null};ia._generateSymbolTableElementInfosForLegendLayer=function(r,a,z){return r.map(U=>{let W=U.url;if(U.imageData&&0<U.imageData.length)W=`data:image/png;base64,${U.imageData}`;else if(0!==W.indexOf("http"))W=l.addTokenParameter(`${this.layer.url}/${a}/images/${W}`);else return null;return{label:U.label,src:W,opacity:null==z?this.opacity:z,width:U.width,
height:U.height}}).filter(U=>!!U)};ia._isSublayerInScale=function(r){const a=r.minScale||0;r=r.maxScale||0;return 0<a&&a<this.scale||r>this.scale?!1:!0};ia._isLegendLayerInScale=function(r,a){a=a||this.layer;let z=null,U=null,W=!0;!a.minScale&&0!==a.minScale||!a.maxScale&&0!==a.maxScale?(0===r.minScale&&a.tileInfo&&(z=a.tileInfo.lods[0].scale),0===r.maxScale&&a.tileInfo&&(U=a.tileInfo.lods[a.tileInfo.lods.length-1].scale)):(z=Math.min(a.minScale,r.minScale)||a.minScale||r.minScale,U=Math.max(a.maxScale,
r.maxScale));if(0<z&&z<this.scale||U>this.scale)W=!1;return W};ia._sanitizeLegendForSublayer=function(r,a){if("version"in this.layer&&10.1>this.layer.version||0===r.length)return r;a=a.renderer;let z=null,U=null;r.some(W=>W.values)&&r.some((W,X)=>{W.values||(z=X,U=W,U.label||(U.label="others"));return null!=U});a?"unique-value"===a.type?U&&(r.splice(z,1),r.push(U)):"class-breaks"===a.type&&(U&&r.splice(z,1),r.reverse(),U&&r.push(U)):U&&(r.splice(z,1),r.push(U));return r};ia._getRendererLegendElements=
function(){var r=J._asyncToGenerator(function*(a,z={}){var U=this.view;U=ca(a)||ja(a)||pa(a)||na(a)||za(a)||ka(a)?"2d"===U.type||f.isSupportedRenderer3D(a):"raster-stretch"===a.type||"raster-colormap"===a.type||"raster-shaded-relief"===a.type||ma(a)||ya(a)||fa(a)||"vector-field"===a.type||"flow"===a.type;return U?ma(a)||ya(a)||fa(a)||"esri.renderers.PointCloudRGBRenderer"===a.declaredClass?this._constructPointCloudRendererLegendElements(a,z):za(a)?this._constructDotDensityRendererLegendElements(a):
ka(a)?this._constructPieChartRendererLegendElements(a):this._constructRendererLegendElements(a,z):(ta.warn(`Renderer of type '${a.type}' not supported!`),[])});return function(a){return r.apply(this,arguments)}}();ia._getPointCloudRendererTitle=function(r){return r.legendOptions&&r.legendOptions.title||r.field};ia._constructPointCloudRendererLegendElements=function(r,a={}){a=a.title;const z=[];let U=null;var W=null;if(ma(r))U={type:"symbol-table",title:a||this._getPointCloudRendererTitle(r),infos:[]},
r.colorClassBreakInfos.forEach(X=>{U.infos.unshift({label:X.label||X.minValue+" - "+X.maxValue,value:[X.minValue,X.maxValue],symbol:this._getAppliedCloneSymbol(Ia,X.color)})});else if(ya(r)){W=r.stops;let X=null;if(W.length&&(1===W.length&&(X=W[0].color),!X)){const aa=W[0].value,da=W[W.length-1].value;null!=aa&&null!=da&&(X=v.getColorFromPointCloudStops(aa+(da-aa)/2,W))}U={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(Ia,X||Ia.color)}]};W=v.getRampStopsForPointCloud(r.stops);
W={type:"color-ramp",title:a||this._getPointCloudRendererTitle(r),infos:W,preview:G.renderColorRampPreviewHTML(W.map(aa=>aa.color))}}else fa(r)&&(U={type:"symbol-table",title:a||this._getPointCloudRendererTitle(r),infos:[]},r.colorUniqueValueInfos.forEach(X=>{U.infos.push({label:X.label||X.values.join(", "),value:X.values.join(", "),symbol:this._getAppliedCloneSymbol(Ia,X.color)})}));U&&U.infos.length&&z.push(U);W&&W.infos.length&&z.push(W);a=z.reduce((X,aa)=>X.concat(aa.infos),[]).filter(X=>!!X.symbol).map(X=>
this._getSymbolPreview(X,this.opacity,{symbolConfig:{applyColorModulation:!!r.colorModulation}}));return n.eachAlways(a).then(()=>z)};ia._getElementInfoForDotDensity=function(r,a){const {backgroundColor:z,outline:U,dotSize:W}=r;var X=this.effectList;X=null==X?void 0:X.effects.map(da=>da.toJSON());X=m.effectFunctionsFromJSON(X);X=W+"-"+a+"-"+z+"-"+(U&&JSON.stringify(U.toJSON()))+"-"+X;const aa=this._dotDensityUrlCache;r=aa.has(X)?aa.get(X):G.renderDotDensityPreviewHTML(r,a);aa.set(X,r);a=V.renderSymbol([[{shape:{type:"image",
x:0,y:0,width:r.width,height:r.height,src:r.src},fill:null,stroke:null,offset:[0,0]}]],[r.width,r.height],{effectView:this.effectList});return{opacity:1,src:r.src,preview:a,width:r.width,height:r.height}};ia._constructDotDensityRendererLegendElements=function(r){const a=r.calculateDotValue(this.view.scale),z={type:"symbol-table",title:{value:a&&Math.round(a),unit:r.legendOptions&&r.legendOptions.unit||""},infos:[]};r.attributes.forEach(U=>{const W=this._getElementInfoForDotDensity(r,U.color);W.label=
U.label||U.valueExpressionTitle||U.field;z.infos.push(W)});return Promise.resolve([z])};ia._constructPieChartRendererLegendElements=function(){var r=J._asyncToGenerator(function*(a){var z,U,W;const X=this.layer.opacity,aa=[],da=a.outline;a.attributes.forEach(wa=>{const ha=new R({color:wa.color,outline:da});aa.push({label:wa.label||wa.valueExpressionTitle||wa.field,symbol:ha})});var la=aa.length?[...aa]:[];null!=(z=a.othersCategory)&&z.color&&0!==(null==(U=a.othersCategory)?void 0:U.threshold)&&(z=
new R({color:a.othersCategory.color,outline:da}),aa.push({label:a.othersCategory.label||"Others",symbol:z}));null!=(W=a.defaultColor)&&W.a&&(W=new R({color:a.defaultColor,outline:da}),aa.push({label:a.defaultLabel,symbol:W}));W=(yield this._getVisualVariableLegendElements(a,this.layer))||[];if(aa.length){var va;W.unshift({type:"symbol-table",title:null,infos:aa});la=la.filter(wa=>"Others"!==wa.label).map(wa=>wa.symbol.color).filter(Boolean);la=G.renderPieChartPreviewHTML(la,{holePercentage:a.holePercentage,
backgroundColor:null==(va=a.backgroundFillSymbol)?void 0:va.color,effectList:this.effectList,outline:da});W.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(a,this.layer),infos:aa,preview:la})}a=W.reduce((wa,ha)=>wa.concat(this._getAllInfos(ha)),[]).filter(wa=>!(null==wa||!wa.symbol)&&!(null!=wa&&wa.preview)).map(wa=>this._getSymbolPreview(wa,X,{effectList:this.effectList}));yield n.eachAlways(a);return W});return function(a){return r.apply(this,arguments)}}();ia._constructRendererLegendElements=
function(){var r=J._asyncToGenerator(function*(a,z={}){const {title:U,sublayer:W}=z,X=W||this.layer;a=yield this._loadRenderer(a);this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._scaleDrivenSizeVariable=null;const aa=(yield this._getVisualVariableLegendElements(a,X))||[],da={type:"symbol-table",title:U||this._getRendererTitle(a,X),infos:[]};let la=null,va=!1;const wa=new Set;if("flow"!==a.type||this._hasSizeRamp)if(sa(a)){var ha=U,oa=Ba(a)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",
Aa=aa.findIndex(ra=>"color-ramp"===ra.type);Aa=-1!==Aa?aa.splice(Aa,1)[0]:null;var xa=aa.findIndex(ra=>"size-ramp"===ra.type);xa=-1!==xa?aa.splice(xa,1)[0]:null;var Ca=[];Aa&&(ha=Aa.title,Ca.push(Aa));xa&&(ha=xa.title,Ca.push(xa));0<Ca.length&&aa.push({type:oa,title:ha,infos:Ca})}else if(na(a))ha=I.getHeatmapRampStops(a),aa.push({type:"heatmap-ramp",title:U||(null==(xa=a.legendOptions)?void 0:xa.title),infos:ha,preview:G.renderColorRampPreviewHTML(ha.map(ra=>ra.color),{effectList:this.effectList})});
else if(pa(a)){if((oa=a&&a.authoringInfo)&&"relationship"===oa.type){const {focus:ra,numClasses:Da,field1:La,field2:Ma}=oa;if(Da&&La&&Ma){Aa=[La,Ma];oa=Y.getRotationAngleForFocus(ra)||0;for(ha of Aa){const {field:Qa,normalizationField:Na,label:Ra}=ha;Aa=Ra||{field:this._getFieldAlias(Qa,X),normField:Na&&this._getFieldAlias(Na,X)};xa=Pa.clone();xa.angle=oa;da.infos.push({label:Aa,symbol:xa});wa.add(xa);oa+=90}ha=Y.getRelationshipRampElement({focus:ra,numClasses:Da,infos:a.uniqueValueInfos});aa.unshift(ha)}}else{const ra=
a.field;a.uniqueValueInfos.forEach(Da=>{Da.symbol&&da.infos.push({label:Da.label||this._getDomainName(ra,Da.value,X)||Da.value,value:Da.value,symbol:Da.symbol})})}a.defaultSymbol&&(da.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),va=!0)}else if(ja(a))la=this._isUnclassedRenderer(a),la&&this._hasSizeRamp||(a.classBreakInfos.forEach(ra=>{ra.symbol&&da.infos.unshift({label:ra.label||(la?null:ra.minValue+" - "+ra.maxValue),value:[ra.minValue,ra.maxValue],symbol:ra.symbol})}),la&&
(da.title=null),this._updateInfosforClassedSizeRenderer(a,da.infos)),a.defaultSymbol&&!la&&(da.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),va=!0);else if("raster-stretch"===a.type)if("esri.layers.ImageryTileLayer"===this.layer.declaredClass||"esri.layers.WCSLayer"===this.layer.declaredClass)ha=this._constructTileImageryStretchRendererElements(a),"stretch-ramp"===ha.type?aa.push(ha):da.infos=ha;else{ha=this.layer;a.statistics&&a.statistics.length&&(oa=null!=a.statistics[0].min?
a.statistics[0].min:a.statistics[0][0],Aa=null!=a.statistics[0].max?a.statistics[0].max:a.statistics[0][1]);xa=[];xa=h.unwrap(ha.renderingRule?yield ha.generateRasterInfo(ha.renderingRule):ha.serviceRasterInfo);const ra=xa.keyProperties.BandProperties;Ca=Ka[ha.rasterInfo.pixelType.toLowerCase()];1===xa.bandCount?(oa=null!=oa?oa:xa.statistics?xa.statistics[ha.bandIds[0]].min:Ca[0],Aa=null!=Aa?Aa:xa.statistics?xa.statistics[ha.bandIds[0]].max:Ca[1],oa||Aa?aa.push(this._getStretchLegendElements(a,{min:oa,
max:Aa})):this._getServerSideLegend()):ha.bandIds&&1===ha.bandIds.length?(oa=null!=oa?oa:xa.statistics?xa.statistics[ha.bandIds[0]].min:Ca[0],Aa=null!=Aa?Aa:xa.statistics?xa.statistics[ha.bandIds[0]].max:Ca[1],oa||Aa?aa.push(this._getStretchLegendElements(a,{min:oa,max:Aa})):this._getServerSideLegend()):3<=xa.bandCount?ra&&ra.length>=xa.bandCount?ha.bandIds&&3===ha.bandIds.length?(xa=ha.bandIds.map(Da=>ra[Da].BandName),da.infos=this._createSymbolTableElementMultiBand(xa)):"lerc"===ha.format?(xa=[0,
1,2].map(Da=>ra[Da].BandName),da.infos=this._createSymbolTableElementMultiBand(xa)):this._getServerSideLegend():"lerc"===ha.format?(xa=["band1","band2","band3"],da.infos=this._createSymbolTableElementMultiBand(xa)):this._getServerSideLegend():this._getServerSideLegend()}else if("raster-colormap"===a.type)a.colormapInfos.forEach(ra=>{da.infos.push({label:ra.label,value:ra.value,symbol:this._getAppliedCloneSymbol(Oa,ra.color)})});else if(ca(a)){ha=a.symbol;switch(z.geometryType){case "point":ha="pointSymbol"in
X&&X.pointSymbol;break;case "polyline":ha="lineSymbol"in X&&X.lineSymbol;break;case "polygon":ha="polygonSymbol"in X&&X.polygonSymbol}a.symbol&&!this._hasSizeRamp&&da.infos.push({label:a.label,symbol:ha})}else"vector-field"===a.type?(a.outputUnit&&(this.title="("+a.toJSON().outputUnit+")"),da.title=a.attributeField,ha=a.getClassBreakInfos(),null!=ha&&ha.length?ha.forEach(ra=>{da.infos.push({label:ra.minValue+" - "+ra.maxValue,symbol:ra.symbol})}):da.infos.push({label:a.attributeField,symbol:a.getDefaultSymbol()})):
"raster-shaded-relief"===a.type&&aa.push(this._getStretchLegendElements(a,{min:0,max:255}));else ha=yield ba.getSymbolForFlowRenderer(a),da.infos.push({label:null,symbol:ha});const Ga=a.defaultSymbol;!Ga||va||ca(a)||la&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||aa.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:Ga}]});da.infos.length&&aa.unshift(da);const Sa=null==z.opacity?this.opacity:z.opacity,Ta=this._isTallSymbol("visualVariables"in a&&a.visualVariables),
Ua="esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass;z=aa.reduce((ra,Da)=>ra.concat(this._getAllInfos(Da)),[]).filter(ra=>!(null==ra||!ra.symbol)).map(ra=>this._getSymbolPreview(ra,Sa,{isDefault:ra.symbol===Ga,applyScaleDrivenSize:!wa.has(ra.symbol),symbolConfig:{isTall:Ta,isSquareFill:Ua},effectList:wa.has(ra.symbol)?null:this.effectList}));a=null;yield n.eachAlways(z);return aa});return function(a){return r.apply(this,arguments)}}();
ia._getServerSideLegend=function(){setTimeout(()=>this.buildLegendElementsForTools(),0)};ia._getAllInfos=function(r){const a=null==r?void 0:r.infos;return a?a.reduce((z,U)=>z.concat(this._getAllInfos(U)),[]):[r]};ia._constructTileImageryStretchRendererElements=function(r){function a(va){var wa;const ha=(null!=W&&null!=(wa=W.bandIds)&&wa.length?W.bandIds:Array.from(Array(Math.min(X.bandCount,3)).keys())).map(oa=>va&&va[oa]&&va[oa].BandName||"band"+(oa+1));3>ha.length?ha.push(ha[1]):3<ha.length&&ha.splice(3);
return ha}var z,U;const W=this.layer,X=W.rasterInfo,aa=X.bandCount||r.statistics.length;var da,la=[];la=X.keyProperties&&X.keyProperties.BandProperties;(da=null!=r&&null!=(z=r.statistics)&&z.length?r.statistics:null==X?void 0:X.statistics)?(z=void 0!==da[0].min?da[0].min:da[0][0],da=da[0].max||da[0][1]):(da=Ka[W.rasterInfo.pixelType.toLowerCase()],z=da[0],da=da[1]);W.hasStandardTime()&&(z=W.getStandardTimeValue(z),da=W.getStandardTimeValue(da));if(1===X.bandCount||1===(null==(U=W.bandIds)?void 0:
U.length))return this._getStretchLegendElements(r,{min:z,max:da});la=la&&la.length>=aa?a(la):a();return this._createSymbolTableElementMultiBand(la)};ia._getStretchLegendElements=function(r,a){r=v.getStrectchRampStops(r.colorRamp,a);return{type:"stretch-ramp",title:"",infos:r,preview:G.renderColorRampPreviewHTML(r.map(z=>z.color))}};ia._getSizeLegendElement=function(){var r=J._asyncToGenerator(function*(a,z,U,W){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(z):a,
infos:yield ea.getRampStops(U,z,yield ba.getMedianColor(U),this.scale,this.view.type,W)}});return function(a,z,U,W){return r.apply(this,arguments)}}();ia._createSymbolTableElementMultiBand=function(r){const a=[],z=["red","green","blue"];r.forEach((U,W)=>{var X;a.push({label:{colorName:z[W],bandName:U},src:ba.RGB_IMG_SOURCE[W],opacity:null!=(X=this.opacity)?X:1})});return a};ia._updateInfosforClassedSizeRenderer=function(r,a){const z=r.authoringInfo&&"class-breaks-size"===r.authoringInfo.type,U=r.classBreakInfos.some(W=>
N.isVolumetricSymbol(W.symbol));if(z&&U){const W=ea.REAL_WORLD_MAX_SIZE;r=r.classBreakInfos.length;const X=(W-ea.REAL_WORLD_MIN_SIZE)/(1<r?r-1:r);a.forEach((aa,da)=>{aa.size=W-X*da})}};ia._isTallSymbol=function(r){let a=!1,z=!1;if(r)for(let U=0;U<r.length&&(!a||!z);U++){const W=r[U];"size"===W.type&&("height"===W.axis&&(a=!0),"width-and-depth"===W.axis&&(z=!0))}return a&&z};ia._getSymbolPreview=function(){var r=J._asyncToGenerator(function*(a,z,U){var W=null!=U&&U.isDefault||null!=a.size||!this._hasSizeRamp?
a.size:p.px2pt(k.SymbolSizeDefaults.size);this._scaleDrivenSizeVariable&&null!=U&&U.applyScaleDrivenSize&&({getSize:W}=yield new Promise((X,aa)=>E(["../../../renderers/visualVariables/support/visualVariableUtils"],X,aa)),W=W(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===a.symbol.type?a.symbol.style:null}));return G.renderPreviewHTML(a.symbol,{size:W,opacity:z,scale:!1,symbolConfig:null==U?void 0:U.symbolConfig,effectView:null==U?void 0:U.effectList}).then(X=>
{a.preview=X;return a}).catch(()=>{a.preview=null;return a})});return function(a,z,U){return r.apply(this,arguments)}}();ia._loadRenderer=function(){var r=J._asyncToGenerator(function*(a){var z,U;const W=[];var X=this.layer;a=a.clone();this._hasClusterSizeVariable=!1;const aa="visualVariables"in a&&(null==(z=a.visualVariables)?void 0:z.some(la=>"size"===la.type&&"outline"!==la.target&&!Ea.test(la.valueExpression)));if(a&&"visualVariables"in a&&!aa&&"featureReduction"in X&&"cluster"===(null==(U=X.featureReduction)?
void 0:U.type)&&(z=h.unwrap(e.getClusterSizeVariable(this.layerView._effectiveRenderer,this.view)))){X=X.featureReduction;if("clusterMinSize"in X&&"clusterMaxSize"in X){const {clusterMinSize:la,clusterMaxSize:va}=X;z.legendOptions=new F({showLegend:la!==va})}a.visualVariables=(a.visualVariables||[]).concat([z]);this._hasClusterSizeVariable=!0}const da=yield ba.getMedianColor(a);if(ja(a)||pa(a))X=(a.classBreakInfos||a.uniqueValueInfos).map(la=>this._fetchSymbol(la.symbol,da).then(va=>{la.symbol=va}).catch(()=>
{la.symbol=null})),Array.prototype.push.apply(W,X);W.push(this._fetchSymbol(a.symbol||a.defaultSymbol,a.defaultSymbol?null:da).then(la=>{this._applySymbolToRenderer(a,la,ca(a))}).catch(()=>{this._applySymbolToRenderer(a,null,ca(a))}));return n.eachAlways(W).then(()=>a)});return function(a){return r.apply(this,arguments)}}();ia._applySymbolToRenderer=function(r,a,z){z?r.symbol=a:r.defaultSymbol=a};ia._fetchSymbol=function(){var r=J._asyncToGenerator(function*(a,z){if(!a)throw Error();if("web-style"===
a.type){const U=this._webStyleSymbolCache;try{const W=yield"2d"===this.view.type?a.fetchCIMSymbol({cache:U}):a.fetchSymbol({cache:U});return this._getAppliedCloneSymbol(W,z)}catch{throw ta.warn("Fetching web-style failed!"),Error();}}return this._getAppliedCloneSymbol(a,z)});return function(a,z){return r.apply(this,arguments)}}();ia._getAppliedCloneSymbol=function(r,a){if(!r||!a)return r;r=r.clone();const z=a&&a.toRgba();r.type.includes("3d")?this._applyColorTo3dSymbol(r,z):"cim"===r.type?g.applyCIMSymbolColor(r,
a):r.color&&(r.color=new t(z||r.color));return r};ia._applyColorTo3dSymbol=function(r,a){a&&r.symbolLayers.forEach(z=>{z&&(z.material||(z.material={}),z.material.color=new t(a))})};ia._getVisualVariableLegendElements=function(){var r=J._asyncToGenerator(function*(a,z){var U=this;if(!("visualVariables"in a&&a.visualVariables)||"vector-field"===a.type)return null;var W=a.visualVariables,X=[];const aa=[],da=[];for(const ha of W)"color"===ha.type?X.push(ha):"size"===ha.type?aa.push(ha):"opacity"===ha.type&&
da.push(ha);W=[...X,...aa,...da];let la;if(0===X.length&&ja(a)&&a.classBreakInfos&&1===a.classBreakInfos.length)var va=(va=a.classBreakInfos[0])&&va.symbol;0===X.length&&ca(a)&&(va=a.symbol);va&&(va.type.includes("3d")?(X=va.symbolLayers.getItemAt(0),"water"===X.type?h.isSome(X.color)&&(la=X.color):h.isSome(X.material)&&h.isSome(X.material.color)&&(la=X.material.color)):va.url||(la=va.color));const wa=this.effectList;return(yield Promise.all(W.map(function(){var ha=J._asyncToGenerator(function*(oa){if(!oa.legendOptions||
!1!==oa.legendOptions.showLegend){const xa="flow"===a.type?oa.field:U._getRampTitle(oa,z);let Ca=null;var Aa="getField"in z&&z.getField&&z.getField(oa.field);Aa=Aa&&T.isDateField(Aa);"color"===oa.type?(oa=yield v.getRampStops(oa,null,Aa),Ca={type:"color-ramp",title:xa,infos:oa,preview:G.renderColorRampPreviewHTML(oa.map(Ga=>Ga.color),{effectList:wa})},U._hasColorRamp||(U._hasColorRamp=!(null==Ca.infos||!Ca.infos.length))):"size"===oa.type&&"outline"!==oa.target?Ea.test(oa.valueExpression)?U._hasClusterSizeVariable||
(U._scaleDrivenSizeVariable=oa):(Ca=yield U._getSizeLegendElement(xa,oa,a,Aa),U._hasSizeRamp||(U._hasSizeRamp=!(null==Ca.infos||!Ca.infos.length))):"opacity"===oa.type&&(oa=yield v.getRampStops(oa,la,Aa),Ca={type:"opacity-ramp",title:xa,infos:oa,preview:G.renderColorRampPreviewHTML(oa.map(Ga=>Ga.color),{effectList:wa})},U._hasOpacityRamp||(U._hasOpacityRamp=!(null==Ca.infos||!Ca.infos.length)));return Ca&&Ca.infos?Ca:null}});return function(oa){return ha.apply(this,arguments)}}()))).filter(ha=>!!ha)});
return function(a,z){return r.apply(this,arguments)}}();ia._getDomainName=function(r,a,z){return r&&"function"!==typeof r?(z=(r="getField"in z&&z.getField&&z.getField(r))&&"getFieldDomain"in z&&z.getFieldDomain?z.getFieldDomain(r.name):null)&&"coded-value"===z.type?z.getName(a):null:null};ia._getClusterTitle=function(r){var a=this.layer;r=r.field;if("featureReduction"in a&&a.featureReduction&&"cluster"===a.featureReduction.type&&(a=a.featureReduction,a=(a="popupTemplate"in a&&a.popupTemplate)&&a.fieldInfos))for(const z of a)if(z.fieldName===
r)return"cluster_count"===r?z.label||{showCount:!0}:z.label;return{showCount:!0}};ia._getRampTitle=function(r,a){let z=r.field,U=r.normalizationField,W=!1,X=!1,aa=!1;var da=null;z="function"===typeof z?null:z;U="function"===typeof U?null:U;da=r.legendOptions&&r.legendOptions.title;if(null==da)if(r.valueExpressionTitle)da=r.valueExpressionTitle;else{if("renderer"in a&&a.renderer&&"authoringInfo"in a.renderer&&a.renderer.authoringInfo&&a.renderer.authoringInfo.visualVariables)for(r=a.renderer.authoringInfo.visualVariables,
da=0;da<r.length;da++){const la=r[da];if("color"===la.type){if("ratio"===la.style){W=!0;break}if("percent"===la.style){X=!0;break}if("percent-of-total"===la.style){aa=!0;break}}}da={field:z&&this._getFieldAlias(z,a),normField:U&&this._getFieldAlias(U,a),ratio:W,ratioPercent:X,ratioPercentTotal:aa}}return da};ia._getRendererTitle=function(r,a){if(r.legendOptions&&r.legendOptions.title)return r.legendOptions.title;if(r.valueExpressionTitle)return r.valueExpressionTitle;let z=r.field,U=null,W=null;ja(r)&&
(U=r.normalizationField,W="percent-of-total"===r.normalizationType);z="function"===typeof z?null:z;U="function"===typeof U?null:U;r=null;if(z||U)r={field:z&&this._getFieldAlias(z,a),normField:U&&this._getFieldAlias(U,a),normByPct:W};return r};ia._getFieldAlias=function(r,a){var z="popupTemplate"in a&&a.popupTemplate;z=z&&z.fieldInfos;let U=null;z&&z.some(X=>r===X.fieldName?(U=X,!0):!1);z=null;"getField"in a&&a.getField?z=a.getField(r):"fieldsIndex"in a&&a.fieldsIndex&&(z=a.fieldsIndex.get(r));a=U||
z;let W=null;a&&(W=U&&U.label||z&&z.alias||"name"in a&&a.name||"fieldName"in a&&a.fieldName);return W};ia._isUnclassedRenderer=function(r){const a=r.visualVariables;let z=!1;ja(r)&&r.classBreakInfos&&1===r.classBreakInfos.length&&a&&(z=r.field?a.some(U=>!(!U||r.field!==U.field||(r.normalizationField||U.normalizationField)&&r.normalizationField!==U.normalizationField)):!!a.length);return z};J._createClass(Ja,[{key:"effectList",get:function(){const r=this.layer;let a=null;"effect"in r&&r.effect&&(a=
new c.EffectView,a.effect=r.effect,a.end(),a.scale=this.scale);return a}},{key:"opacity",get:function(){var r;const a=this.layer.opacity,z=null==(r=this.parent)?void 0:r.opacity;r=(r=this.layer.parent)&&"uid"in r?this._getParentLayerOpacity(r):null;return null!=z?z*a:null!=r?r*a:a}},{key:"ready",get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length}},{key:"scale",get:function(){return this.view&&this.view.scale}},{key:"isScaleDriven",
get:function(){const r=this.layer;if(null===r)return!1;if("effect"in r&&r.effect&&Array.isArray(r.effect))return!0;if("featureReduction"in r&&r.featureReduction){if("cluster"===r.featureReduction.type)return!0;if("binning"===r.featureReduction.type&&"renderer"in r.featureReduction&&r.featureReduction.renderer)return this._isRendererScaleDriven(r.featureReduction.renderer)}return"renderer"in r&&r.renderer?this._isRendererScaleDriven(r.renderer):this._isLayerScaleDriven(this.layer)}},{key:"version",
get:function(){return this._get("version")+1}}]);return Ja}(D);K.__decorate([Q.property()],A.prototype,"children",void 0);K.__decorate([Q.property({readOnly:!0})],A.prototype,"effectList",null);K.__decorate([Q.property()],A.prototype,"layerView",void 0);K.__decorate([Q.property()],A.prototype,"layer",void 0);K.__decorate([Q.property()],A.prototype,"legendElements",void 0);K.__decorate([Q.property({readOnly:!0})],A.prototype,"opacity",null);K.__decorate([Q.property()],A.prototype,"parent",void 0);
K.__decorate([Q.property({readOnly:!0,dependsOn:[]})],A.prototype,"ready",null);K.__decorate([Q.property()],A.prototype,"hideLayersNotInCurrentView",void 0);K.__decorate([Q.property()],A.prototype,"keepCacheOnDestroy",void 0);K.__decorate([Q.property()],A.prototype,"respectLayerVisibility",void 0);K.__decorate([Q.property({readOnly:!0})],A.prototype,"scale",null);K.__decorate([Q.property()],A.prototype,"sublayerIds",void 0);K.__decorate([Q.property({readOnly:!0})],A.prototype,"isScaleDriven",null);
K.__decorate([Q.property()],A.prototype,"title",void 0);K.__decorate([Q.property({readOnly:!0,dependsOn:["ready"],value:0})],A.prototype,"version",null);K.__decorate([Q.property()],A.prototype,"view",void 0);return A=K.__decorate([q.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],A)})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),
function(E,J,K,t,l,O,A,D,P,M,H,d){function h(p){p=H.parse(p)||[];var S=(S=p[0])?"type"in S:!1;return S?[{scale:-1,effects:p}]:p}function n(p,S,Q){var B,x,b,q;return null!=(B=p[0])&&B.effects&&null!=(x=S[0])&&x.effects?(-1===(null==(b=p[0])?void 0:b.scale)||-1===(null==(q=S[0])?void 0:q.scale))&&(1<p.length||1<S.length)&&0>=Q?!1:d.canInterpolateEffects(p[0].effects,S[0].effects):!0}function u(p,S,Q){var B,x;const b=p.length>S.length?p:S;p=p.length>S.length?S:p;const q=p[p.length-1];S=null!=(B=null==
q?void 0:q.scale)?B:Q;B=null!=(x=null==q?void 0:q.effects)?x:[];for(x=p.length;x<b.length;x++)p.push({scale:S,effects:[...B]});for(x=0;x<b.length;x++)p[x].scale=-1===p[x].scale?Q:p[x].scale,b[x].scale=-1===b[x].scale?Q:b[x].scale,d.normalizeEffects(p[x].effects,b[x].effects)}E.EffectView=function(p){function S(B){B=p.call(this,B)||this;B._from=null;B._to=null;B._final=null;B._current=[];B._time=0;B.duration=l("mapview-transitions-duration");B.effects=[];return B}J._inheritsLoose(S,p);var Q=S.prototype;
Q.canTransitionTo=function(B){try{return 0<this.scale&&n(this._current,h(B),this.scale)}catch{return!1}};Q.transitionStep=function(B,x){this._applyTimeTransition(B);this._updateForScale(x)};Q.end=function(){this._applyTimeTransition(this.duration)};Q._transitionTo=function(B){0<this.scale&&n(this._current,B,this.scale)?(this._final=B,this._to=O.clone(B),u(this._current,this._to,this.scale),this._from=O.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=B);this._set("effects",
this._current[0]?O.clone(this._current[0].effects):[])};Q._applyTimeTransition=function(B){if(this._to&&this._from&&this._current&&this._final){this._time+=B;B=Math.min(1,this._time/this.duration);for(let b=0;b<this._current.length;b++){const q=this._current[b],C=this._from[b],c=this._to[b];var x=C.scale;q.scale=x+(c.scale-x)*B;for(x=0;x<q.effects.length;x++)q.effects[x].interpolate(C.effects[x],c.effects[x],B)}1===B&&(this._current=this._final,this._set("effects",this._current[0]?O.clone(this._current[0].effects):
[]),this._from=this._to=this._final=null)}};Q._updateForScale=function(B){this._set("scale",B);if(0!==this._current.length){var x=this._current,b=this._current.length-1,q,C=1;if(1===x.length||B>=x[0].scale)var c=q=x[0].effects;else if(B<=x[b].scale)c=q=x[b].effects;else for(let m=0;m<b;m++){const w=x[m],T=x[m+1];if(w.scale>=B&&T.scale<=B){C=(B-w.scale)/(T.scale-w.scale);q=w.effects;c=T.effects;break}}for(B=0;B<this.effects.length;B++)this.effects[B].interpolate(q[B],c[B],C)}};J._createClass(S,[{key:"effect",
set:function(B){const x=this._get("effect");B=B||"";if(x!==B){this._set("effect",B);try{this._transitionTo(h(B))}catch(b){this._transitionTo([]),A.getLogger(this.declaredClass).warn("Invalid Effect",{effect:B,error:b})}}}},{key:"hasEffects",get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(B){this._updateForScale(B)}},{key:"transitioning",get:function(){return null!==this._to}}]);return S}(t);K.__decorate([D.property()],E.EffectView.prototype,"_to",void 0);
K.__decorate([D.property()],E.EffectView.prototype,"duration",void 0);K.__decorate([D.property({value:""})],E.EffectView.prototype,"effect",null);K.__decorate([D.property({readOnly:!0})],E.EffectView.prototype,"effects",void 0);K.__decorate([D.property({readOnly:!0})],E.EffectView.prototype,"hasEffects",null);K.__decorate([D.property({value:0})],E.EffectView.prototype,"scale",null);K.__decorate([D.property({readOnly:!0})],E.EffectView.prototype,"transitioning",null);E.EffectView=K.__decorate([M.subclass("esri.layers.effects.EffectView")],
E.EffectView);E.canInterpolateEffectStops=n;E.convertEffectToStops=h;E.normalizeEffectStops=u;Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/sql ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./commonProperties ./floorFilterUtils ./sublayerUtils".split(" "),
function(E,J,K,t,l,O,A,D,P,M,H,d,h,n,u){const p={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};E.ExportImageParameters=function(S){function Q(x){x=S.call(this,x)||this;x.floors=null;x.scale=0;return x}J._inheritsLoose(Q,S);var B=Q.prototype;B.destroy=function(){this.layer=null};B.toJSON=
function(){var x=this.layer;x={dpi:x.dpi,format:x.imageFormat,transparent:x.imageTransparency,gdbVersion:x.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?x.dynamicLayers=this.dynamicLayers:x={...x,layers:this.layers,layerDefs:this.layerDefs};return x};J._createClass(Q,[{key:"dynamicLayers",get:function(){if(!this.hasDynamicLayers)return null;const x=this.visibleSublayers.map(b=>{const q=n.getLayerFloorFilterClause(this.floors,b);return b.toExportImageJSON(q)});return x.length?JSON.stringify(x):
null}},{key:"hasDynamicLayers",get:function(){return this.layer&&u.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}},{key:"layer",set:function(x){this._get("layer")!==x&&(this._set("layer",x),this.handles.remove("layer"),x&&this.handles.add([x.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),x.on("sublayer-update",b=>this.notifyChange(p[b.propertyName]))],"layer"))}},{key:"layers",get:function(){const x=this.visibleSublayers;return x?x.length?
"show:"+x.map(b=>b.id).join(","):"show:-1":null}},{key:"layerDefs",get:function(){var x;const b=!(null==(x=this.floors)||!x.length);x=this.visibleSublayers.filter(q=>null!=q.definitionExpression||b&&null!=q.floorInfo);return x.length?JSON.stringify(x.reduce((q,C)=>{var c=n.getLayerFloorFilterClause(this.floors,C);c=A.sqlAnd(c,C.definitionExpression);O.isSome(c)&&(q[C.id]=c);return q},{})):null}},{key:"version",get:function(){this.commitProperty("layers");this.commitProperty("layerDefs");this.commitProperty("dynamicLayers");
this.commitProperty("timeExtent");const x=this.layer;x&&(x.commitProperty("dpi"),x.commitProperty("imageFormat"),x.commitProperty("imageTransparency"),x.commitProperty("gdbVersion"));return(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){const x=[];if(!this.layer)return x;var b=this.layer.sublayers;const q=C=>{const c=this.scale,m=0===C.minScale||c<=C.minScale,w=0===C.maxScale||c>=C.maxScale;C.visible&&(0===c||m&&w)&&(C.sublayers?C.sublayers.forEach(q):x.unshift(C))};b&&b.forEach(q);
b=this._get("visibleSublayers");return!b||b.length!==x.length||b.some((C,c)=>x[c]!==C)?x:b}}]);return Q}(l.HandleOwnerMixin(t));K.__decorate([D.property({readOnly:!0})],E.ExportImageParameters.prototype,"dynamicLayers",null);K.__decorate([D.property()],E.ExportImageParameters.prototype,"floors",void 0);K.__decorate([D.property({readOnly:!0})],E.ExportImageParameters.prototype,"hasDynamicLayers",null);K.__decorate([D.property()],E.ExportImageParameters.prototype,"layer",null);K.__decorate([D.property({readOnly:!0})],
E.ExportImageParameters.prototype,"layers",null);K.__decorate([D.property({readOnly:!0})],E.ExportImageParameters.prototype,"layerDefs",null);K.__decorate([D.property({type:Number})],E.ExportImageParameters.prototype,"scale",void 0);K.__decorate([D.property(h.combinedViewLayerTimeExtentProperty)],E.ExportImageParameters.prototype,"timeExtent",void 0);K.__decorate([D.property({readOnly:!0})],E.ExportImageParameters.prototype,"version",null);K.__decorate([D.property({readOnly:!0})],E.ExportImageParameters.prototype,
"visibleSublayers",null);E.ExportImageParameters=K.__decorate([d.subclass("esri.layers.mixins.ExportImageParameters")],E.ExportImageParameters);Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(E){function J(K,t){if(null==K||!K.length)return null;K=K.filter(l=>""!==l).map(l=>`'${l}'`);K.push("''");return`${t} IN (${K.join(",")}) OR ${t} IS NULL`}E.getFloorFilterClause=function(K){var t;
const l=K.layer;return"floorInfo"in l&&null!=(t=l.floorInfo)&&t.floorField&&"floors"in K.view?J(K.view.floors,l.floorInfo.floorField):null};E.getLayerFloorFilterClause=function(K,t){var l;return"floorInfo"in t&&null!=(l=t.floorInfo)&&l.floorField?J(K,t.floorInfo.floorField):null};Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/sublayerUtils":function(){define(["exports","../../core/maybe","../../core/accessorSupport/PropertyOrigin"],
function(E,J,K){function t(l,O){if(!l||!l.length||J.isNone(O))return!0;O=O.slice().reverse().flatten(({sublayers:P})=>P&&P.toArray().reverse()).map(P=>P.id).toArray();if(l.length>O.length)return!1;let A=0;const D=O.length;for(const {id:P}of l){for(;A<D&&O[A]!==P;)A++;if(A>=D)return!1}return!0}E.isExportDynamic=function(l,O,A){return l.some(D=>{const P=D.source;return!(!P||"map-layer"===P.type&&P.mapLayerId===D.id&&(J.isNone(P.gdbVersion)||P.gdbVersion===A))||D.originIdOf("renderer")>K.OriginId.SERVICE||
D.originIdOf("labelingInfo")>K.OriginId.SERVICE||D.originIdOf("opacity")>K.OriginId.SERVICE||D.originIdOf("labelsVisible")>K.OriginId.SERVICE})?!0:!t(l,O)};E.isSublayerOverhaul=function(l){return!!l&&l.some(O=>null!=O.minScale||O.layerDefinition&&null!=O.layerDefinition.minScale)};E.shouldWriteSublayerStructure=function(l,O,A){return O.flatten(({sublayers:D})=>D).length!==l.length||l.some(D=>D.originIdOf("minScale")>A||D.originIdOf("maxScale")>A||D.originIdOf("renderer")>A||D.originIdOf("labelingInfo")>
A||D.originIdOf("opacity")>A||D.originIdOf("labelsVisible")>A||D.originIdOf("source")>A)?!0:!t(l,O)};Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/renderers/support/rendererConversion":function(){define(["exports","../../core/has","../../core/Error","../../core/maybe","../../symbols/support/symbolConversion"],function(E,J,K,t,l){function O(M){return t.isNone(M)||"simple"===M.type||"unique-value"===M.type||"class-breaks"===M.type||"dictionary"===
M.type||"heatmap"===M.type}function A(M,H){if(!H)return null;H=Array.isArray(H)?H:[H];if(0<H.length){const d=H.map(n=>n.details.symbol.type||n.details.symbol.declaredClass).filter(n=>!!n);d.sort();const h=[];d.forEach((n,u)=>{0!==u&&n===d[u-1]||h.push(n)});return new K("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${h.join(", ")}) which are not supported in 3D`,{renderer:M,symbolErrors:H})}return null}function D(M){const H=M.uniqueValueInfos.map(h=>l.to3D(h.symbol).error).filter(h=>
!!h),d=l.to3D(M.defaultSymbol);d.error&&H.unshift(d.error);return A(M,H)}function P(M){const H=M.classBreakInfos.map(h=>l.to3D(h.symbol).error).filter(h=>!!h),d=l.to3D(M.defaultSymbol);d.error&&H.unshift(d.error);return A(M,H)}E.isSupportedRenderer3D=O;E.validateTo3D=function(M){if(t.isNone(M))return null;if(!O(M))return new K("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${M.type||M.declaredClass}'`,{renderer:M});switch(M.type){case "simple":return A(M,l.to3D(M.symbol).error);
case "unique-value":return D(M);case "class-breaks":return P(M)}return null};Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(E,J,K){function t(d){d=K.toCIMSymbolJSON(d);if("CIMTextSymbol"===d.type)return d.height;let h=0;if(d.symbolLayers)for(const n of d.symbolLayers)K.isCIMMarker(n)&&n.size>h?h=n.size:K.isCIMStroke(n)&&n.width>h?h=n.width:K.isCIMFill(n);
return h}function l(d,h,n,u){if("CIMTextSymbol"===d.type)d.height*=h;else{if(n&&d.effects)for(const p of d.effects)D(p,h);if(d.symbolLayers)for(const p of d.symbolLayers)switch(p.type){case "CIMPictureMarker":case "CIMVectorMarker":O(p,h,u);break;case "CIMPictureStroke":case "CIMSolidStroke":null!=u&&u.preserveOutlineWidth||!p.width||(p.width*=h);break;case "CIMPictureFill":p.height&&(p.height*=h);p.offsetX&&(p.offsetX*=h);p.offsetY&&(p.offsetY*=h);break;case "CIMHatchFill":l(p.lineSymbol,h,!0,{...u,
preserveOutlineWidth:!1}),p.offsetX&&(p.offsetX*=h),p.offsetY&&(p.offsetY*=h),p.separation&&(p.separation*=h)}}}function O(d,h,n){d.markerPlacement&&A(d.markerPlacement,h);d.offsetX&&(d.offsetX*=h);d.offsetY&&(d.offsetY*=h);d.anchorPoint&&"Absolute"===d.anchorPointUnits&&(d.anchorPoint={x:d.anchorPoint.x*h,y:d.anchorPoint.y*h});d.size*=h;if("CIMVectorMarker"===d.type&&d.markerGraphics)for(const u of d.markerGraphics)d.scaleSymbolsProportionally||l(u.symbol,h,!0,n)}function A(d,h){K.isCIMMarkerStrokePlacement(d)&&
d.offset&&(d.offset*=h);switch(d.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":d.customEndingOffset&&(d.customEndingOffset*=h);d.offsetAlongLine&&(d.offsetAlongLine*=h);if(d.placementTemplate&&d.placementTemplate.length){var n=d.placementTemplate.map(u=>u*h);d.placementTemplate=n}break;case "CIMMarkerPlacementAlongLineVariableSize":d.maxRandomOffset&&(d.maxRandomOffset*=h);d.placementTemplate&&d.placementTemplate.length&&(n=d.placementTemplate.map(u=>
u*h),d.placementTemplate=n);break;case "CIMMarkerPlacementOnLine":d.startPointOffset&&(d.startPointOffset*=h);break;case "CIMMarkerPlacementAtExtremities":d.offsetAlongLine&&(d.offsetAlongLine*=h);break;case "CIMMarkerPlacementAtRatioPositions":d.beginPosition&&(d.beginPosition*=h);d.endPosition&&(d.endPosition*=h);break;case "CIMMarkerPlacementPolygonCenter":d.offsetX&&(d.offsetX*=h);d.offsetY&&(d.offsetY*=h);break;case "CIMMarkerPlacementInsidePolygon":d.offsetX&&(d.offsetX*=h),d.offsetY&&(d.offsetY*=
h),d.stepX&&(d.stepX*=h),d.stepY&&(d.stepY*=h)}}function D(d,h){switch(d.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":d.width&&(d.width*=h);break;case "CIMGeometricEffectBuffer":d.size&&(d.size*=h);break;case "CIMGeometricEffectCut":d.beginCut&&(d.beginCut*=h);d.endCut&&(d.endCut*=h);d.middleCut&&(d.middleCut*=h);break;case "CIMGeometricEffectDashes":d.customEndingOffset&&(d.customEndingOffset*=h);d.offsetAlongLine&&(d.offsetAlongLine*=h);if(d.dashTemplate&&d.dashTemplate.length){const n=
d.dashTemplate.map(u=>u*h);d.dashTemplate=n}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":d.length&&(d.length*=h);break;case "CIMGeometricEffectMove":d.offsetX&&(d.offsetX*=h);d.offsetY&&(d.offsetY*=h);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":d.offset&&(d.offset*=h);break;case "CIMGeometricEffectRegularPolygon":d.radius&&(d.radius*=h);break;case "CIMGeometricEffectTaperedPolygon":d.fromWidth&&(d.fromWidth*=
h);d.length&&(d.length*=h);d.toWidth&&(d.toWidth*=h);break;case "CIMGeometricEffectWave":d.amplitude&&(d.amplitude*=h),d.period&&(d.period*=h)}}function P(d,h){let n;n="CIMTextSymbol"===d.type?d.symbol:d;d="CIMPolygonSymbol"===d.type;if(n.symbolLayers)for(const u of n.symbolLayers)if(!(u.colorLocked||d&&(K.isCIMStroke(u)||K.isCIMMarker(u)&&u.markerPlacement&&K.isCIMMarkerStrokePlacement(u.markerPlacement))))switch(u.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":u.tintColor&&
M(h,u.tintColor);break;case "CIMVectorMarker":u.markerGraphics.forEach(p=>{P(p.symbol,h)});break;case "CIMSolidStroke":case "CIMSolidFill":M(h,u.color);break;case "CIMHatchFill":P(u.lineSymbol,h)}}function M(d,h){for(const n of d)if(n.join(".")===h.join("."))return;d.push(h)}function H(d,h,n){var u="CIMTextSymbol"===d.type?d.symbol:d;d="CIMPolygonSymbol"===u.type?!0:!1;if(u.symbolLayers)for(const p of u.symbolLayers)if(!p.colorLocked){if(d)if(n){if({layersToColor:u}=n,(K.isCIMStroke(p)||K.isCIMMarker(p)&&
p.markerPlacement&&K.isCIMMarkerStrokePlacement(p.markerPlacement))&&"fill"===u||K.isCIMFill(p)&&"outline"===u)continue}else if(K.isCIMStroke(p)||K.isCIMMarker(p)&&p.markerPlacement&&K.isCIMMarkerStrokePlacement(p.markerPlacement))continue;u=h.toArray();switch(p.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":p.tintColor=u;break;case "CIMVectorMarker":p.markerGraphics.forEach(S=>{H(S.symbol,h,n)});break;case "CIMSolidStroke":case "CIMSolidFill":p.color=u;break;case "CIMHatchFill":H(p.lineSymbol,
h,n)}}}E.applyCIMSymbolColor=function(d,h,n){h instanceof J||(h=new J(h));(d=K.toCIMSymbolJSON(d))&&H(d,h,n)};E.applyCIMSymbolRotation=function(d,h,n=!1){d=K.toCIMSymbolJSON(d);n&&0!==h&&(h=360-h);if("CIMTextSymbol"===d.type)d.angle=h;else if("CIMPointSymbol"===d.type&&d.symbolLayers){n=h-(d.angle||0);for(const u of d.symbolLayers)if(K.isCIMMarker(u)){let p=u.rotation||0;p=u.rotateClockwise?p-n:p+n;u.rotation=p}d.angle=h}};E.getCIMSymbolColor=function(d){d=K.toCIMSymbolJSON(d);const h=[];P(d,h);return h.length?
new J(K.fromCIMColor(h[0])):null};E.getCIMSymbolRotation=function(d,h=!1){d=K.toCIMSymbolJSON(d);return"CIMTextSymbol"===d.type||"CIMPointSymbol"===d.type?h&&0!==d.angle?360-d.angle:d.angle||0:0};E.getCIMSymbolSize=t;E.scaleCIMMarker=O;E.scaleCIMSymbolTo=function(d,h,n){const u=K.toCIMSymbolJSON(d);d=t(d);if(0===d)if("CIMTextSymbol"===u.type)u.height=h;else{if(u.symbolLayers)for(const p of u.symbolLayers)switch(p.type){case "CIMPictureMarker":case "CIMVectorMarker":p.size=h;break;case "CIMPictureStroke":case "CIMSolidStroke":p.width=
h}}else l(u,h/d,!1,n)};Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(E,J){function K(t,l){"string"!==typeof t&&(t=String(t));switch(l){case "LowerCase":return t.toLowerCase();case "Allcaps":return t.toUpperCase();default:return t}}J._adjustTextCase=K;J.colorToArray=function(t){return[t.r,t.g,t.b,t.a]};J.createLabelOverrideFunction=function(t,l,O){const A=H=>{let d=H.length;for(;d--;)if(!" /-,\n".includes(H.charAt(d)))return!1;
return!0},D=[];var P=0;let M=-1;do M=l.indexOf("[",P),M>=P&&(M>P&&(P=l.substr(P,M-P),D.push([P,null,A(P)])),P=M+1,M=l.indexOf("]",P),M>=P&&(M>P&&(P=l.substr(P,M-P),(P=t[P])&&D.push([null,P,!1])),P=M+1));while(-1!==M);P<l.length-1&&(t=l.substr(P),D.push([t,null,A(t)]));return H=>{let d="",h=null;for(const n of D){const [u,p,S]=n;if(u)S?h=u:(h&&(d+=h,h=null),d+=u);else{const Q=H.attributes[p];Q&&(h&&(d+=h,h=null),d+=Q)}}return K(d,O)}};J.evaluateValueOrFunction=function(t,l,O,A){return"function"===
typeof t?t(l,O,A):t};J.fromCIMColor=function(t){return t?{r:t[0],g:t[1],b:t[2],a:t[3]/255}:{r:0,g:0,b:0,a:0}};J.getValue=t=>isNaN(t)||!t?0:t;J.importGeometryEngine=function(){return new Promise((t,l)=>E(["../../geometry/geometryEngineJSON"],t,l))};J.isCIMFill=function(t){return"CIMGradientFill"===t.type||"CIMHatchFill"===t.type||"CIMPictureFill"===t.type||"CIMSolidFill"===t.type||"CIMWaterFill"===t.type};J.isCIMMarker=function(t){return"CIMVectorMarker"===t.type||"CIMPictureMarker"===t.type||"CIMBarChartMarker"===
t.type||"CIMCharacterMarker"===t.type||"CIMPieChartMarker"===t.type||"CIMStackedBarChartMarker"===t.type};J.isCIMMarkerStrokePlacement=function(t){return"CIMMarkerPlacementAlongLineRandomSize"===t.type||"CIMMarkerPlacementAlongLineSameSize"===t.type||"CIMMarkerPlacementAlongLineVariableSize"===t.type||"CIMMarkerPlacementAtExtremities"===t.type||"CIMMarkerPlacementAtMeasuredUnits"===t.type||"CIMMarkerPlacementAtRatioPositions"===t.type||"CIMMarkerPlacementOnLine"===t.type||"CIMMarkerPlacementOnVertices"===
t.type};J.isCIMStroke=function(t){return"CIMGradientStroke"===t.type||"CIMPictureStroke"===t.type||"CIMSolidStroke"===t.type};J.isGeometryEngineRequired=t=>{if(!t)return!1;for(const l of t)switch(l.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":return!0}return!1};J.resampleHermite=function(t,l,O,A,D,P,M=!0){const H=l/D;O/=P;const d=Math.ceil(H/2),h=Math.ceil(O/2);for(let p=0;p<P;p++)for(let S=0;S<D;S++){const Q=4*(S+(M?P-p-1:p)*D);var n=0;let B=0,x=0,b=0,q=0,C=0,c=0;const m=
(p+.5)*O;for(let w=Math.floor(p*O);w<(p+1)*O;w++){var u=Math.abs(m-(w+.5))/h;const T=(S+.5)*H;u*=u;for(let y=Math.floor(S*H);y<(S+1)*H;y++){let f=Math.abs(T-(y+.5))/d;n=Math.sqrt(u+f*f);-1<=n&&1>=n&&(n=2*n*n*n-3*n*n+1,0<n&&(f=4*(y+w*l),c+=n*t[f+3],x+=n,255>t[f+3]&&(n=n*t[f+3]/250),b+=n*t[f],q+=n*t[f+1],C+=n*t[f+2],B+=n))}}A[Q]=b/B;A[Q+1]=q/B;A[Q+2]=C/B;A[Q+3]=c/x}};J.toCIMSymbolJSON=function(t){var l;return null==(l=t.data)?void 0:l.symbol};Object.defineProperties(J,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(E,J){function K(t,l){return Math.round(Math.min(Math.max(t+191.25*l,0),255))}E.SymbolSizeDefaults=void 0;(function(t){t[t.size=22]="size";t[t.lineWidth=50]="lineWidth";t[t.maxSize=120]="maxSize";t[t.maxOutlineSize=80]="maxOutlineSize";t[t.tallSymbolWidth=20]="tallSymbolWidth"})(E.SymbolSizeDefaults||(E.SymbolSizeDefaults={}));E.adjustColorBrightness=function(t,l){if("type"in t&&("linear"===t.type||"pattern"===
t.type))return t;t=new J(t);return new J([K(t.r,l),K(t.g,l),K(t.b,l),t.a])};E.adjustColorComponentBrightness=K;E.getConeShapes=function(t,l){let O=l?E.SymbolSizeDefaults.tallSymbolWidth:t;l=l?4:6;O=O<=E.SymbolSizeDefaults.size?O-.5*l:O-l;l=.15*O;const A=O;t-=l;return[{type:"ellipse",cx:.5*O,cy:t,rx:.5*O,ry:l},{type:"path",path:[{command:"M",values:[.5*A,0]},{command:"L",values:[A,t]},{command:"L",values:[0,t]},{command:"Z",values:[]}]}]};E.getCubeShapes=function(t,l){let O=l?E.SymbolSizeDefaults.tallSymbolWidth:
t;var A=l?4:6;A=O=O<=E.SymbolSizeDefaults.size?O-.5*A:O-A;l=l?.35*O:.5*O;return[{type:"path",path:[{command:"M",values:[.5*A,0]},{command:"L",values:[A,.5*l]},{command:"L",values:[.5*A,l]},{command:"L",values:[0,.5*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*l]},{command:"L",values:[.5*A,l]},{command:"L",values:[.5*A,t]},{command:"L",values:[0,t-.5*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*A,l]},{command:"L",values:[.5*A,t]},{command:"L",
values:[A,t-.5*l]},{command:"L",values:[A,.5*l]},{command:"Z",values:[]}]}]};E.getCylinderShapes=function(t,l){var O=l?E.SymbolSizeDefaults.tallSymbolWidth:t;l=l?4:6;O=O<=E.SymbolSizeDefaults.size?O-.5*l:O-l;l=.5*O;const A=.15*O;t-=A;return[{type:"ellipse",cx:.5*O,cy:t,rx:l,ry:A},{type:"path",path:[{command:"M",values:[0,A]},{command:"L",values:[0,t]},{command:"L",values:[O,t]},{command:"L",values:[O,A]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*O,cy:A,rx:l,ry:A}]};E.getDiamondShapes=function(t){var l=
t;l=l<E.SymbolSizeDefaults.size?l-2:l-4;const O=Math.floor(t/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*l,0]},{command:"L",values:[l,.5*t-O]},{command:"L",values:[.45*l-O,.5*t+O]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*l,0]},{command:"L",values:[.45*l-O,.5*t+O]},{command:"L",values:[0,.5*t-O]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*t-O]},{command:"L",values:[.45*l-O,.5*t+O]},{command:"L",values:[.45*l,t]},{command:"Z",
values:[]}]},{type:"path",path:[{command:"M",values:[.45*l,t]},{command:"L",values:[l,.5*t-O]},{command:"L",values:[.45*l-O,.5*t+O]},{command:"Z",values:[]}]}]};E.getExtrudeSymbolShapes=function(t){const l=E.SymbolSizeDefaults.size;t*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*l]},{command:"L",values:[.3*l,.7*l]},{command:"L",values:[.3*l,.7*l+t]},{command:"L",values:[0,.7*l+t-.35*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*l,.7*l]},{command:"L",values:[.3*
l,.7*l+t]},{command:"L",values:[l,t]},{command:"L",values:[l,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*l,0]},{command:"L",values:[l,0]},{command:"L",values:[.3*l,.7*l]},{command:"L",values:[0,.35*l]},{command:"Z",values:[]}]}]};E.getInvertedConeShapes=function(t){let l=t;l=l<E.SymbolSizeDefaults.size?l-3:l-6;const O=.15*l,A=l;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[A,0]},{command:"L",values:[.5*A,t-O]},{command:"Z",values:[]}]},{type:"ellipse",
cx:.5*l,cy:0,rx:.5*l,ry:O}]};E.getPathSymbolShapes=function(t,l,O){var A=E.SymbolSizeDefaults.size;let D=A,P=A;1>t?D*=.75:1<t&&(P*=1.25);t=A;l&&O&&(D=P=t=A=0);return[{type:"path",path:[{command:"M",values:[t,0]},{command:"L",values:[O?t:.875*t,0]},{command:"L",values:[O?D-.5*t:0,P-.5*A]},{command:"L",values:[D-.5*t,P-.5*A]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[t,0]},{command:"L",values:[t,l?0:.125*A]},{command:"L",values:[D-.5*t,l?P-.5*A:A]},{command:"L",values:[D-.5*
t,P-.5*A]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[D-.5*t,P-.5*A]},{command:"L",values:[O?D-.5*t:0,P-.5*A]},{command:"L",values:[O?D-.5*t:0,l?P-.5*A:A]},{command:"L",values:[D-.5*t,l?P-.5*A:A]},{command:"Z",values:[]}]}]};E.getTetrahedronShapes=function(t){var l=t;l=l<E.SymbolSizeDefaults.size?l-1:l-2;return[{type:"path",path:[{command:"M",values:[.45*t,0]},{command:"L",values:[t,l]},{command:"L",values:[.45*t,.6*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[.45*t,0]},{command:"L",values:[.45*t,.6*l]},{command:"L",values:[0,l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,l]},{command:"L",values:[.45*t,.6*l]},{command:"L",values:[t,l]},{command:"Z",values:[]}]}]};E.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
E.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],
cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],
tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",
path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),
function(E,J,K,t,l,O,A,D,P,M){function H(h,n,u){return h?K(h,{responseType:"image"}).then(p=>{p=p.data;const S=p.width,Q=p.height,B=S/Q;let x=n;u&&(x=Math.min(x,Math.max(S,Q)));return{image:p,width:1>=B?Math.ceil(x*B):x,height:1>=B?x:Math.ceil(x/B)}}):Promise.reject(new l("renderUtils: imageDataSize","href not provided."))}const d=D.createProjector();E.renderSymbol=function(h,n,u){const p=Math.ceil(n[0]);n=Math.ceil(n[1]);if(!h.some(Q=>!!Q.length))return null;const S=u&&u.node||document.createElement("div");
null!=u.opacity&&(S.style.opacity=u.opacity.toString());null!=u.effectView&&(S.style.filter=M.getCSSFilterFromEffectList(u.effectView));d.append(S,P.renderSVG.bind(null,h,p,n,u));return S};E.tintImageWithColor=function(h,n,u,p,S){return H(h,n,S).then(Q=>{const B=Q.width?Q.width:n,x=Q.height?Q.height:n;var b;if(b=Q.image)b=u&&"ignore"!==p?"multiply"===p&&255===u.r&&255===u.g&&255===u.b&&1===u.a?!1:!0:!1;if(b){var q=Q.image.width,C=Q.image.height;O("edge")&&/\.svg$/i.test(h)&&(--q,--C);b=Math.ceil(B);
var c=Math.ceil(x);var m=document.createElement("canvas");m.width=b;m.height=c;m.style.width=b+"px";m.style.height=c+"px";m=m.getContext("2d");m.clearRect(0,0,b,c);b=m;b.drawImage(Q.image,0,0,q,C,0,0,B,x);c=b.getImageData(0,0,B,x);m=[u.r/255,u.g/255,u.b/255,u.a];const T=t.toHSV(u);for(let y=0;y<c.data.length;y+=4){Q=c.data;q=y;C=m;var w=T;switch(p){case "multiply":Q[q+0]*=C[0];Q[q+1]*=C[1];Q[q+2]*=C[2];Q[q+3]*=C[3];break;default:{const f=t.toHSV({r:Q[q+0],g:Q[q+1],b:Q[q+2]});f.h=w.h;f.s=w.s;f.v=f.v/
100*w.v;w=t.toRGB(f);Q[q+0]=w.r;Q[q+1]=w.g;Q[q+2]=w.b;Q[q+3]*=C[3]}}}b.putImageData(c,0,0);h=b.canvas.toDataURL("image/png")}else(b=J.id&&J.id.findCredential(h))&&b.token&&(Q=h.includes("?")?"\x26":"?",h=`${h}${Q}token=${b.token}`);return{url:h,width:B,height:x}}).catch(()=>({url:h,width:n,height:n}))};Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../chunks/mat2df32 ../../chunks/mat2d ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),
function(E,J,K,t,l,O,A){function D(e,v){e*=G/180;return Math.abs(v*Math.sin(e))+Math.abs(v*Math.cos(e))}function P(e){return e.map(v=>`${v.command} ${v.values.join(" ")}`).join(" ").trim()}function M(e,v,I,Y){if(e){if("circle"===e.type)return A.tsx("circle",{fill:v,"fill-rule":"evenodd",stroke:I.color,"stroke-width":I.width,"stroke-linecap":I.cap,"stroke-linejoin":I.join,"stroke-dasharray":I.dashArray,"stroke-dashoffset":I.dashOffset,"stroke-miterlimit":"4",cx:e.cx,cy:e.cy,r:e.r});if("ellipse"===
e.type)return A.tsx("ellipse",{fill:v,"fill-rule":"evenodd",stroke:I.color,"stroke-width":I.width,"stroke-linecap":I.cap,"stroke-linejoin":I.join,"stroke-dasharray":I.dashArray,"stroke-miterlimit":"4",cx:e.cx,cy:e.cy,rx:e.rx,ry:e.ry});if("rect"===e.type)return A.tsx("rect",{fill:v,"fill-rule":"evenodd",stroke:I.color,"stroke-width":I.width,"stroke-linecap":I.cap,"stroke-linejoin":I.join,"stroke-dasharray":I.dashArray,"stroke-miterlimit":"4",x:e.x,y:e.y,width:e.width,height:e.height});if("image"===
e.type)return A.tsx("image",{href:e.src,x:e.x,y:e.y,width:e.width,height:e.height,preserveAspectRatio:"none"});if("path"===e.type)return e="string"!==typeof e.path?P(e.path):e.path,A.tsx("path",{fill:v,"fill-rule":"evenodd",stroke:I.color,"stroke-width":I.width,"stroke-linecap":I.cap,"stroke-linejoin":I.join,"stroke-dasharray":I.dashArray,"stroke-miterlimit":"4",d:e});if("text"===e.type)return A.tsx("text",{"alignment-baseline":Y.alignBaseline,fill:v,"fill-rule":"evenodd",stroke:I.color,"stroke-width":I.width,
"stroke-linecap":I.cap,"stroke-linejoin":I.join,"stroke-dasharray":I.dashArray,"stroke-miterlimit":"4","text-anchor":Y.align,"text-decoration":Y.decoration,kerning:Y.kerning,rotate:Y.rotate,"text-rendering":y,"font-style":Y.font.style,"font-variant":Y.font.variant,"font-weight":Y.font.weight,"font-size":Y.font.size,"font-family":Y.font.family,x:e.x,y:e.y},e.text)}return null}function H(e){const v={fill:"none",pattern:null,linearGradient:null};if(e)if("type"in e&&"pattern"===e.type){var I=`patternId-${++w}`;
v.fill=`url(#${I})`;v.pattern={id:I,x:e.x,y:e.y,width:e.width,height:e.height,image:{x:0,y:0,width:e.width,height:e.height,href:e.src}}}else"type"in e&&"linear"===e.type?(I=`linearGradientId-${++T}`,v.fill=`url(#${I})`,v.linearGradient={id:I,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stops:e.colors.map(Y=>({offset:Y.offset,color:Y.color&&(new J(Y.color)).toString()}))}):e&&(e=new J(e),v.fill=e.toString());return v}function d(e){const v={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};
if(e&&(null!=e.width&&(v.width=e.width),e.cap&&(v.cap=e.cap),e.join&&(v.join=e.join.toString()),e.color&&(v.color=(new J(e.color)).toString()),e.dashArray&&(v.dashArray=e.dashArray),e.dashArray&&(v.dashOffset=e.dashoffset),e.style)){let Y=null;e.style in V&&(Y=V[e.style]);if(Array.isArray(Y)){Y=Y.slice(0);for(var I=0;I<Y.length;++I)Y[I]*=e.width;if("butt"!==e.cap){for(I=0;I<Y.length;I+=2)Y[I]-=e.width,1>Y[I]&&(Y[I]=1);for(I=1;I<Y.length;I+=2)Y[I]+=e.width}Y=Y.join(",")}v.dashArray=Y}return v}function h(e,
v){const I={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};e&&(I.align=e.align,I.alignBaseline=e.alignBaseline,I.decoration=e.decoration,I.kerning=e.kerning?"auto":"0",I.rotate=e.rotated?"90":"0",I.font.style=v.style||"normal",I.font.variant=v.variant||"normal",I.font.weight=v.weight||"normal",I.font.size=v.size&&v.size.toString()||"10pt",I.font.family=v.family||"serif");return I}function n(e){const {pattern:v,linearGradient:I}=
e;return v?A.tsx("pattern",{id:v.id,patternUnits:"userSpaceOnUse",x:v.x,y:v.y,width:v.width,height:v.height},A.tsx("image",{x:v.image.x,y:v.image.y,width:v.image.width,height:v.image.height,href:v.image.href})):I?(e=I.stops.map((Y,ea)=>A.tsx("stop",{key:`${ea}-stop`,offset:Y.offset,"stop-color":Y.color})),A.tsx("linearGradient",{id:I.id,gradientUnits:"userSpaceOnUse",x1:I.x1,y1:I.y1,x2:I.x2,y2:I.y2},e)):null}function u(e,v){if(!e)return null;const I=[];for(const Y of e){const {shape:ea,fill:ba,stroke:L,
font:R}=Y;e=H(ba);const Z=d(L),ca="text"===ea.type?h(ea,R):null;I.push(M(ea,e.fill,Z,ca))}return A.tsx("mask",{id:v,maskUnits:"userSpaceOnUse"},A.tsx("g",null,I))}function p(e,v,I){return l.translate(e,l.identity(e),[v,I])}function S(e,v,I,Y,ea){l.scale(e,l.identity(e),[v,I]);e[4]=e[4]*v-Y*v+Y;e[5]=e[5]*I-ea*I+ea;return e}function Q(e,v,I,Y){var ea=v%360*Math.PI/180;l.rotate(e,l.identity(e),ea);v=Math.cos(ea);ea=Math.sin(ea);const ba=e[4],L=e[5];e[4]=ba*v-L*ea+Y*ea-I*v+I;e[5]=L*v+ba*ea-I*ea-Y*v+Y;
return e}function B(e,v){g&&"left"in g?(g.left>e&&(g.left=e),g.right<e&&(g.right=e),g.top>v&&(g.top=v),g.bottom<v&&(g.bottom=v)):g={left:e,bottom:v,right:e,top:v}}function x(e){const v=e.args,I=v.length;switch(e.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(e=0;e<I;e+=2)B(v[e],v[e+1]);k.x=v[I-2];k.y=v[I-1];break;case "H":for(e=0;e<I;++e)B(v[e],k.y);k.x=v[I-1];break;case "V":for(e=0;e<I;++e)B(k.x,v[e]);k.y=v[I-1];break;case "m":e=0;"x"in k||(B(k.x=v[0],k.y=v[1]),e=2);for(;e<I;e+=
2)B(k.x+=v[e],k.y+=v[e+1]);break;case "l":case "t":for(e=0;e<I;e+=2)B(k.x+=v[e],k.y+=v[e+1]);break;case "h":for(e=0;e<I;++e)B(k.x+=v[e],k.y);break;case "v":for(e=0;e<I;++e)B(k.x,k.y+=v[e]);break;case "c":for(e=0;e<I;e+=6)B(k.x+v[e],k.y+v[e+1]),B(k.x+v[e+2],k.y+v[e+3]),B(k.x+=v[e+4],k.y+=v[e+5]);break;case "s":case "q":for(e=0;e<I;e+=4)B(k.x+v[e],k.y+v[e+1]),B(k.x+=v[e+2],k.y+=v[e+3]);break;case "A":for(e=0;e<I;e+=7)B(v[e+5],v[e+6]);k.x=v[I-2];k.y=v[I-1];break;case "a":for(e=0;e<I;e+=7)B(k.x+=v[e+
5],k.y+=v[e+6])}}function b(e,v,I){const Y=f[e.toLowerCase()];"number"===typeof Y&&(Y?v.length>=Y&&(e={action:e,args:v.slice(0,v.length-v.length%Y)},I.push(e),x(e)):(e={action:e,args:[]},I.push(e),x(e)))}function q(e){const v={x:0,y:0,width:0,height:0};if("circle"===e.type)v.x=e.cx-e.r,v.y=e.cy-e.r,v.width=2*e.r,v.height=2*e.r;else if("ellipse"===e.type)v.x=e.cx-e.rx,v.y=e.cy-e.ry,v.width=2*e.rx,v.height=2*e.ry;else if("image"===e.type||"rect"===e.type)v.x=e.x,v.y=e.y,v.width=e.width,v.height=e.height;
else if("path"===e.type){{const ea=("string"!==typeof e.path?P(e.path):e.path).match(F),ba=[];g={};k={};if(ea){e="";var I=[],Y=ea.length;for(let L=0;L<Y;++L){const R=ea[L],Z=parseFloat(R);isNaN(Z)?(e&&b(e,I,ba),I=[],e=R):I.push(Z)}b(e,I,ba);e={x:0,y:0,width:0,height:0};g&&"left"in g&&(e.x=g.left,e.y=g.top,e.width=g.right-g.left,e.height=g.bottom-g.top)}else e=null}v.x=e.x;v.y=e.y;v.width=e.width;v.height=e.height}return v}function C(e){const v={x:0,y:0,width:0,height:0};let I=null,Y=Number.NEGATIVE_INFINITY,
ea=Number.NEGATIVE_INFINITY;for(const ba of e)I?(I.x=Math.min(I.x,ba.x),I.y=Math.min(I.y,ba.y),Y=Math.max(Y,ba.x+ba.width),ea=Math.max(ea,ba.y+ba.height)):(I=v,I.x=ba.x,I.y=ba.y,Y=ba.x+ba.width,ea=ba.y+ba.height);I&&(I.width=Y-I.x,I.height=ea-I.y);return I}function c(e,v,I,Y,ea,ba,L,R,Z){var ca=(L&&ba?D(ba,v):v)/2,ja=(L&&ba?D(ba,I):I)/2;Z&&(ca=Z[0],ja=Z[1],ca=(L&&ba?D(ba,ca):ca)/2,ja=(L&&ba?D(ba,ja):ja)/2);const pa=e.width+Y,na=e.height+Y;L=t.create();Z=t.create();var ma=!1;if(ea&&0!==pa&&0!==na){ea=
v!==I?v/I:pa/na;ma=v>I?v:I;let ya=1,fa=1;isNaN(ma)||(1<ea?(ya=ma/pa,fa=ma/ea/na):(fa=ma/na,ya=ma*ea/pa));l.multiply(Z,Z,S(L,ya,fa,ca,ja));ma=!0}ea=e.x+(pa-Y)/2;e=e.y+(na-Y)/2;l.multiply(Z,Z,p(L,ca-ea,ja-e));!ma&&(pa>v||na>I)&&(Y=pa/v>na/I,v=(Y?v:I)/(Y?pa:na),l.multiply(Z,Z,S(L,v,v,ea,e)));ba&&l.multiply(Z,Z,Q(L,ba,ea,e));R&&l.multiply(Z,Z,p(L,R[0],R[1]));return`matrix(${Z[0]},${Z[1]},${Z[2]},${Z[3]},${Z[4]},${Z[5]})`}function m(e,v,I){e=null==e?void 0:e.effects.find(R=>"bloom"===R.type);if(!e)return null;
const {strength:Y,radius:ea}=e;e=0<Y?ea:0;const ba=(Y+e)*v,L=4*Y+1;return A.tsx("filter",{id:`bloom${I}`,x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},A.tsx("feMorphology",{operator:"dilate",radius:(Y+.5*e)*5**(v/100)*(.4+v/100),in:"SourceGraphic",result:"dilate"}),A.tsx("feGaussianBlur",{in:"dilate",stdDeviation:ba/25,result:"blur"}),A.tsx("feGaussianBlur",{in:"blur",stdDeviation:ba/50,result:"intensityBlur"}),A.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},
A.tsx("feFuncR",{type:"linear",slope:L}),A.tsx("feFuncG",{type:"linear",slope:L}),A.tsx("feFuncB",{type:"linear",slope:L})),A.tsx("feMerge",null,A.tsx("feMergeNode",{in:"intensityBlur"}),A.tsx("feMergeNode",{in:"intensityBrightness"}),A.tsx("feGaussianBlur",{stdDeviation:Y/10})))}let w=0,T=0;O=K("android");const y=K("chrome")||O&&4<=O?"auto":"optimizeLegibility",f={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},F=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let g={},k={};const V={solid:"none",
shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},G=Math.PI;let N=1;E.computeBBox=C;E.generateFillAttributes=H;E.generateStrokeAttributes=d;E.generateTextAttributes=h;E.getBoundingBox=q;E.getTransformMatrix=c;E.renderDef=n;E.renderSVG=function(e,v,I,Y={}){const ea=[],ba=[],L=++N,R=m(Y.effectView,v,L);var Z=null;if(R){var ca;Z=null==(ca=Y.effectView)?void 0:ca.effects.find(ma=>
"bloom"===ma.type);Z=(Z.strength?Z.strength+Z.radius/2:0)/3;Z=[Math.max(v+v*Z,10),Math.max(I+I*Z,10)]}for(ca=0;ca<e.length;ca++){var ja=e[ca];const ma=[];var pa=[],na=0;let ya=0,fa=0;for(const za of ja){const {shape:ka,fill:qa,stroke:sa,font:Ba,offset:ta}=za;Y.ignoreStrokeWidth||(na+=sa&&sa.width||0);ja=H(qa);const Ea=d(sa),Fa="text"===ka.type?h(ka,Ba):null;ea.push(n(ja));ma.push(M(ka,ja.fill,Ea,Fa));pa.push(q(ka));ta&&(ya+=ta[0],fa+=ta[1])}pa=c(C(pa),v,I,na,Y.scale,Y.rotation,Y.useRotationSize,[ya,
fa],Z);na=null;Y.masking&&(na=`mask-${ca}`,ea.push(u(Y.masking[ca],na)),na=`url(#${na})`);ba.push(na?A.tsx("g",{mask:na},A.tsx("g",{transform:pa},ma)):A.tsx("g",{transform:pa},ma))}Y.useRotationSize&&Y.rotation&&(v=D(Y.rotation,v),I=D(Y.rotation,I));R&&(v=Z[0],I=Z[1]);return A.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:v,height:I,style:"display: block;"},R,A.tsx("defs",null,ea),R?A.tsx("g",{filter:`url(#bloom${L})`},ba):ba)};E.renderShape=M;Object.defineProperties(E,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/mat2df32":function(){define(["exports"],function(E){function J(){const P=new Float32Array(6);P[0]=1;P[3]=1;return P}function K(P){const M=new Float32Array(6);M[0]=P[0];M[1]=P[1];M[2]=P[2];M[3]=P[3];M[4]=P[4];M[5]=P[5];return M}function t(P,M,H,d,h,n){const u=new Float32Array(6);u[0]=P;u[1]=M;u[2]=H;u[3]=d;u[4]=h;u[5]=n;return u}function l(P,M){return new Float32Array(P,M,6)}function O(P,M,H,d){const h=M[d];M=M[d+1];P[d]=H[0]*h+H[2]*M+H[4];P[d+
1]=H[1]*h+H[3]*M+H[5]}function A(P,M,H,d=0,h=0,n=2){for(h=h||M.length/n;d<h;d++)O(P,M,H,d*n)}const D=Object.freeze(Object.defineProperty({__proto__:null,create:J,clone:K,fromValues:t,createView:l,transform:O,transformMany:A},Symbol.toStringTag,{value:"Module"}));E.clone=K;E.create=J;E.createView=l;E.fromValues=t;E.mat2df32=D;E.transform=O;E.transformMany=A})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(E,J){function K(c,m){c[0]=m[0];c[1]=m[1];c[2]=m[2];c[3]=m[3];c[4]=m[4];
c[5]=m[5];return c}function t(c){c[0]=1;c[1]=0;c[2]=0;c[3]=1;c[4]=0;c[5]=0;return c}function l(c,m,w,T,y,f,F){c[0]=m;c[1]=w;c[2]=T;c[3]=y;c[4]=f;c[5]=F;return c}function O(c,m){const w=m[0],T=m[1],y=m[2],f=m[3],F=m[4];m=m[5];let g=w*f-T*y;if(!g)return null;g=1/g;c[0]=f*g;c[1]=-T*g;c[2]=-y*g;c[3]=w*g;c[4]=(y*m-f*F)*g;c[5]=(T*F-w*m)*g;return c}function A(c){return c[0]*c[3]-c[1]*c[2]}function D(c,m,w){const T=m[0],y=m[1],f=m[2],F=m[3],g=m[4];m=m[5];const k=w[0],V=w[1],G=w[2],N=w[3],e=w[4];w=w[5];c[0]=
T*k+f*V;c[1]=y*k+F*V;c[2]=T*G+f*N;c[3]=y*G+F*N;c[4]=T*e+f*w+g;c[5]=y*e+F*w+m;return c}function P(c,m,w){const T=m[0],y=m[1],f=m[2],F=m[3],g=m[4];m=m[5];const k=Math.sin(w);w=Math.cos(w);c[0]=T*w+f*k;c[1]=y*w+F*k;c[2]=T*-k+f*w;c[3]=y*-k+F*w;c[4]=g;c[5]=m;return c}function M(c,m,w){const T=m[1],y=m[2],f=m[3],F=m[4],g=m[5],k=w[0];w=w[1];c[0]=m[0]*k;c[1]=T*k;c[2]=y*w;c[3]=f*w;c[4]=F;c[5]=g;return c}function H(c,m,w){const T=m[0],y=m[1],f=m[2],F=m[3],g=m[4];m=m[5];const k=w[0];w=w[1];c[0]=T;c[1]=y;c[2]=
f;c[3]=F;c[4]=T*k+f*w+g;c[5]=y*k+F*w+m;return c}function d(c,m){const w=Math.sin(m);m=Math.cos(m);c[0]=m;c[1]=w;c[2]=-w;c[3]=m;c[4]=0;c[5]=0;return c}function h(c,m){c[0]=m[0];c[1]=0;c[2]=0;c[3]=m[1];c[4]=0;c[5]=0;return c}function n(c,m){c[0]=1;c[1]=0;c[2]=0;c[3]=1;c[4]=m[0];c[5]=m[1];return c}function u(c){return"mat2d("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+")"}function p(c){return Math.sqrt(c[0]**2+c[1]**2+c[2]**2+c[3]**2+c[4]**2+c[5]**2+1)}function S(c,m,w){c[0]=m[0]+w[0];c[1]=
m[1]+w[1];c[2]=m[2]+w[2];c[3]=m[3]+w[3];c[4]=m[4]+w[4];c[5]=m[5]+w[5];return c}function Q(c,m,w){c[0]=m[0]-w[0];c[1]=m[1]-w[1];c[2]=m[2]-w[2];c[3]=m[3]-w[3];c[4]=m[4]-w[4];c[5]=m[5]-w[5];return c}function B(c,m,w){c[0]=m[0]*w;c[1]=m[1]*w;c[2]=m[2]*w;c[3]=m[3]*w;c[4]=m[4]*w;c[5]=m[5]*w;return c}function x(c,m,w,T){c[0]=m[0]+w[0]*T;c[1]=m[1]+w[1]*T;c[2]=m[2]+w[2]*T;c[3]=m[3]+w[3]*T;c[4]=m[4]+w[4]*T;c[5]=m[5]+w[5]*T;return c}function b(c,m){return c[0]===m[0]&&c[1]===m[1]&&c[2]===m[2]&&c[3]===m[3]&&
c[4]===m[4]&&c[5]===m[5]}function q(c,m){const w=c[0],T=c[1],y=c[2],f=c[3],F=c[4];c=c[5];const g=m[0],k=m[1],V=m[2],G=m[3],N=m[4];m=m[5];return Math.abs(w-g)<=J.EPSILON*Math.max(1,Math.abs(w),Math.abs(g))&&Math.abs(T-k)<=J.EPSILON*Math.max(1,Math.abs(T),Math.abs(k))&&Math.abs(y-V)<=J.EPSILON*Math.max(1,Math.abs(y),Math.abs(V))&&Math.abs(f-G)<=J.EPSILON*Math.max(1,Math.abs(f),Math.abs(G))&&Math.abs(F-N)<=J.EPSILON*Math.max(1,Math.abs(F),Math.abs(N))&&Math.abs(c-m)<=J.EPSILON*Math.max(1,Math.abs(c),
Math.abs(m))}const C=Object.freeze(Object.defineProperty({__proto__:null,copy:K,identity:t,set:l,invert:O,determinant:A,multiply:D,rotate:P,scale:M,translate:H,fromRotation:d,fromScaling:h,fromTranslation:n,str:u,frob:p,add:S,subtract:Q,multiplyScalar:B,multiplyScalarAndAdd:x,exactEquals:b,equals:q,mul:D,sub:Q},Symbol.toStringTag,{value:"Module"}));E.add=S;E.copy=K;E.determinant=A;E.equals=q;E.exactEquals=b;E.frob=p;E.fromRotation=d;E.fromScaling=h;E.fromTranslation=n;E.identity=t;E.invert=O;E.mat2d=
C;E.mul=D;E.multiply=D;E.multiplyScalar=B;E.multiplyScalarAndAdd=x;E.rotate=P;E.scale=M;E.set=l;E.str=u;E.sub=Q;E.subtract=Q;E.translate=H})},"esri/symbols/support/utils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./gfxUtils ./Symbol3DMaterial".split(" "),function(E,J,K,t,l,O,A,D,P,M,H,d,h){function n(g){g=g.symbolLayers;
if(!g)return null;let k=null;g.forEach(V=>{if("object"!==V.type||null==V.resource.href)k="water"===V.type?D.unwrap(V.color):D.isSome(V.material)?D.unwrap(V.material.color):null});return k?new t(k):null}function u(g,k){if(null==k)return g;g=g.toRgba();g[3]*=k;return new t(g)}function p(g,k,V){if(g=g.symbolLayers){var G=N=>{N=D.isSome(N)?N:null;k=k||N||null!=V&&F;return u(k,V)};g.forEach(N=>{if("object"!==N.type||null==N.resource.href||k)if("water"===N.type)N.color=G(N.color);else{var e=D.isSome(N.material)?
N.material.color:null;e=G(e);D.isNone(N.material)?N.material=new h.Symbol3DMaterial({color:e}):N.material.color=e;null!=V&&"outline"in N&&D.isSome(N.outline)&&D.isSome(N.outline.color)&&(N.outline.color=u(N.outline.color,V))}})}}function S(g,k){return Q.apply(this,arguments)}function Q(){Q=K._asyncToGenerator(function*(g,k){(g=g.symbolLayers)&&(yield O.forEach(g,function(){var V=K._asyncToGenerator(function*(G){return B(G,k)});return function(G){return V.apply(this,arguments)}}()))});return Q.apply(this,
arguments)}function B(g,k){return x.apply(this,arguments)}function x(){x=K._asyncToGenerator(function*(g,k){switch(g.type){case "extrude":g.size="number"===typeof k[2]?k[2]:0;break;case "icon":case "line":case "text":k=b(k);D.isSome(k)&&(g.size=k);break;case "path":{const V=c(k,M.ONES,[g.width,void 0,g.height]);g.width=T(k[0],g.width,1,V);g.height=T(k[2],g.height,1,V)}break;case "object":yield q(g,k)}});return x.apply(this,arguments)}function b(g){for(const k of g)if("number"===typeof k)return k;
return null}function q(g,k){return C.apply(this,arguments)}function C(){C=K._asyncToGenerator(function*(g,k){const {resourceSize:V,symbolSize:G}=yield m(g),N=c(k,V,G);g.width=T(k[0],G[0],V[0],N);g.depth=T(k[1],G[1],V[1],N);g.height=T(k[2],G[2],V[2],N)});return C.apply(this,arguments)}function c(g,k,V){for(let G=0;3>G;G++){const N=g[G];switch(N){case "symbol-value":return null!=V[G]?V[G]/k[G]:1;case "proportional":break;default:if(N&&k[G])return N/k[G]}}return 1}function m(g){return w.apply(this,arguments)}
function w(){w=K._asyncToGenerator(function*(g){const k=yield(yield new Promise((I,Y)=>E(["./symbolLayerUtils"],I,Y))).computeObjectLayerResourceSize(g,10),{width:V,height:G,depth:N}=g;g=[V,N,G];let e=1;for(var v=0;3>v;v++)if(null!=g[v]){e=g[v]/k[v];break}for(v=0;3>v;v++)null==g[v]&&(g[v]=k[v]*e);return{resourceSize:k,symbolSize:g}});return w.apply(this,arguments)}function T(g,k,V,G){switch(g){case "proportional":return V*G;case "symbol-value":return null!=k?k:V;default:return g}}function y(){y=K._asyncToGenerator(function*(g,
k){if(g&&k){if(l.isSymbol3D(g))return S(g,k);if(l.isSymbol2D(g)&&(k=b(k),!D.isNone(k)))switch(g.type){case "simple-marker":g.size=k;break;case "picture-marker":{const V=g.width/g.height;1<V?(g.width=k,g.height=k*V):(g.width=k*V,g.height=k);break}case "simple-line":g.width=k;break;case "text":g.font.size=k}}});return y.apply(this,arguments)}const f=/\/resource\/(.*?)\.svg$/,F=new t("white");J.applyColorToSymbol=function(g,k,V){if(g&&(k||null!=V))if(k&&(k=new t(k)),l.isSymbol3D(g))p(g,k,V);else if(l.isSymbol2D(g)){if(k=
k||g.color)g.color=u(k,V);null!=V&&"outline"in g&&g.outline&&g.outline.color&&(g.outline.color=u(g.outline.color,V))}};J.applyOpacityToColor=u;J.applyRotationToSymbol=function(g,k,V){g&&null!=k&&(l.isSymbol3D(g)?(g=g.symbolLayers)&&g.forEach(G=>{if(G&&"object"===G.type)switch(V){case "tilt":G.tilt=k;break;case "roll":G.roll=k;break;default:G.heading=k}}):!l.isSymbol2D(g)||"simple-marker"!==g.type&&"picture-marker"!==g.type&&"text"!==g.type||(g.angle=k))};J.applySizesToSymbol=function(g,k){return y.apply(this,
arguments)};J.getCSSFilterFromEffectList=function(g){if(!g)return null;g=g.effects.filter(k=>"bloom"!==k.type).map(k=>k.toJSON());return H.effectFunctionsFromJSON(g)};J.getColorFromSymbol=function(g,k){if(!g)return null;let V=null;l.isSymbol3D(g)?V=n(g):l.isSymbol2D(g)&&(V=g.color?new t(g.color):null);return V?u(V,k):null};J.getIconHref=function(g,k){k=k.resource.href;return!A("esri-canvas-svg-support")&&g.styleOrigin&&f.test(k)?k.replace(f,"/resource/png/$1.png"):k};J.getSymbolOutlineSize=function(g){if(!g)return 0;
if(l.isSymbol3D(g)){{const k=g.symbolLayers&&g.symbolLayers.length;k?(g=g.symbolLayers.getItemAt(k-1),g="outline"in g?D.get(g,"outline","size"):void 0):g=void 0}return D.isSome(g)?g:0}return(g=d.getStroke(g))&&P.px2pt(g.width)||0};J.isVolumetricSymbol=function(g){if(D.isNone(g)||!("symbolLayers"in g)||D.isNone(g.symbolLayers))return!1;switch(g.type){case "point-3d":return g.symbolLayers.some(k=>"object"===k.type);case "line-3d":return g.symbolLayers.some(k=>"path"===k.type);case "polygon-3d":return g.symbolLayers.some(k=>
"object"===k.type||"extrude"===k.type);default:return!1}};Object.defineProperties(J,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(E,J,K,t,l,O,A){function D(h){if(!h)return null;let n;switch(h.type){case "simple-fill":case "picture-fill":case "simple-marker":n=D(h.outline);break;case "simple-line":{const u=
O.pt2px(h.width);"none"!==h.style&&0!==u&&(n={color:h.color,style:d(h.style),width:u,cap:h.cap,join:"miter"===h.join?O.pt2px(h.miterLimit):h.join});break}default:n=null}return n}const P={left:"start",center:"middle",right:"end",justify:"start"},M={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},H=new l(1E3),d=(()=>{const h={};return n=>{if(h[n])return h[n];const u=n.replace(/-/g,"");return h[n]=u}})();K=new K([128,128,128]);E.defaultThematicColor=K;E.dekebabifyLineStyle=
d;E.getFill=function(h){const n=h.style;let u=null;if(h)switch(h.type){case "simple-marker":"cross"!==n&&"x"!==n&&(u=h.color);break;case "simple-fill":"solid"===n?u=h.color:"none"!==n&&(u={type:"pattern",x:0,y:0,src:J.getAssetUrl(`esri/symbols/patterns/${n}.png`),width:5,height:5});break;case "picture-fill":u={type:"pattern",src:h.url,width:O.pt2px(h.width)*h.xscale,height:O.pt2px(h.height)*h.yscale,x:O.pt2px(h.xoffset),y:O.pt2px(h.yoffset)};break;case "text":u=h.color;break;case "cim":u=A.getCIMSymbolColor(h)}return u};
E.getPatternUrlWithColor=function(h,n){const u=h+"-"+n;return void 0!==H.get(u)?Promise.resolve(H.get(u)):t(h,{responseType:"image"}).then(p=>{p=p.data;const S=p.naturalWidth,Q=p.naturalHeight,B=document.createElement("canvas");B.width=S;B.height=Q;const x=B.getContext("2d");x.fillStyle=n;x.fillRect(0,0,S,Q);x.globalCompositeOperation="destination-in";x.drawImage(p,0,0);p=B.toDataURL();H.put(u,p);return p})};E.getSVGAlign=function(h){return h=(h=h.horizontalAlignment)&&P[h.toLowerCase()]||"middle"};
E.getSVGBaseline=function(h){return(h=h.verticalAlignment)&&M[h.toLowerCase()]||"alphabetic"};E.getSVGBaselineShift=function(h){return"bottom"===h.verticalAlignment?"super":null};E.getStroke=D;Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/ItemCache":function(){define(["./MemCache"],function(E){return function(){function J(t,l){this._storage=new E.MemCacheStorage;this._storage.maxSize=t;l&&this._storage.registerRemoveFunc("",l)}var K=J.prototype;
K.put=function(t,l){this._storage.put(t,l,1,1)};K.pop=function(t){return this._storage.pop(t)};K.get=function(t){return this._storage.get(t)};K.clear=function(){this._storage.clearAll()};K.destroy=function(){this._storage.destroy()};return J}()})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/maybe ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils".split(" "),function(E,J,K,t,l,O,A,
D,P,M){function H(B,x){if(x&&(B.style.filter=M.getCSSFilterFromEffectList(x),x=x.effects))for(const b of x)if("drop-shadow"===(null==b?void 0:b.type)){0>b.offsetX?B.style.marginLeft=`${Math.abs(b.offsetX)}px`:B.style.marginRight=`${b.offsetX}px`;break}}function d(B,x){return h.apply(this,arguments)}function h(){h=K._asyncToGenerator(function*(B,x){switch(B.type){case "web-style":var {previewWebStyleSymbol:b}=yield new Promise((q,C)=>E(["./previewWebStyleSymbol"],q,C));return b(B,d,x);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:b}=
yield new Promise((q,C)=>E(["./previewSymbol3D"],q,C)),b(B,x);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:b}=yield new Promise((q,C)=>E(["./previewSymbol2D"],q,C)),b(B,x);case "cim":return{previewCIMSymbol:b}=yield new Promise((q,C)=>E(["./previewCIMSymbol"],q,C)),b(B,x)}});return h.apply(this,arguments)}function n(B){return B&&"opacity"in B?B.opacity*n(B.parent):1}function u(){u=K._asyncToGenerator(function*(B,
x){var b,q;if(B){var C=B.sourceLayer;C=null!=(b=l.isSome(x)&&null!=(q=x.useSourceLayer)&&q?C:B.layer)?b:C;b=n(C);if(l.isSome(B.symbol)&&(!l.isSome(x)||!0!==x.ignoreGraphicSymbol))return B="web-style"===B.symbol.type?yield B.symbol.fetchSymbol({...x,cache:l.isSome(x)?x.webStyleCache:null}):B.symbol.clone(),M.applyColorToSymbol(B,null,b),B;var c=l.isSome(x)&&x.renderer||C&&"renderer"in C&&C.renderer;if(q=c&&"getSymbolAsync"in c?yield c.getSymbolAsync(B,x):null){q="web-style"===q.type?yield q.fetchSymbol({...x,
cache:l.isSome(x)?x.webStyleCache:null}):q.clone();if(!("visualVariables"in c&&c.visualVariables&&c.visualVariables.length))return M.applyColorToSymbol(q,null,b),q;"arcadeRequiredForVisualVariables"in c&&c.arcadeRequiredForVisualVariables&&(l.isNone(x)||l.isNone(x.arcade))&&(x={...l.unwrap(x)},x.arcade=yield O.loadArcade());C=yield new Promise((F,g)=>E(["../../renderers/visualVariables/support/visualVariableUtils"],F,g));var m=[],w=[],T=[],y=[];for(var f of c.visualVariables)switch(f.type){case "color":m.push(f);
break;case "opacity":w.push(f);break;case "rotation":y.push(f);break;case "size":f.target||T.push(f)}f=(f=!!m.length&&m[m.length-1])?C.getColor(f,B,x):null;w=(w=!!w.length&&w[w.length-1])?C.getOpacity(w,B,x):null;null!=b&&(w=null!=w?w*b:b);M.applyColorToSymbol(q,f,w);T.length&&(b=C.getAllSizes(T,B,x),yield M.applySizesToSymbol(q,b));for(const F of y)M.applyRotationToSymbol(q,C.getRotationAngle(F,B,x),F.axis);return q}}});return u.apply(this,arguments)}function p(){p=K._asyncToGenerator(function*(B,
x){var b;if(B){var q=n(B.layer||B.sourceLayer);if(l.isSome(B.symbol)&&(!l.isSome(x)||!0!==x.ignoreGraphicSymbol))return B="web-style"===B.symbol.type?yield B.symbol.fetchSymbol(x):B.symbol.clone(),M.getColorFromSymbol(B,q);var C=l.isSome(x)&&x.renderer||B.get("layer.renderer")||B.get("sourceLayer.renderer"),c=yield C.getSymbolAsync(B,x);if(c){c="web-style"===c.type?yield c.fetchSymbol(x):c.clone();c=M.getColorFromSymbol(c,q);if(!("visualVariables"in C)||"visualVariables"in C&&!C.visualVariables||
"visualVariables"in C&&(null==(b=C.visualVariables)||!b.length))return c;C.arcadeRequiredForVisualVariables&&(l.isNone(x)||l.isNone(x.arcade))&&(x={...l.unwrap(x)},x.arcade=yield O.loadArcade());b=yield new Promise((T,y)=>E(["../../renderers/visualVariables/support/visualVariableUtils"],T,y));var m=[],w=[];for(const T of C.visualVariables)switch(T.type){case "color":m.push(T);break;case "opacity":w.push(T)}C=(C=0<m.length?m[m.length-1]:null)?b.getColor(C,B,x):c;B=(c=0<w.length?w[w.length-1]:null)?
b.getOpacity(c,B,x):null;null!=q&&(B=null!=B?B*q:q);return C?M.applyOpacityToColor(C,B):null}}});return p.apply(this,arguments)}let S=null;const Q=[255,255,255];J.getDisplayedColor=function(B,x){return p.apply(this,arguments)};J.getDisplayedSymbol=function(B,x){return u.apply(this,arguments)};J.renderColorRampPreviewHTML=function(B,x={}){var b="horizontal"===x.align;const {width:q=b?75:24,height:C=b?24:75,gradient:c=!0}=x;var m=window.devicePixelRatio,w=q*m,T=C*m;m=document.createElement("canvas");
m.width=w;m.height=T;m.style.width=`${q}px`;m.style.height=`${C}px`;const y=m.getContext("2d");var f=b?w:0,F=b?0:T;if(c){const g=y.createLinearGradient(0,0,f,F);b=B.length;const k=1===b?0:1/(b-1);B.forEach((V,G)=>g.addColorStop(G*k,V.toString()));y.fillStyle=g;y.fillRect(0,0,w,T)}else{w=b?w/B.length:w;T=b?T:T/B.length;F=f=0;for(const g of B)y.fillStyle=g.toString(),y.fillRect(f,F,w,T),f=b?f+w:0,F=b?0:F+T}B=document.createElement("div");B.style.width=`${q}px`;B.style.height=`${C}px`;H(B,null==x?void 0:
x.effectList);B.appendChild(m);return B};J.renderDotDensityPreviewHTML=function(B,x,b){const {backgroundColor:q,outline:C,dotSize:c}=B;b=b&&b.swatchSize||D.SymbolSizeDefaults.size;const m=Math.round(b*b/c**2*.8),w=window.devicePixelRatio;B=document.createElement("canvas");const T=b*w;B.width=T;B.height=T;B.style.width=`${B.width/w}px`;B.style.height=`${B.height/w}px`;const y=B.getContext("2d");q&&(y.fillStyle=q.toCss(!0),y.fillRect(0,0,T,T),y.fill());y.fillStyle=x.toCss(!0);if(S&&S.length/2===m)for(x=
0;x<2*m;x+=2)y.fillRect(S[x],S[x+1],c*w,c*w),y.fill();else for(S=[],x=0;x<2*m;x+=2){const f=Math.floor(Math.random()*(T-0+1)),F=Math.floor(Math.random()*(T-0+1));S.push(f,F);y.fillRect(f,F,c*w,c*w);y.fill()}C&&(C.color&&(y.strokeStyle=C.color.toCss(!0)),y.lineWidth=C.width,y.strokeRect(0,0,T,T));b=new Image(b,b);b.src=B.toDataURL();return b};J.renderPieChartPreviewHTML=function(B,x={}){const b=x.radius||40;var q=2*Math.PI*b,C=B.length;const c=q/C,m=[],w=A.getStroke(x.outline);w&&(w.width*=2);(w||
x.backgroundColor)&&m.push({shape:{type:"circle",cx:b,cy:b,r:b},fill:x.backgroundColor,stroke:w,offset:[0,0]});const T=x.values,y=T&&T.length===C&&100===T.reduce((F,g)=>F+g,0),f=[0];for(let F=0;F<C;F++){const g=y?T[F]*q/100:null;y&&f.push(g+f[F]);m.push({shape:{type:"circle",cx:b,cy:b,r:b/2},fill:[0,0,0,0],stroke:{width:b,dashArray:`${g||c} ${q}`,dashoffset:`-${y?f[F]/2:c/2*F}`,color:B[F]},offset:[0,0]})}C=null;B=2*b+((null==w?void 0:w.width)||0);if(q=x.holePercentage)w&&m.push({shape:{type:"circle",
cx:b,cy:b,r:b*q},fill:null,stroke:w,offset:[0,0]}),C=B/2,C=[[{shape:{type:"circle",cx:C,cy:C,r:C},fill:Q,stroke:w?{...w,color:Q}:null,offset:[0,0]},{shape:{type:"circle",cx:C,cy:C,r:b*q},fill:[0,0,0],stroke:null,offset:[0,0]}]];return P.renderSymbol([m],[B,B],{effectView:x.effectList,ignoreStrokeWidth:!0,masking:C,rotation:-90})};J.renderPreviewHTML=d;Object.defineProperties(J,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Legend/support/clusterUtils":function(){define(["exports",
"../../../renderers/visualVariables/SizeVariable"],function(E,J){const K=(t,l)=>{t=t.featuresTilingScheme.getClosestInfoForScale(t.scale).level;return null!=l&&l.levels?l.levels[t]:null};E.getClusterSizeVariable=function(t,l){if(!(t&&"visualVariables"in t&&t.visualVariables))return null;t=t.visualVariables.find(O=>"size"===O.type);return(l=K(l,t))?new J({field:t.field,minSize:l[2].size,minDataValue:l[2].value,maxSize:l[3].size,maxDataValue:l[3].value}):null};Object.defineProperties(E,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../chunks/_rollupPluginBabelHelpers","../../../Color","./utils"],function(E,J,K,t,l){function O(h,n){const u=[],p=h.length-1;5===h.length?u.push(0,2,4):u.push(0,p);return h.map((S,Q)=>u.includes(Q)?l.createStopLabel(S,Q,p,n):null)}function A(){A=K._asyncToGenerator(function*(h,n,u){let p=!1,S=[],Q=[];if(h.stops){var B=h.stops;S=B.map(b=>b.value);(p=B.some(b=>!!b.label))&&
(Q=B.map(b=>b.label))}B=S[S.length-1];if(null==S[0]&&null==B)return null;const x=p?null:O(S,u);return(yield Promise.all(S.map(function(){var b=K._asyncToGenerator(function*(q,C){const c="opacity"===h.type?yield D(q,h,n):(yield new Promise((m,w)=>E(["../../../renderers/visualVariables/support/visualVariableUtils"],m,w))).getColor(h,q);return{value:q,color:c,label:p?Q[C]:x[C]}});return function(q,C){return b.apply(this,arguments)}}()))).reverse()});return A.apply(this,arguments)}function D(h,n){return P.apply(this,
arguments)}function P(){P=K._asyncToGenerator(function*(h,n,u=d){u=new t(u);h=(yield new Promise((p,S)=>E(["../../../renderers/visualVariables/support/visualVariableUtils"],p,S))).getOpacity(n,h);null!=h&&(u.a=h);return u});return P.apply(this,arguments)}function M(h,n){const {startIndex:u,endIndex:p,weight:S}=H(h,n);if(u===p)return n[u].color;h=t.blendColors(n[u].color,n[p].color,S);return new t(h)}function H(h,n){let u=0,p=n.length-1;n.some((S,Q)=>{if(h<S.value)return p=Q,!0;u=Q;return!1});return{startIndex:u,
endIndex:p,weight:(h-n[u].value)/(n[p].value-n[u].value)}}const d=new t([64,64,64]);J.getColorFromPointCloudStops=M;J.getRampStops=function(h,n,u){return A.apply(this,arguments)};J.getRampStopsForPointCloud=function(h){let n=!1,u=[],p=[];u=h.map(B=>B.value);(n=h.some(B=>!!B.label))&&(p=h.map(B=>B.label));const S=u[u.length-1];if(null==u[0]&&null==S)return null;const Q=n?null:O(u,!1);return u.map((B,x)=>{const b=M(B,h);return{value:B,color:b,label:n?p[x]:Q[x]}}).reverse()};J.getStrectchRampStops=function(h,
n){let u=[];if(h&&"multipart"===h.type)h.colorRamps.reverse().forEach((p,S)=>{0===S?u.push({value:n.max,color:new t(p.toColor),label:"high"}):u.push({value:null,color:new t(p.toColor),label:""});S===h.colorRamps.length-1?u.push({value:n.min,color:new t(p.fromColor),label:"low"}):u.push({value:null,color:new t(p.fromColor),label:""})});else{let p,S;h&&"algorithmic"===h.type?(p=h.fromColor,S=h.toColor):(p=[0,0,0,1],S=[255,255,255,1]);u=[{value:n.max,color:new t(S),label:"high"},{value:n.min,color:new t(p),
label:"low"}]}return u};Object.defineProperties(J,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Legend/support/utils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../symbols ../../../intl/date ../../../renderers/support/numberUtils ../../../symbols/SimpleLineSymbol".split(" "),function(E,J,K,t,l,O,A){function D(d){return P.apply(this,arguments)}function P(){P=K._asyncToGenerator(function*(d){if(!("visualVariables"in d&&d.visualVariables))return null;
d=d.visualVariables.find(u=>"color"===u.type);if(!d)return null;var h=null,n=null;if(d.stops){if(1===d.stops.length)return d.stops[0].color;h=d.stops[0].value;n=d.stops[d.stops.length-1].value}h+=(n-h)/2;({getColor:n}=yield new Promise((u,p)=>E(["../../../renderers/visualVariables/support/visualVariableUtils"],u,p)));return n(d,h)});return P.apply(this,arguments)}function M(){M=K._asyncToGenerator(function*(d,h){const n=d.trailCap,u=d.trailWidth||1;d=h||(yield D(d))||d.color;return new A({cap:n,color:d,
width:u})});return M.apply(this,arguments)}const H=l.convertDateFormatToIntlOptions("short-date");J.RGB_IMG_SOURCE=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d",
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];J.SPECIAL_CHARS_GREATER_THAN="\x3e";J.SPECIAL_CHARS_LESS_THAN="\x3c";J.createStopLabel=function(d,h,n,u){let p="";0===h?p="\x3c ":h===n&&(p="\x3e ");h=null;h=u?l.formatDate(d,H):O.format(d);return p+h};J.getMedianColor=D;J.getSymbolForFlowRenderer=function(d,h){return M.apply(this,arguments)};Object.defineProperties(J,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],function(E,J,K){function t(H,d){return H-d}function l(H,d){let h;h=Number(H.toFixed(d));h<H?H=h+1/10**d:(H=h,h-=1/10**d);h=Number(h.toFixed(d));H=Number(H.toFixed(d));return[h,H]}function O(H,d,h,n,u){H=D(H,d,h,n);d=null==H.next||H.next<=u;return(null==H.previous||H.previous<=u)&&d||H.previous+H.next<=2*u}function A(H){H=String(H);var d=
H.match(P);if(d&&d[1])return{integer:d[1].split("").length,fractional:d[3]?d[3].split("").length:0};if(H.toLowerCase().includes("e")&&(d=H.split("e"),H=d[0],d=d[1],H&&d)){H=Number(H);d=Number(d);const h=0<d;h||(d=Math.abs(d));H=A(H);h?(H.integer+=d,H.fractional=d>H.fractional?0:H.fractional-d):(H.fractional+=d,H.integer=d>H.integer?1:H.integer-d);return H}return{integer:0,fractional:0}}function D(H,d,h,n){const u={previous:null,next:null};if(null!=h){const p=H-h;u.previous=Math.floor(Math.abs(100*
(d-h-p)/p))}null!=n&&(H=n-H,u.next=Math.floor(Math.abs(100*(n-d-H)/H)));return u}const P=/^-?(\d+)(\.(\d+))?$/i,M={maximumFractionDigits:20};E.format=function(H){return K.formatNumber(H,M)};E.numDigits=A;E.percentChange=D;E.round=function(H,d={}){H=H.slice(0);const {tolerance:h=2,strictBounds:n=!1,indexes:u=H.map((S,Q)=>Q)}=d;u.sort(t);for(d=0;d<u.length;d++){const S=u[d],Q=H[S],B=0===S?null:H[S-1],x=S===H.length-1?null:H[S+1],b=A(Q).fractional;if(b){let q=0,C=!1;for(var p=void 0;q<=b&&!C;)p=l(Q,
q),p=n&&0===d?p[1]:p[0],C=O(Q,p,B,x,h),q++;C&&(H[S]=p)}}return H};Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(E,J){E.getHeatmapRampStops=function(K){if(!K.colorStops)return[];const t=[...K.colorStops].filter(O=>{var A;return 0<(null==(A=O.color)?void 0:A.a)});let l=t.length-1;if(t&&t[0]){const O=t[l];O&&1!==O.ratio&&(t.push(new J({ratio:1,
color:O.color})),l++)}return t.map((O,A)=>{let D="";if(0===A){var P;D=(null==(P=K.legendOptions)?void 0:P.minLabel)||"low"}else if(A===l){var M;D=(null==(M=K.legendOptions)?void 0:M.maxLabel)||"high"}return{color:O.color,label:D,ratio:O.ratio}}).reverse()};Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],
function(E,J,K,t){function l(M){if(M){var {type:H}=M;return H.includes("3d")?t.getSymbolLayerFill(M.symbolLayers.getItemAt(0)):"simple-line"===H||"simple-marker"===M.type&&("x"===M.style||"cross"===M.style)?(M=K.getStroke(M))&&M.color:K.getFill(M)}}function O(M,H){const d=H.HH.label,h=H.LL.label,n=H.HL.label;H=H.LH.label;switch(M){case "HH":return{top:d,bottom:h,left:n,right:H};case "HL":return{top:n,bottom:H,left:h,right:d};case "LL":return{top:h,bottom:d,left:H,right:n};case "LH":return{top:H,bottom:n,
left:d,right:h};default:return{top:d,bottom:h,left:n,right:H}}}function A(M){let H=D[M];M&&null==H&&(H=D.HH);return H||0}const D={HH:315,HL:45,LL:135,LH:225},P={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};E.getRelationshipRampColors2D=function(M,H){const d=[],h=M.length**.5;M=J.clone(M);var n=(H||"HH").split("");H=n[0];for(n="H"===n[1];M.length;){const u=
[];for(;u.length<h;)u.push(M.shift());n&&u.reverse();d.push(u)}"L"===H&&d.reverse();return d};E.getRelationshipRampElement=function(M){const {focus:H,infos:d,numClasses:h}=M;var n=P[h];const u={};d.forEach(p=>{u[p.value]={label:p.label,fill:l(p.symbol)}});M=[];for(let p=0;p<h;p++){const S=[];for(let Q=0;Q<h;Q++)S.push(u[n[p][Q]].fill);M.push(S)}n=O(H,u);return{type:"relationship-ramp",numClasses:h,focus:H,colors:M,labels:n,rotation:A(H)}};E.getRotationAngleForFocus=A;Object.defineProperties(E,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),function(E,J,K,t,l,O,A,D,P,M,H,d,h,n,u,p,S){function Q(L){const R=
L.outline;var Z=D.isSome(L.material)?L.material.color:null;Z=D.isSome(Z)?Z.toHex():null;if(D.isNone(R)||"pattern"in R&&D.isSome(R.pattern)&&"style"===R.pattern.type&&"none"===R.pattern.style)return"fill"===L.type&&"#ffffff"===Z?{color:"#bdc3c7",width:.75}:null;L=M.pt2px(R.size)||0;return{color:"rgba("+(D.isSome(R.color)?R.color.toRgba():"255,255,255,1")+")",width:Math.min(L,I),style:"pattern"in R&&D.isSome(R.pattern)&&"style"===R.pattern.type?H.dekebabifyLineStyle(R.pattern.style):null,join:"butt",
cap:"patternCap"in R?R.patternCap:"butt"}}function B(L,R){var Z=R&&R.resource;Z=Z&&Z.href;if(L.thumbnail&&L.thumbnail.url)return Promise.resolve(L.thumbnail.url);if(Z&&"object"!==R.type)return Promise.resolve(p.getIconHref(L,R));const ca=K.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return L.styleOrigin&&(L.styleOrigin.styleName||L.styleOrigin.styleUrl)?S.resolveWebStyleSymbol(L.styleOrigin,{portal:L.styleOrigin.portal},"webRef").catch(ja=>ja).then(ja=>{var pa;return(null==ja?void 0:
null==(pa=ja.thumbnail)?void 0:pa.url)||ca}):Promise.resolve(ca)}function x(L,R=1){const Z=L.a;L=t.toHSV(L);const {r:ca,g:ja,b:pa}=t.toRGB({h:L.h,s:L.s/R,v:100-(100-L.v)/R});return[ca,ja,pa,Z]}function b(L){return"water"===L.type?D.isNone(L.color)?null:L.color:D.isNone(L.material)||D.isNone(L.material.color)?null:L.material.color}function q(L,R=0){var Z=b(L);if(!Z){if("fill"===L.type)return null;R=n.adjustColorComponentBrightness(H.defaultThematicColor.r,R);return[R,R,R,100]}L=Z.toRgba();for(Z=0;3>
Z;Z++)L[Z]=n.adjustColorComponentBrightness(L[Z],R);return L}function C(L,R){return c.apply(this,arguments)}function c(){c=J._asyncToGenerator(function*(L,R){L=L.style;return"none"===L?null:{type:"pattern",x:0,y:0,src:yield H.getPatternUrlWithColor(K.getAssetUrl(`esri/symbols/patterns/${L}.png`),R.toCss(!0)),width:5,height:5}});return c.apply(this,arguments)}function m(L){return L.outline?Q(L):{color:"rgba(0, 0, 0, 1)",width:1.5}}function w(L,R){L=b(L);if(!L)return null;let Z;Z="rgba("+(n.adjustColorComponentBrightness(L.r,
R)+",");Z+=n.adjustColorComponentBrightness(L.g,R)+",";Z+=n.adjustColorComponentBrightness(L.b,R)+",";return Z+L.a+");"}function T(L,R){R=w(L,R);if(!R)return{};if("pattern"in L&&D.isSome(L.pattern)&&"style"===L.pattern.type&&"none"===L.pattern.style)return null;const Z=Math.min(L.size?M.pt2px(L.size):.75,I);return{color:R,width:Z,style:"pattern"in L&&D.isSome(L.pattern)&&"style"===L.pattern.type?H.dekebabifyLineStyle(L.pattern.style):null,cap:"cap"in L?L.cap:null,join:"join"in L?"miter"===L.join?
M.pt2px(2):L.join:null}}function y(L,R,Z){Z*=.75;return{type:"linear",x1:Z?.25*Z:0,y1:Z?.5*Z:0,x2:Z||4,y2:Z?.5*Z:4,colors:[{color:L,offset:0},{color:R,offset:1}]}}function f(L){const R=L.depth,Z=L.height;return(L=L.width)&&R&&Z&&L===R&&L<Z}function F(L,R,Z){const ca=[];if(!L)return ca;switch(L.type){case "icon":switch(L.resource&&L.resource.primitive||d.defaultPrimitive){case "circle":ca.push({shape:{type:"circle",cx:0,cy:0,r:.5*R},fill:q(L,0),stroke:Q(L)});break;case "square":ca.push({shape:{type:"path",
path:[{command:"M",values:[0,R]},{command:"L",values:[0,0]},{command:"L",values:[R,0]},{command:"L",values:[R,R]},{command:"Z",values:[]}]},fill:q(L,0),stroke:Q(L)});break;case "triangle":ca.push({shape:{type:"path",path:[{command:"M",values:[0,R]},{command:"L",values:[.5*R,0]},{command:"L",values:[R,R]},{command:"Z",values:[]}]},fill:q(L,0),stroke:Q(L)});break;case "cross":ca.push({shape:{type:"path",path:[{command:"M",values:[.5*R,0]},{command:"L",values:[.5*R,R]},{command:"M",values:[0,.5*R]},
{command:"L",values:[R,.5*R]}]},stroke:m(L)});break;case "x":ca.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[R,R]},{command:"M",values:[R,0]},{command:"L",values:[0,R]}]},stroke:m(L)});break;case "kite":ca.push({shape:{type:"path",path:[{command:"M",values:[0,.5*R]},{command:"L",values:[.5*R,0]},{command:"L",values:[R,.5*R]},{command:"L",values:[.5*R,R]},{command:"Z",values:[]}]},fill:q(L,0),stroke:Q(L)})}break;case "object":switch(L.resource&&L.resource.primitive||
h.defaultPrimitive){case "cone":var ja=q(L,0);L=q(L,-.6);L=y(ja,L,Z?ea:R);R=n.getConeShapes(R,Z);ca.push({shape:R[0],fill:L});ca.push({shape:R[1],fill:L});break;case "inverted-cone":Z=q(L,0);L=q(L,-.6);L=y(Z,L,R);R=n.getInvertedConeShapes(R);ca.push({shape:R[0],fill:L});ca.push({shape:R[1],fill:Z});break;case "cube":R=n.getCubeShapes(R,Z);ca.push({shape:R[0],fill:q(L,0)});ca.push({shape:R[1],fill:q(L,-.3)});ca.push({shape:R[2],fill:q(L,-.5)});break;case "cylinder":{ja=q(L,0);const pa=q(L,-.6);ja=
y(ja,pa,Z?ea:R);R=n.getCylinderShapes(R,Z);ca.push({shape:R[0],fill:ja});ca.push({shape:R[1],fill:ja});ca.push({shape:R[2],fill:q(L,0)});break}case "diamond":R=n.getDiamondShapes(R);ca.push({shape:R[0],fill:q(L,-.3)});ca.push({shape:R[1],fill:q(L,0)});ca.push({shape:R[2],fill:q(L,-.3)});ca.push({shape:R[3],fill:q(L,-.7)});break;case "sphere":Z=q(L,0);L=q(L,-.6);L=y(Z,L);L.x1=0;L.y1=0;L.x2=.25*R;L.y2=.25*R;ca.push({shape:{type:"circle",cx:0,cy:0,r:.5*R},fill:L});break;case "tetrahedron":R=n.getTetrahedronShapes(R),
ca.push({shape:R[0],fill:q(L,-.3)}),ca.push({shape:R[1],fill:q(L,0)}),ca.push({shape:R[2],fill:q(L,-.6)})}}return ca}function g(L){return(L="number"===typeof(null==L?void 0:L.size)?null==L?void 0:L.size:null)?M.pt2px(L):null}function k(L,R){const Z=g(R),ca=R&&R.maxSize?M.pt2px(R.maxSize):null,ja=R&&R.disableUpsampling,pa=L.symbolLayers,na=[];let ma=0,ya=0;const fa=pa.getItemAt(pa.length-1);let za;fa&&"icon"===fa.type&&(za=fa.size&&M.pt2px(fa.size));pa.forEach(ka=>{if("icon"===ka.type||"object"===
ka.type){var qa="icon"===ka.type?ka.size&&M.pt2px(ka.size):0,sa=Z||qa?Math.ceil(Math.min(Z||qa,ca||v)):e;if(ka&&ka.resource&&ka.resource.href){var Ba=B(L,ka).then(ta=>{const Ea=ka.get("material.color");var Fa="icon"===ka.type?"multiply":"tint";return u.tintImageWithColor(ta,sa,Ea,Fa,ja)}).then(ta=>{const Ea=ta.width,Fa=ta.height;ma=Math.max(ma,Ea);ya=Math.max(ya,Fa);return[{shape:{type:"image",x:0,y:0,width:Ea,height:Fa,src:ta.url},fill:null,stroke:null}]});na.push(Ba)}else{let ta=sa;"icon"===ka.type&&
za&&Z&&(ta=qa/za*sa);qa="tall"===(null==R?void 0:R.symbolConfig)||(null==R?void 0:null==(Ba=R.symbolConfig)?void 0:Ba.isTall)||("object"===ka.type?f(ka):!1);ma=Math.max(ma,qa?ea:ta);ya=Math.max(ya,ta);na.push(Promise.resolve(F(ka,ta,qa)))}}});return P.eachAlways(na).then(ka=>{const qa=[];ka.forEach(sa=>{sa.value?qa.push(sa.value):sa.error&&ba.warn("error while building swatchInfo!",sa.error)});return u.renderSymbol(qa,[ma,ya],{node:R&&R.node,scale:!1,opacity:R&&R.opacity})})}function V(L,R){const Z=
L.symbolLayers,ca=[];L=p.isVolumetricSymbol(L);const ja=g(R),pa=(R&&R.maxSize?M.pt2px(R.maxSize):null)||I;let na=0,ma=0,ya;Z.forEach((fa,za)=>{if(fa&&("line"===fa.type||"path"===fa.type)){var ka=[];switch(fa.type){case "line":var qa=T(fa,0);if(D.isNone(qa))break;var sa=qa&&qa.width||0;0===za&&(ya=sa);fa=Math.min(ja||sa,pa);za=0===za?fa:ja?sa/ya*fa:fa;sa=za>Y/2?2*za:Y;ma=Math.max(ma,za);na=Math.max(na,sa);qa.width=za;ka.push({shape:{type:"path",path:[{command:"M",values:[0,.5*ma]},{command:"L",values:[na,
.5*ma]}]},stroke:qa});break;case "path":qa=Math.min(ja||e,pa);za=q(fa,0);sa=q(fa,-.2);var Ba=w(fa,-.4);Ba=Ba?{color:Ba,width:1}:{};if("quad"===fa.profile){const ta=fa.width;fa=fa.height;fa=n.getPathSymbolShapes(ta&&fa?ta/fa:1,0===fa,0===ta);Ba={...Ba,join:"bevel"};ka.push({shape:fa[0],fill:sa,stroke:Ba});ka.push({shape:fa[1],fill:sa,stroke:Ba});ka.push({shape:fa[2],fill:za,stroke:Ba})}else ka.push({shape:n.shapes.pathSymbol3DLayer[0],fill:sa,stroke:Ba}),ka.push({shape:n.shapes.pathSymbol3DLayer[1],
fill:za,stroke:Ba});na=ma=Math.max(ma,qa)}ca.push(ka)}});return Promise.resolve(u.renderSymbol(ca,[na,ma],{node:R&&R.node,scale:L,opacity:R&&R.opacity}))}function G(L,R){return N.apply(this,arguments)}function N(){N=J._asyncToGenerator(function*(L,R){const Z="mesh-3d"===L.type;L=L.symbolLayers;var ca=g(R);const ja=R&&R.maxSize?M.pt2px(R.maxSize):null;ca=ca||e;const pa=[];let na=0,ma=0;var ya=!1;for(let Ba=0;Ba<L.length;Ba++){var fa=L.getItemAt(Ba);const ta=[];if(!Z||"fill"===fa.type){var za=n.shapes.fill[0];
switch(fa.type){case "fill":var ka=Q(fa);ya=Math.min(ca,ja||v);na=Math.max(na,ya);ma=Math.max(ma,ya);ya=!0;var qa=q(fa,0),sa="pattern"in fa&&fa.pattern;fa=b(fa);!Z&&D.isSome(sa)&&"style"===sa.type&&"solid"!==sa.style&&fa&&(qa=yield C(sa,fa));ta.push({shape:za,fill:qa,stroke:ka});break;case "line":fa=T(fa,0);if(D.isNone(fa))break;fa={stroke:fa,shape:za};na=Math.max(na,e);ma=Math.max(ma,e);ta.push(fa);break;case "extrude":za={join:"round",width:1,...T(fa,-.4)};ka=q(fa,0);fa=q(fa,-.2);qa=Math.min(ca,
ja||v);sa=n.getExtrudeSymbolShapes(qa);za.width=1;ta.push({shape:sa[0],fill:fa,stroke:za});ta.push({shape:sa[1],fill:fa,stroke:za});ta.push({shape:sa[2],fill:ka,stroke:za});fa=.7*e+.5*qa;na=Math.max(na,e);ma=Math.max(ma,fa);break;case "water":ya=b(fa),fa=x(ya),za=x(ya,2),ka=x(ya,3),qa=n.getWaterSymbolShapes(),ya=!0,ta.push({shape:qa[0],fill:fa}),ta.push({shape:qa[1],fill:za}),ta.push({shape:qa[2],fill:ka}),fa=Math.min(ca,ja||v),na=Math.max(na,fa),ma=Math.max(ma,fa)}pa.push(ta)}}return u.renderSymbol(pa,
[na,ma],{node:R&&R.node,scale:ya,opacity:R&&R.opacity})});return N.apply(this,arguments)}const e=n.SymbolSizeDefaults.size,v=n.SymbolSizeDefaults.maxSize,I=n.SymbolSizeDefaults.maxOutlineSize,Y=n.SymbolSizeDefaults.lineWidth,ea=n.SymbolSizeDefaults.tallSymbolWidth,ba=A.getLogger("esri.symbols.support.previewSymbol3D");E.getPatternDescriptor=C;E.getSizeFromOptions=g;E.getSymbolLayerFill=q;E.previewSymbol3D=function(L,R){if(0===L.symbolLayers.length)return Promise.reject(new O("symbolPreview: renderPreviewHTML3D",
"No symbolLayers in the symbol."));switch(L.type){case "point-3d":return k(L,R);case "line-3d":return V(L,R);case "polygon-3d":case "mesh-3d":return G(L,R)}return Promise.reject(new O("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/maybe ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),
function(E,J,K,t,l,O,A,D,P,M,H,d){function h(u,p,S,Q,B){var x=u.data;const b=S&&l.isSome(S.portal)?S.portal:A.getDefault(),q={portal:b,url:O.urlToObject(u.baseUrl),origin:"portal-item"};x=x.items.find(T=>T.name===p);if(!x)return Promise.reject(new t("symbolstyleutils:symbol-name-not-found",`The symbol name '${p}' could not be found`,{symbolName:p}));let C=D.fromJSON(H.symbolUrlFromStyleItem(x,Q),q),c=x.thumbnail&&x.thumbnail.href;const m=x.thumbnail&&x.thumbnail.imageData;K.isDevEnvironment()&&(C=
K.adjustStaticAGOUrl(C),c=K.adjustStaticAGOUrl(c));const w={portal:b,url:O.urlToObject(O.removeFile(C)),origin:"portal-item"};return H.requestJSON(C,B).then(T=>{T="cimRef"===Q?H.makeCIMSymbolRef(T.data):T.data;if((T=P.fromJSON(T,w))&&J.isSymbol3D(T)){if(c){const y=D.fromJSON(c,q);T.thumbnail=new d.Thumbnail({url:y})}else m&&(T.thumbnail=new d.Thumbnail({url:`data:image/png;base64,${m}`}));u.styleUrl?T.styleOrigin=new M({portal:S.portal,styleUrl:u.styleUrl,name:p}):u.styleName&&(T.styleOrigin=new M({portal:S.portal,
styleName:u.styleName,name:p}))}return T})}function n(u,p,S){const Q=H.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,u.name),B=l.isSome(p.portal)?p.portal:A.getDefault();return H.requestJSON(Q,S).then(x=>{x=H.makeCIMSymbolRef(x.data);return P.fromJSON(x,{portal:B,url:O.urlToObject(O.removeFile(Q)),origin:"portal-item"})})}E.fetchSymbolFromStyle=h;E.resolveWebStyleSymbol=function(u,p,S,Q){return u.name?u.styleName&&"Esri2DPointSymbolsStyle"===u.styleName?n(u,p,Q):H.fetchStyle(u,p,Q).then(B=>h(B,u.name,
p,S,Q)):Promise.reject(new t("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))};Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(E){const J=/^devext.arcgis.com$/,K=/^qaext.arcgis.com$/,t=/^[\w-]*\.mapsdevext.arcgis.com$/,l=/^[\w-]*\.mapsqa.arcgis.com$/,O=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,J,K,/^jsapps.esri.com$/,t,l];E.adjustStaticAGOUrl=
function(A,D){return A?(D=D||globalThis.location.hostname)?null!=D.match(J)||null!=D.match(t)?A.replace("static.arcgis.com","staticdev.arcgis.com"):null!=D.match(K)||null!=D.match(l)?A.replace("static.arcgis.com","staticqa.arcgis.com"):A:A:A};E.isDevEnvironment=function(A){A=A||globalThis.location.hostname;return O.some(D=>{var P;return null!=(null==(P=A)?void 0:P.match(D))})};E.isTelemetryDevEnvironment=function(A){A=A||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(O).some(D=>
{var P;return null!=(null==(P=A)?void 0:P.match(D))})};Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../Color ../../../symbols ../../../renderers/support/numberUtils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ./utils ../../support/widgetUtils ../../../support/themeUtils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleLineSymbol".split(" "),
function(E,J,K,t,l,O,A,D,P,M,H,d,h){function n(G,N){const e=G.length-1;return G.map((v,I)=>P.createStopLabel(v,I,e,N))}function u(){u=K._asyncToGenerator(function*(G,N,e,v,I,Y){var ea,ba,L=N.legendOptions;L=L&&L.customValues;const R=yield Q(G,e);var Z=null!=N.minSize&&null!=N.maxSize;e=N.stops&&1<N.stops.length;var ca=!!N.target;if(R&&(L||Z||e&&!ca)){var ja=D.isVolumetricSymbol(R),pa=null,na=Z=null;Z=ja&&!e?O.round([N.minDataValue,N.maxDataValue]):L||(yield C(N,R,v,I));L=null==G?void 0:G.authoringInfo;
var ma=(ca="univariate-color-size"===(null==L?void 0:L.type))&&"above-and-below"===(null==L?void 0:L.univariateTheme);!Z&&e&&(Z=N.stops.map(ka=>ka.value),pa=N.stops.some(ka=>!!ka.label),"flow"===G.type&&(Z=O.round(Z)),pa&&(na=N.stops.map(ka=>ka.label)));ja&&2<(null==(ea=Z)?void 0:ea.length)&&!ma&&(Z=[Z[0],Z[Z.length-1]]);if(!Z)return null;ca&&5!==(null==(ba=Z)?void 0:ba.length)&&(Z=m({minSize:Z[0],maxSize:Z[Z.length-1]}));var ya=ja?p(G,Z):null,fa=D.getSymbolOutlineSize(R),za=pa?null:n(Z,Y);return(yield Promise.all(Z.map(function(){var ka=
K._asyncToGenerator(function*(qa,sa){const Ba=ja?ya[sa]:yield y(N,R,qa,v,I),ta=F(ma&&"class-breaks"===G.type?S(G,sa):R,Ba);return{value:qa,symbol:ta,label:pa?na[sa]:za[sa],size:Ba,outlineSize:fa}});return function(qa,sa){return ka.apply(this,arguments)}}()))).reverse()}});return u.apply(this,arguments)}function p(G,N){G=null==G?void 0:G.authoringInfo;const e="univariate-color-size"===(null==G?void 0:G.type);let v=[12,30];if(e){const I=N[0],Y=N[N.length-1];v=N.map(ea=>12+(ea-I)/(Y-I)*18)}e&&"below"===
(null==G?void 0:G.univariateTheme)&&v.reverse();return v}function S(G,N){const e=G.classBreakInfos,v=e.length;N=2>v||!(2<=N)?e[0].symbol.clone():e[v-1].symbol.clone();G.visualVariables.some(I=>"color"===I.type)&&(N.type.includes("3d")?b(N):q(N));return N}function Q(G,N){return B.apply(this,arguments)}function B(){B=K._asyncToGenerator(function*(G,N){if("flow"===G.type)return P.getSymbolForFlowRenderer(G,N);if("pie-chart"===G.type){var e;return new d({color:null,outline:null!=(e=G.outline)&&e.width?
G.outline:new h})}let v=e=null;"simple"===G.type?e=G.symbol:"class-breaks"===G.type?(e=(G=G.classBreakInfos)&&G[0]&&G[0].symbol,v=1<G.length):"unique-value"===G.type&&(e=(G=G.uniqueValueInfos)&&G[0]&&G[0].symbol,v=1<G.length);if(!e||x(e))return null;e=e.clone();if(N||v)e.type.includes("3d")?b(e):q(e);return e});return B.apply(this,arguments)}function x(G){return G?l.isSymbol3D(G)?G.symbolLayers?G.symbolLayers.some(N=>N&&"fill"===N.type):!1:G.type.includes("fill"):!1}function b(G){"line-3d"===G.type?
G.symbolLayers.forEach(N=>{N.material={color:V}}):G.symbolLayers.forEach(N=>{"icon"!==N.type||N.resource&&N.resource.href?N.material={color:k}:(N.material={color:g},N.outline={color:V,size:1.5})})}function q(G){const N=H.isDarkTheme();if("cim"===G.type)A.applyCIMSymbolColor(G,new t(k));else if(G.type.includes("line"))G.color=V;else if(G.color=N?V:g,"simple-marker"===G.type)if(G.outline){var e,v;"#ffffff"===(null==(e=G.outline)?void 0:null==(v=e.color)?void 0:v.toHex())&&(G.outline.color=V)}else G.outline=
{color:V,width:1.5}}function C(G,N,e,v){return c.apply(this,arguments)}function c(){c=K._asyncToGenerator(function*(G,N,e,v){const I=(yield new Promise((ba,L)=>E(["../../../renderers/visualVariables/support/visualVariableUtils"],ba,L))).getSizeRangeAtScale(G,e,v),Y=I&&m(I);if(I||Y){var ea=Y.map(ba=>{{const L=I.minSize,R=I.maxSize,Z=G.minDataValue,ca=G.maxDataValue;let ja=null;ba=ja=ba<=L?Z:ba>=R?ca:(ba-L)/(R-L)*(ca-Z)+Z}return ba});ea=O.round(ea);for(let ba=1;ba<ea.length-1;ba++){const L=yield w(G,
N,ea[ba],ea[ba-1],e,v);L&&(ea[ba]=L[0],Y[ba]=L[1])}return ea}});return c.apply(this,arguments)}function m(G){const N=G.minSize;G=(G.maxSize-N)/4;const e=[];for(let v=0;5>v;v++)e.push(N+G*v);return e}function w(G,N,e,v,I,Y){return T.apply(this,arguments)}function T(){T=K._asyncToGenerator(function*(G,N,e,v,I,Y){const ea=yield y(G,N,e,I,Y);v=yield y(G,N,v,I,Y);var ba=O.numDigits(e),L=ba.fractional,R=ba.integer;let Z=ba=null;0<e&&1>e&&(ba=10**L,e*=ba,R=O.numDigits(e).integer);for(L=R-1;0<=L;L--){var ca=
10**L;R=Math.floor(e/ca)*ca;ca*=Math.ceil(e/ca);null!=ba&&(R/=ba,ca/=ba);let ja=(R+ca)/2;[,ja]=O.round([R,ja,ca],{indexes:[1]});const pa=yield y(G,N,R,I,Y),na=yield y(G,N,ca,I,Y),ma=yield y(G,N,ja,I,Y),ya=O.percentChange(ea,pa,v,null),fa=O.percentChange(ea,na,v,null),za=O.percentChange(ea,ma,v,null);let ka=20>=ya.previous,qa=20>=fa.previous;ka&&qa&&(ya.previous<=fa.previous?(ka=!0,qa=!1):(qa=!0,ka=!1));ka?Z=[R,pa]:qa?Z=[ca,na]:20>=za.previous&&(Z=[ja,ma]);if(Z)break}return Z});return T.apply(this,
arguments)}function y(G,N,e,v,I){return f.apply(this,arguments)}function f(){f=K._asyncToGenerator(function*(G,N,e,v,I){const {getSize:Y}=yield new Promise((ea,ba)=>E(["../../../renderers/visualVariables/support/visualVariableUtils"],ea,ba));return Y(G,e,{scale:v,view:I,shape:"simple-marker"===N.type?N.style:null})});return f.apply(this,arguments)}function F(G,N){G=G.clone();if(l.isSymbol3D(G))D.isVolumetricSymbol(G)||G.symbolLayers.forEach(e=>{"fill"!==e.type&&(e.size=N)});else if("esri.symbols.SimpleMarkerSymbol"===
G.declaredClass)G.size=N;else if("esri.symbols.PictureMarkerSymbol"===G.declaredClass){const e=G.width,v=G.height;G.height=N;G.width=e/v*N}else"esri.symbols.SimpleLineSymbol"===G.declaredClass?G.width=N:"esri.symbols.TextSymbol"===G.declaredClass&&G.font&&(G.font.size=N);return G}const g=[255,255,255],k=[200,200,200],V=[128,128,128];J.REAL_WORLD_MAX_SIZE=30;J.REAL_WORLD_MIN_SIZE=12;J.getRampStops=function(G,N,e,v,I,Y){return u.apply(this,arguments)};Object.defineProperties(J,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/smartMapping/support/utils":function(){define("exports ../../../Color ../../../core/maybe ../../../intl/date ../../../intl/number ../../../renderers/support/utils ../../../renderers/visualVariables/SizeVariable".split(" "),function(E,J,K,t,l,O,A){E.formatDateLabel=function(D){return t.formatDate(new Date(D),O.timelineDateFormatOptions)};E.formatNumberLabel=function(D){const P=Math.floor(Math.log10(Math.abs(D)))+1;return l.formatNumber(D,{notation:1E6<=
Math.abs(D)?"compact":"standard",minimumSignificantDigits:2,maximumSignificantDigits:4>P||6<P?4:P})};E.getDeviationValues=function(D,P,M){if(K.isNone(P)||K.isNone(D))return[];const H=[];for(let d=-1*M;d<=M;d++)0!==d&&H.push(P+d*D);return H};E.getDynamicPathForSizeStops=function(D){const {max:P,min:M,padding:H,pathHeight:d,pathWidth:h,stops:n}=D,u=P-M;let p=`M0 0 L${h} 0 `,S;D=3===n.length?[n[0],n[1],n[2]]:[n[0],n[2],n[4]];const Q=Math.min.apply(Math,D.map(x=>x.size)),B=Math.max(Math.abs(D[0].size-
D[1].size),Math.abs(D[2].size-D[1].size));D.reverse();D.forEach(({size:x,value:b},q)=>{b=Math.round(d-(b-M)/u*d);S=Math.round((x-Q)/B*100)/100*h;0===S&&(S=H*h);0===q&&(p+=`L${S} 0 `);p+=`L${S} ${b} `});return p+=`L${S} ${d} L0 ${d} L0 0 Z`};E.getFillFromColor=function(D){return D instanceof J?D.toCss(!0):J.fromString(D).toCss(!0)};E.getPathForSizeStops=function(D){const {bottomValue:P,bottomWidth:M,max:H,min:d,pathHeight:h,pathWidth:n,topValue:u,topWidth:p}=D;D=p*n;const S=M*n,Q=H-d;return`M${D} 0 L${D} ${Math.round(h-
(u-d)/Q*h)} L${S} ${Math.round(h-(P-d)/Q*h)} L${S} ${h} L0 ${h} L0 0 Z`};E.getSizesFromVariable=function(D){let P=D.maxSize;D=D.minSize;P instanceof A&&(P=P.stops[0].size);D instanceof A&&(D=D.stops[0].size);return[P,D]};E.getStopChanges=function(D,P,M){const H=M.length-1,d=M[0],h=M[H]-d,n=P-D,u=[];for(let p=1;p<H;p++)u.push({index:p,value:(M[p]-d)/h*n+D});u.unshift({index:0,value:D});u.push({index:H,value:P});return u};Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/renderers/support/utils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../intl/date ./numberUtils ../visualVariables/support/ColorStop ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),function(E,J,K,t,l,O,A,D,P,M,H){function d(b,q,C){l.getOrCreateMapValue(b,q,()=>[]).push(...C)}function h(){h=J._asyncToGenerator(function*(b){const q=
new Map;if("visualVariables"in b&&b.visualVariables){var C=b.visualVariables.filter(w=>"color"===w.type);for(const w of C){C=w.field||w.valueExpression;const T=(yield M.getRampStops(w)).map(y=>y.color);d(q,C,T)}}if("heatmap"===b.type){var c=H.getHeatmapRampStops(b).map(w=>w.color);d(q,b.field,c)}else if("pie-chart"===b.type){for(const w of b.attributes)d(q,w.field,[w.color]);d(q,null,[null==b?void 0:null==(c=b.othersCategory)?void 0:c.color,P.getColorFromSymbol(b.backgroundFillSymbol,null)])}else if("dot-density"===
b.type){for(const w of b.attributes)d(q,w.field,[w.color]);d(q,null,[b.backgroundColor])}else if("unique-value"===b.type){var m;if("predominance"===(null==(m=b.authoringInfo)?void 0:m.type))for(const w of b.uniqueValueInfos)d(q,w.value.toString(),[P.getColorFromSymbol(w.symbol,null)]);else{c=b.uniqueValueInfos.map(F=>P.getColorFromSymbol(F.symbol,null));const {field:w,field2:T,field3:y,valueExpression:f}=b;(w||f)&&d(q,w||f,c);T&&d(q,T,c);y&&d(q,y,c)}}else"class-breaks"===b.type?(c=b.classBreakInfos.map(w=>
P.getColorFromSymbol(w.symbol,null)),d(q,b.field||b.valueExpression,c)):"simple"===b.type&&d(q,null,[P.getColorFromSymbol(b.symbol,null)]);"defaultSymbol"in b&&b.defaultSymbol&&d(q,null,[P.getColorFromSymbol(b.defaultSymbol,null)]);q.forEach((w,T)=>{w=K.unique(w.filter(Boolean),(y,f)=>JSON.stringify(y)===JSON.stringify(f));q.set(T,w)});return q});return h.apply(this,arguments)}function n(b,q,C){let c="";0===q?c=Q.lt+" ":q===C&&(c=Q.gt+" ");return c+b}function u(b){let q=b.minValue,C=b.maxValue;const c=
b.isFirstBreak?"":Q.gt+" ";b="percent-of-total"===b.normalizationType?Q.pct:"";q=null==q?"":A.format(q);C=null==C?"":A.format(C);return c+q+b+" "+Q.ld+" "+C+b}function p(b,q){return"normalizationField"in b&&b.normalizationField?{type:"normalized-field",field:b.field,normalizationField:b.normalizationField}:"field"in b&&b.field?{type:"field",field:b.field}:"valueExpression"in b&&b.valueExpression?{type:"expression",expression:b.valueExpression,title:b.valueExpressionTitle,returnType:q}:null}const S=
t.getLogger("esri.renderers.support.utils"),Q={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},B={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},x={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};t=O.convertDateFormatToIntlOptions("short-date");E.calculateDateFormatInterval=function(b){b=
b.map(w=>new Date(w));const q=b.length;let C=Infinity,c=null;for(let w=0;w<q-1;w++){const T=b[w];let y=Infinity,f=null;for(let F=w+1;F<q;F++){var m=b[F];m=T.getFullYear()!==m.getFullYear()&&"year"||T.getMonth()!==m.getMonth()&&"month"||T.getDate()!==m.getDate()&&"day"||T.getHours()!==m.getHours()&&"hour"||T.getMinutes()!==m.getMinutes()&&"minute"||T.getSeconds()!==m.getSeconds()&&"second"||"millisecond";const g=B[m];g<y&&(y=g,f=m)}y<C&&(C=y,c=f)}return c};E.createClassBreakLabel=u;E.createColorStops=
function(b){const {values:q,colors:C,labelIndexes:c,isDate:m,dateFormatOptions:w}=b;return q.map((T,y)=>{let f=null;if(!c||c.includes(y)){let F;(F=m?O.formatDate(T,w):A.format(T))&&(f=n(F,y,q.length-1))}return new D({value:T,color:C[y],label:f})})};E.createUniqueValueLabel=function(b){const {value:q,domain:C,fieldInfo:c,dateFormatInterval:m}=b;b=String(q);const w=C&&"codedValues"in C&&C.codedValues?C.getName(q):null;w?b=w:"number"===typeof q&&(b=c&&"date"===c.type?O.formatDate(q,m&&O.convertDateFormatToIntlOptions(x[m])):
A.format(q));return b};E.getAttribute=p;E.getAttributes=function(b,q){const C=[];if("class-breaks"===b.type||"heatmap"===b.type)C.push(p(b,"number"));else if("unique-value"===b.type){var c=b.authoringInfo;if(c&&"relationship"===c.type){if(c.field1&&c.field2){var m=c.field2.field;const w=c.field2.normalizationField;C.push(p({field:c.field1.field,normalizationField:c.field1.normalizationField}));C.push(p({field:m,normalizationField:w}))}}else m=b.uniqueValueInfos[0],c=null,m&&m.value&&(m=typeof b.uniqueValueInfos[0].value,
"string"===m||"number"===m)&&(c=m),C.push(p(b,c)),[b.field2,b.field3].forEach(w=>w&&C.push({type:"field",field:w}))}else"attributes"in b&&b.attributes.forEach(w=>C.push(p(w,"number")));(b=q?q(b):"visualVariables"in b?b.visualVariables:null)&&b.forEach(w=>C.push(p(w,"number")));return K.unique(C.filter(Boolean),(w,T)=>"field"===w.type&&"field"===T.type?w.field===T.field:"normalized-field"===w.type&&"normalized-field"===T.type?w.field===T.field&&w.normalizationField===T.normalizationField:"expression"===
w.type&&"expression"===T.type?w.expression===T.expression:!1)};E.getColorsFromRenderer=function(b){return h.apply(this,arguments)};E.setLabelsForClassBreaks=function(b){const q=b.classBreakInfos,C=b.normalizationType;let c=[];if(q&&q.length)if("standard-deviation"===b.classificationMethod)S.warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");else if(b.round){c.push(q[0].minValue);for(const m of q)c.push(m.maxValue);c=A.round(c);q.forEach((m,
w)=>{m.label=u({minValue:0===w?c[0]:c[w],maxValue:c[w+1],isFirstBreak:0===w,normalizationType:C})})}else q.forEach((m,w)=>{m.label=u({minValue:m.minValue,maxValue:m.maxValue,isFirstBreak:0===w,normalizationType:C})})};E.timelineDateFormatOptions=t;E.updateClassBreak=function(b){if("standard-deviation"===b.classificationMethod)S.warn("updateClassBreak","cannot update labels for class breaks generated using 'standard-deviation' method.");else{var q=b.classBreaks,C=b.change,c=C.index;C=C.value;var m=
q.length,w=-1,T=-1;0===c?w=c:c===m?T=c-1:(T=c-1,w=c);b=b.normalizationType;c=null;-1<w&&w<m&&(c=q[w],c.minValue=C,c.label=u({minValue:c.minValue,maxValue:c.maxValue,isFirstBreak:0===w,normalizationType:b}));-1<T&&T<m&&(c=q[T],c.maxValue=C,c.label=u({minValue:c.minValue,maxValue:c.maxValue,isFirstBreak:0===T,normalizationType:b}))}};E.updateColorStops=function(b){const {stops:q,changes:C,isDate:c,dateFormatOptions:m}=b,w=q.map(y=>y.value);b=[];for(const y of C)b.push(y.index),w[y.index]=y.value;const T=
A.round(w,{indexes:b});q.forEach((y,f)=>{y.value=w[f];if(null!=y.label){let F,g=null;(F=c?O.formatDate(T[f],m):A.format(T[f]))&&(g=n(F,f,q.length-1));y.label=g}})};Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Legend/styles/Card":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/Handles ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../symbols/support/svgUtils ../../../symbols/support/utils ../../Widget ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/decorators/accessibleHandler ../../support/decorators/messageBundle ../../support/jsxFactory ../../support/widgetUtils ../../../intl/substitute".split(" "),
function(E,J,K,t,l,O,A,D,P,M,H,d,h,n,u,p,S,Q,B,x,b,q,C){var c;(function(w){w.Auto="auto";w.Stack="stack";w.SideBySide="side-by-side"})(c||(c={}));const m=window.devicePixelRatio;K=function(w){function T(f,F){f=w.call(this,f,F)||this;f._handles=new t;f._hasIndicators=!1;f._selectedSectionName=null;f._sectionNames=[];f._sectionMap=new Map;f.activeLayerInfos=null;f.headingLevel=3;f.layout=c.Stack;f.messages=null;f.messagesCommon=null;f.type="card";f.view=null;return f}E._inheritsLoose(T,w);var y=T.prototype;
y.initialize=function(){this.own(l.watch(()=>this.activeLayerInfos,f=>{this._handles.removeAll();this._watchForSectionChanges(f)}))};y.destroy=function(){this._handles.destroy();this._handles=null};y.render=function(){this._hasIndicators=this.layout===c.Auto&&768>=this.view.container.clientWidth||this.layout===c.Stack;var f=this.activeLayerInfos;f=f&&f.toArray().map(k=>this._renderLegendForLayer(k)).filter(k=>!!k);this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||
(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const F=this._sectionNames.length;var g=this._sectionNames.map((k,V)=>{V=C.substitute(this.messagesCommon.pagination.pageText,{index:V+1,total:F});return b.tsx("div",{key:k,role:"tab",id:k,"aria-label":V,"aria-controls":`${k}-panel`,"aria-selected":(this._selectedSectionName===k).toString(),tabIndex:this._selectedSectionName===k?0:-1,title:V,onclick:this._selectSection,onkeydown:this._focusSection,
bind:this,class:this.classes("esri-legend--card__carousel-indicator",{["esri-legend--card__carousel-indicator--activated"]:this._selectedSectionName===k}),"data-section-name":k})});g=this._hasIndicators&&1<F?b.tsx("div",{class:"esri-legend--card__carousel-indicator-container",key:"carousel-navigation",role:"tablist"},g):null;f=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):f&&f.length?f:null;return b.tsx("div",{class:this.classes("esri-legend--card",{["esri-legend--stacked"]:this._hasIndicators})},
f?f:b.tsx("div",{class:"esri-legend--card__message"},this.messages.noLegend),g)};y._selectSection=function(f){if(f=f.target.getAttribute("data-section-name"))this._selectedSectionName=f};y._focusSection=function(f){switch(f.key){case "ArrowLeft":case "ArrowRight":this._switchSectionOnArrowPress(f);break;case "Enter":case " ":this._selectSection(f)}};y._switchSectionOnArrowPress=function(f){const F=f.key,g="ArrowLeft"===F?-1:1;f=f.target.getAttribute("data-section-name");f=this._sectionNames.indexOf(f);
const k=this._sectionNames;let V=null;-1!==f&&(k[f+g]?V=document.getElementById(k[f+g]):"ArrowLeft"===F?V=document.getElementById(k[k.length-1]):"ArrowRight"===F&&(V=document.getElementById(k[0])),V&&V.focus())};y._watchForSectionChanges=function(f){this._generateSectionNames();f&&(f.forEach(F=>{const g=`activeLayerInfo-${F.layer.uid}-version-change`;this._handles.remove(g);this._watchForSectionChanges(F.children);this._handles.add(l.watch(()=>F.version,()=>this._generateSectionNames()),g)}),this._handles.remove("activeLayerInfos-collection-change"),
this._handles.add(f.on("change",()=>this._watchForSectionChanges(f)),"activeLayerInfos-collection-change"))};y._generateSectionNames=function(){this._sectionNames.length=0;this._selectedSectionName=null;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)};y._getSectionName=function(f,F,g){return`${this.id}${f.uid}-type-${F.type}-${g}`};y._generateSectionNamesForActiveLayerInfo=function(f){f.children.forEach(this._generateSectionNamesForActiveLayerInfo,
this);f.legendElements&&f.legendElements.forEach((F,g)=>{this._sectionNames.push(this._getSectionName(f.layer,F,g))})};y._renderLegendForLayer=function(f){if(!f.ready)return null;if(f.children.length){var F=f.children.map(g=>this._renderLegendForLayer(g)).toArray();return b.tsx("div",{key:f.layer.uid,class:this.classes("esri-legend--card__service","esri-legend--card__group-layer")},b.tsx("div",{class:"esri-legend--card__service-caption-container"},f.title),F)}{if((F=f.legendElements)&&!F.length)return null;
const g=F.some(k=>"relationship-ramp"===k.type);F=F.map((k,V)=>this._renderLegendForElement(k,f,V,g)).filter(k=>!!k);return F.length?b.tsx("div",{key:f.layer.uid,class:this.classes("esri-legend--card__service",{["esri-legend--card__group-layer-child"]:!!f.parent})},b.tsx("div",{class:"esri-legend--card__service-caption-container"},b.tsx("div",{class:"esri-legend--card__service-caption-text"},f.title)),b.tsx("div",{class:"esri-legend--card__service-content"},F)):null}};y._renderLegendForElement=function(f,
F,g,k=!1){var V="color-ramp"===f.type,G="opacity-ramp"===f.type,N="size-ramp"===f.type;const e=F.layer;var v=null;"string"===typeof f.title?v=f.title:f.title&&(v=f.title,V=S.getTitle(this.messages,v,V||G),v=v.title?`${v.title} (${V})`:V);g=this._getSectionName(e,f,g);V=this._hasIndicators?b.tsx("div",null,b.tsx(Q.Heading,{level:this.headingLevel,class:"esri-legend--card__carousel-title"},F.title),b.tsx(Q.Heading,{level:Q.incrementHeadingLevel(this.headingLevel),class:"esri-legend--card__layer-caption"},
v)):v?b.tsx(Q.Heading,{level:this.headingLevel,class:"esri-legend--card__layer-caption"},v):null;v=F.effectList;G=null;"symbol-table"===f.type?(N=f.infos.map((I,Y)=>this._renderLegendForElementInfo(I,F,f.legendType,Y)).filter(I=>!!I),N.length&&(G=b.tsx("div",{class:this.classes({["esri-legend--card__label-container"]:!(N[0].properties.classes&&N[0].properties.classes["esri-legend--card__symbol-row"])&&!k,["esri-legend--card__relationship-label-container"]:k})},N))):"color-ramp"===f.type||"opacity-ramp"===
f.type||"heatmap-ramp"===f.type?G=this._renderLegendForRamp(f,e.opacity,v):N?G=this._renderSizeRamp(f,e.opacity):"pie-chart-ramp"===f.type?G=this._renderPieChartRamp(f):"relationship-ramp"===f.type?G=u.renderRelationshipRamp(f,this.id,e.opacity,v):"univariate-above-and-below-ramp"===f.type?G=this._renderUnivariateAboveAndBelowRamp(f,e.opacity,v):"univariate-color-size-ramp"===f.type&&(G=this._renderUnivariateColorSizeRamp(f,e.opacity,v));if(!G)return null;k=b.tsx("div",{key:g,class:"esri-legend--card__section",
id:`${g}-panel`,role:"tabpanel","aria-labelledby":g,tabIndex:0},[V,G]);this._sectionMap.set(g,k);return k};y._renderPieChartRamp=function(f){return b.tsx("div",{class:"esri-legend--card__pie-chart-ramp-preview",bind:f.preview,afterCreate:S.attachToNode})};y._renderUnivariateAboveAndBelowRamp=function(f,F,g){const {sizeRampElement:k,colorRampElement:V}=p.getUnivariateAboveAndBelowRampElements(f,F,"horizontal");if(!k)return null;f=p.getUnivariateSizeRampSize(k,"full",!0,"horizontal");var G=p.getUnivariateColorRampSize(k,
"above",!0,"horizontal"),N=p.getUnivariateColorRampSize(k,"below",!0,"horizontal");G=p.getUnivariateColorRampPreview(V,{width:G,height:12,rampAlignment:"horizontal",opacity:F,type:"above",effectList:g});F=p.getUnivariateColorRampPreview(V,{width:N,height:12,rampAlignment:"horizontal",opacity:F,type:"below",effectList:g});g=p.getUnivariateColorRampMargin(k,"card");N=k.infos.map(I=>I.label);const e=N.length-1;N=N.map((I,Y)=>0===Y||Y===e?b.tsx("div",{key:Y},I):null);const v={marginTop:"3px",display:"flex"};
q.isRTL(this.container)?v.marginRight=`${g}px`:v.marginLeft=`${g}px`;f={width:`${f}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return b.tsx("div",{class:"esri-legend--card__layer-row",key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},b.tsx("div",{class:this.classes("esri-legend--card__symbol-container","esri-legend__size-ramp--horizontal"),styles:{display:"flex",flexDirection:"row"}},k.infos.map((I,Y)=>b.tsx("div",{key:Y,class:"esri-legend--card__symbol",
bind:I.preview,afterCreate:S.attachToNode}))),G?b.tsx("div",{class:"esri-univariate-above-and-below-ramp__color--card",styles:v,key:"color-ramp-preview"},b.tsx("div",{bind:G,afterCreate:S.attachToNode}),b.tsx("div",{bind:F,afterCreate:S.attachToNode})):null,b.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},b.tsx("div",{class:"esri-legend__ramp-labels",styles:f},N)))};y._renderUnivariateColorSizeRamp=function(f,F,g){const {sizeRampElement:k,colorRampElement:V}=p.getUnivariateColorSizeRampElements(f,
"horizontal");if(!k)return null;f=p.getUnivariateSizeRampSize(k,"full",!1,"horizontal");var G=p.getUnivariateColorRampSize(k,"full",!1,"horizontal");F=p.getUnivariateColorRampPreview(V,{width:G,height:12,rampAlignment:"horizontal",opacity:F,type:"full",effectList:g});const N=p.getUnivariateColorRampMargin(k,"card"),e=k.infos.length-1;g=k.infos.map((v,I)=>0===I||I===e?b.tsx("div",{key:I},v.label):null);G={marginTop:"3px",display:"flex"};q.isRTL(this.container)?G.marginRight=`${N}px`:G.marginLeft=`${N}px`;
f={width:`${f}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return b.tsx("div",{class:"esri-legend--card__layer-row",key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},b.tsx("div",{class:this.classes("esri-legend--card__symbol-container","esri-legend__size-ramp--horizontal"),styles:{display:"flex",flexDirection:"row"}},k.infos.map((v,I)=>b.tsx("div",{key:I,class:"esri-legend--card__symbol",bind:v.preview,afterCreate:S.attachToNode}))),b.tsx("div",{class:"esri-univariate-above-and-below-ramp__color--card",
styles:G,key:"color-ramp-preview"},b.tsx("div",{bind:F,afterCreate:S.attachToNode})),b.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},b.tsx("div",{class:"esri-legend__ramp-labels",styles:f},g)))};y._renderLegendForElementInfo=function(f,F,g,k){var V=F.layer;if(f.type)return this._renderLegendForElement(f,F,k);g=S.isImageryStretchedLegend(V,g);if(f.preview){var G;if(!f.symbol||!f.symbol.type.includes("simple-fill")){if(!f.label)return b.tsx("div",{key:k,bind:f.preview,afterCreate:S.attachToNode});
F={["esri-legend--card__symbol-cell"]:this._hasIndicators};return b.tsx("div",{key:k,class:this.classes("esri-legend--card__layer-row",{["esri-legend--card__symbol-row"]:this._hasIndicators})},b.tsx("div",{class:this.classes(F),bind:f.preview,afterCreate:S.attachToNode}),b.tsx("div",{class:this.classes("esri-legend--card__image-label",{["esri-legend--card__label-cell"]:this._hasIndicators})},S.getTitle(this.messages,f.label,!1)||""))}let e=g=255,v=255,I=0,Y=255,ea=255,ba=255,L=0;const R=f.symbol.color&&
f.symbol.color.a,Z=f.symbol.outline&&f.symbol.outline.color&&f.symbol.outline.color.a;R&&(g=f.symbol.color.r,e=f.symbol.color.g,v=f.symbol.color.b,I=f.symbol.color.a*V.opacity);Z&&(Y=f.symbol.outline.color.r,ea=f.symbol.outline.color.g,ba=f.symbol.outline.color.b,L=f.symbol.outline.color.a*V.opacity);var N=(V=null!=(N=null==(G=f.symbol.color)?void 0:G.isBright)?N:!0)?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";F={background:R?`rgba(${g}, ${e}, ${v}, ${I})`:"none",color:V?"black":"white",textShadow:`-1px -1px 0 ${N},\n                                              1px -1px 0 ${N},\n                                              -1px 1px 0 ${N},\n                                              1px 1px 0 ${N}`,
border:Z?`1px solid rgba(${Y}, ${ea}, ${ba}, ${L})`:"none",filter:h.getCSSFilterFromEffectList(F.effectList)};return b.tsx("div",{key:k,class:"esri-legend--card__layer-row"},b.tsx("div",{class:"esri-legend--card__label-element",styles:F}," ",f.label," "))}if(f.src)return F=this._renderImage(f,V,g),b.tsx("div",{key:k,class:"esri-legend--card__layer-row"},F,b.tsx("div",{class:"esri-legend--card__image-label"},f.label||""))};y._renderImage=function(f,F,g){const {label:k,src:V,opacity:G}=f;g={["esri-legend--card__imagery-layer-image--stretched"]:g,
["esri-legend--card__symbol"]:!g};F={opacity:`${null!=G?G:F.opacity}`};return b.tsx("img",{alt:S.getTitle(this.messages,k,!1),src:V,border:0,width:f.width,height:f.height,class:this.classes(g),styles:F})};y._renderSizeRampLines=function(f){f=f.infos;var F=f[0],g=f[f.length-1],k=F.symbol;f=this._hasIndicators;F=O.pt2px(F.size+F.outlineSize)*m;g=O.pt2px(g.size+g.outlineSize)*m;const V=f?F:F+50*m,G=f?F/2+50*m:F;var N;k?k.type.includes("3d")?(N=k.symbolLayers&&k.symbolLayers.length)?(N=k.symbolLayers.getItemAt(N-
1).get("resource.primitive"),N="triangle"===N||"cone"===N||"tetrahedron"===N):N=void 0:N="triangle"===k.style:N=void 0;if(k)if(k.type.includes("3d")){var e=k.symbolLayers&&k.symbolLayers.length;e?(k=k.symbolLayers.getItemAt(e-1),k=k.resource&&k.resource.primitive,k="circle"===k||"cross"===k||"kite"===k||"sphere"===k||"cube"===k||"diamond"===k):k=void 0}else k=k.style,k="circle"===k||"diamond"===k||"cross"===k;else k=void 0;e=document.createElement("canvas");e.width=V;e.height=G;e.style.width=`${e.width/
m}px`;e.style.height=`${e.height/m}px`;const v=e.getContext("2d");if(f){v.beginPath();var I=V/2-g/2;v.moveTo(0,0);v.lineTo(I,G);I=V/2+g/2;v.moveTo(V,0);v.lineTo(I,G)}else v.beginPath(),v.moveTo(0,G/2-g/2),v.lineTo(V,0),v.moveTo(0,G/2+g/2),v.lineTo(V,G);v.strokeStyle="#ddd";v.stroke();return b.tsx("div",{bind:e,afterCreate:S.attachToNode,styles:f?{display:"flex",marginTop:`-${N?0:k?F/2:0}px`,marginBottom:`-${N?g:k?g/2:0}px`}:{display:"flex",marginRight:`-${N?0:k?F/2:0}px`,marginLeft:`-${N?0:k?g/2:
0}px`}})};y._renderSizeRamp=function(f,F){var g=f.infos;const k=g[0].label,V=g[g.length-1].label;let G=g[0].preview;g=g[g.length-1].preview;const N=this._hasIndicators,e={"flex-direction":N?"column":"row-reverse"};G&&(G=G.cloneNode(!0),G.style.display="flex");g&&(g=g.cloneNode(!0),g.style.display="flex");F={opacity:null!=F?`${F}`:""};return b.tsx("div",{class:this.classes("esri-legend--card__layer-row",{["esri-legend--card__size-ramp-row"]:N})},b.tsx("div",{class:"esri-legend--card__ramp-label"},
N?k:V),b.tsx("div",{class:"esri-legend--card__size-ramp-container",styles:e},b.tsx("div",{bind:G,afterCreate:S.attachToNode,class:"esri-legend--card__size-ramp-preview",styles:F}),this._renderSizeRampLines(f),b.tsx("div",{bind:g,afterCreate:S.attachToNode,class:"esri-legend--card__size-ramp-container",styles:F})),b.tsx("div",{class:"esri-legend--card__ramp-label"},N?V:k))};y._renderLegendForRamp=function(f,F,g){var k=f.infos;const V="heatmap-ramp"===f.type,G=k.length-1;var N=2<G&&!V?25*G:100,e=N+
20;const v=k.slice(0).reverse();v.forEach((ea,ba)=>{ea.offset=V?ea.ratio:ba/G});const I=v.length-1;f=(f=0!==v.length%2&&v[v.length/2|0])&&b.tsx("div",{class:"esri-legend--card__interval-separators-container"},b.tsx("div",{class:"esri-legend--card__interval-separator"},"|"),b.tsx("div",{class:"esri-legend--card__ramp-label"},f.label));const Y=k[k.length-1].label;k=k[0].label;N=d.renderSVG([[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:v[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,
y:0,width:N,height:25},fill:{type:"linear",x1:10,y1:0,x2:N+10,y2:0,colors:v},stroke:{width:0}},{shape:{type:"path",path:`M${N+10} 0 L${e} ${12.5} L${N+10} ${25} Z`},fill:v[I].color,stroke:{width:0}}]],e,25);({messages:e}=this);F={filter:h.getCSSFilterFromEffectList(g),opacity:null==F?null:`${F}`};return b.tsx("div",{class:"esri-legend--card__layer-row",styles:{justifyContent:"center"}},b.tsx("div",{class:"esri-legend--card__ramp-label"},V?e[Y]:Y),b.tsx("div",{class:"esri-legend--card__symbol-container"},
b.tsx("div",{styles:F},N),f),b.tsx("div",{class:"esri-legend--card__ramp-label"},V?e[k]:k))};return T}(n);J.__decorate([A.property()],K.prototype,"activeLayerInfos",void 0);J.__decorate([A.property()],K.prototype,"headingLevel",void 0);J.__decorate([A.property()],K.prototype,"layout",void 0);J.__decorate([A.property(),x.messageBundle("esri/widgets/Legend/t9n/Legend")],K.prototype,"messages",void 0);J.__decorate([A.property(),x.messageBundle("esri/t9n/common")],K.prototype,"messagesCommon",void 0);
J.__decorate([A.property({readOnly:!0})],K.prototype,"type",void 0);J.__decorate([A.property()],K.prototype,"view",void 0);J.__decorate([B.accessibleHandler()],K.prototype,"_selectSection",null);return K=J.__decorate([H.subclass("esri.widgets.Legend.styles.Card")],K)})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(E,
J,K,t,l){function O(P,M,H){const d=`${H}_arrowStart`;H=`${H}_arrowEnd`;P="left"===P;const h={markerStart:null,markerEnd:null};switch(M){case "HL":P?h.markerStart=`url(#${H})`:h.markerEnd=`url(#${d})`;break;case "LL":h.markerStart=`url(#${H})`;break;case "LH":P?h.markerEnd=`url(#${d})`:h.markerStart=`url(#${H})`;break;default:h.markerEnd=`url(#${d})`}return h}function A(P,M,H,d,h=60){const {focus:n,numClasses:u,colors:p,rotation:S}=P;P=!!n;const Q=Math.sqrt(h**2+h**2)+(P?0:5),B=[],x=[];var b=[],q=
(h||75)/u;for(var C=0;C<u;C++){var c=C*q;for(var m=0;m<u;m++){var w=m*q;const T=J.generateFillAttributes(p[C][m]),y=J.generateStrokeAttributes(null);w={type:"rect",x:w,y:c,width:q,height:q};B.push(J.renderDef(T));x.push(J.renderShape(w,T.fill,y,null));b.push(J.getBoundingBox(w))}}q=null;P||(q="margin: -15px -15px -18px -15px");C=O("left",n,M);c=O("right",n,M);m=J.computeBBox(b);b=J.getTransformMatrix(m,Q,Q,0,!1,S,!1);m=J.getTransformMatrix(m,Q,Q,0,!1,P?-45:null,!1);H={filter:K.getCSSFilterFromEffectList(d),
opacity:null==H?null:`${H}`};return l.tsx("div",{styles:H,class:P?D.diamondMidColRamp:D.squareTableCell},l.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:Q,height:Q,style:q},l.tsx("defs",null,l.tsx("marker",{id:`${M}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},l.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),l.tsx("marker",{id:`${M}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",
markerUnits:"strokeWidth",orient:"auto"},l.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),B),l.tsx("g",{transform:b},x),l.tsx("g",{transform:m},l.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":C.markerStart,"marker-end":C.markerEnd,x1:-10,y1:h-15,x2:-10,y2:15}),l.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":c.markerStart,"marker-end":c.markerEnd,x1:15,y1:h+10,x2:h-15,y2:h+10}))))}const D={diamondContainer:"esri-relationship-ramp--diamond__container",
diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",
squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};E.renderRelationshipRamp=function(P,M,H,d){const {focus:h,labels:n}=P,u=!!h;P=A(P,M,H,d);M={justifyContent:"center"};
H=t.isRTL();return u?l.tsx("div",{class:D.diamondContainer,styles:M},l.tsx("div",{class:D.diamondLeftCol},H?n.right:n.left),l.tsx("div",{class:D.diamondMidCol},l.tsx("div",{class:D.diamondMidColLabel},n.top),P,l.tsx("div",{class:D.diamondMidColLabel},n.bottom)),l.tsx("div",{class:D.diamondRightCol},H?n.left:n.right)):l.tsx("div",{class:D.squareTable},l.tsx("div",{class:D.squareTableRow},l.tsx("div",{class:t.classes(D.squareTableCell,D.squareTableLabel,D.squareTableLabelRightBottom)},H?n.top:n.left),
l.tsx("div",{class:D.squareTableCell}),l.tsx("div",{class:t.classes(D.squareTableCell,D.squareTableLabel,D.squareTableLabelLeftBottom)},H?n.left:n.top)),l.tsx("div",{class:D.squareTableRow},l.tsx("div",{class:D.squareTableCell}),P,l.tsx("div",{class:D.squareTableCell})),l.tsx("div",{class:D.squareTableRow},l.tsx("div",{class:t.classes(D.squareTableCell,D.squareTableLabel,D.squareTableLabelRightTop)},H?n.right:n.bottom),l.tsx("div",{class:D.squareTableCell}),l.tsx("div",{class:t.classes(D.squareTableCell,
D.squareTableLabel,D.squareTableLabelLeftTop)},H?n.bottom:n.right)))};Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Legend/styles/support/univariateUtils":function(){define("exports ../../../../core/screenUtils ../../../../libs/maquette/projection ../../../../libs/maquette/projector ../../../../symbols/support/symbolUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),function(E,J,K,t,l,O,A){function D(n="vertical"){return"vertical"===
n?A.tsx("svg",{height:"4",width:"10"},A.tsx("line",{x1:"0",y1:"2",x2:"10",y2:"2",style:"stroke:rgb(200, 200, 200);stroke-width:1"})):A.tsx("svg",{height:"10",width:"10"},A.tsx("line",{x1:"5",y1:"0",x2:"5",y2:"10",style:"stroke:rgb(200, 200, 200);stroke-width:1"}))}function P(n,u="vertical"){const p=document.createElement("div");p.style.height="20px";p.className=h.univariateAboveAndBelowSymbol;null!=n&&(p.style.opacity=n.toString());d.append(p,D.bind(null,u));return p}function M(n,u,p="vertical",S){n.infos.forEach((Q,
B)=>{if(S&&2===B)Q.preview=P(u,p);else{B=J.pt2px(Q.size)+("horizontal"===p?20:10);const x="div"===Q.preview.tagName.toLowerCase(),b=x?Q.preview:document.createElement("div");b.className=h.univariateAboveAndBelowSymbol;"horizontal"===p?b.style.width=`${B}px`:b.style.height=`${B}px`;x||b.appendChild(Q.preview);Q.preview=b}})}function H(n,u,p,S="vertical"){let Q=0;n=n.infos;const B=Math.floor(n.length/2);var x="full"===u||"above"===u?0:B;for(u="full"===u||"below"===u?n.length-1:B;x<=u;x++)if(p&&x===
B)Q+="horizontal"===S?10:20;else{const b=J.pt2px(n[x].size)+("horizontal"===S?20:10);Q+=b}return Math.round(Q)}const d=t.createProjector(),h={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};E.getUnivariateAboveAndBelowRampElements=function(n,u,p="vertical"){var S=n.infos;n=S.find(({type:x})=>"size-ramp"===x);S=S.find(({type:x})=>"color-ramp"===x);n&&(n={...n},n.infos=[...n.infos],M(n,u,p,!0));S&&(S={...S},S.infos=[...S.infos]);if("horizontal"===
p){var Q,B;null==(Q=n)?void 0:Q.infos.reverse();null==(B=S)?void 0:B.infos.reverse()}return{sizeRampElement:n,colorRampElement:S}};E.getUnivariateColorRampMargin=function(n,u="classic"){n=n.infos;return"classic"===u?(J.pt2px(n[0].size)+10)/2:(J.pt2px(n[0].size)-J.pt2px(n[n.length-1].size))/2};E.getUnivariateColorRampPreview=function(n,u){if(!n)return null;n=n.infos.map(p=>p.color);n=l.renderColorRampPreviewHTML("full"===u.type?n:"above"===u.type?n.slice(0,3):n.slice(2,5),{width:u.width,height:u.height,
align:u.rampAlignment,effectList:u.effectList});n.className=h.colorRamp;null!=u.opacity&&(n.style.opacity=u.opacity.toString());return n};E.getUnivariateColorRampSize=function(n,u,p,S="vertical"){const Q=H(n,u,p,S);n=n.infos;var B=Math.floor(n.length/2);const x="full"===u||"above"===u?0:B;B="full"===u||"below"===u?n.length-1:B;p=p?"vertical"===S?20:10:0;S="vertical"===S?10*("full"===u?2:1):20*("full"===u?2:1);return Math.round(Q-(J.pt2px("full"===u?n[x].size+n[B].size:"above"===u?n[x].size:n[B].size)/
2+p/2+S/2))};E.getUnivariateColorSizeRampElements=function(n,u="vertical"){var p=n.infos;n=p.find(({type:B})=>"size-ramp"===B);p=p.find(({type:B})=>"color-ramp"===B);n&&(n={...n},n.infos=[...n.infos],M(n,null,u,!1));p&&(p={...p},p.infos=[...p.infos]);if("horizontal"===u){var S,Q;null==(S=n)?void 0:S.infos.reverse();null==(Q=p)?void 0:Q.infos.reverse()}return{sizeRampElement:n,colorRampElement:p}};E.getUnivariateSizeRampSize=H;Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/widgets/Legend/support/styleUtils":function(){define(["exports","../../../intl","../../../intl/substitute"],function(E,J,K){E.attachToNode=function(t){t.appendChild(this)};E.getTitle=function(t,l,O){if(l){if("string"===typeof l||"number"===typeof l)return l;if("value"in l||"unit"in l)return K.substitute(t.dotValue,l);if("colorName"in l||"bandName"in l)return t[l.colorName]+": "+(t[l.bandName]||l.bandName);if("showCount"in l)return l.showCount?t.clusterCountTitle:null;var A=null;O?A=l.ratioPercentTotal?
"showRatioPercentTotal":l.ratioPercent?"showRatioPercent":l.ratio?"showRatio":l.normField?"showNormField":l.field?"showField":null:O||(A=l.normField?"showNormField":l.normByPct?"showNormPct":l.field?"showField":null);return A?K.substitute("showField"===A?"{field}":t[A],{field:l.field,normField:l.normField}):null}};E.isImageryStretchedLegend=function(t,l){return!!(l&&"Stretched"===l&&10.3<=t.version&&"esri.layers.ImageryLayer"===t.declaredClass)};E.isRendererTitle=function(t,l){return!l};Object.defineProperties(E,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./widgetUtils","./jsxFactory"],function(E,J,K,t){const l={heading:"esri-widget__heading"};E.CSS=l;E.Heading=function(O,A){const D=J.clamp(Math.ceil(O.level),1,6),P=`h${D}`;delete O.level;return t.tsx(P,{...O,class:K.classes(l.heading,O.class),role:"heading","aria-level":String(D)},A)};E.incrementHeadingLevel=function(O,A=1){return J.clamp(Math.ceil(O+
A),1,6)};Object.defineProperties(E,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/widgets/Legend/styles/Classic":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../Widget ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/jsxFactory ../../../intl/number".split(" "),
function(E,J,K,t,l,O,A,D,P,M,H,d,h,n,u,p,S){const Q={display:"flex",alignItems:"flex-start"},B={marginLeft:"3px"},x={display:"table-cell",verticalAlign:"middle"};K=function(b){function q(c,m){c=b.call(this,c,m)||this;c.activeLayerInfos=null;c.headingLevel=3;c.messages=null;c.type="classic";return c}E._inheritsLoose(q,b);var C=q.prototype;C.render=function(){var c=this.activeLayerInfos;c=c&&c.toArray().map(m=>this._renderLegendForLayer(m)).filter(m=>!!m);return p.tsx("div",null,c&&c.length?c:p.tsx("div",
{class:"esri-legend__message"},this.messages.noLegend))};C._renderLegendForLayer=function(c){if(!c.ready)return null;var m=!!c.children.length;const w=`${"esri-legend__"}${c.layer.uid}-version-${c.version}`,T=c.title?h.Heading({level:this.headingLevel,class:this.classes("esri-widget__heading","esri-legend__service-label")},c.title):null;if(m)return m=c.children.map(y=>this._renderLegendForLayer(y)).toArray(),p.tsx("div",{key:w,class:this.classes("esri-legend__service","esri-legend__group-layer")},
T,m);if((m=c.legendElements)&&!m.length)return null;m=m.map(y=>this._renderLegendForElement(y,c.layer,c.effectList)).filter(y=>!!y);return m.length?p.tsx("div",{key:w,class:this.classes("esri-legend__service",{["esri-legend__group-layer-child"]:!!c.parent}),tabIndex:0},T,p.tsx("div",{class:"esri-legend__layer"},m)):null};C._renderLegendForElement=function(c,m,w,T){var y="color-ramp"===c.type,f="opacity-ramp"===c.type;const F="size-ramp"===c.type;let g=null;if("symbol-table"===c.type||F){var k=c.infos.map(G=>
this._renderLegendForElementInfo(G,m,w,F,c.legendType)).filter(G=>!!G);k.length&&(g=p.tsx("div",{class:"esri-legend__layer-body"},k))}else"color-ramp"===c.type||"opacity-ramp"===c.type||"heatmap-ramp"===c.type||"stretch-ramp"===c.type?g=this._renderLegendForRamp(c,m.opacity):"relationship-ramp"===c.type?g=M.renderRelationshipRamp(c,this.id,m.opacity,w):"pie-chart-ramp"===c.type?g=this._renderPieChartRamp(c):"univariate-above-and-below-ramp"===c.type?g=this._renderUnivariateAboveAndBelowRamp(c,m.opacity,
w):"univariate-color-size-ramp"===c.type&&(g=this._renderUnivariateColorSizeRamp(c,m.opacity,w));if(!g)return null;k=c.title;var V=null;"string"===typeof k?V=k:k&&(V=d.getTitle(this.messages,k,y||f),V=d.isRendererTitle(k,y||f)&&k.title?`${k.title} (${V})`:V);y=T?"esri-legend__layer-child-table":"esri-legend__layer-table";f=V?p.tsx("div",{class:"esri-legend__layer-caption"},V):null;return p.tsx("div",{class:this.classes(y,{["esri-legend__layer-table--size-ramp"]:F||!T})},f,g)};C._renderPieChartRamp=
function(c){return p.tsx("div",{bind:c.preview,afterCreate:d.attachToNode})};C._renderUnivariateAboveAndBelowRamp=function(c,m,w){const {sizeRampElement:T,colorRampElement:y}=H.getUnivariateAboveAndBelowRampElements(c,m);if(!T)return null;var f=H.getUnivariateColorRampSize(T,"above",!0);c=H.getUnivariateColorRampSize(T,"below",!0);const F=H.getUnivariateColorRampPreview(y,{width:12,height:f,rampAlignment:"vertical",opacity:m,type:"above",effectList:w});m=H.getUnivariateColorRampPreview(y,{width:12,
height:c,rampAlignment:"vertical",opacity:m,type:"below",effectList:w});var g=H.getUnivariateColorRampMargin(T);const k=T.infos.map(v=>v.label);w=k.map((v,I)=>{const Y=2===I;return 0===I?p.tsx("div",{key:I,class:v?F?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},v):Y?p.tsx("div",null):null});const V=k.length-1,G=Math.floor(k.length/2),N=k.map((v,I)=>{const Y=I===V;return I===G||Y?p.tsx("div",{key:I,class:v?F?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":
null},v):null}),e={display:"table-cell",verticalAlign:"middle"};g={marginTop:`${g}px`};f={height:`${f}px`};c={height:`${c}px`};return p.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:Q},p.tsx("div",{class:"esri-legend__layer-body"},T.infos.map((v,I)=>p.tsx("div",{class:this.classes("esri-legend__layer-row","esri-legend__size-ramp")},p.tsx("div",{class:"esri-legend__symbol",styles:e,bind:v.preview,afterCreate:d.attachToNode}),F||0!==I%2?null:p.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},
k[I])))),F?p.tsx("div",{styles:g,key:"color-ramp-preview"},p.tsx("div",{styles:B},p.tsx("div",{styles:x},p.tsx("div",{class:"esri-legend__ramps",bind:F,afterCreate:d.attachToNode})),p.tsx("div",{styles:x},p.tsx("div",{class:"esri-legend__ramp-labels",styles:f},w))),p.tsx("div",{styles:B},p.tsx("div",{styles:x},p.tsx("div",{class:"esri-legend__ramps",bind:m,afterCreate:d.attachToNode})),p.tsx("div",{styles:x},p.tsx("div",{class:"esri-legend__ramp-labels",styles:c},N)))):null)};C._renderUnivariateColorSizeRamp=
function(c,m,w){const {sizeRampElement:T,colorRampElement:y}=H.getUnivariateColorSizeRampElements(c);if(!T)return null;var f=H.getUnivariateColorRampMargin(T);c=H.getUnivariateColorRampSize(T,"full",!1);m=H.getUnivariateColorRampPreview(y,{width:12,height:c,rampAlignment:"vertical",opacity:m,type:"full",effectList:w});const F=T.infos.length-1;w=T.infos.map((k,V)=>0===V||V===F?p.tsx("div",{key:V,class:k.label?y?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},k.label):
null);const g={display:"table-cell",verticalAlign:"middle"};f={marginTop:`${f}px`};c={height:`${c}px`};return p.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:Q},p.tsx("div",{class:"esri-legend__layer-body"},T.infos.map(k=>p.tsx("div",{class:this.classes("esri-legend__layer-row","esri-legend__size-ramp")},p.tsx("div",{class:"esri-legend__symbol",styles:g,bind:k.preview,afterCreate:d.attachToNode})))),p.tsx("div",{styles:f,key:"color-ramp-preview"},p.tsx("div",{styles:B},p.tsx("div",
{styles:x},p.tsx("div",{class:"esri-legend__ramps",bind:m,afterCreate:d.attachToNode})),p.tsx("div",{styles:x},p.tsx("div",{class:"esri-legend__ramp-labels",styles:c},w)))))};C._renderLegendForRamp=function(c,m){const w=c.infos,T="heatmap-ramp"===c.type,y="stretch-ramp"===c.type,f=c.preview;f.className=`${"esri-legend__color-ramp"} ${"opacity-ramp"===c.type?"esri-legend__opacity-ramp":""}`;null!=m&&(f.style.opacity=m.toString());c=w.map(F=>p.tsx("div",{class:F.label?"esri-legend__ramp-label":null},
T?this.messages[F.label]||F.label:y?this._getStretchStopLabel(F):F.label));m={height:f.style.height};return p.tsx("div",{class:"esri-legend__layer-row"},p.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},p.tsx("div",{class:"esri-legend__ramps",bind:f,afterCreate:d.attachToNode})),p.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},p.tsx("div",{class:"esri-legend__ramp-labels",styles:m},c)))};C._getStretchStopLabel=function(c){return c.label?
this.messages[c.label]+": "+("string"===typeof c.value?c.value:S.formatNumber(c.value,{style:"decimal",notation:c.value.toString().includes("e")?"scientific":"standard"})):""};C._renderLegendForElementInfo=function(c,m,w,T,y){if(c.type)return this._renderLegendForElement(c,m,w,!0);w=null;y=d.isImageryStretchedLegend(m,y);c.preview?w=p.tsx("div",{class:"esri-legend__symbol",bind:c.preview,afterCreate:d.attachToNode}):c.src&&(w=this._renderImage(c,m,y));if(!w)return null;m={["esri-legend__imagery-layer-info--stretched"]:y};
return p.tsx("div",{class:"esri-legend__layer-row"},p.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",{["esri-legend__imagery-layer-info--stretched"]:y,["esri-legend__size-ramp"]:!y&&T})},w),p.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",m)},d.getTitle(this.messages,c.label,!1)||""))};C._renderImage=function(c,m,w){const {label:T,src:y,opacity:f}=c;w={["esri-legend__imagery-layer-image--stretched"]:w,["esri-legend__symbol"]:!w};
m={opacity:`${null!=f?f:m.opacity}`};return p.tsx("img",{alt:d.getTitle(this.messages,T,!1),src:y,border:0,width:c.width,height:c.height,class:this.classes(w),styles:m})};return q}(P);J.__decorate([t.property()],K.prototype,"activeLayerInfos",void 0);J.__decorate([t.property()],K.prototype,"headingLevel",void 0);J.__decorate([t.property(),u.messageBundle("esri/widgets/Legend/t9n/Legend")],K.prototype,"messages",void 0);J.__decorate([t.property({readOnly:!0})],K.prototype,"type",void 0);return K=J.__decorate([D.subclass("esri.widgets.Legend.styles.Classic")],
K)})},"app/utils/closeBtn":function(){define(["require","exports"],function(E,J){Object.defineProperty(J,"__esModule",{value:!0});J.addCloseBtn=void 0;J.addCloseBtn=function(K,t,l){l.dismissible=!0}})},"app/utils/messageBundleLoader":function(){define(["require","exports","tslib","esri/intl","esri/request"],function(E,J,K,t,l){function O(D,P){return K.__awaiter(this,void 0,void 0,function(){var M,H;return K.__generator(this,function(d){switch(d.label){case 0:M=t.normalizeMessageBundleLocale(P),d.label=
1;case 1:return d.trys.push([1,3,,5]),[4,A("./js/app/"+D+"_"+M.toLowerCase()+".json")];case 2:return H=d.sent(),[2,H];case 3:return d.sent(),[4,A("./js/app/"+D+"_en.json")];case 4:return H=d.sent(),[2,H];case 5:return[2]}})})}function A(D){return K.__awaiter(this,void 0,void 0,function(){var P,M;return K.__generator(this,function(H){switch(H.label){case 0:return H.trys.push([0,2,,3]),[4,l.default(""+D,{responseType:"json"})];case 1:return P=H.sent(),[2,(null===P||void 0===P?void 0:P.data)||{}];case 2:throw M=
H.sent(),console.error("Error loading locale: "+D,M),Error(M);case 3:return[2]}})})}Object.defineProperty(J,"__esModule",{value:!0});J.fetchMessageBundles=J.createMessageBundleLoader=J.isLoadingLocale=void 0;t=K.__importStar(t);l=K.__importDefault(l);J.isLoadingLocale=!1;J.createMessageBundleLoader=function(D){return K.__awaiter(this,void 0,void 0,function(){var P,M,H;return K.__generator(this,function(d){H=/^mapviewer\/(.+)/;t.registerMessageBundleLoader({pattern:H,fetchMessageBundle:function(h,
n){return K.__awaiter(this,void 0,void 0,function(){var u,p;return K.__generator(this,function(S){switch(S.label){case 0:J.isLoadingLocale&&setTimeout(function(){return J.isLoadingLocale=!1},250);if(n===P)return[3,2];J.isLoadingLocale=!0;return[4,O("t9n/app",n)];case 1:M=S.sent(),P=n,S.label=2;case 2:return u=H.exec(h)[1],"all"!==u?[3,3]:[2,M];case 3:return M[u]?[2,M[u]]:[3,4];case 4:return[4,O(u,n)];case 5:return p=S.sent(),[2,p]}})})}});return[2]})})};J.fetchMessageBundles=function(D,P){return K.__awaiter(this,
void 0,void 0,function(){var M;return K.__generator(this,function(H){M=D.map(function(d){return t.fetchMessageBundle(d)});return[2,Promise.all(M)]})})}})}}});
define("require exports tslib esri/widgets/Legend ../../../../utils/closeBtn ../../../../utils/messageBundleLoader".split(" "),function(E,J,K,t,l,O){Object.defineProperty(J,"__esModule",{value:!0});J.createWidget=void 0;t=K.__importDefault(t);J.createWidget=function(A){return K.__awaiter(this,void 0,void 0,function(){var D,P,M,H,d,h,n,u,p,S,Q;return K.__generator(this,function(B){switch(B.label){case 0:return[4,O.fetchMessageBundles(["mapviewer/mapMaker"])];case 1:return D=B.sent()[0],P=A.state,M=
A.action,H=A.panel,d=P.mapView,h=A.container||document.createElement("div"),n=D.legend,u=document.createElement("calcite-flow"),h.appendChild(u),p=document.createElement("calcite-panel"),p.setAttribute("heading",n),l.addCloseBtn(H,M,p),u.appendChild(p),S=document.createElement("div"),p.appendChild(S),Q=new t.default({view:d,respectLayerVisibility:!0,keepCacheOnDestroy:!0,container:S}),[2,{destroy:function(){M.active=!1;Q.destroy()}}]}})})}});