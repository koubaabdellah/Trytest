// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.24/esri/copyright.txt for details.//>>built
require({cache:{"esri/views/2d/engine/Stage":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../core/events ../../../core/has ../../../core/maybe ../../../core/reactiveUtils ../../../core/scheduling ../../../chunks/mat3f32 ../../../symbols/cim/CIMResourceManager ./Container ./webgl/enums ./webgl/Painter ./webgl/Profiler ../support/Timeline ../../support/screenshotUtils ../../webgl/context-util ../../webgl/enums ../../webgl/FramebufferObject ../../webgl/RenderingContext".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g,c,m,q,p){let u=function(h){function t(w,A){var E=h.call(this)||this;E._trash=new Set;E._renderRemainingTime=0;E._lastFrameRenderTime=0;E.renderRequested=!1;E.stage=D._assertThisInitialized(E);E._stationary=!0;const {canvas:G=document.createElement("canvas"),alpha:F=!0,stencil:H=!0,contextOptions:J={}}=A;E._canvas=G;const I=c.createContextOrErrorHTML("2d",G,{alpha:F,antialias:!1,depth:!0,stencil:H});E.context=new p.RenderingContext(x.isSome(I)?I:null,J);E.resourceManager=
new a;E.painter=new l(E.context,D._assertThisInitialized(E),E.resourceManager);y("esri-2d-profiler")&&(E._debugOutput=document.createElement("div"),E._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),w.appendChild(E._debugOutput));E._renderParameters={drawPhase:0,state:E.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1,blendMode:null,deltaTime:-1,time:0,inFadeTransition:!1,effects:null,context:E.context,painter:E.painter,timeline:A.timeline||
new r.Timeline,renderingOptions:A.renderingOptions,requestRender:()=>E.requestRender(),requireFBO:!1,profiler:new k.Profiler(E.context,E._debugOutput),dataUploadCounter:0};E._taskHandle=f.addFrameTask({render:N=>E.renderFrame(N)});E._taskHandle.pause();E._lostWebGLContextHandle=B.on(G,"webglcontextlost",()=>{E.emit("webgl-error",{error:new C("webgl-context-lost")})});G.setAttribute("style","width: 100%; height:100%; display:block;");w.appendChild(G);return E}D._inheritsLoose(t,h);var v=t.prototype;
v.destroy=function(){this.removeAllChildren();this._emptyTrash();this._taskHandle.remove();this._taskHandle=null;this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.highlightOptions=null;this.resourceManager.destroy();this.painter.dispose();this.context.dispose();
this._canvas=null};v.trashDisplayObject=function(w){this._trash.add(w);this.requestRender()};v.untrashDisplayObject=function(w){return this._trash.delete(w)};v.requestRender=function(){this._renderRemainingTime=2E3;this.renderRequested||(this.renderRequested=!0,this.emit("will-render"),this._taskHandle.resume())};v.renderFrame=function(w){this._renderRemainingTime-=this._lastFrameRenderTime?w.time-this._lastFrameRenderTime:0;0>=this._renderRemainingTime&&this._taskHandle.pause();this._lastFrameRenderTime=
w.time;this.renderRequested=!1;this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this._renderParameters.time=w.time;this._renderParameters.deltaTime=w.deltaTime;this._renderParameters.effects=null;this.processRender(this._renderParameters);this._emptyTrash();this.emit("post-render")};v._createTransforms=function(){return{dvs:d.create()}};v.renderChildren=function(w){for(const A of this.children)A.beforeRender(w);
this._renderChildren(this.children,w);for(const A of this.children)A.afterRender(w)};v._renderChildren=function(w,A){const E=this.context;E.resetInfo();A.profiler.recordStart("drawLayers");A.dataUploadCounter=0;A.drawPhase=e.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(E,this.background);for(const G of w)G.processRender(A);this.painter.prepareDisplay(A,this.background,this.state.padding);this.painter.renderLayers(E);A.drawPhase=e.WGLDrawPhase.HIGHLIGHT;this.painter.beforeRenderLayers(E);for(const G of w)G.processRender(A);
this.painter.renderLayers(E);if(this._isLabelDrawPhaseRequired(w)){A.drawPhase=e.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(E);for(const G of w)G.processRender(A);this.painter.renderLayers(E)}if(y("esri-tiles-debug")){A.drawPhase=e.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(E);for(const G of w)G.processRender(A);this.painter.renderLayers(E)}A.profiler.recordEnd("drawLayers");E.logInfo()};v.doRender=function(w){const A=this.context,{state:E,pixelRatio:G}=w;this._resizeCanvas(w);A.setViewport(0,
0,G*E.size[0],G*E.size[1]);A.setDepthWriteEnabled(!0);A.setStencilWriteMask(255);h.prototype.doRender.call(this,w)};v.takeScreenshot=function(){var w=D._asyncToGenerator(function*(A){const {framebufferWidth:E,framebufferHeight:G}={framebufferWidth:Math.round(this.state.size[0]*A.resolutionScale),framebufferHeight:Math.round(this.state.size[1]*A.resolutionScale)};var F=this.context,H=this._state.clone();if(null!=A.rotation){var J=H.viewpoint;H.viewpoint.rotation=A.rotation;H.viewpoint=J}var I={...this._renderParameters,
drawPhase:null,globalOpacity:1,stationary:!0,state:H,pixelRatio:1,time:performance.now(),deltaTime:0,blendMode:null,effects:null,inFadeTransition:!1};const N=new q.FramebufferObject(F,{colorTarget:m.TargetType.TEXTURE,depthStencilTarget:m.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER,width:E,height:G});H=F.getBoundFramebufferObject();J=F.getViewport();F.bindFramebuffer(N);F.setViewport(0,0,E,G);this._renderChildren(A.children,I);I=this._readbackScreenshot(N,{...A.cropArea,y:G-(A.cropArea.y+A.cropArea.height)});
F.bindFramebuffer(H);F.setViewport(J.x,J.y,J.width,J.height);this.requestRender();F=yield I;1===A.outputScale?A=F:(A=new ImageData(Math.round(F.width*A.outputScale),Math.round(F.height*A.outputScale)),g.resampleHermite(F,A,!0));return A});return function(A){return w.apply(this,arguments)}}();v._readbackScreenshot=function(){var w=D._asyncToGenerator(function*(A,E){const G=g.createEmptyImageData(E.width,E.height,document.createElement("canvas"));yield A.readPixelsAsync(E.x,E.y,E.width,E.height,m.PixelFormat.RGBA,
m.PixelType.UNSIGNED_BYTE,new Uint8Array(G.data.buffer));return G});return function(A,E){return w.apply(this,arguments)}}();v._resizeCanvas=function(w){const A=this._canvas,E=A.style,{state:{size:G},pixelRatio:F}=w;w=G[0];const H=G[1],J=Math.round(w*F),I=Math.round(H*F);if(A.width!==J||A.height!==I)A.width=J,A.height=I;E.width=w+"px";E.height=H+"px"};v._emptyTrash=function(){for(;0<this._trash.size;){const w=Array.from(this._trash);this._trash.clear();for(const A of w)A.processDetach()}};v._isLabelDrawPhaseRequired=
function(w){let A=!1;for(const E of w){if(!(E instanceof b.Container)){A=A||!1;break}if(E.hasLabels)return!0;A=A||this._isLabelDrawPhaseRequired(E.children)}return A};D._createClass(t,[{key:"background",get:function(){return this._background},set:function(w){this._background=w;this.requestRender()}},{key:"highlightOptions",get:function(){return this._highlightOptions},set:function(w){this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=
w)this._highlightOptionsHandle=n.watch(()=>{var A;return null==(A=this._highlightOptions)?void 0:A.version},()=>{this.painter.setHighlightOptions(w);this.requestRender()},n.initial)}},{key:"renderingOptions",get:function(){return this._renderingOptions},set:function(w){this._renderingOptions=w;this.requestRender()}},{key:"state",get:function(){return this._state},set:function(w){this._state=w;this.requestRender()}},{key:"stationary",get:function(){return this._stationary},set:function(w){this._stationary!==
w&&(this._stationary=w,this.requestRender())}}]);return t}(b.Container);z.EXTRA_RENDER_TIME=2E3;z.Stage=u;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMResourceManager":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../request","../../core/Error","../../core/promiseUtils"],function(z,D,C,B){function y(x,n){if(x.includes(";base64,")){const f=new Image;f.src=x;return f.decode().then(()=>({ok:!0,value:f})).catch(d=>B.isAbortError(d)?
{ok:!1,error:d}:{ok:!1,error:new C("invalid-resource",`Could not fetch requested resource at ${x}`)})}return D(x,{responseType:"image",...n}).then(f=>({ok:!0,value:f.data})).catch(f=>B.isAbortError(f)?{ok:!1,error:f}:{ok:!1,error:new C("invalid-resource",`Could not fetch requested resource at ${x}`)})}return function(){function x(){this._resourceMap=new Map;this._inFlightResourceMap=new Map;this.geometryEngine=null}var n=x.prototype;n.destroy=function(){this._inFlightResourceMap.clear();this._resourceMap.clear()};
n.getResource=function(f){var d;return null!=(d=this._resourceMap.get(f))?d:null};n.fetchResource=function(){var f=z._asyncToGenerator(function*(d,a){const b={width:0,height:0},e=this._resourceMap;var l=e.get(d);if(l)return b.width=l.width,b.height=l.height,b;if(l=this._inFlightResourceMap.get(d))return l;l=y(d,a);this._inFlightResourceMap.set(d,l);return l=l.then(k=>{this._inFlightResourceMap.delete(d);k.ok&&(e.set(d,k.value),k=k.value,b.width=k.width,b.height=k.height);return b})});return function(d,
a){return f.apply(this,arguments)}}();n.deleteResource=function(f){this._inFlightResourceMap.delete(f);this._resourceMap.delete(f)};return x}()})},"esri/views/2d/engine/Container":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../chunks/mat3f32","../../../layers/effects/EffectView","./DisplayObject"],function(z,D,C,B,y){y=function(x){function n(){var d=x.apply(this,arguments)||this;d._childrenSet=new Set;d._needsSort=!1;d.children=[];d._effectView=null;return d}D._inheritsLoose(n,
x);var f=n.prototype;f.updateTransitionProperties=function(d,a){x.prototype.updateTransitionProperties.call(this,d,a);this._effectView&&(this._effectView.transitionStep(d,a),this._effectView.transitioning&&this.requestRender())};f.doRender=function(d){d=this.createRenderParams(d);this.renderChildren(d)};f.addChild=function(d){return this.addChildAt(d,this.children.length)};f.addChildAt=function(d,a=this.children.length){if(!d||this.contains(d))return d;this._needsSort=!0;const b=d.parent;b&&b!==this&&
b.removeChild(d);a>=this.children.length?this.children.push(d):this.children.splice(a,0,d);this._childrenSet.add(d);d.parent=this;d.stage=this.stage;this!==this.stage&&(d.clips=this.clips);this.requestRender();return d};f.contains=function(d){return this._childrenSet.has(d)};f.removeAllChildren=function(){this._childrenSet.clear();this._needsSort=!0;for(const d of this.children)this!==this.stage&&(d.clips=null),d.stage=null,d.parent=null;this.children.length=0};f.removeChild=function(d){return this.contains(d)?
this.removeChildAt(this.children.indexOf(d)):d};f.removeChildAt=function(d){if(0>d||d>=this.children.length)return null;this._needsSort=!0;d=this.children.splice(d,1)[0];this._childrenSet.delete(d);this!==this.stage&&(d.clips=null);d.stage=null;d.parent=null;return d};f.sortChildren=function(d){this._needsSort&&(this.children.sort(d),this._needsSort=!1)};f._createTransforms=function(){return{dvs:C.create()}};f.onAttach=function(){x.prototype.onAttach.call(this);const d=this.stage;for(const a of this.children)a.stage=
d};f.onDetach=function(){x.prototype.onDetach.call(this);for(const d of this.children)d.stage=null};f.renderChildren=function(d){for(const a of this.children)a.beforeRender(d);for(const a of this.children)a.processRender(d);for(const a of this.children)a.afterRender(d)};f.createRenderParams=function(d){return{...d,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:d.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition}};D._createClass(n,[{key:"blendMode",get:function(){return this._blendMode},
set:function(d){this._blendMode=d;this.requestRender()}},{key:"clips",get:function(){return this._clips},set:function(d){this._clips=d;this.children.forEach(a=>a.clips=d)}},{key:"computedEffects",get:function(){var d,a;return null!=(d=null==(a=this._effectView)?void 0:a.effects)?d:null}},{key:"effect",get:function(){var d,a;return null!=(d=null==(a=this._effectView)?void 0:a.effect)?d:""},set:function(d){if(this._effectView||d)this._effectView||(this._effectView=new B.EffectView),this._effectView.effect=
d,this.requestRender()}}]);return n}(y.DisplayObject);z.Container=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e){function l(g){g=b.parse(g)||[];var c=(c=g[0])?"type"in c:!1;return c?[{scale:-1,effects:g}]:g}function k(g,c,m){var q,p,u,h;return null!=(q=g[0])&&q.effects&&null!=(p=c[0])&&p.effects?(-1===(null==(u=g[0])?void 0:u.scale)||-1===(null==(h=c[0])?void 0:h.scale))&&(1<g.length||1<c.length)&&0>=m?!1:e.canInterpolateEffects(g[0].effects,c[0].effects):!0}function r(g,c,m){var q,p;const u=g.length>c.length?g:c;g=g.length>c.length?c:g;const h=g[g.length-1];c=null!=(q=null==
h?void 0:h.scale)?q:m;q=null!=(p=null==h?void 0:h.effects)?p:[];for(p=g.length;p<u.length;p++)g.push({scale:c,effects:[...q]});for(p=0;p<u.length;p++)g[p].scale=-1===g[p].scale?m:g[p].scale,u[p].scale=-1===u[p].scale?m:u[p].scale,e.normalizeEffects(g[p].effects,u[p].effects)}z.EffectView=function(g){function c(q){q=g.call(this,q)||this;q._from=null;q._to=null;q._final=null;q._current=[];q._time=0;q.duration=y("mapview-transitions-duration");q.effects=[];return q}D._inheritsLoose(c,g);var m=c.prototype;
m.canTransitionTo=function(q){try{return 0<this.scale&&k(this._current,l(q),this.scale)}catch{return!1}};m.transitionStep=function(q,p){this._applyTimeTransition(q);this._updateForScale(p)};m.end=function(){this._applyTimeTransition(this.duration)};m._transitionTo=function(q){0<this.scale&&k(this._current,q,this.scale)?(this._final=q,this._to=x.clone(q),r(this._current,this._to,this.scale),this._from=x.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=q);this._set("effects",
this._current[0]?x.clone(this._current[0].effects):[])};m._applyTimeTransition=function(q){if(this._to&&this._from&&this._current&&this._final){this._time+=q;q=Math.min(1,this._time/this.duration);for(let u=0;u<this._current.length;u++){const h=this._current[u],t=this._from[u],v=this._to[u];var p=t.scale;h.scale=p+(v.scale-p)*q;for(p=0;p<h.effects.length;p++)h.effects[p].interpolate(t.effects[p],v.effects[p],q)}1===q&&(this._current=this._final,this._set("effects",this._current[0]?x.clone(this._current[0].effects):
[]),this._from=this._to=this._final=null)}};m._updateForScale=function(q){this._set("scale",q);if(0!==this._current.length){var p=this._current,u=this._current.length-1,h,t=1;if(1===p.length||q>=p[0].scale)var v=h=p[0].effects;else if(q<=p[u].scale)v=h=p[u].effects;else for(let w=0;w<u;w++){const A=p[w],E=p[w+1];if(A.scale>=q&&E.scale<=q){t=(q-A.scale)/(E.scale-A.scale);h=A.effects;v=E.effects;break}}for(q=0;q<this.effects.length;q++)this.effects[q].interpolate(h[q],v[q],t)}};D._createClass(c,[{key:"effect",
set:function(q){const p=this._get("effect");q=q||"";if(p!==q){this._set("effect",q);try{this._transitionTo(l(q))}catch(u){this._transitionTo([]),n.getLogger(this.declaredClass).warn("Invalid Effect",{effect:q,error:u})}}}},{key:"hasEffects",get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(q){this._updateForScale(q)}},{key:"transitioning",get:function(){return null!==this._to}}]);return c}(B);C.__decorate([f.property()],z.EffectView.prototype,"_to",void 0);
C.__decorate([f.property()],z.EffectView.prototype,"duration",void 0);C.__decorate([f.property({value:""})],z.EffectView.prototype,"effect",null);C.__decorate([f.property({readOnly:!0})],z.EffectView.prototype,"effects",void 0);C.__decorate([f.property({readOnly:!0})],z.EffectView.prototype,"hasEffects",null);C.__decorate([f.property({value:0})],z.EffectView.prototype,"scale",null);C.__decorate([f.property({readOnly:!0})],z.EffectView.prototype,"transitioning",null);z.EffectView=C.__decorate([a.subclass("esri.layers.effects.EffectView")],
z.EffectView);z.canInterpolateEffectStops=k;z.convertEffectToStops=l;z.normalizeEffectStops=r;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/DisplayObject":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Evented ../../../core/has ../../../core/maybe ../../../core/promiseUtils".split(" "),function(z,D,C,B,y,x){const n=1/B("mapview-transitions-duration");C=function(f){function d(){var b=f.apply(this,
arguments)||this;b._fadeOutResolver=null;b._fadeInResolver=null;b._clips=null;b.computedVisible=!0;b.computedOpacity=1;b.fadeTransitionEnabled=!1;b.inFadeTransition=!1;b._isReady=!1;b._opacity=1;b._stage=null;b._visible=!0;return b}D._inheritsLoose(d,f);var a=d.prototype;a._getTransforms=function(){y.isNone(this._transforms)&&(this._transforms=this._createTransforms());return this._transforms};a.fadeIn=function(){if(this._fadeInResolver)return this._fadeInResolver.promise;this._fadeOutResolver&&(this._fadeOutResolver(),
this._fadeOutResolver=null);this.computedOpacity=0;this.fadeTransitionEnabled=!0;this._fadeInResolver=x.createResolver();this.requestRender();return this._fadeInResolver.promise};a.fadeOut=function(){if(this._fadeOutResolver)return this._fadeOutResolver.promise;this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this.fadeTransitionEnabled=!0;this._fadeOutResolver=x.createResolver();this.requestRender();return this._fadeOutResolver.promise};a.beforeRender=function(b){this.updateTransitionProperties(b.deltaTime,
b.state.scale)};a.afterRender=function(b){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)};a.remove=function(){var b;null==(b=this.parent)?void 0:b.removeChild(this)};a.setTransform=function(b){};a.processRender=function(b){this.stage&&this.computedVisible&&this.doRender(b)};a.requestRender=function(){this.stage&&this.stage.requestRender()};
a.processDetach=function(){this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null);this.onDetach();this.emit("detach")};a.updateTransitionProperties=function(b,e){if(this.fadeTransitionEnabled){e=this._fadeOutResolver||!this.visible?0:this.opacity;const l=this.computedOpacity;l===e?this.computedVisible=this.visible:(b*=n,this.computedOpacity=l>e?Math.max(e,l-b):Math.min(e,l+b),this.computedVisible=0<this.computedOpacity,
b=e===this.computedOpacity,this.inFadeTransition=!b,b||this.requestRender())}else this.computedOpacity=this.opacity,this.computedVisible=this.visible};a.onAttach=function(){};a.onDetach=function(){};a.doRender=function(b){};a.ready=function(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())};D._createClass(d,[{key:"clips",get:function(){return this._clips},set:function(b){this._clips=b;this.requestRender()}},{key:"isReady",get:function(){return this._isReady}},{key:"opacity",
get:function(){return this._opacity},set:function(b){this._opacity!==b&&(this._opacity=Math.min(1,Math.max(b,0)),this.requestRender())}},{key:"stage",get:function(){return this._stage},set:function(b){if(this._stage!==b){var e=this._stage;(this._stage=b)?this._stage.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):e.trashDisplayObject(this)}}},{key:"transforms",get:function(){return this._getTransforms()}},{key:"visible",get:function(){return this._visible},set:function(b){this._visible!==
b&&(this._visible=b,this.requestRender())}}]);return d}(C);z.DisplayObject=C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(z){z.WGLGeometryType=void 0;(function(D){D[D.FILL=0]="FILL";D[D.LINE=1]="LINE";D[D.MARKER=2]="MARKER";D[D.TEXT=3]="TEXT";D[D.LABEL=4]="LABEL"})(z.WGLGeometryType||(z.WGLGeometryType={}));z.WGLGeometryTransactionStatus=void 0;(function(D){D[D.SUCCEEDED=0]="SUCCEEDED";
D[D.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(z.WGLGeometryTransactionStatus||(z.WGLGeometryTransactionStatus={}));z.WGLDrawPhase=void 0;(function(D){D[D.NONE=0]="NONE";D[D.MAP=1]="MAP";D[D.LABEL=2]="LABEL";D[D.LABEL_ALPHA=4]="LABEL_ALPHA";D[D.HITTEST=8]="HITTEST";D[D.HIGHLIGHT=16]="HIGHLIGHT";D[D.CLIP=32]="CLIP";D[D.DEBUG=64]="DEBUG";D[D.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(z.WGLDrawPhase||(z.WGLDrawPhase={}));z.VVType=void 0;(function(D){D[D.SIZE=0]="SIZE";D[D.COLOR=1]="COLOR";D[D.OPACITY=
2]="OPACITY";D[D.ROTATION=3]="ROTATION"})(z.VVType||(z.VVType={}));z.WGLVVFlag=void 0;(function(D){D[D.NONE=0]="NONE";D[D.OPACITY=1]="OPACITY";D[D.COLOR=2]="COLOR";D[D.ROTATION=4]="ROTATION";D[D.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";D[D.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";D[D.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";D[D.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(z.WGLVVFlag||(z.WGLVVFlag={}));z.WGLVVTarget=void 0;(function(D){D[D.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";D[D.SCALE_TARGETS_OUTLINE=
256]="SCALE_TARGETS_OUTLINE";D[D.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";D[D.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(z.WGLVVTarget||(z.WGLVVTarget={}));z.MosaicType=void 0;(function(D){D[D.SPRITE=0]="SPRITE";D[D.GLYPH=1]="GLYPH"})(z.MosaicType||(z.MosaicType={}));z.WGLSymbologyType=void 0;(function(D){D[D.DEFAULT=0]="DEFAULT";D[D.SIMPLE=1]="SIMPLE";D[D.DOT_DENSITY=2]="DOT_DENSITY";D[D.OUTLINE_FILL=3]="OUTLINE_FILL";D[D.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE";D[D.HEATMAP=
5]="HEATMAP";D[D.PIE_CHART=6]="PIE_CHART"})(z.WGLSymbologyType||(z.WGLSymbologyType={}));Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/Painter":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../brushes ../vectorTiles/shaders/VTLMaterialManager ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./WorldExtentClipRenderer ./effects/AnimationEffect ./effects/BlendEffect ./effects/FeatureEffect ./effects/HighlightEffect ./effects/HittestEffect ./effects/HittestEffectVTL ./effects/post-processing/EffectManager ./painter/RenderPass ../../../webgl/enums ../../../webgl/FramebufferObject ../../../webgl/Renderbuffer".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g,c,m,q,p){function u(t,v){switch(t){case x.WGLGeometryType.LINE:return C.brushes.line;case x.WGLGeometryType.TEXT:return C.brushes.text;case x.WGLGeometryType.LABEL:return C.brushes.label;case x.WGLGeometryType.FILL:switch(v){case x.WGLSymbologyType.DOT_DENSITY:return C.brushes.dotDensity;default:return C.brushes.fill}case x.WGLGeometryType.MARKER:switch(v){case x.WGLSymbologyType.HEATMAP:return C.brushes.heatmap;case x.WGLSymbologyType.PIE_CHART:return C.brushes.pieChart;
default:return C.brushes.marker}}}function h(t,v,w,A){return t!==x.WGLDrawPhase.HIGHLIGHT&&(1!==A||D.isSome(v)&&"normal"!==v||D.isSome(w)&&0<w.length)}return function(){function t(w,A,E){this.context=w;this._blitRenderer=new y.BitBlitRenderer;this._worldExtentClipRenderer=new d.WorldExtentClipRenderer;this._isClippedToWorldExtent=!1;this._brushCache=new Map;this._vtlMaterialManager=new B;this._blendEffect=new b.BlendEffect;this._fboPool=[];this.effects={highlight:new l,hittest:new k.HittestEffect,
hittestVTL:new r.HittestEffectVTL,integrate:new a.AnimationEffect,insideEffect:new e.FeatureEffect("inside"),outsideEffect:new e.FeatureEffect("outside")};this.materialManager=new n(w);this.textureManager=new f(A,E);this._effectsManager=new g.EffectManager}var v=t.prototype;v.getRenderTarget=function(){return this._renderTarget};v.setRenderTarget=function(w){this._renderTarget=w};v.getFbos=function(w,A){if(w!==this._lastWidth||A!==this._lastHeight){this._lastWidth=w;this._lastHeight=A;if(this._fbos){for(var E in this._fbos)this._fbos[E].resize(w,
A);return this._fbos}E={target:m.TextureType.TEXTURE_2D,pixelFormat:m.PixelFormat.RGBA,dataType:m.PixelType.UNSIGNED_BYTE,samplingMode:m.TextureSamplingMode.NEAREST,wrapMode:m.TextureWrapMode.CLAMP_TO_EDGE,width:w,height:A};const G={colorTarget:m.TargetType.TEXTURE,depthStencilTarget:m.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER};this._stencilBuf=w=new p.Renderbuffer(this.context,{width:w,height:A,internalFormat:m.RenderbufferFormat.DEPTH_STENCIL});this._fbos={output:new q.FramebufferObject(this.context,
G,E,w),blend:new q.FramebufferObject(this.context,G,E,w),effect0:new q.FramebufferObject(this.context,G,E,w)}}return this._fbos};v.acquireFbo=function(w,A){let E;E=0<this._fboPool.length?this._fboPool.pop():new q.FramebufferObject(this.context,{colorTarget:m.TargetType.TEXTURE,depthStencilTarget:m.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER},{target:m.TextureType.TEXTURE_2D,pixelFormat:m.PixelFormat.RGBA,dataType:m.PixelType.UNSIGNED_BYTE,samplingMode:m.TextureSamplingMode.NEAREST,wrapMode:m.TextureWrapMode.CLAMP_TO_EDGE,
width:w,height:A},this._stencilBuf);const G=E.descriptor;G.width===w&&G.height===A||E.resize(w,A);return E};v.releaseFbo=function(w){this._fboPool.push(w)};v.getSharedStencilBuffer=function(){return this._stencilBuf};v.beforeRenderLayers=function(w,A=null){const {width:E,height:G}=w.getViewport();this._prevFBO=w.getBoundFramebufferObject();const F=this.getFbos(E,G);w.bindFramebuffer(F.output);w.setColorMask(!0,!0,!0,!0);if(D.isSome(A)){const {r:H,g:J,b:I,a:N}=A.color;w.setClearColor(N*H/255,N*J/255,
N*I/255,N)}else w.setClearColor(0,0,0,0);w.setDepthWriteEnabled(!0);w.setClearDepth(1);w.clear(w.gl.COLOR_BUFFER_BIT|w.gl.DEPTH_BUFFER_BIT);w.setDepthWriteEnabled(!1)};v.beforeRenderLayer=function(w,A,E){const {context:G,blendMode:F,effects:H,requireFBO:J,drawPhase:I}=w;J||h(I,F,H,E)?(G.bindFramebuffer(this._fbos.blend),G.setColorMask(!0,!0,!0,!0),G.setClearColor(0,0,0,0),G.setDepthWriteEnabled(!0),G.setClearDepth(1),G.clear(G.gl.COLOR_BUFFER_BIT|G.gl.DEPTH_BUFFER_BIT),G.setDepthWriteEnabled(!1)):
(w=this._getOutputFBO(),G.bindFramebuffer(w));G.setDepthWriteEnabled(!1);G.setDepthTestEnabled(!1);G.setStencilTestEnabled(!0);G.setClearStencil(A);G.setStencilWriteMask(255);G.clear(G.gl.STENCIL_BUFFER_BIT)};v.compositeLayer=function(w,A){const {context:E,blendMode:G,effects:F,requireFBO:H,drawPhase:J}=w;if(H||h(J,G,F,A)){D.isSome(F)&&0<F.length&&J===x.WGLDrawPhase.MAP&&this._applyEffects(w,F);var I=this._getOutputFBO();E.bindFramebuffer(I);E.setStencilTestEnabled(!1);E.setStencilWriteMask(0);E.setBlendingEnabled(!0);
E.setBlendFunctionSeparate(m.BlendFactor.ONE,m.BlendFactor.ONE_MINUS_SRC_ALPHA,m.BlendFactor.ONE,m.BlendFactor.ONE_MINUS_SRC_ALPHA);E.setColorMask(!0,!0,!0,!0);I=D.isNone(G)||J===x.WGLDrawPhase.HIGHLIGHT?"normal":G;this._blendEffect.draw(w,this._fbos.blend.colorTexture,m.TextureSamplingMode.NEAREST,I,A)}};v.renderLayers=function(w){w.bindFramebuffer(this._prevFBO);if(this._fbos){var A=this._getOutputFBO();w.setDepthTestEnabled(!1);w.setStencilWriteMask(0);this._isClippedToWorldExtent?(w.setStencilTestEnabled(!0),
w.setStencilFunction(m.CompareFunction.EQUAL,1,255)):w.setStencilTestEnabled(!1);this.blitTexture(w,A.colorTexture,m.TextureSamplingMode.NEAREST)}};v.prepareDisplay=function(w,A,E){const {context:G}=w;G.bindFramebuffer(this._prevFBO);G.setColorMask(!0,!0,!0,!0);if(D.isSome(A)){const {r:F,g:H,b:J,a:I}=A.color;G.setClearColor(I*F/255,I*H/255,I*J/255,I)}else G.setClearColor(0,0,0,0);G.setStencilWriteMask(255);G.setClearStencil(0);G.clear(G.gl.COLOR_BUFFER_BIT|G.gl.STENCIL_BUFFER_BIT);this._isClippedToWorldExtent=
this._worldExtentClipRenderer.render(w,E)};v.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this._blitRenderer=D.disposeMaybe(this._blitRenderer);this._worldExtentClipRenderer=D.disposeMaybe(this._worldExtentClipRenderer);this._brushCache&&(this._brushCache.forEach(w=>w.dispose()),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(const w in this._fbos)this._fbos[w]&&this._fbos[w].dispose();for(const w of this._fboPool)w.dispose();this._fboPool.length=
0;if(this.effects)for(const w in this.effects)this.effects[w]&&this.effects[w].dispose();this._effectsManager.dispose();this._vtlMaterialManager=D.disposeMaybe(this._vtlMaterialManager);this._prevFBO=null};v.getBrush=function(w,A){w=u(w,A);A=this._brushCache.get(w);void 0===A&&(A=new w,this._brushCache.set(w,A));return this._brushCache.get(w)};v.renderObject=function(w,A,E,G){E=C.brushes[E];if(!E)return null;let F=this._brushCache.get(E);void 0===F&&(F=new E,this._brushCache.set(E,F));F.prepareState(w,
A,G);F.draw(w,A,G)};v.renderObjects=function(w,A,E,G){E=C.brushes[E];if(!E)return null;let F=this._brushCache.get(E);void 0===F&&(F=new E,this._brushCache.set(E,F));F.drawMany(w,A,G)};v.registerRenderPass=function(w){const A=w.brushes.map(E=>{this._brushCache.has(E)||this._brushCache.set(E,new E);return this._brushCache.get(E)});return new c(A,w)};v.setHighlightOptions=function(w){this.effects.highlight.setHighlightOptions(w)};v.blitTexture=function(w,A,E,G=1){w.setBlendingEnabled(!0);w.setBlendFunctionSeparate(m.BlendFactor.ONE,
m.BlendFactor.ONE_MINUS_SRC_ALPHA,m.BlendFactor.ONE,m.BlendFactor.ONE_MINUS_SRC_ALPHA);w.setColorMask(!0,!0,!0,!0);this._blitRenderer.render(w,A,E,G)};v.getPostProcessingEffects=function(w){return this._effectsManager.getPostProcessingEffects(w)};v._getOutputFBO=function(){return null!=this._renderTarget?this._renderTarget:this._fbos.output};v._applyEffects=function(w,A){const {context:E}=w;A=this._effectsManager.getPostProcessingEffects(A);for(const {postProcessingEffect:G,effect:F}of A)E.bindFramebuffer(this._fbos.blend),
G.draw(w,this._fbos.blend,F)};z._createClass(t,[{key:"vectorTilesMaterialManager",get:function(){return this._vtlMaterialManager}}]);return t}()})},"esri/views/2d/engine/brushes":function(){define("exports ./flow/BrushFlow ./imagery/BrushRasterBitmap ./imagery/BrushVectorField ./webgl/brushes/BrushBitmap ./webgl/brushes/BrushClip ./webgl/brushes/BrushOverlay ./webgl/brushes/WGLBrushDotDensity ./webgl/brushes/WGLBrushHeatmap ./webgl/brushes/WGLBrushInfo ./webgl/brushes/WGLBrushPieChart ./webgl/brushes/WGLBrushStencil ./webgl/brushes/WGLBrushVTLBackground ./webgl/brushes/WGLBrushVTLCircle ./webgl/brushes/WGLBrushVTLFill ./webgl/brushes/WGLBrushVTLLine ./webgl/brushes/WGLBrushVTLSymbol ./webgl/brushes/WGLGeometryBrushFill ./webgl/brushes/WGLGeometryBrushLabel ./webgl/brushes/WGLGeometryBrushLine ./webgl/brushes/WGLGeometryBrushMarker ./webgl/brushes/WGLGeometryBrushText".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g,c,m,q,p,u,h){const t={vtlBackground:l.WGLBrushVTLBackground,vtlFill:r.WGLBrushVTLFill,vtlLine:g.WGLBrushVTLLine,vtlCircle:k.WGLBrushVTLCircle,vtlSymbol:c.WGLBrushVTLSymbol};z.brushes={marker:u,line:p,fill:m,text:h,label:q,clip:x,stencil:e,bitmap:y,overlay:n,raster:C,rasterVF:B,flow:D,tileInfo:a,vtlBackground:l.WGLBrushVTLBackground,vtlFill:r.WGLBrushVTLFill,vtlLine:g.WGLBrushVTLLine,vtlCircle:k.WGLBrushVTLCircle,vtlSymbol:c.WGLBrushVTLSymbol,dotDensity:f,heatmap:d,
pieChart:b};z.vtlBrushes=t;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/flow/BrushFlow":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../../../../chunks/mat3f32","../webgl/brushes/WGLBrush","../../../webgl/enums"],function(z,D,C,B,y){return function(x){function n(){var d=x.apply(this,arguments)||this;d._visualState={time:0,dvsMat3:C.create(),displayViewMat3:C.create()};return d}z._inheritsLoose(n,
x);var f=n.prototype;f.dispose=function(){};f.prepareState=function(d){({context:d}=d);d.setColorMask(!0,!0,!0,!0);d.setStencilFunction(y.CompareFunction.EQUAL,0,255)};f.draw=function(d,a){const {requestRender:b}=d,{displayData:e}=a;if(!D.isNone(e)&&("loaded"===e.state.name&&e.attach(d),"attached"===e.state.name)){var l=e.state.resources;!l.ready&&D.isSome(b)?b():(this._visualState.time=d.time/1E3,this._visualState.dvsMat3=a.transforms.dvs,this._visualState.displayViewMat3=d.state.displayViewMat3,
e.flowStyle.render(d,this._visualState,l),e.flowStyle.animated&&D.isSome(b)&&b())}};return n}(B)})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(function(){return function(){function z(){this.name=this.constructor.name||"UnnamedBrush"}var D=z.prototype;D.prepareState=function(C,B,y){};D.draw=function(C,B,y){};D.drawMany=function(C,B,y){for(const x of B)this.draw(C,x,y)};return z}()})},"esri/views/2d/engine/imagery/BrushRasterBitmap":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ./RasterBitmap ../webgl/VertexStream ../webgl/brushes/WGLBrush ../../../webgl/enums ../../../webgl/rasterUtils".split(" "),
function(z,D,C,B,y,x,n){return function(f){function d(){var b=f.apply(this,arguments)||this;b._desc={lut:{vsPath:"raster/lut",fsPath:"raster/lut",attributes:new Map([["a_position",0],["a_texcoord",1]])},stretch:{vsPath:"raster/stretch",fsPath:"raster/stretch",attributes:new Map([["a_position",0],["a_texcoord",1]])},hillshade:{vsPath:"raster/hillshade",fsPath:"raster/hillshade",attributes:new Map([["a_position",0],["a_texcoord",1]])}};b._rendererUniformInfos=new Map;return b}z._inheritsLoose(d,f);
var a=d.prototype;a.dispose=function(){this._quad&&this._quad.dispose()};a.prepareState=function({context:b},e){b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(x.BlendFactor.ONE,x.BlendFactor.ONE_MINUS_SRC_ALPHA,x.BlendFactor.ONE,x.BlendFactor.ONE_MINUS_SRC_ALPHA);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0);b.setStencilFunction(x.CompareFunction.EQUAL,e.stencilRef,255)};a.draw=function(b,e){var l;if(C.hasSource(e)&&!e.suspended){var {timeline:k,context:r,painter:g,
requestRender:c}=b;k.begin(this.name);var m=!(null!=(l=r.capabilities.textureFloat)&&l.textureFloatLinear);e.updateTexture(b);b=this._getShaderVariations(e,m);b=g.materialManager.getProgram(this._desc[e.symbolizerParameters.type],b);this._drawWithProgram(r,b,e,c);k.end(this.name)}};a._drawWithProgram=function(b,e,l,k,r=1,g=[0,0],c=!1){this._quad||(this._quad=new B(b,[0,0,1,0,0,1,1,1]));if(D.isSome(k)&&!e.isCompiled)k();else{var {symbolizerParameters:m,transformGrid:q,width:p,height:u,opacity:h}=l;
k=m.type;b.useProgram(e);var t=this._getShaderVariations(l);k=this._getUniformInfos(k,b,e,t);var {names:v,textures:w}=l.getTextures();n.setTextures(b,e,v,w);b=n.getBasicGridUniforms(r,g);c=n.getCommonUniforms(q,[p,u],[l.source.width,l.source.height],h,c);n.setUniforms(e,k,{u_coordScale:l.coordScale,u_dvsMat3:l.transforms.dvs,...b,...c});if(m.colormap){const {colormap:A,colormapOffset:E}=m;l=n.getColormapUniforms(A,E);n.setUniforms(e,k,l)}"stretch"===m.type?(l=n.getStretchUniforms(m),n.setUniforms(e,
k,l)):"hillshade"===m.type&&(l=n.getShadedReliefUniforms(m),n.setUniforms(e,k,l));this._quad.draw()}};a._getUniformInfos=function(b,e,l,k){b=0<k.length?b+"-"+k.join("-"):b;if(this._rendererUniformInfos.has(b))return this._rendererUniformInfos.get(b);e=n.getUniformLocationInfos(e,l);this._rendererUniformInfos.set(b,e);return e};a._getShaderVariations=function(b,e=!1){const l=[],{interpolation:k}=b,{type:r,colormap:g}=b.symbolizerParameters;"cubic"===k?l.push("bicubic"):"bilinear"===k&&"stretch"===
r&&null!=g?(l.push("bilinear"),l.push("nnedge")):e&&"bilinear"===k&&l.push("bilinear");b.isRendereredSource?l.push("noop"):g&&l.push("applyColormap");b.transformGrid&&(l.push("applyProjection"),1===b.transformGrid.spacing[0]&&l.push("lookupProjection"));return l};return d}(y)})},"esri/views/2d/engine/imagery/RasterBitmap":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f32 ../../../../layers/support/rasterFunctions/pixelUtils ../DisplayObject ../../../webgl/enums ../../../webgl/rasterUtils".split(" "),
function(z,D,C,B,y,x,n,f,d,a){const b={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,stretchType:"none",type:"stretch"};f=function(l){function k(g=null,c=null,m=null){var q=l.call(this)||this;q._textureInvalidated=!0;q._colormapTextureInvalidated=!0;q._supportsBilinearTexture=!0;q.stencilRef=0;q.coordScale=[1,1];q._symbolizerParameters=null;q.height=null;q.isRendereredSource=
!1;q.pixelRatio=1;q.resolution=0;q.rotation=0;q._source=null;q.rawPixelData=null;q._suspended=!1;q._bandIds=null;q._interpolation=null;q._transformGrid=null;q.width=null;q.x=0;q.y=0;q.source=g;q.transformGrid=c;q.interpolation=m;return q}D._inheritsLoose(k,l);var r=k.prototype;r.destroy=function(){const g=this.getTextures();null==g?void 0:g.textures.forEach(c=>c.dispose());this._colormapTexture=this._transformGridTexture=this._rasterTexture=null};r.invalidateTexture=function(){this._textureInvalidated||
(this._textureInvalidated=!0,this.requestRender())};r._createTransforms=function(){return{dvs:y.create()}};r.setTransform=function(g){const c=B.identity(this.transforms.dvs),[m,q]=g.toScreenNoRotation([0,0],[this.x,this.y]);var p=this.resolution/this.pixelRatio/g.resolution;const u=p*this.width;p*=this.height;const h=Math.PI*this.rotation/180;B.translate(c,c,x.fromValues(m,q));B.translate(c,c,x.fromValues(u/2,p/2));B.rotate(c,c,-h);B.translate(c,c,x.fromValues(-u/2,-p/2));B.scaleByVec2(c,c,x.fromValues(u,
p));B.multiply(this.transforms.dvs,g.displayViewMat3,c)};r.getTextures=function(){if(!this._rasterTexture)return null;const g=[],c=[];this._transformGridTexture&&(c.push(this._transformGridTexture),g.push("u_transformGrid"));this._rasterTexture&&(c.push(this._rasterTexture),g.push("u_image"));this._colormapTexture&&(c.push(this._colormapTexture),g.push("u_colormap"));return{names:g,textures:c}};r.onAttach=function(){this.invalidateTexture()};r.onDetach=function(){this.invalidateTexture()};r.updateTexture=
function({context:g}){if(this.stage){var c=this._isValidSource(this.source);c&&this._colormapTextureInvalidated&&(this._colormapTextureInvalidated=!1,this._updateColormapTexture(g));this._textureInvalidated&&(this._textureInvalidated=!1,this._createOrDestroyRasterTexture(g),this._rasterTexture&&(c?this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=a.createTransformTexture(g,this.transformGrid)):this._rasterTexture.setData(null)),this.suspended||(this.ready(),this.requestRender()))}else{var m,
q;null==(c=this._rasterTexture)?void 0:c.dispose();null==(m=this._transformGridTexture)?void 0:m.dispose();null==(q=this._colormapTexture)?void 0:q.dispose();this._colormapTexture=this._transformGridTexture=this._rasterTextureBandIds=this._rasterTexture=null}};r._createOrDestroyRasterTexture=function(g){var c,m;const q=C.isSome(this.source)?n.extractBands(this.source,this.bandIds):null;if(this._isValidSource(q)){var p=!this._isBandIdschanged(this.bandIds);if(this._rasterTexture){if(p)return;this._rasterTexture.dispose();
this._rasterTexture=this._rasterTextureBandIds=null}this._supportsBilinearTexture=null==(c=g.capabilities.textureFloat)?void 0:c.textureFloatLinear;c=this._getTextureSamplingMethod(this.interpolation);p=this.isRendereredSource||!(null!=(m=g.capabilities.textureFloat)&&m.textureFloat);this._rasterTexture=a.createRasterTexture(g,q,c,p);this._rasterTextureBandIds=this.bandIds?[...this.bandIds]:null}else this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=this._rasterTextureBandIds=
null)};r._isBandIdschanged=function(g){const c=this._rasterTextureBandIds;return!(null==c&&null==g||c&&g&&c.join("")===g.join(""))};r._isValidSource=function(g){var c;return C.isSome(g)&&0<(null==(c=g.pixels)?void 0:c.length)};r._getTextureSamplingMethod=function(g){const {type:c,colormap:m}=this.symbolizerParameters,q="lut"===c||"stretch"===c&&C.isSome(m);return!this._supportsBilinearTexture||q||"bilinear"!==g&&"cubic"!==g?"nearest":"bilinear"};r._updateColormapTexture=function(g){const c=this._colormap,
m=this.symbolizerParameters.colormap;if(!m)this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormap=null;else if(!c)this._colormapTexture=a.createColormapTexture(g,m),this._colormap=m;else if(m.length!==c.length||m.some((q,p)=>q!==c[p]))this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormapTexture=a.createColormapTexture(g,m),this._colormap=m};D._createClass(k,[{key:"symbolizerParameters",get:function(){return this._symbolizerParameters||
b},set:function(g){this._symbolizerParameters!==g&&(this._symbolizerParameters=g,this._colormapTextureInvalidated=!0)}},{key:"source",get:function(){return this._source},set:function(g){this._source!==g&&(this._source=g,this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTextureBandIds=this._rasterTexture=null),this.invalidateTexture())}},{key:"suspended",get:function(){return this._suspended},set:function(g){this._suspended&&!g&&this.stage&&(this.ready(),this.requestRender());this._suspended=
g}},{key:"bandIds",get:function(){return this._bandIds},set:function(g){this._bandIds=g;this._isBandIdschanged(g)&&this.invalidateTexture()}},{key:"interpolation",get:function(){return this._interpolation||"nearest"},set:function(g){this._interpolation=g;this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===this._getTextureSamplingMethod(g)?d.TextureSamplingMode.LINEAR:d.TextureSamplingMode.NEAREST)}},{key:"transformGrid",get:function(){return this._transformGrid},set:function(g){this._transformGrid=
g;this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null)}}]);return k}(f.DisplayObject);let e=function(l){function k(){return l.apply(this,arguments)||this}D._inheritsLoose(k,l);D._createClass(k,[{key:"source",get:function(){return this._source}}]);return k}(f);z.RasterBitmap=f;z.RasterBitmapWithSource=e;z.hasSource=function(l){return C.isSome(l.source)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports",
"../../../core/maybe","../PixelBlock"],function(z,D,C){function B(g){return D.isSome(g)&&"esri.layers.support.PixelBlock"===g.declaredClass&&g.pixels&&0<g.pixels.length}function y(g,c,m,q,p,u,h,t){return{xmin:p<=m*g?0:p<m*g+g?p-m*g:g,ymin:u<=q*c?0:u<q*c+c?u-q*c:c,xmax:p+h<=m*g?0:p+h<m*g+g?p+h-m*g:g,ymax:u+t<=q*c?0:u+t<q*c+c?u+t-q*c:c}}function x(g,c,m,q,p,u){const {width:h,height:t}=m.block,{x:v,y:w}=m.offset,{width:A,height:E}=m.mosaic;m=y(h,t,q,p,v,w,A,E);let G=0;var F=0;if(u){var H=u.hasGCSSShiftTransform?
360:u.halfWorldWidth,J=h*u.resolutionX,I=u.startX+q*J;J=I+J;I<H&&J>H?F=u.rightPadding:I>=H&&(G=u.leftMargin-u.rightPadding,F=0)}m.xmax-=F;if("number"===typeof c)for(u=m.ymin;u<m.ymax;u++)for(F=(p*t+u-w)*A+(q*h-v)+G,H=m.xmin;H<m.xmax;H++)g[F+H]=c;else for(u=m.ymin;u<m.ymax;u++)for(F=(p*t+u-w)*A+(q*h-v)+G,H=u*h,I=m.xmin;I<m.xmax;I++)g[F+I]=c[H+I]}function n(g,c,m={}){const {clipOffset:q,clipSize:p,alignmentInfo:u,blockWidths:h}=m;if(h)return f(g,c,{blockWidths:h});var t=g.find(M=>B(M));if(D.isNone(t))return null;
m=p?p.width:c.width;const v=p?p.height:c.height;var w=t.width,A=t.height;const E=c.width/w,G=c.height/A;c={offset:q||{x:0,y:0},mosaic:p||c,block:{width:w,height:A}};w=t.pixelType;A=C.getPixelArrayConstructor(w);var F=t.pixels.length;t=[];for(var H=0;H<F;H++){var J=new A(m*v);for(let M=0;M<G;M++)for(let K=0;K<E;K++){var I=g[M*E+K];B(I)&&(I=I.pixels[H],x(J,I,c,K,M,u))}t.push(J)}let N;if(g.some(M=>D.isNone(M)||M.mask&&0<M.mask.length))for(N=new Uint8Array(m*v),A=0;A<G;A++)for(F=0;F<E;F++)J=g[A*E+F],
(H=D.isSome(J)?J.mask:null)?x(N,H,c,F,A,u):J?x(N,1,c,F,A,u):x(N,0,c,F,A,u);g=new C({width:m,height:v,pixels:t,pixelType:w,mask:N});g.updateStatistics();return g}function f(g,c,m){const q=g.find(F=>D.isSome(F));if(D.isNone(q))return null;var p=g.some(F=>D.isSome(F)?!!F.mask:!0);const {width:u,height:h}=c;c=p?new Uint8Array(u*h):null;({blockWidths:m}=m);const t=[],v=q.getPlaneCount(),w=C.getPixelArrayConstructor(q.pixelType);if(p)for(let F=0,H=0;F<g.length;H+=m[F],F++)if(p=g[F],B(p)){var A=p.mask;for(var E=
0;E<h;E++)for(var G=0;G<m[F];G++)c[E*u+G+H]=null==A?255:A[E*p.width+G]}for(p=0;p<v;p++){A=new w(u*h);for(let F=0,H=0;F<g.length;H+=m[F],F++)if(E=g[F],B(E)&&(G=E.pixels[p],null!=G))for(let J=0;J<h;J++)for(let I=0;I<m[F];I++)A[J*u+I+H]=G[J*E.width+I];t.push(A)}g=new C({width:u,height:h,mask:c,pixels:t,pixelType:q.pixelType});g.updateStatistics();return g}function d(g){if(!B(g))return null;const c=g.clone(),{width:m,height:q,pixels:p,mask:u}=g;var h=p[0];g=c.pixels[0];for(let w=2;w<q-1;w++){const A=
new Map;for(var t=w-2;t<w+2;t++)for(var v=0;4>v;v++){const E=t*m+v;e(A,h[E],u?u[E]:1)}g[w*m]=a(A);g[w*m+1]=g[w*m+2]=g[w*m];for(t=3;t<m-1;t++)v=(w-2)*m+t+1,e(A,h[v],u?u[v]:1),v=(w-1)*m+t+1,e(A,h[v],u?u[v]:1),v=w*m+t+1,e(A,h[v],u?u[v]:1),v=(w+1)*m+t+1,e(A,h[v],u?u[v]:1),v=(w-2)*m+t-3,b(A,h[v],u?u[v]:1),v=(w-1)*m+t-3,b(A,h[v],u?u[v]:1),v=w*m+t-3,b(A,h[v],u?u[v]:1),v=(w+1)*m+t-3,b(A,h[v],u?u[v]:1),g[w*m+t]=a(A);g[w*m+t+1]=g[w*m+t]}for(h=0;h<m;h++)g[h]=g[m+h]=g[2*m+h],g[(q-1)*m+h]=g[(q-2)*m+h];c.updateStatistics();
return c}function a(g){if(0===g.size)return 0;let c=0,m=-1,q=0;const p=g.keys();let u=p.next();for(;!u.done;)q=g.get(u.value),q>c&&(m=u.value,c=q),u=p.next();return m}function b(g,c,m){0!==m&&(m=g.get(c),1===m?g.delete(c):g.set(c,m-1))}function e(g,c,m){0!==m&&g.set(c,g.has(c)?g.get(c)+1:1)}function l(g,c,m){let {x:q,y:p}=c;const {width:u,height:h}=m;if(0===q&&0===p&&h===g.height&&u===g.width)return g;const {width:t,height:v}=g;c=Math.max(0,p);const w=Math.max(0,q),A=Math.min(q+u,t),E=Math.min(p+
h,v);if(0>A||0>E||!B(g))return null;q=Math.max(0,-q);p=Math.max(0,-p);const {pixels:G,mask:F}=g;var H=u*h,J=G.length;const I=[];for(var N=0;N<J;N++){var M=G[N],K=C.createEmptyBand(g.pixelType,H);for(let O=c;O<E;O++){const X=O*t;let aa=(O+p-c)*u+q;for(let ba=w;ba<A;ba++)K[aa++]=M[X+ba]}I.push(K)}H=new Uint8Array(H);for(J=c;J<E;J++)for(N=J*t,M=(J+p-c)*u+q,K=w;K<A;K++)H[M++]=F?F[N+K]:1;g=new C({width:m.width,height:m.height,pixelType:g.pixelType,pixels:I,mask:H});g.updateStatistics();return g}function k(g,
c=!0){if(!B(g))return null;const {pixels:m,width:q,height:p,mask:u,pixelType:h}=g;g=[];const t=Math.round(q/2),v=Math.round(p/2),w=p-1,A=q-1;for(var E=0;E<m.length;E++){var G=m[E],F=C.createEmptyBand(h,t*v),H=0;for(var J=0;J<p;J+=2)for(var I=0;I<q;I+=2){var N=G[J*q+I];if(c){var M=I===A?N:G[J*q+I+1];const K=J===w?N:G[J*q+I+q],O=I===A?K:J===w?M:G[J*q+I+q+1];F[H++]=(N+M+K+O)/4}else F[H++]=N}g.push(F)}E=null;if(u)for(E=new Uint8Array(t*v),G=0,F=0;F<p;F+=2)for(H=0;H<q;H+=2)J=u[F*q+H],c?(I=H===A?J:u[F*
q+H+1],N=F===w?J:u[F*q+H+q],M=H===A?N:F===w?I:u[F*q+H+q+1],E[G++]=J*I*N*M?1:0):E[G++]=J;return new C({width:t,height:v,pixelType:h,pixels:g,mask:E})}function r(g,c,m,q,p=.5){const {width:u,height:h}=g,{width:t,height:v}=c;g=q.cols;q=q.rows;c=Math.ceil(t/g-.1/g);const w=Math.ceil(v/q-.1/q);let A,E,G,F,H;const J=c*g;var I=J*w*q;const N=new Float32Array(I),M=new Float32Array(I),K=new Uint32Array(I),O=new Uint32Array(I);let X=0,aa,ba;for(let P=0;P<w;P++)for(let Y=0;Y<c;Y++){var V=12*(P*c+Y);I=m[V];A=
m[V+1];E=m[V+2];G=m[V+3];F=m[V+4];H=m[V+5];for(var L=0;L<q;L++){X=(P*q+L)*J+Y*g;ba=(L+.5)/q;for(let U=0;U<L;U++)aa=(U+.5)/g,N[X+U]=(I*aa+A*ba+E)*u-p,M[X+U]=(G*aa+F*ba+H)*h-p,K[X+U]=Math.round(N[X+U]),O[X+U]=Math.round(M[X+U])}V+=6;I=m[V];A=m[V+1];E=m[V+2];G=m[V+3];F=m[V+4];H=m[V+5];for(V=0;V<q;V++)for(X=(P*q+V)*J+Y*g,ba=(V+.5)/q,L=V;L<g;L++)aa=(L+.5)/g,N[X+L]=(I*aa+A*ba+E)*u-p,M[X+L]=(G*aa+F*ba+H)*h-p,K[X+L]=Math.round(N[X+L]),O[X+L]=Math.round(M[X+L])}return{offsets_x:N,offsets_y:M,offsets_xi:K,
offsets_yi:O,gridWidth:J}}z.approximateTransform=function(g,c,m,q,p="nearest"){if(!B(g))return null;"majority"===p&&(g=d(g));const {pixels:u,mask:h,pixelType:t}=g,v=g.width;var w=g.height;const A=C.getPixelArrayConstructor(t),E=u.length,{width:G,height:F}=c;g=!1;for(let O=0;O<m.length;O+=3)-1===m[O]&&-1===m[O+1]&&-1===m[O+2]&&(g=!0);const {offsets_x:H,offsets_y:J,offsets_xi:I,offsets_yi:N,gridWidth:M}=r({width:v,height:w},c,m,q,"majority"===p?0:.5);let K;c=(O,X,aa)=>{const ba=O instanceof Float32Array||
O instanceof Float64Array?0:.5;for(let V=0;V<F;V++){K=V*M;for(let L=0;L<G;L++){if(0>H[K]||0>J[K])O[V*G+L]=0;else if(aa)O[V*G+L]=X[I[K]+N[K]*v];else{const P=Math.floor(H[K]),Y=Math.floor(J[K]),U=Math.ceil(H[K]),Q=Math.ceil(J[K]),W=H[K]-P,R=J[K]-Y;O[V*G+L]=!h||h[P+Y*v]&&h[P+Y*v]&&h[P+Q*v]&&h[U+Q*v]?(1-R)*((1-W)*X[P+Y*v]+W*X[U+Y*v])+R*((1-W)*X[P+Q*v]+W*X[U+Q*v])+ba:X[I[K]+N[K]*v]}K++}}};m=[];for(w=0;w<E;w++)q=new A(G*F),c(q,u[w],"nearest"===p||"majority"===p),m.push(q);p=new C({width:G,height:F,pixelType:t,
pixels:m});if(h)p.mask=new Uint8Array(G*F),c(p.mask,h,!0);else if(g)for(p.mask=new Uint8Array(G*F),g=0;g<G*F;g++)p.mask[g]=0>H[g]||0>J[g]?0:1;p.updateStatistics();return p};z.clip=l;z.colorize=function(g,c){if(!B(g)||!c&&(c.indexedColormap||c.indexed2DColormap))return g;const m=g.clone();var q=m.pixels;let p=m.mask;const u=m.width*m.height;if(1!==q.length)return g;const {indexedColormap:h,indexed2DColormap:t,offset:v,alphaSpecified:w}=c;c=h.length-1;g=0;q=q[0];const A=new Uint8Array(q.length),E=new Uint8Array(q.length),
G=new Uint8Array(q.length);let F=0;if(h)if(p)for(g=0;g<u;g++)p[g]&&(F=4*(q[g]-v),F<v||F>c?p[g]=0:(A[g]=h[F],E[g]=h[F+1],G[g]=h[F+2],p[g]=h[F+3]));else{p=new Uint8Array(u);for(g=0;g<u;g++)F=4*(q[g]-v),F<v||F>c?p[g]=0:(A[g]=h[F],E[g]=h[F+1],G[g]=h[F+2],p[g]=h[F+3]);m.mask=p}else if(p)for(g=0;g<u;g++)p[g]&&(c=t[q[g]],A[g]=c[0],E[g]=c[1],G[g]=c[2],p[g]=c[3]);else{p=new Uint8Array(u);for(g=0;g<u;g++)c=t[q[g]],A[g]=c[0],E[g]=c[1],G[g]=c[2],p[g]=c[3];m.mask=p}m.pixels=[A,E,G];m.statistics=null;m.pixelType=
"u8";m.maskIsAlpha=w;return m};z.createColormapLUT=function(g){if(g){var c=g.colormap;if(c&&0!==c.length){c=c.sort((w,A)=>w[0]-A[0]);var m=0;0>c[0][0]&&(m=c[0][0]);var q=Math.max(256,c[c.length-1][0]-m+1),p=new Uint8Array(4*q),u=[],h=0,t=0,v=5===c[0].length;if(65536<q)return c.forEach(w=>{u[w[0]-m]=v?w.slice(1):w.slice(1).concat([255])}),{indexed2DColormap:u,offset:m,alphaSpecified:v};if(g.fillUnspecified)for(g=c[t],h=g[0]-m;h<q;h++)p[4*h]=g[1],p[4*h+1]=g[2],p[4*h+2]=g[3],p[4*h+3]=v?g[4]:255,h===
g[0]-m&&(g=t===c.length-1?g:c[++t]);else for(h=0;h<c.length;h++)g=c[h],t=4*(g[0]-m),p[t]=g[1],p[t+1]=g[2],p[t+2]=g[3],p[t+3]=v?g[4]:255;return{indexedColormap:p,offset:m,alphaSpecified:v}}}};z.extractBands=function(g,c){if(null==c||!c.length||!B(g))return g;const m=g.pixels.length;return c&&c.some(q=>q>=m)||1===m&&1===c.length&&0===c[0]||m===c.length&&!c.some((q,p)=>q!==p)?g:new C({pixelType:g.pixelType,width:g.width,height:g.height,mask:g.mask,validPixelCount:g.validPixelCount,maskIsAlpha:g.maskIsAlpha,
pixels:c.map(q=>g.pixels[q]),statistics:g.statistics&&c.map(q=>g.statistics[q])})};z.getClipBounds=y;z.getLocalArithmeticNorthRotations=function(g,c){const {coefficients:m,spacing:q}=c,{offsets_x:p,offsets_y:u,gridWidth:h}=r(g,g,m,{rows:q[0],cols:q[1]},.5),{width:t,height:v}=g;g=new Float32Array(t*v);c=180/Math.PI;for(let E=0;E<v;E++)for(let G=0;G<t;G++){var w=E*h+G,A=0===E?w:w-h;const F=E===v-1?w:w+h;w=p[A]-p[F];A=u[F]-u[A];isNaN(w)||isNaN(A)?g[E*t+G]=90:(A=Math.atan2(A,w)*c,A=(360+A)%360,g[E*t+
G]=A)}return g};z.isValidPixelBlock=B;z.lookupPixels=function(g,c){if(!B(g))return null;const {pixels:m,mask:q}=g,p=g.width*g.height,u=m.length;let h=c.lut;({offset:c}=c);let t,v;h&&1===h[0].length&&(h=m.map(()=>h));const w=[];let A,E,G;if(c)if(null==q)for(t=0;t<u;t++){A=m[t];E=h[t];G=new Uint8Array(p);for(v=0;v<p;v++)G[v]=E[A[v]-c];w.push(G)}else for(t=0;t<u;t++){A=m[t];E=h[t];G=new Uint8Array(p);for(v=0;v<p;v++)q[v]&&(G[v]=E[A[v]-c]);w.push(G)}else if(null==q)for(t=0;t<u;t++){A=m[t];E=h[t];G=new Uint8Array(p);
for(v=0;v<p;v++)G[v]=E[A[v]];w.push(G)}else for(t=0;t<u;t++){A=m[t];E=h[t];G=new Uint8Array(p);for(v=0;v<p;v++)q[v]&&(G[v]=E[A[v]]);w.push(G)}g=new C({width:g.width,height:g.height,pixels:w,mask:q,pixelType:"u8"});g.updateStatistics();return g};z.mosaic=n;z.mosaicPixelData=function(g,c){if(!g||0===g.length)return null;var m=g.find(E=>E.pixelBlock);if(!m||D.isNone(m.pixelBlock))return null;var q=(m.extent.xmax-m.extent.xmin)/m.pixelBlock.width;const p=(m.extent.ymax-m.extent.ymin)/m.pixelBlock.height,
u=.01*Math.min(q,p),h=g.sort((E,G)=>Math.abs(E.extent.ymax-G.extent.ymax)>u?G.extent.ymax-E.extent.ymax:Math.abs(E.extent.xmin-G.extent.xmin)>u?E.extent.xmin-G.extent.xmin:0);var t=Math.min.apply(null,h.map(E=>E.extent.xmin));const v=Math.min.apply(null,h.map(E=>E.extent.ymin)),w=Math.max.apply(null,h.map(E=>E.extent.xmax)),A=Math.max.apply(null,h.map(E=>E.extent.ymax));g={x:Math.round((c.xmin-t)/q),y:Math.round((A-c.ymax)/p)};t={width:Math.round((w-t)/q),height:Math.round((A-v)/p)};q={width:Math.round((c.xmax-
c.xmin)/q),height:Math.round((c.ymax-c.ymin)/p)};if(Math.round(t.width/m.pixelBlock.width)*Math.round(t.height/m.pixelBlock.height)!==h.length||0>g.x||0>g.y||t.width<q.width||t.height<q.height)return null;m=h.map(E=>E.pixelBlock);m=n(m,t,{clipOffset:g,clipSize:q});return{extent:c,pixelBlock:m}};z.remapColor=function(g,c){if(!B(g))return null;g=g.clone();var {pixels:m}=g;const q=g.width*g.height,p=c.length,u=Math.floor(p/2),h=c[Math.floor(u)];m=m[0];let t,v,w,A,E,G,F=!1;const H=new Uint8Array(q),J=
new Uint8Array(q),I=new Uint8Array(q);let N=g.mask;const M=4===c[0].mappedColor.length;N||(N=new Uint8Array(q),N.fill(M?255:1),g.mask=N);for(E=0;E<q;E++)if(N[E]){t=m[E];F=!1;G=u;v=h;w=0;for(A=p-1;1<A-w;){if(t===v.value){F=!0;break}t>v.value?w=G:A=G;G=Math.floor((w+A)/2);v=c[Math.floor(G)]}F||(t===c[w].value?(v=c[w],F=!0):t===c[A].value?(v=c[A],F=!0):t<c[w].value?(F=!1,v=null):t>c[w].value&&(t<c[A].value?(v=c[w],F=!0):A===p-1?(F=!1,v=null):(v=c[A],F=!0)));F?(H[E]=v.mappedColor[0],J[E]=v.mappedColor[1],
I[E]=v.mappedColor[2],N[E]=v.mappedColor[3]):H[E]=J[E]=I[E]=N[E]=0}g.pixels=[H,J,I];g.mask=N;g.pixelType="u8";g.maskIsAlpha=M;return g};z.resampleByMajority=d;z.setValidBoundary=function(g,c,m){if(!B(g))return null;const {width:q,height:p}=g,u=c.x;c=c.y;const h=m.width+u;m=m.height+c;if(0>u||0>c||h>q||m>p||0===u&&0===c&&h===q&&m===p)return g;g.mask||(g.mask=new Uint8Array(q*p));const t=g.mask;for(let v=0;v<p;v++){const w=v*q;for(let A=0;A<q;A++)t[w+A]=v<c||v>=m||A<u||A>=h?0:1}g.updateStatistics();
return g};z.split=function(g,c,m){if(!B(g))return null;const {width:q,height:p}=c;let {width:u,height:h}=g;const t=new Map,v={x:0,y:0};m=null==m?1:1+m;for(let w=0;w<m;w++){const A=Math.ceil(u/q),E=Math.ceil(h/p);for(let G=0;G<E;G++){v.y=G*p;for(let F=0;F<A;F++){v.x=F*q;const H=l(g,v,c);t.set(`${w}/${G}/${F}`,H)}}w<m-1&&(g=k(g));u=Math.round(u/2);h=Math.round(h/2)}return t};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b){var e;const l=n.getLogger("esri.layers.support.PixelBlock");C=e=function(k){function r(c){c=k.call(this,c)||this;c.width=null;c.height=null;c.pixelType="f32";c.validPixelCount=null;c.mask=null;c.maskIsAlpha=!1;c.pixels=null;c.statistics=null;return c}z._inheritsLoose(r,k);r.createEmptyBand=function(c,m){return new (e.getPixelArrayConstructor(c))(m)};r.getPixelArrayConstructor=function(c){let m;switch(c){case "u1":case "u2":case "u4":case "u8":m=Uint8Array;break;case "u16":m=
Uint16Array;break;case "u32":m=Uint32Array;break;case "s8":m=Int8Array;break;case "s16":m=Int16Array;break;case "s32":m=Int32Array;break;case "f32":m=Float32Array;break;case "f64":m=Float64Array;break;case "c64":case "c128":case "unknown":m=Float32Array}return m};var g=r.prototype;g.castPixelType=function(c){if(!c)return"f32";c=c.toLowerCase();["u1","u2","u4"].includes(c)?c="u8":"unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").includes(c)||(c="f32");return c};g.getPlaneCount=function(){return this.pixels&&
this.pixels.length};g.addData=function(c){if(!c.pixels||c.pixels.length!==this.width*this.height)throw new B("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(c.pixels);this.statistics.push(c.statistics||{minValue:null,maxValue:null})};g.getAsRGBA=function(){const c=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(c);
break;default:this._fillFrom8Bit(c)}return new Uint8ClampedArray(c)};g.getAsRGBAFloat=function(){const c=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(c);return c};g.updateStatistics=function(){this.statistics=this.pixels.map(q=>this._calculateBandStatistics(q,this.mask));const c=this.mask;let m=0;if(c)for(let q=0;q<c.length;q++)c[q]&&m++;else m=this.width*this.height;this.validPixelCount=m};g.clamp=function(c){if(c&&"f64"!==c&&"f32"!==c){switch(c){case "u8":var m=[0,255];break;case "u16":m=
[0,65535];break;case "u32":m=[0,4294967295];break;case "s8":m=[-128,127];break;case "s16":m=[-32768,32767];break;case "s32":m=[-2147483648,2147483647];break;default:m=[-3.4*1E39,3.4*1E39]}var [q,p]=m;m=this.pixels;var u=this.width*this.height,h=m.length,t=[];for(let E=0;E<h;E++){var v=e.createEmptyBand(c,u);var w=m[E];for(let G=0;G<u;G++){var A=w[G];v[G]=A>p?p:A<q?q:A}t.push(v)}this.pixels=t;this.pixelType=c}};g.extractBands=function(c){if(f.isNone(c)||0===c.length||null==this.pixels||0===this.pixels.length)return this;
var m=this.pixels.length;const q=c.some(p=>p>=this.pixels.length);m=m===c.length&&!c.some((p,u)=>p!==u);return q||m?this:new e({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:c.map(p=>this.pixels[p]),statistics:this.statistics&&c.map(p=>this.statistics[p])})};g.clone=function(){const c=new e({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});
this.mask&&(c.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));let m;const q=e.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){c.pixels=[];const p=this.pixels[0].slice;for(m=0;m<this.pixels.length;m++)c.pixels[m]=p?this.pixels[m].slice(0,this.pixels[m].length):new q(this.pixels[m])}if(this.statistics)for(c.statistics=[],m=0;m<this.statistics.length;m++)c.statistics[m]=x.clone(this.statistics[m]);return c};g._fillFrom8Bit=function(c){const {mask:m,
maskIsAlpha:q,pixels:p}=this;if(c&&p&&p.length){var u,h;var t=u=h=p[0];3<=p.length?(u=p[1],h=p[2]):2===p.length&&(u=p[1]);var v=new Uint32Array(c),w=this.width*this.height;if(t.length!==w)l.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(m&&m.length===w)if(q)for(c=0;c<w;c++)m[c]&&(v[c]=m[c]<<24|h[c]<<16|u[c]<<8|t[c]);else for(c=0;c<w;c++)m[c]&&(v[c]=-16777216|h[c]<<16|u[c]<<8|t[c]);else for(c=0;c<w;c++)v[c]=-16777216|h[c]<<16|u[c]<<8|t[c]}else l.error("getAsRGBA()",
"Unable to convert to RGBA. The input pixel block is empty.")};g._fillFromNon8Bit=function(c){const {pixels:m,mask:q,statistics:p}=this;if(c&&m&&m.length){var u=this.pixelType,h=1,t=0;h=1;p&&0<p.length?(t=p.map(G=>G.minValue).reduce((G,F)=>Math.min(G,F)),h=p.map(G=>G.maxValue-G.minValue).reduce((G,F)=>Math.max(G,F)),h=255/h):(h=255,"s8"===u?(t=-128,h=127):"u16"===u?h=65535:"s16"===u?(t=-32768,h=32767):"u32"===u?h=4294967295:"s32"===u?(t=-2147483648,h=2147483647):"f32"===u?(t=-3.4*1E39,h=3.4*1E39):
"f64"===u&&(t=-Number.MAX_VALUE,h=Number.MAX_VALUE),h=255/(h-t));c=new Uint32Array(c);u=this.width*this.height;var v,w,A;var E=v=w=m[0];if(E.length!==u)return l.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=m.length)if(v=m[1],3<=m.length&&(w=m[2]),q&&q.length===u)for(A=0;A<u;A++)q[A]&&(c[A]=-16777216|(w[A]-t)*h<<16|(v[A]-t)*h<<8|(E[A]-t)*h);else for(A=0;A<u;A++)c[A]=-16777216|(w[A]-t)*h<<16|(v[A]-t)*h<<8|(E[A]-t)*h;else if(q&&q.length===u)for(A=0;A<u;A++)v=(E[A]-
t)*h,q[A]&&(c[A]=-16777216|v<<16|v<<8|v);else for(A=0;A<u;A++)v=(E[A]-t)*h,c[A]=-16777216|v<<16|v<<8|v}else l.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};g._fillFrom32Bit=function(c){const {pixels:m,mask:q}=this;if(!c||!m||!m.length)return l.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let p,u,h,t;p=u=h=m[0];3<=m.length?(u=m[1],h=m[2]):2===m.length&&(u=m[1]);const v=this.width*this.height;if(p.length!==v)return l.error("getAsRGBAFloat()",
"Unable to convert to RGBA. The pixelblock is invalid.");let w=0;if(q&&q.length===v)for(t=0;t<v;t++)c[w++]=p[t],c[w++]=u[t],c[w++]=h[t],c[w++]=q[t]&1;else for(t=0;t<v;t++)c[w++]=p[t],c[w++]=u[t],c[w++]=h[t],c[w++]=1};g._calculateBandStatistics=function(c,m){let q=Infinity,p=-Infinity;const u=c.length;let h,t=0;if(m)for(h=0;h<u;h++)m[h]&&(t=c[h],q=t<q?t:q,p=t>p?t:p);else for(h=0;h<u;h++)t=c[h],q=t<q?t:q,p=t>p?t:p;return{minValue:q,maxValue:p}};return r}(y.JSONSupport);D.__decorate([d.property({json:{write:!0}})],
C.prototype,"width",void 0);D.__decorate([d.property({json:{write:!0}})],C.prototype,"height",void 0);D.__decorate([d.property({json:{write:!0}})],C.prototype,"pixelType",void 0);D.__decorate([a.cast("pixelType")],C.prototype,"castPixelType",null);D.__decorate([d.property({json:{write:!0}})],C.prototype,"validPixelCount",void 0);D.__decorate([d.property({json:{write:!0}})],C.prototype,"mask",void 0);D.__decorate([d.property({json:{write:!0}})],C.prototype,"maskIsAlpha",void 0);D.__decorate([d.property({json:{write:!0}})],
C.prototype,"pixels",void 0);D.__decorate([d.property({json:{write:!0}})],C.prototype,"statistics",void 0);return C=e=D.__decorate([b.subclass("esri.layers.support.PixelBlock")],C)})},"esri/views/webgl/rasterUtils":function(){define("exports ../../chunks/vec2f64 ./context-util ./enums ./FramebufferObject ./Texture".split(" "),function(z,D,C,B,y,x){z.createColormapTexture=function(n,f){return new x.Texture(n,{width:f.length/4,height:1,target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,
internalFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,samplingMode:B.TextureSamplingMode.NEAREST,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1},f)};z.createFrameBuffer=function(n,f,d,a){a=new x.Texture(n,{width:f,height:d,target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:B.PixelFormat.RGBA,samplingMode:B.TextureSamplingMode.NEAREST,dataType:a?B.PixelType.UNSIGNED_BYTE:B.PixelType.FLOAT,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1});return new y.FramebufferObject(n,
{colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER,width:f,height:d},a)};z.createRasterTexture=function(n,f,d="nearest",a=!1){var b;const e=(a=!(a&&"u8"===f.pixelType))?B.PixelType.FLOAT:B.PixelType.UNSIGNED_BYTE,l=null==f.pixels||0===f.pixels.length?null:a?f.getAsRGBAFloat():f.getAsRGBA(),k=null==(b=n.capabilities.textureFloat)?void 0:b.textureFloatLinear;return new x.Texture(n,{width:f.width,height:f.height,target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,
internalFormat:n.type===C.ContextType.WEBGL2&&a?B.SizedPixelFormat.RGBA32F:B.PixelFormat.RGBA,samplingMode:!k||"bilinear"!==d&&"cubic"!==d?B.TextureSamplingMode.NEAREST:B.TextureSamplingMode.LINEAR,dataType:e,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1},l)};z.createTransformTexture=function(n,f){const {spacing:d,offsets:a,coefficients:b,size:[e,l]}=f;var k=1<d[0];f={width:k?4*e:e,height:l,target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:n.type===C.ContextType.WEBGL2?
B.SizedPixelFormat.RGBA32F:B.PixelFormat.RGBA,dataType:B.PixelType.FLOAT,samplingMode:B.TextureSamplingMode.NEAREST,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1};const r=new Float32Array(k?e*l*16:2*a.length);if(k)for(let g=0,c=0;g<b.length;g++)r[c++]=b[g],2===g%3&&(r[c++]=1);else for(k=0;k<l;k++)for(let g=0;g<e;g++){const c=4*(k*e+g),m=2*(g*l+k);r[c]=a[m];r[c+1]=a[m+1];r[c+3]=-1===a[m]?0:1}return new x.Texture(n,f,r)};z.getBasicGridUniforms=function(n,f){return{u_scale:n,u_offset:f}};z.getColormapUniforms=
function(n,f){return{u_colormapOffset:f||0,u_colormapMaxIndex:n?n.length/4-1:0}};z.getCommonUniforms=function(n,f,d,a=1,b=!0){return{u_flipY:b,u_applyTransform:n?!0:!1,u_opacity:a,u_transformSpacing:n?n.spacing:D.ZEROS,u_transformGridSize:n?n.size:D.ZEROS,u_targetImageSize:f,u_srcImageSize:d}};z.getShadedReliefUniforms=function(n){return{u_hillshadeType:n.hillshadeType,u_sinZcosAs:n.sinZcosAs,u_sinZsinAs:n.sinZsinAs,u_cosZs:n.cosZs,u_weights:n.weights,u_factor:n.factor,u_minValue:n.minValue,u_maxValue:n.maxValue}};
z.getStretchUniforms=function(n){return{u_bandCount:n.bandCount,u_minOutput:n.outMin,u_maxOutput:n.outMax,u_minCutOff:n.minCutOff,u_maxCutOff:n.maxCutOff,u_factor:n.factor,u_useGamma:n.useGamma,u_gamma:n.gamma,u_gammaCorrection:n.gammaCorrection}};z.getUniformLocationInfos=function(n,f){n=n.gl;f=f.glName;const d=n.getProgramParameter(f,n.ACTIVE_UNIFORMS),a=new Map;let b;for(let e=0;e<d;e++)(b=n.getActiveUniform(f,e))&&a.set(b.name,{location:n.getUniformLocation(f,b.name),info:b});return a};z.setTextures=
function(n,f,d,a){d.length===a.length&&(a.some(b=>null==b)||d.some(b=>null==b)||d.forEach((b,e)=>{f.setUniform1i(b,e);n.bindTexture(a[e],e)}))};z.setUniforms=function(n,f,d){Object.keys(d).forEach(a=>{var b=f.get(a)||f.get(a+"[0]");if(b){var e=d[a];if(null!==b&&null!=e)switch({info:b}=b,b.type){case B.UniformType.FLOAT:1<b.size?n.setUniform1fv(a,e):n.setUniform1f(a,e);break;case B.UniformType.FLOAT_VEC2:n.setUniform2fv(a,e);break;case B.UniformType.FLOAT_VEC3:n.setUniform3fv(a,e);break;case B.UniformType.FLOAT_VEC4:n.setUniform4fv(a,
e);break;case B.UniformType.FLOAT_MAT3:n.setUniformMatrix3fv(a,e);break;case B.UniformType.FLOAT_MAT4:n.setUniformMatrix4fv(a,e);break;case B.UniformType.INT:1<b.size?n.setUniform1iv(a,e):n.setUniform1i(a,e);break;case B.UniformType.BOOL:n.setUniform1i(a,e?1:0);break;case B.UniformType.INT_VEC2:case B.UniformType.BOOL_VEC2:n.setUniform2iv(a,e);break;case B.UniformType.INT_VEC3:case B.UniformType.BOOL_VEC3:n.setUniform3iv(a,e);break;case B.UniformType.INT_VEC4:case B.UniformType.BOOL_VEC4:n.setUniform4iv(a,
e)}}})};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/FramebufferObject":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/Logger ../../core/maybe ./BufferObject ./checkWebGLError ./context-util ./enums ./Renderbuffer ./Texture ./Util".split(" "),function(z,D,C,B,y,x,n,f,d,a,b){function e(m){return"type"in m&&"texture"===m.type}function l(m){return e(m)||"pixelFormat"in m}function k(m,q){m.target!==f.TextureType.TEXTURE_2D&&
m.target!==f.TextureType.TEXTURE_CUBE_MAP&&console.error("Texture type must be TEXTURE_2D or TEXTURE_CUBE_MAP!");void 0!==q.width&&0<=q.width&&void 0!==q.height&&0<=q.height?q.width===m.width&&q.height===m.height||console.error("Color attachment texture must match the framebuffer's!"):(q.width=m.width,q.height=m.height)}function r(m,q){void 0!==q.width&&0<=q.width&&void 0!==q.height&&0<=q.height?q.width===m.width&&q.height===m.height||console.error("Renderbuffer dimensions must match the framebuffer's!"):
(q.width=m.width,q.height=m.height)}function g(m){return m.descriptor.target===f.TextureType.TEXTURE_CUBE_MAP?f.TextureType.TEXTURE_CUBE_MAP_POSITIVE_X:f.TextureType.TEXTURE_2D}const c=C.getLogger("esri.views.webgl.FrameBufferObject");C=function(){function m(p,u,h=null,t=null){this._context=p;this._stencilAttachment=this._depthAttachment=this._glName=null;this._colorAttachments=new Map;this._initialized=!1;this._desc={...u};p.instanceCounter.increment(f.ResourceType.FramebufferObject,this);if(B.isSome(h))for(Array.isArray(h)||
(h=[h]),p=0;p<h.length;++p){u=h[p];const w=f.ColorAttachment.COLOR_ATTACHMENT0+p;let A;l(u)?(e(u)?(A=u.descriptor,this._colorAttachments.set(w,u)):(A=u,this._colorAttachments.set(w,new a.Texture(this._context,A))),k(A,this._desc)):("type"in u&&"renderbuffer"===u.type?(A=u.descriptor,this._colorAttachments.set(w,u)):(A=u,this._colorAttachments.set(w,new d.Renderbuffer(this._context,A))),r(A,this._desc));this._validateColorAttachmentPoint(w)}if(B.isSome(t))if(l(t))this._context.capabilities.depthTexture||
console.error("Setting the depth/stencil texture as an attachment requires WEBGL_depth_texture or WebGL2"),e(t)?(h=t.descriptor,this._depthStencilTexture=t):(h=t,this._depthStencilTexture=new a.Texture(this._context,h)),k(h,this._desc);else{var v;"type"in t&&"renderbuffer"===t.type?h=t.descriptor:(h=t,t=new d.Renderbuffer(this._context,h));p=null!=(v=this._desc.depthStencilTarget)?v:f.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER;p===f.DepthStencilTargetType.STENCIL_RENDER_BUFFER?this._stencilAttachment=
t:p===f.DepthStencilTargetType.DEPTH_RENDER_BUFFER||p===f.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER?this._depthAttachment=t:console.error('If a Renderbuffer is provided, "depthStencilTarget" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER');r(h,this._desc)}}var q=m.prototype;q.dispose=function(){if(this._desc){var p=this._context.getBoundFramebufferObject();this._disposeColorAttachments();this._disposeDepthStencilAttachments();this._glName&&(this._context.gl.deleteFramebuffer(this._glName),
this._glName=null);this._context.bindFramebuffer(p);this._context.instanceCounter.decrement(f.ResourceType.FramebufferObject,this);this._desc=null}};q.getColorTexture=function(p){return(p=this._colorAttachments.get(p))&&e(p)?p:null};q.attachColorTexture=function(p,u=f.ColorAttachment.COLOR_ATTACHMENT0){p&&(this._validateColorAttachmentPoint(u),k(p.descriptor,this._desc),this._disposeColorAttachments(),this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(p.glName,u)),
this._colorAttachments.set(u,p))};q.detachColorTexture=function(p=f.ColorAttachment.COLOR_ATTACHMENT0){const u=this._colorAttachments.get(p);if(e(u))return this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,p)),this._colorAttachments.delete(p),u};q.setColorTextureTarget=function(p,u=f.ColorAttachment.COLOR_ATTACHMENT0){const h=this._colorAttachments.get(u);e(h)&&this._framebufferTexture2D(h.glName,u,p)};q.attachDepthStencilTexture=function(p){if(!B.isNone(p)){var u=
p.descriptor;u.pixelFormat!==f.PixelFormat.DEPTH_STENCIL&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!");u.dataType!==f.PixelType.UNSIGNED_INT_24_8&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8!");this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!");k(u,this._desc);this._desc.depthStencilTarget&&this._desc.depthStencilTarget!==
f.DepthStencilTargetType.DEPTH_STENCIL_TEXTURE&&(this._desc.depthStencilTarget=f.DepthStencilTargetType.DEPTH_STENCIL_TEXTURE);this._disposeDepthStencilAttachments();this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(p.glName,f.DepthStencilAttachment));this._depthStencilTexture=p}};q.detachDepthStencilTexture=function(){const p=this._depthStencilTexture;p&&this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,f.DepthStencilAttachment));
this._depthStencilTexture=null;return p};q.attachDepthStencilBuffer=function(p){if(!B.isNone(p)){var u=p.descriptor;u.internalFormat!==f.RenderbufferFormat.DEPTH_STENCIL&&u.internalFormat!==f.RenderbufferFormat.DEPTH_COMPONENT16&&console.error("Depth/Stencil buffer must have correct internalFormat");r(u,this._desc);this._disposeDepthStencilAttachments();this._desc.depthStencilTarget=u.internalFormat===f.RenderbufferFormat.DEPTH_STENCIL?f.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER:f.DepthStencilTargetType.DEPTH_RENDER_BUFFER;
this._initialized&&(this._context.bindFramebuffer(this),u=this._context.gl,u.framebufferRenderbuffer(f.FramebufferTarget.FRAMEBUFFER,this._desc.depthStencilTarget===f.DepthStencilTargetType.DEPTH_RENDER_BUFFER?u.DEPTH_ATTACHMENT:u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,p.glName));this._depthAttachment=p}};q.detachDepthStencilBuffer=function(){const p=this._context.gl,u=this._depthAttachment;u&&this._initialized&&(this._context.bindFramebuffer(this),p.framebufferRenderbuffer(f.FramebufferTarget.FRAMEBUFFER,
this._desc.depthStencilTarget===f.DepthStencilTargetType.DEPTH_RENDER_BUFFER?p.DEPTH_ATTACHMENT:p.DEPTH_STENCIL_ATTACHMENT,p.RENDERBUFFER,null));this._depthAttachment=null;return u};q.detachAll=function(){this._colorAttachments.forEach((p,u)=>this._detachColorAttachment(u));this.detachDepthStencilBuffer();this.detachDepthStencilTexture()};q.copyToTexture=function(p,u,h,t,v,w,A){(0>p||0>u||0>v||0>w)&&console.error("Offsets cannot be negative!");(0>=h||0>=t)&&console.error("Copy width and height must be greater than zero!");
var E=this._desc;const G=A.descriptor;A.descriptor.target!==f.TextureType.TEXTURE_2D&&console.error("Texture target must be TEXTURE_2D!");(p+h>E.width||u+t>E.height||v+h>G.width||w+t>G.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");E=this._context;A=E.bindTexture(A,a.Texture.TEXTURE_UNIT_FOR_UPDATES);E.setActiveTexture(a.Texture.TEXTURE_UNIT_FOR_UPDATES);E.bindFramebuffer(this);E.gl.copyTexSubImage2D(f.TextureType.TEXTURE_2D,0,v,w,p,
u,h,t);E.bindTexture(A,a.Texture.TEXTURE_UNIT_FOR_UPDATES)};q.readPixels=function(p,u,h,t,v,w,A){(0>=h||0>=t)&&console.error("Copy width and height must be greater than zero!");A||console.error("Target memory is not initialized!");this._context.bindFramebuffer(this);this._context.gl.readPixels(p,u,h,t,v,w,A)};q.readPixelsAsync=function(){var p=D._asyncToGenerator(function*(u,h,t,v,w,A,E){if(this._context.type!==n.ContextType.WEBGL2)x.webglDebugEnabled()&&console.warn("Attempting to read pixels using pixel buffer object without WebGL2"),
this.readPixels(u,h,t,v,w,A,E);else{var G=this._context.gl,F=y.BufferObject.createPixelPack(this._context,f.Usage.STREAM_READ,E.byteLength);this._context.bindBuffer(F);this._context.bindFramebuffer(this);G.readPixels(u,h,t,v,w,A,0);this._context.unbindBuffer(f.BufferType.PIXEL_PACK_BUFFER);yield F.getSubDataAsync(E);F.dispose()}});return function(u,h,t,v,w,A,E){return p.apply(this,arguments)}}();q.resize=function(p,u){const h=this._desc;if(h.width!==p||h.height!==u)if(this._initialized){h.width=p;
h.height=u;this._colorAttachments.forEach(t=>{t&&t.resize(p,u)});if(null!=this._depthStencilTexture)this._depthStencilTexture.resize(p,u);else if(this._depthAttachment||this._stencilAttachment)this._depthAttachment&&this._depthAttachment.resize(p,u),this._stencilAttachment&&this._stencilAttachment.resize(p,u);this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null);this._initialized=!1}else h.width=p,h.height=u,this._colorAttachments.forEach(t=>{t&&t.resize(p,u)}),this._depthStencilTexture&&
this._depthStencilTexture.resize(p,u)};q.initializeAndBind=function(p=f.FramebufferTarget.FRAMEBUFFER){var u,h,t,v;const w=this._context.gl;if(this._initialized)w.bindFramebuffer(p,this.glName);else{this._glName&&w.deleteFramebuffer(this._glName);var A=this._context,E=w.createFramebuffer(),G=this._desc,F=null!=(u=G.colorTarget)?u:f.TargetType.RENDER_BUFFER;u=null!=(h=G.width)?h:1;h=null!=(t=G.height)?t:1;w.bindFramebuffer(p,E);0===this._colorAttachments.size&&(F===f.TargetType.TEXTURE||F===f.TargetType.CUBEMAP?
this._colorAttachments.set(f.ColorAttachment.COLOR_ATTACHMENT0,new a.Texture(A,{target:this.descriptor.colorTarget===f.TargetType.CUBEMAP?f.TextureType.TEXTURE_CUBE_MAP:f.TextureType.TEXTURE_2D,pixelFormat:f.PixelFormat.RGBA,dataType:f.PixelType.UNSIGNED_BYTE,samplingMode:f.TextureSamplingMode.NEAREST,wrapMode:f.TextureWrapMode.CLAMP_TO_EDGE,width:G.width,height:G.height})):(t=new d.Renderbuffer(A,{internalFormat:f.SizedPixelFormat.RGBA4,width:u,height:h}),this._colorAttachments.set(f.ColorAttachment.COLOR_ATTACHMENT0,
t)));this._colorAttachments.forEach((H,J)=>{H&&(e(H)?this._framebufferTexture2D(H.glName,J,g(H),p):w.framebufferRenderbuffer(p,J,w.RENDERBUFFER,H.glName))});t=null!=(v=G.depthStencilTarget)?v:f.DepthStencilTargetType.NONE;switch(t){case f.DepthStencilTargetType.DEPTH_RENDER_BUFFER:case f.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER:this._depthAttachment||(this._depthAttachment=new d.Renderbuffer(A,{internalFormat:G.depthStencilTarget===f.DepthStencilTargetType.DEPTH_RENDER_BUFFER?f.RenderbufferFormat.DEPTH_COMPONENT16:
f.RenderbufferFormat.DEPTH_STENCIL,width:u,height:h}));w.framebufferRenderbuffer(p,t===f.DepthStencilTargetType.DEPTH_RENDER_BUFFER?w.DEPTH_ATTACHMENT:w.DEPTH_STENCIL_ATTACHMENT,w.RENDERBUFFER,this._depthAttachment.glName);break;case f.DepthStencilTargetType.STENCIL_RENDER_BUFFER:this._stencilAttachment||(this._stencilAttachment=new d.Renderbuffer(A,{internalFormat:f.RenderbufferFormat.STENCIL_INDEX8,width:u,height:h}));w.framebufferRenderbuffer(p,w.STENCIL_ATTACHMENT,w.RENDERBUFFER,this._stencilAttachment.glName);
break;case f.DepthStencilTargetType.DEPTH_STENCIL_TEXTURE:this._depthStencilTexture||(A.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),this._depthStencilTexture=new a.Texture(A,{target:f.TextureType.TEXTURE_2D,pixelFormat:f.PixelFormat.DEPTH_STENCIL,dataType:f.PixelType.UNSIGNED_INT_24_8,samplingMode:f.TextureSamplingMode.NEAREST,wrapMode:f.TextureWrapMode.CLAMP_TO_EDGE,width:u,
height:h})),this._framebufferTexture2D(this._depthStencilTexture.glName,w.DEPTH_STENCIL_ATTACHMENT,g(this._depthStencilTexture),p)}x.webglValidateShadersEnabled()&&w.checkFramebufferStatus(p)!==w.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!");this._glName=E;this._initialized=!0}};q._framebufferTexture2D=function(p,u=f.ColorAttachment.COLOR_ATTACHMENT0,h=f.TextureType.TEXTURE_2D,t=f.FramebufferTarget.FRAMEBUFFER,v=0){this._context.gl.framebufferTexture2D(t,u,h,p,v)};q._detachColorAttachment=
function(p){x.webglDebugEnabled()&&console.warn("Detaching an FBO attachment can be a slow due to invalidating framebuffer completeness!");const u=this._context.gl,h=this._colorAttachments.get(p);e(h)?this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,p)):this._initialized&&(this._context.bindFramebuffer(this),u.framebufferRenderbuffer(f.FramebufferTarget.FRAMEBUFFER,p,u.RENDERBUFFER,null));this._colorAttachments.delete(p);return h};q._disposeColorAttachments=
function(){this._colorAttachments.forEach((p,u)=>{this._detachColorAttachment(u);p.dispose()});this._colorAttachments.clear()};q._disposeDepthStencilAttachments=function(){const p=this._context.gl;this._depthAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),p.framebufferRenderbuffer(f.FramebufferTarget.FRAMEBUFFER,this._desc.depthStencilTarget===f.DepthStencilTargetType.DEPTH_RENDER_BUFFER?p.DEPTH_ATTACHMENT:p.DEPTH_STENCIL_ATTACHMENT,p.RENDERBUFFER,null)),this._depthAttachment.dispose(),
this._depthAttachment=null);this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),p.framebufferRenderbuffer(f.FramebufferTarget.FRAMEBUFFER,p.STENCIL_ATTACHMENT,p.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null);this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,p.DEPTH_STENCIL_ATTACHMENT)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)};q._validateColorAttachmentPoint=
function(p){if(-1===m._MAX_COLOR_ATTACHMENTS){const u=this._context.capabilities.drawBuffers;m._MAX_COLOR_ATTACHMENTS=u?this._context.gl.getParameter(u.MAX_COLOR_ATTACHMENTS):1}p-=f.ColorAttachment.COLOR_ATTACHMENT0;p+1>m._MAX_COLOR_ATTACHMENTS&&c.error("esri.FrameBufferObject",`illegal attachment point for color attachment: ${p+1}. Implementation supports up to ${m._MAX_COLOR_ATTACHMENTS} color attachments`)};D._createClass(m,[{key:"glName",get:function(){return this._glName}},{key:"descriptor",
get:function(){return this._desc}},{key:"colorTexture",get:function(){const p=this._colorAttachments.get(f.ColorAttachment.COLOR_ATTACHMENT0);return p&&e(p)?p:null}},{key:"colorAttachment",get:function(){return this._colorAttachments.get(f.ColorAttachment.COLOR_ATTACHMENT0)}},{key:"depthStencilAttachment",get:function(){return this._depthStencilTexture||this._depthAttachment||this._stencilAttachment}},{key:"depthStencilTexture",get:function(){return this._depthStencilTexture}},{key:"width",get:function(){return this._desc.width}},
{key:"height",get:function(){return this._desc.height}},{key:"gpuMemoryUsage",get:function(){return[...this._colorAttachments].reduce((p,[,u])=>p+b.getGpuMemoryUsage(u),0)+b.getGpuMemoryUsage(this.depthStencilAttachment)}}]);return m}();C._MAX_COLOR_ATTACHMENTS=-1;z.FramebufferObject=C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/BufferObject":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/arrayUtils ../../core/Logger ../../core/maybe ../../core/typedArrayUtil ./checkWebGLError ./context-util ./enums".split(" "),
function(z,D,C,B,y,x,n,f,d){const a=B.getLogger("esri.views.webgl.BufferObject");B=function(){function b(l,k,r,g){this._context=l;this.bufferType=k;this.usage=r;this._glName=null;this._size=-1;this._indexType=void 0;l.instanceCounter.increment(d.ResourceType.BufferObject,this);this._glName=this._context.gl.createBuffer();n.checkWebGLError(this._context.gl);g&&this.setData(g)}b.createIndex=function(l,k,r){return new b(l,d.BufferType.ELEMENT_ARRAY_BUFFER,k,r)};b.createVertex=function(l,k,r){return new b(l,
d.BufferType.ARRAY_BUFFER,k,r)};b.createUniform=function(l,k,r){if(l.type!==f.ContextType.WEBGL2)throw Error("Uniform buffers are supported in WebGL2 only!");return new b(l,d.BufferType.UNIFORM_BUFFER,k,r)};b.createPixelPack=function(l,k=d.Usage.STREAM_READ,r){if(l.type!==f.ContextType.WEBGL2)throw Error("Pixel pack buffers are supported in WebGL2 only!");l=new b(l,d.BufferType.PIXEL_PACK_BUFFER,k);r&&l.setSize(r);return l};b.createPixelUnpack=function(l,k=d.Usage.STREAM_DRAW,r){if(l.type!==f.ContextType.WEBGL2)throw Error("Pixel unpack buffers are supported in WebGL2 only!");
return new b(l,d.BufferType.PIXEL_UNPACK_BUFFER,k,r)};var e=b.prototype;e.dispose=function(){var l;null!=(l=this._context)&&l.gl?(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(d.ResourceType.BufferObject,this),this._context=null):this._glName&&a.warn("Leaked WebGL buffer object")};e.setSize=function(l,k=null){0>=l&&a.error("Buffer size needs to be positive!");if(this.bufferType===d.BufferType.ELEMENT_ARRAY_BUFFER&&y.isSome(k))switch(this._indexType=
k,k){case d.DataType.UNSIGNED_SHORT:l*=2;break;case d.DataType.UNSIGNED_INT:l*=4}this._setBufferData(l)};e.setData=function(l){if(l){var k=l.byteLength;this.bufferType===d.BufferType.ELEMENT_ARRAY_BUFFER&&(x.isUint16Array(l)&&(k/=2,this._indexType=d.DataType.UNSIGNED_SHORT),x.isUint32Array(l)&&(k/=4,this._indexType=d.DataType.UNSIGNED_INT));this._setBufferData(k,l)}};e._setBufferData=function(l,k=null){this._size=l;const r=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null);
this._context.bindBuffer(this);const g=this._context.gl;y.isSome(k)?g.bufferData(this.bufferType,k,this.usage):g.bufferData(this.bufferType,l,this.usage);n.checkWebGLError(g);this._isVAOAware&&this._context.bindVAO(r)};e.setSubData=function(l,k=0,r=0,g=l.byteLength){if(l){(0>k||k>=this._size)&&a.error("offset is out of range!");var c=k,m=r,q=g,p=l.byteLength;this.bufferType===d.BufferType.ELEMENT_ARRAY_BUFFER&&(x.isUint16Array(l)?(p/=2,c*=2,m*=2,q*=2):x.isUint32Array(l)&&(p/=4,c*=4,m*=4,q*=4));void 0===
g&&(g=p-1);r>=g&&a.error("end must be bigger than start!");k+r-g>this._size&&a.error("An attempt to write beyond the end of the buffer!");k=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null);this._context.bindBuffer(this);r=this._context.gl;g=ArrayBuffer.isView(l)?l.buffer:l;l=0===m&&q===l.byteLength?g:g.slice(m,q);r.bufferSubData(this.bufferType,c,l);n.checkWebGLError(r);this._isVAOAware&&this._context.bindVAO(k)}};e.setSubDataFromView=function(l,k,r,g){if(l){(0>k||k>=this._size)&&
a.error("offset is out of range!");r>=g&&a.error("end must be bigger than start!");k+r-g>this._size&&a.error("An attempt to write beyond the end of the buffer!");var c=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null);this._context.bindBuffer(this);var m=this._context.gl;this._context.type===f.ContextType.WEBGL2?m.bufferSubData(this.bufferType,k*l.BYTES_PER_ELEMENT,l,r,g-r):(r=0===r&&g===l.length?l:l.subarray(r,g),m.bufferSubData(this.bufferType,k*l.BYTES_PER_ELEMENT,r));n.checkWebGLError(m);
this._isVAOAware&&this._context.bindVAO(c)}};e.getSubData=function(l,k=0,r,g){if(this._context.type!==f.ContextType.WEBGL2)a.error("Get buffer subdata is supported in WebGL2 only!");else if(0>r||0>g)a.error("Problem getting subdata: offset and length were less than zero!");else{var c=C.isArrayLike(l)?l.BYTES_PER_ELEMENT:1;c*((null!=r?r:0)+(null!=g?g:0))>l.byteLength?a.error("Problem getting subdata: offset and length exceeded destination size!"):(k+c*(null!=g?g:0)>this.byteSize&&a.warn("Potential problem getting subdata: requested data exceeds buffer size!"),
c=this._context.gl,this._context.bindBuffer(this,d.BufferType.COPY_READ_BUFFER),c.getBufferSubData(d.BufferType.COPY_READ_BUFFER,k,l,r,g),this._context.unbindBuffer(d.BufferType.COPY_READ_BUFFER))}};e.getSubDataAsync=function(){var l=D._asyncToGenerator(function*(k,r=0,g,c){this._context.type!==f.ContextType.WEBGL2?a.error("Get buffer subdata is supported in WebGL2 only!"):(yield this._context.clientWaitAsync(),this.getSubData(k,r,g,c))});return function(k){return l.apply(this,arguments)}}();D._createClass(b,
[{key:"glName",get:function(){return this._glName}},{key:"size",get:function(){return this._size}},{key:"indexType",get:function(){return this._indexType}},{key:"byteSize",get:function(){return this.bufferType===d.BufferType.ELEMENT_ARRAY_BUFFER?this._indexType===d.DataType.UNSIGNED_INT?4*this._size:2*this._size:this._size}},{key:"_isVAOAware",get:function(){return this.bufferType===d.BufferType.ELEMENT_ARRAY_BUFFER||this.bufferType===d.BufferType.ARRAY_BUFFER}}]);return b}();z.BufferObject=B;Object.defineProperties(z,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/checkWebGLError":function(){define(["exports","../../core/Error","../../core/has","../../core/Logger"],function(z,D,C,B){function y(f,d){switch(d){case f.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case f.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case f.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";
case f.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case f.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case f.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const x=B.getLogger("esri/views/webgl"),n=!!C("enable-feature:webgl-debug");z.checkWebGLError=function(f){if(n){const d=f.getError();
d&&(f=y(f,d),x.error(new D("webgl-error","WebGL error occured",{message:f,stack:Error().stack})))}};z.hasFeatureFlagWebGLDebug=n;z.webglDebugEnabled=function(){return n};z.webglValidateShadersEnabled=function(){return n};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/Renderbuffer":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./context-util","./enums"],function(z,D,C,B){let y=function(){function x(f,d){this._context=
f;this._desc=d;this.type="renderbuffer";this._context.instanceCounter.increment(B.ResourceType.Renderbuffer,this);f=this._context.gl;this.glName=f.createRenderbuffer();this._context.bindRenderbuffer(this);const {width:a,height:b,internalFormat:e,multisampled:l}=d;if(l){if(this._context.type!==C.ContextType.WEBGL2)throw Error("Multisampled renderbuffers are not supported in WebGL1!");f.renderbufferStorageMultisample(f.RENDERBUFFER,this.samples,e,a,b)}else f.renderbufferStorage(f.RENDERBUFFER,e,a,b)}
var n=x.prototype;n.resize=function(f,d){const a=this._desc;if(a.width!==f||a.height!==d)a.width=f,a.height=d,f=this._context.gl,this._context.bindRenderbuffer(this),a.multisampled?f.renderbufferStorageMultisample(f.RENDERBUFFER,this.samples,a.internalFormat,a.width,a.height):f.renderbufferStorage(f.RENDERBUFFER,a.internalFormat,a.width,a.height)};n.dispose=function(){this._context&&(this._context.gl.deleteRenderbuffer(this.glName),this._context.instanceCounter.decrement(B.ResourceType.Renderbuffer,
this),this._context=null)};D._createClass(x,[{key:"descriptor",get:function(){return this._desc}},{key:"samples",get:function(){const f=this._desc.samples,d=this._context.parameters.maxSamples;return f?Math.min(f,d):d}}]);return x}();z.Renderbuffer=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/Texture":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/mathUtils ../../core/maybe ./checkWebGLError ./context-util ./enums ./capabilities/isWebGL2Context".split(" "),
function(z,D,C,B,y,x,n,f,d){function a(k){return y.isSome(k)&&"type"in k&&"compressed"===k.type}function b(k){var r;if(r=y.isSome(k)&&!a(k))r=!(y.isSome(k)&&"byteLength"in k);return r}function e(k){return k===f.TextureType.TEXTURE_3D||k===f.TextureType.TEXTURE_2D_ARRAY}function l(k,r,g,c=1){r=Math.max(r,g);k===f.TextureType.TEXTURE_3D&&(r=Math.max(r,c));return Math.round(Math.log(r)/Math.LN2)+1}C=function(){function k(g,c,m=null){this._context=g;this.type="texture";this._glName=null;this._descriptor=
void 0;this._wasImmutablyAllocated=this._wrapModeDirty=this._samplingModeDirty=!1;g.instanceCounter.increment(f.ResourceType.Texture,this);this._descriptor={target:f.TextureType.TEXTURE_2D,samplingMode:f.TextureSamplingMode.LINEAR,wrapMode:f.TextureWrapMode.REPEAT,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1,isImmutable:!1,...c};if(g.type!==n.ContextType.WEBGL2&&(this._descriptor.isImmutable&&(this._descriptor.isImmutable=!1),e(this._descriptor.target)))throw Error("3D and array textures are not supported in WebGL1");
this._descriptor.target===f.TextureType.TEXTURE_CUBE_MAP?this._setDataCubeMap(m):this.setData(m)}var r=k.prototype;r.dispose=function(){this._context.gl&&this._glName&&(this._context.unbindTexture(this),this._context.gl.deleteTexture(this._glName),this._glName=null,this._context.instanceCounter.decrement(f.ResourceType.Texture,this))};r.release=function(){this.dispose()};r.resize=function(g,c){const m=this._descriptor;if(m.width!==g||m.height!==c){if(this._wasImmutablyAllocated)throw Error("Immutable textures can't be resized!");
m.width=g;m.height=c;this._descriptor.target===f.TextureType.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}};r._setDataCubeMap=function(g=null){for(let c=f.TextureType.TEXTURE_CUBE_MAP_POSITIVE_X;c<=f.TextureType.TEXTURE_CUBE_MAP_NEGATIVE_Z;c++)this._setData(g,c)};r.setData=function(g){this._setData(g)};r._setData=function(g,c){var m;if(this._context&&this._context.gl){var q=this._context.gl;this._glName||(this._glName=q.createTexture());void 0===g&&(g=null);var p=this._descriptor;
null!=(m=c)?m:c=p.target;m=e(c);if(null===g&&(p.width=p.width||4,p.height=p.height||4,m)){var u;p.depth=null!=(u=p.depth)?u:1}u=this._context.bindTexture(this,k.TEXTURE_UNIT_FOR_UPDATES);this._context.setActiveTexture(k.TEXTURE_UNIT_FOR_UPDATES);k._validateTexture(this._context,p);this._configurePixelStorage();var h=p.pixelFormat,t=p.internalFormat?p.internalFormat:this._deriveInternalFormat(h,p.dataType);if(b(g)){h=g.width;let v=g.height;g instanceof HTMLVideoElement&&(h=g.videoWidth,v=g.videoHeight);
p.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(c,t,p.hasMipmap,h,v,1);this._texImage(c,0,t,h,v,1,g);x.checkWebGLError(q);p.hasMipmap&&this.generateMipmap();void 0===p.width&&(p.width=h);void 0===p.height&&(p.height=v);m&&void 0===p.depth&&(p.depth=1)}else{const {width:v,height:w,depth:A}=p;null!=v&&null!=w||console.error("Width and height must be specified!");m&&null==A&&console.error("Depth must be specified!");p.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(c,t,p.hasMipmap,
v,w,A);q.DEPTH24_STENCIL8&&t===q.DEPTH_STENCIL&&(t=q.DEPTH24_STENCIL8);if(a(g)){const E=g.levels;g=l(c,v,w,A);m=Math.min(g-1,E.length-1);d(q)?q.texParameteri(p.target,q.TEXTURE_MAX_LEVEL,m):p.hasMipmap=p.hasMipmap&&g===E.length;const G=t;if(!(G in f.CompressedTextureFormat))throw Error("Attempting to use compressed data with an umcompressed format!");this._forEachMipmapLevel((F,H,J,I)=>{this._compressedTexImage(c,F,G,H,J,I,E[Math.min(F,E.length-1)])},m)}else y.isSome(g)?(this._texImage(c,0,t,v,w,
A,g),x.checkWebGLError(q),p.hasMipmap&&this.generateMipmap()):this._forEachMipmapLevel((E,G,F,H)=>{this._texImage(c,E,t,G,F,H,null);x.checkWebGLError(q)})}k._applySamplingMode(q,this._descriptor);k._applyWrapMode(q,this._descriptor);k._applyAnisotropicFilteringParameters(this._context,this._descriptor);x.checkWebGLError(q);this._context.bindTexture(u,k.TEXTURE_UNIT_FOR_UPDATES)}};r.updateData=function(g,c,m,q,p,u){u||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");
const h=this._context.gl,t=this._descriptor,{pixelFormat:v,internalFormat:w,dataType:A,isImmutable:E,target:G}=t;if(E&&!this._wasImmutablyAllocated)throw Error("Cannot update immutable texture before allocation!");const F=this._context.bindTexture(this,k.TEXTURE_UNIT_FOR_UPDATES);(0>c||0>m||q>t.width||p>t.height||c+q>t.width||m+p>t.height)&&console.error("An attempt to update out of bounds of the texture!");this._configurePixelStorage();b(u)?h.texSubImage2D(G,g,c,m,v,A,u):a(u)?h.compressedTexSubImage2D(G,
g,c,m,q,p,w,u.levels[g]):h.texSubImage2D(G,g,c,m,q,p,v,A,u);this._context.bindTexture(F,k.TEXTURE_UNIT_FOR_UPDATES)};r.updateData3D=function(g,c,m,q,p,u,h,t){t||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");const v=this._context.gl;if(!d(v))throw Error("3D textures are not supported in WebGL1");const w=this._descriptor,{pixelFormat:A,dataType:E,isImmutable:G,target:F,internalFormat:H}=w;if(G&&!this._wasImmutablyAllocated)throw Error("Cannot update immutable texture before allocation!");
e(F)||console.warn("Attempting to set 3D texture data on a non-3D texture");const J=this._context.bindTexture(this,k.TEXTURE_UNIT_FOR_UPDATES);this._context.setActiveTexture(k.TEXTURE_UNIT_FOR_UPDATES);(0>c||0>m||0>q||p>w.width||u>w.height||h>w.depth||c+p>w.width||m+u>w.height||q+h>w.depth)&&console.error("An attempt to update out of bounds of the texture!");this._configurePixelStorage();a(t)?(t=t.levels[g],v.compressedTexSubImage3D(F,g,c,m,q,p,u,h,H,t)):v.texSubImage3D(F,g,c,m,q,p,u,h,A,E,t);this._context.bindTexture(J,
k.TEXTURE_UNIT_FOR_UPDATES)};r.generateMipmap=function(){const g=this._descriptor;if(!g.hasMipmap){if(this._wasImmutablyAllocated)throw Error("Cannot add mipmaps to immutable texture after allocation");this._samplingModeDirty=g.hasMipmap=!0;k._validateTexture(this._context,g)}g.samplingMode===f.TextureSamplingMode.LINEAR?(this._samplingModeDirty=!0,g.samplingMode=f.TextureSamplingMode.LINEAR_MIPMAP_NEAREST):g.samplingMode===f.TextureSamplingMode.NEAREST&&(this._samplingModeDirty=!0,g.samplingMode=
f.TextureSamplingMode.NEAREST_MIPMAP_NEAREST);const c=this._context.bindTexture(this,k.TEXTURE_UNIT_FOR_UPDATES);this._context.setActiveTexture(k.TEXTURE_UNIT_FOR_UPDATES);this._context.gl.generateMipmap(g.target);this._context.bindTexture(c,k.TEXTURE_UNIT_FOR_UPDATES)};r.setSamplingMode=function(g){g!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=g,this._samplingModeDirty=!0)};r.setWrapMode=function(g){g!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=g,k._validateTexture(this._context,
this._descriptor),this._wrapModeDirty=!0)};r.applyChanges=function(){const g=this._context.gl,c=this._descriptor;this._samplingModeDirty&&(k._applySamplingMode(g,c),this._samplingModeDirty=!1);this._wrapModeDirty&&(k._applyWrapMode(g,c),this._wrapModeDirty=!1)};r._deriveInternalFormat=function(g,c){if(this._context.type===n.ContextType.WEBGL1)return g;switch(c){case f.PixelType.FLOAT:switch(g){case f.PixelFormat.RGBA:return f.SizedPixelFormat.RGBA32F;case f.PixelFormat.RGB:return f.SizedPixelFormat.RGB32F;
default:throw Error("Unable to derive format");}case f.PixelType.UNSIGNED_BYTE:switch(g){case f.PixelFormat.RGBA:return f.SizedPixelFormat.RGBA8;case f.PixelFormat.RGB:return f.SizedPixelFormat.RGB8}default:return g}};r._configurePixelStorage=function(){const g=this._context.gl,{unpackAlignment:c,flipped:m,preMultiplyAlpha:q}=this._descriptor;g.pixelStorei(g.UNPACK_ALIGNMENT,c);g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,m?1:0);g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,q?1:0)};r._texStorage=function(g,
c,m,q,p,u){const h=this._context.gl;if(!d(h))throw Error("Immutable textures are not supported in WebGL1");if(!(c in f.SizedPixelFormat))throw Error("Immutable textures must have a sized internal format");this._descriptor.isImmutable&&(m=m?l(g,q,p,u):1,e(g)?h.texStorage3D(g,m,c,q,p,u):h.texStorage2D(g,m,c,q,p),this._wasImmutablyAllocated=!0)};r._texImage=function(g,c,m,q,p,u,h){const t=this._context.gl;let v=null;const w=this._context.type===n.ContextType.WEBGL2,A=e(g),{isImmutable:E,pixelFormat:G,
dataType:F}=this._descriptor;w&&(v=t);!w&&b(h)?t.texImage2D(g,0,m,G,F,h):E?y.isSome(h)&&(A?v.texSubImage3D(g,c,0,0,0,q,p,u,G,F,h):t.texSubImage2D(g,c,0,0,q,p,G,F,h)):(h=y.unwrap(h),A?v.texImage3D(g,c,m,q,p,u,0,G,F,h):t.texImage2D(g,c,m,q,p,0,G,F,h))};r._compressedTexImage=function(g,c,m,q,p,u,h){const t=this._context.gl;let v=null;const w=e(g),A=this._descriptor.isImmutable;if(w){if(this._context.type!==n.ContextType.WEBGL2)throw Error("3D textures are not supported in WebGL1");v=t}A?y.isSome(h)&&
(w?v.compressedTexSubImage3D(g,c,0,0,0,q,p,u,m,h):t.compressedTexSubImage2D(g,c,0,0,q,p,m,h)):w?v.compressedTexImage3D(g,c,m,q,p,u,0,h):t.compressedTexImage2D(g,c,m,q,p,0,h)};r._forEachMipmapLevel=function(g,c=Infinity){let {width:m,height:q,depth:p,hasMipmap:u,target:h}=this._descriptor;const t=h===f.TextureType.TEXTURE_3D;for(let v=0;;++v){g(v,m,q,p);if(!u||1===m&&1===q&&(!t||1===p)||v>=c)break;m=Math.max(1,m>>1);q=Math.max(1,q>>1);t&&(p=Math.max(1,p>>1))}};k._validateTexture=function(g,c){(0>c.width||
0>c.height||0>c.depth)&&console.error("Negative dimension parameters are not allowed!");g=d(g.gl);const m=B.isPowerOfTwo(c.width)&&B.isPowerOfTwo(c.height);g||!c.isImmutable&&!e(c.target)||console.error("Immutable and 3D-like textures are not supported in WebGL1!");g||m||("number"===typeof c.wrapMode?c.wrapMode!==f.TextureWrapMode.CLAMP_TO_EDGE&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):(c.wrapMode.s!==f.TextureWrapMode.CLAMP_TO_EDGE||c.wrapMode.t!==f.TextureWrapMode.CLAMP_TO_EDGE)&&
console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),c.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};k._applySamplingMode=function(g,c){let m=c.samplingMode,q=c.samplingMode;if(m===f.TextureSamplingMode.LINEAR_MIPMAP_NEAREST||m===f.TextureSamplingMode.LINEAR_MIPMAP_LINEAR)m=f.TextureSamplingMode.LINEAR,c.hasMipmap||(q=f.TextureSamplingMode.LINEAR);else if(m===f.TextureSamplingMode.NEAREST_MIPMAP_NEAREST||m===f.TextureSamplingMode.NEAREST_MIPMAP_LINEAR)m=
f.TextureSamplingMode.NEAREST,c.hasMipmap||(q=f.TextureSamplingMode.NEAREST);g.texParameteri(c.target,g.TEXTURE_MAG_FILTER,m);g.texParameteri(c.target,g.TEXTURE_MIN_FILTER,q)};k._applyWrapMode=function(g,c){"number"===typeof c.wrapMode?(g.texParameteri(c.target,g.TEXTURE_WRAP_S,c.wrapMode),g.texParameteri(c.target,g.TEXTURE_WRAP_T,c.wrapMode)):(g.texParameteri(c.target,g.TEXTURE_WRAP_S,c.wrapMode.s),g.texParameteri(c.target,g.TEXTURE_WRAP_T,c.wrapMode.t))};k._applyAnisotropicFilteringParameters=function(g,
c){var m;const q=g.capabilities.textureFilterAnisotropic;q&&g.gl.texParameterf(c.target,q.TEXTURE_MAX_ANISOTROPY,null!=(m=c.maxAnisotropy)?m:1)};D._createClass(k,[{key:"glName",get:function(){return this._glName}},{key:"descriptor",get:function(){return this._descriptor}},{key:"isDirty",get:function(){return this._samplingModeDirty||this._wrapModeDirty}}]);return k}();C.TEXTURE_UNIT_FOR_UPDATES=0;z.Texture=C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/webgl/capabilities/isWebGL2Context":function(){define(function(){return function(z){return window.WebGL2RenderingContext&&z instanceof window.WebGL2RenderingContext}})},"esri/views/webgl/Util":function(){define(["exports","../../core/has","../../core/maybe","./enums"],function(z,D,C,B){function y(f){return f[0].stride}function x(f){switch(f){case B.PixelFormat.ALPHA:case B.PixelFormat.LUMINANCE:case B.PixelFormat.RED:case B.PixelFormat.RED_INTEGER:case B.SizedPixelFormat.R8:case B.SizedPixelFormat.R8I:case B.SizedPixelFormat.R8UI:case B.SizedPixelFormat.R8_SNORM:case B.RenderbufferFormat.STENCIL_INDEX8:return 1;
case B.PixelFormat.LUMINANCE_ALPHA:case B.PixelFormat.RG:case B.PixelFormat.RG_INTEGER:case B.SizedPixelFormat.RGBA4:case B.SizedPixelFormat.R16F:case B.SizedPixelFormat.R16I:case B.SizedPixelFormat.R16UI:case B.SizedPixelFormat.RG8:case B.SizedPixelFormat.RG8I:case B.SizedPixelFormat.RG8UI:case B.SizedPixelFormat.RG8_SNORM:case B.SizedPixelFormat.RGB565:case B.SizedPixelFormat.RGB5_A1:case B.RenderbufferFormat.DEPTH_COMPONENT16:return 2;case B.PixelFormat.DEPTH_COMPONENT:case B.PixelFormat.RGB:case B.PixelFormat.RGB_INTEGER:case B.SizedPixelFormat.RGB8:case B.SizedPixelFormat.RGB8I:case B.SizedPixelFormat.RGB8UI:case B.SizedPixelFormat.RGB8_SNORM:case B.SizedPixelFormat.SRGB8:case B.RenderbufferFormat.DEPTH_COMPONENT24:return 3;
case B.PixelFormat.DEPTH_STENCIL:case B.PixelFormat.RGBA:case B.PixelFormat.RGBA_INTEGER:case B.SizedPixelFormat.RGBA8:case B.SizedPixelFormat.R32F:case B.SizedPixelFormat.R11F_G11F_B10F:case B.SizedPixelFormat.RG16F:case B.SizedPixelFormat.R32I:case B.SizedPixelFormat.R32UI:case B.SizedPixelFormat.RG16I:case B.SizedPixelFormat.RG16UI:case B.SizedPixelFormat.RGBA8I:case B.SizedPixelFormat.RGBA8UI:case B.SizedPixelFormat.RGBA8_SNORM:case B.SizedPixelFormat.SRGB8_ALPHA8:case B.SizedPixelFormat.RGB9_E5:case B.SizedPixelFormat.RGB10_A2UI:case B.SizedPixelFormat.RGB10_A2:case B.RenderbufferFormat.DEPTH_STENCIL:case B.RenderbufferFormat.DEPTH_COMPONENT32F:case B.RenderbufferFormat.DEPTH24_STENCIL8:return 4;
case B.RenderbufferFormat.DEPTH32F_STENCIL8:return 5;case B.SizedPixelFormat.RGB16F:case B.SizedPixelFormat.RGB16I:case B.SizedPixelFormat.RGB16UI:return 6;case B.SizedPixelFormat.RG32F:case B.SizedPixelFormat.RG32I:case B.SizedPixelFormat.RG32UI:case B.SizedPixelFormat.RGBA16F:case B.SizedPixelFormat.RGBA16I:case B.SizedPixelFormat.RGBA16UI:return 8;case B.SizedPixelFormat.RGB32F:case B.SizedPixelFormat.RGB32I:case B.SizedPixelFormat.RGB32UI:return 12;case B.SizedPixelFormat.RGBA32F:case B.SizedPixelFormat.RGBA32I:case B.SizedPixelFormat.RGBA32UI:return 16;
case B.CompressedTextureFormat.COMPRESSED_RGB_S3TC_DXT1_EXT:case B.CompressedTextureFormat.COMPRESSED_RGBA_S3TC_DXT1_EXT:return.5;case B.CompressedTextureFormat.COMPRESSED_RGBA_S3TC_DXT3_EXT:case B.CompressedTextureFormat.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case B.CompressedTextureFormat.COMPRESSED_R11_EAC:case B.CompressedTextureFormat.COMPRESSED_SIGNED_R11_EAC:case B.CompressedTextureFormat.COMPRESSED_RGB8_ETC2:case B.CompressedTextureFormat.COMPRESSED_SRGB8_ETC2:case B.CompressedTextureFormat.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case B.CompressedTextureFormat.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return.5;
case B.CompressedTextureFormat.COMPRESSED_RG11_EAC:case B.CompressedTextureFormat.COMPRESSED_SIGNED_RG11_EAC:case B.CompressedTextureFormat.COMPRESSED_RGBA8_ETC2_EAC:case B.CompressedTextureFormat.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}function n(f){if(C.isNone(f))return 0;if("descriptor"in f)return f.glName?n(f.descriptor):0;const d=f.internalFormat||"pixelFormat"in f&&f.pixelFormat;if(!d)return 0;const a="hasMipmap"in f&&f.hasMipmap?1.3:1;f=f.width*f.height;return x(d)*f*a}z.bindVertexBufferLayout=
function(f,d,a,b,e=0){const l=f.gl,k=f.capabilities.instancing;f.bindBuffer(a);for(const r of b)if(f=d.get(r.name),void 0===f&&console.error(`There is no location for vertex attribute '${r.name}' defined.`),a=e*r.stride,4>=r.count)l.vertexAttribPointer(f,r.count,r.type,r.normalized,r.stride,r.offset+a),l.enableVertexAttribArray(f),0<r.divisor&&k&&k.vertexAttribDivisor(f,r.divisor);else if(9===r.count)for(b=0;3>b;b++)l.vertexAttribPointer(f+b,3,r.type,r.normalized,r.stride,r.offset+12*b+a),l.enableVertexAttribArray(f+
b),0<r.divisor&&k&&k.vertexAttribDivisor(f+b,r.divisor);else if(16===r.count)for(b=0;4>b;b++)l.vertexAttribPointer(f+b,4,r.type,r.normalized,r.stride,r.offset+16*b+a),l.enableVertexAttribArray(f+b),0<r.divisor&&k&&k.vertexAttribDivisor(f+b,r.divisor);else console.error("Unsupported vertex attribute element count: "+r.count)};z.getBytesPerElementFormat=x;z.getErrorString=function(f){f=f.gl;switch(f.getError()){case f.NO_ERROR:return null;case f.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";
case f.INVALID_VALUE:return"A numeric argument is out of range";case f.INVALID_OPERATION:return"The specified command is not allowed for the current state";case f.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case f.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case f.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"};z.getGpuMemoryUsage=n;z.getStride=y;z.unbindVertexBufferLayout=function(f,d,a,b){const e=
f.gl,l=f.capabilities.instancing;f.bindBuffer(a);for(const k of b)if(a=d.get(k.name),4>=k.count)e.disableVertexAttribArray(a),k.divisor&&0<k.divisor&&l&&l.vertexAttribDivisor(a,0);else if(9===k.count)for(b=0;3>b;b++)e.disableVertexAttribArray(a+b),k.divisor&&0<k.divisor&&l&&l.vertexAttribDivisor(a+b,0);else if(16===k.count)for(b=0;4>b;b++)e.disableVertexAttribArray(a+b),k.divisor&&0<k.divisor&&l&&l.vertexAttribDivisor(a+b,0);else console.error("Unsupported vertex attribute element count: "+k.count);
f.unbindBuffer(B.BufferType.ARRAY_BUFFER)};z.vertexCount=function(f,d){return f.vertexBuffers[d].size/y(f.layout[d])};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["../../../webgl/BufferObject","../../../webgl/enums","../../../webgl/VertexArrayObject","../../../webgl/VertexElementDescriptor"],function(z,D,C,B){return function(){function y(n,f){this.rctx=n;this._vertexBuffer=z.BufferObject.createVertex(n,
D.Usage.STATIC_DRAW,new Uint16Array(f));this._vao=new C.VertexArrayObject(n,new Map([["a_position",0]]),{geometry:[new B.VertexElementDescriptor("a_position",2,D.DataType.SHORT,0,4)]},{geometry:this._vertexBuffer});this._count=f.length/2}var x=y.prototype;x.bind=function(){this.rctx.bindVAO(this._vao)};x.unbind=function(){this.rctx.bindVAO(null)};x.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};x.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(D.PrimitiveType.TRIANGLE_STRIP,
0,this._count)};return y}()})},"esri/views/webgl/VertexArrayObject":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/Logger ../../core/maybe ./enums ./Util".split(" "),function(z,D,C,B,y,x){const n=C.getLogger("esri.views.webgl.VertexArrayObject");C=function(){function f(a,b,e,l,k=null){this._context=a;this._locations=b;this._layout=e;this._buffers=l;this._indexBuffer=k;this._glName=null;this._initialized=!1;a.instanceCounter.increment(y.ResourceType.VertexArrayObject,
this)}var d=f.prototype;d.dispose=function(a=!0){if(this._context){if(this._glName){var b,e;const l=null==(b=this._context)?void 0:null==(e=b.capabilities)?void 0:e.vao;l?(l.deleteVertexArray(this._glName),this._glName=null):n.warn("Leaked WebGL VAO")}this._context.getBoundVAO()===this&&this._context.bindVAO(null);if(a){for(const l in this._buffers)this._buffers[l].dispose(),delete this._buffers[l];this._indexBuffer=B.disposeMaybe(this._indexBuffer)}this._context.instanceCounter.decrement(y.ResourceType.VertexArrayObject,
this);this._context=null}else(this._glName||a&&0<Object.getOwnPropertyNames(this._buffers).length)&&n.warn("Leaked WebGL VAO")};d.initialize=function(){if(!this._initialized){var a=this._context.capabilities.vao;if(a){const b=a.createVertexArray();a.bindVertexArray(b);this._bindLayout();a.bindVertexArray(null);this._glName=b}this._initialized=!0}};d.bind=function(){this.initialize();const a=this._context.capabilities.vao;a?a.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())};
d._bindLayout=function(){const {_buffers:a,_layout:b,_indexBuffer:e}=this;a||n.error("Vertex buffer dictionary is empty!");const l=this._context.gl;for(const k in a){const r=a[k];r||n.error("Vertex buffer is uninitialized!");const g=b[k];g||n.error("Vertex element descriptor is empty!");x.bindVertexBufferLayout(this._context,this._locations,r,g)}B.isSome(e)&&(this._context.capabilities.vao?l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,e.glName):this._context.bindBuffer(e))};d.unbind=function(){this.initialize();
const a=this._context.capabilities.vao;a?a.bindVertexArray(null):this._unbindLayout()};d._unbindLayout=function(){const {_buffers:a,_layout:b}=this;a||n.error("Vertex buffer dictionary is empty!");for(const e in a){const l=a[e];l||n.error("Vertex buffer is uninitialized!");x.unbindVertexBufferLayout(this._context,this._locations,l,b[e])}B.isSome(this._indexBuffer)&&this._context.unbindBuffer(this._indexBuffer.bufferType)};D._createClass(f,[{key:"glName",get:function(){return this._glName}},{key:"context",
get:function(){return this._context}},{key:"vertexBuffers",get:function(){return this._buffers}},{key:"indexBuffer",get:function(){return this._indexBuffer}},{key:"size",get:function(){return Object.keys(this._buffers).reduce((a,b)=>a+this._buffers[b].size,B.isSome(this._indexBuffer)?this._indexBuffer.size:0)}},{key:"layout",get:function(){return this._layout}},{key:"locations",get:function(){return this._locations}}]);return f}();z.VertexArrayObject=C;Object.defineProperties(z,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/imagery/BrushVectorField":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../webgl/brushes/WGLBrush","../../../webgl/enums"],function(z,D,C,B){const y=new Float32Array([.27058823529411763,.4588235294117647,.7098039215686275,1,.396078431372549,.5372549019607843,.7215686274509804,1,.5176470588235295,.6196078431372549,.7294117647058823,1,.6352941176470588,.7058823529411765,.7411764705882353,1,
.7529411764705882,.8,.7450980392156863,1,.8705882352941177,.8901960784313725,.7490196078431373,1,1,1,.7490196078431373,1,1,.8627450980392157,.6313725490196078,1,.9803921568627451,.7254901960784313,.5176470588235295,1,.9607843137254902,.596078431372549,.4117647058823529,1,.9294117647058824,.4588235294117647,.3176470588235294,1,.9098039215686274,.08235294117647059,.08235294117647059,1]),x={beaufort_ft:y,beaufort_m:y,beaufort_km:y,beaufort_mi:y,beaufort_kn:new Float32Array([.1568627450980392,.5725490196078431,
.7803921568627451,1,.34901960784313724,.6352941176470588,.7294117647058823,1,.5058823529411764,.7019607843137254,.6705882352941176,1,.6274509803921569,.7607843137254902,.6078431372549019,1,.7490196078431373,.8313725490196079,.5411764705882353,1,.8549019607843137,.9019607843137255,.4666666666666667,1,.9803921568627451,.9803921568627451,.39215686274509803,1,.9882352941176471,.8352941176470589,.3254901960784314,1,.9882352941176471,.7019607843137254,.4,1,.9803921568627451,.5529411764705883,.20392156862745098,
1,.9686274509803922,.43137254901960786,.16470588235294117,1,.9411764705882353,.2784313725490196,.11372549019607843,1]),classified_arrow:new Float32Array([.2196078431372549,.6588235294117647,0,1,.5450980392156862,1.2117647058823529,0,1,1,1,0,1,1,.5019607843137255,0,1,1,0,0,1]),ocean_current_m:new Float32Array([.3058823529411765,.10196078431372549,.6,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,1,.6941176470588235,.6941176470588235,
.6941176470588235,1]),ocean_current_kn:new Float32Array([0,0,0,1,0,.1450980392156863,.39215686274509803,1,.3058823529411765,.10196078431372549,.6,1,.592156862745098,0,.39215686274509803,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.6941176470588235,.3058823529411765,.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,1,.6941176470588235,.7019607843137254,.20392156862745098,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),single_arrow:new Float32Array([0,
92/255,230/255,1]),wind_speed:new Float32Array([0,0,0,1])};return function(n){function f(){var a=n.apply(this,arguments)||this;a._desc={magdir:{vsPath:"raster/magdir",fsPath:"raster/magdir",attributes:new Map([["a_pos",0],["a_offset",1],["a_vv",2]])},scalar:{vsPath:"raster/scalar",fsPath:"raster/scalar",attributes:new Map([["a_pos",0],["a_offset",1],["a_vv",2]])}};return a}z._inheritsLoose(f,n);var d=f.prototype;d.dispose=function(){};d.prepareState=function({context:a},b){a.setBlendingEnabled(!0);
a.setBlendFunctionSeparate(B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA,B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilOp(B.StencilOperation.KEEP,B.StencilOperation.KEEP,B.StencilOperation.REPLACE);a.setStencilFunction(B.CompareFunction.EQUAL,b.stencilRef,255)};d.draw=function(a,b){if(!D.isNone(b.source)&&0!==b.source.validPixelCount){var {timeline:e}=a;e.begin(this.name);b.updateVectorFieldVAO(a);
if("scalar"===a.renderPass){var l=b.vaoData.scalar;l&&this._drawScalars(a,b,l.vao,l.elementCount)}else(l=b.vaoData.magdir)&&this._drawTriangles(a,b,l.vao,l.elementCount);e.end(this.name)}};d._drawTriangles=function(a,b,e,l){const {context:k,painter:r,requestRender:g}=a,{symbolizerParameters:c}=b;var m=c.dataRange?["dataRange"]:[];"geographic"===c.rotationType&&m.push("rotationGeographic");m=r.materialManager.getProgram(this._desc.magdir,m);if(D.isSome(g)&&!m.isCompiled)g();else{k.useProgram(m);var {coordScale:q,
opacity:p,transforms:u}=b;m.setUniform2fv("u_coordScale",q);m.setUniform1f("u_opacity",p);m.setUniformMatrix3fv("u_dvsMat3",u.dvs);var {style:h,dataRange:t,rotation:v,symbolPercentRange:w}=c;m.setUniform4fv("u_colors",x[h]||x.single_arrow);m.setUniform2fv("u_dataRange",t);m.setUniform1f("u_rotation",v);m.setUniform2fv("u_symbolPercentRange",w);a=this._getSymbolSize(a,b);m.setUniform2fv("u_symbolSize",a);k.bindVAO(e);k.drawElements(B.PrimitiveType.TRIANGLES,l,B.DataType.UNSIGNED_INT,0)}};d._drawScalars=
function(a,b,e,l){const {context:k,painter:r,requestRender:g}=a,{symbolizerParameters:c}=b;var m=[];"wind_speed"===c.style?m.push("innerCircle"):c.dataRange&&m.push("dataRange");"geographic"===c.rotationType&&m.push("rotationGeographic");m=r.materialManager.getProgram(this._desc.scalar,m);if(D.isSome(g)&&!m.isCompiled)g();else{k.useProgram(m);var {coordScale:q,opacity:p,transforms:u}=b;m.setUniform2fv("u_coordScale",q);m.setUniform1f("u_opacity",p);m.setUniformMatrix3fv("u_dvsMat3",u.dvs);var {dataRange:h,
symbolPercentRange:t}=c;m.setUniform2fv("u_dataRange",h);m.setUniform2fv("u_symbolPercentRange",t);a=this._getSymbolSize(a,b);m.setUniform2fv("u_symbolSize",a);k.bindVAO(e);k.drawElements(B.PrimitiveType.TRIANGLES,l,B.DataType.UNSIGNED_INT,0)}};d._getSymbolSize=function(a,b){a=b.key?2**(a.displayLevel-b.key.level):b.resolution/a.state.resolution;const {symbolTileSize:e}=b.symbolizerParameters;return[e/(Math.round((b.width-b.offset[0])/e)*e)/a,e/(Math.round((b.height-b.offset[1])/e)*e)/a]};return f}(C)})},
"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../VertexStream ./WGLBrush ../../../../webgl/enums".split(" "),function(z,D,C,B,y,x){const n={nearest:{defines:[],samplingMode:x.TextureSamplingMode.NEAREST,mips:!1},bilinear:{defines:[],samplingMode:x.TextureSamplingMode.LINEAR,mips:!1},bicubic:{defines:["bicubic"],samplingMode:x.TextureSamplingMode.LINEAR,mips:!1},trilinear:{defines:[],samplingMode:x.TextureSamplingMode.LINEAR_MIPMAP_LINEAR,
mips:!0}};return function(f){function d(){var b=f.apply(this,arguments)||this;b._desc={vsPath:"raster/bitmap",fsPath:"raster/bitmap",attributes:new Map([["a_pos",0]])};return b}z._inheritsLoose(d,f);var a=d.prototype;a.dispose=function(){this._quad&&this._quad.dispose()};a.prepareState=function({context:b},e){b.setBlendingEnabled(!0);"additive"===e.blendFunction?b.setBlendFunctionSeparate(x.BlendFactor.ONE,x.BlendFactor.ONE,x.BlendFactor.ONE,x.BlendFactor.ONE):b.setBlendFunctionSeparate(x.BlendFactor.ONE,
x.BlendFactor.ONE_MINUS_SRC_ALPHA,x.BlendFactor.ONE,x.BlendFactor.ONE_MINUS_SRC_ALPHA);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0);b.setStencilFunction(x.CompareFunction.EQUAL,e.stencilRef,255)};a.draw=function(b,e){const {context:l,renderingOptions:k,painter:r,requestRender:g}=b;if(e.source){if("dynamic"===k.samplingMode){({state:q}=b);var c=e.resolution/e.pixelRatio/q.resolution,m=Math.round(b.pixelRatio)!==b.pixelRatio;c=1.05<c||.95>c;var q=q.rotation||c||m||
e.isSourceScaled||e.rotation?n.bilinear:n.nearest}else q=n[k.samplingMode];m=r.materialManager.getProgram(this._desc,q.defines);if(D.isSome(g)&&!m.isCompiled)g();else{b.timeline.begin(this.name);this._quad||(this._quad=new B(l,[0,0,1,0,0,1,1,1]));var {coordScale:p,computedOpacity:u,transforms:h}=e;e.setSamplingProfile(q);e.bind(b.context,C.TEXTURE_BINDING_BITMAP);l.useProgram(m);m.setUniformMatrix3fv("u_dvsMat3",h.dvs);m.setUniform1i("u_texture",C.TEXTURE_BINDING_BITMAP);m.setUniform2fv("u_coordScale",
p);m.setUniform1f("u_opacity",u);this._quad.draw();b.timeline.end(this.name)}}};return d}(y)})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/enums ../../../../webgl/ProgramTemplate".split(" "),function(z,D,C,B,y,x,n,f){return function(d){function a(){var e=d.apply(this,arguments)||this;e._color=C.fromValues(0,
1,0,1);return e}z._inheritsLoose(a,d);var b=a.prototype;b.dispose=function(){this._program&&this._program.dispose()};b.prepareState=function({context:e}){e.setStencilTestEnabled(!0);e.setBlendingEnabled(!1);e.setFaceCullingEnabled(!1);e.setColorMask(!1,!1,!1,!1);e.setStencilOp(n.StencilOperation.KEEP,n.StencilOperation.KEEP,n.StencilOperation.REPLACE);e.setStencilWriteMask(255);e.setStencilFunction(n.CompareFunction.ALWAYS,0,255)};b.draw=function(e,l){const {context:k,state:r,requestRender:g}=e;e=
B.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:n.DataType.SHORT}]});l=l.getVAO(k,r,e.attributes,e.bufferLayouts);D.isNone(l.indexBuffer)||(this._program||(this._program=f.createProgram(k,x.background)),D.isSome(g)&&!this._program.isCompiled?g():(k.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),this._program.setUniformMatrix3fv("u_dvsMat3",r.displayMat3),k.bindVAO(l),k.drawElements(n.PrimitiveType.TRIANGLES,
l.indexBuffer.size,n.DataType.UNSIGNED_INT,0),k.bindVAO()))};return a}(y)})},"esri/chunks/vec4f32":function(){define(["exports"],function(z){function D(){return new Float32Array(4)}function C(q){const p=new Float32Array(4);p[0]=q[0];p[1]=q[1];p[2]=q[2];p[3]=q[3];return p}function B(q,p,u,h){const t=new Float32Array(4);t[0]=q;t[1]=p;t[2]=u;t[3]=h;return t}function y(q,p){return new Float32Array(q,p,4)}function x(){return D()}function n(){return B(1,1,1,1)}function f(){return B(1,0,0,0)}function d(){return B(0,
1,0,0)}function a(){return B(0,0,1,0)}function b(){return B(0,0,0,1)}const e=D(),l=n(),k=f(),r=d(),g=a(),c=b(),m=Object.freeze(Object.defineProperty({__proto__:null,create:D,clone:C,fromValues:B,createView:y,zeros:x,ones:n,unitX:f,unitY:d,unitZ:a,unitW:b,ZEROS:e,ONES:l,UNIT_X:k,UNIT_Y:r,UNIT_Z:g,UNIT_W:c},Symbol.toStringTag,{value:"Module"}));z.ONES=l;z.UNIT_W=c;z.UNIT_X=k;z.UNIT_Y=r;z.UNIT_Z=g;z.ZEROS=e;z.clone=C;z.create=D;z.createView=y;z.fromValues=B;z.ones=n;z.unitW=b;z.unitX=f;z.unitY=d;z.unitZ=
a;z.vec4f32=m;z.zeros=x})},"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../symbols/cim/enums ./color ./enums ./SymbolProperties ../../../webgl/enums ../../../webgl/Texture ../../../webgl/VertexElementDescriptor".split(" "),function(z,D,C,B,y,x,n,f,d,a,b,e){function l(Q){const W={};for(const R of Q)W[R.name]=R.strideInBytes;return W}function k(Q){switch(Q){case f.WGLGeometryType.MARKER:return M;
case f.WGLGeometryType.FILL:return K;case f.WGLGeometryType.LINE:return O;case f.WGLGeometryType.TEXT:return X;case f.WGLGeometryType.LABEL:return aa}}function r(Q){switch(Q%4){case 0:case 2:return 4;case 1:case 3:return 1}}function g(Q){switch(Q){case a.DataType.BYTE:case a.DataType.UNSIGNED_BYTE:return 1;case a.DataType.SHORT:case a.DataType.UNSIGNED_SHORT:return 2;case a.DataType.FLOAT:case a.DataType.INT:case a.DataType.UNSIGNED_INT:return 4}}function c(Q){const W={};for(const R in Q){let S=0;
W[R]=Q[R].map(Z=>{const ca=new e.VertexElementDescriptor(Z.name,Z.count,Z.type,S,0,Z.normalized||!1);S+=Z.count*g(Z.type);return ca});W[R].forEach(Z=>Z.stride=S)}return W}const m=C.getLogger("esri.views.2d.engine.webgl.Utils");C=[{name:"geometry",strideInBytes:36}];const q=[{name:"geometry",strideInBytes:12}],p=[{name:"geometry",strideInBytes:36}],u=[{name:"geometry",strideInBytes:24}],h=[{name:"geometry",strideInBytes:12}],t=[{name:"geometry",strideInBytes:40}],v=[{name:"geometry",strideInBytes:36}],
w=[{name:"geometry",strideInBytes:36}],A=l(C),E=l(q),G=l(p),F=l(u),H=l(h),J=l(t),I=l(v),N=l(w),M=["geometry"],K=["geometry"],O=["geometry"],X=["geometry"],aa=["geometry"],ba={["geometry"]:a.Usage.STATIC_DRAW},V=new Map,L=Q=>Q.startsWith("data:image/gif"),P=Q=>Q.startsWith("data:image/png"),Y=Q=>{if(!Q)return!1;Q=Q.trim();return/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(Q)&&/[\dz]$/i.test(Q)&&4<Q.length?!0:!1},U=Q=>{var W,R;return"fill"===Q.type&&"CIMMarkerPlacementInsidePolygon"===(null==Q?void 0:
null==(W=Q.cim)?void 0:null==(R=W.markerPlacement)?void 0:R.type)};z.C_FILL_STRIDE_SPEC=G;z.C_FILL_STRIDE_SPEC_DD=H;z.C_FILL_STRIDE_SPEC_SIMPLE=F;z.C_FILL_VERTEX_DEF=p;z.C_FILL_VERTEX_DEF_DD=h;z.C_FILL_VERTEX_DEF_SIMPLE=u;z.C_HEATMAP_STRIDE_SPEC=E;z.C_HEATMAP_VERTEX_DEF=q;z.C_ICON_STRIDE_SPEC=A;z.C_ICON_VERTEX_DEF=C;z.C_LABEL_STRIDE_SPEC=N;z.C_LABEL_VERTEX_DEF=w;z.C_LINE_STRIDE_SPEC=J;z.C_LINE_VERTEX_DEF=t;z.C_TEXT_STRIDE_SPEC=I;z.C_TEXT_VERTEX_DEF=v;z.C_VBO_GEOMETRY="geometry";z.C_VBO_INFO=ba;z.C_VBO_PERINSTANCE=
"per_instance";z.C_VBO_PERINSTANCE_VV="per_instance_vv";z.allocateTypedArrayBuffer=function(Q,W){switch(W%4){case 0:case 2:return new Uint32Array(Math.floor(Q*W/4));case 1:case 3:return new Uint8Array(Q*W)}};z.allocateTypedArrayBufferwithData=function(Q,W){switch(W%4){case 0:case 2:return new Uint32Array(Q);case 1:case 3:return new Uint8Array(Q)}};z.charCodes=function(Q){const W=[];for(let R=0;R<Q.length;R++)W.push(Q.charCodeAt(R));return W};z.copyMeshData=function(Q,W,R,S,Z,ca,ia){for(const fa in ca){var T=
ca[fa].stride,da=r(T);const ka=ca[fa].data,ea=R[fa].data,ha=T*Z.vertexCount/da,ja=T*Q/da;T=T*Z.vertexFrom/da;for(da=0;da<ha;++da)ea[da+ja]=ka[da+T]}R=Z.indexCount;for(ca=0;ca<R;++ca)S[ca+W]=ia[ca+Z.indexFrom]-Z.vertexFrom+Q};z.createGeometryData=function(Q,W){const R=[];for(let S=0;5>S;++S){const Z=k(S),ca={};for(const ia of Z)ca[ia]={data:W(S,ia)};R.push({data:Q(S),buffers:ca})}return R};z.createProgramDescriptor=(Q,W)=>{if(!V.has(Q)){const Z=c(W);var R=Z;var S={};for(const ca in R){const ia=R[ca];
S[ca]=ia.length?ia[0].stride:0}R=S;S=new Map;for(const ca in W)for(const ia of W[ca])S.set(ia.name,ia.location);W=S;V.set(Q,{strides:R,bufferLayouts:Z,attributes:W})}return V.get(Q)};z.createTextureFromTexelData=function(Q,W){let R,S;B.isPowerOfTwo(W.width)&&B.isPowerOfTwo(W.height)?(R=!0,S=a.TextureSamplingMode.LINEAR_MIPMAP_LINEAR):(R=!1,S=a.TextureSamplingMode.LINEAR);return new b.Texture(Q,{target:a.TextureType.TEXTURE_2D,pixelFormat:a.PixelFormat.RGBA,internalFormat:a.PixelFormat.RGBA,dataType:a.PixelType.UNSIGNED_BYTE,
hasMipmap:R,samplingMode:S,wrapMode:a.TextureWrapMode.CLAMP_TO_EDGE,flipped:!0},W)};z.forEachGeometryType=function(Q){Q(f.WGLGeometryType.FILL);Q(f.WGLGeometryType.LINE);Q(f.WGLGeometryType.MARKER);Q(f.WGLGeometryType.TEXT);Q(f.WGLGeometryType.LABEL)};z.geometryToMappedGeometry=function(Q){return{vertexFrom:void 0,vertexTo:void 0,geometry:Q}};z.getBytes=g;z.getCapType=function(Q){switch(Q){case "butt":return x.CapType.BUTT;case "round":return x.CapType.ROUND;case "square":return x.CapType.SQUARE;
default:return m.error(new D("mapview-invalid-type",`Cap type ${Q} is not a valid option. Defaulting to round`)),x.CapType.ROUND}};z.getJoinType=function(Q){switch(Q){case "miter":return x.JoinType.MITER;case "bevel":return x.JoinType.BEVEL;case "round":return x.JoinType.ROUND;default:return m.error(new D("mapview-invalid-type",`Join type ${Q} is not a valid option. Defaulting to round`)),x.JoinType.ROUND}};z.getNamedBuffers=k;z.getPMSResourceSize=function(Q){const W="maxVVSize"in Q&&Q.maxVVSize;
Q="width"in Q&&Q.width||"size"in Q&&Q.size||0;return W?W:Q};z.getPixelArrayCtor=function(Q){switch(Q){case a.PixelType.UNSIGNED_BYTE:return Uint8Array;case a.PixelType.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case a.PixelType.FLOAT:return Float32Array;default:m.error(new D("webgl-utils",`Unable to handle type ${Q}`))}};z.getPixelBytes=function(Q){switch(Q){case a.PixelType.UNSIGNED_BYTE:return 1;case a.PixelType.UNSIGNED_SHORT_4_4_4_4:return 2;case a.PixelType.FLOAT:return 4;default:m.error(new D("webgl-utils",
`Unable to handle type ${Q}`))}};z.getStrides=function(Q,W){switch(Q){case f.WGLGeometryType.MARKER:switch(W){case f.WGLSymbologyType.HEATMAP:return E;default:return A}case f.WGLGeometryType.FILL:switch(W){case f.WGLSymbologyType.DOT_DENSITY:return H;case f.WGLSymbologyType.SIMPLE:case f.WGLSymbologyType.OUTLINE_FILL_SIMPLE:return F;default:return G}case f.WGLGeometryType.LINE:return J;case f.WGLGeometryType.TEXT:return I;case f.WGLGeometryType.LABEL:return N}};z.getTextProperties=function(Q){return d.TextProperties.pool.acquire(Q.color?
n.copyAndPremultiply(Q.color):[255,255,255,255],Q.haloColor?n.copyAndPremultiply(Q.haloColor):[255,255,255,255],y.pt2px(Q.haloSize),y.pt2px(Q.font.size),Q.angle*Math.PI/180,Q.xoffset/Q.font.size,Q.yoffset/Q.font.size,"left"===Q.horizontalAlignment?0:"right"===Q.horizontalAlignment?1:.5,"top"===Q.verticalAlignment?0:"bottom"===Q.verticalAlignment?1:.5)};z.getTransformParams=function(Q){const {transform:W,hasZ:R,hasM:S}=Q;return{transform:W,hasZ:R,hasM:S}};z.getUrl=Q=>"imageData"in Q&&Q.imageData&&
"contentType"in Q&&Q.contentType?`data:${Q.contentType};base64,${Q.imageData}`:"url"in Q?Q.url:null;z.getVVType=function(Q){switch(Q){case "opacity":return f.VVType.OPACITY;case "color":return f.VVType.COLOR;case "rotation":return f.VVType.ROTATION;case "size":return f.VVType.SIZE;default:return m.error(`Cannot interpret unknown vv: ${Q}`),null}};z.is3D=Q=>Q.type&&Q.type.toLowerCase().includes("3d");z.isDefined=function(Q){return null!=Q};z.isGIF=Q=>"url"in Q&&Q.url&&(Q.url.includes(".gif")||L(Q.url))||
"contentType"in Q&&"image/gif"===Q.contentType||"imageData"in Q&&L(Q.imageData);z.isGIFDataUri=L;z.isImageResource=Q=>"url"in Q&&Q.url||"imageData"in Q&&Q.imageData;z.isMarkerPlacementInsidePolygon=U;z.isNumber=function(Q){return"number"===typeof Q};z.isPNG=Q=>"url"in Q&&Q.url&&(Q.url.includes(".png")||P(Q.url))||"contentType"in Q&&"image/png"===Q.contentType||"imageData"in Q&&P(Q.imageData);z.isPNGDataUri=P;z.isSVGImage=Q=>Q.includes("data:image/svg+xml");z.isSVGResource=Q=>"path"in Q&&Y(Q.path);
z.isSimple=function(Q){switch(Q.type){case "line":return"CIMSolidStroke"===Q.cim.type&&!Q.dashTemplate;case "fill":return"CIMSolidFill"===Q.cim.type;case "esriSFS":return"esriSFSSolid"===Q.style||"esriSFSNull"===Q.style;case "esriSLS":return"esriSLSSolid"===Q.style||"esriSLSNull"===Q.style;default:return!1}};z.isValidSVG=Y;z.shouldRepeat=function(Q){switch("cim"in Q?Q.cim.type:Q.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":return!1;case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":return U(Q);
default:return!0}};z.strideToPackingFactor=r;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/color":function(){define(["exports","../../../../core/maybe","./number"],function(z,D,C){function B(n,f){Array.isArray(f)?(n[0]=f[0],n[1]=f[1],n[2]=f[2],n[3]=f[3]):(n[0]=f.r,n[1]=f.g,n[2]=f.b,n[3]=f.a);return n}function y(n,f=0,d=!1){const a=n[f+3];n[f+0]*=a;n[f+1]*=a;n[f+2]*=a;d||(n[f+3]*=255);return n}const x=[0,0,0,0];z.copyAndPremultiply=
function(n){return y(B([],n))};z.premultiplyAlpha=y;z.premultiplyAlphaRGBA=function(n){if(!n)return 0;const {r:f,g:d,b:a,a:b}=n;return C.i8888to32(f*b,d*b,a*b,255*b)};z.premultiplyAlphaRGBAArray=function(n){if(!n)return 0;const [f,d,a,b]=n;return C.i8888to32(b/255*f,b/255*d,b/255*a,b)};z.premultiplyAlphaUint32=function(n){y(B(x,n));return C.i8888to32(x[0],x[1],x[2],x[3])};z.white=[255,255,255,1];z.writeColor=function(n,f,d=0){if(D.isNone(f))n[d+0]=0,n[d+1]=0,n[d+2]=0,n[d+3]=0;else{var {r:a,g:b,b:e,
a:l}=f;n[d+0]=a*l/255;n[d+1]=b*l/255;n[d+2]=e*l/255;n[d+3]=l}};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],function(z){function D(y,x,n){return Math.round(Math.max(Math.min(y,n),x))}const C=new Float32Array(1),B=new Uint32Array(C.buffer);z.i16=function(y){return D(y,-32768,32767)};z.i1616to32=function(y,x){return 65535&y|x<<16};z.i32=function(y){return D(y,-2147483648,2147483647)};z.i8=
function(y){return D(y,-128,127)};z.i8816to32=function(y,x,n){return y&255|(x&255)<<8|n<<16};z.i8888to32=function(y,x,n,f){return y&255|(x&255)<<8|(n&255)<<16|f<<24};z.numTo32=function(y){return y|0};z.toFloat32=function(y){B[0]=y;return C[0]};z.toUint32=function(y){C[0]=y;return B[0]};z.u16=function(y){return D(y,0,65535)};z.u32=function(y){return D(y,0,4294967295)};z.u32to4Xu8=function(y){return[y&255,(y&65280)>>>8,(y&16711680)>>>16,(y&4278190080)>>>24]};z.u4u4to8=function(y,x){return 15&y|(15&
x)<<4};z.u8=function(y){return D(y,0,255)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["exports","../../../../core/ObjectPool"],function(z,D){let C=function(){function B(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}var y=B.prototype;y.acquire=function(x,n,f,d,a,b,e,l,k){this.color=x;this.haloColor=
n;this.haloSize=f;this.size=d;this.angle=a;this.offsetX=b;this.offsetY=e;this.hAnchor=l;this.vAnchor=k};y.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};return B}();C.pool=new D(C);z.TextProperties=C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["exports",
"./sources/resolver"],function(z,D){D={shaders:{vertexShader:D.resolveIncludes("background/background.vert"),fragmentShader:D.resolveIncludes("background/background.frag")},attributes:new Map([["a_pos",0]])};z.background=D;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["exports","./shaderRepository","../../../../../webgl/ShaderCompiler"],function(z,D,C){const B=new C.ShaderCompiler(function(y){let x=
D;y.split("/").forEach(n=>{x&&(x=x[n])});return x});z.resolveIncludes=function(y){return B.resolveIncludes(y)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\ngl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\nvec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nlowp vec4 color \x3d texture2D(u_tex, v_uv);\ngl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_pos, 0.0, 1.0);\nv_uv \x3d a_tex;\n}"},blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\nuniform lowp float u_inFadeOpacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\nreturn max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\nfloat vIn \x3d rgb2v(Cb);\nvec3 hsvTint \x3d rgb2hsv(Cs);\nvec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\nreturn hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 0.0) ? 0.0 : (Cs \x3d\x3d 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 1.0) ? 1.0 : (Cs \x3d\x3d 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\nreturn (Cs \x3d\x3d 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\nif (Cs \x3c\x3d 0.5) {\nreturn Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n}\nif (Cb \x3c\x3d 0.25) {\nreturn Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n}\nreturn Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\nreturn min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\nreturn max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\nreturn dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\nreturn maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\nfloat lum \x3d lumv3(color);\nfloat mincol \x3d minv3(color);\nfloat maxcol \x3d maxv3(color);\nif (mincol \x3c 0.0) {\ncolor \x3d lum + ((color - lum) * lum) / (lum - mincol);\n}\nif (maxcol \x3e 1.0) {\ncolor \x3d lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n}\nreturn color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\nfloat lbase \x3d lumv3(cbase);\nfloat llum \x3d lumv3(clum);\nfloat ldiff \x3d llum - lbase;\nvec3 color \x3d cbase + vec3(ldiff);\nreturn clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\nfloat minbase \x3d minv3(cbase);\nfloat sbase \x3d satv3(cbase);\nfloat ssat \x3d satv3(csat);\nvec3 color;\nif (sbase \x3e 0.0) {\ncolor \x3d (cbase - minbase) * ssat / sbase;\n} else {\ncolor \x3d vec3(0.0);\n}\nreturn setLum(color, clum);\n}\nvoid main() {\nvec4 src \x3d texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\ngl_FragColor \x3d src *  u_opacity;\n#else\nvec4 dst \x3d texture2D(u_backbufferTexture, v_uv);\nvec3 Cs \x3d src.a \x3d\x3d 0.0 ? src.rgb : vec3(src.rgb / src.a);\nvec3 Cb \x3d dst.a \x3d\x3d 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\nfloat as \x3d u_opacity * src.a;\nfloat ab \x3d dst.a;\n#ifdef DESTINATION_OVER\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n#endif\n#ifdef SOURCE_IN\nvec4 color \x3d vec4(as * Cs * ab, as * ab);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef DESTINATION_IN\nvec4 color \x3d vec4(ab * Cb * as, ab * as);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef SOURCE_OUT\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n#endif\n#ifdef DESTINATION_OUT\ngl_FragColor \x3d vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n#endif\n#ifdef SOURCE_ATOP\ngl_FragColor \x3d vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n#endif\n#ifdef DESTINATION_ATOP\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n#endif\n#ifdef XOR\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\nas * (1.0 - ab) + ab * (1.0 - as));\n#endif\n#ifdef MULTIPLY\ngl_FragColor \x3d vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\nas + ab * (1.0 - as));\n#endif\n#ifdef SCREEN\ngl_FragColor \x3d vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef OVERLAY\nvec3 f \x3d vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DARKEN\ngl_FragColor \x3d vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LIGHTER\ngl_FragColor \x3d vec4(as * Cs + ab * Cb, as + ab);\n#endif\n#ifdef LIGHTEN\ngl_FragColor \x3d vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_DODGE\nvec3 f \x3d vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_BURN\nvec3 f \x3d vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HARD_LIGHT\nvec3 f \x3d vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SOFT_LIGHT\nvec3 f \x3d vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DIFFERENCE\ngl_FragColor \x3d vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef EXCLUSION\nvec3 f \x3d Cs + Cb - 2.0 * Cs * Cb;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef INVERT\ngl_FragColor \x3d vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n#endif\n#ifdef VIVID_LIGHT\nvec3 f \x3d vec3(vividLight(Cb.r, Cs.r),\nvividLight(Cb.g, Cs.g),\nvividLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HUE\nvec3 f \x3d setLumSat(Cs,Cb,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SATURATION\nvec3 f \x3d setLumSat(Cb,Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR\nvec3 f \x3d setLum(Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LUMINOSITY\nvec3 f \x3d setLum(Cb,Cs);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef PLUS\ngl_FragColor \x3d clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n#endif\n#ifdef MINUS\ngl_FragColor \x3d vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n#endif\n#ifdef AVERAGE\nvec3 f \x3d (Cb + Cs) / 2.0;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef REFLECT\nvec3 f \x3d vec3(reflectBlend(Cb.r, Cs.r),\nreflectBlend(Cb.g, Cs.g),\nreflectBlend(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#endif\n}",
"blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_position , 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"},dot:{dot:{"dot.frag":"precision mediump float;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nuniform highp float u_tileZoomFactor;\nvoid main()\n{\nfloat dist \x3d length(gl_PointCoord - vec2(.5, .5)) * 2.;\nfloat alpha \x3d smoothstep(0., 1., v_invEdgeRatio * (dist - v_dotRatio) + 1.);\ngl_FragColor \x3d v_color * alpha;\n}",
"dot.vert":"precision highp float;\nattribute vec2 a_pos;\nuniform sampler2D u_texture;\nuniform highp mat3 u_dvsMat3;\nuniform highp float u_tileZoomFactor;\nuniform highp float u_dotSize;\nuniform highp float u_pixelRatio;\nvarying vec2 v_pos;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nconst float EPSILON \x3d 0.000001;\nvoid main()\n{\nmat3 tileToTileTexture \x3d mat3(  1., 0., 0.,\n0., -1., 0.,\n0., 1., 1.  );\nvec3 texCoords \x3d tileToTileTexture * vec3(a_pos.xy / 512., 1.);\nv_color \x3d texture2D(u_texture, texCoords.xy);\nfloat smoothEdgeWidth \x3d max(u_dotSize / 2., 1.) ;\nfloat z \x3d 0.;\nz +\x3d 2.0 * step(v_color.a, EPSILON);\ngl_PointSize \x3d (smoothEdgeWidth + u_dotSize);\ngl_Position \x3d vec4((u_dvsMat3 * vec3(a_pos + .5, 1.)).xy, z, 1.);\nv_dotRatio \x3d u_dotSize / gl_PointSize;\nv_invEdgeRatio \x3d -1. / ( smoothEdgeWidth / gl_PointSize );\ngl_PointSize  *\x3d (u_pixelRatio * u_tileZoomFactor);\n}"}},
filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\nfloat b \x3d 1.0 / 6.0;\nfloat v2 \x3d v * v;\nfloat v3 \x3d v2 * v;\nfloat w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\nfloat w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\nfloat w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\nfloat w3 \x3d b * v3;\nreturn vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\nvec4 w \x3d computeWeights(v);\nfloat g0 \x3d w.x + w.y;\nfloat g1 \x3d w.z + w.w;\nfloat h0 \x3d 1.0 - (w.y / g0) + v;\nfloat h1 \x3d 1.0 + (w.w / g1) - v;\nreturn vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\nvec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\nvec2 texel \x3d coords * texSize - 0.5;\nvec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\nvec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\nvec2 coords10 \x3d coords + hgX.x * eX;\nvec2 coords00 \x3d coords - hgX.y * eX;\nvec2 coords11 \x3d coords10 + hgY.x * eY;\nvec2 coords01 \x3d coords00 + hgY.x * eY;\ncoords10 \x3d coords10 - hgY.y * eY;\ncoords00 \x3d coords00 - hgY.y * eY;\nvec4 color00 \x3d texture2D(sampler, coords00);\nvec4 color10 \x3d texture2D(sampler, coords10);\nvec4 color01 \x3d texture2D(sampler, coords01);\nvec4 color11 \x3d texture2D(sampler, coords11);\ncolor00 \x3d mix(color00, color01, hgY.z);\ncolor10 \x3d mix(color10, color11, hgY.z);\ncolor00 \x3d mix(color00, color10, hgX.z);\nreturn color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 texelStart \x3d floor(coords * texSize);\nvec2 coord0 \x3d texelStart / texSize;\nvec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\nvec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\nvec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\nvec4 color0 \x3d texture2D(sampler, coord0);\nvec4 color1 \x3d texture2D(sampler, coord1);\nvec4 color2 \x3d texture2D(sampler, coord2);\nvec4 color3 \x3d texture2D(sampler, coord3);\nvec2 blend \x3d fract(coords * texSize);\nvec4 color01 \x3d mix(color0, color1, blend.x);\nvec4 color23 \x3d mix(color2, color3, blend.x);\nvec4 color \x3d mix(color01, color23, blend.y);\n#ifdef NNEDGE\nfloat alpha \x3d floor(color0.a * color1.a * color2.a * color3.a + 0.5);\ncolor \x3d color * alpha + (1.0 - alpha) * texture2D(sampler, coords);\n#endif\nreturn color;\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\nvec2 invSize \x3d 1.0 / texSize;\nvec2 texel \x3d coords * texSize;\nvec2 texel_i \x3d floor(texel);\nvec2 texel_frac \x3d fract(texel);\nvec4 colorP \x3d texture2D(sampler, texel_i * invSize);\nvec4 colorP1 \x3d vec4(colorP);\nvec4 colorP2 \x3d vec4(colorP);\nvec4 colorP3 \x3d vec4(colorP);\nvec4 colorP4 \x3d vec4(colorP);\nvec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\nvec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\nvec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\nvec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\nif (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\ncolorP1 \x3d colorA;\n}\nif (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\ncolorP2 \x3d colorB;\n}\nif (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\ncolorP3 \x3d colorC;\n}\nif (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\ncolorP4 \x3d colorD;\n}\nvec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\nvec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\nreturn mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\nvec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\nfloat flags \x3d data0.r * 255.0;\nfloat groupMinZoom \x3d data0.g * 255.0;\nfloat isVisible \x3d getFilterBit(flags, 0);\nfloat wouldClip \x3d step(groupMinZoom, u_zoomLevel);\nfloat direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\nfloat dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\nvec4 nextState \x3d vec4(texel + direction * dt);\ngl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\ngl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},heatmap:{heatmapResolve:{"heatmapResolve.frag":"precision highp float;\n#ifdef HEATMAP_PRECISION_HALF_FLOAT\n#define COMPRESSION_FACTOR 4.0\n#else\n#define COMPRESSION_FACTOR 1.0\n#endif\nuniform sampler2D u_texture;\nuniform sampler2D u_gradient;\nuniform vec2 u_densityMinAndInvRange;\nuniform float u_densityNormalization;\nvarying vec2 v_uv;\nvoid main() {\nvec4 data \x3d texture2D(u_texture, v_uv);\nfloat density \x3d data.r * COMPRESSION_FACTOR;\ndensity *\x3d u_densityNormalization;\ndensity \x3d (density - u_densityMinAndInvRange.x) * u_densityMinAndInvRange.y;\nvec4 color \x3d texture2D(u_gradient, vec2(density, 0.5));\ngl_FragColor \x3d vec4(color.rgb * color.a, color.a);\n}",
"heatmapResolve.vert":"precision highp float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nvarying vec2 v_uv;\nconst float UV_TO_TILE_SPACE \x3d 512.;\nvoid main() {\nv_uv \x3d a_pos;\ngl_Position \x3d vec4((u_dvsMat3 * vec3(a_pos * UV_TO_TILE_SPACE, 1.)).xy, 1., 1.);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump float u_sigma;\nuniform sampler2D u_texture;\nmediump float gauss1(mediump vec2 dir) {\nreturn exp(-dot(dir, dir) / (2.0 * u_sigma * u_sigma));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\nreturn u_channelSelector * sample;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\nmediump float w \x3d gauss1(i * u_direction.xy);\ntot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\nweight +\x3d w;\n}\nvoid main(void) {\nmediump float tot \x3d 0.0;\nmediump float weight \x3d 0.0;\naccumGauss1(-5.0, tot, weight);\naccumGauss1(-4.0, tot, weight);\naccumGauss1(-3.0, tot, weight);\naccumGauss1(-2.0, tot, weight);\naccumGauss1(-1.0, tot, weight);\naccumGauss1(0.0, tot, weight);\naccumGauss1(1.0, tot, weight);\naccumGauss1(2.0, tot, weight);\naccumGauss1(3.0, tot, weight);\naccumGauss1(4.0, tot, weight);\naccumGauss1(5.0, tot, weight);\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump float u_sigma;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\nmediump float y \x3d texture2D(u_texture, v_texcoord)[3];\nconst mediump float y0 \x3d 0.5;\nmediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * u_sigma);\nmediump float d \x3d (y - y0) / m0;\nreturn d;\n}\nmediump vec4 shade(mediump float d) {\nmediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\nmappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\nreturn texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\nmediump float d \x3d estimateDistance();\ngl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlayTexture;\nuniform bool u_maskEnabled;\nuniform bool u_overlayEnabled;\nvarying mediump vec2 v_texCoord;\nconst lowp float barrelFactor \x3d 1.1;\nlowp vec2 barrel(lowp vec2 uv) {\nlowp vec2 uvn \x3d uv * 2.0 - 1.0;\nif (uvn.x \x3d\x3d 0.0 \x26\x26 uvn.y \x3d\x3d 0.0) {\nreturn vec2(0.5, 0.5);\n}\nlowp float theta \x3d atan(uvn.y, uvn.x);\nlowp float r \x3d pow(length(uvn), barrelFactor);\nreturn r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;\n}\nvoid main(void)\n{\nlowp vec4 color \x3d texture2D(u_readbackTexture, barrel(v_texCoord));\ncolor \x3d (color + (1.0 - color.a) * u_background);\nlowp float mask \x3d u_maskEnabled ? texture2D(u_maskTexture, v_texCoord).a : 1.0;\ncolor *\x3d mask;\nlowp vec4 overlayColor \x3d u_overlayEnabled ? texture2D(u_overlayTexture, v_texCoord) : vec4(0);\ngl_FragColor \x3d overlayColor + (1.0 - overlayColor.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec4 u_drawPos;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\nv_texCoord \x3d a_pos;\ngl_Position \x3d vec4(u_drawPos.xy + vec2(a_pos - 0.5) * u_drawPos.zw, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp sampler2D u_attributeData4;\nuniform highp sampler2D u_attributeData5;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec3 id) {\nhighp vec3  texel \x3d unpackDisplayIdTexel(id);\nhighp float size \x3d float(u_attributeTextureSize);\nhighp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256);\nhighp float col \x3d mod(u32, size);\nhighp float row \x3d (u32 - col) / size;\nhighp float u \x3d col / size;\nhighp float v \x3d row / size;\nreturn vec2(u, v);\n}\nhighp vec2 getAttributeDataTextureCoords(in highp vec3 id) {\nreturn (getAttributeDataCoords(id) * 2.0) - 1.0 + (.5 / vec2(u_attributeTextureSize));\n}\nhighp vec4 getAttributeData0(in highp vec3 id) {\nvec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData3, coords);\n}\nhighp vec4 getAttributeData4(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData4, coords);\n}\nhighp vec4 getAttributeData5(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData5, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\nbool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\nif (isMagic) {\nreturn NAN_MAGIC_NUMBER;\n}\nreturn (v.x + v.y * float(0x100)) - 32768.0;\n}",
"barycentric.glsl":"float inTriangle(vec3 bary) {\nvec3 absBary \x3d abs(bary);\nreturn step((absBary.x + absBary.y + absBary.z), 1.05);\n}\nvec3 xyToBarycentric(in vec2 pos, in vec2 v0,  in vec2 v1, in vec2 v2) {\nmat3 xyToBarycentricMat3 \x3d mat3(\nv1.x * v2.y - v2.x * v1.y, v2.x * v0.y - v0.x * v2.y, v0.x * v1.y - v1.x * v0.y,\nv1.y - v2.y, v2.y - v0.y, v0.y - v1.y,\nv2.x - v1.x, v0.x - v2.x, v1.x - v0.x\n);\nfloat A2 \x3d v0.x * (v1.y - v2.y) + v1.x * (v2.y - v0.y) + v2.x * (v0.y - v1.y);\nreturn (1. / A2) * xyToBarycentricMat3 * vec3(1., pos);\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_RAD_TO_DEG \x3d 180.0 / 3.141592654;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float POSITION_PRECISION \x3d 1.0 / 8.0;\nconst float FILL_POSITION_PRECISION \x3d 1.0 / 1.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING \x3d 1.0 / 4.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.00001;\nconst float EPSILON_HITTEST \x3d 0.05;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;\nconst int BITSET_GENERIC_LOCK_COLOR \x3d 1;\nconst int BITSET_GENERIC_CONSIDER_ALPHA_ONLY \x3d 4;\nconst int BITSET_MARKER_ALIGNMENT_MAP \x3d 0;\nconst int BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE \x3d 2;\nconst int BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY \x3d 3;\nconst int BITSET_TYPE_FILL_OUTLINE \x3d 0;\nconst int BITSET_FILL_RANDOM_PATTERN_OFFSET \x3d 2;\nconst int BITSET_LINE_SCALE_DASH \x3d 2;",
fill:{"common.glsl":"#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_sampleAlphaOnly;\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying highp vec3 v_id;\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\nvarying mediump vec4 v_aux1;\n#ifdef PATTERN\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nvarying lowp float v_isOutline;\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.frag\x3e\nlowp vec4 drawLine() {\nfloat v_lineWidth \x3d v_aux1.x;\nvec2  v_normal    \x3d v_aux1.yz;\nLineData inputs \x3d LineData(\nv_color,\nv_normal,\nv_lineWidth,\nv_opacity,\nv_id\n);\nreturn shadeLine(inputs);\n}\n#endif\nlowp vec4 drawFill() {\nlowp vec4 out_color \x3d vec4(0.);\n#ifdef HITTEST\nout_color \x3d v_color;\n#elif defined(PATTERN)\nmediump vec4 v_tlbr \x3d v_aux1;\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\n#ifdef VV_COLOR\nif (v_sampleAlphaOnly \x3e 0.5) {\ncolor.rgb \x3d vec3(color.a);\n}\n#endif\nout_color \x3d v_opacity * v_color * color;\n#elif SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY \x26\x26 !defined(HIGHLIGHT)\nvec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\nvec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\nvec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\nvec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\nvec4 isPositive0 \x3d step(0.0, difference0);\nvec4 isPositive1 \x3d step(0.0, difference1);\nfloat weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\nfloat lessThanEqZero \x3d step(weightSum, 0.0);\nfloat greaterThanZero \x3d 1.0 - lessThanEqZero ;\nfloat divisor \x3d (weightSum + lessThanEqZero);\nvec4 weights0 \x3d difference0 * isPositive0 / divisor;\nvec4 weights1 \x3d difference1 * isPositive1 / divisor;\nvec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\nvec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\nfloat diffMax \x3d max(max4(difference0), max4(difference1));\nfloat lessThanZero \x3d step(diffMax, 0.0);\nfloat greaterOrEqZero \x3d 1.0 - lessThanZero;\nvec4 isMax0 \x3d step(diffMax, difference0);\nvec4 isMax1 \x3d step(diffMax, difference1);\nvec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\nvec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\nout_color \x3d preEffectColor;\n#else\nout_color \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\nout_color.a \x3d 1.0;\n#endif\nreturn out_color;\n}\nvoid main() {\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nif (v_isOutline \x3e 0.5) {\ngl_FragColor \x3d drawLine();\n} else {\ngl_FragColor \x3d drawFill();\n}\n#else\ngl_FragColor \x3d drawFill();\n#endif\n}",
"fill.vert":"#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#define PACKED_LINE\nprecision highp float;\nattribute float a_bitset;\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_aux2;\nattribute vec4 a_aux3;\n#ifndef SYMBOLOGY_TYPE_IS_SIMPLE_LIKE\nattribute vec4 a_aux1;\nattribute vec2 a_zoomRange;\n#else\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#endif\n#endif\nuniform vec2 u_tileOffset;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#include \x3cmaterials/fill/hittest.glsl\x3e\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\nreturn featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.vert\x3e\nvoid drawLine(out lowp vec4 out_color, out highp vec3 out_pos) {\nLineData outputs \x3d buildLine(\nout_pos,\na_id,\na_pos,\na_color,\n(a_aux3.xy - 128.) / 16.,\n(a_aux3.zw - 128.) / 16.,\n0.,\na_aux2.z / 16.,\na_bitset,\nvec4(0.),\nvec2(0.),\na_aux2.w / 16.\n);\nv_id      \x3d outputs.id;\nv_opacity \x3d outputs.opacity;\nv_aux1    \x3d vec4(outputs.lineHalfWidth, outputs.normal, 0.);\nout_color \x3d outputs.color;\n}\n#endif\nvoid drawFill(out lowp vec4 out_color, out highp vec3 out_pos) {\nfloat a_bitSet \x3d a_bitset;\nout_color \x3d getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nmat3 tileToTileNormalized \x3d mat3(  2. / 512.,  0.,  0.,\n0., -2. / 512.,  0.,\n-1.,  1.,  1.  );\nout_pos   \x3d tileToTileNormalized * vec3((a_pos * FILL_POSITION_PRECISION), 1.);\n#else\nout_pos   \x3d u_dvsMat3 * vec3(a_pos * FILL_POSITION_PRECISION, 1.);\n#endif\n#ifdef PATTERN\nvec4  a_tlbr   \x3d a_aux1;\nfloat a_width  \x3d a_aux2.x;\nfloat a_height \x3d a_aux2.y;\nvec2  a_offset \x3d a_aux2.zw;\nvec2  a_scale  \x3d a_aux3.xy;\nfloat a_angle  \x3d a_aux3.z;\nvec2 scale \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_scale;\nfloat width \x3d u_zoomFactor * a_width * scale.x;\nfloat height \x3d u_zoomFactor * a_height * scale.y;\nfloat angle \x3d C_256_TO_RAD * a_angle;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nfloat dx \x3d 0.0;\nfloat dy \x3d 0.0;\nif (getBit(a_bitset, BITSET_FILL_RANDOM_PATTERN_OFFSET) \x3e 0.5) {\nfloat id \x3d rgba2float(vec4(a_id, 0.0));\ndx \x3d rand(vec2(id, 0.0));\ndy \x3d rand(vec2(0.0, id));\n}\nmat3 patternMatrix \x3d mat3(cosA / width, sinA / height, 0,\n-sinA / width, cosA / height, 0,\ndx,            dy,           1);\nvec2 tileOffset \x3d vec2(u_tileOffset.x * cosA - u_tileOffset.y * sinA, u_tileOffset.x * sinA + u_tileOffset.y * cosA);\ntileOffset \x3d mod(tileOffset, vec2(a_aux2.x, a_aux2.y));\nvec2 symbolOffset \x3d (a_offset - tileOffset) / vec2(width, height);\nv_tileTextureCoord \x3d (patternMatrix * vec3(a_pos * FILL_POSITION_PRECISION, 1.0)).xy - symbolOffset;\nv_aux1 \x3d a_tlbr / u_mosaicSize.xyxy;\nv_sampleAlphaOnly \x3d getBit(a_bitset, BITSET_GENERIC_CONSIDER_ALPHA_ONLY);\n#elif SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nvec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\nvec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\nfloat size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\nv_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\nv_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\nv_dotTextureCoords \x3d (a_pos * FILL_POSITION_PRECISION + 0.5) / size;\n#endif\n}\n#ifdef HITTEST\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nif (getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE) \x3e 0.5) {\nout_pos \x3d vec3(0., 0., 2.);\nreturn;\n}\n#endif\nhittestFill(out_color, out_pos);\ngl_PointSize \x3d 1.0;\n}\n#elif defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\nv_isOutline \x3d getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE);\nif (v_isOutline \x3e 0.5) {\ndrawLine(out_color, out_pos);\n} else {\ndrawFill(out_color, out_pos);\n}\n}\n#else\n#define draw drawFill\n#endif\nvoid main()\n{\nINIT;\nhighp vec3 pos  \x3d vec3(0.);\nhighp vec4 color  \x3d vec4(0.);\ndraw(color, pos);\nv_color \x3d color;\ngl_Position \x3d vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}",
"hittest.glsl":"#ifdef HITTEST\n#include \x3cmaterials/hittest/common.glsl\x3e\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nvoid hittestFill(\nout lowp vec4 out_color,\nout highp vec3 out_pos\n) {\nvec3 pos        \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos  * FILL_POSITION_PRECISION, 1.);\nvec3 pos1       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos1 * FILL_POSITION_PRECISION, 1.);\nvec3 pos2       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos2 * FILL_POSITION_PRECISION, 1.);\nfloat hittestDist \x3d u_hittestDist;\nfloat dist \x3d distPointTriangle(u_hittestPos, pos.xy, pos1.xy, pos2.xy);\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif (dist \x3c 0. || dist \x3e\x3d hittestDist) {\nout_pos.z +\x3d 2.0;\n}\nout_color \x3d vec4(1. / 255., 0, 0, dist \x3d\x3d 0. ? (1. / 255.) : 0.);\n}\n#endif"},
hittest:{"common.glsl":"#ifdef HITTEST\nuniform float u_hittestDist;\nuniform highp vec2 u_hittestPos;\nfloat projectScalar(vec2 a, vec2 b) {\nreturn dot(a, normalize(b));\n}\nfloat distPointSegment(vec2 p0, vec2 p1, vec2 p2) {\nvec2 L \x3d p2 - p1;\nvec2 A \x3d p0 - p1;\nfloat projAL \x3d projectScalar(A, L);\nfloat t \x3d clamp(projAL / length(L), 0., 1.);\nreturn distance(p0, p1 + t * (p2 - p1));\n}\nvoid hittestMarker(out lowp vec4 out_color, out highp vec3 out_pos, in highp vec3 pos, float size) {\nfloat dist \x3d distance(pos, vec3(u_hittestPos, 1.));\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif ((dist - size) \x3e u_hittestDist) {\nout_pos.z +\x3d 2.0;\n}\nout_color \x3d vec4(1. / 255., 0, 0, (dist - size) \x3c 0. ? (1. / 255.) : 0.);\n}\nfloat intersectPointTriangleBary(vec2 p, vec2 a, vec2 b, vec2 c) {\nreturn inTriangle(xyToBarycentric(p, a, b, c));\n}\nfloat distPointTriangle(vec2 p, vec2 a, vec2 b, vec2 c) {\nvec2 ba \x3d b - a;\nvec2 ca \x3d c - a;\nfloat crossProduct \x3d ba.x * ca.y - ca.x * ba.y;\nbool isParallel \x3d crossProduct \x3c EPSILON_HITTEST \x26\x26 crossProduct \x3e -EPSILON_HITTEST;\nif (isParallel) {\nreturn -1.;\n}\nif (intersectPointTriangleBary(p.xy, a, b, c) \x3d\x3d 1.) {\nreturn 0.;\n}\nfloat distAB \x3d distPointSegment(p, a, b);\nfloat distBC \x3d distPointSegment(p, b, c);\nfloat distCA \x3d distPointSegment(p, c, a);\nreturn min(min(distAB, distBC), distCA);\n}\n#endif"},
icon:{"common.glsl":"#include \x3cutil/encoding.glsl\x3e\nuniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif\n#ifdef SDF\nvec4 getColor(vec2 v_size, vec2 v_tex) {\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nfloat outlineWidth \x3d v_outlineWidth;\n#ifdef HIGHLIGHT\noutlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n#endif\nif (outlineWidth \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\nfloat clampedOutlineSize \x3d min(outlineWidth, size);\noutlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\nreturn v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n}\nreturn v_opacity * fillPixelColor;\n}\n#else\nvec4 getColor(vec2 _v_size, vec2 v_tex) {\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\nreturn v_opacity * texColor * v_color;\n}\n#endif",
heatmapAccumulate:{"common.glsl":"varying lowp vec4 v_hittestResult;\nvarying mediump vec2 v_offsetFromCenter;\nvarying highp float v_fieldValue;","heatmapAccumulate.frag":"precision mediump float;\n#include \x3cmaterials/icon/heatmapAccumulate/common.glsl\x3e\n#ifdef HEATMAP_PRECISION_HALF_FLOAT\n#define COMPRESSION_FACTOR 0.25\n#else\n#define COMPRESSION_FACTOR 1.0\n#endif\nuniform lowp sampler2D u_texture;\nvoid main() {\n#ifdef HITTEST\ngl_FragColor \x3d v_hittestResult;\n#else\nfloat radius \x3d length(v_offsetFromCenter);\nfloat shapeWeight \x3d step(radius, 1.0);\nfloat oneMinusRadiusSquared \x3d 1.0 - radius * radius;\nfloat kernelWeight \x3d oneMinusRadiusSquared * oneMinusRadiusSquared;\ngl_FragColor \x3d vec4(shapeWeight * kernelWeight * v_fieldValue * COMPRESSION_FACTOR);\n#endif\n}",
"heatmapAccumulate.vert":"precision highp float;\nattribute vec2 a_vertexOffset;\nvec4 a_color \x3d vec4(0.0);\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\nuniform float u_radius;\nuniform float u_isFieldActive;\nconst float TILE_TO_CLIP_SPACE \x3d 2.0 / 512.0;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/hittest/common.glsl\x3e\n#include \x3cmaterials/icon/heatmapAccumulate/common.glsl\x3e\nvoid main() {\nfloat filterFlags \x3d getFilterFlags();\n#ifdef HITTEST\nhighp vec4 out_hittestResult \x3d vec4(0.);\nhighp vec3 out_pos \x3d vec3(0.);\nvec3 pos \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos * POSITION_PRECISION, 1.0);\nhittestMarker(out_hittestResult, out_pos, pos, u_radius);\nv_hittestResult \x3d out_hittestResult;\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(a_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\nv_offsetFromCenter \x3d sign(a_vertexOffset);\nv_fieldValue \x3d getAttributeData2(a_id).x * u_isFieldActive + 1.0 - u_isFieldActive;\nvec3 centerPos \x3d vec3(a_pos * POSITION_PRECISION * TILE_TO_CLIP_SPACE - 1.0, 1.0);\nvec3 vertexPos \x3d centerPos + vec3(v_offsetFromCenter, 0.0) * u_radius * TILE_TO_CLIP_SPACE;\ngl_Position \x3d vec4(clip(a_color, vertexPos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},
"hittest.glsl":"#ifdef HITTEST\n#include \x3cmaterials/hittest/common.glsl\x3e\nattribute vec2 a_vertexOffset1;\nattribute vec2 a_vertexOffset2;\nattribute vec2 a_texCoords1;\nattribute vec2 a_texCoords2;\nvec2 getTextureCoords(in vec3 bary, in vec2 texCoords0, in vec2 texCoords1, in vec2 texCoords2) {\nreturn texCoords0 * bary.x + texCoords1 * bary.y + texCoords2 * bary.z;\n}\nvoid hittestIcon(\ninout lowp vec4 out_color,\nout highp vec3 out_pos,\nin vec3 pos,\nin vec3 offset,\nin vec2 size,\nin float scaleFactor,\nin float isMapAligned\n) {\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nvec3 posBase \x3d u_viewMat3 * u_tileMat3  * pos;\nvec3 offset1 \x3d scaleFactor * vec3(a_vertexOffset1 / 16.0, 0.);\nvec3 offset2 \x3d scaleFactor * vec3(a_vertexOffset2 / 16.0, 0.);\nvec2 pos0    \x3d (posBase + getMatrixNoDisplay(isMapAligned) * offset).xy;\nvec2 pos1    \x3d (posBase + getMatrixNoDisplay(isMapAligned) * offset1).xy;\nvec2 pos2    \x3d (posBase + getMatrixNoDisplay(isMapAligned) * offset2).xy;\nvec3 bary0 \x3d xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, -u_hittestDist), pos0, pos1, pos2);\nvec3 bary1 \x3d xyToBarycentric(u_hittestPos + vec2(0., -u_hittestDist), pos0, pos1, pos2);\nvec3 bary2 \x3d xyToBarycentric(u_hittestPos + vec2(u_hittestDist, -u_hittestDist), pos0, pos1, pos2);\nvec3 bary3 \x3d xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, 0.), pos0, pos1, pos2);\nvec3 bary4 \x3d xyToBarycentric(u_hittestPos, pos0, pos1, pos2);\nvec3 bary5 \x3d xyToBarycentric(u_hittestPos + vec2(u_hittestDist, 0.), pos0, pos1, pos2);\nvec3 bary6 \x3d xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, u_hittestDist), pos0, pos1, pos2);\nvec3 bary7 \x3d xyToBarycentric(u_hittestPos + vec2(0., u_hittestDist), pos0, pos1, pos2);\nvec3 bary8 \x3d xyToBarycentric(u_hittestPos + vec2(u_hittestDist, u_hittestDist), pos0, pos1, pos2);\nvec2 tex0 \x3d a_texCoords  / u_mosaicSize;\nvec2 tex1 \x3d a_texCoords1 / u_mosaicSize;\nvec2 tex2 \x3d a_texCoords2 / u_mosaicSize;\nfloat alphaSum \x3d 0.;\nalphaSum +\x3d inTriangle(bary0) * getColor(size, getTextureCoords(bary0, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary1) * getColor(size, getTextureCoords(bary1, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary2) * getColor(size, getTextureCoords(bary2, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary3) * getColor(size, getTextureCoords(bary3, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary4) * getColor(size, getTextureCoords(bary4, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary5) * getColor(size, getTextureCoords(bary5, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary6) * getColor(size, getTextureCoords(bary6, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary7) * getColor(size, getTextureCoords(bary7, tex0, tex1, tex2)).a;\nout_pos.z +\x3d step(alphaSum, .05) * 2.0;\nout_color \x3d vec4(1. / 255., 0., 0., alphaSum / 255.);\n}\n#endif",
"icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvoid main()\n{\n#ifdef HITTEST\nvec4 color \x3d v_color;\n#else\nvec4 color \x3d getColor(v_sizeTex.xy, v_sizeTex.zw);\n#endif\n#ifdef HIGHLIGHT\ncolor.a \x3d step(1.0 / 255.0, color.a);\n#endif\ngl_FragColor \x3d color;\n}","icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\n#include \x3cmaterials/icon/hittest.glsl\x3e\nfloat getMarkerScaleFactor(inout vec2 size, in float referenceSize) {\n#ifdef VV_SIZE\nfloat f \x3d getSize(size.y) / size.y;\nfloat sizeFactor \x3d size.y / referenceSize;\nreturn getSize(referenceSize) / referenceSize;\n#else\nreturn 1.;\n#endif\n}\nvoid main()\n{\nINIT;\nfloat a_bitSet \x3d a_bitSetAndDistRatio.x;\nvec3  pos           \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nvec2  size          \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec3  offset        \x3d vec3(a_vertexOffset / 16.0, 0.);\nfloat outlineSize   \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\nfloat isMapAligned  \x3d getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nfloat referenceSize \x3d a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0;\nfloat scaleSymbolProportionally \x3d getBit(a_bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\nfloat scaleFactor               \x3d getMarkerScaleFactor(size, referenceSize);\nsize.xy     *\x3d scaleFactor;\noffset.xy   *\x3d scaleFactor;\noutlineSize *\x3d scaleSymbolProportionally * (scaleFactor - 1.0) + 1.0;\nvec2 v_tex   \x3d a_texCoords / u_mosaicSize;\nfloat filterFlags \x3d getFilterFlags();\nv_color    \x3d getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity  \x3d getOpacity();\nv_id       \x3d norm(a_id);\nv_pos      \x3d u_dvsMat3 * pos + getMatrix(isMapAligned) * getRotation()  * offset;\nv_sizeTex  \x3d vec4(size.xy, v_tex.xy);\n#ifdef SDF\nv_isThin   \x3d getBit(a_bitSet, BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE);\n#ifdef VV_COLOR\nv_overridingOutlineColor \x3d v_isThin;\n#else\nv_overridingOutlineColor \x3d 0.0;\n#endif\nv_outlineWidth \x3d min(outlineSize, max(max(size.x, size.y) - 0.99, 0.0));\nv_outlineColor \x3d a_outlineColor;\nv_distRatio \x3d a_bitSetAndDistRatio.y / 126.0;\n#endif\n#ifdef HITTEST\nhighp vec4 out_color \x3d vec4(0.);\nhighp vec3 out_pos   \x3d vec3(0.);\nhittestIcon(out_color, out_pos, pos, offset, size, scaleFactor, isMapAligned);\nv_color \x3d out_color;\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\ngl_Position \x3d vec4(clip(v_color, v_pos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include \x3cmaterials/text/text.frag\x3e","label.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\nfloat glyphAngle \x3d angle * 360.0 / 254.0;\nfloat mapAngle \x3d u_mapRotation * 360.0 / 254.0;\nfloat diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\nfloat z \x3d 0.0;\nz +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_currentZoom)));\nz +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\nz +\x3d 2.0 * (1.0 - step(u_currentZoom, maxZoom));\nreturn z;\n}\nvoid main()\n{\nINIT;\nfloat groupMinZoom    \x3d getMinZoom();\nfloat glyphMinZoom    \x3d a_glyphData.x;\nfloat glyphMaxZoom    \x3d a_glyphData.y;\nfloat glyphAngle      \x3d a_glyphData.z;\nfloat a_minZoom          \x3d max(groupMinZoom, glyphMinZoom);\nfloat a_placementPadding \x3d a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\nvec2  a_placementDir     \x3d unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\nfloat a_refSymbolSize    \x3d a_refSymbolAndPlacementOffset.y;\nfloat fontSize           \x3d a_texAndSize.z;\nfloat haloSize           \x3d a_texAndSize.w * OUTLINE_SCALE;\nvec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  pos          \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat z            \x3d getZ(a_minZoom, glyphMaxZoom, glyphAngle);\nfloat fontScale    \x3d fontSize / SDF_FONT_SIZE;\nfloat halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\nfloat animation    \x3d pow(getAnimationState(), vec4(2.0)).r;\nv_color     \x3d animation * ((1.0 - u_isHalo) * a_color + (u_isHalo * a_haloColor));\nv_opacity   \x3d 1.0;\nv_tex       \x3d a_texCoords / u_mosaicSize;\nv_edgeDistanceOffset \x3d u_isHalo * haloSize / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\nvec2 placementOffset \x3d a_placementDir * (halfSize + a_placementPadding);\nvec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\nvec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\ngl_Position \x3d vec4(v_pos, 1.0);\n#ifdef DEBUG\nv_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif\n#ifdef SDF\nvarying mediump float v_lineWidthRatio;\n#endif","hittest.glsl":"#include \x3cmaterials/hittest/common.glsl\x3e\n#ifdef HITTEST\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nvoid hittestLine(out lowp vec4 out_color, out highp vec3 out_pos, float halfWidth) {\nvec3 pos        \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos  * POSITION_PRECISION, 1.);\nvec3 pos1       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos1 * POSITION_PRECISION, 1.);\nvec3 pos2       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos2 * POSITION_PRECISION, 1.);\nvec3 outTextureCoords \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nfloat dist \x3d min(distPointSegment(u_hittestPos, pos.xy, pos1.xy),\ndistPointSegment(u_hittestPos, pos.xy, pos2.xy)) - halfWidth;\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif (dist \x3e\x3d u_hittestDist) {\nout_pos.z +\x3d 2.0;\n}\nout_color \x3d vec4(1. / 255., 0, 0, dist \x3c\x3d 0. ? (1. / 255.) : 0.);\n}\n#endif",
"line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.frag\x3e\n#ifdef HITTEST\nvoid main() {\ngl_FragColor \x3d v_color;\n}\n#else\nvoid main() {\nLineData inputs \x3d LineData(\nv_color,\nv_normal,\nv_lineHalfWidth,\nv_opacity,\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nv_tlbr,\nv_patternSize,\n#endif\n#ifdef SDF\nv_lineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance,\n#endif\n#endif\nv_id\n);\ngl_FragColor \x3d shadeLine(inputs);\n}\n#endif",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\n#include \x3cmaterials/line/hittest.glsl\x3e\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.vert\x3e\n#ifdef HITTEST\nvoid draw() {\nfloat aa        \x3d 0.5 * u_antialiasing;\nfloat a_halfWidth \x3d a_accumulatedDistanceAndHalfWidth.y / 16.;\nfloat a_cimHalfWidth \x3d a_aux.x / 16. ;\nvec2  a_offset \x3d a_offsetAndNormal.xy / 16.;\nfloat baseWidth \x3d getBaseLineHalfWidth(a_halfWidth, a_cimHalfWidth);\nfloat halfWidth \x3d getLineHalfWidth(baseWidth, aa);\nhighp vec3 pos  \x3d vec3(0.);\nv_color \x3d vec4(0.);\nhittestLine(v_color, pos, halfWidth);\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#else\nvoid draw()\n{\nhighp vec3 pos \x3d vec3(0.);\nLineData outputs \x3d buildLine(\npos,\na_id,\na_pos,\na_color,\na_offsetAndNormal.xy / 16.,\na_offsetAndNormal.zw / 16.,\na_accumulatedDistanceAndHalfWidth.x,\na_accumulatedDistanceAndHalfWidth.y / 16.,\na_segmentDirection.w,\na_tlbr,\na_segmentDirection.xy / 16.,\na_aux.x / 16.\n);\nv_id              \x3d outputs.id;\nv_color           \x3d outputs.color;\nv_normal          \x3d outputs.normal;\nv_lineHalfWidth   \x3d outputs.lineHalfWidth;\nv_opacity         \x3d outputs.opacity;\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nv_tlbr          \x3d outputs.tlbr;\nv_patternSize   \x3d outputs.patternSize;\n#endif\n#ifdef SDF\nv_lineWidthRatio \x3d outputs.lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d outputs.accumulatedDistance;\n#endif\n#endif\ngl_Position \x3d vec4(clip(outputs.color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#endif\nvoid main() {\nINIT;\ndraw();\n}"},
pie:{"pie.frag":"precision mediump float;\n#include \x3cutil/atan2.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvarying float v_size;\nvarying vec2 v_offset;\nvarying vec2 v_filteredSectorToColorId[NUMBER_OF_FIELDS];\nvarying float v_numOfEntries;\nvarying float v_maxSectorAngle;\nuniform lowp vec4 u_colors[NUMBER_OF_FIELDS];\nuniform lowp vec4 u_defaultColor;\nuniform lowp vec4 u_othersColor;\nuniform lowp vec4 u_outlineColor;\nuniform float u_donutRatio;\nuniform float u_sectorThreshold;\nstruct FilteredChartInfo {\nfloat endSectorAngle;\nint colorId;\n};\nlowp vec4 getSectorColor(in int index, in vec2 filteredSectorToColorId[NUMBER_OF_FIELDS]) {\n#if __VERSION__ \x3d\x3d 300\nmediump int colorIndex \x3d int(filteredSectorToColorId[index].y);\nreturn u_colors[colorIndex];\n#else\nmediump int colorIndex;\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nif (i \x3d\x3d index) {\ncolorIndex \x3d int(filteredSectorToColorId[i].y);\n}\n}\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nif (i \x3d\x3d colorIndex) {\nreturn u_colors[i];\n}\n}\nreturn u_colors[NUMBER_OF_FIELDS - 1];\n#endif\n}\nconst int OTHER_SECTOR_ID \x3d 255;\n#ifdef HITTEST\nvec4 getColor() {\nreturn v_color;\n}\n#else\nvec4 getColor() {\nfloat angle \x3d 90.0 - C_RAD_TO_DEG * atan2(v_offset.y, v_offset.x);\nif (angle \x3c 0.0) {\nangle +\x3d 360.0;\n} else if (angle \x3e 360.0) {\nangle \x3d mod(angle, 360.0);\n}\nint numOfEntries \x3d int(v_numOfEntries);\nfloat maxSectorAngle \x3d v_maxSectorAngle;\nlowp vec4 fillColor \x3d (maxSectorAngle \x3e 0.0 || u_sectorThreshold \x3e 0.0) ? u_othersColor : u_defaultColor;\nlowp vec4 prevColor \x3d vec4(0.0);\nlowp vec4 nextColor \x3d vec4(0.0);\nfloat startSectorAngle \x3d 0.0;\nfloat endSectorAngle \x3d 0.0;\nif (angle \x3c maxSectorAngle) {\nfor (int index \x3d 0; index \x3c NUMBER_OF_FIELDS; ++index) {\nstartSectorAngle \x3d endSectorAngle;\nendSectorAngle \x3d v_filteredSectorToColorId[index].x;\nif (endSectorAngle \x3e angle) {\nfillColor \x3d getSectorColor(index, v_filteredSectorToColorId);\nprevColor \x3d u_sectorThreshold !\x3d 0.0 \x26\x26 index \x3d\x3d 0 \x26\x26 abs(360.0 - maxSectorAngle) \x3c EPSILON ? u_othersColor :\ngetSectorColor(index \x3e 0 ? index - 1 : numOfEntries - 1, v_filteredSectorToColorId);\nnextColor \x3d u_sectorThreshold !\x3d 0.0 \x26\x26 abs(endSectorAngle - maxSectorAngle) \x3c EPSILON ? u_othersColor :\ngetSectorColor(index \x3c numOfEntries - 1 ? index + 1 : 0, v_filteredSectorToColorId);\nbreak;\n}\nif (index \x3d\x3d numOfEntries - 1) {\nbreak;\n}\n}\n} else {\nprevColor \x3d getSectorColor(numOfEntries - 1, v_filteredSectorToColorId);\nnextColor \x3d getSectorColor(0, v_filteredSectorToColorId);\nstartSectorAngle \x3d maxSectorAngle;\nendSectorAngle \x3d 360.0;\n}\nlowp vec4 outlineColor \x3d u_outlineColor;\nfloat offset \x3d length(v_offset);\nfloat distanceSize \x3d offset * v_size;\nif (startSectorAngle !\x3d 0.0 || endSectorAngle !\x3d 360.0) {\nfloat distanceToStartSector \x3d (angle - startSectorAngle);\nfloat distanceToEndSector \x3d (endSectorAngle - angle);\nfloat sectorThreshold \x3d 0.6;\nfloat beginSectorAlpha \x3d smoothstep(0.0, sectorThreshold, distanceToStartSector * offset);\nfloat endSectorAlpha \x3d smoothstep(0.0, sectorThreshold, distanceToEndSector * offset);\nif (endSectorAlpha \x3e 0.0) {\nfillColor \x3d mix(nextColor, fillColor, endSectorAlpha);\n} else if (beginSectorAlpha \x3e 0.0) {\nfillColor \x3d mix(prevColor, fillColor, beginSectorAlpha);\n}\n}\nfloat donutSize \x3d u_donutRatio * (v_size - v_outlineWidth);\nfloat endOfDonut \x3d donutSize - v_outlineWidth;\nfloat aaThreshold \x3d 0.75;\nfloat innerCircleAlpha \x3d endOfDonut - aaThreshold \x3e 0.0 ? smoothstep(endOfDonut - aaThreshold, endOfDonut + aaThreshold, distanceSize) : 1.0;\nfloat outerCircleAlpha \x3d 1.0 - smoothstep(v_size - aaThreshold, v_size + aaThreshold , distanceSize);\nfloat circleAlpha \x3d innerCircleAlpha * outerCircleAlpha;\nfloat startOfOutline \x3d v_size - v_outlineWidth;\nif (startOfOutline \x3e 0.0 \x26\x26 v_outlineWidth \x3e 0.25) {\nfloat outlineFactor \x3d smoothstep(startOfOutline - aaThreshold, startOfOutline + aaThreshold, distanceSize);\nfloat innerLineFactor \x3d donutSize - aaThreshold \x3e 0.0 ? 1.0 - smoothstep(donutSize - aaThreshold, donutSize + aaThreshold , distanceSize) : 0.0;\nfillColor \x3d mix(fillColor, outlineColor, innerLineFactor + outlineFactor);\n}\nreturn v_opacity * circleAlpha * fillColor;\n}\n#endif\nvoid main()\n{\nvec4 color \x3d getColor();\n#ifdef HIGHLIGHT\ncolor.a \x3d step(1.0 / 255.0, color.a);\n#endif\ngl_FragColor \x3d color;\n}",
"pie.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\nuniform float u_outlineWidth;\nuniform mediump float u_sectorThreshold;\nvarying float v_size;\nvarying vec2 v_offset;\nvarying vec2 v_filteredSectorToColorId[NUMBER_OF_FIELDS];\nvarying float v_numOfEntries;\nvarying float v_maxSectorAngle;\nstruct FilteredChartInfo {\nfloat endSectorAngle;\nint colorId;\n};\nint filter(in float sectorAngle,\nin int currentIndex,\ninout FilteredChartInfo filteredInfo,\ninout vec2 filteredSectorToColorId[NUMBER_OF_FIELDS]) {\nif (sectorAngle \x3e u_sectorThreshold * 360.0) {\nfilteredInfo.endSectorAngle +\x3d sectorAngle;\n#if __VERSION__ \x3d\x3d 300\nfilteredSectorToColorId[filteredInfo.colorId] \x3d vec2(filteredInfo.endSectorAngle, currentIndex);\n#else\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; i++) {\nif (i \x3d\x3d filteredInfo.colorId) {\nfilteredSectorToColorId[i] \x3d vec2(filteredInfo.endSectorAngle, currentIndex);\n}\n}\n#endif\n++filteredInfo.colorId;\n}\nreturn 0;\n}\nint filterValues(inout vec2 filteredSectorToColorId[NUMBER_OF_FIELDS],\ninout FilteredChartInfo filteredInfo,\nin float sectorAngles[NUMBER_OF_FIELDS]) {\nfor (int index \x3d 0; index \x3c NUMBER_OF_FIELDS; ++index) {\nfloat sectorValue \x3d sectorAngles[index];\nfilter(sectorValue, index, filteredInfo, filteredSectorToColorId);\n}\nreturn filteredInfo.colorId;\n}\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\n#include \x3cmaterials/hittest/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\nvec2 outSize \x3d baseSize;\n#ifdef VV_SIZE\nfloat r \x3d 0.5 * getSize(referenceSize) / referenceSize;\noutSize.xy *\x3d r;\noffset.xy *\x3d r;\nfloat scaleSymbolProportionally \x3d getBit(bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\noutlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\nreturn outSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\nfloat isMapAligned \x3d getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nvec3  offset       \x3d vec3(in_offset, 0.0);\nreturn getMatrix(isMapAligned) * offset;\n}\nfloat filterNaNValues(in float value) {\nreturn value !\x3d NAN_MAGIC_NUMBER ? value : 0.0;\n}\nvoid main()\n{\nINIT;\nvec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec2  a_offset \x3d a_vertexOffset / 16.0;\nfloat outlineSize \x3d u_outlineWidth;\nfloat a_bitSet \x3d a_bitSetAndDistRatio.x;\nvec2 size \x3d getMarkerSize(a_offset, a_size, outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\nfloat filterFlags \x3d getFilterFlags();\nvec3  pos         \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nv_opacity      \x3d getOpacity();\nv_id           \x3d norm(a_id);\nv_pos          \x3d u_dvsMat3 * pos + getOffset(a_offset, a_bitSet);\nv_offset       \x3d sign(a_texCoords - 0.5);\nv_size         \x3d max(size.x, size.y);\nv_outlineWidth \x3d outlineSize;\nfloat attributeData[10];\nvec4 attributeData0 \x3d getAttributeData3(a_id);\nattributeData[0] \x3d filterNaNValues(attributeData0.x);\nattributeData[1] \x3d filterNaNValues(attributeData0.y);\nattributeData[2] \x3d filterNaNValues(attributeData0.z);\nattributeData[3] \x3d filterNaNValues(attributeData0.w);\n#if (NUMBER_OF_FIELDS \x3e 4)\nvec4 attributeData1 \x3d getAttributeData4(a_id);\nattributeData[4] \x3d filterNaNValues(attributeData1.x);\nattributeData[5] \x3d filterNaNValues(attributeData1.y);\nattributeData[6] \x3d filterNaNValues(attributeData1.z);\nattributeData[7] \x3d filterNaNValues(attributeData1.w);\n#endif\n#if (NUMBER_OF_FIELDS \x3e 8)\nvec4 attributeData2 \x3d getAttributeData5(a_id);\nattributeData[8] \x3d filterNaNValues(attributeData2.x);\nattributeData[9] \x3d filterNaNValues(attributeData2.y);\n#endif\nfloat sum \x3d 0.0;\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nsum +\x3d attributeData[i];\n}\nfloat sectorAngles[NUMBER_OF_FIELDS];\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nsectorAngles[i] \x3d 360.0 * attributeData[i] / sum;\n}\nvec2 filteredSectorToColorId[NUMBER_OF_FIELDS];\nFilteredChartInfo filteredInfo \x3d FilteredChartInfo(0.0, 0);\nint numOfEntries \x3d filterValues(filteredSectorToColorId, filteredInfo, sectorAngles);\nv_numOfEntries \x3d float(numOfEntries);\nv_maxSectorAngle \x3d filteredInfo.endSectorAngle;\n#if __VERSION__ \x3d\x3d 300\nv_filteredSectorToColorId \x3d filteredSectorToColorId;\n#else\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nif (i \x3d\x3d numOfEntries) {\nbreak;\n}\nv_filteredSectorToColorId[i] \x3d filteredSectorToColorId[i];\n}\n#endif\n#ifdef HITTEST\nhighp vec3 out_pos \x3d vec3(0.0);\nv_color            \x3d vec4(0.0);\nhittestMarker(v_color, out_pos, u_viewMat3 * u_tileMat3 *  pos, v_size);\ngl_PointSize \x3d 1.0;\ngl_Position \x3d vec4(clip(v_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\ngl_Position \x3d vec4(clip(v_color, v_pos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},
shared:{line:{"common.glsl":"#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) \x26\x26 defined(PATTERN)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_sampleAlphaOnly;\n#endif\nstruct LineData {\nlowp vec4 color;\nmediump vec2 normal;\nmediump float lineHalfWidth;\nlowp float opacity;\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nmediump vec4 tlbr;\nmediump vec2 patternSize;\n#endif\n#ifdef SDF\nmediump float lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nhighp float accumulatedDistance;\n#endif\n#endif\nhighp vec3 id;\n};",
"line.frag":"uniform lowp float u_blur;\n#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) \x26\x26 !defined(HIGHLIGHT)\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\nuniform highp float u_pixelRatio;\n#endif\n#endif\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT) \x26\x26 !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nlowp vec4 getLineColor(LineData line) {\nmediump float adjustedPatternWidth \x3d line.patternSize.x * 2.0 * line.lineWidthRatio;\nmediump float relativeTexX \x3d fract(line.accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY \x3d 0.5 + 0.25 * line.normal.y;\nmediump vec2 texCoord \x3d mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * line.lineHalfWidth;\nreturn line.opacity * clamp(0.5 - dist, 0.0, 1.0) * line.color;\n}\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT) \x26\x26 !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nlowp vec4 getLineColor(LineData line) {\nmediump float lineHalfWidth \x3d line.lineHalfWidth;\nmediump float adjustedPatternWidth \x3d line.patternSize.x * 2.0 * lineHalfWidth / line.patternSize.y;\nmediump float relativeTexX \x3d fract(line.accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY \x3d 0.5 + 0.5 * line.normal.y;\nmediump vec2 texCoord \x3d mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexY, relativeTexX));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\n#ifdef VV_COLOR\nif (v_sampleAlphaOnly \x3e 0.5) {\ncolor.rgb \x3d vec3(color.a);\n}\n#endif\nreturn line.opacity * line.color * color;\n}\n#else\nlowp vec4 getLineColor(LineData line) {\nreturn line.opacity * line.color;\n}\n#endif\nvec4 shadeLine(LineData line)\n{\nmediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(line.lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nmediump float fragDist \x3d length(line.normal) * line.lineHalfWidth;\nlowp float alpha \x3d clamp(thinLineFactor * (line.lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\nlowp vec4 out_color \x3d getLineColor(line) * alpha;\n#ifdef HIGHLIGHT\nout_color.a \x3d step(1.0 / 255.0, out_color.a);\n#endif\n#ifdef ID\nif (out_color.a \x3c 1.0 / 255.0) {\ndiscard;\n}\nout_color \x3d vec4(line.id, 0.0);\n#endif\nreturn out_color;\n}",
"line.vert":"float getBaseLineHalfWidth(in float lineHalfWidth, in float referenceHalfWidth) {\n#ifdef VV_SIZE\nfloat refLineWidth \x3d 2.0 * referenceHalfWidth;\nreturn 0.5 * (lineHalfWidth / max(referenceHalfWidth, EPSILON)) * getSize(refLineWidth);\n#else\nreturn lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\nfloat halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\nhalfWidth \x3d max(halfWidth, 2.0);\n#endif\nreturn halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\nfloat thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nreturn thinLineFactor * halfWidth * offset;\n}\nLineData buildLine(\nout vec3 out_pos,\nin vec3 in_id,\nin vec2 in_pos,\nin vec4 in_color,\nin vec2 in_offset,\nin vec2 in_normal,\nin float in_accumulatedDist,\nin float in_lineHalfWidth,\nin float in_bitSet,\nin vec4 in_tlbr,\nin vec2 in_segmentDirection,\nin float in_referenceHalfWidth\n)\n{\nfloat aa        \x3d 0.5 * u_antialiasing;\nfloat baseWidth \x3d getBaseLineHalfWidth(in_lineHalfWidth, in_referenceHalfWidth);\nfloat halfWidth \x3d getLineHalfWidth(baseWidth, aa);\nfloat z         \x3d 2.0 * step(baseWidth, 0.0);\nvec2  dist      \x3d getDist(in_offset, halfWidth);\nvec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\nvec3  pos       \x3d u_dvsMat3 * vec3(in_pos * POSITION_PRECISION, 1.0) + offset;\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nvec4  color     \x3d in_color;\nfloat opacity   \x3d 1.0;\n#else\nvec4  color     \x3d getColor(in_color, in_bitSet, BITSET_GENERIC_LOCK_COLOR);\nfloat opacity   \x3d getOpacity();\n#ifdef SDF\nconst float SDF_PATTERN_HALF_WIDTH \x3d 15.5;\nfloat scaleDash \x3d getBit(in_bitSet, BITSET_LINE_SCALE_DASH);\nfloat lineWidthRatio \x3d (scaleDash * max(halfWidth - 0.55 * u_antialiasing, 0.25) + (1.0 - scaleDash)) / SDF_PATTERN_HALF_WIDTH;\n#endif\n#endif\n#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) \x26\x26 defined(PATTERN)\nv_sampleAlphaOnly \x3d getBit(in_bitSet, BITSET_GENERIC_CONSIDER_ALPHA_ONLY);\n#endif\nout_pos \x3d vec3(pos.xy, z);\nreturn LineData(\ncolor,\nin_normal,\nhalfWidth,\nopacity,\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nin_tlbr / u_mosaicSize.xyxy,\nvec2(in_tlbr.z - in_tlbr.x, in_tlbr.w - in_tlbr.y),\n#endif\n#ifdef SDF\nlineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nin_accumulatedDist * u_zoomFactor + dot(in_segmentDirection, dist),\n#endif\n#endif\nnorm(in_id)\n);\n}"}},
"symbologyTypeUtils.glsl":"#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_OUTLINE_FILL || SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_OUTLINE_FILL_SIMPLE\n#define SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_SIMPLE || SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_OUTLINE_FILL_SIMPLE\n#define SYMBOLOGY_TYPE_IS_SIMPLE_LIKE\n#endif",text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec3 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;",
"hittest.glsl":"#include \x3cmaterials/hittest/common.glsl\x3e","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\n#ifdef HITTEST\nvec4 getColor() {\nreturn v_color;\n}\n#else\nvec4 getColor()\n{\nfloat SDF_CUTOFF \x3d (2.0 / 8.0);\nfloat SDF_BASE_EDGE_DIST \x3d 1.0 - SDF_CUTOFF;\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float edge \x3d SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\nedge /\x3d 2.0;\n#endif\nlowp float aa \x3d v_antialiasingWidth;\nlowp float alpha \x3d smoothstep(edge - aa, edge + aa, dist);\nreturn alpha * v_color * v_opacity;\n}\n#endif\nvoid main()\n{\ngl_FragColor \x3d getColor();\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\n#include \x3cmaterials/text/hittest.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_zoomRange;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nfloat getTextSize(inout vec2 offset, inout float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\nfloat r \x3d getSize(referenceSize) / referenceSize;\nbaseSize *\x3d r;\noffset.xy *\x3d r;\nreturn baseSize;\n#endif\nreturn baseSize;\n}\nvoid main()\n{\nINIT;\nfloat a_referenceSize \x3d a_aux.z * a_aux.z / 256.0;\nfloat a_bitSet        \x3d a_aux.w;\nfloat a_fontSize      \x3d a_texFontSize.z;\nvec2  a_offset        \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  in_pos        \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat fontSize      \x3d getTextSize(a_offset, a_fontSize, a_referenceSize);\nfloat fontScale     \x3d fontSize / SDF_FONT_SIZE;\nvec3  offset        \x3d getRotation() * vec3(a_offset, 0.0);\nmat3  extrudeMatrix \x3d getBit(a_bitSet, 0) \x3d\x3d 1.0 ? u_displayViewMat3 : u_displayMat3;\nv_color   \x3d u_isHalo * a_haloColor + (1.0 - u_isHalo) * getColor(a_color, a_bitSet, 1);\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\nv_tex     \x3d a_texCoords / u_mosaicSize;\nv_pos     \x3d u_dvsMat3 * in_pos + extrudeMatrix * offset;\nv_edgeDistanceOffset \x3d u_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n#ifdef HITTEST\nhighp vec3 out_pos  \x3d vec3(0.);\nv_color \x3d vec4(0.);\nhittestMarker(v_color, out_pos, u_viewMat3 * u_tileMat3 *  vec3(a_pos * POSITION_PRECISION, 1.0)\n+ u_tileMat3 * offset, fontSize / 2.);\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, out_pos, getFilterFlags(), a_zoomRange), 1.0);\n#else\ngl_Position \x3d  vec4(clip(v_color, v_pos, getFilterFlags(), a_zoomRange), 1.0);\n#endif\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\nreturn floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\nfloat offset \x3d pow(2.0, float(bitIndex));\nreturn mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\nreturn getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\nreturn getBit(bitset, 0);\n}\nhighp vec3 unpackDisplayIdTexel(in highp vec3 bitset) {\nfloat isAggregate \x3d getBit(bitset.b, 7);\nreturn (1.0 - isAggregate) * bitset + isAggregate * (vec3(bitset.rgb) - vec3(0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\nfloat r \x3d mod(rshift(u32, 0), 255.0);\nfloat g \x3d mod(rshift(u32, 8), 255.0);\nfloat b \x3d mod(rshift(u32, 16), 255.0);\nfloat a \x3d mod(rshift(u32, 24), 255.0);\nreturn vec4(r, g, b, a);\n}\nvec3 norm(in vec3 v) {\nreturn v /\x3d 255.0;\n}\nvec4 norm(in vec4 v) {\nreturn v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\nreturn max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\nreturn (bytes - 127.0) / 127.0;\n}\nhighp float rand(in vec2 co) {\nhighp float a \x3d 12.9898;\nhighp float b \x3d 78.233;\nhighp float c \x3d 43758.5453;\nhighp float dt \x3d dot(co, vec2(a,b));\nhighp float sn \x3d mod(dt, 3.14);\nreturn fract(sin(sn) * c);\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\n#include \x3cmaterials/barycentric.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec3 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp mat3 u_tileMat3;\nuniform highp mat3 u_viewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nuniform mediump float u_currentZoom;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef SUPPORTS_TEXTURE_FLOAT\ntarget.rgba \x3d getAttributeData2(a_id);\n#else\nvec4 data0 \x3d getAttributeData2(a_id);\nvec4 data1 \x3d getAttributeData3(a_id);\ntarget.r \x3d u88VVToFloat(data0.rg * 255.0);\ntarget.g \x3d u88VVToFloat(data0.ba * 255.0);\ntarget.b \x3d u88VVToFloat(data1.rg * 255.0);\ntarget.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n#define INIT loadVisualVariableData(VV_ADATA)\n#else\n#define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\nfloat isColorLocked   \x3d getBit(a_bitSet, index);\nreturn getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\nreturn a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\nreturn getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\nreturn 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\nreturn getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\nreturn in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\nreturn getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\nreturn mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\nreturn ceil(getAttributeData0(a_id).x * 255.0);\n#else\nreturn getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\nreturn getAttributeData1(a_id);\n}\nfloat getMinZoom() {\nvec4 data0 \x3d getAttributeData0(a_id) * 255.0;\nreturn data0.g;\n}\nmat3 getMatrixNoDisplay(float isMapAligned) {\nreturn isMapAligned * u_viewMat3 * u_tileMat3 + (1.0 - isMapAligned) * u_tileMat3;\n}\nmat3 getMatrix(float isMapAligned) {\nreturn isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}\nvec3 clip(inout vec4 color, inout vec3 pos, in float filterFlags, in vec2 minMaxZoom) {\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef INSIDE\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#elif defined(OUTSIDE)\npos.z +\x3d 2.0 * getFilterBit(filterFlags, 1);\n#elif defined(HIGHLIGHT)\n#if !defined(HIGHLIGHT_ALL)\npos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n#endif\npos.z +\x3d 2.0 * (step(minMaxZoom.y, u_currentZoom) + (1.0 - step(minMaxZoom.x, u_currentZoom)));\nreturn pos;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n#define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n#define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\nreturn (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nfloat interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\ninterpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\nreturn u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nif (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\nreturn u_vvSizeFieldStopsSizes[0];\n}\nfor (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\nif (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\nfloat f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\nreturn mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n}\n}\nreturn u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nreturn u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue) {\nif (isNan(opacityValue)) {\nreturn 1.0;\n}\nif (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\nreturn u_vvOpacities[0];\n}\nfor (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\nif (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\nfloat f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\nreturn mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n}\n}\nreturn u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat4(1, 0, 0, 0,\n0, 1, 0, 0,\n0, 0, 1, 0,\n0, 0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat4(cosA, sinA, 0, 0,\n-sinA,  cosA, 0, 0,\n0,     0, 1, 0,\n0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat3(1, 0, 0,\n0, 1, 0,\n0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * -rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat3(cosA, -sinA, 0,\nsinA, cosA, 0,\n0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\nif (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\nreturn fallback;\n}\nif (colorValue \x3c\x3d u_vvColorValues[0]) {\nreturn u_vvColors[0];\n}\nfor (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\nif (u_vvColorValues[i] \x3e\x3d colorValue) {\nfloat f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\nreturn mix(u_vvColors[i-1], u_vvColors[i], f);\n}\n}\nreturn u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\nreturn getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\nreturn u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\nfloat outSize \x3d getVVStopsSize(vvSize, size);\nreturn isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\nreturn getVVUnitValue(vvSize, size);\n#else\nreturn size;\n#endif\n}"},
overlay:{overlay:{"overlay.frag":"precision lowp float;\nuniform lowp sampler2D u_texture;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nvec4 color \x3d texture2D(u_texture, v_uv);\ngl_FragColor \x3d color *  u_opacity;\n}","overlay.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_uv;\nuniform highp mat3 u_dvsMat3;\nvarying mediump vec2 v_uv;\nvoid main(void) {\nv_uv \x3d a_uv;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0);\ngl_Position \x3d vec4(pos.xy, 0.0, 1.0);\n}"}},
"post-processing":{blit:{"blit.frag":"precision mediump float;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\ngl_FragColor \x3d texture2D(u_texture, v_uv);\n}"},bloom:{composite:{"composite.frag":"precision mediump float;\nvarying vec2 v_uv;\nuniform sampler2D u_blurTexture1;\nuniform sampler2D u_blurTexture2;\nuniform sampler2D u_blurTexture3;\nuniform sampler2D u_blurTexture4;\nuniform sampler2D u_blurTexture5;\nuniform float u_bloomStrength;\nuniform float u_bloomRadius;\nuniform float u_bloomFactors[NUMMIPS];\nuniform vec3 u_bloomTintColors[NUMMIPS];\nfloat lerpBloomFactor(const in float factor) {\nfloat mirrorFactor \x3d 1.2 - factor;\nreturn mix(factor, mirrorFactor, u_bloomRadius);\n}\nvoid main() {\ngl_FragColor \x3d u_bloomStrength * (\nlerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\nlerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\nlerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\nlerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\nlerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n);\n}"},
gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\n#define SIGMA RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d float(SIGMA);\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
luminosityHighPass:{"luminosityHighPass.frag":"precision mediump float;\nuniform sampler2D u_texture;\nuniform vec3 u_defaultColor;\nuniform float u_defaultOpacity;\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\nvarying vec2 v_uv;\nvoid main() {\nvec4 texel \x3d texture2D(u_texture, v_uv);\nvec3 luma \x3d vec3(0.299, 0.587, 0.114);\nfloat v \x3d dot(texel.xyz, luma);\nvec4 outputColor \x3d vec4(u_defaultColor.rgb, u_defaultOpacity);\nfloat alpha \x3d smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\ngl_FragColor \x3d mix(outputColor, texel, alpha);\n}"}},
blur:{gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nuniform float u_sigma;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d u_sigma;\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
"radial-blur":{"radial-blur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nconst float sampleDist \x3d 1.0;\nconst float sampleStrength \x3d 2.2;\nvoid main(void) {\nfloat samples[10];\nsamples[0] \x3d -0.08;\nsamples[1] \x3d -0.05;\nsamples[2] \x3d -0.03;\nsamples[3] \x3d -0.02;\nsamples[4] \x3d -0.01;\nsamples[5] \x3d  0.01;\nsamples[6] \x3d  0.02;\nsamples[7] \x3d  0.03;\nsamples[8] \x3d  0.05;\nsamples[9] \x3d  0.08;\nvec2 dir \x3d 0.5 - v_uv;\nfloat dist \x3d sqrt(dir.x * dir.x + dir.y * dir.y);\ndir \x3d dir / dist;\nvec4 color \x3d texture2D(u_colorTexture,v_uv);\nvec4 sum \x3d color;\nfor (int i \x3d 0; i \x3c 10; i++) {\nsum +\x3d texture2D(u_colorTexture, v_uv + dir * samples[i] * sampleDist);\n}\nsum *\x3d 1.0 / 11.0;\nfloat t \x3d dist * sampleStrength;\nt \x3d clamp(t, 0.0, 1.0);\ngl_FragColor \x3d mix(color, sum, t);\n}"}},
dra:{"dra.frag":"precision mediump float;\nuniform sampler2D u_minColor;\nuniform sampler2D u_maxColor;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\nvec4 minColor \x3d texture2D(u_minColor, vec2(0.5));\nvec4 maxColor \x3d texture2D(u_maxColor, vec2(0.5));\nvec4 color \x3d texture2D(u_texture, v_uv);\nvec3 minColorUnpremultiply \x3d minColor.rgb / minColor.a;\nvec3 maxColorUnpremultiply \x3d maxColor.rgb / maxColor.a;\nvec3 colorUnpremultiply \x3d color.rgb / color.a;\nvec3 range \x3d maxColorUnpremultiply - minColorUnpremultiply;\ngl_FragColor \x3d vec4(color.a * (colorUnpremultiply - minColorUnpremultiply) / range, color.a);\n}",
"min-max":{"min-max.frag":"#extension GL_EXT_draw_buffers : require\nprecision mediump float;\n#define CELL_SIZE 2\nuniform sampler2D u_minTexture;\nuniform sampler2D u_maxTexture;\nuniform vec2 u_srcResolution;\nuniform vec2 u_dstResolution;\nvarying vec2 v_uv;\nvoid main() {\nvec2 srcPixel \x3d floor(gl_FragCoord.xy) * float(CELL_SIZE);\nvec2 onePixel \x3d vec2(1.0) / u_srcResolution;\nvec2 uv \x3d (srcPixel + 0.5) / u_srcResolution;\nvec4 minColor \x3d vec4(1.0);\nvec4 maxColor \x3d vec4(0.0);\nfor (int y \x3d 0; y \x3c CELL_SIZE; ++y) {\nfor (int x \x3d 0; x \x3c CELL_SIZE; ++x) {\nvec2 offset \x3d uv + vec2(x, y) * onePixel;\nminColor \x3d min(minColor, texture2D(u_minTexture, offset));\nmaxColor \x3d max(maxColor, texture2D(u_maxTexture, offset));\n}\n}\ngl_FragData[0] \x3d minColor;\ngl_FragData[1] \x3d maxColor;\n}"}},
"drop-shadow":{composite:{"composite.frag":"precision mediump float;\nuniform sampler2D u_layerFBOTexture;\nuniform sampler2D u_blurTexture;\nuniform vec4 u_shadowColor;\nuniform vec2 u_shadowOffset;\nuniform highp mat3 u_displayViewMat3;\nvarying vec2 v_uv;\nvoid main() {\nvec3 offset \x3d u_displayViewMat3 * vec3(u_shadowOffset, 0.0);\nvec4 layerColor \x3d texture2D(u_layerFBOTexture, v_uv);\nvec4 blurColor \x3d texture2D(u_blurTexture, v_uv - offset.xy / 2.0);\ngl_FragColor \x3d ((1.0 - layerColor.a) * blurColor.a * u_shadowColor + layerColor);\n}"}},
"edge-detect":{"frei-chen":{"frei-chen.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nvarying vec2 v_uv;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[9];\nconst mat3 g0 \x3d mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 \x3d mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 \x3d mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 \x3d mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 \x3d mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 \x3d mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 \x3d mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 \x3d mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 \x3d mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\nvoid main() {\nG[0] \x3d g0,\nG[1] \x3d g1,\nG[2] \x3d g2,\nG[3] \x3d g3,\nG[4] \x3d g4,\nG[5] \x3d g5,\nG[6] \x3d g6,\nG[7] \x3d g7,\nG[8] \x3d g8;\nmat3 I;\nfloat cnv[9];\nvec3 sample;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D(u_colorTexture, v_uv + texel * vec2(i - 1.0,j - 1.0)).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 9; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nfloat M \x3d (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\nfloat S \x3d (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\ngl_FragColor \x3d vec4(vec3(sqrt(M / S)), texture2D(u_colorTexture, v_uv).a);\n}"},
sobel:{"sobel.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\ngl_FragColor \x3d vec4(vec3(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1])), texture2D(u_colorTexture, v_uv).a);\n}"}},
"edge-enhance":{"edge-enhance.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 0.0, -1.0, 1.0, 0.0, -1.0, 1.0, 0.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\ngl_FragColor \x3d vec4(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1]) * color);\n}"},
filterEffect:{"filterEffect.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform mat4 u_coefficients;\nvarying vec2 v_uv;\nvoid main() {\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\nvec4 rgbw \x3d u_coefficients * vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\nfloat a \x3d color.a;\ngl_FragColor \x3d vec4(a * rgbw.rgb, a);\n}"},pp:{"pp.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying vec2 v_uv;\nvoid main() {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"}},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\nuniform lowp float u_opacity;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\nvec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\nfloat alpha \x3d u_opacity * color.a;\ngl_FragColor \x3d vec4(alpha * color.rgb, alpha);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include \x3craster/common/projection.glsl\x3e\n#endif\n#ifdef BICUBIC\n#include \x3cfiltering/bicubic.glsl\x3e\n#endif\n#ifdef BILINEAR\n#include \x3cfiltering/bilinear.glsl\x3e\n#endif\nvec2 getPixelLocation(vec2 coords) {\nvec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\ntargetLocation \x3d projectPixelLocation(targetLocation);\n#endif\nreturn targetLocation;\n}\nbool isOutside(vec2 coords){\nif (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\nreturn true;\n} else {\nreturn false;\n}\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#elif defined(BILINEAR)\nvec4 color \x3d sampleBilinear(u_image, pixelLocation, u_srcImageSize);\n#else\nvec4 color \x3d texture2D(u_image, pixelLocation);\n#endif\nreturn color;\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\nvec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\nfloat maxI \x3d 255.0;\nfloat mid \x3d 128.0;\nfloat c \x3d u_contrastOffset;\nfloat b \x3d u_brightnessOffset;\nvec4 v;\nif (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n} else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n} else if (c \x3d\x3d 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\nv \x3d (sign(v) + 1.0) / 2.0;\n} else if (c \x3d\x3d -100.0) {\nv \x3d vec4(mid, mid, mid, currentPixel.a);\n}\nreturn vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n#ifdef LOOKUP_PROJECTION\nvec4 pv \x3d texture2D(u_transformGrid, coords);\nreturn vec2(pv.r, pv.g);\n#endif\nvec2 index_image \x3d floor(coords * u_targetImageSize);\nvec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\nvec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\nvec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\nvec2 srcLocation;\nvec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\nif (pos.s \x3c\x3d pos.t) {\nvec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\nvec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n} else {\nvec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\nvec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n}\nreturn srcLocation;\n}"},
flow:{"getFadeOpacity.glsl":"uniform float u_decayRate;\nuniform float u_fadeToZero;\nfloat getFadeOpacity(float x) {\nfloat cutOff \x3d mix(0.0, exp(-u_decayRate), u_fadeToZero);\nreturn (exp(-u_decayRate * x) - cutOff) / (1.0 - cutOff);\n}","getFragmentColor.glsl":"vec4 getFragmentColor(vec4 color, float dist, float size, float featheringSize) {\nfloat featheringStart \x3d clamp(0.5 - featheringSize / size, 0.0, 0.5);\nif (dist \x3e featheringStart) {\ncolor *\x3d 1.0 - (dist - featheringStart) / (0.5 - featheringStart);\n}\nreturn color;\n}",
imagery:{"imagery.frag":"precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform float u_Min;\nuniform float u_Max;\nuniform float u_featheringSize;\n#include \x3craster/flow/vv.glsl\x3e\nfloat getIntensity(float v) {\nreturn u_Min + v * (u_Max - u_Min);\n}\nvoid main(void) {\nvec4 sampled \x3d texture2D(u_texture, v_texcoord);\nfloat intensity \x3d getIntensity(sampled.r);\ngl_FragColor \x3d getColor(intensity);\ngl_FragColor.a *\x3d getOpacity(sampled.r);\ngl_FragColor.a *\x3d sampled.a;\ngl_FragColor.rgb *\x3d gl_FragColor.a;\n}",
"imagery.vert":"attribute vec2 a_position;\nattribute vec2 a_texcoord;\nuniform mat3 u_dvsMat3;\nvarying vec2 v_texcoord;\nvoid main(void) {\nvec2 xy \x3d (u_dvsMat3 * vec3(a_position, 1.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_texcoord \x3d a_texcoord;\n}"},particles:{"particles.frag":"precision highp float;\nvarying vec4 v_color;\nvarying vec2 v_texcoord;\nvarying float v_size;\nuniform float u_featheringSize;\n#include \x3craster/flow/getFragmentColor.glsl\x3e\nvoid main(void) {\ngl_FragColor \x3d getFragmentColor(v_color, length(v_texcoord - 0.5), v_size, u_featheringSize);\n}",
"particles.vert":"attribute vec4 a_xyts0;\nattribute vec4 a_xyts1;\nattribute vec4 a_typeIdDurationSeed;\nattribute vec4 a_extrudeInfo;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nuniform float u_time;\nuniform float u_trailLength;\nuniform float u_flowSpeed;\nvarying vec4 v_color;\nvarying vec2 v_texcoord;\nvarying float v_size;\nuniform float u_featheringSize;\nuniform float u_introFade;\n#include \x3craster/flow/vv.glsl\x3e\n#include \x3craster/flow/getFadeOpacity.glsl\x3e\nvoid main(void) {\nvec2 position0 \x3d a_xyts0.xy;\nfloat t0 \x3d a_xyts0.z;\nfloat speed0 \x3d a_xyts0.w;\nvec2 position1 \x3d a_xyts1.xy;\nfloat t1 \x3d a_xyts1.z;\nfloat speed1 \x3d a_xyts1.w;\nfloat type \x3d a_typeIdDurationSeed.x;\nfloat id \x3d a_typeIdDurationSeed.y;\nfloat duration \x3d a_typeIdDurationSeed.z;\nfloat seed \x3d a_typeIdDurationSeed.w;\nvec2 e0 \x3d a_extrudeInfo.xy;\nvec2 e1 \x3d a_extrudeInfo.zw;\nfloat animationPeriod \x3d duration + u_trailLength;\nfloat scaledTime \x3d u_time * u_flowSpeed;\nfloat randomizedTime \x3d scaledTime + seed * animationPeriod;\nfloat t \x3d mod(randomizedTime, animationPeriod);\nfloat fUnclamped \x3d (t - t0) / (t1 - t0);\nfloat f \x3d clamp(fUnclamped, 0.0, 1.0);\nfloat clampedTime \x3d mix(t0, t1, f);\nfloat speed \x3d mix(speed0, speed1, f);\nvec2 extrude;\nvec2 position;\nfloat fadeOpacity;\nfloat introOpacity;\nif (type \x3d\x3d 2.0) {\nif (fUnclamped \x3c 0.0 || (fUnclamped \x3e 1.0 \x26\x26 t1 !\x3d duration)) {\ngl_Position \x3d vec4(0.0, 0.0, -2.0, 1.0);\nreturn;\n}\nvec2 ortho \x3d mix(e0, e1, f);\nvec2 parallel;\nparallel \x3d normalize(position1 - position0) * 0.5;\nif (id \x3d\x3d 1.0) {\nextrude \x3d ortho;\nv_texcoord \x3d vec2(0.5, 0.0);\n} else if (id \x3d\x3d 2.0) {\nextrude \x3d -ortho;\nv_texcoord \x3d vec2(0.5, 1.0);\n} else if (id \x3d\x3d 3.0) {\nextrude \x3d ortho + parallel;\nv_texcoord \x3d vec2(1.0, 0.0);\n} else if (id \x3d\x3d 4.0) {\nextrude \x3d -ortho + parallel;\nv_texcoord \x3d vec2(1.0, 1.0);\n}\nfadeOpacity \x3d getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-clampedTime);\nv_size \x3d getSize(speed);\nv_color \x3d getColor(speed);\nv_color.a *\x3d getOpacity(speed);\nposition \x3d mix(position0, position1, f);\n} else {\nif (fUnclamped \x3c 0.0) {\ngl_Position \x3d vec4(0.0, 0.0, -2.0, 1.0);\nreturn;\n}\nif (id \x3d\x3d 1.0) {\nextrude \x3d e0;\nv_texcoord \x3d vec2(0.5, 0.0);\nfadeOpacity \x3d getFadeOpacity((t - t0) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-t0);\nv_size \x3d getSize(speed0);\nv_color \x3d getColor(speed0);\nv_color.a *\x3d getOpacity(speed0);\nposition \x3d position0;\n} else if (id \x3d\x3d 2.0) {\nextrude \x3d -e0;\nv_texcoord \x3d vec2(0.5, 1.0);\nfadeOpacity \x3d getFadeOpacity((t - t0) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-t0);\nv_size \x3d getSize(speed0);\nv_color \x3d getColor(speed0);\nv_color.a *\x3d getOpacity(speed0);\nposition \x3d position0;\n} else if (id \x3d\x3d 3.0) {\nextrude \x3d mix(e0, e1, f);\nv_texcoord \x3d vec2(0.5, 0.0);\nfadeOpacity \x3d getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-clampedTime);\nv_size \x3d getSize(speed);\nv_color \x3d getColor(speed);\nv_color.a *\x3d getOpacity(speed);\nposition \x3d mix(position0, position1, f);\n} else if (id \x3d\x3d 4.0) {\nextrude \x3d -mix(e0, e1, f);\nv_texcoord \x3d vec2(0.5, 1.0);\nfadeOpacity \x3d getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-clampedTime);\nv_size \x3d getSize(speed);\nv_color \x3d getColor(speed);\nv_color.a *\x3d getOpacity(speed);\nposition \x3d mix(position0, position1, f);\n}\n}\nvec2 xy \x3d (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(extrude * v_size, 0.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_color.a *\x3d fadeOpacity;\nv_color.a *\x3d mix(1.0, introOpacity, u_introFade);\nv_color.rgb *\x3d v_color.a;\n}"},
streamlines:{"streamlines.frag":"precision highp float;\nvarying float v_side;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_color;\nvarying float v_size;\nuniform float u_time;\nuniform float u_trailLength;\nuniform float u_flowSpeed;\nuniform float u_featheringSize;\nuniform float u_introFade;\n#include \x3craster/flow/getFragmentColor.glsl\x3e\n#include \x3craster/flow/getFadeOpacity.glsl\x3e\nvoid main(void) {\nfloat t \x3d mod(v_timeSeed * (v_totalTime + u_trailLength) + u_time * u_flowSpeed, v_totalTime + u_trailLength) - v_time;\nvec4 color \x3d v_color * step(0.0, t) * getFadeOpacity(t / u_trailLength);\ncolor *\x3d mix(1.0, 1.0 - exp(-v_time), u_introFade);\ngl_FragColor \x3d getFragmentColor(color, length((v_side + 1.0) / 2.0 - 0.5), v_size, u_featheringSize);\n}",
"streamlines.vert":"attribute vec3 a_positionAndSide;\nattribute vec3 a_timeInfo;\nattribute vec2 a_extrude;\nattribute float a_speed;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_color;\nvarying float v_side;\nvarying float v_size;\nuniform float u_featheringSize;\n#include \x3craster/flow/vv.glsl\x3e\nvoid main(void) {\nvec4 lineColor \x3d getColor(a_speed);\nfloat lineOpacity \x3d getOpacity(a_speed);\nfloat lineSize \x3d getSize(a_speed);\nvec2 position \x3d a_positionAndSide.xy;\nv_side \x3d a_positionAndSide.z;\nvec2 xy \x3d (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(a_extrude * lineSize, 0.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_time \x3d a_timeInfo.x;\nv_totalTime \x3d a_timeInfo.y;\nv_timeSeed \x3d a_timeInfo.z;\nv_color \x3d lineColor;\nv_color.a *\x3d lineOpacity;\nv_color.rgb *\x3d v_color.a;\nv_size \x3d lineSize;\n}"},
"vv.glsl":"#define MAX_STOPS 8\n#ifdef VV_COLOR\nuniform float u_color_stops[MAX_STOPS];\nuniform vec4 u_color_values[MAX_STOPS];\nuniform int u_color_count;\n#else\nuniform vec4 u_color;\n#endif\n#ifdef VV_OPACITY\nuniform float u_opacity_stops[MAX_STOPS];\nuniform float u_opacity_values[MAX_STOPS];\nuniform int u_opacity_count;\n#else\nuniform float u_opacity;\n#endif\n#ifdef VV_SIZE\nuniform float u_size_stops[MAX_STOPS];\nuniform float u_size_values[MAX_STOPS];\nuniform int u_size_count;\n#else\nuniform float u_size;\n#endif\nuniform float u_featheringOffset;\nvec4 getColor(float x) {\n#ifdef VV_COLOR\nvec4 color \x3d u_color_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_color_count) {\nbreak;\n}\nfloat x1 \x3d u_color_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_color_stops[i];\nvec4 y2 \x3d u_color_values[i];\nif (x \x3c x2) {\nvec4 y1 \x3d u_color_values[i - 1];\ncolor \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\ncolor \x3d y2;\n}\n}\n}\n#else\nvec4 color \x3d u_color;\n#endif\nreturn color;\n}\nfloat getOpacity(float x) {\n#ifdef VV_OPACITY\nfloat opacity \x3d u_opacity_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_opacity_count) {\nbreak;\n}\nfloat x1 \x3d u_opacity_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_opacity_stops[i];\nfloat y2 \x3d u_opacity_values[i];\nif (x \x3c x2) {\nfloat y1 \x3d u_opacity_values[i - 1];\nopacity \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nopacity \x3d y2;\n}\n}\n}\n#else\nfloat opacity \x3d u_opacity;\n#endif\nreturn opacity;\n}\nfloat getSize(float x) {\n#ifdef VV_SIZE\nfloat size \x3d u_size_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_size_count) {\nbreak;\n}\nfloat x1 \x3d u_size_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_size_stops[i];\nfloat y2 \x3d u_size_values[i];\nif (x \x3c x2) {\nfloat y1 \x3d u_size_values[i - 1];\nsize \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nsize \x3d y2;\n}\n}\n}\n#else\nfloat size \x3d u_size;\n#endif\nreturn size + 2.0 * u_featheringSize * u_featheringOffset;\n}"},
hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\nif (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\nreturn 0.0;\n}\nelse {\nreturn e;\n}\n}\nvec3 rgb2hsv(vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade) {\nval \x3d clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\nvec4 rgb \x3d colorize(vec4(val, val, val, 1.0), 255.0);\nvec3 hsv \x3d rgb2hsv(rgb.xyz);\nhsv.z \x3d hillshade;\nreturn vec4(hsv2rgb(hsv), 1.0) * rgb.a;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nif (currentPixel.a \x3d\x3d 0.0) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec2 axy \x3d vec2(-1.0, -1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nvec2 onePixel \x3d 1.0 / u_srcImageSize;\nif (pixelLocation.s \x3c onePixel.s) {\naxy[0] \x3d 1.0;\ndxy[0] \x3d 1.0;\ngxy[0] \x3d 1.0;\n}\nif (pixelLocation.t \x3c onePixel.t) {\naxy[1] \x3d 1.0;\nbxy[1] \x3d 1.0;\ncxy[1] \x3d 1.0;\n}\nif (pixelLocation.s \x3e 1.0 - onePixel.s) {\ncxy[0] \x3d -1.0;\nfxy[0] \x3d -1.0;\nixy[0] \x3d -1.0;\n}\nif (pixelLocation.t \x3e 1.0 - onePixel.t) {\ngxy[1] \x3d -1.0;\nhxy[1] \x3d -1.0;\nixy[1] \x3d -1.0;\n}\nvec4 va \x3d texture2D(u_image, pixelLocation + onePixel * axy);\nvec4 vb \x3d texture2D(u_image, pixelLocation + onePixel * bxy);\nvec4 vc \x3d texture2D(u_image, pixelLocation + onePixel * cxy);\nvec4 vd \x3d texture2D(u_image, pixelLocation + onePixel * dxy);\nvec4 ve \x3d texture2D(u_image, pixelLocation);\nvec4 vf \x3d texture2D(u_image, pixelLocation + onePixel * fxy);\nvec4 vg \x3d texture2D(u_image, pixelLocation + onePixel * gxy);\nvec4 vh \x3d texture2D(u_image, pixelLocation + onePixel * hxy);\nvec4 vi \x3d texture2D(u_image, pixelLocation + onePixel * ixy);\nfloat dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\nfloat dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\nfloat dzd \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\nfloat hillshade \x3d 0.0;\nif (u_hillshadeType \x3d\x3d 0){\nfloat cosDelta \x3d u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\nfloat z \x3d (u_cosZs[0] + cosDelta) / dzd;\nif (z \x3c 0.0)  z \x3d 0.0;\nhillshade \x3d z;\n} else {\nfor (int k \x3d 0; k \x3c 6; k++) {\nfloat cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\nfloat z \x3d (u_cosZs[k] + cosDelta) / dzd;\nif (z \x3c 0.0) z \x3d 0.0;\nhillshade \x3d hillshade + z * u_weights[k];\nif (k \x3d\x3d 5) break;\n}\n}\nfloat alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n#ifdef APPLY_COLORMAP\ngl_FragColor \x3d overlay(ve.r, u_minValue, u_maxValue, hillshade) * alpha * u_opacity;\n#else\ngl_FragColor \x3d vec4(hillshade, hillshade, hillshade, 1.0) * alpha * u_opacity;\n#endif\n}",
"hillshade.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, float scaleFactor) {\nfloat clrIndex \x3d clamp(currentPixel.r * scaleFactor - u_colormapOffset, 0.0, u_colormapMaxIndex);\nvec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\nvec4 color \x3d texture2D(u_colormap, clrPosition);\nvec4 result \x3d vec4(color.rgb, color.a * currentPixel.a);\nreturn result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nvec4 result \x3d colorize(currentPixel, 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * u_opacity;\n}","lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
magdir:{"magdir.frag":"precision mediump float;\nvarying vec4 v_color;\nuniform lowp float u_opacity;\nvoid main() {\ngl_FragColor \x3d v_color * u_opacity;\n}","magdir.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nuniform float u_rotation;\nuniform vec4 u_colors[12];\nvarying vec4 v_color;\nvoid main()\n{\nfloat angle \x3d a_offset.y + u_rotation;\n#ifndef ROTATION_GEOGRAPHIC\nangle \x3d 3.14159265359 * 2.0 - angle - 3.14159265359 / 2.0;\n#endif\nvec2 offset \x3d vec2(cos(angle), sin(angle)) * a_offset.x;\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 pos \x3d a_pos + offset * sizePercentage * u_symbolSize;\nv_color \x3d u_colors[int(a_vv.x)];\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
reproject:{"reproject.frag":"precision mediump float;\nvarying vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 1.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\n}","reproject.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_position;\ngl_Position \x3d vec4(2.0 * (a_position - 0.5), 0.0, 1.0);\n}"},
scalar:{"scalar.frag":"precision mediump float;\nuniform lowp float u_opacity;\nvarying vec2 v_pos;\nconst vec4 outlineColor \x3d vec4(0.2, 0.2, 0.2, 1.0);\nconst float outlineSize \x3d 0.02;\nconst float innerRadius \x3d 0.25;\nconst float outerRadius \x3d 0.42;\nconst float innerSquareLength \x3d 0.15;\nvoid main() {\nmediump float dist \x3d length(v_pos);\nmediump float fillalpha1 \x3d smoothstep(outerRadius, outerRadius + outlineSize, dist);\nfillalpha1 *\x3d (1.0-smoothstep(outerRadius + outlineSize, outerRadius + 0.1 + outlineSize, dist));\n#ifdef INNER_CIRCLE\nmediump float fillalpha2 \x3d smoothstep(innerRadius, innerRadius + outlineSize, dist);\nfillalpha2 *\x3d (1.0-smoothstep(innerRadius + outlineSize, innerRadius + 0.1 + outlineSize, dist));\n#else\nmediump float fillalpha2 \x3d (abs(v_pos.x) \x3c innerSquareLength ? 1.0 : 0.0) * (abs(v_pos.y) \x3c innerSquareLength ? 1.0 : 0.0);\n#endif\ngl_FragColor \x3d (fillalpha2 + fillalpha1) * outlineColor * u_opacity;\n}",
"scalar.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nvarying vec2 v_pos;\nvoid main()\n{\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 size \x3d u_symbolSize * sizePercentage;\nvec2 pos \x3d a_pos + a_offset * size;\nv_pos \x3d a_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\nif (val \x3e\x3d maxCutOff) {\nreturn maxOutput;\n} else if (val \x3c\x3d minCutOff) {\nreturn minOutput;\n}\nfloat stretchedVal;\nif (useGamma) {\nfloat tempf \x3d 1.0;\nfloat outRange \x3d maxOutput - minOutput;\nfloat relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\nif (gamma \x3e 1.0) {\ntempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n}\nstretchedVal \x3d (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n} else {\nstretchedVal \x3d minOutput + (val - minCutOff) * factor;\n}\nreturn stretchedVal;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\n#ifdef NOOP\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\nreturn;\n#endif\nif (u_bandCount \x3d\x3d 1) {\nfloat grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\nvec4 result \x3d colorize(vec4(grayVal, grayVal, grayVal, 1.0), u_useGamma ? 255.0 : 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * currentPixel.a * u_opacity;\n#else\ngl_FragColor \x3d vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n} else {\nfloat redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\nfloat greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor \x3d vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n}\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\ngl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nuniform mat3 u_worldExtent;\nvoid main() {\ngl_Position \x3d vec4(u_worldExtent * vec3(a_pos, 1.0), 1.0);\n}"},
tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\nlowp vec4 color \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\nmediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\nvec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\nv_tex \x3d a_pos;\n}"},
util:{"atan2.glsl":"float atan2(in float y, in float x) {\nfloat t0, t1, t2, t3, t4;\nt3 \x3d abs(x);\nt1 \x3d abs(y);\nt0 \x3d max(t3, t1);\nt1 \x3d min(t3, t1);\nt3 \x3d 1.0 / t0;\nt3 \x3d t1 * t3;\nt4 \x3d t3 * t3;\nt0 \x3d         - 0.013480470;\nt0 \x3d t0 * t4 + 0.057477314;\nt0 \x3d t0 * t4 - 0.121239071;\nt0 \x3d t0 * t4 + 0.195635925;\nt0 \x3d t0 * t4 - 0.332994597;\nt0 \x3d t0 * t4 + 0.999995630;\nt3 \x3d t0 * t3;\nt3 \x3d (abs(y) \x3e abs(x)) ? 1.570796327 - t3 : t3;\nt3 \x3d x \x3c 0.0 ?  3.141592654 - t3 : t3;\nt3 \x3d y \x3c 0.0 ? -t3 : t3;\nreturn t3;\n}",
"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/webgl/ShaderCompiler":function(){define(["exports"],function(z){let D=function(){function C(y){this.readFile=y}var B=C.prototype;B.resolveIncludes=function(y){return this._resolve(y)};B._resolve=function(y,x=new Map){if(x.has(y))return x.get(y);
const n=this._read(y);if(!n)throw Error(`cannot find shader file ${y}`);const f=/^[^\S\n]*#include\s+<(\S+)>[^\S\n]?/gm;let d=f.exec(n);const a=[];for(;null!=d;)a.push({path:d[1],start:d.index,length:d[0].length}),d=f.exec(n);let b=0,e="";a.forEach(l=>{e+=n.slice(b,l.start);e+=x.has(l.path)?"":this._resolve(l.path,x);b=l.start+l.length});e+=n.slice(b);x.set(y,e);return e};B._read=function(y){return this.readFile(y)};return C}();z.ShaderCompiler=D;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/webgl/ProgramTemplate":function(){define(["exports","./Program"],function(z,D){z.createProgram=function(C,B,y=""){return new D.Program(C,y+B.shaders.vertexShader,y+B.shaders.fragmentShader,B.attributes)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/Program":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/arrayUtils ../../core/has ../../core/maybe ./checkWebGLError ./context-util ./enums ./ShaderTranspiler".split(" "),
function(z,D,C,B,y,x,n,f,d){function a(k,r,g){k=k.gl;const c=k.createShader(r);k.shaderSource(c,g);k.compileShader(c);x.webglValidateShadersEnabled()&&!k.getShaderParameter(c,k.COMPILE_STATUS)&&(console.error("Compile error in ".concat(r===f.ShaderType.VERTEX_SHADER?"vertex":"fragment"," shader")),console.error(k.getShaderInfoLog(c)),console.error(b(g)));l.enabled&&(l.compiledLOC+=g.match(/\n/g).length+1);return c}function b(k){let r=2;return k.replace(/\n/g,()=>{var g=r++;g=1E3<=g?g.toString():("  "+
g).slice(-3);return"\n"+g+":"})}function e(k,r,g){const c=k.get(r);return c?C.update(c,g):(k.set(r,Array.from(g)),!0)}B=function(){function k(g,c,m,q,p=new Map){this._context=g;this._locations=q;this._uniformBlockBindings=p;this._refCount=1;this._compiled=!1;this._nameToUniformLocation={};this._nameToUniform1={};this._nameToUniform1v=new Map;this._nameToUniform2=new Map;this._nameToUniform3=new Map;this._nameToUniform4=new Map;this._nameToUniformMatrix3=new Map;this._nameToUniformMatrix4=new Map;
g||console.error("RenderingContext isn't initialized!");0===c.length&&console.error("Shaders source should not be empty!");this._context.type===n.ContextType.WEBGL2&&(c=d.transpileShader(c,f.ShaderType.VERTEX_SHADER),m=d.transpileShader(m,f.ShaderType.FRAGMENT_SHADER));this._vShader=a(this._context,f.ShaderType.VERTEX_SHADER,c);this._fShader=a(this._context,f.ShaderType.FRAGMENT_SHADER,m);this._vShader&&this._fShader||console.error("Error loading shaders!");this._context.instanceCounter.increment(f.ResourceType.Shader,
this);x.webglValidateShadersEnabled()&&(this.vertexShader=c,this.fragmentShader=m)}var r=k.prototype;r.dispose=function(){if(!(0<--this._refCount)){var g=this._context.gl;this._vShader&&(g.deleteShader(this._vShader),this._vShader=null,this._context.instanceCounter.decrement(f.ResourceType.Shader,this));this._fShader&&(g.deleteShader(this._fShader),this._fShader=null);this._glName&&(g.deleteProgram(this._glName),this._glName=null,this._context.instanceCounter.decrement(f.ResourceType.Program,this))}};
r.ref=function(){++this._refCount};r._getUniformLocation=function(g){void 0===this._nameToUniformLocation[g]&&(++l.numUniforms,this._nameToUniformLocation[g]=this._context.gl.getUniformLocation(this.glName,g));return this._nameToUniformLocation[g]};r.hasUniform=function(g){return null!==this._getUniformLocation(g)};r.setUniform1i=function(g,c){const m=this._nameToUniform1[g];if(void 0===m||c!==m)this._context.gl.uniform1i(this._getUniformLocation(g),c),this._nameToUniform1[g]=c};r.setUniform1iv=function(g,
c){e(this._nameToUniform1v,g,c)&&this._context.gl.uniform1iv(this._getUniformLocation(g),c)};r.setUniform2iv=function(g,c){e(this._nameToUniform2,g,c)&&this._context.gl.uniform2iv(this._getUniformLocation(g),c)};r.setUniform3iv=function(g,c){e(this._nameToUniform3,g,c)&&this._context.gl.uniform3iv(this._getUniformLocation(g),c)};r.setUniform4iv=function(g,c){e(this._nameToUniform4,g,c)&&this._context.gl.uniform4iv(this._getUniformLocation(g),c)};r.setUniform1f=function(g,c){const m=this._nameToUniform1[g];
if(void 0===m||c!==m)this._context.gl.uniform1f(this._getUniformLocation(g),c),this._nameToUniform1[g]=c};r.setUniform1fv=function(g,c){e(this._nameToUniform1v,g,c)&&this._context.gl.uniform1fv(this._getUniformLocation(g),c)};r.setUniform2f=function(g,c,m){const q=this._nameToUniform2.get(g);if(void 0===q)this._context.gl.uniform2f(this._getUniformLocation(g),c,m),this._nameToUniform2.set(g,[c,m]);else if(c!==q[0]||m!==q[1])this._context.gl.uniform2f(this._getUniformLocation(g),c,m),q[0]=c,q[1]=m};
r.setUniform2fv=function(g,c){e(this._nameToUniform2,g,c)&&this._context.gl.uniform2fv(this._getUniformLocation(g),c)};r.setUniform3f=function(g,c,m,q){const p=this._nameToUniform3.get(g);if(void 0===p)this._context.gl.uniform3f(this._getUniformLocation(g),c,m,q),this._nameToUniform3[g]=[c,m,q];else if(c!==p[0]||m!==p[1]||q!==p[2])this._context.gl.uniform3f(this._getUniformLocation(g),c,m,q),p[0]=c,p[1]=m,p[2]=q};r.setUniform3fv=function(g,c){e(this._nameToUniform3,g,c)&&this._context.gl.uniform3fv(this._getUniformLocation(g),
c)};r.setUniform4f=function(g,c,m,q,p){const u=this._nameToUniform4.get(g);if(void 0===u)this._context.gl.uniform4f(this._getUniformLocation(g),c,m,q,p),this._nameToUniform4.set(g,[c,m,q,p]);else if(void 0===u||c!==u[0]||m!==u[1]||q!==u[2]||p!==u[3])this._context.gl.uniform4f(this._getUniformLocation(g),c,m,q,p),u[0]=c,u[1]=m,u[2]=q,u[3]=p};r.setUniform4fv=function(g,c){e(this._nameToUniform4,g,c)&&this._context.gl.uniform4fv(this._getUniformLocation(g),c)};r.setUniformMatrix3fv=function(g,c,m=!1){e(this._nameToUniformMatrix3,
g,c)&&this._context.gl.uniformMatrix3fv(this._getUniformLocation(g),m,c)};r.setUniformMatrix4fv=function(g,c,m=!1){e(this._nameToUniformMatrix4,g,c)&&this._context.gl.uniformMatrix4fv(this._getUniformLocation(g),m,c)};r.stop=function(){};D._createClass(k,[{key:"glName",get:function(){if(y.isSome(this._glName))return this._glName;if(y.isNone(this._vShader))return null;const g=this._context.gl,c=g.createProgram();g.attachShader(c,this._vShader);g.attachShader(c,this._fShader);this._locations.forEach((m,
q)=>g.bindAttribLocation(c,m,q));g.linkProgram(c);x.webglValidateShadersEnabled()&&!g.getProgramParameter(c,g.LINK_STATUS)&&console.error("Could not link shader\n"+`validated: ${g.getProgramParameter(c,g.VALIDATE_STATUS)}`+`, gl error ${g.getError()}`+`, vertex: ${g.getShaderParameter(this._vShader,g.COMPILE_STATUS)}`+`, fragment: ${g.getShaderParameter(this._fShader,g.COMPILE_STATUS)}`+`, info log: ${g.getProgramInfoLog(c)}`+`, vertex source: ${this.vertexShader}`+`, fragment source: ${this.fragmentShader}`);
if(this._context.type===n.ContextType.WEBGL2)for(const [m,q]of this._uniformBlockBindings){const p=g.getUniformBlockIndex(c,m);4294967295>p&&g.uniformBlockBinding(c,p,q)}this._glName=c;this._context.instanceCounter.increment(f.ResourceType.Program,this);return c}},{key:"hasGLName",get:function(){return y.isSome(this._glName)}},{key:"isCompiled",get:function(){if(this._compiled)return!0;const g=this._context.gl.getExtension("KHR_parallel_shader_compile");return null==g?this._compiled=!0:this._compiled=
!!this._context.gl.getProgramParameter(this.glName,g.COMPLETION_STATUS_KHR)}}]);return k}();const l={compiledLOC:0,numUniforms:0,enabled:!1};z.Program=B;z.test=l;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/ShaderTranspiler":function(){define("exports ../../core/has ../../core/maybe ./enums ./reservedWordsGLSL3 ./testUtils".split(" "),function(z,D,C,B,y,x){function n(){function p(L){L.length&&N.push({type:c[F],data:L,position:O,line:M,
column:K})}function u(){I=I.length?[]:I;if("/"===J&&"*"===H)return O=G+E-1,F=0,J=H,E+1;if("/"===J&&"/"===H)return O=G+E-1,F=1,J=H,E+1;if("#"===H)return F=2,O=G+E,E;if(/\s/.test(H))return F=9,O=G+E,E;X=/\d/.test(H);aa=/[^\w_]/.test(H);O=G+E;F=X?4:aa?3:9999;return E}function h(){if(("\r"===H||"\n"===H)&&"\\"!==J)return p(I.join("")),F=999,E;I.push(H);J=H;return E+1}function t(){if("."===J&&/\d/.test(H))return F=5,E;if("/"===J&&"*"===H)return F=0,E;if("/"===J&&"/"===H)return F=1,E;if("."===H&&I.length){for(;v(I););
F=5;return E}if(";"===H||")"===H||"("===H){if(I.length)for(;v(I););p(H);F=999;return E+1}var L=2===I.length&&"\x3d"!==H;if(/[\w_\d\s]/.test(H)||L){for(;v(I););F=999;return E}I.push(H);J=H;return E+1}function v(L){var P=0;do{var Y=r.indexOf(L.slice(0,L.length+P).join(""));var U=r[Y];if(-1===Y){if(0<P--+L.length)continue;U=L.slice(0,1).join("")}p(U);O+=U.length;I=I.slice(U.length);return I.length}while(1)}function w(){if("."===H||/[eE]/.test(H))return I.push(H),F=5,J=H,E+1;if("x"===H&&1===I.length&&
"0"===I[0])return F=11,I.push(H),J=H,E+1;if(/[^\d]/.test(H))return p(I.join("")),F=999,E;I.push(H);J=H;return E+1}function A(){"f"===H&&(I.push(H),J=H,E+=1);if(/[eE]/.test(H)||"-"===H&&/[eE]/.test(J))return I.push(H),J=H,E+1;if(/[^\d]/.test(H))return p(I.join("")),F=999,E;I.push(H);J=H;return E+1}var E=0,G=0,F=999,H,J,I=[],N=[],M=1,K=0,O=0,X=!1,aa=!1,ba="",V;return function(L){N=[];if(null!==L){L=L.replace?L.replace(/\r\n/g,"\n"):L;E=0;ba+=L;for(V=ba.length;H=ba[E],E<V;){L=E;switch(F){case 0:"/"===
H&&"*"===J?(I.push(H),p(I.join("")),F=999):(I.push(H),J=H);E+=1;break;case 1:E=h();break;case 2:E=h();break;case 3:E=t();break;case 4:E=w();break;case 11:/[^a-fA-F0-9]/.test(H)?(p(I.join("")),F=999):(I.push(H),J=H,E+=1);break;case 5:E=A();break;case 9999:if(/[^\d\w_]/.test(H)){var P=I.join("");F=-1<k.indexOf(P)?8:-1<g.indexOf(P)?7:6;p(I.join(""));F=999}else I.push(H),J=H,E+=1;break;case 9:/[^\s]/g.test(H)?(p(I.join("")),F=999):(I.push(H),J=H,E+=1);break;case 999:E=u()}if(L!==E)switch(ba[L]){case "\n":K=
0;++M;break;default:++K}}G+=E;ba=ba.slice(E);return N}I.length&&p(I.join(""));F=10;p("(eof)");return N}}function f(p){return p.map(u=>"eof"!==u.type?u.data:"").join("")}function d(p,u="100",h="300 es"){const t=/^\s*#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/;for(const v of p)if("preprocessor"===v.type){const w=t.exec(v.data);if(w){p=w[1].replace(/\s\s+/g," ");if(p===h)return p;if(p===u)return v.data="#version "+h,u;throw Error("unknown glsl version: "+p);}}p.splice(0,0,{type:"preprocessor",data:"#version "+
h},{type:"whitespace",data:"\n"});return null}function a(p,u,h,t){t=t||h;for(const v of p)if("ident"===v.type&&v.data===h)return t in u?u[t]++:u[t]=0,a(p,u,t+"_"+u[t],t);return h}function b(p,u,h="afterVersion"){const t={data:"\n",type:"whitespace"},v=A=>A<p.length?/[^\r\n]$/.test(p[A].data):!1;let w=function(A){let E=-1,G=0,F=-1;for(let J=0;J<A.length;J++){var H=A[J];"preprocessor"===H.type&&(H.data.match(/#(if|ifdef|ifndef)\s+.+/)?++G:H.data.match(/#endif\s*.*/)&&--G);("afterVersion"===h||"afterPrecision"===
h)&&"preprocessor"===H.type&&/^#version/.test(H.data)&&(F=Math.max(F,J));if("afterPrecision"===h&&"keyword"===H.type&&"precision"===H.data){a:{for(H=J;H<A.length;H++){const I=A[H];if("operator"===I.type&&";"===I.data)break a}H=null}if(null===H)throw Error("precision statement not followed by any semicolons!");F=Math.max(F,H)}E<F&&0===G&&(E=J)}return E+1}(p);v(w-1)&&p.splice(w++,0,t);for(const A of u)p.splice(w++,0,A);v(w-1)&&v(w)&&p.splice(w,0,t)}function e(p,u,h,t="lowp"){b(p,[{type:"keyword",data:"out"},
{type:"whitespace",data:" "},{type:"keyword",data:t},{type:"whitespace",data:" "},{type:"keyword",data:h},{type:"whitespace",data:" "},{type:"ident",data:u},{type:"operator",data:";"}],"afterPrecision")}function l(p,u,h,t,v="lowp"){b(p,[{type:"keyword",data:"layout"},{type:"operator",data:"("},{type:"keyword",data:"location"},{type:"whitespace",data:" "},{type:"operator",data:"\x3d"},{type:"whitespace",data:" "},{type:"integer",data:t.toString()},{type:"operator",data:")"},{type:"whitespace",data:" "},
{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:v},{type:"whitespace",data:" "},{type:"keyword",data:h},{type:"whitespace",data:" "},{type:"ident",data:u},{type:"operator",data:";"}],"afterPrecision")}D={exports:{}};(function(p){(function(u){u=u();void 0!==u&&(p.exports=u)})(function(){return"precision highp mediump lowp attribute const uniform varying break continue do for while if else in out inout float int void bool true false discard return mat2 mat3 mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow struct asm class union enum typedef template this packed goto switch default inline noinline volatile public static extern external interface long short double half fixed unsigned input output hvec2 hvec3 hvec4 dvec2 dvec3 dvec4 fvec2 fvec3 fvec4 sampler2DRect sampler3DRect sampler2DRectShadow sizeof cast namespace using".split(" ")})})(D);
const k=D.exports;D={exports:{}};(function(p){(function(u){u=u();void 0!==u&&(p.exports=u)})(function(){"use strict;";return"\x3c\x3c\x3d \x3e\x3e\x3d ++ -- \x3c\x3c \x3e\x3e \x3c\x3d \x3e\x3d \x3d\x3d !\x3d \x26\x26 || +\x3d -\x3d *\x3d /\x3d %\x3d \x26\x3d ^^ ^\x3d |\x3d ( ) [ ] . ! ~ * / % + - \x3c \x3e \x26 ^ | ? : \x3d , ; { }".split(" ")})})(D);const r=D.exports;D={exports:{}};(function(p){(function(u){u=u();void 0!==u&&(p.exports=u)})(function(){return"abs acos all any asin atan ceil clamp cos cross dFdx dFdy degrees distance dot equal exp exp2 faceforward floor fract gl_BackColor gl_BackLightModelProduct gl_BackLightProduct gl_BackMaterial gl_BackSecondaryColor gl_ClipPlane gl_ClipVertex gl_Color gl_DepthRange gl_DepthRangeParameters gl_EyePlaneQ gl_EyePlaneR gl_EyePlaneS gl_EyePlaneT gl_Fog gl_FogCoord gl_FogFragCoord gl_FogParameters gl_FragColor gl_FragCoord gl_FragData gl_FragDepth gl_FragDepthEXT gl_FrontColor gl_FrontFacing gl_FrontLightModelProduct gl_FrontLightProduct gl_FrontMaterial gl_FrontSecondaryColor gl_LightModel gl_LightModelParameters gl_LightModelProducts gl_LightProducts gl_LightSource gl_LightSourceParameters gl_MaterialParameters gl_MaxClipPlanes gl_MaxCombinedTextureImageUnits gl_MaxDrawBuffers gl_MaxFragmentUniformComponents gl_MaxLights gl_MaxTextureCoords gl_MaxTextureImageUnits gl_MaxTextureUnits gl_MaxVaryingFloats gl_MaxVertexAttribs gl_MaxVertexTextureImageUnits gl_MaxVertexUniformComponents gl_ModelViewMatrix gl_ModelViewMatrixInverse gl_ModelViewMatrixInverseTranspose gl_ModelViewMatrixTranspose gl_ModelViewProjectionMatrix gl_ModelViewProjectionMatrixInverse gl_ModelViewProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixTranspose gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_Normal gl_NormalMatrix gl_NormalScale gl_ObjectPlaneQ gl_ObjectPlaneR gl_ObjectPlaneS gl_ObjectPlaneT gl_Point gl_PointCoord gl_PointParameters gl_PointSize gl_Position gl_ProjectionMatrix gl_ProjectionMatrixInverse gl_ProjectionMatrixInverseTranspose gl_ProjectionMatrixTranspose gl_SecondaryColor gl_TexCoord gl_TextureEnvColor gl_TextureMatrix gl_TextureMatrixInverse gl_TextureMatrixInverseTranspose gl_TextureMatrixTranspose gl_Vertex greaterThan greaterThanEqual inversesqrt length lessThan lessThanEqual log log2 matrixCompMult max min mix mod normalize not notEqual pow radians reflect refract sign sin smoothstep sqrt step tan texture2D texture2DLod texture2DProj texture2DProjLod textureCube textureCubeLod texture2DLodEXT texture2DProjLodEXT textureCubeLodEXT texture2DGradEXT texture2DProjGradEXT textureCubeGradEXT".split(" ")})})(D);
const g=D.exports;var c="block-comment line-comment preprocessor operator integer float ident builtin keyword whitespace eof integer".split(" ");const m=["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers","GL_EXT_shader_texture_lod"],q=new Map;z.transpileShader=function(p,u){var h=x.shaderTranspiler.enableCache?q.get(p):null;if(C.isSome(h))return h;h=n();var t=[];t=t.concat(h(p));h=t=t.concat(h(null));if("300 es"===d(h,"100","300 es"))return p;var v=t=null;const w={},A={};for(let H=
0;H<h.length;++H){const J=h[H];switch(J.type){case "keyword":u===B.ShaderType.VERTEX_SHADER&&"attribute"===J.data?J.data="in":"varying"===J.data&&(J.data=u===B.ShaderType.VERTEX_SHADER?"out":"in");break;case "builtin":/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(J.data.trim())&&(J.data=J.data.replace(/(2D|Cube|EXT)/g,""));u===B.ShaderType.FRAGMENT_SHADER&&"gl_FragColor"===J.data&&(t||(t=a(h,w,"fragColor"),e(h,t,"vec4")),J.data=t);if(u===B.ShaderType.FRAGMENT_SHADER&&"gl_FragData"===J.data){{var E=
void 0;let I=void 0;var G=h;var F=H+1;let N=-1;for(;F<G.length;F++){const M=G[F];if("operator"===M.type&&("["===M.data&&(I=F),"]"===M.data)){E=F;break}"integer"===M.type&&(N=parseInt(M.data,10))}I&&E&&G.splice(I,E-I+1);G=N}E=a(h,w,"fragData");l(h,E,"vec4",G,"mediump");J.data=E}else u===B.ShaderType.FRAGMENT_SHADER&&"gl_FragDepthEXT"===J.data&&(v||(v=a(h,w,"gl_FragDepth")),J.data=v);break;case "ident":if(y.includes(J.data)){if(G=u===B.ShaderType.VERTEX_SHADER)a:{for(G=H-1;0<=G;G--)if(E=h[G],"whitespace"!==
E.type&&"block-comment"!==E.type)if("keyword"===E.type){if("attribute"===E.data||"in"===E.data){G=!0;break a}}else break;G=!1}if(G)throw Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");J.data in A||(A[J.data]=a(h,w,J.data));J.data=A[J.data]}}}for(u=h.length-1;0<=u;--u)t=h[u],"preprocessor"===t.type&&((v=t.data.match(/#extension\s+(.*):/))&&v[1]&&m.includes(v[1].trim())&&(v=h[u+1],h.splice(u,v&&"whitespace"===v.type?2:1)),(v=t.data.match(/#ifdef\s+(.*)/))&&v[1]&&
m.includes(v[1].trim())&&(t.data="#if 1"),(v=t.data.match(/#ifndef\s+(.*)/))&&v[1]&&m.includes(v[1].trim())&&(t.data="#if 0"));h=f(h);x.shaderTranspiler.enableCache&&q.set(p,h);return h};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/reservedWordsGLSL3":function(){define(function(){return"layout centroid smooth case mat2x2 mat2x3 mat2x4 mat3x2 mat3x3 mat3x4 mat4x2 mat4x3 mat4x4 uint uvec2 uvec3 uvec4 samplerCubeShadow sampler2DArray sampler2DArrayShadow isampler2D isampler3D isamplerCube isampler2DArray usampler2D usampler3D usamplerCube usampler2DArray coherent restrict readonly writeonly resource atomic_uint noperspective patch sample subroutine common partition active filter image1D image2D image3D imageCube iimage1D iimage2D iimage3D iimageCube uimage1D uimage2D uimage3D uimageCube image1DArray image2DArray iimage1DArray iimage2DArray uimage1DArray uimage2DArray image1DShadow image2DShadow image1DArrayShadow image2DArrayShadow imageBuffer iimageBuffer uimageBuffer sampler1DArray sampler1DArrayShadow isampler1D isampler1DArray usampler1D usampler1DArray isampler2DRect usampler2DRect samplerBuffer isamplerBuffer usamplerBuffer sampler2DMS isampler2DMS usampler2DMS sampler2DMSArray isampler2DMSArray usampler2DMSArray trunc round roundEven isnan isinf floatBitsToInt floatBitsToUint intBitsToFloat uintBitsToFloat packSnorm2x16 unpackSnorm2x16 packUnorm2x16 unpackUnorm2x16 packHalf2x16 unpackHalf2x16 outerProduct transpose determinant inverse texture textureSize textureProj textureLod textureOffset texelFetch texelFetchOffset textureProjOffset textureLodOffset textureProjLod textureProjLodOffset textureGrad textureGradOffset textureProjGrad textureProjGradOffset".split(" ")})},
"esri/views/webgl/testUtils":function(){define(["exports"],function(z){z.shaderTranspiler={enableCache:!1};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/BrushOverlay":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../Utils ./WGLBrush ../../../../webgl/enums".split(" "),function(z,D,C,B,y,x){return function(n){function f(){var a=n.apply(this,arguments)||this;
a._desc={vsPath:"overlay/overlay",fsPath:"overlay/overlay",attributes:new Map([["a_pos",0],["a_uv",1]])};return a}z._inheritsLoose(f,n);var d=f.prototype;d.dispose=function(){};d.prepareState=function({context:a}){a.setBlendingEnabled(!0);a.setColorMask(!0,!0,!0,!0);a.setBlendFunctionSeparate(x.BlendFactor.ONE,x.BlendFactor.ONE_MINUS_SRC_ALPHA,x.BlendFactor.ONE,x.BlendFactor.ONE_MINUS_SRC_ALPHA);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(x.CompareFunction.GREATER,255,
255)};d.draw=function(a,b){const {context:e,painter:l,requestRender:k}=a;if(b.isReady){var {computedOpacity:r,dvsMat3:g,isWrapAround:c,texture:m}=b;a.timeline.begin(this.name);var q=l.materialManager.getProgram(this._desc);if(D.isSome(k)&&!q.isCompiled)k();else{var p=B.createProgramDescriptor("overlay",{geometry:[{location:0,name:"a_pos",count:2,type:x.DataType.FLOAT}],tex:[{location:1,name:"a_uv",count:2,type:x.DataType.UNSIGNED_SHORT}]});if(b=b.getVAO(e,p.bufferLayouts,p.attributes))e.bindVAO(b),
e.useProgram(q),e.bindTexture(m,C.TEXTURE_BINDING_BITMAP),q.setUniformMatrix3fv("u_dvsMat3",g),q.setUniform1i("u_texture",C.TEXTURE_BINDING_BITMAP),q.setUniform1f("u_opacity",r),e.drawArrays(x.PrimitiveType.TRIANGLE_STRIP,0,c?10:4),e.bindVAO(),a.timeline.end(this.name)}}};return f}(y)})},"esri/views/2d/engine/webgl/brushes/WGLBrushDotDensity":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../core/RandomLCG ../definitions ../enums ./WGLGeometryBrushFill ../techniques/utils ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/FramebufferObject ../../../../webgl/Renderbuffer ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l){return function(k){function r(){var c=k.apply(this,arguments)||this;c._dotTextureSize=0;c._dotTextures=null;c._dotSamplers=new Int32Array([B.TEXTURE_BINDING_RENDERER_0,B.TEXTURE_BINDING_RENDERER_1]);c._dotVAO=null;c._dotDesc={vsPath:"dot/dot",fsPath:"dot/dot",attributes:new Map([["a_pos",0]])};return c}z._inheritsLoose(r,k);var g=r.prototype;g.dispose=function(){k.prototype.dispose.call(this);this._disposeTextures();this._dotFBO=D.disposeMaybe(this._dotFBO);this._dotVAO=
D.disposeMaybe(this._dotVAO)};g.getGeometryType=function(){return y.WGLGeometryType.FILL};g.supportsSymbology=function(c){return c===y.WGLSymbologyType.DOT_DENSITY};g._drawFills=function(c,m,q,p,u,h){const {passOptions:t}=c;D.isSome(t)&&"hittest"===t.type?k.prototype._drawFills.call(this,c,m,q,p,u,h):(q=this._drawDotLocations(c,m,q,u,h),this._drawDotDensity(c,m,q))};g._drawDotDensity=function(c,m,q){const {context:p,painter:u,rendererInfo:h,requestRender:t}=c,v=u.materialManager.getProgram(this._dotDesc);
if(D.isSome(t)&&!v.isCompiled)t();else{var {rendererSchema:w}=h;n.assertRendererSchema(w,"dot-density");var A=this._createDotDensityMesh(p,this._dotDesc.attributes,{geometry:[{name:"a_pos",count:2,type:d.DataType.SHORT,divisor:0,normalized:!1,offset:0,stride:4}]});p.setStencilTestEnabled(!0);p.useProgram(v);v.setUniform1f("u_tileZoomFactor",1);v.setUniform1i("u_texture",this._dotSamplers[0]);v.setUniform1f("u_dotSize",Math.max(w.dotSize,1));v.setUniform1f("u_pixelRatio",window.devicePixelRatio);this._setSharedUniforms(v,
c,m);p.bindTexture(q,this._dotSamplers[0]);p.bindVAO(A);p.drawArrays(d.PrimitiveType.POINTS,0,262144)}};g._drawDotLocations=function(c,m,q,p,u){const {context:h,rendererInfo:t,requiredLevel:v}=c,w=h.getViewport();var {rendererSchema:A}=t;n.assertRendererSchema(A,"dot-density");const {dotScale:E,colors:G,activeDots:F,backgroundColor:H,dotValue:J}=A;h.setViewport(0,0,512,512);A=h.getBoundFramebufferObject();const I=this._createFBO(h);h.bindFramebuffer(I);h.setClearColor(0,0,0,0);h.clear(h.gl.COLOR_BUFFER_BIT|
h.gl.STENCIL_BUFFER_BIT);h.setStencilTestEnabled(!1);m=1/2**(v-m.key.level);const N=B.TILE_SIZE,M=N*window.devicePixelRatio*N*window.devicePixelRatio,K=1/m*(1/m);c=E?c.state.scale/E:1;q.setUniform1f("u_tileZoomFactor",m);q.setUniform1f("u_tileDotsOverArea",M/(B.TILE_SIZE*window.devicePixelRatio*B.TILE_SIZE*window.devicePixelRatio));q.setUniformMatrix4fv("u_dotColors",G);q.setUniform4fv("u_isActive",F);q.setUniform4fv("u_dotBackgroundColor",H);q.setUniform1f("u_dotValue",Math.max(1,J*c*K));this._bindDotDensityTextures(h,
q,t,N);h.drawElements(d.PrimitiveType.TRIANGLES,p,d.DataType.UNSIGNED_INT,u);h.setViewport(w.x,w.y,w.width,w.height);h.bindFramebuffer(A);return I.colorTexture};g._createFBO=function(c){if(D.isNone(this._dotFBO)){const m={target:d.TextureType.TEXTURE_2D,pixelFormat:d.PixelFormat.RGBA,dataType:d.PixelType.UNSIGNED_BYTE,samplingMode:d.TextureSamplingMode.NEAREST,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE,width:512,height:512},q={colorTarget:d.TargetType.TEXTURE,depthStencilTarget:d.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER},
p=new b.Renderbuffer(c,{width:512,height:512,internalFormat:d.RenderbufferFormat.DEPTH_STENCIL});this._dotFBO=new a.FramebufferObject(c,q,m,p)}return this._dotFBO};g._disposeTextures=function(){if(this._dotTextures){for(let c=0;c<this._dotTextures.length;c++)this._dotTextures[c].dispose();this._dotTextures=null}};g._bindDotDensityTextures=function(c,m,q,p){({rendererSchema:q}=q);n.assertRendererSchema(q,"dot-density");p=this._createDotDensityTextures(c,p,q.seed);m.setUniform1iv("u_dotTextures",this._dotSamplers);
for(m=0;m<p.length;m++)c.bindTexture(p[m],this._dotSamplers[m])};g._createDotDensityMesh=function(c,m,q){if(D.isNone(this._dotVAO)){var p=new Int16Array(524288);for(let u=0;512>u;u++)for(let h=0;512>h;h++)p[2*(h+512*u)]=h,p[2*(h+512*u)+1]=u;p=f.BufferObject.createVertex(c,d.Usage.STATIC_DRAW,p);this._dotVAO=new l.VertexArrayObject(c,m,q,{geometry:p},null)}return this._dotVAO};g._createDotDensityTextures=function(c,m,q){if(this._dotTextureSize!==m||this._seed!==q)this._disposeTextures(),this._dotTextureSize=
m,this._seed=q;null===this._dotTextures&&(q=new C(q),this._dotTextures=[this._allocDotDensityTexture(c,m,q),this._allocDotDensityTexture(c,m,q)]);return this._dotTextures};g._allocDotDensityTexture=function(c,m,q){const p=new Float32Array(m*m*4);for(let u=0;u<p.length;u++)p[u]=q.getFloat();return new e.Texture(c,{wrapMode:d.TextureWrapMode.REPEAT,pixelFormat:d.PixelFormat.RGBA,dataType:d.PixelType.FLOAT,samplingMode:d.TextureSamplingMode.NEAREST,width:m,height:m},p)};return r}(x)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../techniques/utils ../../../../webgl/enums".split(" "),
function(z,D,C,B,y,x,n,f){function d(a){const b={geometry:[{location:0,name:"a_pos",count:2,type:f.DataType.SHORT},{location:1,name:"a_id",count:3,type:f.DataType.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:f.DataType.UNSIGNED_BYTE},{location:3,name:"a_color",count:4,type:f.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_aux1",count:4,type:f.DataType.UNSIGNED_SHORT},{location:5,name:"a_aux2",count:4,type:f.DataType.SHORT},{location:6,name:"a_aux3",count:4,type:f.DataType.UNSIGNED_BYTE},
{location:7,name:"a_zoomRange",count:2,type:f.DataType.UNSIGNED_SHORT}]};switch(a.symbologyType){case C.WGLSymbologyType.SIMPLE:case C.WGLSymbologyType.OUTLINE_FILL_SIMPLE:b.geometry.splice(7,1),b.geometry.splice(4,1)}return{shader:"materials/fill",vertexLayout:b}}return function(a){function b(){return a.apply(this,arguments)||this}z._inheritsLoose(b,a);var e=b.prototype;e.dispose=function(){};e.getGeometryType=function(){return C.WGLGeometryType.FILL};e.supportsSymbology=function(l){return l!==C.WGLSymbologyType.DOT_DENSITY};
e.drawGeometry=function(l,k,r,g){const {context:c,painter:m,rendererInfo:q,requiredLevel:p,passOptions:u,requestRender:h}=l;var t=x.FillMaterialKey.load(r.materialKey),v=n.getTechniqueFromMaterialKey(t.data);const w=D.isSome(u)&&"hittest"===u.type;var A=m.materialManager;const {shader:E,vertexLayout:G,hittestAttributes:F}=D.unwrapOr(v.programSpec,d(t));v=f.PrimitiveType.TRIANGLES;let H=B.createProgramDescriptor(t.data,G);w&&(H=this._getTriangleDesc(r.materialKey,H,F),v=f.PrimitiveType.POINTS);const {attributes:J,
bufferLayouts:I}=H;g=A.getMaterialProgram(l,t,E,J,g);!D.isSome(h)||w||g.isCompiled?(c.useProgram(g),this._setSharedUniforms(g,l,k),g.setUniform2f("u_tileOffset",512*k.key.col,512*k.key.row),t.textureBinding&&(m.textureManager.bindTextures(c,g,t),g.setUniform1f("u_zoomFactor",1/2**(p-k.key.level))),A=1/l.pixelRatio,g.setUniform1f("u_blur",A),g.setUniform1f("u_antialiasing",A),this._setSizeVVUniforms(t,g,q,k),this._setColorAndOpacityVVUniforms(t,g,q),t=r.target.getVAO(c,I,J,w),A=r.indexCount,r=r.indexFrom*
Uint32Array.BYTES_PER_ELEMENT,w&&(A/=3,r/=3),c.bindVAO(t),this._drawFills(l,k,g,v,A,r)):h()};e._drawFills=function(l,k,r,g,c,m){l.context.drawElements(g,c,f.DataType.UNSIGNED_INT,m)};return b}(y)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./WGLBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),function(z,D,C,B,y,x){return function(n){function f(){var a=n.apply(this,
arguments)||this;a._computeDesc=new Map;return a}z._inheritsLoose(f,n);var d=f.prototype;d.prepareState=function({context:a},b,e){e&&e.includes("hittest")?a.setBlendFunctionSeparate(x.BlendFactor.ONE,x.BlendFactor.ONE,x.BlendFactor.ONE,x.BlendFactor.ONE):a.setBlendFunctionSeparate(x.BlendFactor.ONE,x.BlendFactor.ONE_MINUS_SRC_ALPHA,x.BlendFactor.ONE,x.BlendFactor.ONE_MINUS_SRC_ALPHA);a.setBlendingEnabled(!0);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(x.CompareFunction.EQUAL,
b.stencilRef,255)};d.draw=function(a,b,e){var l=this.getGeometryType();b.commit(a);l=b.getGeometry(l);D.isNone(l)||(a.timeline.begin(this.name),a.attributeView.bindTextures(a.context),l.forEachCommand(k=>{const r=y.MaterialKeyBase.load(k.materialKey).symbologyType;this.supportsSymbology(r)&&this.drawGeometry(a,b,k,e)}))};d._setSharedUniforms=function(a,b,e){const {displayLevel:l,pixelRatio:k,state:r,passOptions:g}=b;D.isSome(g)&&"hittest"===g.type&&(a.setUniform2fv("u_hittestPos",g.position),a.setUniform1f("u_hittestDist",
g.distance));a.setUniform1f("u_pixelRatio",k);a.setUniformMatrix3fv("u_tileMat3",e.transforms.tileMat3);a.setUniformMatrix3fv("u_viewMat3",r.viewMat3);a.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs);a.setUniformMatrix3fv("u_displayViewMat3",r.displayViewMat3);a.setUniform1f("u_currentZoom",Math.round(l*C.MIN_MAX_ZOOM_PRECISION_FACTOR));a.setUniform1i("u_attributeTextureSize",b.attributeView.size);a.setUniform1i("u_attributeData0",C.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.setUniform1i("u_attributeData1",
C.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.setUniform1i("u_attributeData2",C.TEXTURE_BINDING_ATTRIBUTE_DATA_2);a.setUniform1i("u_attributeData3",C.TEXTURE_BINDING_ATTRIBUTE_DATA_3);a.setUniform1i("u_attributeData4",C.TEXTURE_BINDING_ATTRIBUTE_DATA_4);a.setUniform1i("u_attributeData5",C.TEXTURE_BINDING_ATTRIBUTE_DATA_5)};d._setSizeVVUniforms=function(a,b,e,l){a.vvSizeMinMaxValue&&b.setUniform4fv("u_vvSizeMinMaxValue",e.vvSizeMinMaxValue);a.vvSizeScaleStops&&b.setUniform1f("u_vvSizeScaleStopsValue",e.vvSizeScaleStopsValue);
a.vvSizeFieldStops&&(l=e.getSizeVVFieldStops(l.key.level),b.setUniform1fv("u_vvSizeFieldStopsValues",l.values),b.setUniform1fv("u_vvSizeFieldStopsSizes",l.sizes));a.vvSizeUnitValue&&b.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",e.vvSizeUnitValueToPixelsRatio)};d._setColorAndOpacityVVUniforms=function(a,b,e){a.vvColor&&(b.setUniform1fv("u_vvColorValues",e.vvColorValues),b.setUniform4fv("u_vvColors",e.vvColors));a.vvOpacity&&(b.setUniform1fv("u_vvOpacityValues",e.vvOpacityValues),b.setUniform1fv("u_vvOpacities",
e.vvOpacities))};d._setRotationVVUniforms=function(a,b,e){a.vvRotation&&b.setUniform1f("u_vvRotationType","geographic"===e.vvMaterialParameters.vvRotationType?0:1)};d._getTriangleDesc=function(a,b,e=["a_pos"]){const l=b.bufferLayouts.geometry;e=e.map(g=>l.findIndex(c=>c.name===g));a=`${a}-${e.join("-")}`;var k=this._computeDesc.get(a);if(!k){k=b.strides;const g=b.strides.geometry,c=new Map(b.attributes);var r=l.map(q=>({...q}));b=Math.max(...b.attributes.values());r={geometry:r};let m=0;for(const q of e)e=
l[q],r.geometry.push({count:e.count,name:e.name+"1",divisor:e.divisor,normalized:e.normalized,offset:g+e.offset,stride:g,type:e.type}),r.geometry.push({count:e.count,name:e.name+"2",divisor:e.divisor,normalized:e.normalized,offset:2*g+e.offset,stride:g,type:e.type}),c.set(e.name+"1",b+ ++m),c.set(e.name+"2",b+ ++m);k={bufferLayouts:r,attributes:c,strides:k};this._computeDesc.set(a,k)}return k};return f}(B)})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/Error","../alignmentUtils","../enums"],function(z,D,C,B,y){function x(q){return q===y.WGLSymbologyType.SIMPLE||q===y.WGLSymbologyType.OUTLINE_FILL_SIMPLE}function n(q){return q===y.WGLSymbologyType.OUTLINE_FILL||q===y.WGLSymbologyType.OUTLINE_FILL_SIMPLE}const f=Object.keys(y.WGLSymbologyType).filter(q=>"number"===typeof y.WGLSymbologyType[q]).reduce((q,p)=>({...q,[p]:y.WGLSymbologyType[p]}),{});let d=function(){function q(u){this._data=0;this._data=u}q.load=function(u){const h=
this.shared;h.data=u;return h};var p=q.prototype;p.setBit=function(u,h){u=1<<u;this._data=h?this._data|u:this._data&~u};p.bit=function(u){return(this._data&1<<u)>>u};p.setBits=function(u,h,t){for(let v=h,w=0;v<t;v++,w++)this.setBit(v,0!==(u&1<<w))};p.bits=function(u,h){let t=0;for(let v=u,w=0;v<h;v++,w++)t|=this.bit(v)<<w;return t};p.hasVV=function(){return!1};p.setVV=function(u,h){};p.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf,symbologyType:{value:y.WGLSymbologyType[this.symbologyType],
options:f,namespace:"SYMBOLOGY_TYPE"}}};p.getVariationHash=function(){return this._data&~(7&this.textureBinding)};D._createClass(q,[{key:"data",get:function(){return this._data},set:function(u){this._data=u}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(u){this.setBits(u,8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(u){this.setBit(20,u)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(u){this.setBit(11,u)}},{key:"pattern",get:function(){return!!this.bit(12)},
set:function(u){this.setBit(12,u)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(u){this.setBits(u,0,8)}},{key:"symbologyType",get:function(){return this.bits(21,26)},set:function(u){this.setBits(u,21,26)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case y.WGLGeometryType.FILL:return"fill";case y.WGLGeometryType.MARKER:return"marker";case y.WGLGeometryType.LINE:return"line";case y.WGLGeometryType.TEXT:return"text";case y.WGLGeometryType.LABEL:return"label";
default:throw new C(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);return q}();d.shared=new d(0);const a=q=>function(p){function u(){return p.apply(this,arguments)||this}D._inheritsLoose(u,p);var h=u.prototype;h.hasVV=function(){return p.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};h.setVV=function(t,v){p.prototype.setVV.call(this,t,v);{var w=this.geometryType;const A=y.WGLVVFlag.SIZE_FIELD_STOPS|y.WGLVVFlag.SIZE_MINMAX_VALUE|
y.WGLVVFlag.SIZE_SCALE_STOPS|y.WGLVVFlag.SIZE_UNIT_VALUE,E=(t&(y.WGLVVTarget.FIELD_TARGETS_OUTLINE|y.WGLVVTarget.MINMAX_TARGETS_OUTLINE|y.WGLVVTarget.SCALE_TARGETS_OUTLINE|y.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;v=w===y.WGLGeometryType.LINE&&v.isOutline||w===y.WGLGeometryType.FILL&&n(v.symbologyType)?A&E:A&~E}t&=v;this.vvSizeMinMaxValue=!!(t&y.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(t&y.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(t&y.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=
!!(t&y.WGLVVFlag.SIZE_SCALE_STOPS)};D._createClass(u,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(t){this.setBit(16,t)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(t){this.setBit(17,t)}},{key:"vvSizeFieldStops",get:function(){return 0!==this.bit(18)},set:function(t){this.setBit(18,t)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(t){this.setBit(19,t)}}]);return u}(q),b=q=>function(p){function u(){return p.apply(this,
arguments)||this}D._inheritsLoose(u,p);var h=u.prototype;h.hasVV=function(){return p.prototype.hasVV.call(this)||this.vvRotation};h.setVV=function(t,v){p.prototype.setVV.call(this,t,v);this.vvRotation=!v.isOutline&&!!(t&y.WGLVVFlag.ROTATION)};D._createClass(u,[{key:"vvRotation",get:function(){return 0!==this.bit(15)},set:function(t){this.setBit(15,t)}}]);return u}(q),e=q=>function(p){function u(){return p.apply(this,arguments)||this}D._inheritsLoose(u,p);var h=u.prototype;h.hasVV=function(){return p.prototype.hasVV.call(this)||
this.vvColor};h.setVV=function(t,v){p.prototype.setVV.call(this,t,v);this.vvColor=!v.isOutline&&!!(t&y.WGLVVFlag.COLOR)};D._createClass(u,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(t){this.setBit(13,t)}}]);return u}(q),l=q=>function(p){function u(){return p.apply(this,arguments)||this}D._inheritsLoose(u,p);var h=u.prototype;h.hasVV=function(){return p.prototype.hasVV.call(this)||this.vvOpacity};h.setVV=function(t,v){p.prototype.setVV.call(this,t,v);this.vvOpacity=!v.isOutline&&
!!(t&y.WGLVVFlag.OPACITY)};D._createClass(u,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(t){this.setBit(14,t)}}]);return u}(q);let k=function(q){function p(){return q.apply(this,arguments)||this}D._inheritsLoose(p,q);p.load=function(u){const h=this.shared;h.data=u;return h};p.from=function(u){const {symbologyType:h,vvFlags:t}=u,v=this.load(0);v.geometryType=y.WGLGeometryType.FILL;v.symbologyType=h;h!==y.WGLSymbologyType.DOT_DENSITY&&v.setVV(t,u);return v.data};p.prototype.getVariation=
function(){return{...q.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return p}(e(l(a(d))));k.shared=new k(0);let r=function(q){function p(){return q.apply(this,arguments)||this}D._inheritsLoose(p,q);p.load=function(u){const h=this.shared;h.data=u;return h};p.from=function(u){const {symbologyType:h,vvFlags:t}=
u,v=this.load(0);v.geometryType=y.WGLGeometryType.MARKER;v.symbologyType=h;h!==y.WGLSymbologyType.HEATMAP&&v.setVV(t,u);return v.data};p.prototype.getVariation=function(){return{...q.prototype.getVariation.call(this),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return p}(e(l(b(a(d)))));r.shared=new r(0);let g=function(q){function p(){return q.apply(this,
arguments)||this}D._inheritsLoose(p,q);p.load=function(u){const h=this.shared;h.data=u;return h};p.from=function(u){const h=this.load(0);h.geometryType=y.WGLGeometryType.LINE;h.symbologyType=u.symbologyType;h.setVV(u.vvFlags,u);return h.data};p.prototype.getVariation=function(){return{...q.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};
return p}(e(l(a(d))));g.shared=new g(0);let c=function(q){function p(){return q.apply(this,arguments)||this}D._inheritsLoose(p,q);p.load=function(u){const h=this.shared;h.data=u;return h};p.from=function(u){const h=this.load(0);h.geometryType=y.WGLGeometryType.TEXT;h.symbologyType=u.symbologyType;h.setVV(u.vvFlags,u);return h.data};p.prototype.getVariation=function(){return{...q.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,
vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return p}(e(l(b(a(d)))));c.shared=new c(0);let m=function(q){function p(){return q.apply(this,arguments)||this}D._inheritsLoose(p,q);p.load=function(u){const h=this.shared;h.data=u;return h};p.from=function(u){const h=this.load(0);h.geometryType=y.WGLGeometryType.LABEL;h.symbologyType=u.symbologyType;h.setVV(u.vvFlags,u);h.mapAligned=B.isMapAligned(u.placement);return h.data};p.prototype.getVariation=
function(){return{...q.prototype.getVariation.call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return p}(a(d));m.shared=new m(0);z.FillMaterialKey=k;z.LabelMaterialKey=m;z.LineMaterialKey=g;z.MarkerMaterialKey=r;z.MaterialKeyBase=d;z.TextMaterialKey=c;z.createMaterialKey=function(q,p){switch(q){case y.WGLGeometryType.FILL:return k.from(p);case y.WGLGeometryType.LINE:return g.from(p);
case y.WGLGeometryType.MARKER:return r.from(p);case y.WGLGeometryType.TEXT:return c.from(p);case y.WGLGeometryType.LABEL:return m.from(p);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${q}`);}};z.hasOutlineFillSymbology=function(q){return n(q.symbologyType)};z.hasSimpleSymbology=function(q){return x(q.symbologyType)};z.hydrateMaterialKey=function(q){switch(d.load(q).geometryType){case y.WGLGeometryType.MARKER:return new r(q);case y.WGLGeometryType.FILL:return new k(q);
case y.WGLGeometryType.LINE:return new g(q);case y.WGLGeometryType.TEXT:return new c(q);case y.WGLGeometryType.LABEL:return new m(q)}};z.isOutlineFillSymbology=n;z.isSimpleSymbology=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(z){z.HAlign=void 0;(function(D){D[D.Left=-1]="Left";D[D.Center=0]="Center";D[D.Right=1]="Right"})(z.HAlign||(z.HAlign={}));z.VAlign=void 0;(function(D){D[D.Top=
1]="Top";D[D.Center=0]="Center";D[D.Bottom=-1]="Bottom";D[D.Baseline=2]="Baseline"})(z.VAlign||(z.VAlign={}));z.getAlignmentFromPlacement=function(D){switch(D){case "above-left":case "esriServerPointLabelPlacementAboveLeft":return[z.HAlign.Right,z.VAlign.Bottom];case "above-center":case "above-along":case "esriServerPointLabelPlacementAboveCenter":case "esriServerLinePlacementAboveAlong":return[z.HAlign.Center,z.VAlign.Bottom];case "above-right":case "esriServerPointLabelPlacementAboveRight":return[z.HAlign.Left,
z.VAlign.Bottom];case "center-left":case "esriServerPointLabelPlacementCenterLeft":return[z.HAlign.Right,z.VAlign.Center];case "center-center":case "center-along":case "esriServerPointLabelPlacementCenterCenter":case "esriServerLinePlacementCenterAlong":return[z.HAlign.Center,z.VAlign.Center];case "center-right":case "esriServerPointLabelPlacementCenterRight":return[z.HAlign.Left,z.VAlign.Center];case "below-left":case "esriServerPointLabelPlacementBelowLeft":return[z.HAlign.Right,z.VAlign.Top];case "below-center":case "below-along":case "esriServerPointLabelPlacementBelowCenter":case "esriServerLinePlacementBelowAlong":return[z.HAlign.Center,
z.VAlign.Top];case "below-right":case "esriServerPointLabelPlacementBelowRight":return[z.HAlign.Left,z.VAlign.Top];case "always-horizontal":case "esriServerPolygonPlacementAlwaysHorizontal":return[z.HAlign.Center,z.VAlign.Center];default:return console.debug(`Found invalid placement type ${D}`),[z.HAlign.Center,z.VAlign.Center]}};z.getJustification=function(D){switch(D){case "left":return z.HAlign.Left;case "right":return z.HAlign.Right;case "center":return z.HAlign.Center}};z.getXAnchorDirection=
function(D){switch(D){case "left":return z.HAlign.Left;case "right":return z.HAlign.Right;case "center":return z.HAlign.Center}};z.getXDirection=function(D){switch(D){case z.HAlign.Right:return-1;case z.HAlign.Center:return 0;case z.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${D}`),0}};z.getYAnchorDirection=function(D){switch(D){case "top":return z.VAlign.Top;case "middle":return z.VAlign.Center;case "baseline":return z.VAlign.Baseline;case "bottom":return z.VAlign.Bottom}};
z.getYDirection=function(D){switch(D){case z.VAlign.Top:return 1;case z.VAlign.Center:return 0;case z.VAlign.Bottom:case z.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${D}`),0}};z.isMapAligned=function(D){switch(D){case "above-along":case "below-along":case "center-along":case "esriServerLinePlacementAboveAlong":case "esriServerLinePlacementBelowAlong":case "esriServerLinePlacementCenterAlong":return!0;default:return!1}};Object.defineProperties(z,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/techniques/utils":function(){define("exports ../../../../../core/Error ../enums ../materialKey/MaterialKey ./Technique ./dotDensity/TechniqueDotDensity ./heatmap/TechniqueHeatmap ./pieChart/TechniquePieChart".split(" "),function(z,D,C,B,y,x,n,f){z.assertRendererSchema=function(d,a){if(d.type!==a)throw new D("material-view-model:unexpected-renderer-schema",`expected to find renderer schema of type "${a}" but found type "${d.type}"`);
};z.getTechniqueFromMaterialKey=function(d){const {geometryType:a,symbologyType:b}=B.MaterialKeyBase.load(d);switch(a){case C.WGLGeometryType.FILL:switch(b){case C.WGLSymbologyType.DOT_DENSITY:return x.DotDensityTechnique}break;case C.WGLGeometryType.MARKER:switch(b){case C.WGLSymbologyType.HEATMAP:return n.HeatmapTechnique;case C.WGLSymbologyType.PIE_CHART:return f.PieChartTechnique}}return y.Technique};z.getTechniqueFromRenderer=function(d){switch(d.type){case "dot-density":return x.DotDensityTechnique;
case "heatmap":return n.HeatmapTechnique;case "pie-chart":return f.PieChartTechnique;default:return y.Technique}};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/techniques/Technique":function(){define(["exports","../../../../../core/maybe"],function(z,D){let C=function(){function B(){}B.getStorageSpec=function(y){return null};B.createOrUpdateRendererSchema=function(y,x){return D.isSome(y)&&"default"===y.type?y:{type:"default"}};
B.getVariation=function(y){return{}};B.getVariationHash=function(y){return 0};return B}();C.type="default";C.programSpec=null;z.Technique=C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/techniques/dotDensity/TechniqueDotDensity":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../color ../../definitions ../Technique ../../../../../webgl/enums".split(" "),function(z,
D,C,B,y,x,n){x=function(f){function d(){return f.apply(this,arguments)||this}D._inheritsLoose(d,f);d.getStorageSpec=function({attributes:a}){return{visualVariables:!1,attributes:null!=a?a:null}};d._createRendererSchema=function(){return{type:"dot-density",colors:new Float32Array(32),dotValue:-1,dotSize:-1,dotScale:-1,dotBlending:!1,backgroundColor:new Float32Array(4),activeDots:new Float32Array(8),seed:-1}};d.createOrUpdateRendererSchema=function(a,b){const {attributes:e,dotValue:l,referenceScale:k,
dotSize:r,dotBlendingEnabled:g,seed:c,backgroundColor:m}=b;a=C.isSome(a)&&"dot-density"===a.type?a:this._createRendererSchema();a.dotValue=l;a.dotSize=r;a.dotScale=k;a.dotBlending=g;a.seed=c;const {colors:q,activeDots:p,backgroundColor:u}=a;for(var h=0;h<y.DOT_DENSITY_MAX_FIELDS;h++)B.writeColor(q,h>=e.length?null:e[h].color,4*h);for(h=0;8>h;h++)p[h]=h<b.attributes.length?1:0;B.writeColor(u,m);return a};d.getVariation=function(a){return{ddDotBlending:a.dotBlending}};d.getVariationHash=function(a){return a.dotBlending?
1:0};return d}(x.Technique);x.type="dot-density";x.programSpec={shader:"materials/fill",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:n.DataType.SHORT},{location:1,name:"a_id",count:3,type:n.DataType.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:n.DataType.UNSIGNED_BYTE},{location:3,name:"a_inverseArea",count:1,type:n.DataType.FLOAT}]}};z.DotDensityTechnique=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/techniques/heatmap/TechniqueHeatmap":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../renderers/support/heatmapUtils ../Technique ../../../../../webgl/enums".split(" "),
function(z,D,C,B,y,x,n){x=function(f){function d(){return f.apply(this,arguments)||this}D._inheritsLoose(d,f);d.getStorageSpec=function({field:a,valueExpression:b}){return{visualVariables:!1,attributes:a||b?[{field:a,valueExpression:b}]:null}};d._createRendererSchema=function(){return{type:"heatmap",radius:-1,referenceScale:-1,isFieldActive:0,minDensity:-1,densityRange:-1,kernel:null,gradient:null,gradientHash:"invalid"}};d.createOrUpdateRendererSchema=function(a,b){const {radius:e,minDensity:l,maxDensity:k,
referenceScale:r,field:g,valueExpression:c,colorStops:m}=b;b=k-l;const q=g||c?1:0,p=m.map(({color:t,ratio:v})=>`${v}:${t.toString()}`).join();let u=!0,h;C.isSome(a)&&"heatmap"===a.type?(h=a,u=p!==a.gradientHash):h=this._createRendererSchema();h.radius=B.pt2px(e);h.minDensity=l;h.densityRange=b;h.referenceScale=r;h.isFieldActive=q;u&&(h.gradient=y.generateGradient(m),h.gradientHash=p);return h};return d}(x.Technique);x.type="heatmap";x.programSpec={shader:"materials/icon/heatmapAccumulate",vertexLayout:{geometry:[{location:0,
name:"a_pos",count:2,type:n.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:n.DataType.SHORT},{location:4,name:"a_id",count:4,type:n.DataType.UNSIGNED_BYTE}]}};z.HeatmapTechnique=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/techniques/pieChart/TechniquePieChart":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../Color ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../Technique ../../../../../webgl/enums".split(" "),
function(z,D,C,B,y,x,n,f,d){f=function(a){function b(){return a.apply(this,arguments)||this}D._inheritsLoose(b,a);b.getStorageSpec=function({attributes:e}){return{visualVariables:!0,attributes:null!=e?e:null}};b._createRendererSchema=function(){return{type:"pie-chart",colors:new Float32Array(4*n.CHART_MAX_FIELDS),defaultColor:new Float32Array(4),othersColor:new Float32Array(4),outlineColor:new Float32Array(4),holePercentage:0,sectorThreshold:0,outlineWidth:1,numberOfFields:10}};b.createOrUpdateRendererSchema=
function(e,l){const {attributes:k,defaultColor:r,holePercentage:g,othersCategory:c,outline:m}=l;e=B.isSome(e)&&"pie-chart"===e.type?e:this._createRendererSchema();for(l=0;l<n.CHART_MAX_FIELDS;l++){const q=l>=k.length?new C([0,0,0,0]):k[l].color;x.writeColor(e.colors,q,4*l)}x.writeColor(e.defaultColor,r);x.writeColor(e.othersColor,null==c?void 0:c.color);x.writeColor(e.outlineColor,null==m?void 0:m.color);e.outlineWidth=y.pt2px((null==m?void 0:m.width)||0);e.holePercentage=g;e.sectorThreshold=(null==
c?void 0:c.threshold)||0;e.numberOfFields=k.length;return e};b.getVariation=function(e){return{numberOfFields:e.numberOfFields}};b.getVariationHash=function(e){return e.numberOfFields};return b}(f.Technique);f.type="pie-chart";f.programSpec={shader:"materials/pie",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:d.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:d.DataType.SHORT},{location:2,name:"a_texCoords",count:2,type:d.DataType.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",
count:2,type:d.DataType.UNSIGNED_SHORT},{location:4,name:"a_id",count:4,type:d.DataType.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:d.DataType.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:d.DataType.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:d.DataType.UNSIGNED_BYTE},{location:8,name:"a_zoomRange",count:2,type:d.DataType.UNSIGNED_SHORT}]},hittestAttributes:["a_vertexOffset","a_texCoords"]};z.PieChartTechnique=f;Object.defineProperties(z,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushHeatmap":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Logger ../../../../../core/maybe ../enums ../VertexStream ./WGLGeometryBrushMarker ../techniques/utils ../../../../webgl/context-util ../../../../webgl/enums ../../../../webgl/FramebufferObject ../../../../webgl/Texture".split(" "),function(z,D,C,B,y,x,n,f,d,a,b){const e=D.getLogger("esri.views.2d.engine.webgl.brushes.WGLBrushHeatmap"),
l={vsPath:"heatmap/heatmapResolve",fsPath:"heatmap/heatmapResolve",attributes:new Map([["a_position",0]])};return function(k){function r(){return k.apply(this,arguments)||this}z._inheritsLoose(r,k);var g=r.prototype;g.supportsSymbology=function(c){return c===B.WGLSymbologyType.HEATMAP};g.dispose=function(){k.prototype.dispose.call(this);this._accumulateOutputTexture=C.disposeMaybe(this._accumulateOutputTexture);this._accumulateFramebuffer=C.disposeMaybe(this._accumulateFramebuffer);this._resolveGradientTexture=
C.disposeMaybe(this._resolveGradientTexture);this._tileQuad=C.disposeMaybe(this._tileQuad)};g.drawGeometry=function(c,m,q,p){const {defines:u}=this._loadQualityProfile(c.context);k.prototype.drawGeometry.call(this,c,m,q,p?[...p,...u]:u)};g._drawMarkers=function(c,m,q,p,u,h,t){const {context:v}=c,w=v.getBoundFramebufferObject(),A=v.getViewport();this._prepareAccumulatePass(c,m,q,t);v.drawElements(p,u,d.DataType.UNSIGNED_INT,h);t||this._drawResolvePass(c,m,w,A)};g._prepareAccumulatePass=function(c,
m,q,p){const {context:u,rendererInfo:h,state:t,displayLevel:v}=c;({rendererSchema:c}=h);n.assertRendererSchema(c,"heatmap");const {referenceScale:w,radius:A,isFieldActive:E}=c;this._loadResources(u);this._updateResources(c);q.setUniform1f("u_radius",A*(0!==w?w/t.scale:1)*2**(m.key.level-v));p||(u.bindFramebuffer(this._accumulateFramebuffer),q.setUniform1f("u_isFieldActive",E),u.setViewport(0,0,this._accumulateFramebuffer.width,this._accumulateFramebuffer.height),u.setBlendingEnabled(!0),u.setBlendFunction(d.BlendFactor.ONE,
d.BlendFactor.ONE),u.setClearColor(0,0,0,0),u.clear(d.ClearBufferBit.COLOR_BUFFER_BIT))};g._drawResolvePass=function(c,m,q,p){const {context:u,painter:h,rendererInfo:t}=c;var {rendererSchema:v}=t;n.assertRendererSchema(v,"heatmap");const {radius:w,minDensity:A,densityRange:E}=v;({defines:v}=this._loadQualityProfile(u));v=h.materialManager.getProgram(l,v);u.useProgram(v);this._setSharedUniforms(v,c,m);u.bindFramebuffer(q);u.setViewport(0,0,p.width,p.height);u.setBlendFunction(d.BlendFactor.ONE,d.BlendFactor.ONE_MINUS_SRC_ALPHA);
u.bindTexture(this._accumulateOutputTexture,8);u.bindTexture(this._resolveGradientTexture,9);v.setUniform1i("u_texture",8);v.setUniform1i("u_gradient",9);v.setUniform2f("u_densityMinAndInvRange",A,1/E);v.setUniform1f("u_densityNormalization",3/(w*w*Math.PI));this._tileQuad.draw()};g._loadResources=function(c){var m,q,p,u;const h=c.type===f.ContextType.WEBGL2,{dataType:t,samplingMode:v,shadingRate:w}=this._loadQualityProfile(c);null!=(m=this._accumulateOutputTexture)?m:this._accumulateOutputTexture=
new b.Texture(c,{target:d.TextureType.TEXTURE_2D,pixelFormat:h?d.PixelFormat.RED:d.PixelFormat.RGBA,internalFormat:h?t===d.PixelType.FLOAT?d.SizedPixelFormat.R32F:d.SizedPixelFormat.R16F:d.PixelFormat.RGBA,dataType:t,samplingMode:v,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE,width:Math.round(512*w),height:Math.round(512*w)});null!=(q=this._accumulateFramebuffer)?q:this._accumulateFramebuffer=new a.FramebufferObject(c,{},this._accumulateOutputTexture);null!=(p=this._resolveGradientTexture)?p:this._resolveGradientTexture=
new b.Texture(c,{target:d.TextureType.TEXTURE_2D,pixelFormat:d.PixelFormat.RGBA,dataType:d.PixelType.UNSIGNED_BYTE,samplingMode:d.TextureSamplingMode.LINEAR,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE});null!=(u=this._tileQuad)?u:this._tileQuad=new y(c,[0,0,1,0,0,1,1,1])};g._updateResources=function(c){const {gradientHash:m,gradient:q}=c;this._prevGradientHash!==m&&(this._resolveGradientTexture.resize(q.length/4,1),this._resolveGradientTexture.setData(q),this._prevGradientHash=m)};g._loadQualityProfile=
function(c){if(C.isNone(this._qualityProfile)){const {textureFloat:m,colorBufferFloat:q}=c.capabilities,{textureFloat:p,textureFloatLinear:u,textureHalfFloat:h,textureHalfFloatLinear:t,HALF_FLOAT:v}=m,{textureFloat:w,textureHalfFloat:A,floatBlend:E}=q;let G,F;c=p&&w&&E;const H=h&&A;c&&u?(G=d.PixelType.FLOAT,F=d.TextureSamplingMode.LINEAR):H&&t?(G=v,F=d.TextureSamplingMode.LINEAR):c?(G=d.PixelType.FLOAT,F=d.TextureSamplingMode.NEAREST):H?(G=v,F=d.TextureSamplingMode.NEAREST):e.error("Missing webgl extensions for heatmap!");
F===d.TextureSamplingMode.NEAREST&&e.warnOnce("Missing linear filtering webgl extension(s). Heatmap quality may be reduced.");this._qualityProfile={dataType:G,samplingMode:F,shadingRate:.5,defines:G===v?["heatmapPrecisionHalfFloat"]:[]}}return this._qualityProfile};return r}(x)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../techniques/utils ../../../../webgl/enums".split(" "),
function(z,D,C,B,y,x,n,f){const d={shader:"materials/icon",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:f.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:f.DataType.SHORT},{location:2,name:"a_texCoords",count:2,type:f.DataType.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",count:2,type:f.DataType.UNSIGNED_SHORT},{location:4,name:"a_id",count:4,type:f.DataType.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:f.DataType.UNSIGNED_BYTE,normalized:!0},{location:6,
name:"a_outlineColor",count:4,type:f.DataType.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:f.DataType.UNSIGNED_BYTE},{location:8,name:"a_zoomRange",count:2,type:f.DataType.UNSIGNED_SHORT}]},hittestAttributes:["a_vertexOffset","a_texCoords"]};return function(a){function b(){return a.apply(this,arguments)||this}z._inheritsLoose(b,a);var e=b.prototype;e.dispose=function(){};e.getGeometryType=function(){return C.WGLGeometryType.MARKER};e.supportsSymbology=function(l){return l!==
C.WGLSymbologyType.HEATMAP&&l!==C.WGLSymbologyType.PIE_CHART};e.drawGeometry=function(l,k,r,g){const {context:c,painter:m,rendererInfo:q,state:p,passOptions:u,requestRender:h}=l;var t=x.MarkerMaterialKey.load(r.materialKey),v=n.getTechniqueFromMaterialKey(t.data);const w=D.isSome(u)&&"hittest"===u.type,{shader:A,vertexLayout:E,hittestAttributes:G}=D.unwrapOr(v.programSpec,d);v=f.PrimitiveType.TRIANGLES;var F=B.createProgramDescriptor(t.data,E);w&&(F=this._getTriangleDesc(r.materialKey,F,G),v=f.PrimitiveType.POINTS);
const {attributes:H,bufferLayouts:J}=F;g=m.materialManager.getMaterialProgram(l,t,A,H,g);!D.isSome(h)||w||g.isCompiled?(c.useProgram(g),t.textureBinding&&m.textureManager.bindTextures(c,g,t,!0),this._setSharedUniforms(g,l,k),g.setUniformMatrix3fv("u_displayMat3",t.vvRotation?p.displayViewMat3:p.displayMat3),this._setSizeVVUniforms(t,g,q,k),this._setColorAndOpacityVVUniforms(t,g,q),this._setRotationVVUniforms(t,g,q),t=r.target.getVAO(c,J,H,w),F=r.indexCount,r=r.indexFrom*Uint32Array.BYTES_PER_ELEMENT,
w&&(F/=3,r/=3),c.bindVAO(t),this._drawMarkers(l,k,g,v,F,r,w),c.bindVAO(null)):h()};e._drawMarkers=function(l,k,r,g,c,m,q){l.context.drawElements(g,c,f.DataType.UNSIGNED_INT,m)};return b}(y)})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../DefaultVertexAttributeLayouts ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/ProgramTemplate ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e){return function(l){function k(){var g=l.apply(this,arguments)||this;g._color=C.fromValues(1,0,0,1);return g}z._inheritsLoose(k,l);var r=k.prototype;r.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&
(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null);this._canvas=null};r.prepareState=function({context:g}){g.setBlendingEnabled(!0);g.setBlendFunctionSeparate(d.BlendFactor.ONE,d.BlendFactor.ONE_MINUS_SRC_ALPHA,d.BlendFactor.ONE,d.BlendFactor.ONE_MINUS_SRC_ALPHA);g.setColorMask(!0,!0,!0,!0);g.setStencilWriteMask(0);g.setStencilTestEnabled(!1)};r.draw=function(g,c){const {context:m,requestRender:q}=g;if(c.isReady)if(this._loadWGLResources(m),!D.isSome(q)||this._outlineProgram.isCompiled&&
this._tileInfoProgram.isCompiled){m.bindVAO(this._outlineVertexArrayObject);m.useProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",c.rangeX,c.rangeY);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);m.drawArrays(d.PrimitiveType.LINE_STRIP,0,4);if(g=this._getTexture(m,c))m.bindVAO(this._tileInfoVertexArrayObject),m.useProgram(this._tileInfoProgram),
m.bindTexture(g,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",c.rangeX/c.width,c.rangeY/c.height),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",g.descriptor.width,g.descriptor.height),m.drawArrays(d.PrimitiveType.TRIANGLE_STRIP,0,4);m.bindVAO()}else q()};r._loadWGLResources=function(g){if(!this._outlineProgram||!this._tileInfoProgram){var c=
a.createProgram(g,x.background),m=a.createProgram(g,n.tileInfo),q=new Int8Array([0,0,1,0,1,1,0,1]);q=f.BufferObject.createVertex(g,d.Usage.STATIC_DRAW,q);q=new e.VertexArrayObject(g,x.background.attributes,B.Pos2b,{geometry:q});var p=new Int8Array([0,0,1,0,0,1,1,1]);p=f.BufferObject.createVertex(g,d.Usage.STATIC_DRAW,p);g=new e.VertexArrayObject(g,n.tileInfo.attributes,B.Pos2b,{geometry:p});this._outlineProgram=c;this._tileInfoProgram=m;this._outlineVertexArrayObject=q;this._tileInfoVertexArrayObject=
g}};r._getTexture=function(g,c){if(c.texture&&c.triangleCountReportedInDebug===c.triangleCount)return c.texture;c.triangleCountReportedInDebug=c.triangleCount;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));const m=c.triangleCount;let q=c.key.id;0<c.triangleCount&&(q+=`, ${m}`);const p=this._canvas,u=p.getContext("2d");
u.font="24px sans-serif";u.textAlign="left";u.textBaseline="top";u.clearRect(0,0,300,32);1E5<m?(u.fillStyle="red",u.fillRect(0,0,300,32),u.fillStyle="black"):(u.clearRect(0,0,300,32),u.fillStyle="blue");u.fillText(q,0,0);c.texture=new b.Texture(g,{target:d.TextureType.TEXTURE_2D,pixelFormat:d.PixelFormat.RGBA,dataType:d.PixelType.UNSIGNED_BYTE,samplingMode:d.TextureSamplingMode.NEAREST,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE},p);return c.texture};return k}(y)})},"esri/views/2d/engine/webgl/DefaultVertexAttributeLayouts":function(){define(["exports",
"../../../webgl/enums","../../../webgl/VertexElementDescriptor"],function(z,D,C){const B={geometry:[new C.VertexElementDescriptor("a_pos",2,D.DataType.BYTE,0,2)]},y={geometry:[new C.VertexElementDescriptor("a_pos",2,D.DataType.BYTE,0,4),new C.VertexElementDescriptor("a_tex",2,D.DataType.BYTE,2,4)]};D={geometry:[new C.VertexElementDescriptor("a_pos",2,D.DataType.UNSIGNED_SHORT,0,4)]};z.Pos2b=B;z.Pos2us=D;z.PosTex2b=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["exports","./sources/resolver"],function(z,D){D={shaders:{vertexShader:D.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:D.resolveIncludes("tileInfo/tileInfo.frag")},attributes:new Map([["a_pos",0]])};z.tileInfo=D;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushPieChart":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../enums","./WGLGeometryBrushMarker","../techniques/utils","../../../../webgl/enums"],function(z,D,C,B,y){return function(x){function n(){return x.apply(this,arguments)||this}z._inheritsLoose(n,x);var f=n.prototype;f.supportsSymbology=function(d){return d===D.WGLSymbologyType.PIE_CHART};f._drawMarkers=function(d,a,b,e,l,k,r){({context:a}=d);({rendererInfo:d}=d);({rendererSchema:d}=d);B.assertRendererSchema(d,"pie-chart");b.setUniform4fv("u_colors",d.colors);b.setUniform4fv("u_defaultColor",d.defaultColor);
b.setUniform4fv("u_othersColor",d.othersColor);b.setUniform4fv("u_outlineColor",d.outlineColor);b.setUniform1f("u_donutRatio",d.holePercentage);b.setUniform1f("u_sectorThreshold",d.sectorThreshold);b.setUniform1f("u_outlineWidth",d.outlineWidth);a.drawElements(e,l,y.DataType.UNSIGNED_INT,k)};return n}(C)})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../DefaultVertexAttributeLayouts ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/ProgramTemplate ../../../../webgl/VertexArrayObject".split(" "),
function(z,D,C,B,y,x,n,f,d,a){return function(b){function e(){var k=b.apply(this,arguments)||this;k._color=C.fromValues(1,0,0,1);k._initialized=!1;return k}z._inheritsLoose(e,b);var l=e.prototype;l.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};l.prepareState=function({context:k},r){k.setDepthWriteEnabled(!1);k.setDepthTestEnabled(!1);k.setStencilTestEnabled(!0);
k.setBlendingEnabled(!1);k.setColorMask(!1,!1,!1,!1);k.setStencilOp(f.StencilOperation.KEEP,f.StencilOperation.KEEP,f.StencilOperation.REPLACE);k.setStencilWriteMask(255);k.setStencilFunctionSeparate(f.Face.FRONT_AND_BACK,f.CompareFunction.GREATER,r.stencilRef,255)};l.draw=function(k,r){const {context:g,requestRender:c}=k;this._initialized||this._initialize(g);D.isSome(c)&&!this._solidProgram.isCompiled?c():(g.bindVAO(this._solidVertexArrayObject),g.useProgram(this._solidProgram),this._solidProgram.setUniformMatrix3fv("u_dvsMat3",
r.transforms.dvs),this._solidProgram.setUniform2fv("u_coord_range",[r.rangeX,r.rangeY]),this._solidProgram.setUniform1f("u_depth",0),this._solidProgram.setUniform4fv("u_color",this._color),g.drawArrays(f.PrimitiveType.TRIANGLE_STRIP,0,4),g.bindVAO())};l._initialize=function(k){if(this._initialized)return!0;const r=d.createProgram(k,x.background);if(!r)return!1;var g=new Int8Array([0,0,1,0,0,1,1,1]);g=n.BufferObject.createVertex(k,f.Usage.STATIC_DRAW,g);k=new a.VertexArrayObject(k,x.background.attributes,
B.Pos2b,{geometry:g});this._solidProgram=r;this._solidVertexArrayObject=k;return this._initialized=!0};return e}(y)})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../chunks/mat3f32 ../../../../../chunks/vec4f32 ../definitions ../enums ../number ./WGLBrush ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/VertexArrayObject".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l){a=function(k){function r(){var c=k.apply(this,arguments)||this;c._color=x.fromValues(1,0,0,1);c._patternMatrix=y.create();c._programOptions={id:!1,pattern:!1};return c}D._inheritsLoose(r,k);var g=r.prototype;g.dispose=function(){this._vao&&(this._vao.dispose(),this._vao=null)};g.drawMany=function(c,m){const {context:q,painter:p,styleLayerUID:u,requestRender:h}=c;this._loadWGLResources(c);const t=c.displayLevel;var v=c.styleLayer,w=v.backgroundMaterial;const A=p.vectorTilesMaterialManager;
var E=v.getPaintValue("background-color",t);const G=v.getPaintValue("background-opacity",t),F=v.getPaintValue("background-pattern",t),H=void 0!==F,J=E[3]*G,I=c.spriteMosaic;let N,M;const K=(window.devicePixelRatio|1)>n.VTL_HIGH_RES_CUTOFF?2:1;c=c.drawPhase===f.WGLDrawPhase.HITTEST;const O=this._programOptions;O.id=c;O.pattern=H;w=A.getMaterialProgram(q,w,O);if(!B.isSome(h)||c||w.isCompiled){q.bindVAO(this._vao);q.useProgram(w);if(H){E=I.getMosaicItemPosition(F,!0);if(B.isSome(E)){const {tl:X,br:aa,
page:ba}=E;N=aa[0]-X[0];M=aa[1]-X[1];E=I.getPageSize(ba);B.isSome(E)&&(I.bind(q,e.TextureSamplingMode.LINEAR,ba,n.VTL_TEXTURE_BINDING_UNIT_SPRITES),w.setUniform4f("u_tlbr",X[0],X[1],aa[0],aa[1]),w.setUniform2fv("u_mosaicSize",E),w.setUniform1i("u_texture",n.VTL_TEXTURE_BINDING_UNIT_SPRITES))}w.setUniform1f("u_opacity",G)}else this._color[0]=J*E[0],this._color[1]=J*E[1],this._color[2]=J*E[2],this._color[3]=J,w.setUniform4fv("u_color",this._color);w.setUniform1f("u_depth",v.z||0);c&&(v=d.u32to4Xu8(u+
1),w.setUniform4fv("u_id",v));for(const X of m)w.setUniform1f("u_coord_range",X.rangeX),w.setUniformMatrix3fv("u_dvsMat3",X.transforms.dvs),H&&(v=K*X.width*Math.max(2**(Math.round(t)-X.key.level),1),m=v/C.nextPowerOfTwo(N),v/=C.nextPowerOfTwo(M),this._patternMatrix[0]=m,this._patternMatrix[4]=v,w.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),q.setStencilFunction(e.CompareFunction.EQUAL,X.stencilRef,255),q.drawArrays(e.PrimitiveType.TRIANGLE_STRIP,0,4)}else h()};g._loadWGLResources=
function(c){if(!this._vao){var {context:m,styleLayer:q}=c;c=q.backgroundMaterial;var p=new Int8Array([0,0,1,0,0,1,1,1]);p=b.BufferObject.createVertex(m,e.Usage.STATIC_DRAW,p);this._vao=new l.VertexArrayObject(m,c.getAttributeLocations(),c.getLayoutInfo(),{geometry:p})}};return r}(a);z.WGLBrushVTLBackground=a;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(z,D,C,B,y,x,n,f){n=function(d){function a(){var e=d.apply(this,arguments)||this;e._programOptions={id:!1};return e}D._inheritsLoose(a,d);var b=a.prototype;b.dispose=function(){};b.drawMany=function(e,l){const {context:k,displayLevel:r,requiredLevel:g,state:c,drawPhase:m,painter:q,spriteMosaic:p,styleLayerUID:u,requestRender:h}=e;if(l.some(F=>{var H,J;return null!=(H=null==(J=F.layerData.get(u))?void 0:J.circleIndexCount)?H:!1})){e=e.styleLayer;var t=e.circleMaterial,v=q.vectorTilesMaterialManager,
w=e.getPaintValue("circle-translate",r),A=e.getPaintValue("circle-translate-anchor",r),E=m===y.WGLDrawPhase.HITTEST,G=this._programOptions;G.id=E;v=v.getMaterialProgram(k,t,G);if(E||!C.isSome(h)||v.isCompiled){k.useProgram(v);v.setUniformMatrix3fv("u_displayMat3",A===B.TranslateAnchor.VIEWPORT?c.displayMat3:c.displayViewMat3);v.setUniform2fv("u_circleTranslation",w);v.setUniform1f("u_depth",e.z);v.setUniform1f("u_antialiasingWidth",1.2);w=-1;E&&(E=x.u32to4Xu8(u+1),v.setUniform4fv("u_id",E));for(const F of l)F.layerData.has(u)&&
(F.key.level!==w&&(w=F.key.level,t.setDataUniforms(v,r,e,w,p)),l=F.layerData.get(u),l.circleIndexCount&&(l.prepareForRendering(k),E=l.circleVertexArrayObject,C.isNone(E)||(k.bindVAO(E),v.setUniformMatrix3fv("u_dvsMat3",F.transforms.dvs),g!==F.key.level?k.setStencilFunction(f.CompareFunction.EQUAL,F.stencilRef,255):k.setStencilFunction(f.CompareFunction.GREATER,255,255),k.drawElements(f.PrimitiveType.TRIANGLES,l.circleIndexCount,f.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*l.circleIndexStart),
F.triangleCount+=l.circleIndexCount/3)))}else h()}};return a}(n);z.WGLBrushVTLCircle=n;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),function(z,D,C,B,y,x,n,f,d){const a=1/65536;f=function(b){function e(){var k=
b.apply(this,arguments)||this;k._fillProgramOptions={id:!1,pattern:!1};k._outlineProgramOptions={id:!1};return k}D._inheritsLoose(e,b);var l=e.prototype;l.dispose=function(){};l.drawMany=function(k,r){const {displayLevel:g,drawPhase:c,renderPass:m,spriteMosaic:q,styleLayerUID:p}=k;var u=!1;for(var h of r)if(h.layerData.has(p)){var t=h.layerData.get(p);if(0<t.fillIndexCount||0<t.outlineIndexCount){u=!0;break}}if(u){u=k.styleLayer;var v=u.getPaintProperty("fill-pattern");t=(h=void 0!==v)&&v.isDataDriven;
if(h&&!t){var w=v.getValue(g);w=q.getMosaicItemPosition(w,!0)}v=!h&&u.getPaintValue("fill-antialias",g);var A=!0,E=1;if(!h){var G=u.getPaintProperty("fill-color"),F=u.getPaintProperty("fill-opacity");null!=G&&G.isDataDriven||null!=F&&F.isDataDriven||(E=u.getPaintValue("fill-color",g),E=u.getPaintValue("fill-opacity",g)*E[3],1<=E&&(A=!1))}if(!A||"opaque"!==m){var H;c===x.WGLDrawPhase.HITTEST&&(H=n.u32to4Xu8(p+1));G=u.getPaintValue("fill-translate",g);F=u.getPaintValue("fill-translate-anchor",g);(A||
"translucent"!==m)&&this._drawFill(k,p,u,r,G,F,h,w,t,H);w=!u.hasDataDrivenOutlineColor&&u.outlineUsesFillColor&&1>E;v&&"opaque"!==m&&!w&&this._drawOutline(k,p,u,r,G,F,H)}}};l._drawFill=function(k,r,g,c,m,q,p,u,h,t){if(!p||h||!C.isNone(u)){var {context:v,displayLevel:w,state:A,drawPhase:E,painter:G,pixelRatio:F,spriteMosaic:H,requestRender:J}=k;k=g.fillMaterial;var I=G.vectorTilesMaterialManager,N=F>y.VTL_HIGH_RES_CUTOFF?2:1,M=E===x.WGLDrawPhase.HITTEST,K=this._fillProgramOptions;K.id=M;K.pattern=
p;I=I.getMaterialProgram(v,k,K);if(!C.isSome(J)||M||I.isCompiled){v.useProgram(I);C.isSome(u)&&({page:u}=u,K=H.getPageSize(u),C.isSome(K)&&(H.bind(v,d.TextureSamplingMode.LINEAR,u,y.VTL_TEXTURE_BINDING_UNIT_SPRITES),I.setUniform2fv("u_mosaicSize",K),I.setUniform1i("u_texture",y.VTL_TEXTURE_BINDING_UNIT_SPRITES)));I.setUniformMatrix3fv("u_displayMat3",q===B.TranslateAnchor.VIEWPORT?A.displayMat3:A.displayViewMat3);I.setUniform2fv("u_fillTranslation",m);I.setUniform1f("u_depth",g.z+a);M&&I.setUniform4fv("u_id",
t);m=-1;for(const O of c)if(O.layerData.has(r)&&(O.key.level!==m&&(m=O.key.level,k.setDataUniforms(I,w,g,m,H)),c=O.layerData.get(r),c.fillIndexCount&&(c.prepareForRendering(v),q=c.fillVertexArrayObject,!C.isNone(q)))){v.bindVAO(q);I.setUniformMatrix3fv("u_dvsMat3",O.transforms.dvs);v.setStencilFunction(d.CompareFunction.EQUAL,O.stencilRef,255);p&&I.setUniform1f("u_patternFactor",O.rangeX/(N*O.width*Math.max(2**(Math.round(w)-O.key.level),1)));if(h){q=c.patternMap;if(!q)continue;for(const [X,aa]of q)q=
H.getPageSize(X),C.isSome(q)&&(H.bind(v,d.TextureSamplingMode.LINEAR,X,y.VTL_TEXTURE_BINDING_UNIT_SPRITES),I.setUniform2fv("u_mosaicSize",q),I.setUniform1i("u_texture",y.VTL_TEXTURE_BINDING_UNIT_SPRITES),v.drawElements(d.PrimitiveType.TRIANGLES,aa[1],d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*aa[0]))}else v.drawElements(d.PrimitiveType.TRIANGLES,c.fillIndexCount,d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*c.fillIndexStart);O.triangleCount+=c.fillIndexCount/3}}else J()}};l._drawOutline=
function(k,r,g,c,m,q,p){const {context:u,displayLevel:h,state:t,drawPhase:v,painter:w,pixelRatio:A,spriteMosaic:E,requestRender:G}=k;k=g.outlineMaterial;var F=w.vectorTilesMaterialManager;const H=.75/A,J=v===x.WGLDrawPhase.HITTEST,I=this._outlineProgramOptions;I.id=J;F=F.getMaterialProgram(u,k,I);if(!C.isSome(G)||J||F.isCompiled){u.useProgram(F);F.setUniformMatrix3fv("u_displayMat3",q===B.TranslateAnchor.VIEWPORT?t.displayMat3:t.displayViewMat3);F.setUniform2fv("u_fillTranslation",m);F.setUniform1f("u_depth",
g.z+a);F.setUniform1f("u_outline_width",H);J&&F.setUniform4fv("u_id",p);m=-1;for(const N of c)N.layerData.has(r)&&(N.key.level!==m&&(m=N.key.level,k.setDataUniforms(F,h,g,m,E)),c=N.layerData.get(r),c.prepareForRendering(u),c.outlineIndexCount&&(q=c.outlineVertexArrayObject,C.isNone(q)||(u.bindVAO(q),F.setUniformMatrix3fv("u_dvsMat3",N.transforms.dvs),u.setStencilFunction(d.CompareFunction.EQUAL,N.stencilRef,255),u.drawElements(d.PrimitiveType.TRIANGLES,c.outlineIndexCount,d.DataType.UNSIGNED_INT,
Uint32Array.BYTES_PER_ELEMENT*c.outlineIndexStart),N.triangleCount+=c.outlineIndexCount/3)))}else G()};return e}(f);z.WGLBrushVTLFill=f;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(z,D,C,B,y,x,n,f,d){f=function(a){function b(){var l=a.apply(this,arguments)||this;l._programOptions={id:!1,pattern:!1,sdf:!1};return l}D._inheritsLoose(b,a);var e=b.prototype;e.dispose=function(){};e.drawMany=function(l,k){const {context:r,displayLevel:g,state:c,drawPhase:m,painter:q,pixelRatio:p,spriteMosaic:u,styleLayerUID:h,requestRender:t}=l;if(k.some(O=>{var X,aa;return null!=(X=null==(aa=O.layerData.get(h))?void 0:aa.lineIndexCount)?X:!1})){l=l.styleLayer;var v=l.lineMaterial,w=q.vectorTilesMaterialManager,
A=l.getPaintValue("line-translate",g),E=l.getPaintValue("line-translate-anchor",g),G=l.getPaintProperty("line-pattern"),F=void 0!==G,H=F&&G.isDataDriven;if(F&&!H){G=G.getValue(g);var J=u.getMosaicItemPosition(G)}var I;G=!1;if(!F){var N=l.getPaintProperty("line-dasharray");G=(I=void 0!==N)&&N.isDataDriven;I&&!G&&(J=N.getValue(g),J=l.getDashKey(J,l.getLayoutValue("line-cap",g)),J=u.getMosaicItemPosition(J))}N=1/p;var M=m===x.WGLDrawPhase.HITTEST,K=this._programOptions;K.id=M;K.pattern=F;K.sdf=I;I=w.getMaterialProgram(r,
v,K);if(!C.isSome(t)||M||I.isCompiled){r.useProgram(I);I.setUniformMatrix3fv("u_displayViewMat3",c.displayViewMat3);I.setUniformMatrix3fv("u_displayMat3",E===B.TranslateAnchor.VIEWPORT?c.displayMat3:c.displayViewMat3);I.setUniform2fv("u_lineTranslation",A);I.setUniform1f("u_depth",l.z);I.setUniform1f("u_antialiasing",N);M&&(A=n.u32to4Xu8(h+1),I.setUniform4fv("u_id",A));J&&C.isSome(J)&&({page:A}=J,E=u.getPageSize(A),C.isSome(E)&&(u.bind(r,d.TextureSamplingMode.LINEAR,A,y.VTL_TEXTURE_BINDING_UNIT_SPRITES),
I.setUniform2fv("u_mosaicSize",E),I.setUniform1i("u_texture",y.VTL_TEXTURE_BINDING_UNIT_SPRITES)));A=-1;for(const O of k)if(O.layerData.has(h)&&(O.key.level!==A&&(A=O.key.level,v.setDataUniforms(I,g,l,A,u)),I.setUniform1f("u_zoomFactor",2**(g-A)/p),k=O.layerData.get(h),k.lineIndexCount&&(k.prepareForRendering(r),E=k.lineVertexArrayObject,!C.isNone(E)))){r.bindVAO(E);I.setUniformMatrix3fv("u_dvsMat3",O.transforms.dvs);r.setStencilFunction(d.CompareFunction.EQUAL,O.stencilRef,255);if(H||G){E=k.patternMap;
if(!E)continue;for(const [X,aa]of E)E=u.getPageSize(X),C.isSome(E)&&(u.bind(r,d.TextureSamplingMode.LINEAR,X,y.VTL_TEXTURE_BINDING_UNIT_SPRITES),I.setUniform2fv("u_mosaicSize",E),I.setUniform1i("u_texture",y.VTL_TEXTURE_BINDING_UNIT_SPRITES),r.drawElements(d.PrimitiveType.TRIANGLES,aa[1],d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*aa[0]))}else r.drawElements(d.PrimitiveType.TRIANGLES,k.lineIndexCount,d.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*k.lineIndexStart);O.triangleCount+=
k.lineIndexCount/3}}else t()}};return b}(f);z.WGLBrushVTLLine=f;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec2f32 ../../vectorTiles/decluttering/config ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../GeometryUtils ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e){const l=1/65536;b=function(k){function r(){var c=k.apply(this,arguments)||this;c._iconProgramOptions={id:!1,sdf:!1};c._sdfProgramOptions={id:!1};c._spritesTextureSize=B.create();return c}D._inheritsLoose(r,k);var g=r.prototype;g.dispose=function(){};g.drawMany=function(c,m){const {drawPhase:q,styleLayerUID:p}=c,u=c.styleLayer;let h;q===f.WGLDrawPhase.HITTEST&&(h=a.u32to4Xu8(p+1));this._drawIcons(c,u,m,h);this._drawText(c,u,m,h)};g._drawIcons=function(c,m,q,p){const {context:u,
displayLevel:h,drawPhase:t,painter:v,spriteMosaic:w,state:A,styleLayerUID:E,requestRender:G}=c,F=m.iconMaterial;var H=v.vectorTilesMaterialManager,J=!1;for(var I of q)if(I.layerData.has(E)){var N=I.layerData.get(E);if(0<N.iconPerPageElementsMap.size){J=!0;break}}if(J){J=m.getPaintValue("icon-translate",h);I=m.getPaintValue("icon-translate-anchor",h);var M=m.getLayoutValue("icon-rotation-alignment",h);M===x.RotationAlignment.AUTO&&(M=m.getLayoutValue("symbol-placement",h)===x.SymbolPlacement.POINT?
x.RotationAlignment.VIEWPORT:x.RotationAlignment.MAP);var K=M===x.RotationAlignment.MAP;K=m.getLayoutValue("icon-keep-upright",h)&&K;var O=N.isIconSDF;N=t===f.WGLDrawPhase.HITTEST;var X=this._iconProgramOptions;X.id=N;X.sdf=O;H=H.getMaterialProgram(u,F,X);if(!C.isSome(G)||N||H.isCompiled){u.useProgram(H);H.setUniformMatrix3fv("u_displayViewMat3",M===x.RotationAlignment.MAP?A.displayViewMat3:A.displayMat3);H.setUniformMatrix3fv("u_displayMat3",I===x.TranslateAnchor.VIEWPORT?A.displayMat3:A.displayViewMat3);
H.setUniform2fv("u_iconTranslation",J);H.setUniform1f("u_depth",m.z);H.setUniform1f("u_mapRotation",d.degToByte(A.rotation));H.setUniform1f("u_keepUpright",K?1:0);H.setUniform1f("u_level",10*h);H.setUniform1i("u_texture",n.VTL_TEXTURE_BINDING_UNIT_SPRITES);H.setUniform1f("u_fadeDuration",y.FADE_DURATION/1E3);N&&H.setUniform4fv("u_id",p);p=-1;for(const aa of q)if(aa.layerData.has(E)&&(aa.key.level!==p&&(p=aa.key.level,F.setDataUniforms(H,h,m,p,w)),N=aa.layerData.get(E),0!==N.iconPerPageElementsMap.size&&
(N.prepareForRendering(u),N.updateOpacityInfo(),q=N.iconVertexArrayObject,!C.isNone(q)))){u.bindVAO(q);H.setUniformMatrix3fv("u_dvsMat3",aa.transforms.dvs);H.setUniform1f("u_time",(performance.now()-N.lastOpacityUpdate)/1E3);for(const [ba,V]of N.iconPerPageElementsMap)this._renderIconRange(c,H,V,ba,aa)}}else G()}};g._renderIconRange=function(c,m,q,p,u){const {context:h,spriteMosaic:t}=c;this._spritesTextureSize[0]=t.getWidth(p)/4;this._spritesTextureSize[1]=t.getHeight(p)/4;m.setUniform2fv("u_mosaicSize",
this._spritesTextureSize);t.bind(h,e.TextureSamplingMode.LINEAR,p,n.VTL_TEXTURE_BINDING_UNIT_SPRITES);h.setStencilTestEnabled(!0);h.setStencilFunction(e.CompareFunction.GREATER,255,255);h.setStencilWriteMask(0);h.drawElements(e.PrimitiveType.TRIANGLES,q[1],e.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*q[0]);u.triangleCount+=q[1]/3};g._drawText=function(c,m,q,p){const {context:u,displayLevel:h,drawPhase:t,glyphMosaic:v,painter:w,pixelRatio:A,spriteMosaic:E,state:G,styleLayerUID:F,requestRender:H}=
c;c=m.textMaterial;const J=w.vectorTilesMaterialManager;var I=!1;for(var N of q)if(N.layerData.has(F)){var M=N.layerData.get(F);if(0<M.glyphPerPageElementsMap.size){I=!0;break}}if(I&&(M=m.getPaintProperty("text-opacity"),!M||M.isDataDriven||0!==M.getValue(h))){M=m.getPaintProperty("text-color");var K=!M||M.isDataDriven||0<M.getValue(h)[3];M=m.getPaintProperty("text-halo-width");N=m.getPaintProperty("text-halo-color");var O=(!M||M.isDataDriven||0<M.getValue(h))&&(!N||N.isDataDriven||0<N.getValue(h)[3]);
if(K||O){M=m.getLayoutValue("text-rotation-alignment",h);M===x.RotationAlignment.AUTO&&(M=m.getLayoutValue("symbol-placement",h)===x.SymbolPlacement.POINT?x.RotationAlignment.VIEWPORT:x.RotationAlignment.MAP);N=M===x.RotationAlignment.MAP;N=m.getLayoutValue("text-keep-upright",h)&&N;I=t===f.WGLDrawPhase.HITTEST;var X=.8*3/A;this._glyphTextureSize||(this._glyphTextureSize=B.fromValues(v.width/4,v.height/4));var aa=m.getPaintValue("text-translate",h),ba=m.getPaintValue("text-translate-anchor",h),V=
this._sdfProgramOptions;V.id=I;var L=J.getMaterialProgram(u,c,V);if(!C.isSome(H)||I||L.isCompiled){u.useProgram(L);L.setUniformMatrix3fv("u_displayViewMat3",M===x.RotationAlignment.MAP?G.displayViewMat3:G.displayMat3);L.setUniformMatrix3fv("u_displayMat3",ba===x.TranslateAnchor.VIEWPORT?G.displayMat3:G.displayViewMat3);L.setUniform2fv("u_textTranslation",aa);L.setUniform1f("u_depth",m.z+l);L.setUniform2fv("u_mosaicSize",this._glyphTextureSize);L.setUniform1f("u_mapRotation",d.degToByte(G.rotation));
L.setUniform1f("u_keepUpright",N?1:0);L.setUniform1f("u_level",10*h);L.setUniform1i("u_texture",n.VTL_TEXTURE_BINDING_UNIT_GLYPHS);L.setUniform1f("u_antialiasingWidth",X);L.setUniform1f("u_fadeDuration",y.FADE_DURATION/1E3);I&&L.setUniform4fv("u_id",p);p=-1;for(const P of q)P.layerData.has(F)&&(P.key.level!==p&&(p=P.key.level,c.setDataUniforms(L,h,m,p,E)),M=P.layerData.get(F),0!==M.glyphPerPageElementsMap.size&&(M.prepareForRendering(u),M.updateOpacityInfo(),q=M.textVertexArrayObject,C.isNone(q)||
(u.bindVAO(q),L.setUniformMatrix3fv("u_dvsMat3",P.transforms.dvs),u.setStencilTestEnabled(!0),u.setStencilFunction(e.CompareFunction.GREATER,255,255),u.setStencilWriteMask(0),q=(performance.now()-M.lastOpacityUpdate)/1E3,L.setUniform1f("u_time",q),M.glyphPerPageElementsMap.forEach((Y,U)=>{this._renderGlyphRange(u,Y,U,v,L,O,K,P)}))))}else H()}}};g._renderGlyphRange=function(c,m,q,p,u,h,t,v){p.bind(c,e.TextureSamplingMode.LINEAR,q,n.VTL_TEXTURE_BINDING_UNIT_GLYPHS);h&&(u.setUniform1f("u_halo",1),c.drawElements(e.PrimitiveType.TRIANGLES,
m[1],e.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*m[0]),v.triangleCount+=m[1]/3);t&&(u.setUniform1f("u_halo",0),c.drawElements(e.PrimitiveType.TRIANGLES,m[1],e.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*m[0]),v.triangleCount+=m[1]/3)};return r}(b);z.WGLBrushVTLSymbol=b;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),
function(z,D,C,B,y,x,n){return function(f){function d(){return f.apply(this,arguments)||this}z._inheritsLoose(d,f);var a=d.prototype;a.dispose=function(){};a.getGeometryType=function(){return C.WGLGeometryType.LABEL};a.supportsSymbology=function(b){return!0};a.drawGeometry=function(b,e,l,k){const {context:r,painter:g,state:c,rendererInfo:m,passOptions:q,requestRender:p}=b,u=x.LabelMaterialKey.load(l.materialKey);var h=D.isSome(q)&&"hittest"===q.type;const t=u.mapAligned?1:0;if(t||!(1<=Math.abs(e.key.level-
Math.round(100*b.displayLevel)/100))){var {bufferLayouts:v,attributes:w}=B.createProgramDescriptor(u.data,{geometry:[{location:0,name:"a_pos",count:2,type:n.DataType.SHORT},{location:1,name:"a_id",count:4,type:n.DataType.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:n.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_haloColor",count:4,type:n.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:n.DataType.UNSIGNED_BYTE},{location:5,name:"a_refSymbolAndPlacementOffset",
count:4,type:n.DataType.UNSIGNED_BYTE},{location:6,name:"a_glyphData",count:4,type:n.DataType.UNSIGNED_BYTE},{location:7,name:"a_vertexOffset",count:2,type:n.DataType.SHORT},{location:8,name:"a_texCoords",count:2,type:n.DataType.UNSIGNED_SHORT}]});k=g.materialManager.getMaterialProgram(b,u,"materials/label",w,k);!D.isSome(p)||h||k.isCompiled?(b.context.setStencilFunction(n.CompareFunction.EQUAL,0,255),r.useProgram(k),this._setSharedUniforms(k,b,e),g.textureManager.bindTextures(r,k,u),h=1===t?c.displayViewMat3:
c.displayMat3,this._setSizeVVUniforms(u,k,m,e),k.setUniform1f("u_mapRotation",Math.floor(c.rotation/360*254)),k.setUniform1f("u_mapAligned",t),k.setUniformMatrix3fv("u_displayMat3",h),k.setUniform1f("u_opacity",1),k.setUniform2fv("u_screenSize",b.state.size),k.setUniform1f("u_isHalo",1),b=l.target.getVAO(r,v,w),e=l.indexFrom*Uint32Array.BYTES_PER_ELEMENT,r.bindVAO(b),r.drawElements(n.PrimitiveType.TRIANGLES,l.indexCount,n.DataType.UNSIGNED_INT,e),k.setUniform1f("u_isHalo",0),r.drawElements(n.PrimitiveType.TRIANGLES,
l.indexCount,n.DataType.UNSIGNED_INT,e),r.setStencilTestEnabled(!0),r.setBlendingEnabled(!0)):p()}};return d}(y)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),function(z,D,C,B,y,x,n){return function(f){function d(){return f.apply(this,arguments)||this}z._inheritsLoose(d,f);var a=d.prototype;a.dispose=
function(){};a.getGeometryType=function(){return C.WGLGeometryType.LINE};a.supportsSymbology=function(b){return!0};a.drawGeometry=function(b,e,l,k){const {context:r,painter:g,rendererInfo:c,displayLevel:m,passOptions:q,requestRender:p}=b,u=x.LineMaterialKey.load(l.materialKey),h=D.isSome(q)&&"hittest"===q.type;var t=B.createProgramDescriptor(u.data,{geometry:[{location:0,name:"a_pos",count:2,type:n.DataType.SHORT},{location:1,name:"a_id",count:4,type:n.DataType.UNSIGNED_BYTE},{location:2,name:"a_color",
count:4,type:n.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:n.DataType.BYTE},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:n.DataType.UNSIGNED_SHORT},{location:5,name:"a_tlbr",count:4,type:n.DataType.UNSIGNED_SHORT},{location:6,name:"a_segmentDirection",count:4,type:n.DataType.BYTE},{location:7,name:"a_aux",count:2,type:n.DataType.UNSIGNED_SHORT},{location:8,name:"a_zoomRange",count:2,type:n.DataType.UNSIGNED_SHORT}]});let v=n.PrimitiveType.TRIANGLES;
h&&(t=this._getTriangleDesc(l.materialKey,t),v=n.PrimitiveType.POINTS);const {attributes:w,bufferLayouts:A}=t;k=g.materialManager.getMaterialProgram(b,u,"materials/line",w,k);!D.isSome(p)||h||k.isCompiled?(t=1/b.pixelRatio,r.useProgram(k),this._setSharedUniforms(k,b,e),u.textureBinding&&g.textureManager.bindTextures(r,k,u),k.setUniform1f("u_zoomFactor",2**(m-e.key.level)),k.setUniform1f("u_blur",0+t),k.setUniform1f("u_antialiasing",t),this._setSizeVVUniforms(u,k,c,e),this._setColorAndOpacityVVUniforms(u,
k,c),r.setFaceCullingEnabled(!1),b=l.target.getVAO(r,A,w,h),e=l.indexCount,l=l.indexFrom*Uint32Array.BYTES_PER_ELEMENT,h&&(e/=3,l/=3),r.bindVAO(b),r.drawElements(v,e,n.DataType.UNSIGNED_INT,l)):p()};return d}(y)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),function(z,D,C,B,y,x,n){return function(f){function d(){return f.apply(this,
arguments)||this}z._inheritsLoose(d,f);var a=d.prototype;a.dispose=function(){};a.getGeometryType=function(){return C.WGLGeometryType.TEXT};a.supportsSymbology=function(b){return!0};a.drawGeometry=function(b,e,l,k){const {context:r,painter:g,rendererInfo:c,state:m,passOptions:q,requestRender:p}=b,u=x.TextMaterialKey.load(l.materialKey),h=D.isSome(q)&&"hittest"===q.type,{bufferLayouts:t,attributes:v}=B.createProgramDescriptor(u.data,{geometry:[{location:0,name:"a_pos",count:2,type:n.DataType.SHORT},
{location:1,name:"a_id",count:4,type:n.DataType.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:n.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_haloColor",count:4,type:n.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:n.DataType.UNSIGNED_BYTE},{location:5,name:"a_aux",count:4,type:n.DataType.BYTE},{location:6,name:"a_zoomRange",count:2,type:n.DataType.UNSIGNED_SHORT},{location:7,name:"a_vertexOffset",count:2,type:n.DataType.SHORT},{location:8,
name:"a_texCoords",count:2,type:n.DataType.UNSIGNED_SHORT}]});k=g.materialManager.getMaterialProgram(b,u,"materials/text",v,k);if(!D.isSome(p)||h||k.isCompiled){r.useProgram(k);var w=n.PrimitiveType.TRIANGLES;h&&(w=n.PrimitiveType.POINTS);this._setSharedUniforms(k,b,e);g.textureManager.bindTextures(r,k,u);k.setUniformMatrix3fv("u_displayMat3",m.displayMat3);k.setUniformMatrix3fv("u_displayViewMat3",m.displayViewMat3);this._setSizeVVUniforms(u,k,c,e);this._setColorAndOpacityVVUniforms(u,k,c);this._setRotationVVUniforms(u,
k,c);k.setUniform1f("u_isHalo",1);b=l.target.getVAO(r,t,v);e=l.indexFrom*Uint32Array.BYTES_PER_ELEMENT;r.bindVAO(b);r.drawElements(n.PrimitiveType.TRIANGLES,l.indexCount,n.DataType.UNSIGNED_INT,e);k.setUniform1f("u_isHalo",0);r.drawElements(w,l.indexCount,n.DataType.UNSIGNED_INT,e)}else p()};return d}(y)})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterialManager":function(){define(["../enums","./Programs"],function(z,D){return function(){function C(){this._programByKey=new Map}var B=C.prototype;
B.dispose=function(){this._programByKey.forEach(y=>y.dispose());this._programByKey.clear()};B.getMaterialProgram=function(y,x,n){const f=x.key<<3|this._getMaterialOptionsValue(x.type,n);if(this._programByKey.has(f))return this._programByKey.get(f);var d=this._getProgramTemplate(x.type);({shaders:d}=d);const {vertexShader:a,fragmentShader:b}=d(n);n=x.getShaderHeader();d=x.getShaderMain();n=a.replace("#pragma header",n).replace("#pragma main",d);y=y.programCache.acquire(n,b,x.getAttributeLocations());
this._programByKey.set(f,y);return y};B._getMaterialOptionsValue=function(y,x){switch(y){case z.ShaderProgramType.BACKGROUND:return(x.pattern?1:0)<<1|(x.id?1:0);case z.ShaderProgramType.FILL:return(x.pattern?1:0)<<1|(x.id?1:0);case z.ShaderProgramType.OUTLINE:return x.id?1:0;case z.ShaderProgramType.LINE:return(x.sdf?1:0)<<2|(x.pattern?1:0)<<1|(x.id?1:0);case z.ShaderProgramType.ICON:return(x.sdf?1:0)<<1|(x.id?1:0);case z.ShaderProgramType.CIRCLE:return x.id?1:0;case z.ShaderProgramType.TEXT:return x.id?
1:0;default:return 0}};B._getProgramTemplate=function(y){switch(y){case z.ShaderProgramType.BACKGROUND:return D.background;case z.ShaderProgramType.CIRCLE:return D.circle;case z.ShaderProgramType.FILL:return D.fill;case z.ShaderProgramType.ICON:return D.icon;case z.ShaderProgramType.LINE:return D.line;case z.ShaderProgramType.OUTLINE:return D.outline;case z.ShaderProgramType.TEXT:return D.text;default:return null}};return C}()})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["exports",
"./sources/resolver","../../../../webgl/programUtils"],function(z,D,C){z.background={shaders:B=>({vertexShader:C.glslifyDefineMap({ID:B.id,PATTERN:B.pattern})+D.resolveIncludes("background/background.vert"),fragmentShader:C.glslifyDefineMap({ID:B.id,PATTERN:B.pattern})+D.resolveIncludes("background/background.frag")})};z.circle={shaders:B=>({vertexShader:C.glslifyDefineMap({ID:B.id})+D.resolveIncludes("circle/circle.vert"),fragmentShader:C.glslifyDefineMap({ID:B.id})+D.resolveIncludes("circle/circle.frag")})};
z.fill={shaders:B=>({vertexShader:C.glslifyDefineMap({ID:B.id,PATTERN:B.pattern})+D.resolveIncludes("fill/fill.vert"),fragmentShader:C.glslifyDefineMap({ID:B.id,PATTERN:B.pattern})+D.resolveIncludes("fill/fill.frag")})};z.icon={shaders:B=>({vertexShader:C.glslifyDefineMap({ID:B.id,SDF:B.sdf})+D.resolveIncludes("icon/icon.vert"),fragmentShader:C.glslifyDefineMap({ID:B.id,SDF:B.sdf})+D.resolveIncludes("icon/icon.frag")})};z.line={shaders:B=>({vertexShader:C.glslifyDefineMap({ID:B.id,PATTERN:B.pattern,
SDF:B.sdf})+D.resolveIncludes("line/line.vert"),fragmentShader:C.glslifyDefineMap({ID:B.id,PATTERN:B.pattern,SDF:B.sdf})+D.resolveIncludes("line/line.frag")})};z.outline={shaders:B=>({vertexShader:C.glslifyDefineMap({ID:B.id})+D.resolveIncludes("outline/outline.vert"),fragmentShader:C.glslifyDefineMap({ID:B.id})+D.resolveIncludes("outline/outline.frag")})};z.text={shaders:B=>({vertexShader:C.glslifyDefineMap({ID:B.id})+D.resolveIncludes("text/text.vert"),fragmentShader:C.glslifyDefineMap({ID:B.id})+
D.resolveIncludes("text/text.frag")})};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["exports","./shaderRepository","../../../../../webgl/ShaderCompiler"],function(z,D,C){const B=new C.ShaderCompiler(function(y){let x=D;y.split("/").forEach(n=>{x&&(x=x[n])});return x});z.resolveIncludes=function(y){return B.resolveIncludes(y)};Object.defineProperties(z,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform lowp sampler2D u_texture;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d u_opacity * color;\n#else\ngl_FragColor \x3d u_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\nuniform mediump vec4 u_tlbr;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\n#endif\nvoid main() {\ngl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\nv_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d u_tlbr / u_mosaicSize.xyxy;\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float dist \x3d length(v_offset);\nmediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\nlowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\ngl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_stroke_color \x3d stroke_color * stroke_opacity;\nv_stroke_width \x3d stroke_width;\nv_radius \x3d radius;\nv_blur \x3d max(blur, u_antialiasingWidth / (radius + stroke_width));\nmediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\nv_offset \x3d offset;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d v_color[3] * color;\n#else\ngl_FragColor \x3d v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\n#include \x3cutil/util.glsl\x3e\nuniform mediump vec2 u_mosaicSize;\nuniform mediump float u_patternFactor;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\nfloat patternWidth \x3d nextPOT(tlbr.z - tlbr.x);\nfloat patternHeight \x3d nextPOT(tlbr.w - tlbr.y);\nfloat scaleX \x3d 1.0 / (patternWidth * u_patternFactor);\nfloat scaleY \x3d 1.0 / (patternHeight * u_patternFactor);\nmat3 patterMat \x3d mat3(scaleX, 0.0,    0.0,\n0.0,    -scaleY, 0.0,\n0.0,    0.0,    1.0);\nv_tileTextureCoord \x3d (patterMat * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d tlbr / u_mosaicSize.xyxy;\n#endif\nvec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump flaot v_halo_width;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\nconst float softEdgeRatio \x3d 0.248062016;\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * softEdgeRatio * size;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nif (v_halo_width \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d u_outlineColor;\nconst float outlineLimitRatio \x3d (16.0 / 86.0);\nfloat clampedOutlineSize \x3d softEdgeRatio * min(v_halo_width, outlineLimitRatio * max(v_size.x, v_size.y));\noutlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\ngl_FragColor \x3d v_opacity * mixColors(fillPixelColor, outlinePixelColor);\n}\nelse {\ngl_FragColor \x3d v_opacity * fillPixelColor;\n}\n#else\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d v_opacity * texColor;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump float v_halo_width;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nv_color \x3d color;\nv_opacity \x3d opacity;\n#ifdef SDF\nv_halo_width \x3d halo_width;\n#endif\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_opacity *\x3d interpolatedOpacity;\nmediump float a_angle         \x3d a_levelInfo[1];\nmediump float a_minLevel      \x3d a_levelInfo[2];\nmediump float a_maxLevel      \x3d a_levelInfo[3];\nmediump vec2 a_tex            \x3d a_texAngleRange.xy;\nmediump float delta_z \x3d 0.0;\nmediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_opacity, 0.0);\nvec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\nv_size \x3d abs(offset);\n#ifdef SDF\noffset \x3d (120.0 / 86.0) * offset;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_tex \x3d a_tex.xy / u_mosaicSize;\n}"},
line:{"line.frag":"precision lowp float;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#if defined (PATTERN) || defined(SDF)\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\nuniform sampler2D u_texture;\nuniform mediump float u_antialiasing;\n#endif\n#ifdef SDF\n#include \x3cutil/encoding.glsl\x3e\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\nlowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\nmediump float relativeTexX \x3d fract(v_accumulatedDistance / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY \x3d 0.5 + v_normal.y * v_lineHalfWidth / (v_patternSize.y * v_widthRatio);\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\ngl_FragColor \x3d alpha * v_color[3] * color;\n#elif defined(SDF)\nmediump float relativeTexX \x3d fract((v_accumulatedDistance * 0.5) / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY \x3d  0.5 + 0.25 * v_normal.y;\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * (v_lineHalfWidth + u_antialiasing / 2.0);\ngl_FragColor \x3d alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n#else\ngl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_extrude_offset;\nattribute vec4 a_dir_normal;\nattribute vec2 a_accumulatedDistance;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump float u_zoomFactor;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\nconst mediump float tileCoordRatio \x3d 8.0;\n#if defined (SDF)\nconst mediump float sdfPatternHalfWidth \x3d 15.5;\n#endif\n#if defined (PATTERN) || defined(SDF)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_blur \x3d blur + u_antialiasing;\nv_normal \x3d a_dir_normal.zw * scale;\n#if defined (PATTERN) || defined(SDF)\nv_tlbr          \x3d tlbr / u_mosaicSize.xyxy;\nv_patternSize   \x3d vec2(tlbr.z - tlbr.x, tlbr.y - tlbr.w);\n#if defined (PATTERN)\nv_widthRatio \x3d width / v_patternSize.y;\n#else\nv_widthRatio \x3d width / sdfPatternHalfWidth / 2.0;\n#endif\n#endif\nv_lineHalfWidth \x3d (width + u_antialiasing) * 0.5;\nmediump vec2 dir \x3d a_dir_normal.xy * scale;\nmediump vec2 offset_ \x3d a_extrude_offset.zw * scale * offset;\nmediump vec2 dist \x3d v_lineHalfWidth * scale * a_extrude_offset.xy;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos + offset_ * tileCoordRatio / u_zoomFactor, 1.0) + u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n#if defined (PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d a_accumulatedDistance.x * u_zoomFactor / tileCoordRatio + dot(dir, dist + offset_);\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d abs(v_normal.y);\nlowp float alpha \x3d smoothstep(1.0, 0.0, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_normal \x3d a_xnormal;\nmediump vec2 dist \x3d u_outline_width * scale * a_offset;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nvarying lowp vec2 v_tex;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying lowp vec2 v_tex;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nconst float sdfPixel \x3d 3.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nif (u_halo \x3e 0.5)\n{\nv_color \x3d halo_color * opacity;\nhalo_width *\x3d sdfPixel;\nhalo_blur *\x3d sdfPixel;\n}\nelse\n{\nv_color \x3d color * opacity;\nhalo_width \x3d 0.0;\nhalo_blur \x3d 0.0;\n}\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_color *\x3d interpolatedOpacity;\nmediump float a_angle       \x3d a_levelInfo[1];\nmediump float a_minLevel    \x3d a_levelInfo[2];\nmediump float a_maxLevel    \x3d a_levelInfo[3];\nmediump vec2 a_tex          \x3d a_texAngleRange.xy;\nmediump float a_visMinAngle    \x3d a_texAngleRange.z;\nmediump float a_visMaxAngle    \x3d a_texAngleRange.w;\nmediump float delta_z \x3d 0.0;\nmediump float angle \x3d mod(a_angle + u_mapRotation, 256.0);\nif (a_visMinAngle \x3c a_visMaxAngle)\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\n}\nelse\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\n}\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_color[3], 0.0);\nv_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_edgeDistance \x3d edgePos - halo_width / size;\nv_edgeWidth \x3d (u_antialiasingWidth + halo_blur) / size;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}","util.glsl":"float nextPOT(in float x) {\nreturn pow(2.0, ceil(log2(abs(x))));\n}"}}})},"esri/views/webgl/programUtils":function(){define(["exports"],function(z){z.glslifyDefineMap=function(D){let C="";for(const x in D){var B=D[x];if("boolean"===
typeof B)B&&(C+=`#define ${x}\n`);else if("number"===typeof B)C+=`#define ${x} ${B.toFixed()}\n`;else if("object"===typeof B){{const {options:n,value:f}=B;var y="number"===typeof n[f]}if(y){const {value:n,options:f,namespace:d}=B;B=d?`${d}_`:"";for(const a in f)C+=`#define ${B}${a} ${f[a].toFixed()}\n`;C+=`#define ${x} ${B}${n}\n`}else{y=B.options;let n=0;for(const f in y)C+=`#define ${y[f]} ${(n++).toFixed()}\n`;C+=`#define ${x} ${y[B.value]}\n`}}}return C};Object.defineProperties(z,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define("exports ../../../../core/maybe ./DefaultVertexAttributeLayouts ./shaders/BitBlitPrograms ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/ProgramTemplate ../../../webgl/VertexArrayObject".split(" "),function(z,D,C,B,y,x,n,f){let d=function(){function a(){this._initialized=!1}var b=a.prototype;b.dispose=function(){this._program=D.disposeMaybe(this._program);this._vertexArrayObject=
D.disposeMaybe(this._vertexArrayObject)};b.render=function(e,l,k,r){e&&(this._initialized||this._initialize(e),e.setBlendFunctionSeparate(x.BlendFactor.ONE,x.BlendFactor.ONE_MINUS_SRC_ALPHA,x.BlendFactor.ONE,x.BlendFactor.ONE_MINUS_SRC_ALPHA),e.bindVAO(this._vertexArrayObject),e.useProgram(this._program),l.setSamplingMode(k),e.bindTexture(l,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",r),e.drawArrays(x.PrimitiveType.TRIANGLE_STRIP,0,4),e.bindTexture(null,0),e.bindVAO())};
b._initialize=function(e){if(this._initialized)return!0;const l=n.createProgram(e,B.bitBlit);if(!l)return!1;const k=new Int8Array(16);k[0]=-1;k[1]=-1;k[2]=0;k[3]=0;k[4]=1;k[5]=-1;k[6]=1;k[7]=0;k[8]=-1;k[9]=1;k[10]=0;k[11]=1;k[12]=1;k[13]=1;k[14]=1;k[15]=1;e=new f.VertexArrayObject(e,B.bitBlit.attributes,C.PosTex2b,{geometry:y.BufferObject.createVertex(e,x.Usage.STATIC_DRAW,k)});this._program=l;this._vertexArrayObject=e;return this._initialized=!0};return a}();z.BitBlitRenderer=d;Object.defineProperties(z,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["exports","./sources/resolver"],function(z,D){D={shaders:{vertexShader:D.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:D.resolveIncludes("bitBlit/bitBlit.frag")},attributes:new Map([["a_pos",0],["a_tex",1]])};z.bitBlit=D;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/MaterialManager":function(){define(["../../../../core/maybe",
"./enums","./shaders/MaterialPrograms"],function(z,D,C){const B=n=>n===D.WGLDrawPhase.HITTEST||n===D.WGLDrawPhase.LABEL_ALPHA,y=({rendererInfo:n,drawPhase:f},d,a,b)=>{d=d.getVariationHash();b=b.join(".");f=(B(f)?1:0)|(f===D.WGLDrawPhase.HIGHLIGHT?2:0);return`${d}-${b}-${f}-${n.getVariationHash()}-${z.isSome(a)&&a.join(".")}`},x=(n,f,d,a)=>{a=a.reduce((b,e)=>({...b,[e]:n.context.driverTest[e]}),{});f={...f.getVariation(),...n.rendererInfo.getVariation(),highlight:n.drawPhase===D.WGLDrawPhase.HIGHLIGHT,
id:B(n.drawPhase),...a};if(z.isSome(d))for(const b of d)f[b]=!0;return f};return function(){function n(d){this._rctx=d;this._programByKey=new Map}var f=n.prototype;f.dispose=function(){this._programByKey.forEach(d=>d.dispose());this._programByKey.clear()};f.getProgram=function(d,a=[],b=[]){const e=d.vsPath+"."+d.fsPath+JSON.stringify(a)+b.join(".");if(this._programByKey.has(e))return this._programByKey.get(e);b=b.reduce((g,c)=>({...g,[c]:this._rctx.driverTest[c]}),{});a={...a.map(g=>"string"===typeof g?
{name:g,value:!0}:g).reduce((g,c)=>({...g,[c.name]:c.value}),{}),...b};const {vsPath:l,fsPath:k,attributes:r}=d;d=C.createProgramTemplate(l,k,r,a);d=this._rctx.programCache.acquire(d.shaders.vertexShader,d.shaders.fragmentShader,d.attributes);if(!d)throw Error("Unable to get program for key: ${key}");this._programByKey.set(e,d);return d};f.getMaterialProgram=function(d,a,b,e,l,k=["ignoresSamplerPrecision"]){const r=y(d,a,l,k);if(this._programByKey.has(r))return this._programByKey.get(r);d=x(d,a,l,
k);b=C.createProgramTemplate(b,b,e,d);b=this._rctx.programCache.acquire(b.shaders.vertexShader,b.shaders.fragmentShader,b.attributes);if(!b)throw Error("Unable to get program for key: ${key}");this._programByKey.set(r,b);return b};return n}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["exports","./sources/resolver","../../../../webgl/programUtils"],function(z,D,C){z.createProgramTemplate=(B,y,x,n)=>{B+=B.substring(B.lastIndexOf("/"));y+=y.substring(y.lastIndexOf("/"));
{const d={};for(const a in n){{let b=void 0;var f=a;b=""+f[0].toUpperCase();for(let e=1;e<f.length;e++){const l=f[e];l===l.toUpperCase()?(b+="_",b+=l):b+=l.toUpperCase()}f=b}d[f]=n[a]}n=C.glslifyDefineMap(d)}return{attributes:x,shaders:{vertexShader:n+D.resolveIncludes(`${B}.vert`),fragmentShader:n+D.resolveIncludes(`${y}.frag`)}}};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/TextureManager":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../config ../../../../request ../../../../core/BidiText ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../chunks/vec2 ../../../../chunks/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./Utils ./animatedFormats/apng ./animatedFormats/gif ./util/Result ./util/symbolUtils ../../../support/QueueProcessor ../../../webgl/enums".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g,c,m,q,p,u,h,t,v,w,A){function E(N,M){return G.apply(this,arguments)}function G(){G=z._asyncToGenerator(function*(N,M){N=p.getUrl(N);var K;if(N.includes(";base64,")){M=N.indexOf(";base64,")+8;M=N.substring(M);M=atob(M);N=new Uint8Array(M.length);for(K=0;K<M.length;K++)N[K]=M.charCodeAt(K);K=N.buffer}else try{const {data:O}=yield C(N,{responseType:"array-buffer",...M});K=O}catch(O){if(!f.isAbortError(O))return new y("mapview-invalid-resource",`Could not fetch requested resource at ${N}`)}return K});
return G.apply(this,arguments)}function F(N,M){M=Math.round(d.pt2px(M)*window.devicePixelRatio);return Math.min(N,M*(128<=M?2:4))}const H=b.create(),J=x.getLogger("esri.views.2d.engine.webgl.TextureManager");let I=function(){function N(M,K,O){this.mosaicType=M;this.page=K;this.sdf=O}N.fromMosaic=function(M,K){return new N(M,K.page,K.sdf)};return N}();return function(){function N(K,O){this._requestRender=K;this.resourceManager=O;this._invalidFontsMap=new Map;this._sdfConverter=new m(126);this._bindingInfos=
[];this._hashToBindingIndex=new Map;this._ongoingRasterizations=new Map;this._imageRequestQueue=new w.QueueProcessor({concurrency:10,process:function(){var X=z._asyncToGenerator(function*(aa,ba){f.throwIfAborted(ba);try{return yield C(aa,{responseType:"image",signal:ba})}catch(V){if(!f.isAbortError(V))throw new y("mapview-invalid-resource",`Could not fetch requested resource at ${aa}`,V);throw V;}});return function(aa,ba){return X.apply(this,arguments)}}()});this._spriteMosaic=new q(2048,2048,500);
this._glyphSource=new c(`${D.fontsUrl}/{fontstack}/{range}.pbf`);this._glyphMosaic=new g(1024,1024,this._glyphSource);this._rasterizer=new e(O)}var M=N.prototype;M.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._sdfConverter.dispose();this._sdfConverter=this._glyphMosaic=this._spriteMosaic=null;this._hashToBindingIndex.clear();this._bindingInfos=this._hashToBindingIndex=null;this._ongoingRasterizations.clear();this._ongoingRasterizations=
null;this._imageRequestQueue.clear();this._imageRequestQueue=null};M.rasterizeItem=function(){var K=z._asyncToGenerator(function*(O,X,aa,ba){if(n.isNone(O))return J.error(new y("mapview-null-resource","Unable to rasterize null resource",void 0)),null;switch(O.type){case "text":case "esriTS":return O=yield this._rasterizeText(O,aa,ba),O.forEach(V=>this._setTextureBinding(k.MosaicType.GLYPH,V)),{glyphMosaicItems:O};default:if(p.is3D(O))return J.error(new y("mapview-invalid-type",`MapView does not support symbol type: ${O.type}`,
O)),null;O=yield this._rasterizeSpriteSymbol(O,X,ba);t.ok(O)&&O&&this._setTextureBinding(k.MosaicType.SPRITE,O);return{spriteMosaicItem:O}}});return function(O,X,aa,ba){return K.apply(this,arguments)}}();M.bindTextures=function(K,O,X,aa=!1){if(0!==X.textureBinding){var ba=this._bindingInfos[X.textureBinding-1];X=ba.page;aa=aa?A.TextureSamplingMode.LINEAR_MIPMAP_LINEAR:A.TextureSamplingMode.LINEAR;switch(ba.mosaicType){case k.MosaicType.SPRITE:{ba=this.sprites.getWidth(X);const V=this.sprites.getHeight(X);
ba=a.set(H,ba,V);this._spriteMosaic.bind(K,aa,X,l.TEXTURE_BINDING_SPRITE_ATLAS);O.setUniform1i("u_texture",l.TEXTURE_BINDING_SPRITE_ATLAS);O.setUniform2fv("u_mosaicSize",ba);break}case k.MosaicType.GLYPH:ba=a.set(H,this.glyphs.width,this.glyphs.height);this._glyphMosaic.bind(K,aa,X,l.TEXTURE_BINDING_GLYPH_ATLAS);O.setUniform1i("u_texture",l.TEXTURE_BINDING_GLYPH_ATLAS);O.setUniform2fv("u_mosaicSize",ba);break;default:J.error("mapview-texture-manager",`Cannot handle unknown type ${ba.mosaicType}`)}}};
M._hashMosaic=function(K,O){return 1|K<<1|(O.sdf?1:0)<<2|O.page<<3};M._setTextureBinding=function(K,O){const X=this._hashMosaic(K,O);this._hashToBindingIndex.has(X)||(K=I.fromMosaic(K,O),this._hashToBindingIndex.set(X,this._bindingInfos.length+1),this._bindingInfos.push(K));O.textureBinding=this._hashToBindingIndex.get(X)};M._rasterizeText=function(){var K=z._asyncToGenerator(function*(O,X,aa){let ba,V;ba="cim"in O?O.fontName:r.getFullyQualifiedFontName(O.font);V=O.text;O=this._invalidFontsMap.has(ba);
X=X?X:p.charCodes(B.bidiText(V)[0]);try{return yield this._glyphMosaic.getGlyphItems(O?"arial-unicode-ms-regular":ba,X,aa)}catch(L){return J.error(new y("mapview-invalid-resource",`Couldn't find font ${ba}. Falling back to Arial Unicode MS Regular`,void 0)),this._invalidFontsMap.set(ba,!0),this._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",X,aa)}});return function(O,X,aa){return K.apply(this,arguments)}}();M._rasterizeSpriteSymbol=function(){var K=z._asyncToGenerator(function*(O,X,aa){if(p.isSimple(O))return null;
X=v.keyFromSymbol(O);if(this._spriteMosaic.has(X))return this._spriteMosaic.getSpriteItem(X);if(p.isSVGResource(O)||p.isImageResource(O)&&!p.isMarkerPlacementInsidePolygon(O))return this._handleAsyncResource(X,O,aa);if(aa=this._rasterizer.rasterizeJSONResource(O,1)){const {size:ba,image:V,sdf:L,simplePattern:P}=aa;return this._addItemToMosaic(X,ba,{type:"static",data:V},p.shouldRepeat(O),L,P)}return new y("TextureManager","unrecognized or null rasterized image")});return function(O,X,aa){return K.apply(this,
arguments)}}();M._handleAsyncResource=function(){var K=z._asyncToGenerator(function*(O,X,aa){if(this._ongoingRasterizations.has(O))return this._ongoingRasterizations.get(O);X=p.isSVGResource(X)?this._handleSVG(X,O,aa):this._handleImage(X,O,aa);this._ongoingRasterizations.set(O,X);try{yield X,this._ongoingRasterizations.delete(O)}catch{this._ongoingRasterizations.delete(O)}return X});return function(O,X,aa){return K.apply(this,arguments)}}();M._handleSVG=function(){var K=z._asyncToGenerator(function*(O,
X,aa){O=yield this._sdfConverter.draw(O.path,aa);return this._addItemToMosaic(X,[126,126],{type:"static",data:new Uint32Array(O.buffer)},!1,!0,!0)});return function(O,X,aa){return K.apply(this,arguments)}}();M._handleGIFOrPNG=function(){var K=z._asyncToGenerator(function*(O,X,aa){var ba=yield E(O,aa);if(t.ok(ba)){var V=h.isGIF(ba);const L=u.isPNG(ba);if(!V&&!L)return new y("mapview-invalid-resource","Image data is neither GIF nor PNG!");let P;try{const Y=O.animatedSymbolProperties||{},U=O.objectId;
V&&h.isAnimatedGIF(ba)?P=yield h.GIF.create(ba,Y,U,this._requestRender,aa):L&&u.isAnimatedPNG(ba)&&(P=yield u.APNG.create(ba,Y,U,this._requestRender,aa))}catch(Y){if(!f.isAbortError(Y))return new y("mapview-invalid-resource","Could not fetch requested resource!")}if(P&&t.ok(P))return this._addItemToMosaic(X,[P.width,P.height],{type:"animated",data:P},p.shouldRepeat(O),!1,!1);aa=new Blob([ba],{type:V?"image/gif":"image/png"});if((aa=yield this._imageFromBlob(aa))&&aa instanceof HTMLImageElement){ba=
aa.width;V=aa.height;"esriPMS"===O.type&&(ba=Math.round(F(aa.width,p.getPMSResourceSize(O))),V=Math.round(ba/aa.width*aa.height));const {size:Y,sdf:U,image:Q}=this._rasterizer.rasterizeImageResource(ba,V,aa,"cim"in O?O.cim.colorSubstitutions:void 0);return this._addItemToMosaic(X,Y,{type:"static",data:Q},p.shouldRepeat(O),U,!1)}}return new y("mapview-invalid-resource","Could not handle resource!")});return function(O,X,aa){return K.apply(this,arguments)}}();M._handleImage=function(){var K=z._asyncToGenerator(function*(O,
X,aa){if(p.isGIF(O)||p.isPNG(O))return this._handleGIFOrPNG(O,X,aa);const ba=p.getUrl(O);try{let L;const P=this.resourceManager.getResource(ba);if(n.isSome(P))L=P;else{const {data:S}=yield this._imageRequestQueue.push(ba,{...aa});L=S}if(p.isSVGImage(ba))if("width"in O&&"height"in O)L.width=d.pt2px(O.width),L.height=d.pt2px(O.height);else if("cim"in O){var V;const S=O.cim;L.width=d.pt2px(null!=(V=S.width)?V:S.scaleX*S.size);L.height=d.pt2px(S.size)}if(!L.width||!L.height)return null;let Y=L.width,
U=L.height;"esriPMS"===O.type&&(Y=Math.round(F(L.width,p.getPMSResourceSize(O))),U=Math.round(Y/L.width*L.height));const {size:Q,sdf:W,image:R}=this._rasterizer.rasterizeImageResource(Y,U,L,"cim"in O?O.cim.colorSubstitutions:void 0);return this._addItemToMosaic(X,Q,{type:"static",data:R},p.shouldRepeat(O),W,!1)}catch(L){if(!f.isAbortError(L))return new y("mapview-invalid-resource",`Could not fetch requested resource at ${ba}. ${L.message}`)}});return function(O,X,aa){return K.apply(this,arguments)}}();
M._imageFromBlob=function(){var K=z._asyncToGenerator(function*(O){O=window.URL.createObjectURL(O);try{const {data:X}=yield this._imageRequestQueue.push(O);window.URL.revokeObjectURL(O);return X}catch(X){window.URL.revokeObjectURL(O);if(!f.isAbortError(X))return new y("mapview-invalid-resource",`Could not fetch requested resource at ${O}`);throw X;}});return function(O){return K.apply(this,arguments)}}();M._addItemToMosaic=function(K,O,X,aa,ba,V){return this._spriteMosaic.addSpriteItem(K,O,X,aa,ba,
V)};z._createClass(N,[{key:"sprites",get:function(){return this._spriteMosaic}},{key:"glyphs",get:function(){return this._glyphMosaic}}]);return N}()})},"esri/core/BidiText":function(){define(["exports","./BidiEngine"],function(z,D){const C=new D;z.bidiText=function(B){if(!C.hasBidiChar(B))return[B,!1];let y;y="rtl"===C.checkContextual(B)?"IDNNN":"ICNNN";return[C.bidiTransform(B,y,"VLYSN"),!0]};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/Rasterizer":function(){define(["./CIMSymbolHelper",
"./Rect","./SDFHelper","./utils"],function(z,D,C,B){return function(){function y(n){this._resourceManager=n}var x=y.prototype;x.dispose=function(){this._rasterizationCanvas=null};x.rasterizeJSONResource=function(n,f,d){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===n.type||"esriSFS"===n.type){const [c,m,q]=z.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,n.style,f);return{size:[m,q],image:new Uint32Array(c.buffer),sdf:!1,simplePattern:!0,
anchorX:0,anchorY:0}}if("simple-line"===n.type||"esriSLS"===n.type||"line"===n.type&&n.dashTemplate){if("simple-line"===n.type||"esriSLS"===n.type)switch(d=z.slsDashToTemplateArray(n.style,n.cap),n.cap){case "butt":n="Butt";break;case "square":n="Square";break;default:n="Round"}else d=n.dashTemplate,n=n.cim.capStyle;const [c,m,q]=z.SymbolHelper.rasterizeSimpleLine(d,n);return{size:[m,q],image:new Uint32Array(c.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let a,b;"simple-marker"===n.type||
"esriSMS"===n.type||"line-marker"===n.type?(n=z.CIMSymbolHelper.fromSimpleMarker(n),b=C.getSDFInfo(n)):n.cim&&"CIMHatchFill"===n.cim.type?(n=z.CIMSymbolHelper.fromCIMHatchFill(n.cim),a=new D(n.frame.xmin,-n.frame.ymax,n.frame.xmax-n.frame.xmin,n.frame.ymax-n.frame.ymin)):n.cim.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===n.cim.markerPlacement.type?(n=z.CIMSymbolHelper.fromCIMInsidePolygon(n.cim),a=new D(n.frame.xmin,-n.frame.ymax,n.frame.xmax-n.frame.xmin,n.frame.ymax-n.frame.ymin)):(n=n.cim,
b=C.getSDFInfo(n));if(b&&!d){const [c,m,q]=C.buildSDF(b);return c?{size:[m,q],image:new Uint32Array(c.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const [e,l,k,r,g]=z.CIMSymbolHelper.rasterize(this._rasterizationCanvas,n,a,this._resourceManager,!d);return e?{size:[l,k],image:new Uint32Array(e.buffer),sdf:!1,simplePattern:!1,anchorX:r,anchorY:g}:null};x.rasterizeImageResource=function(n,f,d,a){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=
n;this._rasterizationCanvas.height=f;var b=this._rasterizationCanvas.getContext("2d");d instanceof ImageData?b.putImageData(d,0,0):(d.setAttribute("width",`${n}px`),d.setAttribute("height",`${f}px`),b.drawImage(d,0,0,n,f));d=b.getImageData(0,0,n,f);d=new Uint8Array(d.data);if(a)for(var e of a)if(e&&e.oldColor&&4===e.oldColor.length&&e.newColor&&4===e.newColor.length){const [l,k,r,g]=e.oldColor,[c,m,q,p]=e.newColor;if(l!==c||k!==m||r!==q||g!==p)for(a=0;a<d.length;a+=4)l===d[a]&&k===d[a+1]&&r===d[a+
2]&&g===d[a+3]&&(d[a]=c,d[a+1]=m,d[a+2]=q,d[a+3]=p)}for(a=0;a<d.length;a+=4)e=d[a+3]/255,d[a]*=e,d[a+1]*=e,d[a+2]*=e;b=d;e=n;a=f;if(512<=e||512<=a){b=e/a;1<b?(e=512,a=Math.round(512/b)):(a=512,e=Math.round(512*b));b=new Uint8Array(4*e*a);const l=new Uint8ClampedArray(b.buffer);B.resampleHermite(d,n,f,l,e,a,!1)}return{size:[e,a],image:new Uint32Array(b.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return y}()})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../Color ../../core/BidiText ../../core/floatRGBA ../../core/lang ../../core/Logger ../../core/mathUtils ../../core/maybe ../../core/RandomLCG ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ./CIMPlacements ./CIMSymbolDrawHelper ./enums ./utils ../../views/2d/engine/vectorTiles/GeometryUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g,c,m,q){function p(V,L){switch(L.type){case "CIMSymbolReference":return p(V,L.symbol);case "CIMPointSymbol":V.drawSymbol(L,{x:0,y:0});break;case "CIMLineSymbol":V.drawSymbol(L,{paths:[[[0,0],[0,1]]]});break;case "CIMPolygonSymbol":V.drawSymbol(L,{rings:[[[0,0],[0,1],[0,0]]]});break;case "CIMTextSymbol":V.drawSymbol(L,{x:0,y:0});break;case "CIMVectorMarker":{const P=new l.Placement;V.drawMarker(L,P)}}return V.envelope()}function u(V){if(!V)return 0;switch(V.type){case "CIMMarkerPlacementAlongLineSameSize":return Math.abs(V.offset);
case "CIMMarkerPlacementAlongLineRandomSize":return Math.abs(V.offset);case "CIMMarkerPlacementAtExtremities":return Math.abs(V.offset);case "CIMMarkerPlacementAtMeasuredUnits":return Math.abs(V.offset);case "CIMMarkerPlacementAtRatioPositions":return Math.abs(V.offset);case "CIMMarkerPlacementInsidePolygon":return 0;case "CIMMarkerPlacementOnLine":return Math.abs(V.offset);case "CIMMarkerPlacementOnVertices":return Math.abs(V.offset);case "CIMMarkerPlacementPolygonCenter":return 0;default:return 0}}
function h(V){if(!V)return 0;switch(V.type){case "CIMGeometricEffectArrow":return Math.abs(.5*V.width);case "CIMGeometricEffectBuffer":return Math.abs(V.size);case "CIMGeometricEffectExtension":return Math.abs(V.length);case "CIMGeometricEffectJog":return Math.abs(.5*V.length);case "CIMGeometricEffectMove":return Math.max(Math.abs(g.getValue(V.offsetX)),Math.abs(g.getValue(V.offsetY)));case "CIMGeometricEffectOffset":return Math.abs(V.offset);case "CIMGeometricEffectOffsetTangent":return Math.abs(V.offset);
case "CIMGeometricEffectRadial":return Math.abs(V.length);case "CIMGeometricEffectRegularPolygon":return Math.abs(V.radius);case "CIMGeometricEffectRotate":return 0;case "CIMGeometricEffectScale":return 0;case "CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(V.fromWidth),Math.abs(V.toWidth));case "CIMGeometricEffectWave":return Math.abs(V.amplitude);default:return 0}}function t(V){if(!V)return 0;let L=0;for(const P of V)L+=h(P);return L}const v=Math.PI,w=v/2,A=96/72,E=Math.PI/180,G=x.getLogger("esri.symbols.cim.CIMSymbolHelper");
x=function(){function V(){}var L=V.prototype;L.getSymbolInflateSize=function(P,Y,U,Q,W){P||(P=[0,0,0,0]);return Y?this._getInflateSize(P,Y,U,Q,W):P};V.safeSize=function(P){const Y=Math.max(Math.abs(P[0]),Math.abs(P[2]));P=Math.max(Math.abs(P[1]),Math.abs(P[3]));return Math.sqrt(Y*Y+P*P)};L._vectorMarkerBounds=function(P,Y,U,Q){let W=!0;const R=b.create();if(Y&&Y.markerGraphics)for(const S of Y.markerGraphics)Y=[0,0,0,0],S.geometry&&(e.getBoundsXY(R,S.geometry),Y[0]=0,Y[1]=0,Y[2]=0,Y[3]=0,this.getSymbolInflateSize(Y,
S.symbol,U,0,Q),R[0]+=Y[0],R[1]+=Y[1],R[2]+=Y[2],R[3]+=Y[3],W?(P[0]=R[0],P[1]=R[1],P[2]=R[2],P[3]=R[3],W=!1):(P[0]=Math.min(P[0],R[0]),P[1]=Math.min(P[1],R[1]),P[2]=Math.max(P[2],R[2]),P[3]=Math.max(P[3],R[3])));return P};L._getInflateSize=function(P,Y,U,Q,W){return void 0!==Y.symbolLayers?(P=this._getLayersInflateSize(P,Y.symbolLayers,U,Q,W),Y=t(Y.effects),0<Y&&(P[0]-=Y,P[1]-=Y,P[2]+=Y,P[3]+=Y),P):this._getTextInflatedSize(P,Y,W)};L._getLayersInflateSize=function(P,Y,U,Q,W){let R=!0;if(!Y)return P;
for(const da of Y)if(da){var S=[0,0,0,0];switch(da.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":Y=da;var Z=Y.width;Z=Y.capStyle===r.LineCapStyle.Square||Y.joinStyle===r.LineJoinStyle.Miter?Z/1.4142135623730951:Z/2;S[0]=-Z;S[1]=-Z;S[2]=Z;S[3]=Z;break;case "CIMCharacterMarker":case "CIMVectorMarker":case "CIMPictureMarker":Y=da;if("CIMVectorMarker"===da.type){if(Z=da,S=this._vectorMarkerBounds(S,Z,U,W),Z.frame){var ca=(Z.frame.xmin+Z.frame.xmax)/2,ia=(Z.frame.ymin+Z.frame.ymax)/
2;S[0]-=ca;S[1]-=ia;S[2]-=ca;S[3]-=ia;Z=Z.size/(Z.frame.ymax-Z.frame.ymin);S[0]*=Z;S[1]*=Z;S[2]*=Z;S[3]*=Z}}else"CIMPictureMarker"===da.type?(S=da,ca=U.getResource(S.url),Z=1,f.isSome(ca)&&ca.height&&(Z=ca.width/ca.height),ca=Y.size/2,S=Y.size*Z*S.scaleX/2,S=[-S,-ca,S,ca]):(S=Y.size/2,S=[-S,-S,S,S]);Y.anchorPoint&&("Absolute"===Y.anchorPointUnits?(Z=Y.anchorPoint.x,ca=Y.anchorPoint.y):(Z=Y.anchorPoint.x*(S[2]-S[0]),ca=Y.anchorPoint.y*(S[3]-S[1])),S[0]-=Z,S[1]-=ca,S[2]-=Z,S[3]-=ca);Z=g.getValue(Y.rotation);
Y.rotateClockwise&&(Z=-Z);Q&&(Z-=Q);Z&&(ca=E*Z,Z=Math.cos(ca),ca=Math.sin(ca),ia=b.create([c.C_INFINITY,c.C_INFINITY,-c.C_INFINITY,-c.C_INFINITY]),b.expandPointInPlace(ia,[S[0]*Z-S[1]*ca,S[0]*ca+S[1]*Z]),b.expandPointInPlace(ia,[S[0]*Z-S[3]*ca,S[0]*ca+S[3]*Z]),b.expandPointInPlace(ia,[S[2]*Z-S[1]*ca,S[2]*ca+S[1]*Z]),b.expandPointInPlace(ia,[S[2]*Z-S[3]*ca,S[2]*ca+S[3]*Z]),S=ia);Z=g.getValue(Y.offsetX);ca=g.getValue(Y.offsetY);if(Q){var T=E*Q;ia=Math.cos(T);T=Math.sin(T);const fa=Z*T+ca*ia;Z=Z*ia-
ca*T;ca=fa}S[0]+=Z;S[1]+=ca;S[2]+=Z;S[3]+=ca;Y=u(Y.markerPlacement);0<Y&&(S[0]-=Y,S[1]-=Y,S[2]+=Y,S[3]+=Y)}Y=t(da.effects);0<Y&&(S[0]-=Y,S[1]-=Y,S[2]+=Y,S[3]+=Y);R?(P[0]=S[0],P[1]=S[1],P[2]=S[2],P[3]=S[3],R=!1):(P[0]=Math.min(P[0],S[0]),P[1]=Math.min(P[1],S[1]),P[2]=Math.max(P[2],S[2]),P[3]=Math.max(P[3],S[3]))}return P};L._getTextInflatedSize=function(P,Y,U){var Q,W;const R=null!=(Q=Y.height)?Q:10;P[0]=-R/2;P[1]=-R/2;P[2]=R/2;P[3]=R/2;if(!U)return P;U=U.get(Y);if(!U)return P;const {text:S,mosaicItem:Z}=
U;if(!Z||0===Z.glyphMosaicItems.length)return P;U=k.lineGapType2LineHeight(Y.lineGapType,null!=(W=Y.lineGap)?W:0,R);W=C.bidiText(S)[1];Y=q.shapeGlyphs(Z.glyphMosaicItems,W,{scale:R/m.GLYPH_SIZE,angle:g.getValue(Y.angle),xOffset:g.getValue(Y.offsetX),yOffset:g.getValue(Y.offsetY),hAlign:k.horizontalAlignment2HAlign(Y.horizontalAlignment),vAlign:k.verticalAlignment2VAlign(Y.verticalAlignment),maxLineWidth:512,lineHeight:m.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(U||1,4)),decoration:Y.font.decoration||
"none",isCIM:!0}).boundsT;P[0]=Y.x-Y.halfWidth;P[1]=-Y.y-Y.halfHeight;P[2]=Y.x+Y.halfWidth;P[3]=-Y.y+Y.halfHeight;return P};return V}();let F=function(){function V(){}V.getEnvelope=function(L,P){P=new k.EnvDrawHelper(P);if(Array.isArray(L)){let Y;for(const U of L)Y?Y.union(p(P,U)):Y=p(P,U);return Y}return p(P,L)};V.getTextureAnchor=function(L,P){L=this.getEnvelope(L,P);if(!L)return[0,0,0];P=L.height*A+2;return[(L.x+.5*L.width)*A/(L.width*A+2),-(L.y+.5*L.height)*A/P,P]};V.rasterize=function(L,P,Y,
U,Q=!0){var W=Y||this.getEnvelope(P,U);if(!W)return[null,0,0,0,0];const R=(W.x+.5*W.width)*A,S=(W.y+.5*W.height)*A;L.width=W.width*A;L.height=W.height*A;Y||(L.width+=2,L.height+=2);Y=L.getContext("2d");W=k.Transformation.createScale(A,-A);W.translate(.5*L.width-R,.5*L.height+S);U=new k.CanvasDrawHelper(Y,U,W);switch(P.type){case "CIMPointSymbol":U.drawSymbol(P,{type:"point",x:0,y:0});break;case "CIMVectorMarker":W=new l.Placement,U.drawMarker(P,W)}P=Y.getImageData(0,0,L.width,L.height);P=new Uint8Array(P.data);
if(Q)for(U=0;U<P.length;U+=4)Q=P[U+3]/255,P[U]*=Q,P[U+1]*=Q,P[U+2]*=Q;return[P,L.width,L.height,-R/L.width,-S/L.height]};V.fromTextSymbol=function(L){const {angle:P,color:Y,font:U,haloColor:Q,haloSize:W,horizontalAlignment:R,kerning:S,text:Z,verticalAlignment:ca,xoffset:ia,yoffset:T}=L;let da,fa;if(U){var ka=U.family;var ea=U.style;var ha=U.weight;da=U.size;fa=U.decoration}L=!1;Z&&(L=C.bidiText(Z)[1]);var ja=r.BlockProgression.BTT,la=r.FontEffects.Normal,ma=r.FontEncoding.Unicode;ka=ka||"Arial";b:{if(ha)switch(ha.toLowerCase()){case "bold":case "bolder":ha=
"bold";break b}ha=""}b:{if(ea)switch(ea.toLowerCase()){case "italic":case "oblique":ea="italic";break b}ea=""}ha=ha&&ea?`${ha}-${ea}`:`${ha}${ea}`;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:P,blockProgression:ja,depth3D:1,extrapolateBaselines:!0,
fontEffects:la,fontEncoding:ma,fontFamilyName:ka,fontStyleName:ha,fontType:r.FontType.Unspecified,haloSize:W,height:da,hinting:r.GlyphHinting.Default,horizontalAlignment:M(null!=R?R:"center"),kerning:S,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:g.getValue(ia),offsetY:g.getValue(T),strikethrough:"line-through"===fa,underline:"underline"===fa,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:O(Y)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",
enable:!0,color:O(Q)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:L?r.TextReadingDirection.RTL:r.TextReadingDirection.LTR,verticalAlignment:K(null!=ca?ca:"baseline"),verticalGlyphOrientation:r.VerticalGlyphOrientation.Right,wordSpacing:100,billboardMode3D:r.BillBoardMode.FaceNearPlane},textString:Z}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}};V.fromPictureFillSymbol=function(L){const {height:P,outline:Y,width:U,
xoffset:Q,xscale:W,yoffset:R,yscale:S}=L,Z=[],ca={type:"CIMPolygonSymbol",symbolLayers:Z};if(Y){const {cap:T,join:da,miterLimit:fa,width:ka}=Y;Z.push({type:"CIMSolidStroke",color:O(Y.color),capStyle:I(T),joinStyle:N(da),miterLimit:fa,width:ka})}let ia=L.url;"esriPFS"===L.type&&L.imageData&&(ia=L.imageData);L="angle"in L?L.angle:0;Z.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:r.TextureFilter.Picture,tintColor:null,url:ia,height:P*(S||1),width:U*(W||1),offsetX:g.getValue(Q),
offsetY:g.getValue(R),rotation:g.getValue(-L),colorSubstitutions:null});return ca};V.fromSimpleFillSymbol=function(L){const {color:P,style:Y,outline:U}=L;L=[];const Q={type:"CIMPolygonSymbol",symbolLayers:L};var W=null;if(U){const {cap:S,join:Z,style:ca}=U;"solid"!==ca&&"none"!==ca&&"esriSLSSolid"!==ca&&"esriSLSNull"!==ca&&(W=[{type:"CIMGeometricEffectDashes",dashTemplate:X(ca,S),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);L.push({type:"CIMSolidStroke",color:O(U.color),capStyle:I(S),
joinStyle:N(Z),miterLimit:U.miterLimit,width:U.width,effects:W})}if(Y&&"solid"!==Y&&"none"!==Y&&"esriSFSSolid"!==Y&&"esriSFSNull"!==Y){W={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:O(P),capStyle:r.LineCapStyle.Butt,joinStyle:r.LineJoinStyle.Miter,width:.75}]};let S=0;var R=n.nextPowerOfTwo(Math.ceil(window.devicePixelRatio));R=ba(Y)?8*R:10*R;switch(Y){case "vertical":case "esriSFSVertical":S=90;break;case "forward-diagonal":case "esriSFSForwardDiagonal":S=-45;break;case "backward-diagonal":case "esriSFSBackwardDiagonal":S=
45;break;case "cross":case "esriSFSCross":S=0;break;case "diagonal-cross":case "esriSFSDiagonalCross":S=-45}L.push({type:"CIMHatchFill",lineSymbol:W,offsetX:0,offsetY:0,rotation:S,separation:R});"cross"===Y||"esriSFSCross"===Y?L.push({type:"CIMHatchFill",lineSymbol:y.clone(W),offsetX:0,offsetY:0,rotation:90,separation:R}):("diagonal-cross"===Y||"esriSFSDiagonalCross"===Y)&&L.push({type:"CIMHatchFill",lineSymbol:y.clone(W),offsetX:0,offsetY:0,rotation:45,separation:R})}else!Y||"solid"!==Y&&"esriSFSSolid"!==
Y||L.push({type:"CIMSolidFill",enable:!0,color:O(P)});return Q};V.fromSimpleLineSymbol=function(L){const {cap:P,color:Y,join:U,marker:Q,miterLimit:W,style:R,width:S}=L;L=null;"solid"!==R&&"none"!==R&&"esriSLSSolid"!==R&&"esriSLSNull"!==R&&(L=[{type:"CIMGeometricEffectDashes",dashTemplate:X(R,P),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const Z=[];if(Q){let ca;switch(Q.placement){case "begin-end":ca=r.ExtremityPlacement.Both;break;case "begin":ca=r.ExtremityPlacement.JustBegin;
break;case "end":ca=r.ExtremityPlacement.JustEnd;break;default:ca=r.ExtremityPlacement.None}const ia=V.fromSimpleMarker(Q,S,Y).symbolLayers[0];ia.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:ca,offsetAlongLine:0};Z.push(ia)}"none"!==R&&"esriSLSNull"!==R&&Z.push({type:"CIMSolidStroke",color:O(Y),capStyle:I(P),joinStyle:N(U),miterLimit:W,width:S,effects:L});return{type:"CIMLineSymbol",symbolLayers:Z}};V.fromPictureMarker=function(L){const {angle:P,
height:Y,width:U,xoffset:Q,yoffset:W}=L;let R=L.url;"esriPMS"===L.type&&L.imageData&&(R=L.imageData);return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:r.TextureFilter.Picture,tintColor:null,url:R,size:Y,width:U,offsetX:g.getValue(Q),offsetY:g.getValue(W),rotation:g.getValue(-P)}]}};V.fromSimpleMarker=function(L,P,Y){var U,{style:Q}=L;Y=null!=(U=L.color)?U:Y;if("path"===Q){P=[];"outline"in L&&L.outline&&(U=L.outline,P.push({type:"CIMSolidStroke",
enable:!0,width:a.pt2px(Math.round(a.px2pt(U.width))),color:O(U.color)}));P.push({type:"CIMSolidFill",enable:!0,color:O(Y),path:L.path});const [Z,ca]=aa("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:g.getValue(-L.angle),size:g.getValue(L.size||6),offsetX:g.getValue(L.xoffset),offsetY:g.getValue(L.yoffset),frame:Z,markerGraphics:[{type:"CIMMarkerGraphic",geometry:ca,symbol:{type:"CIMPolygonSymbol",symbolLayers:P}}]}]}}const [W,R]=aa(Q);let S;R&&W&&
(U=[],"outline"in L&&L.outline?(Q=L.outline,U.push({type:"CIMSolidStroke",enable:!0,width:.667<Q.width?a.pt2px(Math.round(a.px2pt(Q.width))):Q.width,color:O(Q.color)})):!P||"line-marker"!==L.type||"cross"!==L.style&&"x"!==L.style||U.push({type:"CIMSolidStroke",enable:!0,width:P,color:O(Y)}),U.push({type:"CIMSolidFill",enable:!0,color:O(Y)}),Y={type:"CIMPolygonSymbol",symbolLayers:U},S={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:g.getValue(-L.angle),size:g.getValue(L.size||
6*P),offsetX:g.getValue(L.xoffset),offsetY:g.getValue(L.yoffset),frame:W,markerGraphics:[{type:"CIMMarkerGraphic",geometry:R,symbol:Y}]}]});return S};V.fromCIMHatchFill=function(L){var P;const Y=null!=(P=L.separation)?P:4;P=Y/2;const U=L.lineSymbol;for(L=this._getLineSymbolPeriod(L.lineSymbol)||4;4>L;)L*=2;L/=2;return{type:"CIMVectorMarker",frame:{xmin:-L,xmax:L,ymin:-P,ymax:P},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-L,0],[L,0]]]},symbol:U}],size:Y}};V._getLineSymbolPeriod=function(L){if(L){const P=
this._getEffectsRepeat(L.effects);if(P)return P;if(L.symbolLayers)for(const Y of L.symbolLayers)if(Y){if(L=this._getEffectsRepeat(Y.effects))return L;switch(Y.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":if(L=this._getPlacementRepeat(Y.markerPlacement))return L}}}return 0};V._getEffectsRepeat=function(L){if(L)for(var P of L)if(P)switch(P.type){case "CIMGeometricEffectDashes":if((L=P.dashTemplate)&&L.length){P=0;for(const Y of L)P+=
Y;L.length&1&&(P*=2);return P}break;case "CIMGeometricEffectWave":return P.period;default:G.error(`unsupported geometric effect type ${P.type}`)}return 0};V._getPlacementRepeat=function(L){if(L)switch(L.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((L=L.placementTemplate)&&L.length){let P=0;for(const Y of L)P+=Y;L.length&1&&(P*=2);return P}}return 0};V.fromCIMInsidePolygon=function(L){var P,Y=L.markerPlacement;
const U={type:L.type,...L,markerPlacement:null,anchorPoint:null};L=Math.abs(Y.stepX);const Q=Math.abs(Y.stepY);var W=(null!=(P=Y.randomness)?P:100)/100;let R,S;if("Random"===Y.gridType){P=a.px2pt(m.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const Z=Math.max(Math.floor(P/L),1),ca=Math.max(Math.floor(P/Q),1);P=Z*L/2;R=ca*Q/2;S=2*R;Y=new d(Y.seed);const ia=W*L/1.5,T=W*Q/1.5;W=[];for(let da=0;da<Z;da++)for(let fa=0;fa<ca;fa++){const ka=da*L-P+ia*(.5-Y.getFloat()),ea=fa*Q-R+T*(.5-Y.getFloat());W.push({x:ka,y:ea});
0===da&&W.push({x:ka+2*P,y:ea});0===fa&&W.push({x:ka,y:ea+2*R})}}else!0===Y.shiftOddRows?(P=L/2,R=Q,S=2*Q,W=[{x:-P,y:0},{x:P,y:0},{x:0,y:R},{x:0,y:-R}]):(P=L/2,R=Q/2,S=Q,W=[{x:0,y:0}]);L=W.map(Z=>({type:"CIMMarkerGraphic",geometry:Z,symbol:{type:"CIMPointSymbol",symbolLayers:[U]}}));return{type:"CIMVectorMarker",frame:{xmin:-P,xmax:P,ymin:-R,ymax:R},markerGraphics:L,size:S}};V.getFillColor=function(L){if(!L)return null;switch(L.type){case "CIMPolygonSymbol":if(L.symbolLayers)for(const P of L.symbolLayers)if(L=
V.getFillColor(P),null!=L)return L;break;case "CIMTextSymbol":return V.getFillColor(L.symbol);case "CIMSolidFill":return L.color}};V.getStrokeColor=function(L){if(L)switch(L.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(L.symbolLayers)for(const P of L.symbolLayers)if(L=V.getStrokeColor(P),void 0!==L)return L;break;case "CIMTextSymbol":return V.getStrokeColor(L.symbol);case "CIMSolidStroke":return L.color}};V.getStrokeWidth=function(L){if(L)switch(L.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(L.symbolLayers)for(const P of L.symbolLayers)if(L=
V.getStrokeWidth(P),void 0!==L)return L;break;case "CIMTextSymbol":return V.getStrokeWidth(L.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return L.width}};V.getSize=function(L){if(L)switch(L.type){case "CIMTextSymbol":return L.height;case "CIMPointSymbol":var P=0;if(L.symbolLayers)for(var Y of L.symbolLayers)if(Y)switch(Y.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":L=Y.size,L>P&&(P=
L)}return P;case "CIMLineSymbol":case "CIMPolygonSymbol":Y=0;if(L.symbolLayers)for(P of L.symbolLayers)if(P)switch(P.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":L=P.width;L>Y&&(Y=L);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":g.isCIMMarkerStrokePlacement(P.markerPlacement)&&(L=P.size,L>Y&&(Y=L))}return Y}};V.getMarkerScaleRatio=function(L){if(L)switch(L.type){case "CIMVectorMarker":if(!1!==
L.scaleSymbolsProportionally&&L.frame)return L.size/(L.frame.ymax-L.frame.ymin)}return 1};return V}(),H=function(){function V(){}V.rasterizeSimpleFill=function(L,P,Y){"solid"!==P&&"none"!==P&&"esriSFSSolid"!==P&&"esriSFSNull"!==P||console.error("Unexpected: style does not require rasterization");Y=n.nextPowerOfTwo(Math.ceil(Y));var U=ba(P)?8*Y:16*Y;const Q=2*Y;L.width=U;L.height=U;const W=L.getContext("2d");W.strokeStyle="#FFFFFF";W.lineWidth=Y;W.beginPath();if("vertical"===P||"cross"===P||"esriSFSCross"===
P||"esriSFSVertical"===P)W.moveTo(U/2,-Q),W.lineTo(U/2,U+Q);if("horizontal"===P||"cross"===P||"esriSFSCross"===P||"esriSFSHorizontal"===P)W.moveTo(-Q,U/2),W.lineTo(U+Q,U/2);if("forward-diagonal"===P||"diagonal-cross"===P||"esriSFSDiagonalCross"===P||"esriSFSForwardDiagonal"===P)W.moveTo(-Q,-Q),W.lineTo(U+Q,U+Q),W.moveTo(U-Q,-Q),W.lineTo(U+Q,Q),W.moveTo(-Q,U-Q),W.lineTo(Q,U+Q);if("backward-diagonal"===P||"diagonal-cross"===P||"esriSFSBackwardDiagonal"===P||"esriSFSDiagonalCross"===P)W.moveTo(U+Q,-Q),
W.lineTo(-Q,U+Q),W.moveTo(Q,-Q),W.lineTo(-Q,Q),W.moveTo(U+Q,U-Q),W.lineTo(U-Q,U+Q);W.stroke();P=W.getImageData(0,0,L.width,L.height);P=new Uint8Array(P.data);for(U=0;U<P.length;U+=4)Y=P[U+3]/255,P[U]*=Y,P[U+1]*=Y,P[U+2]*=Y;return[P,L.width,L.height]};V.rasterizeSimpleLine=function(L,P){return this.rasterizeDash(L,P)};V.rasterizeDash=function(L,P){var Y="Butt"===P,U="Square"===P;P=!Y&&!U;1===L.length%2&&(L=[...L,...L]);var Q=0;for(var W of L)Q+=W;W=Math.round(15.5*Q);Q=new Float32Array(31*W);let R=
0,S=0,Z=.5,ca=!0;for(var ia of L){R=S;for(S+=15.5*ia;Z<=S;){for(L=.5;31>L;){const T=P?(L-15.5)*(L-15.5):Math.abs(L-15.5);Q[(L-.5)*W+Z-.5]=ca?Y?Math.max(Math.max(R+7.75-Z,T),Math.max(Z-S+7.75,T)):T:P?Math.min((Z-R)*(Z-R)+T,(Z-S)*(Z-S)+T):U?Math.min(Math.max(Z-R,T),Math.max(S-Z,T)):Math.min(Math.max(Z-R+7.75,T),Math.max(S+7.75-Z,T));L++}Z++}ca=!ca}Y=Q.length;ia=new Uint8Array(4*Y);for(U=0;U<Y;++U)B.packFloatRGBA((P?Math.sqrt(Q[U]):Q[U])/15.5,ia,4*U);return[ia,W,31]};return V}(),J=function(){function V(){}
V.findApplicableOverrides=function(L,P,Y){if(L&&P){if(L.primitiveName){let U=!1;for(const Q of Y)if(Q.primitiveName===L.primitiveName){U=!0;break}if(!U)for(const Q of P)Q.primitiveName===L.primitiveName&&Y.push(Q)}switch(L.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(L.effects)for(const U of L.effects)V.findApplicableOverrides(U,P,Y);if(L.symbolLayers)for(const U of L.symbolLayers)V.findApplicableOverrides(U,P,Y);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(L.effects)for(const U of L.effects)V.findApplicableOverrides(U,
P,Y);L.markerPlacement&&V.findApplicableOverrides(L.markerPlacement,P,Y);if("CIMVectorMarker"===L.type){if(L.markerGraphics)for(const U of L.markerGraphics)V.findApplicableOverrides(U,P,Y),V.findApplicableOverrides(U.symbol,P,Y)}else"CIMCharacterMarker"===L.type?V.findApplicableOverrides(L.symbol,P,Y):"CIMHatchFill"===L.type?V.findApplicableOverrides(L.lineSymbol,P,Y):"CIMPictureMarker"===L.type&&V.findApplicableOverrides(L.animatedSymbolProperties,P,Y)}}};V.findEffectOverrides=function(L,P,Y){if(P&&
L){var U=L.length;for(let W=0;W<U;W++){var Q=L[W];if(Q=null==Q?void 0:Q.primitiveName){let R=!1;for(const S of Y)if(S.primitiveName===Q){R=!0;break}if(!R)for(const S of P)S.primitiveName===Q&&Y.push(S)}}}};V.applyOverrides=function(L,P,Y,U){if(P){if(L.primitiveName)for(const W of P)if(W.primitiveName===L.primitiveName){var Q=(Q=W.propertyName)?Q.charAt(0).toLowerCase()+Q.substr(1):Q;U&&U.push({cim:L,nocapPropertyName:Q,value:L[Q]});W.expression&&(W.value=V.toValue(W.propertyName,W.expression));if(Y){let R=
!1;for(const S of Y)S.primitiveName===L.primitiveName&&(R=!0);R||Y.push(W)}L[Q]=W.value}switch(L.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(L.effects)for(const W of L.effects)V.applyOverrides(W,P,Y,U);if(L.symbolLayers)for(const W of L.symbolLayers)V.applyOverrides(W,P,Y,U);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(L.effects)for(const W of L.effects)V.applyOverrides(W,P,Y,U);if("CIMVectorMarker"===L.type&&L.markerGraphics)for(const W of L.markerGraphics)V.applyOverrides(W,
P,Y,U),V.applyOverrides(W.symbol,P,Y,U)}}};V.restoreOverrides=function(L){for(const P of L)P.cim[P.nocapPropertyName]=P.value};V.buildOverrideKey=function(L){let P="";for(const Y of L)void 0!==Y.value&&(P+=`${Y.primitiveName}${Y.propertyName}${JSON.stringify(Y.value)}`);return P};V.toValue=function(L,P){return"DashTemplate"===L?P.split(" ").map(Y=>Number(Y)):"Color"===L?(L=(new D(P)).toRgba(),L[3]*=255,L):P};return V}();const I=V=>{if(!V)return r.LineCapStyle.Butt;switch(V){case "butt":return r.LineCapStyle.Butt;
case "square":return r.LineCapStyle.Square;case "round":return r.LineCapStyle.Round}},N=V=>{if(!V)return r.LineJoinStyle.Miter;switch(V){case "miter":return r.LineJoinStyle.Miter;case "round":return r.LineJoinStyle.Round;case "bevel":return r.LineJoinStyle.Bevel}},M=V=>{if(f.isNone(V))return"Center";switch(V){case "left":return"Left";case "right":return"Right";case "center":return"Center"}},K=V=>{if(f.isNone(V))return"Center";switch(V){case "baseline":return"Baseline";case "top":return"Top";case "middle":return"Center";
case "bottom":return"Bottom"}},O=V=>{if(!V)return[0,0,0,0];const {r:L,g:P,b:Y,a:U}=V;return[L,P,Y,255*U]},X=(V,L)=>{L="butt"===L;switch(V){case "dash":case "esriSLSDash":return L?[4,3]:[3,4];case "dash-dot":case "esriSLSDashDot":return L?[4,3,1,3]:[3,4,0,4];case "dot":case "esriSLSDot":return L?[1,3]:[0,4];case "long-dash":case "esriSLSLongDash":return L?[8,3]:[7,4];case "long-dash-dot":case "esriSLSLongDashDot":return L?[8,3,1,3]:[7,4,0,4];case "long-dash-dot-dot":case "esriSLSDashDotDot":return L?
[8,3,1,3,1,3]:[7,4,0,4,0,4];case "short-dash":case "esriSLSShortDash":return L?[4,1]:[3,2];case "short-dash-dot":case "esriSLSShortDashDot":return L?[4,1,1,1]:[3,2,0,2];case "short-dash-dot-dot":case "esriSLSShortDashDotDot":return L?[4,1,1,1,1,1]:[3,2,0,2,0,2];case "short-dot":case "esriSLSShortDot":return L?[1,1]:[0,2];case "solid":case "esriSLSSolid":case "none":return G.error("Unexpected: style does not require rasterization"),[0,0];default:return G.error(`Tried to rasterize SLS, but found an unexpected style: ${V}!`),
[0,0]}},aa=V=>{if("circle"===V||"esriSMSCircle"===V){var L=Math.acos(.995);V=Math.ceil(v/L/4);0===V&&(V=1);L=w/V;V*=4;var P=[];P.push([50,0]);for(let Y=1;Y<V;Y++)P.push([50*Math.cos(Y*L),-50*Math.sin(Y*L)]);P.push([50,0]);L={rings:[P]};P={xmin:-50,ymin:-50,xmax:50,ymax:50}}else"cross"===V||"esriSMSCross"===V?(L={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,50],[0,50]]]},P={xmin:-50,ymin:-50,xmax:50,ymax:50}):"diamond"===V||"esriSMSDiamond"===V?(L=
{rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},P={xmin:-50,ymin:-50,xmax:50,ymax:50}):"square"===V||"esriSMSSquare"===V?(L={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},P={xmin:-50,ymin:-50,xmax:50,ymax:50}):"x"===V||"esriSMSX"===V?(L={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},P={xmin:-50,ymin:-50,xmax:50,ymax:50}):"triangle"===V||"esriSMSTriangle"===V?(V=2/3*100,P=V-100,L={rings:[[[-57.735026918962575,P],[0,V],
[57.735026918962575,P],[-57.735026918962575,P]]]},P={xmin:-57.735026918962575,ymin:P,xmax:57.735026918962575,ymax:V}):"arrow"===V&&(L={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},P={xmin:-50,ymin:-50,xmax:50,ymax:50});return[P,L]},ba=V=>"vertical"===V||"horizontal"===V||"cross"===V||"esriSFSCross"===V||"esriSFSVertical"===V||"esriSFSHorizontal"===V;z.CIMSimbolInflatedSizeHelper=x;z.CIMSymbolHelper=F;z.OverrideHelper=J;z.SymbolHelper=H;z.slsDashToTemplateArray=X;z.symbolToCIM=
function(V){if(!V||!V.type)return null;let L;switch(V.type){case "cim":return V.data;case "web-style":return V;case "simple-marker":L=F.fromSimpleMarker(V);break;case "picture-marker":L=F.fromPictureMarker(V);break;case "simple-line":L=F.fromSimpleLineSymbol(V);break;case "simple-fill":L=F.fromSimpleFillSymbol(V);break;case "picture-fill":L=F.fromPictureFillSymbol(V);break;case "text":L=F.fromTextSymbol(V)}return{type:"CIMSymbolReference",symbol:L}};Object.defineProperties(z,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/floatRGBA":function(){define(["exports","./mathUtils"],function(z,D){function C(f,d=0){let a=0;for(let b=0;4>b;b++)a+=f[d+b]*x[b];return a}function B(f){return f-Math.floor(f)}const y=[1,256,65536,16777216],x=[1/256,1/65536,1/16777216,1/4294967296],n=C(new Uint8ClampedArray([255,255,255,255]));z.packFloatRGBA=function(f,d,a=0){f=D.clamp(f,0,n);for(let b=0;4>b;b++)d[a+b]=Math.floor(256*B(f*y[b]))};z.unpackFloatRGBA=C;Object.defineProperties(z,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports"],function(z){let D=function(){function B(){this.setIdentity()}var y=B.prototype;y.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)this.rz=Math.atan2(this.rz_s,this.rz_c);return this.rz};y.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};y.setTranslate=function(x,n){this.tx=x;this.ty=n};y.setTranslateZ=function(x){this.tz=
x};y.setRotateCS=function(x,n){this.rz=void 0;this.rz_c=x;this.rz_s=n};y.setRotate=function(x){this.rz=x;this.rz_s=this.rz_c=void 0};y.setRotateY=function(x){this.ry=x};y.setScale=function(x){this.s=x};y.setMeasure=function(x){this.m=x};return B}(),C=function(){function B(){}B.prototype.next=function(){return null};return B}();z.EmptyPlacementCursor=C;z.Placement=D;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/BidiText ../../core/Logger ../../core/maybe ../../core/ObjectPool ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/centroid ../../geometry/support/jsonUtils ./CIMEffects ./CIMOperators ./CIMPlacements ./CIMResourceManager ./enums ./Rect ./TextRasterizer ../../views/2d/engine/webgl/alignmentUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g,c,m,q,p,u){const h=Math.PI/180,t=B.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let v=function(){function I(M){this._t=M}I.createIdentity=function(){return new I([1,0,0,0,1,0])};var N=I.prototype;N.clone=function(){return new I(this._t.slice())};N.transform=function(M){const K=this._t;return[K[0]*M[0]+K[1]*M[1]+K[2],K[3]*M[0]+K[4]*M[1]+K[5]]};I.createScale=function(M,K){return new I([M,0,0,0,K,0])};N.scale=function(M,K){const O=this._t;O[0]*=M;O[1]*=M;
O[2]*=M;O[3]*=K;O[4]*=K;O[5]*=K;return this};N.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};I.createTranslate=function(M,K){return new I([0,0,M,0,0,K])};N.translate=function(M,K){const O=this._t;O[2]+=M;O[5]+=K;return this};I.createRotate=function(M){const K=Math.cos(M);M=Math.sin(M);return new I([K,-M,0,M,K,0])};N.rotate=function(M){return I.multiply(this,I.createRotate(M),this)};I.multiply=function(M,K,O){M=M._t;K=K._t;const X=M[1]*K[0]+M[4]*K[1],aa=M[2]*
K[0]+M[5]*K[1]+K[2],ba=M[0]*K[3]+M[3]*K[4],V=M[1]*K[3]+M[4]*K[4],L=M[2]*K[3]+M[5]*K[4]+K[5],P=O._t;P[0]=M[0]*K[0]+M[3]*K[1];P[1]=X;P[2]=aa;P[3]=ba;P[4]=V;P[5]=L;return O};N.invert=function(){const M=this._t;let K=M[0]*M[4]-M[1]*M[3];if(0===K)return new I([0,0,0,0,0,0]);K=1/K;return new I([M[4]*K,-M[1]*K,(M[1]*M[5]-M[2]*M[4])*K,-M[3]*K,M[0]*K,(M[2]*M[3]-M[0]*M[5])*K])};return I}();B=function(){function I(M,K){this._transfos=[];this._sizeTransfos=[];this._geomUnitsPerPoint=1;this._placementPool=new x(k.Placement,
null,null,100);this._earlyReturn=!1;this._mapRotation=0;this._resourceManager=M||new r;this._transfos.push(K||v.createIdentity());this._sizeTransfos.push(K?K.scaleRatio():1)}var N=I.prototype;N.setTransform=function(M,K){this._transfos=[M||v.createIdentity()];this._sizeTransfos=[K?K:M?M.scaleRatio():1]};N.setGeomUnitsPerPoint=function(M){this._geomUnitsPerPoint=M};N.transformPt=function(M){return this._transfos[this._transfos.length-1].transform(M)};N.transformSize=function(M){return M*this._sizeTransfos[this._sizeTransfos.length-
1]};N.reverseTransformPt=function(M){return this._transfos[this._transfos.length-1].invert().transform(M)};N.reverseTransformSize=function(M){return M/this._sizeTransfos[this._sizeTransfos.length-1]};N.geomUnitsPerPoint=function(){return this.isEmbedded()?1:this._geomUnitsPerPoint};N.isEmbedded=function(){return 1<this._transfos.length};N.back=function(){return this._transfos[this._transfos.length-1]};N.push=function(M,K){K=K?M.scaleRatio():1;v.multiply(M,this.back(),M);this._transfos.push(M);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-
1]*K)};N.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};N.drawSymbol=function(M,K){if(M)switch(M.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(M,K);break;case "CIMTextSymbol":this.drawTextSymbol(M,K)}};N.drawMultiLayerSymbol=function(M,K){if(M){var O=M.symbolLayers;if(O)if((M=M.effects)&&0<M.length){if(K=this.executeEffects(M,K))for(M=K.next();M;)this.drawSymbolLayers(O,M),M=K.next()}else this.drawSymbolLayers(O,K)}};
N.executeEffects=function(M,K){const O=this._resourceManager.geometryEngine;K=new e.SimpleGeometryCursor(K);for(const X of M)(M=l.getEffectOperator(X))&&(K=M.execute(K,X,this.geomUnitsPerPoint(),O));return K};N.drawSymbolLayers=function(M,K){let O=M.length;for(;O--;){const aa=M[O];if(aa&&!1!==aa.enable){var X=aa.effects;if(X&&0<X.length){if(X=this.executeEffects(X,K)){let ba=null;for(;(ba=X.next())&&(this.drawSymbolLayer(aa,ba),!this._earlyReturn););}}else this.drawSymbolLayer(aa,K);if(this._earlyReturn)break}}};
N.drawSymbolLayer=function(M,K){switch(M.type){case "CIMSolidFill":this.drawSolidFill(K,M.color);break;case "CIMHatchFill":this.drawHatchFill(K,M);break;case "CIMPictureFill":this.drawPictureFill(K,M);break;case "CIMGradientFill":this.drawGradientFill(K,M);break;case "CIMSolidStroke":this.drawSolidStroke(K,M.color,M.width,M.capStyle,M.joinStyle,M.miterLimit);break;case "CIMPictureStroke":this.drawPictureStroke(K,M);break;case "CIMGradientStroke":this.drawGradientStroke(K,M);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(M,
K)}};N.drawHatchFill=function(M,K){const O=this._buildHatchPolyline(K,M,this.geomUnitsPerPoint());O&&(this.pushClipPath(M),this.drawMultiLayerSymbol(K.lineSymbol,O),this.popClipPath())};N.drawPictureFill=function(M,K){};N.drawGradientFill=function(M,K){};N.drawPictureStroke=function(M,K){};N.drawGradientStroke=function(M,K){};N.drawMarkerLayer=function(M,K){var O=M.markerPlacement;if(O){const aa=l.getPlacementOperator(O);if(aa){var X="CIMMarkerPlacementInsidePolygon"===O.type;X&&this.pushClipPath(K);
if(K=aa.execute(K,O,this.geomUnitsPerPoint(),this._resourceManager.geometryEngine))for(O=null;(O=K.next())&&(this.drawMarker(M,O),!this._earlyReturn););X&&this.popClipPath()}}else{O=this._placementPool.acquire();if(b.isPoint(K))O.tx=K.x,O.ty=K.y,this.drawMarker(M,O);else if(b.isPolygon(K))[O.tx,O.ty]=a.polygonCentroid(K),this.drawMarker(M,O);else for(X of K.points)if(O.tx=X[0],O.ty=X[1],this.drawMarker(M,O),this._earlyReturn)break;this._placementPool.release(O)}};N.drawMarker=function(M,K){switch(M.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(M,
K);break;case "CIMVectorMarker":this.drawVectorMarker(M,K)}};N.drawPictureMarker=function(M,K){var O,X,aa,ba,V;if(M){var L=this._resourceManager.getResource(M.url),P=null!=(O=M.size)?O:10;if(!(y.isNone(L)||0>=P)&&(O=L.width,L=L.height,O&&L)){L=O/L;O=null!=(X=M.scaleX)?X:1;X=v.createIdentity();var Y=M.anchorPoint;if(Y){let U=Y.x;Y=Y.y;"Absolute"!==M.anchorPointUnits&&(U*=P*L*O,Y*=P);X.translate(-U,-Y)}L=null!=(aa=M.rotation)?aa:0;M.rotateClockwise&&(L=-L);this._mapRotation&&(L+=this._mapRotation);
L&&X.rotate(L*h);aa=null!=(ba=M.offsetX)?ba:0;ba=null!=(V=M.offsetY)?V:0;if(aa||ba)this._mapRotation&&(L=h*this._mapRotation,V=Math.cos(L),L=Math.sin(L),O=aa*L+ba*V,aa=aa*V-ba*L,ba=O),X.translate(aa,ba);V=this.geomUnitsPerPoint();1!==V&&X.scale(V,V);(V=K.getAngle())&&X.rotate(V);X.translate(K.tx,K.ty);this.push(X,!1);this.drawImage(M.url,P,M.scaleX);this.pop()}}};N.drawVectorMarker=function(M,K){var O,X,aa,ba;if(M){var V=M.markerGraphics;if(V){var L=null!=(O=M.size)?O:10,P=(O=M.frame)?O.ymax-O.ymin:
0;P=L&&P?L/P:1;L=v.createIdentity();O&&L.translate(.5*-(O.xmax+O.xmin),.5*-(O.ymax+O.ymin));var Y=M.anchorPoint;if(Y){let U=Y.x;Y=Y.y;"Absolute"!==M.anchorPointUnits?O&&(U*=O.xmax-O.xmin,Y*=O.ymax-O.ymin):(U/=P,Y/=P);L.translate(-U,-Y)}1!==P&&L.scale(P,P);O=null!=(X=M.rotation)?X:0;M.rotateClockwise&&(O=-O);this._mapRotation&&(O+=this._mapRotation);O&&L.rotate(O*h);X=null!=(aa=M.offsetX)?aa:0;aa=null!=(ba=M.offsetY)?ba:0;if(X||aa)this._mapRotation&&(O=h*this._mapRotation,ba=Math.cos(O),O=Math.sin(O),
P=X*O+aa*ba,X=X*ba-aa*O,aa=P),L.translate(X,aa);ba=this.geomUnitsPerPoint();1!==ba&&L.scale(ba,ba);(ba=K.getAngle())&&L.rotate(ba);L.translate(K.tx,K.ty);this.push(L,M.scaleSymbolsProportionally);for(const U of V)if(U&&U.symbol&&U.geometry||t.error("Invalid marker graphic",U),this.drawSymbol(U.symbol,U.geometry),this._earlyReturn)break;this.pop()}}};N.drawTextSymbol=function(M,K){var O,X,aa,ba;if(M&&b.isPoint(K)&&!(0>=(null!=(O=M.height)?O:10))){O=v.createIdentity();var V=null!=(X=M.angle)?X:0;(V=
-V)&&O.rotate(V*h);X=null!=(aa=M.offsetX)?aa:0;aa=null!=(ba=M.offsetY)?ba:0;(X||aa)&&O.translate(X,aa);ba=this.geomUnitsPerPoint();1!==ba&&O.scale(ba,ba);O.translate(K.x,K.y);this.push(O,!1);this.drawText(M);this.pop()}};N._buildHatchPolyline=function(M,K,O){var X=(void 0!==M.separation?M.separation:4)*O,aa=void 0!==M.rotation?M.rotation:0;if(0===X)return null;0>X&&(X=-X);for(var ba=0,V=.5*X;ba>V;)ba-=X;for(;ba<-V;)ba+=X;ba=f.create();d.getBoundsXY(ba,K);ba[0]-=V;ba[1]-=V;ba[2]+=V;ba[3]+=V;for(var L=
[[ba[0],ba[1]],[ba[0],ba[3]],[ba[2],ba[3]],[ba[2],ba[1]]];180<aa;)aa-=180;for(;0>aa;)aa+=180;V=Math.cos(aa*h);var P=Math.sin(aa*h);aa=-X*P;K=X*V;ba=(void 0!==M.offsetX?M.offsetX*O:0)*P-(void 0!==M.offsetY?M.offsetY*O:0)*V;let Y;var U=M=Number.MAX_VALUE;Y=O=-Number.MAX_VALUE;for(var Q of L){var W=Q[0];const R=Q[1];L=V*W+P*R;W=-P*W+V*R;U=Math.min(U,L);M=Math.min(M,W);Y=Math.max(Y,L);O=Math.max(O,W)}M=Math.floor(M/X)*X;Q=V*U-P*M-aa*ba/X;U=P*U+V*M-K*ba/X;L=V*Y-P*M-aa*ba/X;ba=P*Y+V*M-K*ba/X;X=1+Math.round((O-
M)/X);V=[];for(P=0;P<X;P++)Q+=aa,U+=K,L+=aa,ba+=K,V.push([[Q,U],[L,ba]]);return{paths:V}};return I}();let w=function(I){function N(K,O){K=I.call(this,K,O)||this;K.reset();return K}D._inheritsLoose(N,I);var M=N.prototype;M.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=0};M.envelope=function(){return new c(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};M.bounds=function(){return f.fromValues(this._xmin,this._ymin,this._xmax,this._ymax)};
M.drawSolidFill=function(K){!K||0<this._clipCount||(b.isPolygon(K)?this._processPath(K.rings,0):b.isPolyline(K)?this._processPath(K.paths,0):b.isExtent(K)?(K=G(K))&&this._processPath(K.rings,0):console.error("drawSolidFill Unexpected geometry type!"))};M.drawSolidStroke=function(K,O,X){!K||0<this._clipCount||(O=.5*this.transformSize(X),b.isPolygon(K)?this._processPath(K.rings,O):b.isPolyline(K)?this._processPath(K.paths,O):b.isExtent(K)?(K=G(K))&&this._processPath(K.rings,O):console.error("drawSolidStroke unexpected geometry type!"))};
M.pushClipPath=function(K){this.drawSolidFill(K);++this._clipCount};M.popClipPath=function(){--this._clipCount};M.drawImage=function(K,O,X){let aa=X*O,ba=O;K=this._resourceManager.getResource(K);!O&&y.isSome(K)&&(aa=X*K.width,ba=K.height);this._merge(this.transformPt([-aa/2,-ba/2]),0);this._merge(this.transformPt([-aa/2,ba/2]),0);this._merge(this.transformPt([aa/2,-ba/2]),0);this._merge(this.transformPt([aa/2,ba/2]),0)};M.drawText=function(K){this._textRasterizer||(this._textRasterizer=new m)};M._processPath=
function(K,O){if(K)for(const X of K)if(K=X?X.length:0,1<K){this._merge(this.transformPt(X[0]),O);for(let aa=1;aa<K;++aa)this._merge(this.transformPt(X[aa]),O)}};M._merge=function(K,O){K[0]-O<this._xmin&&(this._xmin=K[0]-O);K[0]+O>this._xmax&&(this._xmax=K[0]+O);K[1]-O<this._ymin&&(this._ymin=K[1]-O);K[1]+O>this._ymax&&(this._ymax=K[1]+O)};return N}(B),A=function(I){function N(){var K=I.apply(this,arguments)||this;K._searchPoint=[0,0];K._searchDistPoint=0;return K}D._inheritsLoose(N,I);var M=N.prototype;
M.hitTest=function(K,O,X,aa,ba,V){V*=n.pt2px(1);this.setTransform();this.setGeomUnitsPerPoint(V);this._searchPoint=[(K[0]+K[2])/2,(K[1]+K[3])/2];this._searchDistPoint=(K[2]-K[0])/2/V;this._textInfo=aa;this._mapRotation=O&&("CIMPointSymbol"===O.type&&"Map"!==O.angleAlignment||"CIMTextSymbol"===O.type)?ba:0;this._earlyReturn=!1;this.drawSymbol(O,X);return this._earlyReturn};M.drawSolidFill=function(K,O){this._hitTestFill(K)};M.drawHatchFill=function(K,O){this._hitTestFill(K)};M.drawPictureFill=function(K,
O){this._hitTestFill(K)};M.drawGradientFill=function(K,O){this._hitTestFill(K)};M.drawSolidStroke=function(K,O,X,aa,ba,V){this._hitTestStroke(K,X)};M.drawPictureStroke=function(K,O){this._hitTestStroke(K,O.width)};M.drawGradientStroke=function(K,O){this._hitTestStroke(K,O.width)};M.drawMarkerLayer=function(K,O){K.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===K.markerPlacement.type?this._hitTestFill(O):I.prototype.drawMarkerLayer.call(this,K,O)};M.pushClipPath=function(K){};M.popClipPath=function(){};
M.drawImage=function(K,O,X){K=this._resourceManager.getResource(K);if(!y.isNone(K)&&0!==K.height&&0!==O){O*=this.geomUnitsPerPoint();X=K.width/K.height*X*O;K=this.reverseTransformPt(this._searchPoint);var aa=this._searchDistPoint;Math.abs(K[0])<X/2+aa&&Math.abs(K[1])<O/2+aa&&(this._earlyReturn=!0)}};M.drawText=function(K){var O,X,aa=this._textInfo;if(aa&&(aa=aa.get(K))){var {text:ba,mosaicItem:V}=aa;if(V&&0!==V.glyphMosaicItems.length){aa=null!=(O=K.height)?O:10;O=J(K.lineGapType,null!=(X=K.lineGap)?
X:0,aa);X=C.bidiText(ba)[1];K=u.shapeGlyphs(V.glyphMosaicItems,X,{scale:aa/p.GLYPH_SIZE,angle:0,xOffset:0,yOffset:0,hAlign:F(K.horizontalAlignment),vAlign:H(K.verticalAlignment),maxLineWidth:512,lineHeight:p.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(O||1,4)),decoration:K.font.decoration||"none",isCIM:!0});O=this.reverseTransformPt(this._searchPoint);X=O[0];O=O[1];for(const L of K.glyphs)if(X>L.xTopLeft&&X<L.xBottomRight&&O>-L.yBottomRight&&O<-L.yTopLeft){this._earlyReturn=!0;break}}}};M._hitTestFill=
function(K){let O=null;if(b.isExtent(K))O=[[[K.xmin,K.ymin],[K.xmin,K.ymax],[K.xmax,K.ymax],[K.xmax,K.ymin],[K.xmin,K.ymin]]];else if(b.isPolygon(K))O=K.rings;else if(b.isPolyline(K))O=K.paths;else return;K=this.reverseTransformPt(this._searchPoint);this._pointInPolygon(K,O)&&(this._earlyReturn=!0);if(!this._earlyReturn){const X=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(K,O,X)&&(this._earlyReturn=!0)}};M._hitTestStroke=function(K,O){let X=null;if(b.isExtent(K))X=
[[[K.xmin,K.ymin],[K.xmin,K.ymax],[K.xmax,K.ymax],[K.xmax,K.ymin],[K.xmin,K.ymin]]];else if(b.isPolygon(K))X=K.rings;else if(b.isPolyline(K))X=K.paths;else return;K=this.reverseTransformPt(this._searchPoint);O*=this.geomUnitsPerPoint();const aa=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(K,X,O/2+aa)&&(this._earlyReturn=!0)};M._pointInPolygon=function(K,O){let X=0;for(const aa of O){O=aa.length;for(let ba=1;ba<O;++ba){const V=aa[ba-1],L=aa[ba];V[1]>K[1]!==
L[1]>K[1]&&(0<(L[0]-V[0])*(K[1]-V[1])-(L[1]-V[1])*(K[0]-V[0])?X++:X--)}}return 0!==X};M._nearLine=function(K,O,X){for(const ba of O){O=ba.length;for(let V=1;V<O;++V){var aa=ba[V-1];const L=ba[V];let P=(L[0]-aa[0])*(L[0]-aa[0])+(L[1]-aa[1])*(L[1]-aa[1]);if(0!==P&&(P=Math.sqrt(P),Math.abs(((L[0]-aa[0])*(K[1]-aa[1])-(L[1]-aa[1])*(K[0]-aa[0]))/P)<X&&(aa=((L[0]-aa[0])*(K[0]-aa[0])+(L[1]-aa[1])*(K[1]-aa[1]))/P,aa>-X&&aa<P+X)))return!0}}return!1};return N}(B),E=function(I){function N(K,O,X){O=I.call(this,
O,X)||this;O._ctx=K;return O}D._inheritsLoose(N,I);var M=N.prototype;M.drawSolidFill=function(K,O){if(K){if(b.isPolygon(K))this._buildPath(K.rings,!0);else if(b.isPolyline(K))this._buildPath(K.paths,!0);else if(b.isExtent(K))this._buildPath(G(K).rings,!0);else if(b.isMultipoint(K))console.log("CanvasDrawHelper.drawSolidFill - No implementation!");else return;K=this._ctx;K.fillStyle="string"===typeof O?O:"rgba("+Math.round(O[0])+","+Math.round(O[1])+","+Math.round(O[2])+","+O[3]/255+")";K.fill("evenodd")}};
M.drawSolidStroke=function(K,O,X,aa,ba,V){if(K&&O&&0!==X){if(b.isPolygon(K))this._buildPath(K.rings,!0);else if(b.isPolyline(K))this._buildPath(K.paths,!1);else if(b.isExtent(K))this._buildPath(G(K).rings,!0);else{console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");return}K=this._ctx;K.strokeStyle="string"===typeof O?O:"rgba("+Math.round(O[0])+","+Math.round(O[1])+","+Math.round(O[2])+","+O[3]/255+")";K.lineWidth=this.transformSize(X)+.5;this._setCapStyle(aa);this._setJoinStyle(ba);
K.miterLimit=V;K.stroke()}};M.pushClipPath=function(K){this._ctx.save();if(b.isPolygon(K))this._buildPath(K.rings,!0);else if(b.isPolyline(K))this._buildPath(K.paths,!0);else if(b.isExtent(K))this._buildPath(G(K).rings,!0);else return;this._ctx.clip("evenodd")};M.popClipPath=function(){this._ctx.restore()};M.drawImage=function(K,O,X){K=this._resourceManager.getResource(K);if(!y.isNone(K)){var aa=this._ctx,ba=aa.canvas.width;aa=aa.canvas.height;var V=K.width/K.height*X*O,L=X*O;O||(V=X*K.width,L=X*
K.height);O=this.transformPt([0,0]);X=this.transformSize(V);L=this.transformSize(L);this._ctx.drawImage(K,0,0,K.width,K.height,O[0]-X/2,O[1]-L/2,Math.min(X,ba),Math.min(L,aa))}};M.drawText=function(K){this._textRasterizer||(this._textRasterizer=new m)};M._buildPath=function(K,O){const X=this._ctx;X.beginPath();if(K)for(const aa of K)if(K=aa?aa.length:0,1<K){let ba=this.transformPt(aa[0]);X.moveTo(ba[0],ba[1]);for(let V=1;V<K;++V)ba=this.transformPt(aa[V]),X.lineTo(ba[0],ba[1]);O&&X.closePath()}};
M._setCapStyle=function(K){switch(K){case g.LineCapStyle.Butt:this._ctx.lineCap="butt";break;case g.LineCapStyle.Round:this._ctx.lineCap="round";break;case g.LineCapStyle.Square:this._ctx.lineCap="square"}};M._setJoinStyle=function(K){switch(K){case g.LineJoinStyle.Bevel:this._ctx.lineJoin="bevel";break;case g.LineJoinStyle.Round:this._ctx.lineJoin="round";break;case g.LineJoinStyle.Miter:this._ctx.lineJoin="miter"}};return N}(B);const G=I=>I?{spatialReference:I.spatialReference,rings:[[[I.xmin,I.ymin],
[I.xmin,I.ymax],[I.xmax,I.ymax],[I.xmax,I.ymin],[I.xmin,I.ymin]]]}:null,F=I=>{switch(I){case "Left":return q.HAlign.Left;case "Right":return q.HAlign.Right;case "Center":return q.HAlign.Center;case "Justify":return t.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),q.HAlign.Center}},H=I=>{switch(I){case "Top":return q.VAlign.Top;case "Center":return q.VAlign.Center;case "Bottom":return q.VAlign.Bottom;case "Baseline":return q.VAlign.Baseline}},J=(I,N,M)=>{switch(I){case "ExtraLeading":return 1+
N/M;case "Multiple":return N;case "Exact":return N/M}};z.CIMSymbolDrawHelper=B;z.C_DEG_TO_RAD=h;z.CanvasDrawHelper=E;z.EnvDrawHelper=w;z.HittestDrawHelper=A;z.Transformation=v;z.horizontalAlignment2HAlign=F;z.lineGapType2LineHeight=J;z.verticalAlignment2VAlign=H;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMEffects":function(){define(["exports","../../core/lang"],function(z,D){let C=function(){function B(y){this._geometry=y}B.prototype.next=
function(){const y=this._geometry;this._geometry=null;return y};return B}();z.SimpleGeometryCursor=C;z.clone=function(B){return D.clone(B)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectControlMeasureLine ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g,c,m,q,p,u,h){z.getEffectOperator=function(t){if(!t)return null;switch(t.type){case "CIMGeometricEffectAddControlPoints":return D.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return C.EffectArrow.local();case "CIMGeometricEffectBuffer":return B.EffectBuffer.local();case "CIMGeometricEffectControlMeasureLine":return y.EffectControlMeasureLine.local();case "CIMGeometricEffectCut":return x.EffectCut.local();case "CIMGeometricEffectDashes":return n.EffectDashes.local();
case "CIMGeometricEffectDonut":return f.EffectDonut.local();case "CIMGeometricEffectJog":return d.EffectJog.local();case "CIMGeometricEffectMove":return a.EffectMove.local();case "CIMGeometricEffectOffset":return b.EffectOffset.local();case "CIMGeometricEffectReverse":return e.EffectReverse.local();case "CIMGeometricEffectRotate":return l.EffectRotate.local();case "CIMGeometricEffectScale":return k.EffectScale.local();case "CIMGeometricEffectWave":return r.EffectWave.local()}return null};z.getPlacementOperator=
function(t){if(!t)return null;switch(t.type){case "CIMMarkerPlacementAlongLineSameSize":return g.PlacementAlongLineSameSize.local();case "CIMMarkerPlacementAtExtremities":return c.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return m.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return q.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return p.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return u.PlacementOnVertices.local();
case "CIMMarkerPlacementPolygonCenter":return h.PlacementPolygonCenter.local()}return null};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(z,D,C,B){let y=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=function(f,d,a,b){return new x(f,
d,a)};return n}();y.instance=null;let x=function(){function n(d,a,b){this._inputGeometries=d;this._angleTolerance=void 0!==a.angleTolerance?a.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var f=n.prototype;f.next=function(){for(var d=this._inputGeometries.next();d;){if(C.isPolygon(d))return this._isClosed=!0,d=D.clone(d),this._processMultipath(d.rings),d;if(C.isPolyline(d))return this._isClosed=!1,d=D.clone(d),this._processMultipath(d.paths),d;if(C.isExtent(d)){if(this._maxCosAngle)return d;
this._isClosed=!0;d=[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]];this._processPath(d);return{rings:[d]}}d=this._inputGeometries.next()}return null};f._processMultipath=function(d){if(d)for(const a of d)this._processPath(a)};f._processPath=function(d){if(d){let a=d.length,b=d[0],e,l,k,r,g,c;this._isClosed&&++a;for(let m=1;m<a;++m){let q;q=this._isClosed&&m===a-1?d[0]:d[m];const p=q[0]-b[0],u=q[1]-b[1],h=Math.sqrt(p*p+u*u);1<m&&0<h&&0<k&&(e*p+l*u)/h/k<=this._maxCosAngle&&
B.setId(b,1);1===m&&(r=p,g=u,c=h);0<h&&(b=q,e=p,l=u,k=h)}this._isClosed&&0<k&&0<c&&(e*r+l*g)/c/k<=this._maxCosAngle&&B.setId(d[0],1)}};return n}();z.EffectAddControlPoints=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(z,D,C,B){function y(c){if(!c)return null;C.isPoint(c)?c.y=-c.y:C.isPolygon(c)?n(c.rings):C.isPolyline(c)?
n(c.paths):C.isMultipoint(c)&&x(c.points)}function x(c){if(c){const m=c.length;for(let q=0;q<m;q++)c[q][1]=-c[q][1]}}function n(c){if(c)for(const m of c)x(m)}function f(c){if(c){var m=c.length;for(--m;0<m;--m)c[m][0]-=c[m-1][0],c[m][1]-=c[m-1][1]}}function d(c){if(c)for(const m of c)f(m)}function a(c){if(c){const m=c.length;for(let q=1;q<m;++q)c[q][0]+=c[q-1][0],c[q][1]+=c[q-1][1]}}function b(c){if(c)for(const m of c)a(m)}function e(c){c&&(C.isPolygon(c)?b(c.rings):C.isPolyline(c)?b(c.paths):C.isMultipoint(c)&&
a(c.points),y(c))}function l(c){c&&c.reverse()}function k(c){return{rings:[[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]]}}let r=function(){function c(m,q,p,u){this.acceptPolygon=q;this.acceptPolyline=p;this.geomUnitsPerPoint=u;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;m&&(C.isPolygon(m)?q&&(this.multiPath=m.rings,this.isClosed=!0):C.isPolyline(m)?p&&(this.multiPath=m.paths,this.isClosed=!1):C.isExtent(m)&&q&&(this.multiPath=k(m).rings,this.isClosed=
!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new B.Placement}c.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const m=this.processPath(this.multiPath[this.pathIndex]);if(m)return m}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return c}(),g=function(){function c(m,q,p,u){this.inputGeometries=m;this.acceptPolygon=q;this.acceptPolyline=p;this.geomUnitsPerPoint=
u;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}c.prototype.next=function(){for(;;){if(!this.multiPath){for(var m=this.inputGeometries.next();m;)if(C.isPolygon(m)?this.acceptPolygon&&(this.multiPath=m.rings,this.isClosed=!0):C.isPolyline(m)?this.acceptPolyline&&(this.multiPath=m.paths,this.isClosed=!1):C.isExtent(m)&&this.acceptPolygon&&(this.multiPath=k(m).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else m=this.inputGeometries.next();
if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,m=this.processPath(this.multiPath[this.pathIndex]))return m;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return c}();z.PathGeometryCursor=g;z.PathTransformationCursor=r;z.cloneAndDecodeGeometry=function(c){c=D.clone(c);e(c);return c};z.deltaDecodeGeometry=e;z.deltaEncodeGeometry=function(c){c&&(y(c),C.isPolygon(c)?d(c.rings):C.isPolyline(c)?d(c.paths):C.isMultipoint(c)&&
f(c.points))};z.getCoord2D=function(c,m,q){return[c[0]+(m[0]-c[0])*q,c[1]+(m[1]-c[1])*q]};z.getId=function(c){return c[4]};z.isClosedPath=function(c){return c&&0!==c.length?c[0][0]===c[c.length-1][0]&&c[0][1]===c[c.length-1][1]:!1};z.reverseMultipath=function(c){if(c)for(const m of c)l(m)};z.reversePath=l;z.setId=function(c,m){c[4]=m};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers",
"../CIMCursor","../CurveHelper","../enums"],function(z,D,C,B,y){const x=y.GeometricEffectArrowType.OpenEnded;let n=function(){function d(){}d.local=function(){null===d.instance&&(d.instance=new d);return d.instance};d.prototype.execute=function(a,b,e,l){return new f(a,b,e)};return d}();n.instance=null;let f=function(d){function a(e,l,k){e=d.call(this,e,!1,!0)||this;e._curveHelper=new B.CurveHelper;e._width=(void 0!==l.width?l.width:5)*k;e._arrowType=void 0!==l.geometricEffectArrowType?l.geometricEffectArrowType:
void 0!==l.arrowType?l.arrowType:x;e._offsetFlattenError=B.PIXEL_TOLERANCE*k;return e}D._inheritsLoose(a,d);var b=a.prototype;b.processPath=function(e){switch(this._arrowType){default:return this._constructSimpleArrow(e,!0);case y.GeometricEffectArrowType.Block:return this._constructSimpleArrow(e,!1);case y.GeometricEffectArrowType.Crossed:return this._constructCrossedArrow(e)}};b._constructSimpleArrow=function(e,l){var k=this._curveHelper.calculatePathLength(e),r=this._width;k<2*r&&(r=k/2);k=this._curveHelper.getSubCurve(e,
0,k-r);if(!k)return null;var g=r/2;if(this._curveHelper.isEmpty(k,!1))return null;r=this._constructOffset(k,-g);if(!r)return null;k=this._constructOffset(k,g);if(!k)return null;const c=this._constructArrowBasePoint(r,-g/2);if(!c)return null;g=this._constructArrowBasePoint(k,g/2);if(!g)return null;e=e[e.length-1];l||(this._makeControlPoint(k,!0),this._makeControlPoint(r,!0));const m=new B.PathHelper;m.addPath(k,!0);m.lineTo(g);this._makeControlPoint(m.path());m.lineTo(e);this._makeControlPoint(m.path());
m.lineTo(c);this._makeControlPoint(m.path());m.addPath(r,!1);return l?{paths:[m.path()]}:(m.close(),{rings:[m.path()]})};b._constructCrossedArrow=function(e){var l=this._curveHelper.calculatePathLength(e),k=this._width;l<3.732050807568877*k&&(k=l/3.732050807568877);var r=this._curveHelper.getSubCurve(e,0,l-2.732050807568877*k);if(!r)return null;var g=k/2;if(this._curveHelper.isEmpty(r,!1))return null;const c=this._constructOffset(r,g);if(!c)return null;r=this._constructOffset(r,-g);if(!r)return null;
l=this._curveHelper.getSubCurve(e,0,l-k);if(!l||this._curveHelper.isEmpty(l,!1))return null;k=this._constructOffset(l,g);if(!k)return null;var m=this._constructOffset(l,-g);if(!m)return null;l=k[k.length-1];k=this._constructArrowBasePoint(k,g/2);if(!k)return null;const q=m[m.length-1];g=this._constructArrowBasePoint(m,-g/2);if(!g)return null;e=e[e.length-1];this._makeControlPoint(c,!1);this._makeControlPoint(r,!1);m=new B.PathHelper;m.addPath(c,!0);this._makeControlPoint(m.path());m.lineTo(q);m.lineTo(g);
this._makeControlPoint(m.path());m.lineTo(e);this._makeControlPoint(m.path());m.lineTo(k);this._makeControlPoint(m.path());m.lineTo(l);this._makeControlPoint(m.path());m.addPath(r,!1);return{paths:[m.path()]}};b._constructOffset=function(e,l){return this._curveHelper.offset(e,l,y.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError)};b._constructArrowBasePoint=function(e,l){if(!e||2>e.length)return null;var k=e[e.length-2];e=e[e.length-1];k=[e[0]-k[0],e[1]-k[1]];this._curveHelper.normalize(k);
return[e[0]+k[1]*l,e[1]-k[0]*l]};b._makeControlPoint=function(e,l=!1){l?C.setId(e[0],1):C.setId(e[e.length-1],1)};return a}(C.PathGeometryCursor);z.EffectArrow=n;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/CurveHelper":function(){define(["exports","./enums"],function(z,D){let C=function(){function y(){this._path=[]}var x=y.prototype;x.path=function(){return this._path};x.addPath=function(n,f){f||n.reverse();Array.prototype.push.apply(this._path,
n);f||n.reverse()};y.mergePath=function(n,f){f&&Array.prototype.push.apply(n,f)};x.startPath=function(n){this._path.push(n)};x.lineTo=function(n){this._path.push(n)};x.close=function(){const n=this._path;1<n.length&&(n[0][0]!==n[n.length-1][0]||n[0][1]!==n[n.length-1][1])&&n.push([n[0][0],n[0][1]])};return y}(),B=function(){function y(n,f){}var x=y.prototype;x.normalize=function(n){const f=Math.sqrt(n[0]*n[0]+n[1]*n[1]);0!==f&&(n[0]/=f,n[1]/=f)};x.calculateLength=function(n,f){const d=f[0]-n[0];n=
f[1]-n[1];return Math.sqrt(d*d+n*n)};x.calculateSegLength=function(n,f){return this.calculateLength(n[f],n[f+1])};x.calculatePathLength=function(n){let f=0;const d=n?n.length:0;for(let a=0;a<d-1;++a)f+=this.calculateSegLength(n,a);return f};x.calculatePathArea=function(n){let f=0;const d=n?n.length:0;for(let a=0;a<d-1;++a)f+=(n[a+1][0]-n[a][0])*(n[a+1][1]+n[a][1]);return f/2};x.getCoord2D=function(n,f,d){return[n[0]+(f[0]-n[0])*d,n[1]+(f[1]-n[1])*d]};x.getSegCoord2D=function(n,f,d){return this.getCoord2D(n[f],
n[f+1],d)};x.getAngle=function(n,f,d){return Math.atan2(f[1]-n[1],f[0]-n[0])};x.getSegAngle=function(n,f,d){return this.getAngle(n[f],n[f+1],d)};x.getAngleCS=function(n,f,d){d=f[0]-n[0];n=f[1]-n[1];f=Math.sqrt(d*d+n*n);return 0<f?[d/f,n/f]:[1,0]};x.getSegAngleCS=function(n,f,d){return this.getAngleCS(n[f],n[f+1],d)};x.cut=function(n,f,d,a){d=0>=d?n[f]:this.getSegCoord2D(n,f,d);n=1<=a?n[f+1]:this.getSegCoord2D(n,f,a);return[d,n]};x.addSegment=function(n,f,d){d&&n.push(f[0]);n.push(f[1])};x.getSubCurve=
function(n,f,d){const a=[];return this.appendSubCurve(a,n,f,d)?a:null};x.appendSubCurve=function(n,f,d,a){const b=f?f.length-1:0;let e=0,l=!0,k=0;for(;k<b;){const g=this.calculateSegLength(f,k);if(0!==g){if(l){if(e+g>d){var r=(d-e)/g;let c=1,m=!1;e+g>=a&&(c=(a-e)/g,m=!0);(r=this.cut(f,k,r,c))&&this.addSegment(n,r,l);if(m)break;l=!1}}else{if(e+g>a){(f=this.cut(f,k,0,(a-e)/g))&&this.addSegment(n,f,l);break}this.addSegment(n,[f[k],f[k+1]],l)}e+=g}++k}return!0};x.getCIMPointAlong=function(n,f){const d=
n?n.length-1:0;let a=0,b=-1;for(;b<d;){++b;const e=this.calculateSegLength(n,b);if(0!==e){if(a+e>f)return this.getCoord2D(n[b],n[b+1],(f-a)/e);a+=e}}return null};x.isEmpty=function(n,f){if(!n||1>=n.length)return!0;const d=n?n.length-1:0;let a=-1;for(;a<d;)if(++a,n[a+1][0]!==n[a][0]||n[a+1][1]!==n[a][1]||f&&n[a+1][2]!==n[a][2])return!1;return!0};x.offset=function(n,f,d,a,b){if(!n||2>n.length)return null;var e=0,l=n[e++];for(b=e;e<n.length;){var k=n[e];if(k[0]!==l[0]||k[1]!==l[1])e!==b&&(n[b]=n[e]),
l=n[b++];e++}(e=n[0][0]===n[b-1][0]&&n[0][1]===n[b-1][1])&&--b;if(b<(e?3:2))return null;k=[];l=e?n[b-1]:null;let r=n[0];for(let p=0;p<b;p++){const u=p===b-1?e?n[0]:null:n[p+1];if(l)if(u){var g=[u[0]-r[0],u[1]-r[1]];this.normalize(g);var c=[r[0]-l[0],r[1]-l[1]];this.normalize(c);var m=c[0]*g[1]-c[1]*g[0],q=c[0]*g[0]+c[1]*g[1];if(0===m&&1===q){r=u;continue}if(0<=m===0>=f)1>q&&(g=[g[0]-c[0],g[1]-c[1]],this.normalize(g),c=Math.sqrt((1+q)/2),c>1/a&&(c=-Math.abs(f)/c,k.push([r[0]-g[0]*c,r[1]-g[1]*c])));
else switch(d){case D.GeometricEffectOffsetMethod.Mitered:if(l=Math.sqrt((1+q)/2),0<l&&1/l<a){g=[g[0]-c[0],g[1]-c[1]];this.normalize(g);c=Math.abs(f)/l;k.push([r[0]-g[0]*c,r[1]-g[1]*c]);break}case D.GeometricEffectOffsetMethod.Bevelled:k.push([r[0]+c[1]*f,r[1]-c[0]*f]);k.push([r[0]+g[1]*f,r[1]-g[0]*f]);break;case D.GeometricEffectOffsetMethod.Rounded:if(1>q){k.push([r[0]+c[1]*f,r[1]-c[0]*f]);l=Math.floor(2.5*(1-q));if(0<l){m=q=1/l;for(let h=1;h<l;h++,m+=q){const t=[c[1]*(1-m)+g[1]*m,-c[0]*(1-m)-g[0]*
m];this.normalize(t);k.push([r[0]+t[0]*f,r[1]+t[1]*f])}}k.push([r[0]+g[1]*f,r[1]-g[0]*f])}break;default:0>m?(k.push([r[0]+(c[1]+c[0])*f,r[1]+(c[1]-c[0])*f]),k.push([r[0]+(g[1]-g[0])*f,r[1]-(g[0]+g[1])*f])):(l=Math.sqrt((1+Math.abs(q))/2),g=[g[0]-c[0],g[1]-c[1]],this.normalize(g),c=f/l,k.push([r[0]-g[0]*c,r[1]-g[1]*c]))}}else g=[r[0]-l[0],r[1]-l[1]],this.normalize(g),k.push([r[0]+g[1]*f,r[1]-g[0]*f]);else g=[u[0]-r[0],u[1]-r[1]],this.normalize(g),k.push([r[0]+g[1]*f,r[1]-g[0]*f]);l=r;r=u}if(k.length<
(e?3:2))return null;e&&k.push([k[0][0],k[0][1]]);return k};return y}();z.CurveHelper=B;z.PIXEL_TOLERANCE=.03;z.PathHelper=C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(z,D,C,B){let y=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=function(f,
d,a,b){return new x(f,d,a,b)};return n}();y.instance=null;let x=function(){function n(f,d,a,b){this._inputGeometries=f;this._curveHelper=new C.CurveHelper;this._size=(void 0!==d.size?d.size:1)*a;this._offsetFlattenError=C.PIXEL_TOLERANCE*a}n.prototype.next=function(){let f=this._inputGeometries.next();for(;f;){if(D.isExtent(f))if(0<this._size){var d=this._curveHelper.offset([[f.xmin,f.ymin],[f.xmin,f.ymax],[f.xmax,f.ymax],[f.xmax,f.ymin],[f.xmin,f.ymin]],this._size,B.GeometricEffectOffsetMethod.Rounded,
4,this._offsetFlattenError);if(d)return{rings:[d]}}else if(0>this._size){if(0<Math.min(f.xmax-f.xmin,f.ymax-f.ymin)+2*this._size)return{xmin:f.xmin-this._size,xmax:f.xmax+this._size,ymin:f.ymin-this._size,ymax:f.ymax+this._size}}else return f;if(D.isPolygon(f)){if(0===this._size)return f;d=[];for(const b of f.rings){var a=this._curveHelper.offset(b,this._size,B.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);a&&d.push(a)}if(d.length)return{rings:d}}if(D.isPolyline(f)&&0<this._size){d=
[];for(const b of f.paths)if(b&&1<b.length){a=this._curveHelper.offset(b,this._size,B.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);const e=this._curveHelper.offset(b,-this._size,B.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(a&&e){for(let l=e.length-1;0<=l;l--)a.push(e[l]);a.push([a[0][0],a[0][1]]);d.push(a)}}if(d.length)return{rings:d}}D.isPoint(f);f=this._inputGeometries.next()}return null};return n}();z.EffectBuffer=y;Object.defineProperties(z,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectControlMeasureLine":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../enums"],function(z,D,C,B){let y=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=function(f,d,a,b){return new x(f,d,a)};return n}();y.instance=null;let x=function(){function n(d,a,b){var e;this._default_point_size=20;this._inputGeometries=d;this._geomUnitsPerPoint=
b;this._rule=null!=(e=a.rule)?e:B.GeometricEffectControlMeasureLineRule.FullGeometry;this._default_size=this._default_point_size*b}var f=n.prototype;f.next=function(){let d;for(;d=this._inputGeometries.next();){let a;D.isPoint(d)?a=this._processGeom([[[d.x,d.y]]]):D.isMultipoint(d)?a=this._processGeom([d.points]):D.isPolyline(d)?a=this._processGeom(d.paths):D.isPolygon(d)&&(a=this._processGeom(d.rings));if(a&&a.length)return{paths:a}}return null};f._clone=function(d){return[d[0],d[1]]};f._mid=function(d,
a){return[(d[0]+a[0])/2,(d[1]+a[1])/2]};f._mix=function(d,a,b,e){return[d[0]*a+b[0]*e,d[1]*a+b[1]*e]};f._add=function(d,a){return[d[0]+a[0],d[1]+a[1]]};f._add2=function(d,a,b){return[d[0]+a,d[1]+b]};f._sub=function(d,a){return[d[0]-a[0],d[1]-a[1]]};f._dist=function(d,a){return Math.sqrt((d[0]-a[0])*(d[0]-a[0])+(d[1]-a[1])*(d[1]-a[1]))};f._norm=function(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])};f._normalize=function(d,a=1){a/=this._norm(d);d[0]*=a;d[1]*=a};f._leftPerpendicular=function(d){const a=
d[0];d[0]=-d[1];d[1]=a};f._leftPerp=function(d){return[-d[1],d[0]]};f._rightPerpendicular=function(d){const a=-d[0];d[0]=d[1];d[1]=a};f._rightPerp=function(d){return[d[1],-d[0]]};f._dotProduct=function(d,a){return d[0]*a[0]+d[1]*a[1]};f._crossProduct=function(d,a){return d[0]*a[1]-d[1]*a[0]};f._rotateDirect=function(d,a,b){const e=d[0]*b+d[1]*a;d[0]=d[0]*a-d[1]*b;d[1]=e};f._makeCtrlPt=function(d){d=[d[0],d[1]];C.setId(d,1);return d};f._addAngledTicks=function(d,a,b,e){const l=this._sub(b,a);this._normalize(l);
var k=this._crossProduct(l,this._sub(e,a));e=0<k?this._rightPerp(l):this._leftPerp(l);k=Math.abs(k)/2;const r=[];r.push([a[0]+(e[0]-l[0])*k,a[1]+(e[1]-l[1])*k]);r.push(a);r.push(b);r.push([b[0]+(e[0]+l[0])*k,b[1]+(e[1]+l[1])*k]);d.push(r)};f._addBezier2=function(d,a,b,e,l){if(0===l--)d.push(e);else{var k=this._mid(a,b);b=this._mid(b,e);var r=this._mid(k,b);this._addBezier2(d,a,k,r,l);this._addBezier2(d,r,b,e,l)}};f._addBezier3=function(d,a,b,e,l,k){if(0===k--)d.push(l);else{var r=this._mid(a,b),g=
this._mid(b,e);e=this._mid(e,l);b=this._mid(r,g);g=this._mid(g,e);var c=this._mid(b,g);this._addBezier3(d,a,r,b,c,k);this._addBezier3(d,c,g,e,l,k)}};f._add90DegArc=function(d,a,b,e,l){e=null!=l?l:0<this._crossProduct(this._sub(b,a),this._sub(e,a));l=this._mid(a,b);const k=this._sub(l,a);e?this._leftPerpendicular(k):this._rightPerpendicular(k);l[0]+=k[0];l[1]+=k[1];this._addBezier3(d,a,this._mix(a,.33333,l,.66667),this._mix(b,.33333,l,.66667),b,4)};f._addArrow=function(d,a,b){var e=a[0],l=a[1],k=a[a.length-
1],r=this._sub(e,l);this._normalize(r);const g=this._crossProduct(r,this._sub(k,l));l=.5*g;var c=this._leftPerp(r);const m=[k[0]-c[0]*g,k[1]-c[1]*g];var q=a.length-1;k=[];k.push(b?[-c[0],-c[1]]:c);var p=[-r[0],-r[1]];for(b=1;b<q-1;b++){r=this._sub(a[b+1],a[b]);this._normalize(r);var u=this._dotProduct(r,p);c=this._crossProduct(r,p);u=Math.sqrt((1+u)/2);p=this._sub(r,p);this._normalize(p);p[0]/=u;p[1]/=u;k.push(0>c?[-p[0],-p[1]]:p);p=r}k.push(this._rightPerp(p));for(q=k.length-1;0<q;q--)d.push([a[q][0]+
k[q][0]*l,a[q][1]+k[q][1]*l]);d.push([m[0]+k[0][0]*l,m[1]+k[0][1]*l]);d.push([m[0]+k[0][0]*g,m[1]+k[0][1]*g]);d.push(e);d.push([m[0]-k[0][0]*g,m[1]-k[0][1]*g]);d.push([m[0]-k[0][0]*l,m[1]-k[0][1]*l]);for(e=1;e<k.length;e++)d.push([a[e][0]-k[e][0]*l,a[e][1]-k[e][1]*l])};f._cp2=function(d,a,b){return 2<=d.length?d[1]:this._add2(d[0],a*this._default_size,b*this._default_size)};f._cp3=function(d,a,b,e){if(3<=d.length)return d[2];b=this._mix(d[0],1-b,a,b);d=this._sub(a,d[0]);this._normalize(d);this._rightPerpendicular(d);
return[b[0]+d[0]*e*this._default_size,b[1]+d[1]*e*this._default_size]};f._arrowPath=function(d){if(2<d.length)return d;const a=d[0];d=this._cp2(d,-4,0);const b=this._sub(a,d);this._normalize(b);const e=this._rightPerp(b);return[a,d,[a[0]+(e[0]-b[0])*this._default_size,a[1]+(e[1]-b[1])*this._default_size]]};f._arrowLastSeg=function(d){var a=d[0];const b=this._cp2(d,-4,0);if(3<=d.length)a=d[d.length-1];else{d=this._sub(a,b);this._normalize(d);const e=this._rightPerp(d);a=[a[0]+(e[0]-d[0])*this._default_size,
a[1]+(e[1]-d[1])*this._default_size]}return[b,a]};f._processGeom=function(d){if(!d)return null;const a=[];for(const b of d){if(!b||0===b.length)continue;const e=b.length;let l=b[0];switch(this._rule){case B.GeometricEffectControlMeasureLineRule.PerpendicularFromFirstSegment:{const k=this._cp2(b,0,-1),r=this._cp3(b,k,.5,4),g=[];g.push(r);g.push(this._mid(l,k));a.push(g);break}case B.GeometricEffectControlMeasureLineRule.ReversedFirstSegment:{const k=this._cp2(b,0,-1);a.push([k,l]);break}case B.GeometricEffectControlMeasureLineRule.PerpendicularToSecondSegment:{const k=
this._cp2(b,-4,1),r=this._cp3(b,k,.882353,-1.94),g=[];g.push(this._mid(k,r));g.push(l);a.push(g);break}case B.GeometricEffectControlMeasureLineRule.SecondSegmentWithTicks:{const k=this._cp2(b,-4,1),r=this._cp3(b,k,.882353,-1.94),g=this._sub(r,k);let c;c=0<this._crossProduct(g,this._sub(l,k))?this._rightPerp(c):this._leftPerp(g);const m=[];m.push([k[0]+(c[0]-g[0])/3,k[1]+(c[1]-g[1])/3]);m.push(k);m.push(r);m.push([r[0]+(c[0]+g[0])/3,r[1]+(c[1]+g[1])/3]);a.push(m);break}case B.GeometricEffectControlMeasureLineRule.DoublePerpendicular:{const k=
this._cp2(b,0,-1),r=this._cp3(b,k,.5,3),g=this._mid(l,k),c=this._sub(g,r);this._normalize(c);const m=this._crossProduct(c,this._sub(l,r));this._leftPerpendicular(c);const q=[];q.push(l);q.push([r[0]+c[0]*m,r[1]+c[1]*m]);a.push(q);const p=[];p.push([r[0]-c[0]*m,r[1]-c[1]*m]);p.push(k);a.push(p);break}case B.GeometricEffectControlMeasureLineRule.OppositeToFirstSegment:{const k=this._cp2(b,0,-1),r=this._cp3(b,k,.5,3),g=this._mid(l,k),c=this._sub(g,r);this._normalize(c);const m=this._crossProduct(c,this._sub(l,
r));this._leftPerpendicular(c);const q=[];q.push([r[0]+c[0]*m,r[1]+c[1]*m]);q.push([r[0]-c[0]*m,r[1]-c[1]*m]);a.push(q);break}case B.GeometricEffectControlMeasureLineRule.TriplePerpendicular:{const k=this._cp2(b,0,-1),r=this._cp3(b,k,.5,4),g=this._mid(l,k),c=this._sub(g,r);this._normalize(c);const m=this._crossProduct(c,this._sub(l,r));this._leftPerpendicular(c);const q=[];q.push([r[0]+c[0]*m*.8,r[1]+c[1]*m*.8]);q.push([g[0]+.8*(l[0]-g[0]),g[1]+.8*(l[1]-g[1])]);a.push(q);a.push([r,g]);const p=[];
p.push([r[0]-c[0]*m*.8,r[1]-c[1]*m*.8]);p.push([g[0]+.8*(k[0]-g[0]),g[1]+.8*(k[1]-g[1])]);a.push(p);break}case B.GeometricEffectControlMeasureLineRule.HalfCircleFirstSegment:{const k=this._cp2(b,0,-1),r=this._cp3(b,k,.5,4),g=this._mid(l,k);let c=this._sub(k,l);const m=Math.cos(Math.PI/18),q=Math.sin(Math.PI/18),p=Math.sqrt((1+m)/2),u=Math.sqrt((1-m)/2),h=[];let t;0<this._crossProduct(c,this._sub(r,l))?(h.push(l),c=this._sub(l,g),t=k):(h.push(k),c=this._sub(k,g),t=l);this._rotateDirect(c,p,u);c[0]/=
p;c[1]/=p;for(let v=1;18>=v;v++)h.push(this._add(g,c)),this._rotateDirect(c,m,q);h.push(t);a.push(h);break}case B.GeometricEffectControlMeasureLineRule.HalfCircleSecondSegment:{const k=this._cp2(b,0,-1),r=this._cp3(b,k,1,-1);let g=this._sub(l,k);this._normalize(g);const c=this._crossProduct(g,this._sub(r,k))/2;this._leftPerpendicular(g);const m=[k[0]+g[0]*c,k[1]+g[1]*c];g=this._sub(k,m);const q=Math.cos(Math.PI/18);let p=Math.sin(Math.PI/18);0<c&&(p=-p);const u=[k];for(let h=1;18>=h;h++)this._rotateDirect(g,
q,p),u.push(this._add(m,g));a.push(u);break}case B.GeometricEffectControlMeasureLineRule.HalfCircleExtended:{const k=this._cp2(b,0,-2),r=this._cp3(b,k,1,-1);let g;if(4<=e)g=b[3];else{const u=this._sub(l,k);g=this._add(r,u)}const c=this._dist(k,r)/2/.75,m=this._sub(k,l);this._normalize(m,c);const q=this._sub(r,g);this._normalize(q,c);a.push([g,r]);const p=[this._clone(r)];this._addBezier3(p,r,this._add(r,q),this._add(k,m),k,4);p.push(l);a.push(p);break}case B.GeometricEffectControlMeasureLineRule.OpenCircle:{const k=
this._cp2(b,-2,0),r=this._sub(k,l),g=Math.cos(Math.PI/18),c=-Math.sin(Math.PI/18),m=[k];for(let q=1;33>=q;q++)this._rotateDirect(r,g,c),m.push(this._add(l,r));a.push(m);break}case B.GeometricEffectControlMeasureLineRule.CoverageEdgesWithTicks:{const k=this._cp2(b,0,-1);let r;if(3<=e)r=b[2];else{const p=this._sub(k,l),u=this._leftPerp(p);r=[l[0]+u[0]-.25*p[0],l[1]+u[1]-.25*p[1]]}let g;if(4<=e)g=b[3];else{const p=this._mid(l,k),u=this._sub(l,k);this._normalize(u);this._leftPerpendicular(u);const h=
this._crossProduct(u,this._sub(r,p));this._rightPerpendicular(u);g=[r[0]+u[0]*h*2,r[1]+u[1]*h*2]}const c=this._sub(k,l);let m,q;m=0<this._crossProduct(c,this._sub(r,l))?this._rightPerp(c):this._leftPerp(c);q=[];q.push(r);q.push(l);q.push([l[0]+(m[0]-c[0])/3,l[1]+(m[1]-c[1])/3]);a.push(q);m=0<this._crossProduct(c,this._sub(g,k))?this._rightPerp(m):this._leftPerp(c);q=[];q.push([k[0]+(m[0]+c[0])/3,k[1]+(m[1]+c[1])/3]);q.push(k);q.push(g);a.push(q);break}case B.GeometricEffectControlMeasureLineRule.GapExtentWithDoubleTicks:{const k=
this._cp2(b,0,2),r=this._cp3(b,k,0,1);let g;if(4<=e)g=b[3];else{const c=this._sub(k,l);g=this._add(r,c)}this._addAngledTicks(a,l,k,this._mid(r,g));this._addAngledTicks(a,r,g,this._mid(l,k));break}case B.GeometricEffectControlMeasureLineRule.GapExtentMidline:{const k=this._cp2(b,2,0),r=this._cp3(b,k,0,1);let g;if(4<=e)g=b[3];else{const m=this._sub(k,l);g=this._add(r,m)}const c=[];c.push(this._mid(l,r));c.push(this._mid(k,g));a.push(c);break}case B.GeometricEffectControlMeasureLineRule.Chevron:{const k=
this._cp2(b,-1,-1);let r;if(3<=e)r=b[2];else{const g=this._sub(k,l);this._leftPerpendicular(g);r=this._add(l,g)}a.push([k,this._makeCtrlPt(l),r]);break}case B.GeometricEffectControlMeasureLineRule.PerpendicularWithArc:{const k=this._cp2(b,0,-2),r=this._cp3(b,k,.5,-1);let g=this._sub(k,l);const c=this._norm(g);g[0]/=c;g[1]/=c;const m=this._crossProduct(g,this._sub(r,l));let q=this._dotProduct(g,this._sub(r,l));q<.05*c?q=.05*c:q>.95*c&&(q=.95*c);const p=[l[0]+g[0]*q,l[1]+g[1]*q];this._leftPerpendicular(g);
let u=[];u.push([p[0]-g[0]*m,p[1]-g[1]*m]);u.push([p[0]+g[0]*m,p[1]+g[1]*m]);a.push(u);const h=[k[0]+g[0]*m,k[1]+g[1]*m];g=this._sub(k,h);const t=Math.cos(Math.PI/18);let v=Math.sin(Math.PI/18);0>m&&(v=-v);u=[l,k];for(let w=1;9>=w;w++)this._rotateDirect(g,t,v),u.push(this._add(h,g));a.push(u);break}case B.GeometricEffectControlMeasureLineRule.ClosedHalfCircle:{const k=this._cp2(b,2,0),r=this._mid(l,k),g=this._sub(k,r),c=Math.cos(Math.PI/18),m=Math.sin(Math.PI/18),q=[l,k];for(let p=1;18>=p;p++)this._rotateDirect(g,
c,m),q.push(this._add(r,g));a.push(q);break}case B.GeometricEffectControlMeasureLineRule.TripleParallelExtended:{const k=this._cp2(b,0,-2),r=this._cp3(b,k,1,-2),g=this._mid(l,k),c=this._sub(r,k);this._normalize(c);const m=Math.abs(this._crossProduct(c,this._sub(g,k)))/2,q=this._dist(k,r),p=[k,l];p.push([l[0]+c[0]*q*.5,l[1]+c[1]*q*.5]);a.push(p);const u=[];u.push([g[0]-c[0]*m,g[1]-c[1]*m]);u.push([g[0]+c[0]*q*.375,g[1]+c[1]*q*.375]);C.setId(u[u.length-1],1);u.push([g[0]+c[0]*q*.75,g[1]+c[1]*q*.75]);
a.push(u);a.push([k,r]);break}case B.GeometricEffectControlMeasureLineRule.ParallelWithTicks:{const k=this._cp2(b,3,0),r=this._cp3(b,k,.5,-1),g=this._sub(r,k);this._normalize(g);const c=this._crossProduct(g,this._sub(r,l));this._leftPerpendicular(g);this._addAngledTicks(a,l,k,r);this._addAngledTicks(a,this._mix(l,1,g,c),this._mix(k,1,g,c),this._mid(l,k));break}case B.GeometricEffectControlMeasureLineRule.Parallel:{const k=this._cp2(b,3,0),r=this._cp3(b,k,.5,-1),g=this._sub(k,l);this._normalize(g);
const c=this._leftPerp(g),m=this._crossProduct(g,this._sub(r,l));let q=[l,k];a.push(q);q=[];q.push([l[0]+c[0]*m,l[1]+c[1]*m]);q.push([k[0]+c[0]*m,k[1]+c[1]*m]);a.push(q);break}case B.GeometricEffectControlMeasureLineRule.PerpendicularToFirstSegment:{const k=this._cp2(b,3,0),r=this._cp3(b,k,.5,-1),g=this._mid(l,k),c=this._sub(k,l);this._normalize(c);const m=this._crossProduct(c,this._sub(r,l));this._leftPerpendicular(c);const q=[];q.push([g[0]-c[0]*m*.25,g[1]-c[1]*m*.25]);q.push([g[0]+c[0]*m*1.25,
g[1]+c[1]*m*1.25]);a.push(q);break}case B.GeometricEffectControlMeasureLineRule.ParallelOffset:{const k=this._cp2(b,3,0),r=this._cp3(b,k,.5,-1),g=this._sub(k,l);this._normalize(g);const c=this._crossProduct(g,this._sub(r,l));this._leftPerpendicular(g);const m=[];m.push([l[0]-g[0]*c,l[1]-g[1]*c]);m.push([k[0]-g[0]*c,k[1]-g[1]*c]);a.push(m);const q=[];q.push([l[0]+g[0]*c,l[1]+g[1]*c]);q.push([k[0]+g[0]*c,k[1]+g[1]*c]);a.push(q);break}case B.GeometricEffectControlMeasureLineRule.OffsetOpposite:{const k=
this._cp2(b,3,0),r=this._cp3(b,k,.5,-1),g=this._sub(k,l);this._normalize(g);const c=this._crossProduct(g,this._sub(r,l));this._leftPerpendicular(g);const m=[];m.push([l[0]-g[0]*c,l[1]-g[1]*c]);m.push([k[0]-g[0]*c,k[1]-g[1]*c]);a.push(m);break}case B.GeometricEffectControlMeasureLineRule.OffsetSame:{const k=this._cp2(b,3,0),r=this._cp3(b,k,.5,-1),g=this._sub(k,l);this._normalize(g);const c=this._crossProduct(g,this._sub(r,l));this._leftPerpendicular(g);const m=[];m.push([l[0]+g[0]*c,l[1]+g[1]*c]);
m.push([k[0]+g[0]*c,k[1]+g[1]*c]);a.push(m);break}case B.GeometricEffectControlMeasureLineRule.CircleWithArc:{let k=this._cp2(b,3,0);const r=this._cp3(b,k,.5,-1);let g,c;if(4<=e)g=b[3],c=0<this._crossProduct(this._sub(g,k),this._sub(r,k));else{g=k;c=0<this._crossProduct(this._sub(g,l),this._sub(r,l));const h=24*this._geomUnitsPerPoint,t=this._sub(g,l);this._normalize(t,h);const v=Math.sqrt(2)/2;this._rotateDirect(t,v,c?v:-v);k=this._add(l,t)}const m=this._sub(k,l),q=Math.cos(Math.PI/18),p=Math.sin(Math.PI/
18),u=[k];for(let h=1;36>=h;h++)this._rotateDirect(m,q,p),u.push(this._add(l,m));this._add90DegArc(u,k,g,r,c);C.setId(u[u.length-8],1);a.push(u);break}case B.GeometricEffectControlMeasureLineRule.DoubleJog:{let k=this._cp2(b,-3,1),r;r=3<=e?b[2]:this._add(l,this._sub(l,k));let g;if(4<=e)g=b[3];else{const w=l;l=k;g=r;const A=this._dist(l,w),E=this._dist(g,w);let G=30*this._geomUnitsPerPoint;.5*A<G&&(G=.5*A);.5*E<G&&(G=.5*E);k=this._mix(l,G/A,w,(A-G)/A);r=this._mix(g,G/E,w,(E-G)/E)}const c=this._mid(l,
k),m=this._mid(g,r),q=this._dist(l,k),p=this._dist(r,g);let u=Math.min(q,p)/8;u=Math.min(u,24*this._geomUnitsPerPoint);const h=Math.cos(Math.PI/4);let t=this._sub(l,k);this._normalize(t,u);0<this._crossProduct(t,this._sub(g,k))?this._rotateDirect(t,h,-h):this._rotateDirect(t,h,h);let v=[];v.push(k);v.push(this._add(c,t));v.push(this._sub(c,t));v.push(l);a.push(v);t=this._sub(g,r);this._normalize(t,u);0>this._crossProduct(t,this._sub(l,r))?this._rotateDirect(t,h,h):this._rotateDirect(t,h,-h);v=[];
v.push(r);v.push(this._add(m,t));v.push(this._sub(m,t));v.push(g);a.push(v);break}case B.GeometricEffectControlMeasureLineRule.PerpendicularOffset:{const k=this._cp2(b,-4,1),r=this._cp3(b,k,.882353,-1.94),g=this._sub(r,k);0<this._crossProduct(g,this._sub(l,k))?this._rightPerpendicular(g):this._leftPerpendicular(g);const c=[g[0]/8,g[1]/8],m=this._sub(this._mid(k,r),c);a.push([m,l]);break}case B.GeometricEffectControlMeasureLineRule.LineExcludingLastSegment:{const k=this._arrowPath(b),r=[];let g=k.length-
2;for(;g--;)r.push(k[g]);a.push(r);break}case B.GeometricEffectControlMeasureLineRule.MultivertexArrow:{const k=this._arrowPath(b),r=[];this._addArrow(r,k,!1);a.push(r);break}case B.GeometricEffectControlMeasureLineRule.CrossedArrow:{const k=this._arrowPath(b),r=[];this._addArrow(r,k,!0);a.push(r);break}case B.GeometricEffectControlMeasureLineRule.ChevronArrow:{const [k,r]=this._arrowLastSeg(b),g=10*this._geomUnitsPerPoint,c=this._sub(l,k);this._normalize(c);const m=this._crossProduct(c,this._sub(r,
k)),q=this._leftPerp(c),p=[r[0]-q[0]*m*2,r[1]-q[1]*m*2],u=[];u.push([r[0]+c[0]*g,r[1]+c[1]*g]);u.push(l);u.push([p[0]+c[0]*g,p[1]+c[1]*g]);a.push(u);break}case B.GeometricEffectControlMeasureLineRule.ChevronArrowOffset:{const [k,r]=this._arrowLastSeg(b),g=this._sub(l,k);this._normalize(g);const c=this._crossProduct(g,this._sub(r,k));this._leftPerpendicular(g);const m=[r[0]-g[0]*c,r[1]-g[1]*c],q=[];q.push([m[0]+g[0]*c*.5,m[1]+g[1]*c*.5]);q.push(this._mid(m,l));q.push([m[0]-g[0]*c*.5,m[1]-g[1]*c*.5]);
a.push(q);break}case B.GeometricEffectControlMeasureLineRule.PartialFirstSegment:{const [k,r]=this._arrowLastSeg(b),g=this._sub(l,k);this._normalize(g);const c=this._crossProduct(g,this._sub(r,k));this._leftPerpendicular(g);a.push([k,[r[0]-g[0]*c,r[1]-g[1]*c]]);break}case B.GeometricEffectControlMeasureLineRule.Arch:{const k=this._cp2(b,0,-1),r=this._cp3(b,k,.5,1),g=this._sub(l,k),c=this._mix(r,1,g,.55),m=this._mix(r,1,g,-.55),q=[l];this._addBezier2(q,l,c,r,4);this._addBezier2(q,r,m,k,4);a.push(q);
break}case B.GeometricEffectControlMeasureLineRule.CurvedParallelTicks:{const k=this._cp2(b,-4,1),r=this._cp3(b,k,.882353,-1.94),g=this._sub(r,k);0<this._crossProduct(g,this._sub(l,k))?this._rightPerpendicular(g):this._leftPerpendicular(g);const c=[g[0]/8,g[1]/8],m=this._sub(this._mid(k,r),c),q=this._sub(this._mix(k,.75,r,.25),c),p=this._sub(this._mix(k,.25,r,.75),c),u=[k];this._addBezier2(u,k,q,m,3);this._addBezier2(u,m,p,r,3);a.push(u);for(let h=0;8>h;h++){const t=u[2*h+1],v=[this._clone(t)];v.push(this._add(t,
[g[0]/4,g[1]/4]));a.push(v)}break}case B.GeometricEffectControlMeasureLineRule.Arc90Degrees:{const k=this._cp2(b,0,-1),r=this._cp3(b,k,.5,1),g=[k];this._add90DegArc(g,k,l,r);a.push(g);break}default:a.push(b)}}return a};return n}();z.EffectControlMeasureLine=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(z,
D,C,B){let y=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=function(f,d,a,b){return new x(f,d,a)};return n}();y.instance=null;let x=function(n){function f(d,a,b){d=n.call(this,d,!0,!0)||this;d._curveHelper=new B.CurveHelper;d._beginCut=(void 0!==a.beginCut?a.beginCut:1)*b;d._endCut=(void 0!==a.endCut?a.endCut:1)*b;d._middleCut=(void 0!==a.middleCut?a.middleCut:0)*b;d._invert=void 0!==a.invert?a.invert:!1;0>d._beginCut&&(d._beginCut=
0);0>d._endCut&&(d._endCut=0);0>d._middleCut&&(d._middleCut=0);return d}D._inheritsLoose(f,n);f.prototype.processPath=function(d){var a=this._beginCut;const b=this._endCut,e=this._middleCut,l=this._curveHelper.calculatePathLength(d),k=[];if(!this._invert)0===a&&0===b&&0===e?k.push(d):a+b+e>=l||(0===e?(d=this._curveHelper.getSubCurve(d,a,l-b))&&k.push(d):((a=this._curveHelper.getSubCurve(d,a,.5*(l-e)))&&k.push(a),(a=this._curveHelper.getSubCurve(d,.5*(l+e),l-b))&&k.push(a)));else if(0!==a||0!==b||
0!==e)a+b+e>=l?k.push(d):((a=this._curveHelper.getSubCurve(d,0,a))&&k.push(a),(a=this._curveHelper.getSubCurve(d,.5*(l-e),.5*(l+e)))&&k.push(a),(a=this._curveHelper.getSubCurve(d,l-b,b))&&k.push(a));return 0===k.length?null:{paths:k}};return f}(C.PathGeometryCursor);z.EffectCut=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectDashes":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../CIMCursor ../CurveHelper ../enums ../GeometryWalker".split(" "),
function(z,D,C,B,y,x){let n=function(){function d(){}d.local=function(){null===d.instance&&(d.instance=new d);return d.instance};d.prototype.execute=function(a,b,e,l){return new f(a,b,e)};return d}();n.instance=null;let f=function(d){function a(b,e,l){var k,r;b=d.call(this,b,!0,!0)||this;b._walker=new x.GeometryWalker;b._walker.updateTolerance(l);b._endings=e.lineDashEnding;b._customDashPos=-(null!=(k=e.offsetAlongLine)?k:0)*l;b._offsetAtEnd=(null!=(r=e.customEndingOffset)?r:0)*l;b._pattern=new x.DashPattern;
b._pattern.init(e.dashTemplate,!0);b._pattern.scale(l);return b}D._inheritsLoose(a,d);a.prototype.processPath=function(b){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[b]};if(!this.iteratePath){var e=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case y.LineDashEnding.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case y.LineDashEnding.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case y.LineDashEnding.NoConstraint:this.isClosed||
(e=!1);break;case y.LineDashEnding.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var l=this._walker.calculatePathLength(b);if(this._pattern.isEmpty()||l<.1*this._pattern.length()||!this._walker.init(b,this._pattern,e))return{paths:[b]}}if(this.iteratePath)b=this._pattern.nextValue();else{switch(this._endings){default:e=.5*this._pattern.firstValue();break;case y.LineDashEnding.HalfGap:e=.5*-this._pattern.lastValue();break;case y.LineDashEnding.FullGap:e=-this._pattern.lastValue();
break;case y.LineDashEnding.FullPattern:e=0;break;case y.LineDashEnding.NoConstraint:case y.LineDashEnding.Custom:e=-this._customDashPos}b=e/this._pattern.length();b-=Math.floor(b);e=b*this._pattern.length();this._pattern.reset();b=this._pattern.nextValue();for(l=!1;e>=b;)e-=b,b=this._pattern.nextValue(),l=!l;b-=e;l?(this._walker.nextPosition(b),b=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(b),b=this._pattern.nextValue(),this._walker.nextPosition(b),b=this._pattern.nextValue())}(e=
this._walker.nextCurve(b))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),B.PathHelper.mergePath(e,this._firstCurve),this._firstCurve=null)):(b=this._pattern.nextValue(),!this._walker.nextPosition(b)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(e=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,e=this._firstCurve,this._firstCurve=null);return{paths:[e]}};return a}(C.PathGeometryCursor);z.EffectDashes=
n;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(z,D,C,B){let y=function(){function f(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var d=f.prototype;d.isEmpty=function(){return 0===this._values.length};d.size=function(){return this._values.length};d.init=function(a,b,e=!0){this._setEmpty();
if(!a||0===a.length)return!1;for(let l=0;l<a.length;l++){let k=Math.abs(a[l]);e&&1E-7>k&&(k=1E-7);this._values.push(k);this._length+=k}b&&a.length&1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};d.scale=function(a){const b=this._values?this._values.length:0;for(let e=0;e<b;++e)this._values[e]*=a;this._length*=a;this.extPtGap*=a;this.ctrlPtGap*=a};d.addValue=function(a){this._length+=a;this._values.push(a)};d.firstValue=function(){return this._values[0]};
d.lastValue=function(){return this._values[this._values.length-1]};d.nextValue=function(){this._currentValue++;this._currentValue===this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};d.reset=function(){this._currentValue=-1};d.length=function(){return this._length};d._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return f}();z.EndType=void 0;(function(f){f[f.FAIL=0]="FAIL";f[f.END=1]="END";f[f.CONTINUE=
2]="CONTINUE"})(z.EndType||(z.EndType={}));let x=function(){function f(){this.reset()}var d=f.prototype;d.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};d.isValid=function(){return-1!==this.segment};d.copyTo=function(a){a.segment=this.segment;a.segmentLength=this.segmentLength;a.abscissa=this.abscissa;a.isPathEnd=this.isPathEnd;a.isPartEnd=this.isPartEnd};return f}(),n=function(f){function d(b=0,e=!1){b=f.call(this,b,e)||this;b._tolerance=B.PIXEL_TOLERANCE;
b._currentPosition=new x;return b}D._inheritsLoose(d,f);var a=d.prototype;a.updateTolerance=function(b){this._tolerance=B.PIXEL_TOLERANCE*b};a.init=function(b,e,l=!0){l?(this._patternLength=e.length(),this._partExtPtGap=e.extPtGap,this._partCtrlPtGap=e.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=b;this._seg=-1;return this._setPosAtNextPart()};a.curPositionIsValid=function(){return this._currentPosition.isValid()};
a.nextPosition=function(b,e=z.EndType.FAIL){const l=new x;if(!this._nextPosition(b,l,null,e))return!1;l.copyTo(this._currentPosition);return!0};a.curPointAndAngle=function(b){b.pt=this._getPoint(this._currentPosition);const [e,l]=this._getAngle(this._currentPosition);b.ca=e;b.sa=l};a.nextPointAndAngle=function(b,e,l=z.EndType.FAIL){const k=new x;if(!this._nextPosition(b,k,null,l))return!1;k.copyTo(this._currentPosition);e.pt=this._getPoint(k);const [r,g]=this._getAngle(k);e.ca=r;e.sa=g;return!0};
a.nextCurve=function(b){if(0===b)return null;const e=[],l=new x;if(!this._nextPosition(b,l,e,z.EndType.END))return null;l.copyTo(this._currentPosition);return e};a.isPathEnd=function(){return this._currentPosition.isPathEnd};a.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};a._nextPosition=function(b,e,l,k){if(this._currentPosition.isPathEnd)return!1;var r=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&
(r/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(e);e.abscissa+b*this._partLengthRatio>e.segmentLength+this._tolerance;)if(l&&(0===l.length&&(0===r?(r=this._path[e.segment],l.push([r[0],r[1]])):l.push(this.getSegCoord2D(this._path,e.segment,r))),r=this._path[e.segment+1],l.push([r[0],r[1]])),r=0,b-=(e.segmentLength-e.abscissa)/this._partLengthRatio,this._partSegCount)e.segment=this._nextSegment(),e.segmentLength=this.calculateSegLength(this._path,e.segment),e.abscissa=0,this._partSegCount--;
else{if(!this._setPosAtNextPart()){if(k===z.EndType.FAIL)return!1;e.segmentLength=this.calculateSegLength(this._path,e.segment);e.isPartEnd=!0;k===z.EndType.END?(e.abscissa=e.segmentLength,e.isPathEnd=!0):e.abscissa=e.segmentLength+b;return!0}this._currentPosition.copyTo(e)}e.abscissa+=b*this._partLengthRatio;l&&(0===l.length&&(0===r?(b=this._path[e.segment],l.push([b[0],b[1]])):l.push(this.getSegCoord2D(this._path,e.segment,r))),b=e.abscissa/e.segmentLength,1===b?(b=this._path[e.segment+1],l.push([b[0],
b[1]])):l.push(this.getSegCoord2D(this._path,e.segment,b)));!this._partSegCount&&Math.abs(e.abscissa-e.segmentLength)<this._tolerance&&(e.isPathEnd=this._partIsLast,e.isPartEnd=!0);return!0};a._getPoint=function(b){if(-1===b.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,b.segment,0>=b.segmentLength?0:b.abscissa/b.segmentLength)};a._getAngle=function(b){if(-1===b.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,b.segment,0>=b.segmentLength?0:
b.abscissa/b.segmentLength)};a._setPosAtNextPart=function(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this._nextSegment()),this._partSegCount++,1===C.getId(this._path[this._getEndPointIndex()])){this._partIsLast=!this._hasNextSegment();break}for(var b=this._partSegCount;b;)this._previousSegment(),
--b;this._currentPosition.segment=this._nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;b=this._getStartPointIndex();this._ctrlPtBegin=1===C.getId(this._path[b]);b=b+this._partSegCount+1;b>=this._path.length&&(b=0);this._ctrlPtEnd=1===C.getId(this._path[b]);if(0<this._patternLength){b=this._ctrlPtBegin?this._partCtrlPtGap:
this._partExtPtGap;const e=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let l=Math.round((this._partLength-(b+e))/this._patternLength);0>=l&&(l=0<b+e?0:1);this._partLengthRatio=this._partLength/(b+e+l*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};a._hasNextSegment=function(){return this._seg<this._path.length-2};a._previousSegment=function(){return--this._seg};a._nextSegment=function(){return++this._seg};a._getStartPointIndex=
function(){return this._seg};a._getEndPointIndex=function(){return this._seg+1};return d}(B.CurveHelper);z.DashPattern=y;z.GeometryWalker=n;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectDonut":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(z,D,C,B){let y=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=
function(f,d,a,b){return new x(f,d,a)};return n}();y.instance=null;let x=function(){function n(f,d,a){this._inputGeometries=f;this._curveHelper=new C.CurveHelper;this._width=(void 0!==d.width?d.width:2)*a;switch(d.method){default:this._method=B.GeometricEffectOffsetMethod.Mitered;break;case B.GeometricEffectDonutMethod.Bevelled:this._method=B.GeometricEffectOffsetMethod.Bevelled;break;case B.GeometricEffectDonutMethod.Rounded:case B.GeometricEffectDonutMethod.TrueBuffer:this._method=B.GeometricEffectOffsetMethod.Rounded;
break;case B.GeometricEffectDonutMethod.Square:this._method=B.GeometricEffectOffsetMethod.Square}this._option=d.option;this._offsetFlattenError=C.PIXEL_TOLERANCE*a}n.prototype.next=function(){for(var f=this._inputGeometries.next();f;){if(D.isExtent(f)&&0<this._width){if(0>Math.min(f.xmax-f.xmin,f.ymax-f.ymin)-2*this._width)return f;var d=[];d.push([[f.xmin,f.ymin],[f.xmin,f.ymax],[f.xmax,f.ymax],[f.xmax,f.ymin],[f.xmin,f.ymin]]);d.push([[f.xmin+this._width,f.ymin+this._width],[f.xmax-this._width,
f.ymin+this._width],[f.xmax-this._width,f.ymax-this._width],[f.xmin+this._width,f.ymax-this._width],[f.xmin+this._width,f.ymin+this._width]]);return{rings:d}}if(D.isPolygon(f)&&0<this._width){d=[];for(const a of f.rings){f=this._curveHelper.calculatePathLength(a);const b=this._curveHelper.offset(a,this._width,this._method,4,this._offsetFlattenError);b&&(0>f&&b.reverse(),d.push(b))}if(d.length)return{rings:d}}f=this._inputGeometries.next()}return null};return n}();z.EffectDonut=y;Object.defineProperties(z,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(z,D,C,B){let y=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=function(f,d,a,b){return new x(f,d,a)};return n}();y.instance=null;let x=function(n){function f(d,a,b){d=n.call(this,d,!1,!0)||this;d._curveHelper=
new B.CurveHelper;d._length=(void 0!==a.length?a.length:20)*b;d._angle=void 0!==a.angle?a.angle:225;d._position=void 0!==a.position?a.position:50;0>d._length&&(d._length=-d._length);20>d._position&&(d._position=20);80<d._position&&(d._position=80);d._mirror=!1;return d}D._inheritsLoose(f,n);f.prototype.processPath=function(d){if(this._curveHelper.isEmpty(d,!1))return null;const a=d[0];d=d[d.length-1];this._curveHelper.normalize([d[0]-a[0],d[1]-a[1]]);const b=[a[0]+(d[0]-a[0])*this._position/100,a[1]+
(d[1]-a[1])*this._position/100],e=Math.cos((90-this._angle)/180*Math.PI);let l=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(l=-l);this._mirror=!this._mirror;return{paths:[[a,[b[0]-this._length/2*e,b[1]-this._length/2*l],[b[0]+this._length/2*e,b[1]+this._length/2*l],d]]}};return f}(C.PathGeometryCursor);z.EffectJog=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../core/lang",
"../../../geometry/support/jsonUtils"],function(z,D,C){let B=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(n,f,d,a){return new y(n,f,d)};return x}();B.instance=null;let y=function(){function x(f,d,a){this._inputGeometries=f;this._offsetX=void 0!==d.offsetX?d.offsetX*a:0;this._offsetY=void 0!==d.offsetY?-d.offsetY*a:0}var n=x.prototype;n.next=function(){for(var f=this._inputGeometries.next();f;){if(C.isExtent(f))return{xmin:f.xmin+
this._offsetX,xmax:f.xmax+this._offsetX,ymin:f.ymin+this._offsetY,ymax:f.ymax+this._offsetY};if(C.isPolygon(f))return f=D.clone(f),this._moveMultipath(f.rings,this._offsetX,this._offsetY),f;if(C.isPolyline(f))return f=D.clone(f),this._moveMultipath(f.paths,this._offsetX,this._offsetY),f;if(C.isMultipoint(f))return f=D.clone(f),this._movePath(f.points,this._offsetX,this._offsetY),f;if(C.isPoint(f))return{x:f.x+this._offsetX,y:f.y+this._offsetY};f=this._inputGeometries.next()}return null};n._moveMultipath=
function(f,d,a){if(f)for(const b of f)this._movePath(b,d,a)};n._movePath=function(f,d,a){if(f)for(const b of f)b[0]+=d,b[1]+=a};return x}();z.EffectMove=B;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectOffset":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums"],function(z,D,C,B){let y=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};
n.prototype.execute=function(f,d,a,b){return new x(f,d,a)};return n}();y.instance=null;let x=function(){function n(f,d,a){var b;this._inputGeometries=f;this._curveHelper=new C.CurveHelper;this._offset=(null!=(b=d.offset)?b:1)*a;this._method=d.method;this._option=d.option;this._offsetFlattenError=C.PIXEL_TOLERANCE*a}n.prototype.next=function(){for(var f=this._inputGeometries.next();f;){if(0===this._offset)return f;if(D.isExtent(f)){if(this._method===B.GeometricEffectOffsetMethod.Rounded&&0<this._offset){var d=
this._curveHelper.offset([[f.xmin,f.ymin],[f.xmin,f.ymax],[f.xmax,f.ymax],[f.xmax,f.ymin],[f.xmin,f.ymin]],-this._offset,this._method,4,this._offsetFlattenError);return d?{rings:[d]}:null}if(0<Math.min(f.xmax-f.xmin,f.ymax-f.ymin)+2*this._offset)return{xmin:f.xmin-this._offset,xmax:f.xmax+this._offset,ymin:f.ymin-this._offset,ymax:f.ymax+this._offset}}if(D.isPolygon(f)){var a=[];for(d of f.rings){const b=this._curveHelper.offset(d,-this._offset,this._method,4,this._offsetFlattenError);b&&a.push(b)}if(a.length)return{rings:a}}if(D.isPolyline(f)){a=
[];for(const b of f.paths)(f=this._curveHelper.offset(b,-this._offset,this._method,4,this._offsetFlattenError))&&a.push(f);if(a.length)return{paths:a}}f=this._inputGeometries.next()}return null};return n}();z.EffectOffset=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(z,D,C,B){let y=function(){function n(){}
n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=function(f,d,a,b){return new x(f,d,a)};return n}();y.instance=null;let x=function(){function n(f,d,a){this._inputGeometries=f;this._reverse=void 0!==d.reverse?d.reverse:!0}n.prototype.next=function(){for(var f=this._inputGeometries.next();f;){if(!this._reverse)return f;if(C.isPolyline(f))return f=D.clone(f),B.reverseMultipath(f.paths),f;f=this._inputGeometries.next()}return null};return n}();z.EffectReverse=
y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectRotate":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(z,D,C,B,y){let x=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(d,a,b,e){return new n(d,a,b)};return f}();
x.instance=null;let n=function(){function f(a,b,e){this._inputGeometries=a;this._rotateAngle=void 0!==b.angle?b.angle*Math.PI/180:0}var d=f.prototype;d.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._rotateAngle)return a;var b=C.create();B.getBoundsXY(b,a);const e=(b[2]+b[0])/2;b=(b[3]+b[1])/2;if(y.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._rotateMultipath(a.rings,e,b),a;if(y.isPolygon(a))return a=
D.clone(a),this._rotateMultipath(a.rings,e,b),a;if(y.isPolyline(a))return a=D.clone(a),this._rotateMultipath(a.paths,e,b),a;if(y.isMultipoint(a))return a=D.clone(a),this._rotatePath(a.points,e,b),a;if(y.isPoint(a))return a;a=this._inputGeometries.next()}return null};d._rotateMultipath=function(a,b,e){if(a)for(const l of a)this._rotatePath(l,b,e)};d._rotatePath=function(a,b,e){if(a){const l=Math.cos(this._rotateAngle),k=Math.sin(this._rotateAngle);for(const r of a){a=r[0]-b;const g=r[1]-e;r[0]=b+a*
l-g*k;r[1]=e+a*k+g*l}}};return f}();z.EffectRotate=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectScale":function(){define(["exports","../../../core/lang","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils"],function(z,D,C,B,y){let x=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=
function(d,a,b,e){return new n(d,a,b)};return f}();x.instance=null;let n=function(){function f(a,b,e){this._inputGeometries=a;this._xFactor=void 0!==b.xScaleFactor?b.xScaleFactor:1.15;this._yFactor=void 0!==b.yScaleFactor?b.yScaleFactor:1.15}var d=f.prototype;d.next=function(){for(var a=this._inputGeometries.next();a;){if(1===this._xFactor&&1===this._yFactor)return a;var b=C.create();B.getBoundsXY(b,a);const e=(b[2]+b[0])/2;b=(b[3]+b[1])/2;if(y.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,
a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._scaleMultipath(a.rings,e,b),a;if(y.isPolygon(a))return a=D.clone(a),this._scaleMultipath(a.rings,e,b),a;if(y.isPolyline(a))return a=D.clone(a),this._scaleMultipath(a.paths,e,b),a;if(y.isMultipoint(a))return a=D.clone(a),this._scalePath(a.points,e,b),a;if(y.isPoint(a))return a;a=this._inputGeometries.next()}return null};d._scaleMultipath=function(a,b,e){if(a)for(const l of a)this._scalePath(l,b,e)};d._scalePath=function(a,b,e){if(a)for(const l of a)a=
(l[1]-e)*this._yFactor,l[0]=b+(l[0]-b)*this._xFactor,l[1]=e+a};return f}();z.EffectScale=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/effects/EffectWave":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../enums","../GeometryWalker"],function(z,D,C,B,y){let x=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(d,a,b,e){return new n(d,
a,b)};return f}();x.instance=null;let n=function(){function f(a,b,e){this._inputGeometries=a;this._height=(void 0!==b.amplitude?b.amplitude:2)*e;this._period=(void 0!==b.period?b.period:3)*e;this._style=b.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new y.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);this._walker=new y.GeometryWalker;this._walker.updateTolerance(e)}var d=
f.prototype;d.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._height||0===this._period)return a;if(D.isPolyline(a)){const b=this._processGeom(a.paths);if(b.length)return{paths:b}}if(D.isPolygon(a)&&(a=this._processGeom(a.rings),a.length))return{rings:a};a=this._inputGeometries.next()}return null};d._processGeom=function(a){const b=[];for(const e of a)if(this._walker.init(e,this._pattern))switch(this._style){default:b.push(this._constructCurve(e,!1));break;case B.GeometricEffectWaveform.Square:b.push(this._constructSquare(e));
break;case B.GeometricEffectWaveform.Triangle:b.push(this._constructTriangle(e));break;case B.GeometricEffectWaveform.Random:b.push(this._constructCurve(e,!0))}else b.push(e);return b};d._constructCurve=function(a,b){const e=new C.PathHelper;var l=this._walker.calculatePathLength(a),k=Math.round(l/this._period);0===k&&(k=1);const r=this._period/16,g=1/(16*k+1);l=2*Math.PI*l/(l/k);k=2*Math.PI*Math.random();const c=2*Math.PI*Math.random(),m=2*Math.PI*Math.random(),q=.75-Math.random()/2,p=.75-Math.random()/
2,u={};this._walker.curPointAndAngle(u);e.startPath(u.pt);let h=0;for(;;)if(this._walker.nextPointAndAngle(r,u)){const t=h;h+=g;let v;if(b){const w=this._height/2*(1+.3*Math.sin(q*l*t+k));v=w*Math.sin(l*t+c);v+=w*Math.sin(p*l*t+m);v/=2}else v=.5*this._height*Math.sin(.5*l*t);e.lineTo([u.pt[0]-v*u.sa,u.pt[1]+v*u.ca])}else{e.lineTo(a[a.length-1]);break}return e.path()};d._constructSquare=function(a){const b=new C.PathHelper;a=this._walker.calculatePathLength(a);Math.round(a/this._period);for(a=!0;;){let e=
!1;if(this._walker.curPositionIsValid()){const l={};this._walker.curPointAndAngle(l);const k={};if(this._walker.nextPointAndAngle(this._period,k)){const r={};this._walker.nextPointAndAngle(this._period,r)&&(a?(b.startPath(l.pt),a=!1):b.lineTo(l.pt),b.lineTo([l.pt[0]-this._height/2*l.sa,l.pt[1]+this._height/2*l.ca]),b.lineTo([k.pt[0]-this._height/2*k.sa,k.pt[1]+this._height/2*k.ca]),b.lineTo([k.pt[0]+this._height/2*k.sa,k.pt[1]-this._height/2*k.ca]),b.lineTo([r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/
2*r.ca]),e=!0)}}if(!e){b.lineTo(this._walker.getPathEnd());break}}return b.path()};d._constructTriangle=function(a){const b=new C.PathHelper;a=this._walker.calculatePathLength(a);Math.round(a/this._period);for(a=!0;;){let e=!1;if(this._walker.curPositionIsValid()){const l={};this._walker.curPointAndAngle(l);const k={};if(this._walker.nextPointAndAngle(this._period/2,k)){const r={};this._walker.nextPointAndAngle(this._period,r)&&(this._walker.nextPosition(this._period/2)&&(a?(b.startPath(l.pt),a=!1):
b.lineTo(l.pt),b.lineTo([k.pt[0]-this._height/2*k.sa,k.pt[1]+this._height/2*k.ca]),b.lineTo([r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca])),e=!0)}}if(!e){b.lineTo(this._walker.getPathEnd());break}}return b.path()};return f}();z.EffectWave=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../enums",
"../GeometryWalker"],function(z,D,C,B,y){let x=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(d,a,b,e){return new n(d,a,b)};return f}();x.instance=null;let n=function(f){function d(b,e,l){var k;b=f.call(this,b,!0,!0)||this;b._geometryWalker=new y.GeometryWalker;b._geometryWalker.updateTolerance(l);b._angleToLine=null!=(k=e.angleToLine)?k:!0;b._offset=(e.offset?e.offset:0)*l;b._originalEndings=e.endings;b._offsetAtEnd=
(e.customEndingOffset?e.customEndingOffset:0)*l;b._position=-(e.offsetAlongLine?e.offsetAlongLine:0)*l;b._pattern=new y.DashPattern;b._pattern.init(e.placementTemplate,!1);b._pattern.scale(l);b._endings=b._originalEndings;return b}D._inheritsLoose(d,f);var a=d.prototype;a.processPath=function(b){if(this._pattern.isEmpty())return null;if(this.iteratePath)var e=this._pattern.nextValue();else{this._endings=this._originalEndings===B.PlacementEndings.WithFullGap&&this.isClosed?B.PlacementEndings.WithMarkers:
this._originalEndings;this._pattern.extPtGap=0;let l=!0;switch(this._endings){case B.PlacementEndings.NoConstraint:e=-this._position;e=this._adjustPosition(e);l=!1;break;default:e=-this._pattern.lastValue()/2;break;case B.PlacementEndings.WithFullGap:e=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case B.PlacementEndings.WithMarkers:e=0;break;case B.PlacementEndings.Custom:e=-this._position,e=this._adjustPosition(e),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(b,
this._pattern,l))return null;this._pattern.reset();for(b=0;e>b;)e-=b,b=this._pattern.nextValue();e=b-=e;this.iteratePath=!0}b={};if(!this._geometryWalker.nextPointAndAngle(e,b)||this._endings===B.PlacementEndings.WithFullGap&&this._geometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===B.PlacementEndings.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(b.pt[0]-this._offset*b.sa,b.pt[1]+this._offset*
b.ca);this._angleToLine&&this.internalPlacement.setRotateCS(b.ca,b.sa);return this.internalPlacement};a._adjustPosition=function(b){b/=this._pattern.length();b-=Math.floor(b);return b*this._pattern.length()};return d}(C.PathTransformationCursor);z.PlacementAlongLineSameSize=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor",
"../CurveHelper","../enums"],function(z,D,C,B,y){let x=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(d,a,b,e){return new n(d,a,b)};return f}();x.instance=null;let n=function(f){function d(b,e,l){b=f.call(this,b,!1,!0)||this;b._curveHelper=new B.CurveHelper;b._angleToLine=void 0!==e.angleToLine?e.angleToLine:!0;b._offset=void 0!==e.offset?e.offset*l:0;b._type=e.extremityPlacement;b._position=void 0!==e.offsetAlongLine?
e.offsetAlongLine*l:0;b._beginProcessed=!1;return b}D._inheritsLoose(d,f);var a=d.prototype;a.processPath=function(b){let e;switch(this._type){default:this._beginProcessed?(e=this._atExtremities(b,this._position,!1),this.iteratePath=this._beginProcessed=!1):(e=this._atExtremities(b,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case y.ExtremityPlacement.JustBegin:e=this._atExtremities(b,this._position,!0);break;case y.ExtremityPlacement.JustEnd:e=this._atExtremities(b,this._position,
!1);case y.ExtremityPlacement.None:}return e};a._atExtremities=function(b,e,l){var k=b.length;if(2>k)return null;var r=l?1:k-2;const g=l?k:-1,c=l?1:-1;let m=0;l=l?b[0]:b[k-1];for(k=r;k!==g;k+=c){r=l;l=b[k];const q=this._curveHelper.calculateLength(r,l);if(m+q>e){b=(e-m)/q;const [p,u]=this._curveHelper.getAngleCS(r,l,b);b=C.getCoord2D(r,l,b);this.internalPlacement.setTranslate(b[0]-this._offset*u,b[1]+this._offset*p);this._angleToLine&&this.internalPlacement.setRotateCS(-p,-u);return this.internalPlacement}m+=
q}return null};return d}(C.PathTransformationCursor);z.PlacementAtExtremities=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../GeometryWalker"],function(z,D,C,B){let y=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};n.prototype.execute=function(f,d,a,b){return new x(f,
d,a)};return n}();y.instance=null;let x=function(n){function f(d,a,b){d=n.call(this,d,!0,!0)||this;d._walker=new B.GeometryWalker;d._walker.updateTolerance(b);d._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;d._offset=void 0!==a.offset?a.offset*b:0;d._beginGap=void 0!==a.beginPosition?a.beginPosition*b:0;d._endGap=void 0!==a.endPosition?a.endPosition*b:0;d._flipFirst=void 0!==a.flipFirst?a.flipFirst:!0;d._pattern=new B.DashPattern;d._pattern.init(a.positionArray,!1,!1);d._subPathLen=0;d._posCount=
d._pattern.size();d._isFirst=!0;d._prevPos=0;return d}D._inheritsLoose(f,n);f.prototype.processPath=function(d){if(this._pattern.isEmpty())return null;if(this.iteratePath){d=this._pattern.nextValue()*this._subPathLen;var a=this._beginGap+d;d=a-this._prevPos;this._prevPos=a}else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0;this._subPathLen=this._walker.calculatePathLength(d)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(d,
this._pattern,!1))return null;this._pattern.reset();d=this._pattern.nextValue()*this._subPathLen;a=this._beginGap+d;d=a-this._prevPos;this._prevPos=a;this.iteratePath=!0}a={};if(!this._walker.nextPointAndAngle(d,a,B.EndType.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(a.pt[0]-this._offset*a.sa,a.pt[1]+this._offset*a.ca);d=this._isFirst&&this._flipFirst;let b;this._angleToLine?(b=a.ca,a=a.sa):(b=1,a=0);d&&(b=-b,a=-a);this.internalPlacement.setRotateCS(b,a);this._isFirst=
!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return f}(C.PathTransformationCursor);z.PlacementAtRatioPositions=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["exports","../../../core/RandomLCG","../CIMPlacements","../enums"],function(z,D,C,B){let y=function(){function n(){}n.local=function(){null===n.instance&&(n.instance=new n);return n.instance};
n.prototype.execute=function(f,d,a,b){return new x(f,d,a,b)};return n}();y.instance=null;let x=function(){function n(d,a,b,e){var l,k,r;this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._stepX=Math.abs(null!=(l=a.stepX)?l:16)*b;this._stepY=Math.abs(null!=(k=a.stepY)?k:16)*b;if(0!==this._stepX&&0!==this._stepY&&d&&void 0!==d.rings&&d.rings){this._gridType=null!=(r=a.gridType)?r:B.PlacementGridType.Fixed;if(this._gridType===B.PlacementGridType.Random){var g,c;b=null!=
(g=a.seed)?g:13;this._randomLCG=new D(1*b);this._randomness=(null!=(c=a.randomness)?c:100)/100;this._gridAngle=0;this._shiftOddRows=!1;this._cosAngle=1;this._offsetY=this._offsetX=this._sinAngle=0}else{var m,q,p,u;this._randomness=0;this._gridAngle=null!=(m=a.gridAngle)?m:0;this._shiftOddRows=null!=(q=a.shiftOddRows)?q:!1;this._offsetX=(null!=(p=a.offsetX)?p:0)*b;this._offsetY=(null!=(u=a.offsetY)?u:0)*b;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/
180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;this._internalPlacement=new C.Placement;this._calculateMinMax(d);this._geometry=d}}var f=n.prototype;f.next=function(){return this._geometry?
this._nextInside():null};f._calculateMinMax=function(d){this._yMax=this._yMin=this._xMax=this._xMin=0;let a,b,e,l,k;b=e=Number.MAX_VALUE;l=k=-Number.MAX_VALUE;for(const g of d.rings){const c=g?g.length:0;for(let m=0;m<c;++m){var r=g[m][0]-this._graphicOriginX-this._offsetX;a=g[m][1]-this._graphicOriginY-this._offsetY;d=this._cosAngle*r-this._sinAngle*a;r=this._sinAngle*r+this._cosAngle*a;b=Math.min(b,d);l=Math.max(l,d);e=Math.min(e,r);k=Math.max(k,r)}}b+=this._graphicOriginX;l+=this._graphicOriginX;
e+=this._graphicOriginY;k+=this._graphicOriginY;this._xMin=Math.round(b/this._stepX);this._xMax=Math.round(l/this._stepX);this._yMin=Math.round(e/this._stepY);this._yMax=Math.round(k/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1};f._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var d=this._currentX*this._stepX+this._offsetX;
this._shiftOddRows&&this._currentY%2&&(d+=.5*this._stepX);const a=this._currentY*this._stepY+this._offsetY;this._currentX++;let b;this._gridType===B.PlacementGridType.Random?(b=this._graphicOriginX+d+this._stepX*this._randomness*(.5-this._randomLCG.getFloat())*2/3,d=this._graphicOriginY+a+this._stepY*this._randomness*(.5-this._randomLCG.getFloat())*2/3):(b=this._graphicOriginX+this._cosAngle*d+this._sinAngle*a,d=this._graphicOriginY-this._sinAngle*d+this._cosAngle*a);this._internalPlacement.setTranslate(b,
d);return this._internalPlacement}};return n}();z.PlacementInsidePolygon=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(z,D,C,B,y){let x=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(d,a,b,e){return new n(d,
a,b)};return f}();x.instance=null;let n=function(f){function d(b,e,l){b=f.call(this,b,!0,!0)||this;b._curveHelper=new B.CurveHelper;b._angleToLine=void 0!==e.angleToLine?e.angleToLine:!0;b._offset=void 0!==e.offset?e.offset*l:0;b._relativeTo=e.relativeTo;b._position=void 0!==e.startPointOffset?e.startPointOffset*l:0;b._epsilon=.001*l;return b}D._inheritsLoose(d,f);var a=d.prototype;a.processPath=function(b){var e=this._position;if(this._relativeTo===y.PlacementOnLineRelativeTo.SegmentMidpoint){this.iteratePath||
(this._segmentCount=b.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var l=this._curSegment;this._curSegment++;e=b[l-1];l=b[l];const k=this._curveHelper.calculateLength(e,l);if(k<this._epsilon)continue;b=.5+this._position/k;const [r,g]=this._curveHelper.getAngleCS(e,l,b);b=C.getCoord2D(e,l,b);this.internalPlacement.setTranslate(b[0]-this._offset*g,b[1]+this._offset*r);this._angleToLine&&this.internalPlacement.setRotateCS(r,g);return this.internalPlacement}this.iteratePath=
!1;return null}this._relativeTo===y.PlacementOnLineRelativeTo.LineEnd&&C.reversePath(b);e=this.onLine(b,e);this._relativeTo===y.PlacementOnLineRelativeTo.LineEnd&&C.reversePath(b);return e};a.onLine=function(b,e){let l,k=!1;switch(this._relativeTo){default:l=this._curveHelper.calculatePathLength(b)/2+e;break;case y.PlacementOnLineRelativeTo.LineBeginning:l=e;break;case y.PlacementOnLineRelativeTo.LineEnd:l=e,k=!0}const r=b.length;let g=0,c=b[0];for(let m=1;m<r;++m){e=c;c=b[m];const q=this._curveHelper.calculateLength(e,
c);if(g+q>l){b=(l-g)/q;const [p,u]=this._curveHelper.getAngleCS(e,c,b);b=C.getCoord2D(e,c,b);e=k?-this._offset:this._offset;this.internalPlacement.setTranslate(b[0]-e*u,b[1]+e*p);this._angleToLine&&(k?this.internalPlacement.setRotateCS(-p,-u):this.internalPlacement.setRotateCS(p,u));return this.internalPlacement}g+=q}return null};return d}(C.PathTransformationCursor);z.PlacementOnLine=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(z,D,C,B){function y(f,d){const a=Math.PI;for(;Math.abs(d-f)>a+2E-15;)d=d-f>a?d-2*a:d+2*a;return(f+d)/2}let x=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(d,a,b,e){return new n(d,a,b)};return f}();x.instance=null;let n=function(f){function d(b,e,l){b=f.call(this,b,!0,!0)||this;b._curveHelper=new B.CurveHelper;b._angleToLine=void 0!==
e.angleToLine?e.angleToLine:!0;b._offset=void 0!==e.offset?e.offset*l:0;b._endPoints=void 0!==e.placeOnEndPoints?e.placeOnEndPoints:!0;b._controlPoints=void 0!==e.placeOnControlPoints?e.placeOnControlPoints:!0;b._regularVertices=void 0!==e.placeOnRegularVertices?e.placeOnRegularVertices:!0;b._tags=[];b._tagIterator=0;return b}D._inheritsLoose(d,f);var a=d.prototype;a.processPath=function(b){this.iteratePath||(this._preparePath(b),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=
this._tags.length=0,this.iteratePath=!1,null;b=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(b[2]);let e=b[0],l=b[1];if(0!==this._offset){const k=Math.cos(b[2]);e-=this._offset*Math.sin(b[2]);l+=this._offset*k}this.internalPlacement.setTranslate(e,l);this._tagIterator++;return this.internalPlacement};a._preparePath=function(b){this._tagIterator=this._tags.length=0;const e=C.isClosedPath(b),l=b.length-1;let k=0,r=0,g=0,c=0,m=0,q,p;for(;k<l;){k++;q=b[k-1];p=b[k];
const u=C.getId(q),h=C.getId(p);if(this._angleToLine||0!==this._offset)c=this._curveHelper.getAngle(q,p,0);1===k?e?(r=c,g=u):(this._endPoints||this._controlPoints&&1===u)&&this._tags.push([q[0],q[1],c]):1===u?this._controlPoints&&this._tags.push([q[0],q[1],y(m,c)]):this._regularVertices&&this._tags.push([q[0],q[1],y(m,c)]);if(this._angleToLine||0!==this._offset)m=this._curveHelper.getAngle(q,p,1);k===l&&(e?1===h||1===g?this._controlPoints&&this._tags.push([p[0],p[1],y(m,r)]):this._regularVertices&&
this._tags.push([p[0],p[1],y(m,r)]):(this._endPoints||this._controlPoints&&1===h)&&this._tags.push([p[0],p[1],m]))}this._tagIterator=0};return d}(C.PathTransformationCursor);z.PlacementOnVertices=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define(["exports","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../CIMPlacements","../enums"],function(z,D,C,
B,y){let x=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(d,a,b,e){return new n(d,a,b)};return f}();x.instance=null;let n=function(){function f(a,b,e){this._geometry=a;this._offsetX=void 0!==b.offsetX?b.offsetX*e:0;this._offsetY=void 0!==b.offsetY?b.offsetY*e:0;this._method=void 0!==b.method?b.method:y.PlacementPolygonCenterMethod.OnPolygon;this._internalPlacement=new B.Placement}var d=f.prototype;d.next=function(){const a=
this._geometry;this._geometry=null;return a&&void 0!==a.rings?this._polygonCenter(a):null};d._polygonCenter=function(a){switch(this._method){default:case y.PlacementPolygonCenterMethod.CenterOfMass:case y.PlacementPolygonCenterMethod.BoundingBoxCenter:{const b=D.create();C.getBoundsXY(b,a);this._internalPlacement.setTranslate((b[2]+b[0])/2+this._offsetX,(b[3]+b[1])/2+this._offsetY)}}return this._internalPlacement};return f}();z.PlacementPolygonCenter=x;Object.defineProperties(z,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(z){return function(){function D(C=0,B=0,y=0,x=0){this.x=C;this.y=B;this.width=y;this.height=x}D.prototype.union=function(C){this.x=Math.min(this.x,C.x);this.y=Math.min(this.y,C.y);this.width=Math.max(this.width,C.width);this.height=Math.max(this.height,C.height)};z._createClass(D,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return D}()})},
"esri/symbols/cim/TextRasterizer":function(){define(["../../core/screenUtils"],function(z){let D=function(){function B(){}var y=B.prototype;y.rasterizeText=function(x,n){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var f=this._textRasterizationCanvas,d=f.getContext("2d");this._setFontProperties(d,n);this.parameters=n;this.textLines=x.split(/\r?\n/);this.lineHeight=this._computeLineHeight();x=this._computeTextWidth(d,n);const {decoration:a,weight:b}=
n.font;this.lineThroughWidthOffset=a&&"line-through"===a?.1*this.lineHeight:0;var e=this.lineHeight*this.textLines.length;f.width=x+2*this.lineThroughWidthOffset;f.height=e;this.renderedLineHeight=Math.round(this.lineHeight*n.pixelRatio);this.renderedHaloSize=n.halo.size*n.pixelRatio;this.renderedWidth=x*n.pixelRatio;this.renderedHeight=e*n.pixelRatio;this.lineThroughWidthOffset*=n.pixelRatio;f=n.color;this.fillStyle=`rgba(${f.slice(0,3).toString()},${f[3]})`;this.haloStyle=`rgb(${n.halo.color.slice(0,
3).toString()})`;f=this.renderedLineHeight;x=this.renderedHaloSize;this._setFontProperties(d,n);e=d.textAlign;var l=this.renderedWidth;e=("center"===e?.5*l:"right"===e?l:0)+x;l=this.lineThroughWidthOffset;let k=0;0<x&&this._renderHalo(d,e,x,l,k,n);k+=x;l+=e;for(var r of this.textLines)d.globalCompositeOperation="destination-out",d.fillStyle="rgb(0, 0, 0)",d.fillText(r,l,k),d.globalCompositeOperation="source-over",d.fillStyle=this.fillStyle,d.fillText(r,l,k),a&&"none"!==a&&this._renderDecoration(d,
l,k,a,b),k+=f;r=this.renderedWidth+2*this.lineThroughWidthOffset;f=this.renderedHeight;d=d.getImageData(0,0,r,f);d=new Uint8Array(d.data);if(n.premultiplyColors)for(x=0;x<d.length;x+=4)n=d[x+3]/255,d[x]*=n,d[x+1]*=n,d[x+2]*=n;return{size:[r,f],image:new Uint32Array(d.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};y._renderHalo=function(x,n,f,d,a,b){const e=this.renderedWidth,l=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));
this._haloRasterizationCanvas.width=e;this._haloRasterizationCanvas.height=l;const k=this._haloRasterizationCanvas,r=k.getContext("2d");r.clearRect(0,0,e,l);this._setFontProperties(r,b);const {decoration:g,weight:c}=b.font;r.fillStyle=this.haloStyle;r.strokeStyle=this.haloStyle;b=3>this.renderedHaloSize;r.lineJoin=b?"miter":"round";b?this._renderHaloEmulated(r,n,f,g,c):this._renderHaloNative(r,n,f,g,c);x.globalAlpha=this.parameters.halo.color[3];x.drawImage(k,0,0,e,l,d,a,e,l);x.globalAlpha=1};y._renderHaloEmulated=
function(x,n,f,d,a){const b=this.renderedLineHeight,e=this.renderedHaloSize;for(const l of this.textLines){for(const [k,r]of C)x.fillText(l,n+e*k,f+e*r);d&&"none"!==d&&this._renderDecoration(x,n,f,d,a);f+=b}};y._renderHaloNative=function(x,n,f,d,a){const b=this.renderedLineHeight,e=this.renderedHaloSize;for(const l of this.textLines){const k=2*e;for(let r=0;5>r;r++)x.lineWidth=(.6+.1*r)*k,x.strokeText(l,n,f),d&&"none"!==d&&this._renderDecoration(x,n,f,d,a);f+=b}};y._setFontProperties=function(x,n){var f=
n.font;f=`${f.style} ${f.weight} ${z.pt2px(n.size*n.pixelRatio)}px ${f.family}, sans-serif`;x.font=f;x.textBaseline="top";switch(n.horizontalAlignment){case "left":n="left";break;case "right":n="right";break;case "center":n="center";break;default:n="left"}x.textAlign=n};y.computeTextSize=function(x,n){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const f=this._textRasterizationCanvas;var d=f.getContext("2d");this._setFontProperties(d,n);this.parameters=
n;this.textLines=x.split(/\r?\n/);this.lineHeight=this._computeLineHeight();x=this._computeTextWidth(d,n);d=this.lineHeight*this.textLines.length;f.width=x;f.height=d;return[x*n.pixelRatio,d*n.pixelRatio]};y._computeTextWidth=function(x,n){let f=0;for(const d of this.textLines)f=Math.max(f,x.measureText(d).width);n=n.font;if("italic"===n.style||"oblique"===n.style||"string"===typeof n.weight&&("bold"===n.weight||"bolder"===n.weight)||"number"===typeof n.weight&&600<n.weight)f+=.3*x.measureText("w").width;
f+=2*this.parameters.halo.size;return Math.round(f)};y._computeLineHeight=function(){let x=1.275*this.parameters.size;const n=this.parameters.font.decoration;n&&"underline"===n&&(x*=1.3);return Math.round(x+2*this.parameters.halo.size)};y._renderDecoration=function(x,n,f,d,a){const b=.9*this.lineHeight;a="bold"===a?.06:"bolder"===a?.09:.04;switch(x.textAlign){case "center":n-=this.renderedWidth/2;break;case "right":n-=this.renderedWidth}const e=x.textBaseline;if("underline"===d)switch(e){case "top":f+=
b;break;case "middle":f+=b/2}else if("line-through"===d)switch(e){case "top":f+=b/1.5;break;case "middle":f+=b/3}x.save();x.beginPath();x.strokeStyle=x.fillStyle;x.lineWidth=Math.ceil(b*a);x.moveTo(n-this.lineThroughWidthOffset,f);x.lineTo(n+this.renderedWidth+2*this.lineThroughWidthOffset,f);x.stroke();x.restore()};return B}();const C=[];for(let B=0;360>B;B+=22.5)C.push([Math.cos(Math.PI*B/180),Math.sin(Math.PI*B/180)]);return D})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),
function(z,D,C,B,y,x,n,f,d,a){const b=Math.PI/180;let e=function(){function g(m,q,p,u){this._rotationT=B.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const h=p.rect,t=new Float32Array(8);m*=u;q*=u;const v=p.code?h.width*u:p.metrics.width,w=p.code?h.height*u:p.metrics.height;t[0]=m;t[1]=q;t[2]=m+v;t[3]=q;t[4]=m;t[5]=q+w;t[6]=m+v;t[7]=q+w;this._data=t;this._setTextureCoords(h);this._scale=u;this._mosaic=p;this.x=m;this.y=q;this.maxOffset=Math.max(m+v,q+w)}var c=
g.prototype;c.setTransform=function(m){this._T=m;this._offsets=null};c._setOffsets=function(m){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const q=this._offsets,p=new Float32Array(8),u=C.multiply(B.create(),this._rotationT,this._T);B.transformMany(p,m,u);q.upperLeft=f.i1616to32(8*p[0],8*p[1]);q.upperRight=f.i1616to32(8*p[2],8*p[3]);q.lowerLeft=f.i1616to32(8*p[4],8*p[5]);q.lowerRight=f.i1616to32(8*p[6],8*p[7])};c._setTextureCoords=function({x:m,y:q,width:p,height:u}){this._texcoords=
{upperLeft:f.i1616to32(m,q),upperRight:f.i1616to32(m+p,q),lowerLeft:f.i1616to32(m,q+u),lowerRight:f.i1616to32(m+p,q+u)}};D._createClass(g,[{key:"width",get:function(){return this._mosaic.metrics.width*this._scale}},{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(m){this._angle=m;C.fromRotation(this._rotationT,-m);this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},
{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){if(!this._bounds){const {height:h,
width:t}=this._mosaic.metrics;var m=t*this._scale,q=Math.abs(h)*this._scale,p=new Float32Array(8);p[0]=this.x;p[1]=this.y;p[2]=this.x+m;p[3]=this.y;p[4]=this.x;p[5]=this.y+q;p[6]=this.x+m;p[7]=this.y+q;m=C.multiply(B.create(),this._rotationT,this._T);B.transformMany(p,p,m);q=m=Infinity;let v=0;var u=0;for(let w=0;4>w;w++){const A=p[2*w],E=p[2*w+1];m=Math.min(m,A);q=Math.min(q,E);v=Math.max(v,A);u=Math.max(u,E)}p=v-m;u-=q;this._bounds=new a(m+p/2,q+u/2,p,u)}return this._bounds}}]);return g}();const l=
(g,c)=>({code:0,page:0,sdf:!0,rect:new d(0,0,11,8),textureBinding:c,metrics:{advance:0,height:4,width:g,left:0,top:0}});let k=function(){function g(m,q,p){this._rotation=0;this._decorate(m,q,p);this.glyphs=m;this.bounds=this._createBounds(m);this.isMultiline=1<q.length;this._hasRotation=0!==p.angle;this._T=this._createGlyphTransform(this.bounds,p);for(const u of m)u.setTransform(this._T)}var c=g.prototype;c.setRotation=function(m){if(0!==m||0!==this._rotation){this._rotation=m;var q=this._T;m=C.fromRotation(B.create(),
m);C.multiply(q,m,q);for(const p of this.glyphs)p.setTransform(this._T)}};c._decorate=function(m,q,p){if(p.decoration&&"none"!==p.decoration&&m.length){var u=p.scale;p="underline"===p.decoration?30:20;var h=m[0].textureBinding;for(const t of q)m.push(new e(t.startX*u,t.startY*u+p*u,l((t.width+t.glyphWidthEnd)*u,h),1))}};c._createBounds=function(m){let q=Infinity,p=Infinity,u=0;var h=0;for(const t of m)q=Math.min(q,t.xTopLeft),p=Math.min(p,t.yTopLeft),u=Math.max(u,t.xTopLeft+t.width),h=Math.max(h,
t.yBottomRight);m=u-q;h-=p;return new a(q+m/2,p+h/2,m,h)};c._createGlyphTransform=function(m,q){const p=b*q.angle,u=B.create(),h=x.create();C.translate(u,u,y.set(h,q.xOffset,-q.yOffset));q.isCIM?C.rotate(u,u,p):(C.translate(u,u,y.set(h,m.x,m.y)),C.rotate(u,u,p),C.translate(u,u,y.set(h,-m.x,-m.y)));return u};D._createClass(g,[{key:"boundsT",get:function(){var m=this.bounds;const q=y.set(x.create(),m.x,m.y);y.transformMat2d(q,q,this._T);return this._hasRotation?(m=Math.max(m.width,m.height),new a(q[0],
q[1],m,m)):new a(q[0],q[1],m.width,m.height)}}]);return g}(),r=function(g,c,m,q,p,u){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(c,m));this.end=Math.max(0,Math.max(c,m));this.end<g.length&&(this.glyphWidthEnd=g[this.end].metrics.width);this.width=q;this.yMin=p;this.yMax=u};z.ShapedGlyph=e;z.ShapingInfo=k;z.shapeGlyphs=function(g,c,m){const q=m.scale,p=[];{var u=[];var h=1/m.scale*m.maxLineWidth;var t=c?g.length-1:0;var v=c?-1:g.length;c=c?-1:1;var w=t,A=0,E=0;let J=
w,I=J,N=0,M=Infinity,K=0;for(;w!==v;){const {code:O,metrics:X}=g[w];var G=Math.abs(X.top);10!==O&&32!==O&&(M=Math.min(M,G),K=Math.max(K,G+X.height));10===O?(w!==t&&(u.push(new r(g,J,w-c,A,M,K)),M=Infinity,K=0),A=0,J=w+c,I=w+c,E=0):32===O?(I=w+c,E=0,N=X.advance,A+=X.advance):(A>h&&(I!==J?(G=I-2*c,A-=N,u.push(new r(g,J,G,A-E,M,K)),M=Infinity,K=0,J=I,A=E):(u.push(new r(g,J,w-c,A,M,K)),M=Infinity,K=0,I=J=w,A=0)),A+=X.advance,E+=X.advance);w+=c}h=new r(g,J,w-c,A,M,K);0<=h.start&&h.end<g.length&&u.push(h)}for(h=
0;h<u.length;h++);h=t=u[0].yMin;t=u[u.length-1].yMax+m.lineHeight*(u.length-1)+("underline"===m.decoration?4:0)-t;const {vAlign:F,hAlign:H}=m;v=F===n.VAlign.Baseline?1:0;h=(1-v)*-h+t/2*(v?0:F-1)+-26*(v?1:0);for(t=0;t<u.length;t++){const {start:J,end:I,width:N}=u[t];v=N/2*(H+1)*-1-3;c=t*m.lineHeight+h-3;u[t].startX=v;u[t].startY=c;for(w=J;w<=I;w++)A=g[w],10!==A.code&&(E=new e(v+A.metrics.left,c-A.metrics.top,A,q),v+=A.metrics.advance,p.push(E))}return new k(p,u,m)};Object.defineProperties(z,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec2f32"],function(z,D){return function(){function C(y,x,n,f){this.center=D.fromValues(y,x);this.centerT=D.create();this.halfWidth=n/2;this.halfHeight=f/2;this.width=n;this.height=f}var B=C.prototype;B.clone=function(){return new C(this.x,this.y,this.width,this.height)};B.serialize=function(y){y.writeF32(this.center[0]);
y.writeF32(this.center[1]);y.push(this.width);y.push(this.height);return y};B.findCollisionDelta=function(y,x=4){return Math.log2(Math.min((y.halfWidth+this.halfWidth+x)/Math.abs(y.centerT[0]-this.centerT[0]),(y.halfHeight+this.halfHeight+x)/Math.abs(y.centerT[1]-this.centerT[1])))};B.extend=function(y){const x=Math.min(this.xmin,y.xmin),n=Math.min(this.ymin,y.ymin),f=Math.max(this.xmax,y.xmax)-x;y=Math.max(this.ymax,y.ymax)-n;this.width=f;this.height=y;this.halfWidth=f/2;this.halfHeight=y/2;this.x=
x+f/2;this.y=n+y/2};C.deserialize=function(y){const x=y.readF32(),n=y.readF32(),f=y.readInt32();y=y.readInt32();return new C(x,n,f,y)};z._createClass(C,[{key:"x",get:function(){return this.center[0]},set:function(y){this.center[0]=y}},{key:"y",get:function(){return this.center[1]},set:function(y){this.center[1]=y}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},
{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return C}()})},"esri/symbols/cim/SDFHelper":function(){define(["exports","../../core/floatRGBA","../../geometry/support/jsonUtils","./Rect"],function(z,D,C,B){function y(n){if(!n)return null;switch(n.type){case "CIMPointSymbol":var f=
n.symbolLayers;if(!f||1!==f.length)break;return y(f[0]);case "CIMVectorMarker":n=n.markerGraphics;if(!n||1!==n.length)break;var d=n[0];if(!d)break;n=d.geometry;if(!n)break;d=d.symbol;if(!d||"CIMPolygonSymbol"!==d.type&&"CIMLineSymbol"!==d.type||null!=(f=d.symbolLayers)&&f.some(a=>!!a.effects))break;return{geom:n,asFill:"CIMPolygonSymbol"===d.type};case "sdf":return{geom:n.geom,asFill:n.asFill}}return null}function x(n){let f=Infinity,d=-Infinity,a=Infinity,b=-Infinity;for(const e of n)for(const l of e)l[0]<
f&&(f=l[0]),l[0]>d&&(d=l[0]),l[1]<a&&(a=l[1]),l[1]>b&&(b=l[1]);return[f,a,d,b]}z.buildSDF=function(n){var f=n.geom;var d=f?f.rings?f.rings:f.paths?f.paths:void 0!==f.xmin&&void 0!==f.ymin&&void 0!==f.xmax&&void 0!==f.ymax?[[[f.xmin,f.ymin],[f.xmin,f.ymax],[f.xmax,f.ymax],[f.xmax,f.ymin],[f.xmin,f.ymin]]]:null:null;f=Infinity;var a=-Infinity;var b=Infinity,e=-Infinity;for(var l of d)for(var k of l)k[0]<f&&(f=k[0]),k[0]>a&&(a=k[0]),k[1]<b&&(b=k[1]),k[1]>e&&(e=k[1]);a=new B(f,b,a-f,e-b);b=64/Math.max(a.width,
a.height);l=Math.round(a.width*b)+62;k=Math.round(a.height*b)+62;f=[];for(var r of d)if(r&&1<r.length){d=[];for(var g of r){let [A,E]=g;A-=a.x;E-=a.y;A*=b;E*=b;A+=30.5;E+=30.5;n.asFill?d.push([A,E]):d.push([Math.round(A),Math.round(E)])}n.asFill&&(e=d.length-1,d[0][0]===d[e][0]&&d[0][1]===d[e][1]||d.push(d[0]));f.push(d)}var c;r=l*k;g=Array(r);for(d=0;d<r;++d)g[d]=962;for(c of f)for(d=c.length,a=1;a<d;++a){b=c[a-1];e=c[a];var m=void 0,q=void 0;b[0]<e[0]?(m=b[0],q=e[0]):(m=e[0],q=b[0]);var p=void 0,
u=void 0;b[1]<e[1]?(p=b[1],u=e[1]):(p=e[1],u=b[1]);var h=Math.floor(m)-31;q=Math.floor(q)+31;p=Math.floor(p)-31;u=Math.floor(u)+31;0>h&&(h=0);q>l&&(q=l);0>p&&(p=0);u>k&&(u=k);m=e[0]-b[0];const A=e[1]-b[1],E=m*m+A*A;for(;h<q;h++)for(let G=p;G<u;G++){var t=(h-b[0])*m+(G-b[1])*A,v=void 0;0>t?(v=b[0],t=b[1]):t>E?(v=e[0],t=e[1]):(t/=E,v=b[0]+t*m,t=b[1]+t*A);v=(h-v)*(h-v)+(G-t)*(G-t);t=(k-G-1)*l+h;v<g[t]&&(g[t]=v)}}for(c=0;c<r;++c)g[c]=Math.sqrt(g[c]);c=g;if(n.asFill)for(var w of f)for(n=w.length,f=1;f<
n;++f)for(r=w[f-1],g=w[f],r[0]<g[0]?(d=r[0],a=g[0]):(d=g[0],a=r[0]),r[1]<g[1]?(e=r[1],b=g[1]):(e=g[1],b=r[1]),d=Math.floor(d),a=Math.floor(a)+1,e=Math.floor(e),b=Math.floor(b)+1,31>d&&(d=31),a>l-31&&(a=l-31),31>e&&(e=31),b>k-31&&(b=k-31);e<b;++e)if(r[1]>e!==g[1]>e){q=(k-e-1)*l;for(p=d;p<a;++p)p<(g[0]-r[0])*(e-r[1])/(g[1]-r[1])+r[0]&&(c[q+p]=-c[q+p]);for(p=31;p<d;++p)c[q+p]=-c[q+p]}w=c.length;n=new Uint8Array(4*w);for(f=0;f<w;++f)D.packFloatRGBA(.5-c[f]/62,n,4*f);w=n;return[w,l,k]};z.getExtent=function(n){return n?
n.rings?x(n.rings):n.paths?x(n.paths):C.isExtent(n)?[n.xmin,n.ymin,n.xmax,n.ymax]:null:null};z.getSDFInfo=y;z.getSDFMetrics=function(n,f,d,a,b){const [e,l,k,r]=n;if(k<e||r<l)return[0,0,0];var g=k-e,c=r-l;n=64/Math.max(g,c);g=Math.round(g*n);c=Math.round(c*n)+62;let m=1;f&&(m=c/n/(f.ymax-f.ymin));let q=0,p=0;a&&(b?f&&d&&0<f.ymax-f.ymin&&(q=a.x/((f.xmax-f.xmin)/(f.ymax-f.ymin)*d),p=a.y/d):(q=a.x,p=a.y));q=.5*(f.xmax+f.xmin)+q*(f.xmax-f.xmin);p=.5*(f.ymax+f.ymin)+p*(f.ymax-f.ymin);q=(q-e)*n+31;p=(p-
l)*n+31;return[m,q/(g+62)-.5,-(p/c-.5)]};z.getSDFSymbol=function(n){n=n.markerGraphics;if(!n||1!==n.length)return null;n=n[0];if(!n)return null;n=n.symbol;return!n||"CIMPolygonSymbol"!==n.type&&"CIMLineSymbol"!==n.type?null:n};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["exports"],function(z){function D(C){C=C.toLowerCase().split(" ").join("-");switch(C){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";
case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return C}}z.getFontDecorationTop=function(C){switch(C){case "underline":return-26;case "line-through":return-18}return NaN};z.getFontFamily=D;z.getFullyQualifiedFontName=function(C){a:{if(C.weight)switch(C.weight.toLowerCase()){case "bold":case "bolder":var B="-bold";break a}B=""}a:{if(C.style)switch(C.style.toLowerCase()){case "italic":case "oblique":var y="-italic";break a}y=""}B+=y;
return D(C.family)+(0<B.length?B:"-regular")};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/promiseUtils ./Rect ./RectangleBinPack ../../../webgl/enums ../../../webgl/Texture".split(" "),function(z,D,C,B,y,x,n){function f(a){const b=new Set;for(const e of a)b.add(Math.floor(e/256));return b}function d(a,b,e){a.has(b)||
a.set(b,e().then(()=>{a.delete(b)}).catch(l=>{a.delete(b);C.throwIfNotAbortError(l)}));return a.get(b)}return function(){function a(e,l,k){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphCache={};this._textures=[];this._rangePromises=new Map;this.width=e;this.height=l;this._glyphSource=k;this._binPack=new y(e-4,l-4);this._glyphData.push(new Uint8Array(e*l));this._dirties.push(!0);this._textures.push(null);this._initDecorationGlyph()}var b=a.prototype;b.dispose=
function(){this._binPack=null;for(const e of this._textures)e&&e.dispose();this._textures.length=0;this._glyphData.length=0};b._initDecorationGlyph=function(){var e=[117,149,181,207,207,181,149,117];const l=[];for(let k=0;k<e.length;k++){const r=e[k];for(let g=0;11>g;g++)l.push(r)}e={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(l)};this._recordGlyph(e)};b.getGlyphItems=function(){var e=z._asyncToGenerator(function*(l,k,r){const g=this._getGlyphCache(l);yield this._fetchRanges(l,
k,r);return k.map(c=>this._getMosaicItem(g,l,c))});return function(l,k,r){return e.apply(this,arguments)}}();b.bind=function(e,l,k,r){const g=this._getTexture(e,k);g.setSamplingMode(l);this._dirties[k]&&(g.setData(this._glyphData[k]),this._dirties[k]=!1);e.bindTexture(g,r)};b._getGlyphCache=function(e){this._glyphCache[e]||(this._glyphCache[e]={});return this._glyphCache[e]};b._getTexture=function(e,l){this._textures[l]||(this._textures[l]=new n.Texture(e,{pixelFormat:x.PixelFormat.ALPHA,dataType:x.PixelType.UNSIGNED_BYTE,
width:this.width,height:this.height},new Uint8Array(this.width*this.height)));return this._textures[l]};b._invalidate=function(){this._dirties[this._currentPage]=!0};b._fetchRanges=function(){var e=z._asyncToGenerator(function*(l,k,r){const g=[];f(k).forEach(c=>{g.push(this._fetchRange(l,c,r))});yield Promise.all(g)});return function(l,k,r){return e.apply(this,arguments)}}();b._fetchRange=function(){var e=z._asyncToGenerator(function*(l,k,r){return 256<k?null:d(this._rangePromises,l+k,()=>this._glyphSource.getRange(l,
k,r))});return function(l,k,r){return e.apply(this,arguments)}}();b._getMosaicItem=function(e,l,k){if(!e[k]){l=this._glyphSource.getGlyph(l,k);if(!l||!l.metrics)return{rect:new B(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,top:0},code:k,sdf:!0};const r=this._recordGlyph(l);e[k]={rect:r,page:this._currentPage,metrics:l.metrics,code:k,sdf:!0};this._invalidate()}return e[k]};b._recordGlyph=function(e){var l=e.metrics;if(0===l.width)l=new B(0,0,0,0);else{const k=l.width+6,r=l.height+6;
l=this._binPack.allocate(k,r);l.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new y(this.width-4,this.height-4),l=this._binPack.allocate(k,r));const g=this._glyphData[this._currentPage];e=e.bitmap;let c,m;if(e)for(let q=0;q<r;q++){c=k*q;m=this.width*(l.y+q)+l.x;for(let p=
0;p<k;p++)g[m+p]=e[c+p]}D("esri-glyph-debug")&&this._showDebugPage(g)}return l};b._showDebugPage=function(e){const l=document.createElement("canvas"),k=l.getContext("2d"),r=new ImageData(this.width,this.height),g=r.data;l.width=this.width;l.height=this.height;l.style.border="1px solid black";for(let c=0;c<e.length;++c)g[4*c]=e[c],g[4*c+1]=0,g[4*c+2]=0,g[4*c+3]=255;k.putImageData(r,0,0);document.body.appendChild(l)};return a}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./Rect"],function(z,D){return function(){function C(y,x){this._height=this._width=0;this._free=[];this._width=y;this._height=x;this._free.push(new D(0,0,y,x))}var B=C.prototype;B.allocate=function(y,x){if(y>this._width||x>this._height)return new D;let n=null,f=-1;for(let d=0;d<this._free.length;++d){const a=this._free[d];y<=a.width&&x<=a.height&&(null===n||a.y<=n.y&&a.x<=n.x)&&(n=a,f=d)}if(null===n)return new D;this._free.splice(f,1);n.width<n.height?(n.width>y&&this._free.push(new D(n.x+y,n.y,n.width-
y,x)),n.height>x&&this._free.push(new D(n.x,n.y+x,n.width,n.height-x))):(n.width>y&&this._free.push(new D(n.x+y,n.y,n.width-y,n.height)),n.height>x&&this._free.push(new D(n.x,n.y+x,y,n.height-x)));return new D(n.x,n.y,y,x)};B.release=function(y){for(let x=0;x<this._free.length;++x){const n=this._free[x];if(n.y===y.y&&n.height===y.height&&n.x+n.width===y.x)n.width+=y.width;else if(n.x===y.x&&n.width===y.width&&n.y+n.height===y.y)n.height+=y.height;else if(y.y===n.y&&y.height===n.height&&y.x+y.width===
n.x)n.x=y.x,n.width+=y.width;else if(y.x===n.x&&y.width===n.width&&y.y+y.height===n.y)n.y=y.y,n.height+=y.height;else continue;this._free.splice(x,1);this.release(y)}this._free.push(y)};z._createClass(C,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]);return C}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define(["../../../../request","../../../../core/pbf"],function(z,D){let C=function(){function y(n){this._metrics=[];for(this._bitmaps=
[];n.next();)switch(n.tag()){case 1:{const f=n.getMessage();for(;f.next();)switch(f.tag()){case 3:{const d=f.getMessage();let a,b,e,l,k,r,g;for(;d.next();)switch(d.tag()){case 1:a=d.getUInt32();break;case 2:b=d.getBytes();break;case 3:e=d.getUInt32();break;case 4:l=d.getUInt32();break;case 5:k=d.getSInt32();break;case 6:r=d.getSInt32();break;case 7:g=d.getUInt32();break;default:d.skip()}d.release();a&&(this._metrics[a]={width:e,height:l,left:k,top:r,advance:g},this._bitmaps[a]=b);break}default:f.skip()}f.release();
break}default:n.skip()}}var x=y.prototype;x.getMetrics=function(n){return this._metrics[n]};x.getBitmap=function(n){return this._bitmaps[n]};return y}(),B=function(){function y(){this._ranges=[]}var x=y.prototype;x.getRange=function(n){return this._ranges[n]};x.addRange=function(n,f){this._ranges[n]=f};return y}();return function(){function y(n){this._glyphInfo={};this._baseURL=n}var x=y.prototype;x.getRange=function(n,f,d){const a=this._getFontStack(n);if(a.getRange(f))return Promise.resolve();const b=
256*f,e=b+255;n=this._baseURL.replace("{fontstack}",n).replace("{range}",b+"-"+e);return z(n,{responseType:"array-buffer",...d}).then(l=>{a.addRange(f,new C(new D(new Uint8Array(l.data),new DataView(l.data))))})};x.getGlyph=function(n,f){if(n=this._getFontStack(n)){var d=Math.floor(f/256);if(!(256<d)&&(n=n.getRange(d)))return{metrics:n.getMetrics(f),bitmap:n.getBitmap(f)}}};x._getFontStack=function(n){let f=this._glyphInfo[n];f||(f=this._glyphInfo[n]=new B);return f};return y}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["../../../../core/floatRGBA",
"../../../../core/promiseUtils"],function(z,D){return function(){function C(y){this.size=y;const x=document.createElement("canvas");x.width=x.height=y;this._context=x.getContext("2d");this._gridOuter=new Float64Array(y*y);this._gridInner=new Float64Array(y*y);this._f=new Float64Array(y);this._d=new Float64Array(y);this._z=new Float64Array(y+1);this._v=new Int16Array(y)}var B=C.prototype;B.dispose=function(){this._context=this._gridOuter=this._gridInner=this._f=this._d=this._z=this._v=null;this._svg&&
(document.body.removeChild(this._svg),this._svg=null)};B.draw=function(y,x,n=31){this._initSVG();const f=this.createSVGString(y);return new Promise((d,a)=>{const b=new Image;b.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(f);b.onload=()=>{b.onload=null;this._context.clearRect(0,0,this.size,this.size);this._context.drawImage(b,0,0,this.size,this.size);var l=this._context.getImageData(0,0,this.size,this.size);const k=new Uint8Array(this.size*this.size*4);for(let r=0;r<this.size*this.size;r++){const g=
l.data[4*r+3]/255;this._gridOuter[r]=1===g?0:0===g?1E20:Math.max(0,.5-g)**2;this._gridInner[r]=1===g?1E20:0===g?0:Math.max(0,g-.5)**2}this._edt(this._gridOuter,this.size,this.size);this._edt(this._gridInner,this.size,this.size);for(l=0;l<this.size*this.size;l++)z.packFloatRGBA(.5-(this._gridOuter[l]-this._gridInner[l])/(2*n),k,4*l);d(k)};const e=x&&x.signal;if(e)D.onAbort(e,()=>a(D.createAbortError()))})};B._initSVG=function(){if(!this._svg){const y=document.createElementNS("http://www.w3.org/2000/svg",
"svg");y.setAttribute("style","position: absolute;");y.setAttribute("width","0");y.setAttribute("height","0");y.setAttribute("aria-hidden","true");y.setAttribute("role","presentation");document.body.appendChild(y);this._svg=y}};B.createSVGString=function(y){this._initSVG();const x=document.createElementNS("http://www.w3.org/2000/svg","path");x.setAttribute("d",y);this._svg.appendChild(x);y=x.getBBox();var n=y.width/y.height;const f=this.size/2;let d,a,b;1<n?(a=d=f/y.width,b=this.size/4,n=f-1/n*f/
2):(d=a=f/y.height,b=f-f*n/2,n=this.size/4);x.setAttribute("style",`transform: matrix(${d}, 0, 0, ${a}, ${-y.x*d+b}, ${-y.y*a+n})`);y=`<svg style="fill:red;" height="${this.size}" width="${this.size}" xmlns="http://www.w3.org/2000/svg">${this._svg.innerHTML}</svg>`;this._svg.removeChild(x);return y};B._edt=function(y,x,n){const f=this._f,d=this._d,a=this._v,b=this._z;for(var e=0;e<x;e++){for(var l=0;l<n;l++)f[l]=y[l*x+e];this._edt1d(f,d,a,b,n);for(l=0;l<n;l++)y[l*x+e]=d[l]}for(e=0;e<n;e++){for(l=
0;l<x;l++)f[l]=y[e*x+l];this._edt1d(f,d,a,b,x);for(l=0;l<x;l++)y[e*x+l]=Math.sqrt(d[l])}};B._edt1d=function(y,x,n,f,d){n[0]=0;f[0]=-1E20;f[1]=1E20;for(let a=1,b=0;a<d;a++){let e=(y[a]+a*a-(y[n[b]]+n[b]*n[b]))/(2*a-2*n[b]);for(;e<=f[b];)b--,e=(y[a]+a*a-(y[n[b]]+n[b]*n[b]))/(2*a-2*n[b]);b++;n[b]=a;f[b]=e;f[b+1]=1E20}for(let a=0,b=0;a<d;a++){for(;f[b+1]<a;)b++;x[a]=(a-n[b])*(a-n[b])+y[n[b]]}};return C}()})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ./definitions ./GeometryUtils ./Rect ./RectangleBinPack ../../../webgl/enums ../../../webgl/Texture".split(" "),
function(z,D,C,B,y,x,n,f){function d(a){return a&&"static"===a.type}return function(){function a(e,l,k=0){this._mosaicPages=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=e||0>=l)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=e;this._pageHeight=l;0<k&&(this._maxItemSize=k);this.pixelRatio=window.devicePixelRatio||1;this._binPack=new x(this._pageWidth,
this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}var b=a.prototype;b.getWidth=function(e){return e>=this._mosaicPages.length?-1:this._mosaicPages[e].size[0]};b.getHeight=function(e){return e>=this._mosaicPages.length?-1:this._mosaicPages[e].size[1]};b.getPageTexture=function(e){return e<this._mosaicPages.length?this._mosaicPages[e].texture:
null};b.has=function(e){return this._mosaicRects.has(e)};b.getSpriteItem=function(e){return this._mosaicRects.get(e)};b.addSpriteItem=function(e,l,k,r,g,c){if(this._mosaicRects.has(e))return this._mosaicRects.get(e);let m,q,p;d(k)?[m,q,p]=this._allocateImage(l[0],l[1]):(m=new y(0,0,l[0],l[1]),q=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:k,size:[l[0]+2*C.SPRITE_PADDING,l[1]+2*C.SPRITE_PADDING],dirty:!0,texture:void 0}));if(0>=m.width||0>=m.height)return null;c={rect:m,width:l[0],
height:l[1],sdf:g,simplePattern:c,pixelRatio:1,page:q};this._mosaicRects.set(e,c);d(k)&&this._copy({rect:m,spriteSize:l,spriteData:k.data,page:q,pageSize:p,repeat:r,sdf:g});return c};b.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};b.processNextItem=function(){const e=this._spriteCopyQueue.pop();e&&this._copy(e)};b.getSpriteItems=function(e){const l={};for(const k of e)l[k]=this.getSpriteItem(k);return l};b.getMosaicItemPosition=function(e){const l=(e=this.getSpriteItem(e))&&
e.rect;if(!l)return null;l.width=e.width;l.height=e.height;const k=C.SPRITE_PADDING,r=this._mosaicPages[e.page];return{size:[e.width,e.height],tl:[(l.x+k)/r[0],(l.y+k)/r[1]],br:[(l.x+k+e.width)/r[0],(l.y+k+e.height)/r[1]],page:e.page}};b.bind=function(e,l,k=0,r=0){k=this._mosaicPages[k];const g=k.mosaicsData;var c=k.texture;c||(c=k.size,c=d(g)?new f.Texture(e,{pixelFormat:n.PixelFormat.RGBA,dataType:n.PixelType.UNSIGNED_BYTE,width:c[0],height:c[1]},new Uint8Array(g.data.buffer)):new f.Texture(e,{pixelFormat:n.PixelFormat.RGBA,
dataType:n.PixelType.UNSIGNED_BYTE,samplingMode:n.TextureSamplingMode.LINEAR,wrapMode:n.TextureWrapMode.CLAMP_TO_EDGE,width:c[0],height:c[1]},null),k.texture=c);c.setSamplingMode(l);d(g)?(e.bindTexture(c,r),k.dirty&&(c.setData(new Uint8Array(g.data.buffer)),c.generateMipmap())):g.data.bindFrame(e,c,r);k.dirty=!1};a._copyBits=function(e,l,k,r,g,c,m,q,p,u,h){let t=r*l+k;m=q*c+m;if(h)for(m-=c,h=-1;h<=u;h++,t=((h+u)%u+r)*l+k,m+=c)for(q=-1;q<=p;q++)g[m+q]=e[t+(q+p)%p];else for(k=0;k<u;k++){for(r=0;r<p;r++)g[m+
r]=e[t+r];t+=l;m+=c}};b._copy=function(e){if(!(e.page>=this._mosaicPages.length)){var l=this._mosaicPages[e.page],k=l.mosaicsData;if(!d(l.mosaicsData))throw new D("mapview-invalid-resource","unsuitable data type!");var r=e.spriteData;(k=k.data)&&r||console.error("Source or target images are uninitialized!");a._copyBits(r,e.spriteSize[0],0,0,k,e.pageSize[0],e.rect.x+C.SPRITE_PADDING,e.rect.y+C.SPRITE_PADDING,e.spriteSize[0],e.spriteSize[1],e.repeat);l.dirty=!0}};b._allocateImage=function(e,l){e+=2*
C.SPRITE_PADDING;l+=2*C.SPRITE_PADDING;var k=Math.max(e,l);if(this._maxItemSize&&this._maxItemSize<k){k=2**Math.ceil(B.log2(e));const r=2**Math.ceil(B.log2(l));e=new y(0,0,e,l);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(k*r)},size:[k,r],dirty:!0,texture:void 0});return[e,this._mosaicPages.length-1,[k,r]]}k=this._binPack.allocate(e,l);return 0>=k.width?(k=this._mosaicPages[this._currentPage],!k.dirty&&d(k.mosaicsData)&&(k.mosaicsData.data=null),this._currentPage=this._mosaicPages.length,
this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new x(this._pageWidth,this._pageHeight),this._allocateImage(e,l)):[k,this._currentPage,[this._pageWidth,this._pageHeight]]};b.dispose=function(){this._binPack=null;for(const l of this._mosaicPages){var e=l.texture;e&&e.dispose();e=l.mosaicsData;d(e)||e.data.destroy()}this._mosaicPages=null;this._mosaicRects.clear()};
z._createClass(a,[{key:"itemCount",get:function(){return this._mosaicRects.size}}]);return a}()})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/_commonjsHelpers ../../../../../core/Error ../../../../../core/promiseUtils ../../../../../core/time ./BaseAnimatableTextureResource".split(" "),function(z,D,C,B,y,x,n){function f(k,r,g){return d.apply(this,arguments)}function d(){d=D._asyncToGenerator(function*(k,
r,g){k=e(k);if(k instanceof Error)throw k;yield k.createImages();y.throwIfAborted(g);const {frames:c,width:m,height:q}=k;g=document.createElement("canvas");g.width=m;g.height=q;g=g.getContext("2d");const p=[];k=[];for(const h of c){k.push(x.Milliseconds(h.delay));var u=h.imageElement;g.globalCompositeOperation=0===h.blendOp?"copy":"source-over";const t=2===h.disposeOp&&g.getImageData(h.left,h.top,h.width,h.height);g.drawImage(u,h.left,h.top);u=g.getImageData(0,0,m,q);p.push(u);0!==h.disposeOp&&(1===
h.disposeOp?g.clearRect(h.left,h.top,h.width,h.height):2===h.disposeOp&&g.putImageData(t,h.left,h.top))}return{frameDurations:k,selectFrame:h=>{r(p[h])},width:m,height:q}});return d.apply(this,arguments)}function a(k){const r=new Uint8Array(k);return!l.some((g,c)=>g!==r[c])}var b={exports:{}};(function(k,r){(function(g,c){k.exports=c()})(C.commonjsGlobal,function(){return function(g){function c(q){if(m[q])return m[q].exports;var p=m[q]={exports:{},id:q,loaded:!1};g[q].call(p.exports,p,p.exports,c);
p.loaded=!0;return p.exports}var m={};c.m=g;c.c=m;c.p="";return c(0)}([function(g,c,m){function q(F,H){var J=new DataView(F.buffer),I=8,N=void 0,M=void 0,K=void 0;do M=J.getUint32(I),N=I+4,N=Array.prototype.slice.call(F.subarray(N,N+4)),N=String.fromCharCode.apply(String,N),K=H(N,F,I,M),I+=12+M;while(!1!==K&&"IEND"!=N&&I<F.length)}function p(F){for(var H=new Uint8Array(F.length),J=0;J<F.length;J++)H[J]=F.charCodeAt(J);return H}function u(F,H,J){var I=new Uint8Array(J);I.set(F.subarray(H,H+J));return I}
Object.defineProperty(c,"__esModule",{value:!0});c.isNotPNG=function(F){return F===v};c.isNotAPNG=function(F){return F===w};c.default=function(F){var H=new Uint8Array(F);if(Array.prototype.some.call(A,function(V,L){return V!==H[L]}))return v;var J=!1;q(H,function(V){return!(J="acTL"===V)});if(!J)return w;var I=[],N=[],M=null,K=null,O=0,X=new t.APNG;q(H,function(V,L,P,Y){var U=new DataView(L.buffer);switch(V){case "IHDR":M=L.subarray(P+8,P+8+Y);X.width=U.getUint32(P+8);X.height=U.getUint32(P+12);break;
case "acTL":X.numPlays=U.getUint32(P+8+4);break;case "fcTL":K&&(X.frames.push(K),O++);K=new t.Frame;K.width=U.getUint32(P+8+4);K.height=U.getUint32(P+8+8);K.left=U.getUint32(P+8+12);K.top=U.getUint32(P+8+16);V=U.getUint16(P+8+20);L=U.getUint16(P+8+22);0===L&&(L=100);K.delay=1E3*V/L;10>=K.delay&&(K.delay=100);X.playTime+=K.delay;K.disposeOp=U.getUint8(P+8+24);K.blendOp=U.getUint8(P+8+25);K.dataParts=[];0===O&&2===K.disposeOp&&(K.disposeOp=1);break;case "fdAT":K&&K.dataParts.push(L.subarray(P+8+4,P+
8+Y));break;case "IDAT":K&&K.dataParts.push(L.subarray(P+8,P+8+Y));break;case "IEND":N.push(u(L,P,12+Y));break;default:I.push(u(L,P,12+Y))}});K&&X.frames.push(K);if(0==X.frames.length)return w;var aa=new Blob(I),ba=new Blob(N);X.frames.forEach(function(V){var L=[];L.push(A);M.set(G(V.width),0);M.set(G(V.height),4);L.push(E("IHDR",M));L.push(aa);V.dataParts.forEach(function(P){return L.push(E("IDAT",P))});L.push(ba);V.imageData=new Blob(L,{type:"image/png"});delete V.dataParts;L=null});return X};var h=
(g=m(1))&&g.__esModule?g:{default:g},t=m(2),v=Error("Not a PNG"),w=Error("Not an animated PNG"),A=new Uint8Array([137,80,78,71,13,10,26,10]),E=function(F,H){var J=F.length+H.length,I=new Uint8Array(J+8),N=new DataView(I.buffer);N.setUint32(0,H.length);I.set(p(F),4);I.set(H,8);F=(0,h.default)(I,4,J);N.setUint32(J+4,F);return I},G=function(F){return new Uint8Array([F>>>24&255,F>>>16&255,F>>>8&255,F&255])}},function(g,c){Object.defineProperty(c,"__esModule",{value:!0});c.default=function(p){var u=1<
arguments.length&&void 0!==arguments[1]?arguments[1]:0,h=-1,t=u;for(u+=2<arguments.length&&void 0!==arguments[2]?arguments[2]:p.length-u;t<u;t++)h=h>>>8^m[(h^p[t])&255];return h^-1};var m=new Uint32Array(256);for(g=0;256>g;g++){c=g;for(var q=0;8>q;q++)c=0!==(c&1)?3988292384^c>>>1:c>>>1;m[g]=c}},function(g,c,m){function q(h,t){if(!(h instanceof t))throw new TypeError("Cannot call a class as a function");}Object.defineProperty(c,"__esModule",{value:!0});c.Frame=c.APNG=void 0;var p=function(){function h(t,
v){for(var w=0;w<v.length;w++){var A=v[w];A.enumerable=A.enumerable||!1;A.configurable=!0;"value"in A&&(A.writable=!0);Object.defineProperty(t,A.key,A)}}return function(t,v,w){v&&h(t.prototype,v);w&&h(t,w);return t}}(),u=(g=m(3))&&g.__esModule?g:{default:g};c.APNG=function(){function h(){q(this,h);this.playTime=this.numPlays=this.height=this.width=0;this.frames=[]}p(h,[{key:"createImages",value:function(){return Promise.all(this.frames.map(function(t){return t.createImage()}))}},{key:"getPlayer",
value:function(t){var v=this,w=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;return this.createImages().then(function(){return new u.default(v,t,w)})}}]);return h}();c.Frame=function(){function h(){q(this,h);this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageElement=this.imageData=null}p(h,[{key:"createImage",value:function(){var t=this;return this.imageElement?Promise.resolve():new Promise(function(v,w){var A=URL.createObjectURL(t.imageData);
t.imageElement=document.createElement("img");t.imageElement.onload=function(){URL.revokeObjectURL(A);v()};t.imageElement.onerror=function(){URL.revokeObjectURL(A);t.imageElement=null;w(Error("Image creation error"))};t.imageElement.src=A})}}]);return h}()},function(g,c,m){function q(u,h){if("function"!==typeof h&&null!==h)throw new TypeError("Super expression must either be null or a function, not "+typeof h);u.prototype=Object.create(h&&h.prototype,{constructor:{value:u,enumerable:!1,writable:!0,
configurable:!0}});h&&(Object.setPrototypeOf?Object.setPrototypeOf(u,h):u.__proto__=h)}Object.defineProperty(c,"__esModule",{value:!0});var p=function(){function u(h,t){for(var v=0;v<t.length;v++){var w=t[v];w.enumerable=w.enumerable||!1;w.configurable=!0;"value"in w&&(w.writable=!0);Object.defineProperty(h,w.key,w)}}return function(h,t,v){t&&u(h.prototype,t);v&&u(h,v);return h}}();g=m(4);g=function(u){function h(t,v,w){if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");
var A=(h.__proto__||Object.getPrototypeOf(h)).call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");A=!A||"object"!==typeof A&&"function"!==typeof A?this:A;A.playbackRate=1;A._currentFrameNumber=0;A._ended=!1;A._paused=!0;A._numPlays=0;A._apng=t;A.context=v;A.stop();w&&A.play();return A}q(h,u);p(h,[{key:"renderNextFrame",value:function(){this._currentFrameNumber=(this._currentFrameNumber+1)%this._apng.frames.length;this._currentFrameNumber===this._apng.frames.length-
1&&(this._numPlays++,0!==this._apng.numPlays&&this._numPlays>=this._apng.numPlays&&(this._paused=this._ended=!0));this._prevFrame&&1==this._prevFrame.disposeOp?this.context.clearRect(this._prevFrame.left,this._prevFrame.top,this._prevFrame.width,this._prevFrame.height):this._prevFrame&&2==this._prevFrame.disposeOp&&this.context.putImageData(this._prevFrameData,this._prevFrame.left,this._prevFrame.top);var t=this.currentFrame;this._prevFrame=t;this._prevFrameData=null;2==t.disposeOp&&(this._prevFrameData=
this.context.getImageData(t.left,t.top,t.width,t.height));0==t.blendOp&&this.context.clearRect(t.left,t.top,t.width,t.height);this.context.drawImage(t.imageElement,t.left,t.top);this.emit("frame",this._currentFrameNumber);this._ended&&this.emit("end")}},{key:"play",value:function(){var t=this;this.emit("play");this._ended&&this.stop();this._paused=!1;var v=performance.now()+this.currentFrame.delay/this.playbackRate;requestAnimationFrame(function E(A){if(!t._ended&&!t._paused){if(A>=v){for(;A-v>=t._apng.playTime/
t.playbackRate;)v+=t._apng.playTime/t.playbackRate,t._numPlays++;do t.renderNextFrame(),v+=t.currentFrame.delay/t.playbackRate;while(!t._ended&&A>v)}requestAnimationFrame(E)}})}},{key:"pause",value:function(){this._paused||(this.emit("pause"),this._paused=!0)}},{key:"stop",value:function(){this.emit("stop");this._numPlays=0;this._ended=!1;this._paused=!0;this._currentFrameNumber=-1;this.context.clearRect(0,0,this._apng.width,this._apng.height);this.renderNextFrame()}},{key:"currentFrameNumber",get:function(){return this._currentFrameNumber}},
{key:"currentFrame",get:function(){return this._apng.frames[this._currentFrameNumber]}},{key:"paused",get:function(){return this._paused}},{key:"ended",get:function(){return this._ended}}]);return h}((g&&g.__esModule?g:{default:g}).default);c.default=g},function(g,c){function m(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}function q(u){return"function"===typeof u}function p(u){return"object"===typeof u&&null!==u}g.exports=m;m.EventEmitter=m;m.prototype._events=void 0;
m.prototype._maxListeners=void 0;m.defaultMaxListeners=10;m.prototype.setMaxListeners=function(u){if("number"!==typeof u||0>u||isNaN(u))throw TypeError("n must be a positive number");this._maxListeners=u;return this};m.prototype.emit=function(u){var h;this._events||(this._events={});if("error"===u&&(!this._events.error||p(this._events.error)&&!this._events.error.length)){var t=arguments[1];if(t instanceof Error)throw t;var v=Error('Uncaught, unspecified "error" event. ('+t+")");v.context=t;throw v;
}v=this._events[u];if(void 0===v)return!1;if(q(v))switch(arguments.length){case 1:v.call(this);break;case 2:v.call(this,arguments[1]);break;case 3:v.call(this,arguments[1],arguments[2]);break;default:t=Array.prototype.slice.call(arguments,1),v.apply(this,t)}else if(p(v)){t=Array.prototype.slice.call(arguments,1);var w=v.slice();v=w.length;for(h=0;h<v;h++)w[h].apply(this,t)}return!0};m.prototype.addListener=function(u,h){if(!q(h))throw TypeError("listener must be a function");this._events||(this._events=
{});this._events.newListener&&this.emit("newListener",u,q(h.listener)?h.listener:h);this._events[u]?p(this._events[u])?this._events[u].push(h):this._events[u]=[this._events[u],h]:this._events[u]=h;p(this._events[u])&&!this._events[u].warned&&(h=void 0!==this._maxListeners?this._maxListeners:m.defaultMaxListeners)&&0<h&&this._events[u].length>h&&(this._events[u].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",
this._events[u].length),"function"===typeof console.trace&&console.trace());return this};m.prototype.on=m.prototype.addListener;m.prototype.once=function(u,h){function t(){this.removeListener(u,t);v||(v=!0,h.apply(this,arguments))}if(!q(h))throw TypeError("listener must be a function");var v=!1;t.listener=h;this.on(u,t);return this};m.prototype.removeListener=function(u,h){if(!q(h))throw TypeError("listener must be a function");if(!this._events||!this._events[u])return this;var t=this._events[u];
var v=t.length;var w=-1;if(t===h||q(t.listener)&&t.listener===h)delete this._events[u],this._events.removeListener&&this.emit("removeListener",u,h);else if(p(t)){for(;0<v--;)if(t[v]===h||t[v].listener&&t[v].listener===h){w=v;break}if(0>w)return this;1===t.length?(t.length=0,delete this._events[u]):t.splice(w,1);this._events.removeListener&&this.emit("removeListener",u,h)}return this};m.prototype.removeAllListeners=function(u){if(!this._events)return this;if(!this._events.removeListener)return 0===
arguments.length?this._events={}:this._events[u]&&delete this._events[u],this;if(0===arguments.length){for(h in this._events)"removeListener"!==h&&this.removeAllListeners(h);this.removeAllListeners("removeListener");this._events={};return this}var h=this._events[u];if(q(h))this.removeListener(u,h);else if(h)for(;h.length;)this.removeListener(u,h[h.length-1]);delete this._events[u];return this};m.prototype.listeners=function(u){return this._events&&this._events[u]?q(this._events[u])?[this._events[u]]:
this._events[u].slice():[]};m.prototype.listenerCount=function(u){if(this._events){u=this._events[u];if(q(u))return 1;if(u)return u.length}return 0};m.listenerCount=function(u,h){return u.listenerCount(h)}}])})})(b);const e=C.getDefaultExportFromCjs(b.exports);n=function(k){function r(){return k.apply(this,arguments)||this}D._inheritsLoose(r,k);r.create=function(){var g=D._asyncToGenerator(function*(c,m,q,p,u){p=new r(p);try{yield p._load(c,m,q,u)}catch(h){if(!y.isAbortError(h))return new B("invalid-resource",
`Could not load PNG: ${h.message}`)}return p});return function(c,m,q,p,u){return g.apply(this,arguments)}}();r.prototype._loadAnimation=function(){var g=D._asyncToGenerator(function*(c,m,q){return f(c,m,q)});return function(c,m,q){return g.apply(this,arguments)}}();return r}(n.BaseAnimatableTextureResource);const l=[137,80,78,71,13,10,26,10];z.APNG=n;z.isAnimatedPNG=function(k){if(!a(k))return!1;const r=new DataView(k);k=new Uint8Array(k);let g=8,c;do{const m=r.getUint32(g);c=String.fromCharCode.apply(String,
Array.prototype.slice.call(k.subarray(g+4,g+8)));if("acTL"===c)return!0;g+=12+m}while("IEND"!==c&&g<k.length);return!1};z.isPNG=a;z.parseApng=f;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/animatedFormats/BaseAnimatableTextureResource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/maybe ../../../../../core/promiseUtils ../definitions ./utils".split(" "),
function(z,D,C,B,y,x,n){let f=function(){function d(b){this._requestRender=b;this._frameData=null}var a=d.prototype;a.destroy=function(){this._playHandle.remove()};a.bindFrame=function(b,e,l){b.bindTexture(e,l);B.isNone(this._frameData)||(e.updateData(0,x.SPRITE_PADDING,x.SPRITE_PADDING,this._frameData.width,this._frameData.height,this._frameData),this._frameData=null)};a._load=function(){var b=D._asyncToGenerator(function*(e,l,k,r){try{const g=yield this._loadAnimation(e,c=>{this._frameData=c;this._requestRender.requestRender()},
r);this.frameCount=g.frameDurations.length;this.width=g.width;this.height=g.height;this._playHandle=n.play(g,l,k)}catch(g){if(!y.isAbortError(g))return new C("invalid-resource","Could not parse animated resource.")}});return function(e,l,k,r){return b.apply(this,arguments)}}();return d}();z.BaseAnimatableTextureResource=f;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/animatedFormats/utils":function(){define(["exports","../../../../../core/time",
"../../../../../symbols/cim/enums","../grouping"],function(z,D,C,B){function y(e){return D.Milliseconds(e.frameDurations.reduce((l,k)=>l+k,0))}function x(e){const {width:l,height:k}=e;return{frameDurations:e.frameDurations.reverse(),selectFrame:r=>{e.selectFrame(e.frameDurations.length-1-r)},width:l,height:k}}function n(e,l){const {width:k,height:r,selectFrame:g}=e,c=y(e),m=l/c;return{frameDurations:e.frameDurations.map(q=>D.Milliseconds(q*m)),selectFrame:g,width:k,height:r}}function f(e,l){const {width:k,
height:r,selectFrame:g}=e;e=e.frameDurations.slice();const c=e.shift();e.unshift(D.Milliseconds(c+l));return{frameDurations:e,selectFrame:g,width:k,height:r}}function d(e,l){const {width:k,height:r,selectFrame:g}=e;e=e.frameDurations.slice();const c=e.pop();e.push(D.Milliseconds(c+l));return{frameDurations:e,selectFrame:g,width:k,height:r}}function a(e,l,k){let {repeatType:r}=l;null==r&&(r=C.AnimatedSymbolRepeatType.Loop);!0===l.reverseAnimation&&(e=x(e));null!=l.duration&&(e=n(e,D.Milliseconds(1E3*
l.duration)));if(null!=l.repeatDelay){const g=1E3*l.repeatDelay;r===C.AnimatedSymbolRepeatType.Loop?e=d(e,D.Milliseconds(g)):r===C.AnimatedSymbolRepeatType.Oscillate&&(e=f(d(e,D.Milliseconds(g/2)),D.Milliseconds(g/2)))}null!=l.startTimeOffset?l=D.Milliseconds(1E3*l.startTimeOffset):null!=l.randomizeStartTime?(k=B.getMaterialGroup(k),l=B.getRandomValue(k,null!=l.randomizeStartSeed?l.randomizeStartSeed:82749913),l=D.Milliseconds(l*y(e))):l=D.Milliseconds(0);return new b(e,l,r)}let b=function(){function e(l,
k,r){this._animation=l;this._repeatType=r;this._direction=1;this._currentFrame=0;this.timeToFrame=this._animation.frameDurations[this._currentFrame];for(l=0;k>l;)l+=this.timeToFrame,this.nextFrame();this._animation.selectFrame(this._currentFrame)}e.prototype.nextFrame=function(){this._currentFrame+=this._direction;if(0<this._direction){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case C.AnimatedSymbolRepeatType.None:this._currentFrame-=this._direction;break;
case C.AnimatedSymbolRepeatType.Loop:this._currentFrame=0;break;case C.AnimatedSymbolRepeatType.Oscillate:this._currentFrame-=this._direction,this._direction=-1}}else if(-1===this._currentFrame)switch(this._repeatType){case C.AnimatedSymbolRepeatType.None:this._currentFrame-=this._direction;break;case C.AnimatedSymbolRepeatType.Loop:this._currentFrame=this._animation.frameDurations.length-1;break;case C.AnimatedSymbolRepeatType.Oscillate:this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=
this._animation.frameDurations[this._currentFrame];this._animation.selectFrame(this._currentFrame)};return e}();z.Player=b;z.adjustDuration=n;z.appendDelay=d;z.createPlayer=a;z.getDuration=y;z.play=function(e,l,k){function r(){q=g&&setTimeout(()=>{c.nextFrame();m=c.timeToFrame;r()},m)}const g=null!=l.playAnimation?l.playAnimation:!0,c=a(e,l,k);let m=c.timeToFrame,q;r();return{remove:()=>{g&&clearTimeout(q)}}};z.prependDelay=f;z.reverse=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/grouping":function(){define(["exports","../../../../core/string"],function(z,D){function C(B,y){if("string"===typeof B)B=D.numericHash(B+`-seed(${y})`);else{let x=12;B^=y;do B=107*(B>>8^B)+x|0;while(0!==--x)}return(1+B/-2147483648)/2}z.getMaterialGroup=function(B){return Math.floor(10*C(B,53290320))};z.getRandomValue=C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/promiseUtils ../../../../../core/time ../../../../../geometry/support/meshUtils/exporters/gltf/imageutils ./BaseAnimatableTextureResource".split(" "),
function(z,D,C,B,y,x,n){function f(v,w,A){return d.apply(this,arguments)}function d(){d=D._asyncToGenerator(function*(v,w,A){v=u(v);var E=q(v,!0);const {width:G,height:F}=v.lsd;v=document.createElement("canvas");v.width=G;v.height=F;v=v.getContext("2d");const H=[];A=[];for(const I of E){A.push(y.Milliseconds(I.delay));E=new ImageData(I.patch,I.dims.width,I.dims.height);var J=x.imageTypeToCanvas(E);E=3===I.disposalType&&v.getImageData(I.dims.left,I.dims.top,I.dims.width,I.dims.height);v.drawImage(J,
I.dims.left,I.dims.top);J=v.getImageData(0,0,G,F);H.push(J);1!==I.disposalType&&(2===I.disposalType?v.clearRect(I.dims.left,I.dims.top,I.dims.width,I.dims.height):3===I.disposalType&&v.putImageData(E,I.dims.left,I.dims.top))}return{frameDurations:A,selectFrame:I=>{w(H[I])},width:G,height:F}});return d.apply(this,arguments)}function a(v){const w=new Uint8Array(v);return!t.some((A,E)=>A!==w[E])}var b={},e={},l={};Object.defineProperty(l,"__esModule",{value:!0});l.loop=l.conditional=l.parse=void 0;l.parse=
function E(w,A){var G=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},F=3<arguments.length&&void 0!==arguments[3]?arguments[3]:G;if(Array.isArray(A))A.forEach(function(J){return E(w,J,G,F)});else if("function"===typeof A)A(w,G,F,E);else{var H=Object.keys(A)[0];Array.isArray(A[H])?(F[H]={},E(w,A[H],G,F[H])):F[H]=A[H](w,G,F,E)}return G};l.conditional=function(w,A){return function(E,G,F,H){A(E,G,F)&&H(E,w,G,F)}};l.loop=function(w,A){return function(E,G,F,H){for(var J=[],I=E.pos;A(E,G,F);){var N=
{};H(E,w,G,N);if(E.pos===I)break;I=E.pos;J.push(N)}return J}};var k={};Object.defineProperty(k,"__esModule",{value:!0});k.readBits=k.readArray=k.readUnsigned=k.readString=k.peekBytes=k.readBytes=k.peekByte=k.readByte=k.buildStream=void 0;k.buildStream=function(w){return{data:w,pos:0}};var r=function(){return function(w){return w.data[w.pos++]}};k.readByte=r;k.peekByte=function(){var w=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return function(A){return A.data[A.pos+w]}};var g=function(w){return function(A){return A.data.subarray(A.pos,
A.pos+=w)}};k.readBytes=g;k.peekBytes=function(w){return function(A){return A.data.subarray(A.pos,A.pos+w)}};k.readString=function(w){return function(A){return Array.from(g(w)(A)).map(function(E){return String.fromCharCode(E)}).join("")}};k.readUnsigned=function(w){return function(A){A=g(2)(A);return w?(A[1]<<8)+A[0]:(A[0]<<8)+A[1]}};k.readArray=function(w,A){return function(E,G,F){G="function"===typeof A?A(E,G,F):A;F=g(w);for(var H=Array(G),J=0;J<G;J++)H[J]=F(E);return H}};k.readBits=function(w){return function(A){A=
r()(A);for(var E=Array(8),G=0;8>G;G++)E[7-G]=!!(A&1<<G);return Object.keys(w).reduce(function(F,H){var J=w[H];if(J.length){for(var I=J.length,N=0,M=0;M<I;M++)N+=E[J.index+M]&&Math.pow(2,I-M-1);F[H]=N}else F[H]=E[J.index];return F},{})}};(function(w){Object.defineProperty(w,"__esModule",{value:!0});w["default"]=void 0;var A={blocks:function(J){for(var I=[],N=J.data.length,M=0,K=(0,k.readByte)()(J);0!==K&&K;K=(0,k.readByte)()(J)){if(J.pos+K>=N){N-=J.pos;I.push((0,k.readBytes)(N)(J));M+=N;break}I.push((0,
k.readBytes)(K)(J));M+=K}J=new Uint8Array(M);for(N=M=0;N<I.length;N++)J.set(I[N],M),M+=I[N].length;return J}},E=(0,l.conditional)({gce:[{codes:(0,k.readBytes)(2)},{byteSize:(0,k.readByte)()},{extras:(0,k.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,k.readUnsigned)(!0)},{transparentColorIndex:(0,k.readByte)()},{terminator:(0,k.readByte)()}]},function(J){J=(0,k.peekBytes)(2)(J);return 33===J[0]&&249===J[1]}),G=(0,l.conditional)({image:[{code:(0,
k.readByte)()},{descriptor:[{left:(0,k.readUnsigned)(!0)},{top:(0,k.readUnsigned)(!0)},{width:(0,k.readUnsigned)(!0)},{height:(0,k.readUnsigned)(!0)},{lct:(0,k.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,l.conditional)({lct:(0,k.readArray)(3,function(J,I,N){return Math.pow(2,N.descriptor.lct.size+1)})},function(J,I,N){return N.descriptor.lct.exists}),{data:[{minCodeSize:(0,k.readByte)()},A]}]},function(J){return 44===(0,
k.peekByte)()(J)}),F=(0,l.conditional)({text:[{codes:(0,k.readBytes)(2)},{blockSize:(0,k.readByte)()},{preData:function(J,I,N){return(0,k.readBytes)(N.text.blockSize)(J)}},A]},function(J){J=(0,k.peekBytes)(2)(J);return 33===J[0]&&1===J[1]}),H=(0,l.conditional)({application:[{codes:(0,k.readBytes)(2)},{blockSize:(0,k.readByte)()},{id:function(J,I,N){return(0,k.readString)(N.blockSize)(J)}},A]},function(J){J=(0,k.peekBytes)(2)(J);return 33===J[0]&&255===J[1]});A=(0,l.conditional)({comment:[{codes:(0,
k.readBytes)(2)},A]},function(J){J=(0,k.peekBytes)(2)(J);return 33===J[0]&&254===J[1]});E=[{header:[{signature:(0,k.readString)(3)},{version:(0,k.readString)(3)}]},{lsd:[{width:(0,k.readUnsigned)(!0)},{height:(0,k.readUnsigned)(!0)},{gct:(0,k.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,k.readByte)()},{pixelAspectRatio:(0,k.readByte)()}]},(0,l.conditional)({gct:(0,k.readArray)(3,function(J,I){return Math.pow(2,I.lsd.gct.size+
1)})},function(J,I){return I.lsd.gct.exists}),{frames:(0,l.loop)([E,H,A,G,F],function(J){J=(0,k.peekByte)()(J);return 33===J||44===J})}];w["default"]=E})(e);var c={};Object.defineProperty(c,"__esModule",{value:!0});c.deinterlace=void 0;c.deinterlace=function(w,A){for(var E=Array(w.length),G=w.length/A,F=[0,4,2,1],H=[8,8,4,2],J=0,I=0;4>I;I++)for(var N=F[I];N<G;N+=H[I]){var M=N,K=w.slice(J*A,(J+1)*A);E.splice.apply(E,[M*A,A].concat(K));J++}return E};var m={};Object.defineProperty(m,"__esModule",{value:!0});
m.lzw=void 0;m.lzw=function(w,A,E){var G,F,H,J,I,N,M,K,O=Array(E),X=Array(4096),aa=Array(4096),ba=Array(4097);var V=1<<w;var L=V+1;var P=V+2;var Y=-1;var U=w+1;var Q=(1<<U)-1;for(F=0;F<V;F++)X[F]=0,aa[F]=F;for(H=J=G=I=N=K=M=0;H<E;){if(0===N){if(G<U){J+=A[M]<<G;G+=8;M++;continue}F=J&Q;J>>=U;G-=U;if(F>P||F==L)break;if(F==V){U=w+1;Q=(1<<U)-1;P=V+2;Y=-1;continue}if(-1==Y){ba[N++]=aa[F];I=Y=F;continue}var W=F;F==P&&(ba[N++]=I,F=Y);for(;F>V;)ba[N++]=aa[F],F=X[F];I=aa[F]&255;ba[N++]=I;4096>P&&(X[P]=Y,aa[P]=
I,P++,0===(P&Q)&&4096>P&&(U++,Q+=P));Y=W}N--;O[K++]=ba[N];H++}for(H=K;H<E;H++)O[H]=0;return O};Object.defineProperty(b,"__esModule",{value:!0});var q=b.decompressFrames=b.decompressFrame=u=b.parseGIF=void 0,p=e&&e.__esModule?e:{default:e},u=b.parseGIF=function(w){w=new Uint8Array(w);return(0,l.parse)((0,k.buildStream)(w),p["default"])},h=function(w,A,E){if(w.image){var G=w.image,F=G.descriptor.width*G.descriptor.height;F=(0,m.lzw)(G.data.minCodeSize,G.data.blocks,F);G.descriptor.lct.interlaced&&(F=
(0,c.deinterlace)(F,G.descriptor.width));F={pixels:F,dims:{top:w.image.descriptor.top,left:w.image.descriptor.left,width:w.image.descriptor.width,height:w.image.descriptor.height}};F.colorTable=G.descriptor.lct&&G.descriptor.lct.exists?G.lct:A;w.gce&&(F.delay=10*(w.gce.delay||10),F.disposalType=w.gce.extras.disposal,w.gce.extras.transparentColorGiven&&(F.transparentIndex=w.gce.transparentColorIndex));if(E){w=F.pixels.length;A=new Uint8ClampedArray(4*w);for(E=0;E<w;E++){G=4*E;var H=F.pixels[E],J=F.colorTable[H]||
[0,0,0];A[G]=J[0];A[G+1]=J[1];A[G+2]=J[2];A[G+3]=H!==F.transparentIndex?255:0}F.patch=A}return F}console.warn("gif frame does not have associated image.")};b.decompressFrame=h;q=b.decompressFrames=function(w,A){return w.frames.filter(function(E){return E.image}).map(function(E){return h(E,w.gct,A)})};n=function(w){function A(){return w.apply(this,arguments)||this}D._inheritsLoose(A,w);A.create=function(){var E=D._asyncToGenerator(function*(G,F,H,J,I){J=new A(J);try{yield J._load(G,F,H,I)}catch(N){if(!B.isAbortError(N))return new C("invalid-resource",
`Could not load GIF: ${N.message}`)}return J});return function(G,F,H,J,I){return E.apply(this,arguments)}}();A.prototype._loadAnimation=function(){var E=D._asyncToGenerator(function*(G,F,H){return f(G,F,H)});return function(G,F,H){return E.apply(this,arguments)}}();return A}(n.BaseAnimatableTextureResource);const t=[71,73,70];z.GIF=n;z.isAnimatedGIF=function(w){function A(){H++;F+=8;const I=G.getUint8(F++);F+=I&128?3*2**((I&7)+1):0;F++;E()}function E(){let I;for(;I=G.getUint8(F++);)F+=I}if(!a(w))return!1;
const G=new DataView(w);w=G.getUint8(10);let F=13+(w&128?3*2**((w&7)+1):0),H=0;for(w=!1;!w;){switch(G.getUint8(F++)){case 33:a:{switch(G.getUint8(F++)){case 249:F++;F+=4;E();break;case 1:H++;F++;F+=12;E();break;case 254:E();break;case 255:F++;F+=8;F+=3;E();break;default:var J=!1;break a}J=!0}if(!J)return!1;break;case 44:A();break;case 59:w=!0;break;default:return!1}if(1<H)return!0}return!1};z.isGIF=a;z.parseGif=f;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/geometry/support/meshUtils/exporters/gltf/imageutils":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/Error ../../../../../core/maybe ../../../../../core/urlUtils".split(" "),function(z,D,C,B,y,x){function n(){n=D._asyncToGenerator(function*(b){const e=a(b);if(y.isNone(e))throw new B("imageToArrayBuffer","Unsupported image type");const l=yield f(b);b=yield new Promise(k=>e.toBlob(k,l));if(!b)throw new B("imageToArrayBuffer",
"Failed to encode image");return{data:yield b.arrayBuffer(),type:l}});return n.apply(this,arguments)}function f(b){return d.apply(this,arguments)}function d(){d=D._asyncToGenerator(function*(b){if(!(b instanceof HTMLImageElement))return"image/png";b=b.src;return x.isDataProtocol(b)?({mediaType:b}=x.dataComponents(b),"image/jpeg"===b?b:"image/png"):/\.png$/i.test(b)?"image/png":/\.(jpg|jpeg)$/i.test(b)?"image/jpeg":"image/png"});return d.apply(this,arguments)}function a(b){if(b instanceof HTMLCanvasElement)return b;
if(b instanceof HTMLVideoElement)return null;const e=document.createElement("canvas");e.width=b.width;e.height=b.height;const l=e.getContext("2d");b instanceof HTMLImageElement?l.drawImage(b,0,0,b.width,b.height):b instanceof ImageData&&l.putImageData(b,0,0);return e}z.encodeBase64DataUri=function(b){const e=[];b=new Uint8Array(b);for(let l=0;l<b.length;l++)e.push(String.fromCharCode(b[l]));return"data:application/octet-stream;base64,"+btoa(e.join(""))};z.imageToArrayBuffer=function(b){return n.apply(this,
arguments)};z.imageToDataURI=function(b){b=a(b);return y.isSome(b)?b.toDataURL():""};z.imageTypeToCanvas=a;z.isArrayBufferPNG=function(b){if(8>b.byteLength)return!1;b=new Uint8Array(b);return 137===b[0]&&80===b[1]&&78===b[2]&&71===b[3]&&13===b[4]&&10===b[5]&&26===b[6]&&10===b[7]};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports","../../../../../core/Error"],function(z,D){z.ok=function(C,
B){return C&&"name"in C?(B&&B.error(new D(C.name,C.message,C.details)),!1):!0};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["exports"],function(z){z.keyFromSymbol=function(D){switch(D.type){case "esriSMS":return`${D.style}.${D.path}`;case "esriSLS":return`${D.style}.${D.cap}`;case "esriSFS":return`${D.style}`;case "esriPFS":case "esriPMS":return D.imageData?`${D.imageData}${D.width}${D.height}`:
`${D.url}${D.width}${D.height}`;default:return"mosaicHash"in D?D.mosaicHash:JSON.stringify(D)}};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/WorldExtentClipRenderer":function(){define("exports ../../../../core/maybe ../../../../chunks/common ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ./VertexStream ./shaders/StencilPrograms ../../../webgl/enums ../../../webgl/ProgramTemplate".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e){const l=x.fromValues(-.5,-.5);x=function(){function k(){this._centerNdc=f.create();this._pxToNdc=f.create();this._worldDimensionsPx=f.create();this._mat3=y.create();this._initialized=!1}var r=k.prototype;r.dispose=function(){this._program=D.disposeMaybe(this._program);this._quad=D.disposeMaybe(this._quad)};r.render=function(g,c){const {context:m}=g;if(!this._updateGeometry(g,c))return!1;this._initialized||this._initialize(m);m.setDepthWriteEnabled(!1);m.setDepthTestEnabled(!1);
m.setColorMask(!1,!1,!1,!1);m.setBlendingEnabled(!1);m.setStencilOp(b.StencilOperation.KEEP,b.StencilOperation.KEEP,b.StencilOperation.REPLACE);m.setStencilFunction(b.CompareFunction.ALWAYS,1,255);m.setStencilTestEnabled(!0);m.useProgram(this._program);this._program.setUniformMatrix3fv("u_worldExtent",this._mat3);this._quad.draw();this._quad.unbind();return!0};r._initialize=function(g){if(!this._initialized){var c=e.createProgram(g,a.stencil);c&&(this._program=c,this._quad=new d(g,[0,0,1,0,0,1,1,
1]),this._initialized=!0)}};r._updateGeometry=function(g,c){const {state:m,pixelRatio:q}=g,{size:p,rotation:u}=m,h=Math.round(p[0]*q),t=Math.round(p[1]*q);if(!m.spatialReference.isWrappable)return!1;g=C.toRadian(u);const v=Math.abs(Math.cos(g)),w=Math.abs(Math.sin(g)),A=Math.round(m.worldScreenWidth);if(Math.round(h*v+t*w)<=A)return!1;const E=(c.left-c.right)*q/h;c=(c.bottom-c.top)*q/t;n.set(this._worldDimensionsPx,A*q,h*w+t*v,1);n.set(this._pxToNdc,2/h,-2/t,1);n.set(this._centerNdc,E,c,1);c=this._mat3;
B.fromTranslation(c,this._centerNdc);B.scale(c,c,this._pxToNdc);0!==u&&B.rotate(c,c,g);B.scale(c,c,this._worldDimensionsPx);B.translate(c,c,l);return!0};return k}();z.WorldExtentClipRenderer=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["exports","./sources/resolver"],function(z,D){D={shaders:{vertexShader:D.resolveIncludes("stencil/stencil.vert"),fragmentShader:D.resolveIncludes("stencil/stencil.frag")},
attributes:new Map([["a_pos",0]])};z.stencil=D;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(z,D,C,B,y,x){x=function(n){function f(){var a=n.apply(this,arguments)||this;a.defines=[];a._desc={vsPath:"fx/integrate",fsPath:"fx/integrate",attributes:new Map([["a_position",
0]])};return a}D._inheritsLoose(f,n);var d=f.prototype;d.dispose=function(){this._quad&&this._quad.dispose()};d.bind=function(){};d.unbind=function(){};d.draw=function(a,b){if(b.size){var {context:e,renderingOptions:l}=a;this._quad||(this._quad=new y(e,[0,0,1,0,0,1,1,1]));var k=e.getBoundFramebufferObject(),{x:r,y:g,width:c,height:m}=e.getViewport();b.bindTextures(e);var q=b.getBlock(B.ATTRIBUTE_DATA_ANIMATION);if(!C.isNone(q)){var p=q.getFBO(e);q=q.getFBO(e,1);e.setViewport(0,0,b.size,b.size);this._computeDelta(a,
q,l.labelsAnimationTime);this._updateAnimationState(a,q,p);e.bindFramebuffer(k);e.setViewport(r,g,c,m)}}};d._computeDelta=function(a,b,e){const {context:l,painter:k,displayLevel:r}=a,g=k.materialManager.getProgram(this._desc,["delta"]);l.bindFramebuffer(b);l.setClearColor(0,0,0,0);l.clear(l.gl.COLOR_BUFFER_BIT);l.useProgram(g);g.setUniform1i("u_maskTexture",B.TEXTURE_BINDING_ATTRIBUTE_DATA_0);g.setUniform1i("u_sourceTexture",B.TEXTURE_BINDING_ATTRIBUTE_DATA_1);g.setUniform1f("u_timeDelta",a.deltaTime);
g.setUniform1f("u_animationTime",e);g.setUniform1f("u_zoomLevel",Math.round(10*r));this._quad.draw()};d._updateAnimationState=function(a,b,e){const {context:l,painter:k}=a;a=k.materialManager.getProgram(this._desc,["update"]);l.bindTexture(b.colorTexture,1);l.useProgram(a);a.setUniform1i("u_sourceTexture",1);l.bindFramebuffer(e);l.setClearColor(0,0,0,0);l.clear(l.gl.COLOR_BUFFER_BIT);this._quad.draw()};return f}(x.Effect);z.AnimationEffect=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/effects/Effect":function(){define(["exports"],function(z){let D=function(){function C(){this.name=this.constructor.name}C.prototype.createOptions=function(B,y){return null};return C}();z.Effect=D;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/BlendEffect":function(){define("exports ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../enums ../VertexStream ../shaders/BlendPrograms ../../../../webgl/enums ../../../../webgl/Texture".split(" "),
function(z,D,C,B,y,x,n,f,d){const a=C.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect");C=function(){function b(){this._size=[0,0]}var e=b.prototype;e.dispose=function(l){this._backBufferTexture=B.disposeMaybe(this._backBufferTexture);this._quad=B.disposeMaybe(this._quad)};e.draw=function(l,k,r,g,c){const {context:m,drawPhase:q}=l;this._setupShader(m);g&&"normal"!==g&&q!==y.WGLDrawPhase.LABEL?this._drawBlended(l,k,r,g,c):(l=n.createProgramTemplate("normal"),(l=m.programCache.acquire(l.shaders.vertexShader,
l.shaders.fragmentShader,l.attributes))?(m.useProgram(l),k.setSamplingMode(r),m.bindTexture(k,0),l.setUniform1i("u_layerTexture",0),l.setUniform1f("u_opacity",c),m.setBlendingEnabled(!0),m.setBlendFunction(f.BlendFactor.ONE,f.BlendFactor.ONE_MINUS_SRC_ALPHA),k=this._quad,k.draw(),k.unbind(),l.dispose()):a.error(new D("mapview-BlendEffect",'Error creating shader program for blend mode "normal"')))};e._drawBlended=function(l,k,r,g,c){const {context:m,state:q,pixelRatio:p,inFadeTransition:u}=l;var {size:h}=
q,t=m.getBoundFramebufferObject();let v;B.isSome(t)?(h=t.descriptor,v=h.width,h=h.height):(v=Math.round(p*h[0]),h=Math.round(p*h[1]));this._createOrResizeTexture(l,v,h);l=this._backBufferTexture;t.copyToTexture(0,0,v,h,0,0,l);m.setStencilTestEnabled(!1);m.setStencilWriteMask(0);m.setBlendingEnabled(!0);m.setDepthTestEnabled(!1);m.setDepthWriteEnabled(!1);t=n.createProgramTemplate(g);(t=m.programCache.acquire(t.shaders.vertexShader,t.shaders.fragmentShader,t.attributes))?(m.useProgram(t),l.setSamplingMode(r),
m.bindTexture(l,0),t.setUniform1i("u_backbufferTexture",0),k.setSamplingMode(r),m.bindTexture(k,1),t.setUniform1i("u_layerTexture",1),t.setUniform1f("u_opacity",c),t.setUniform1f("u_inFadeOpacity",u?1:0),m.setBlendFunction(f.BlendFactor.ONE,f.BlendFactor.ZERO),k=this._quad,k.draw(),k.unbind(),t.dispose(),m.setBlendFunction(f.BlendFactor.ONE,f.BlendFactor.ONE_MINUS_SRC_ALPHA)):a.error(new D("mapview-BlendEffect",`Error creating shader program for blend mode ${g}`))};e._setupShader=function(l){this._quad||
(this._quad=new x(l,[-1,-1,1,-1,-1,1,1,1]))};e._createOrResizeTexture=function(l,k,r){({context:l}=l);if(null===this._backBufferTexture||k!==this._size[0]||r!==this._size[1])this._backBufferTexture?this._backBufferTexture.resize(k,r):this._backBufferTexture=new d.Texture(l,{target:f.TextureType.TEXTURE_2D,pixelFormat:f.PixelFormat.RGBA,internalFormat:f.PixelFormat.RGBA,dataType:f.PixelType.UNSIGNED_BYTE,wrapMode:f.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:f.TextureSamplingMode.LINEAR,flipped:!1,
width:k,height:r}),this._size[0]=k,this._size[1]=r};return b}();z.BlendEffect=C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/shaders/BlendPrograms":function(){define(["exports","./sources/resolver"],function(z,D){z.createProgramTemplate=function(C){return{attributes:new Map([["a_pos",0],["a_tex",1]]),shaders:{vertexShader:`#define ${C.replace("-","_").toUpperCase()}\n`+D.resolveIncludes("blend/blend.vert"),fragmentShader:`#define ${C.replace("-",
"_").toUpperCase()}\n`+D.resolveIncludes("blend/blend.frag")}}};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/FeatureEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./Effect","../../../../webgl/enums"],function(z,D,C,B){C=function(y){function x(f){var d=y.call(this)||this;d.name=d.constructor.name;d.defines=[f];return d}D._inheritsLoose(x,y);var n=x.prototype;n.dispose=function(){};
n.bind=function({context:f,painter:d}){this._prev=f.getBoundFramebufferObject();const {width:a,height:b}=f.getViewport();d=d.getFbos(a,b).effect0;f.bindFramebuffer(d);f.setColorMask(!0,!0,!0,!0);f.setClearColor(0,0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT)};n.unbind=function(){};n.draw=function(f,d){const {context:a,painter:b}=f;d=b.getPostProcessingEffects(d);const e=a.getBoundFramebufferObject();for(const {postProcessingEffect:l,effect:k}of d)l.draw(f,e,k);a.bindFramebuffer(this._prev);a.setStencilTestEnabled(!1);
b.blitTexture(a,e.colorTexture,B.TextureSamplingMode.NEAREST);a.setStencilTestEnabled(!0)};return x}(C.Effect);z.FeatureEffect=C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../BitBlitRenderer ./Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces ../../../../webgl/enums".split(" "),
function(z,D,C,B,y,x,n,f){return function(d){function a(){var e=d.apply(this,arguments)||this;e.defines=["highlight"];e._hlRenderer=new x;e._hlGradient=new y;e._width=void 0;e._height=void 0;e._hlSurfaces=new n;e._adjustedWidth=void 0;e._adjustedHeight=void 0;e._blitRenderer=new C.BitBlitRenderer;return e}z._inheritsLoose(a,d);var b=a.prototype;b.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();this._hlGradient&&this._hlGradient.destroy();
this._boundFBO=null};b.bind=function(e){const {context:l,painter:k}=e,{width:r,height:g}=l.getViewport(),c=k.getFbos(r,g).effect0;this.setup(e,r,g);l.bindFramebuffer(c);l.setColorMask(!0,!0,!0,!0);l.setClearColor(0,0,0,0);l.clear(l.gl.COLOR_BUFFER_BIT)};b.unbind=function(){};b.setup=function({context:e},l,k){this._width=l;this._height=k;const r=l%4,g=k%4;l+=2>r?-r:4-r;k+=2>g?-g:4-g;this._adjustedWidth=l;this._adjustedHeight=k;this._boundFBO=e.getBoundFramebufferObject();l=Math.round(1*l);k=Math.round(1*
k);this._hlRenderer.setup(e,l,k);this._hlSurfaces.setup(e,l,k)};b.draw=function({context:e}){const l=e.getBoundFramebufferObject();e.setViewport(0,0,1*this._adjustedWidth,1*this._adjustedHeight);e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);e.setStencilTestEnabled(!1);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(e,l.colorTexture,f.TextureSamplingMode.NEAREST,1);e.setStencilTestEnabled(!1);e.setBlendingEnabled(!1);e.setColorMask(!1,!1,!1,!0);e.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);
e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(e,this._hlSurfaces.sharedBlur1Tex);e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(e,this._hlSurfaces.sharedBlur2Tex);e.bindFramebuffer(this._boundFBO);e.setBlendingEnabled(!0);e.setColorMask(!0,!0,!0,!0);e.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(e,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);
this._boundFBO=null};b.setHighlightOptions=function(e){this._hlGradient.setHighlightOptions(e)};return a}(B.Effect)})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define(["../../../../../../core/Logger","../../definitions","./parameters","../../../../../webgl/enums","../../../../../webgl/Texture"],function(z,D,C,B,y){function x(d,a){a.fillColor[0]=d.color.r/255;a.fillColor[1]=d.color.g/255;a.fillColor[2]=d.color.b/255;a.fillColor[3]=d.color.a;d.haloColor?(a.outlineColor[0]=
d.haloColor.r/255,a.outlineColor[1]=d.haloColor.g/255,a.outlineColor[2]=d.haloColor.b/255,a.outlineColor[3]=d.haloColor.a):(a.outlineColor[0]=a.fillColor[0],a.outlineColor[1]=a.fillColor[1],a.outlineColor[2]=a.fillColor[2],a.outlineColor[3]=a.fillColor[3]);a.fillColor[3]*=d.fillOpacity;a.outlineColor[3]*=d.haloOpacity;a.fillColor[0]*=a.fillColor[3];a.fillColor[1]*=a.fillColor[3];a.fillColor[2]*=a.fillColor[3];a.outlineColor[0]*=a.outlineColor[3];a.outlineColor[1]*=a.outlineColor[3];a.outlineColor[2]*=
a.outlineColor[3];a.outlineWidth=C.HIGHLIGHT_SIZING.outlineWidth;a.outerHaloWidth=C.HIGHLIGHT_SIZING.outerHaloWidth;a.innerHaloWidth=C.HIGHLIGHT_SIZING.innerHaloWidth;a.outlinePosition=C.HIGHLIGHT_SIZING.outlinePosition}const n=z.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),f=[0,0,0,0];return function(){function d(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:C.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:C.HIGHLIGHT_SIZING.outlineWidth,
innerHaloWidth:C.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:C.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*C.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}var a=d.prototype;a.setHighlightOptions=function(b){function e(p,u,h){q[0]=(1-h)*p[0]+h*u[0];q[1]=(1-h)*p[1]+h*u[1];q[2]=(1-h)*p[2]+h*u[2];q[3]=(1-h)*p[3]+h*u[3]}const l=this._convertedHighlightOptions;x(b,l);b=l.outlinePosition-l.outlineWidth/2-l.outerHaloWidth;const k=l.outlinePosition-l.outlineWidth/
2,r=l.outlinePosition+l.outlineWidth/2,g=l.outlinePosition+l.outlineWidth/2+l.innerHaloWidth;var c=Math.sqrt(Math.PI/2)*C.SIGMA,m=Math.abs(b)>c?Math.round(10*(Math.abs(b)-c))/10:0;c=Math.abs(g)>c?Math.round(10*(Math.abs(g)-c))/10:0;m&&!c?n.error("The outer rim of the highlight is "+m+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!m&&c?n.error("The inner rim of the highlight is "+c+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):
m&&c&&n.error("The highlight is "+Math.max(m,c)+"px away from the edge of the feature; consider reducing some width values.");const q=[void 0,void 0,void 0,void 0];({texelData:c}=this);for(let p=0;p<C.SHADE_TEXTURE_SIZE;++p)m=b+p/(C.SHADE_TEXTURE_SIZE-1)*(g-b),m<b?(q[4*p]=0,q[4*p+1]=0,q[4*p+2]=0,q[4*p+3]=0):m<k?e(f,l.outlineColor,(m-b)/(k-b)):m<r?[q[0],q[1],q[2],q[3]]=l.outlineColor:m<g?e(l.outlineColor,l.fillColor,(m-r)/(g-r)):[q[4*p],q[4*p+1],q[4*p+2],q[4*p+3]]=l.fillColor,c[4*p]=255*q[0],c[4*p+
1]=255*q[1],c[4*p+2]=255*q[2],c[4*p+3]=255*q[3];this.minMaxDistance[0]=b;this.minMaxDistance[1]=g;this.shadeTexChanged=!0};a.applyHighlightOptions=function(b,e){this.shadeTex||(this.shadeTex=new y.Texture(b,{target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,width:C.SHADE_TEXTURE_SIZE,height:1,samplingMode:B.TextureSamplingMode.LINEAR}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,C.SHADE_TEXTURE_SIZE,
1,this.texelData),this.shadeTexChanged=!1);b.bindTexture(this.shadeTex,D.TEXTURE_BINDING_HIGHLIGHT_1);e.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};a.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return d}()})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["exports"],function(z){z.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];z.HIGHLIGHT_SIZING={outlineWidth:1.3,outerHaloWidth:.4,innerHaloWidth:.4,
outlinePosition:0};z.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];z.SHADE_TEXTURE_SIZE=256;z.SIGMA=1;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("../../definitions ./parameters ../../shaders/HighlightPrograms ../../../../../webgl/BufferObject ../../../../../webgl/enums ../../../../../webgl/ProgramTemplate ../../../../../webgl/VertexArrayObject ../../../../../webgl/VertexElementDescriptor".split(" "),
function(z,D,C,B,y,x,n,f){return function(){function d(){this._height=this._width=void 0;this._resources=null}var a=d.prototype;a.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};a.preBlur=function(b,e){b.bindTexture(e,z.TEXTURE_BINDING_HIGHLIGHT_0);b.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",
[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",D.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);b.bindVAO(this._resources.quadVAO);b.drawArrays(y.PrimitiveType.TRIANGLE_STRIP,0,4);b.bindVAO()};a.finalBlur=function(b,e){b.bindTexture(e,z.TEXTURE_BINDING_HIGHLIGHT_0);b.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",D.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
b.bindVAO(this._resources.quadVAO);b.drawArrays(y.PrimitiveType.TRIANGLE_STRIP,0,4);b.bindVAO()};a.renderHighlight=function(b,e,l){b.bindTexture(e,z.TEXTURE_BINDING_HIGHLIGHT_0);b.useProgram(this._resources.highlightProgram);l.applyHighlightOptions(b,this._resources.highlightProgram);b.bindVAO(this._resources.quadVAO);b.setBlendingEnabled(!0);b.setBlendFunction(y.BlendFactor.ONE,y.BlendFactor.ONE_MINUS_SRC_ALPHA);b.drawArrays(y.PrimitiveType.TRIANGLE_STRIP,0,4);b.bindVAO()};a._initialize=function(b,
e,l){this._width=e;this._height=l;e=B.BufferObject.createVertex(b,y.Usage.STATIC_DRAW,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1])).buffer);l=new n.VertexArrayObject(b,new Map([["a_position",0],["a_texcoord",1]]),{geometry:[new f.VertexElementDescriptor("a_position",2,y.DataType.BYTE,0,4),new f.VertexElementDescriptor("a_texcoord",2,y.DataType.UNSIGNED_BYTE,2,4)]},{geometry:e});const k=x.createProgram(b,C.highlight),r=x.createProgram(b,C.blur);b.useProgram(k);k.setUniform1i("u_texture",z.TEXTURE_BINDING_HIGHLIGHT_0);
k.setUniform1i("u_shade",z.TEXTURE_BINDING_HIGHLIGHT_1);k.setUniform1f("u_sigma",D.SIGMA);b.useProgram(r);r.setUniform1i("u_texture",z.TEXTURE_BINDING_HIGHLIGHT_0);r.setUniform1f("u_sigma",D.SIGMA);this._resources={quadGeometry:e,quadVAO:l,highlightProgram:k,blurProgram:r}};a.setup=function(b,e,l){this._resources?(this._width=e,this._height=l):this._initialize(b,e,l)};return d}()})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["exports","./sources/resolver"],function(z,
D){const C={shaders:{vertexShader:D.resolveIncludes("highlight/textured.vert"),fragmentShader:D.resolveIncludes("highlight/highlight.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])};D={shaders:{vertexShader:D.resolveIncludes("highlight/textured.vert"),fragmentShader:D.resolveIncludes("highlight/blur.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])};z.blur=D;z.highlight=C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../webgl/enums","../../../../../webgl/FramebufferObject","../../../../../webgl/Texture"],function(z,D,C,B){function y(x,n,f){n=new B.Texture(x,{target:D.TextureType.TEXTURE_2D,pixelFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,width:n,height:f,samplingMode:D.TextureSamplingMode.LINEAR});x=new C.FramebufferObject(x,{colorTarget:D.TargetType.TEXTURE,depthStencilTarget:D.DepthStencilTargetType.STENCIL_RENDER_BUFFER},n);return[n,x]}
return function(){function x(){this._height=this._width=void 0;this._resources=null}var n=x.prototype;n.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)};n._initialize=function(f,d,a){this._width=d;this._height=a;const [b,e]=y(f,d,a),[l,k]=y(f,d,a);this._resources={sharedBlur1Tex:b,sharedBlur1Fbo:e,sharedBlur2Tex:l,sharedBlur2Fbo:k}};
n.setup=function(f,d,a){!this._resources||this._width===d&&this._height===a||this.dispose();this._resources||this._initialize(f,d,a)};z._createClass(x,[{key:"sharedBlur1Tex",get:function(){return this._resources.sharedBlur1Tex}},{key:"sharedBlur1Fbo",get:function(){return this._resources.sharedBlur1Fbo}},{key:"sharedBlur2Tex",get:function(){return this._resources.sharedBlur2Tex}},{key:"sharedBlur2Fbo",get:function(){return this._resources.sharedBlur2Fbo}}]);return x}()})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./Effect ../../../../webgl/enums".split(" "),
function(z,D,C,B,y,x){y=function(n){function f(){var a=n.apply(this,arguments)||this;a.name=a.constructor.name;a.defines=["hittest"];return a}D._inheritsLoose(f,n);var d=f.prototype;d.dispose=function(){C.isSome(this._fbo)&&this._fbo.dispose()};d.createOptions=function({pixelRatio:a},b,e=B.HITTEST_RADIUS){if(!b.length)return null;b=b.shift();const l=b.point.x,k=b.point.y;this._outstanding=b;return{type:"hittest",distance:e*a,position:[l,k]}};d.bind=function(a){const {context:b,attributeView:e}=a;
e.size&&(a=e.getBlock(B.ATTRIBUTE_DATA_GPGPU),C.isNone(a)||(a=a.getFBO(b),b.setViewport(0,0,e.size,e.size),b.bindFramebuffer(a),b.setColorMask(!0,!0,!0,!0),b.setClearColor(0,0,0,0),b.clear(b.gl.COLOR_BUFFER_BIT|b.gl.DEPTH_BUFFER_BIT)))};d.unbind=function(a){};d.draw=function(a){const {context:b,attributeView:e}=a;var l=e.getBlock(B.ATTRIBUTE_DATA_GPGPU);if(!C.isNone(this._outstanding))if(a=this._outstanding.resolver,C.isNone(l))a.resolve([]),this._outstanding=null;else{var k=l.getFBO(b);l=new Uint8Array(k.width*
k.height*4);k.readPixels(0,0,k.width,k.height,x.PixelFormat.RGBA,x.PixelType.UNSIGNED_BYTE,l);k=[];for(let r=0;r<l.length;r+=4){const g=l[r+3];l[r]&&k.push({id:r/4,directHits:g})}this._outstanding=null;k.sort((r,g)=>g.directHits===r.directHits?g.id-r.id:g.directHits-r.directHits);a.resolve(k.map(r=>r.id))}};return f}(y.Effect);z.HittestEffect=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/HittestEffectVTL":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./Effect ../../../../webgl/enums".split(" "),
function(z,D,C,B,y,x){y=function(n){function f(){var a=n.apply(this,arguments)||this;a.name=a.constructor.name;a.defines=["id"];a._lastSize=0;return a}D._inheritsLoose(f,n);var d=f.prototype;d.dispose=function(){C.isSome(this._fbo)&&this._fbo.dispose()};d.bind=function({context:a,painter:b}){const {width:e,height:l}=a.getViewport();this._boundFBO=a.getBoundFramebufferObject();b=b.getFbos(e,l).effect0;a.bindFramebuffer(b);a.setColorMask(!0,!0,!0,!0);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT)};
d.unbind=function({context:a}){a.bindFramebuffer(this._boundFBO);this._boundFBO=null};d.draw=function({context:a,state:b,pixelRatio:e},l,k=2*B.HITTEST_RADIUS){const r=a.getBoundFramebufferObject(),g=b.size[1]*e,c=Math.round(k*e),m=c/2,q=c/2;this._ensureBuffer(c);l.forEach((p,u)=>{var h=new Map;r.readPixels(Math.floor(u.x*e-c/2),Math.floor(g-u.y*e-c/2),c,c,x.PixelFormat.RGBA,x.PixelType.UNSIGNED_BYTE,this._buf);for(let w=0;w<this._buf32.length;w++){const A=this._buf32[w];if(4294967295!==A&&0!==A){var t=
w%c,v=c-Math.floor(w/c);t=(m-t)*(m-t)+(q-v)*(q-v);v=h.has(A)?h.get(A):4294967295;h.set(A,Math.min(t,v))}}h=Array.from(h).sort((w,A)=>w[1]-A[1]).map(w=>w[0]);p.resolve(h);l.delete(u)})};d._ensureBuffer=function(a){this._lastSize!==a&&(this._lastSize=a,this._buf=new Uint8Array(4*a*a),this._buf32=new Uint32Array(this._buf.buffer))};return f}(y.Effect);z.HittestEffectVTL=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/EffectManager":function(){define("exports ./Bloom ./Blur ./Colorize ./DropShadow ./Opacity".split(" "),
function(z,D,C,B,y,x){const n={colorize:()=>new B.Colorize,blur:()=>new C.Blur,bloom:()=>new D.Bloom,opacity:()=>new x.Opacity,"drop-shadow":()=>new y.DropShadow};let f=function(){function d(){this._effectMap=new Map}var a=d.prototype;a.dispose=function(){this._effectMap.forEach(b=>b.dispose());this._effectMap.clear()};a.getPostProcessingEffects=function(b){if(!b||0===b.length)return[];const e=[];for(const l of b){a:switch(b=l.type,b){case "bloom":case "blur":case "opacity":case "drop-shadow":break a;
default:b="colorize"}let k=this._effectMap.get(b);k||(k=n[b](),this._effectMap.set(b,k));e.push({postProcessingEffect:k,effect:l})}return e};return d}();z.EffectManager=f;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/Bloom":function(){define(["exports","../../VertexStream","../../../../../webgl/enums","../../../../../webgl/FramebufferObject"],function(z,D,C,B){const y=[1,0],x=[0,1],n=[1,.8,.6,.4,.2],
f=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];let d=function(){function a(){this._compositeFBO=this._intensityFBO=null;this._mipsFBOs=Array(5);this._nMips=5;this._kernelSizeArray=[3,5,7,9,11];this._size=[0,0];this._programDesc={luminosityHighPass:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/luminosityHighPass",attributes:new Map([["a_position",0]])},gaussianBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/gaussianBlur",attributes:new Map([["a_position",0]])},composite:{vsPath:"post-processing/pp",
fsPath:"post-processing/bloom/composite",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",0]])}}}var b=a.prototype;b.dispose=function(){this._quad&&(this._quad.dispose(),this._quad=null);this._intensityFBO&&(this._intensityFBO.dispose(),this._intensityFBO=null);this._compositeFBO&&(this._compositeFBO.dispose(),this._compositeFBO=null);if(this._mipsFBOs){for(let e=0;e<this._nMips;e++)this._mipsFBOs[e]&&(this._mipsFBOs[e].horizontal.dispose(),
this._mipsFBOs[e].vertical.dispose());this._mipsFBOs=null}};b.draw=function(e,l,k){const {width:r,height:g}=l,{context:c,painter:m}=e,{materialManager:q}=m;var p=c.gl;const u=this._programDesc,{strength:h,radius:t,threshold:v}=k;this._quad||(this._quad=new D(c,[-1,-1,1,-1,-1,1,1,1]));this._createOrResizeResources(e,r,g);c.setStencilTestEnabled(!1);c.setBlendingEnabled(!0);c.setBlendFunction(C.BlendFactor.ONE,C.BlendFactor.ONE_MINUS_SRC_ALPHA);c.setStencilWriteMask(0);e=this._quad;e.bind();c.bindFramebuffer(this._intensityFBO);
k=q.getProgram(u.luminosityHighPass);c.useProgram(k);c.bindTexture(l.colorTexture,0);k.setUniform1i("u_texture",0);k.setUniform3fv("u_defaultColor",[0,0,0]);k.setUniform1f("u_defaultOpacity",0);k.setUniform1f("u_luminosityThreshold",v);k.setUniform1f("u_smoothWidth",.01);k=[Math.round(r/2),Math.round(g/2)];c.setViewport(0,0,k[0],k[1]);c.setClearColor(0,0,0,0);c.clear(p.COLOR_BUFFER_BIT);e.draw();c.setBlendingEnabled(!1);p=this._intensityFBO.colorTexture;for(let w=0;w<this._nMips;w++){const A=q.getProgram(u.gaussianBlur,
[{name:"radius",value:this._kernelSizeArray[w]}]);c.useProgram(A);c.bindTexture(p,w+1);A.setUniform1i("u_colorTexture",w+1);A.setUniform2fv("u_texSize",k);A.setUniform2fv("u_direction",y);c.setViewport(0,0,k[0],k[1]);const E=this._mipsFBOs[w];c.bindFramebuffer(E.horizontal);e.draw();p=E.horizontal.colorTexture;c.bindFramebuffer(E.vertical);c.bindTexture(p,w+1);A.setUniform2fv("u_direction",x);e.draw();p=E.vertical.colorTexture;k[0]=Math.round(k[0]/2);k[1]=Math.round(k[1]/2)}c.setViewport(0,0,r,g);
k=q.getProgram(u.composite,[{name:"nummips",value:5}]);c.bindFramebuffer(this._compositeFBO);c.useProgram(k);k.setUniform1f("u_bloomStrength",h);k.setUniform1f("u_bloomRadius",t);k.setUniform1fv("u_bloomFactors",n);k.setUniform3fv("u_bloomTintColors",f);c.bindTexture(this._mipsFBOs[0].vertical.colorTexture,1);k.setUniform1i("u_blurTexture1",1);c.bindTexture(this._mipsFBOs[1].vertical.colorTexture,2);k.setUniform1i("u_blurTexture2",2);c.bindTexture(this._mipsFBOs[2].vertical.colorTexture,3);k.setUniform1i("u_blurTexture3",
3);c.bindTexture(this._mipsFBOs[3].vertical.colorTexture,4);k.setUniform1i("u_blurTexture4",4);c.bindTexture(this._mipsFBOs[4].vertical.colorTexture,5);k.setUniform1i("u_blurTexture5",5);e.draw();c.bindFramebuffer(l);c.setBlendingEnabled(!0);l=q.getProgram(u.blit);c.useProgram(l);c.bindTexture(this._compositeFBO.colorTexture,6);l.setUniform1i("u_texture",6);c.setBlendFunction(C.BlendFactor.ONE,C.BlendFactor.ONE);e.draw();e.unbind();c.setBlendFunction(C.BlendFactor.ONE,C.BlendFactor.ONE_MINUS_SRC_ALPHA);
c.setStencilTestEnabled(!0)};b._createOrResizeResources=function(e,l,k){({context:e}=e);if(!this._compositeFBO||this._size[0]!==l||this._size[1]!==k){this._size[0]=l;this._size[1]=k;var r=[Math.round(l/2),Math.round(k/2)];this._compositeFBO?this._compositeFBO.resize(l,k):this._compositeFBO=new B.FramebufferObject(e,{colorTarget:C.TargetType.TEXTURE,depthStencilTarget:C.DepthStencilTargetType.NONE,width:l,height:k});this._intensityFBO?this._intensityFBO.resize(r[0],r[1]):this._intensityFBO=new B.FramebufferObject(e,
{colorTarget:C.TargetType.TEXTURE,depthStencilTarget:C.DepthStencilTargetType.NONE,width:r[0],height:r[1]},{target:C.TextureType.TEXTURE_2D,pixelFormat:C.PixelFormat.RGBA,internalFormat:C.PixelFormat.RGBA,dataType:C.PixelType.UNSIGNED_BYTE,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:C.TextureSamplingMode.LINEAR,flipped:!1,width:r[0],height:r[1]});for(l=0;l<this._nMips;l++)this._mipsFBOs[l]?(this._mipsFBOs[l].horizontal.resize(r[0],r[1]),this._mipsFBOs[l].vertical.resize(r[0],r[1])):this._mipsFBOs[l]=
{horizontal:new B.FramebufferObject(e,{colorTarget:C.TargetType.TEXTURE,depthStencilTarget:C.DepthStencilTargetType.NONE,width:r[0],height:r[1]},{target:C.TextureType.TEXTURE_2D,pixelFormat:C.PixelFormat.RGBA,internalFormat:C.PixelFormat.RGBA,dataType:C.PixelType.UNSIGNED_BYTE,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:C.TextureSamplingMode.LINEAR,flipped:!1,width:r[0],height:r[1]}),vertical:new B.FramebufferObject(e,{colorTarget:C.TargetType.TEXTURE,depthStencilTarget:C.DepthStencilTargetType.NONE,
width:r[0],height:r[1]},{target:C.TextureType.TEXTURE_2D,pixelFormat:C.PixelFormat.RGBA,internalFormat:C.PixelFormat.RGBA,dataType:C.PixelType.UNSIGNED_BYTE,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:C.TextureSamplingMode.LINEAR,flipped:!1,width:r[0],height:r[1]})},r[0]=Math.round(r[0]/2),r[1]=Math.round(r[1]/2)}};return a}();z.Bloom=d;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/Blur":function(){define(["exports",
"../../VertexStream","../../../../../webgl/enums","../../../../../webgl/FramebufferObject"],function(z,D,C,B){const y=[1,0],x=[0,1];let n=function(){function f(){this._blurFBO=null;this._size=[0,0];this._programDesc={gaussianBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/gaussianBlur",attributes:new Map([["a_position",0]])},radialBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/radial-blur",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",
attributes:new Map([["a_position",0]])}}}var d=f.prototype;d.dispose=function(){this._blurFBO&&(this._blurFBO.dispose(),this._blurFBO=null)};d.draw=function(a,b,e){const {context:l}=a,{type:k,radius:r}=e;0!==r&&(this._createOrResizeResources(a),this._quad||(this._quad=new D(l,[-1,-1,1,-1,-1,1,1,1])),e=this._quad,e.bind(),"blur"===k?this._gaussianBlur(a,b,r):this._radialBlur(a,b),e.unbind())};d._gaussianBlur=function(a,b,e){const {context:l,state:k,painter:r,pixelRatio:g}=a;var {size:c}=k,{materialManager:m}=
r;a=this._quad;c=[Math.round(g*c[0]),Math.round(g*c[1])];const q=this._blurFBO;m=m.getProgram(this._programDesc.gaussianBlur,[{name:"radius",value:Math.ceil(e)}]);l.useProgram(m);l.setBlendingEnabled(!1);l.bindFramebuffer(q);l.bindTexture(b.colorTexture,4);m.setUniform1i("u_colorTexture",4);m.setUniform2fv("u_texSize",c);m.setUniform2fv("u_direction",y);m.setUniform1f("u_sigma",e);a.draw();l.bindFramebuffer(b);l.setStencilWriteMask(0);l.setStencilTestEnabled(!1);l.setDepthWriteEnabled(!1);l.setDepthTestEnabled(!1);
l.bindTexture(q.colorTexture,5);m.setUniform1i("u_colorTexture",5);m.setUniform2fv("u_direction",x);a.draw();l.setBlendingEnabled(!0);l.setBlendFunction(C.BlendFactor.ONE,C.BlendFactor.ONE_MINUS_SRC_ALPHA);l.setStencilTestEnabled(!0)};d._radialBlur=function(a,b){const {context:e,painter:l}=a,{materialManager:k}=l,r=this._programDesc;a=this._quad;const g=this._blurFBO;e.bindFramebuffer(g);const c=k.getProgram(r.radialBlur);e.useProgram(c);e.setBlendingEnabled(!1);e.bindTexture(b.colorTexture,4);c.setUniform1i("u_colorTexture",
4);a.draw();e.bindFramebuffer(b);e.setStencilWriteMask(0);e.setStencilTestEnabled(!1);e.setDepthWriteEnabled(!1);e.setDepthTestEnabled(!1);e.setBlendingEnabled(!0);b=k.getProgram(r.blit);e.useProgram(b);e.bindTexture(g.colorTexture,5);b.setUniform1i("u_texture",5);e.setBlendFunction(C.BlendFactor.ONE,C.BlendFactor.ONE_MINUS_SRC_ALPHA);a.draw()};d._createOrResizeResources=function(a){const {context:b,state:e,pixelRatio:l}=a;var {size:k}=e;a=Math.round(l*k[0]);k=Math.round(l*k[1]);this._blurFBO&&this._size[0]===
a&&this._size[1]===k||(this._size[0]=a,this._size[1]=k,this._blurFBO?this._blurFBO.resize(a,k):this._blurFBO=new B.FramebufferObject(b,{colorTarget:C.TargetType.TEXTURE,depthStencilTarget:C.DepthStencilTargetType.NONE,width:a,height:k},{target:C.TextureType.TEXTURE_2D,pixelFormat:C.PixelFormat.RGBA,internalFormat:C.PixelFormat.RGBA,dataType:C.PixelType.UNSIGNED_BYTE,wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:C.TextureSamplingMode.LINEAR,flipped:!1,width:a,height:k}))};return f}();z.Blur=
n;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/Colorize":function(){define(["exports","../../VertexStream","../../../../../webgl/enums","../../../../../webgl/Texture"],function(z,D,C,B){let y=function(){function x(){this._size=[0,0];this._programDesc={vsPath:"post-processing/pp",fsPath:"post-processing/filterEffect",attributes:new Map([["a_position",0]])}}var n=x.prototype;n.dispose=function(){this._layerFBOTexture&&
(this._layerFBOTexture.dispose(),this._layerFBOTexture=null)};n.draw=function(f,d,a){const {width:b,height:e}=d;this._createOrResizeResources(f,b,e);const {context:l,painter:k}=f,{materialManager:r}=k,g=this._programDesc;f=this._quad;a=a.colorMatrix;f.bind();const c=this._layerFBOTexture;l.bindFramebuffer(d);d.copyToTexture(0,0,b,e,0,0,c);l.setBlendingEnabled(!1);l.setStencilTestEnabled(!1);d=r.getProgram(g);l.useProgram(d);l.bindTexture(c,2);d.setUniformMatrix4fv("u_coefficients",a);d.setUniform1i("u_colorTexture",
2);f.draw();l.setBlendingEnabled(!0);l.setBlendFunction(C.BlendFactor.ONE,C.BlendFactor.ONE_MINUS_SRC_ALPHA);l.setStencilTestEnabled(!0);f.unbind()};n._createOrResizeResources=function(f,d,a){({context:f}=f);this._layerFBOTexture&&this._size[0]===d&&this._size[1]===a||(this._size[0]=d,this._size[1]=a,this._layerFBOTexture?this._layerFBOTexture.resize(d,a):this._layerFBOTexture=new B.Texture(f,{target:C.TextureType.TEXTURE_2D,pixelFormat:C.PixelFormat.RGBA,internalFormat:C.PixelFormat.RGBA,dataType:C.PixelType.UNSIGNED_BYTE,
wrapMode:C.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:C.TextureSamplingMode.LINEAR,flipped:!1,width:d,height:a}),this._quad||(this._quad=new D(f,[-1,-1,1,-1,-1,1,1,1])))};return x}();z.Colorize=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/DropShadow":function(){define("exports ../../../../../../core/screenUtils ../../VertexStream ../../../../../webgl/enums ../../../../../webgl/FramebufferObject ../../../../../webgl/Texture".split(" "),
function(z,D,C,B,y,x){const n=[1,0],f=[0,1];let d=function(){function a(){this._verticalBlurFBO=this._horizontalBlurFBO=null;this._size=[0,0];this._programDesc={blur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/gaussianBlur",attributes:new Map([["a_position",0]])},composite:{vsPath:"post-processing/pp",fsPath:"post-processing/drop-shadow/composite",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",
0]])}}}var b=a.prototype;b.dispose=function(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null);this._horizontalBlurFBO&&(this._horizontalBlurFBO.dispose(),this._horizontalBlurFBO=null);this._verticalBlurFBO&&(this._verticalBlurFBO.dispose(),this._verticalBlurFBO=null)};b.draw=function(e,l,k){const {context:r,state:g,painter:c}=e,{materialManager:m}=c,q=this._programDesc,p=l.width,u=l.height,h=[Math.round(p/2),Math.round(u/2)],{blurRadius:t,offsetX:v,offsetY:w,color:A}=
k;k=[D.pt2px(v/2),D.pt2px(w/2)];this._createOrResizeResources(e,p,u,h);const E=this._horizontalBlurFBO;e=this._verticalBlurFBO;r.setStencilWriteMask(0);r.setStencilTestEnabled(!1);r.setDepthWriteEnabled(!1);r.setDepthTestEnabled(!1);const G=this._layerFBOTexture;l.copyToTexture(0,0,p,u,0,0,G);this._quad||(this._quad=new C(r,[-1,-1,1,-1,-1,1,1,1]));r.setViewport(0,0,h[0],h[1]);const F=this._quad;F.bind();r.setBlendingEnabled(!1);const H=m.getProgram(q.blur,[{name:"radius",value:Math.ceil(t)}]);r.useProgram(H);
r.bindFramebuffer(E);r.bindTexture(l.colorTexture,4);H.setUniform1i("u_colorTexture",4);H.setUniform2fv("u_texSize",h);H.setUniform2fv("u_direction",n);H.setUniform1f("u_sigma",t);F.draw();r.bindFramebuffer(e);r.bindTexture(E.colorTexture,5);H.setUniform1i("u_colorTexture",5);H.setUniform2fv("u_direction",f);F.draw();r.bindFramebuffer(l);r.setViewport(0,0,p,u);l=m.getProgram(q.composite);r.useProgram(l);r.bindTexture(e.colorTexture,2);l.setUniform1i("u_blurTexture",2);r.bindTexture(G,3);l.setUniform1i("u_layerFBOTexture",
3);l.setUniform4fv("u_shadowColor",[A[0]/255*A[3],A[1]/255*A[3],A[2]/255*A[3],A[3]]);l.setUniformMatrix3fv("u_displayViewMat3",g.displayMat3);l.setUniform2fv("u_shadowOffset",k);F.draw();r.setBlendingEnabled(!0);r.setStencilTestEnabled(!0);r.setBlendFunction(B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA);F.unbind()};b._createOrResizeResources=function(e,l,k,r){({context:e}=e);this._horizontalBlurFBO&&this._size[0]===l&&this._size[1]===k||(this._size[0]=l,this._size[1]=k,this._horizontalBlurFBO?
this._horizontalBlurFBO.resize(r[0],r[1]):this._horizontalBlurFBO=new y.FramebufferObject(e,{colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.NONE,width:r[0],height:r[1]},{target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:B.TextureSamplingMode.LINEAR,flipped:!1,width:r[0],height:r[1]}),this._verticalBlurFBO?this._verticalBlurFBO.resize(r[0],
r[1]):this._verticalBlurFBO=new y.FramebufferObject(e,{colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.NONE,width:r[0],height:r[1]},{target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:B.TextureSamplingMode.LINEAR,flipped:!1,width:r[0],height:r[1]}),this._layerFBOTexture?this._layerFBOTexture.resize(l,k):this._layerFBOTexture=new x.Texture(e,
{target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,internalFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:B.TextureSamplingMode.LINEAR,flipped:!1,width:l,height:k}))};return a}();z.DropShadow=d;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/effects/post-processing/Opacity":function(){define(["exports","../../../../../webgl/enums","../../../../../webgl/Texture"],
function(z,D,C){let B=function(){function y(){this._size=[0,0]}var x=y.prototype;x.dispose=function(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null)};x.draw=function(n,f,d){const {width:a,height:b}=f;this._createOrResizeResources(n,a,b);const {context:e,painter:l}=n;({amount:n}=d);d=e.gl;const k=this._layerFBOTexture;e.bindFramebuffer(f);f.copyToTexture(0,0,a,b,0,0,k);e.setBlendingEnabled(!0);e.setStencilTestEnabled(!1);e.setDepthTestEnabled(!1);e.setClearColor(0,
0,0,0);e.clear(d.COLOR_BUFFER_BIT);l.blitTexture(e,k,D.TextureSamplingMode.NEAREST,n)};x._createOrResizeResources=function(n,f,d){({context:n}=n);this._layerFBOTexture&&this._size[0]===f&&this._size[1]===d||(this._size[0]=f,this._size[1]=d,this._layerFBOTexture?this._layerFBOTexture.resize(f,d):this._layerFBOTexture=new C.Texture(n,{target:D.TextureType.TEXTURE_2D,pixelFormat:D.PixelFormat.RGBA,internalFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,
samplingMode:D.TextureSamplingMode.NEAREST,flipped:!1,width:f,height:d}))};return y}();z.Opacity=B;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define(["../../../../../core/arrayUtils","../../../../../core/maybe","../enums"],function(z,D,C){return function(){function B(x,n){var f;this.brushes=x;this.name=n.name;this.drawPhase=n.drawPhase||C.WGLDrawPhase.MAP;this._targetFn=n.target;this.effects=
n.effects||[];this.enableDefaultDraw=null!=(f=n.enableDefaultDraw)?f:()=>!0}var y=B.prototype;y.render=function(x){const {context:n,profiler:f}=x,d=this._targetFn();var a=this.drawPhase&x.drawPhase;f.recordPassStart(this.name);if(a){this.enableDefaultDraw()&&this._doRender(x,d);f.recordPassEnd();for(const b of this.effects){if(!b.enable())continue;a=b.apply;f.recordPassStart(this.name+"."+a.name);f.recordBrushStart(a.name);const e=b.args&&b.args(),{x:l,y:k,width:r,height:g}=n.getViewport(),c=n.getBoundFramebufferObject();
a.bind(x,e);const m=a.createOptions(x,e),q=x.passOptions;x.passOptions=m;this._doRender(x,d,a.defines);x.passOptions=q;a.draw(x,e);a.unbind(x,e);n.bindFramebuffer(c);n.setViewport(l,k,r,g);f.recordBrushEnd();f.recordPassEnd()}}};y._doRender=function(x,n,f){if(!D.isNone(n))if(z.isArrayLike(n))for(const d of n){if(d.visible)for(const a of this.brushes)x.profiler.recordBrushStart(a.name),a.prepareState(x,d,f),a.draw(x,d,f),x.profiler.recordBrushEnd()}else for(const d of this.brushes)x.profiler.recordBrushStart(d.name),
d.prepareState(x,n,f),d.draw(x,n,f),x.profiler.recordBrushEnd()};return B}()})},"esri/views/2d/engine/webgl/Profiler":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),function(z,D,C,B,y,x,n){const f=y("esri-2d-profiler");y=function(){function d(b,e){this._events=new B;this._entries=new Map;this._timings=new C(10);if(f){this._ext=
n.createDisjointTimerQuery(b.gl,{});this._debugOutput=e;var l=b.gl;if(this.enableCommandLogging)for(const k in l)if("function"===typeof l[k]){const r=l[k],g=k.includes("draw");l[k]=(...c)=>{this._events.emit("command",{container:this._currentContainer,pass:this._currentPass,brush:this._currentBrush,method:k,args:c,isDrawCommand:g});this._currentSummary&&(this._currentSummary.commands++,g&&this._currentSummary.drawCommands++);return r.apply(l,c)}}}}var a=d.prototype;a.recordContainerStart=function(b){f&&
(this._currentContainer=b)};a.recordContainerEnd=function(){f&&(this._currentContainer=null)};a.recordPassStart=function(b){f&&(this._currentPass=b,this._initSummary())};a.recordPassEnd=function(){f&&(this._currentPass=null,this._emitSummary())};a.recordBrushStart=function(b){f&&(this._currentBrush=b)};a.recordBrushEnd=function(){f&&(this._currentBrush=null)};a.recordStart=function(b){if(f&&x.isSome(this._ext)){if(this._entries.has(b)){const g=this._entries.get(b);var e=this._ext.resultAvailable(g.query),
l=this._ext.disjoint();if(e&&!l){e=this._ext.getResult(g.query)/1E6;l=0;if(x.isSome(this._timings.enqueue(e))){l=this._timings.entries;const c=l.length;let m=0;for(var k of l)m+=k;l=m/c}k=e.toFixed(2);e=l?l.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed(`Frame report for ${b}, ${k} ms (${e} last 10 avg)\n${g.commandsLen} Commands (${g.drawCommands} draw)`),console.log("RenderPass breakdown: "),console.table(g.summaries),console.log("Commands: ",g.commands),console.groupEnd()):console.log(`Frame report for ${b}, ${k} ms (${e} last 10 avg)`);
this._debugOutput.innerHTML=`${k} (${e})`}for(const c of g.handles)c.remove();this._entries.delete(b)}const r={name:b,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(r.handles.push(this._events.on("command",g=>{r.commandsLen++;r.commands.push(g);g.isDrawCommand&&r.drawCommands++})),r.handles.push(this._events.on("summary",g=>{r.summaries.push(g)})));this._ext.beginTimeElapsed(r.query);this._entries.set(b,r)}};a.recordEnd=
function(b){f&&x.isSome(this._ext)&&this._entries.has(b)&&this._ext.endTimeElapsed()};a._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};a._emitSummary=function(){this.enableCommandLogging&&this._events.emit("summary",this._currentSummary)};D._createClass(d,[{key:"enableCommandLogging",get:function(){return!("object"===typeof f&&f.disableCommands)}}]);return d}();z.Profiler=y;Object.defineProperties(z,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(z,D){return function(){function C(y){this._start=this.size=0;this.maxSize=y;this._buffer=Array(y)}var B=C.prototype;B.enqueue=function(y){if(this.size===this.maxSize){const x=this._buffer[this._start];this._buffer[this._start]=y;this._start=(this._start+1)%this.maxSize;return x}this._buffer[(this._start+this.size++)%this.maxSize]=
y;return null};B.dequeue=function(){if(0===this.size)return null;const y=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return y};B.peek=function(){return 0===this.size?null:this._buffer[this._start]};B.find=function(y){if(0===this.size)return null;for(const x of this._buffer)if(D.isSome(x)&&y(x))return x;return null};B.clear=function(y){let x=this.dequeue();for(;D.isSome(x);)y&&y(x),x=this.dequeue()};z._createClass(C,[{key:"entries",
get:function(){return this._buffer}}]);return C}()})},"esri/views/webgl/capabilities/DisjointTimerQuery":function(){define(["exports","./isWebGL2Context"],function(z,D){let C=function(B,y,x,n,f,d,a,b){this.createQuery=B;this.resultAvailable=y;this.getResult=x;this.disjoint=n;this.beginTimeElapsed=f;this.endTimeElapsed=d;this.createTimestamp=a;this.timestampBits=b};z.DisjointTimerQuery=C;z.createDisjointTimerQuery=function(B,y){if(y.disjointTimerQuery)return null;let x=B.getExtension("EXT_disjoint_timer_query_webgl2");
return x&&D(B)?new C(()=>B.createQuery(),n=>B.getQueryParameter(n,B.QUERY_RESULT_AVAILABLE),n=>B.getQueryParameter(n,B.QUERY_RESULT),()=>B.getParameter(x.GPU_DISJOINT_EXT),n=>B.beginQuery(x.TIME_ELAPSED_EXT,n),()=>B.endQuery(x.TIME_ELAPSED_EXT),n=>x.queryCounterEXT(n,x.TIMESTAMP_EXT),()=>B.getQuery(x.TIMESTAMP_EXT,x.QUERY_COUNTER_BITS_EXT)):(x=B.getExtension("EXT_disjoint_timer_query"))?new C(()=>x.createQueryEXT(),n=>x.getQueryObjectEXT(n,x.QUERY_RESULT_AVAILABLE_EXT),n=>x.getQueryObjectEXT(n,x.QUERY_RESULT_EXT),
()=>B.getParameter(x.GPU_DISJOINT_EXT),n=>x.beginQueryEXT(x.TIME_ELAPSED_EXT,n),()=>x.endQueryEXT(x.TIME_ELAPSED_EXT),n=>x.queryCounterEXT(n,x.TIMESTAMP_EXT),()=>x.getQueryEXT(x.TIMESTAMP_EXT,x.QUERY_COUNTER_BITS_EXT)):null};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/RenderingContext":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ../../core/promiseUtils ../../core/time ./checkWebGLError ./context-util ./ContextState ./enums ./InstanceCounter ./ProgramCache ./renderState ./Texture ./Util ./WebGLDriverTest ./capabilities/Capabilities ./capabilities/isWebGL2Context".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g,c){function m(u,h,t,v){h?v!==h&&u.bindBuffer(t,h.glName):u.bindBuffer(t,null);return h}function q(u,h){switch(u){case d.PrimitiveType.POINTS:return 2*h;case d.PrimitiveType.TRIANGLES:return h/3;case d.PrimitiveType.TRIANGLE_STRIP:return h-2;case d.PrimitiveType.TRIANGLE_FAN:return h-2;default:return 0}}let p=function(){function u(t,v){this.gl=t;this.instanceCounter=new a.InstanceCounter;this.programCache=new b.ProgramCache(this);this._state=new f.ContextState;
this._numOfTriangles=this._numOfDrawCalls=0;this.type=c(t)?n.ContextType.WEBGL2:n.ContextType.WEBGL1;this._loadExtensions();this.configure(v)}var h=u.prototype;h.configure=function(t){this._capabilities=new g.Capabilities(this.gl,t);this._parameters=this._loadParameters(t);t=this.gl.getParameter(this.gl.VIEWPORT);this._state=new f.ContextState;this._state.viewport={x:t[0],y:t[1],width:t[2],height:t[3]};this._stateTracker=new e.StateTracker({setBlending:v=>{v?(this.setBlendingEnabled(!0),this.setBlendEquationSeparate(v.opRgb,
v.opAlpha),this.setBlendFunctionSeparate(v.srcRgb,v.dstRgb,v.srcAlpha,v.dstAlpha),v=v.color,this.setBlendColor(v.r,v.g,v.b,v.a)):this.setBlendingEnabled(!1)},setCulling:v=>{v?(this.setFaceCullingEnabled(!0),this.setCullFace(v.face),this.setFrontFace(v.mode)):this.setFaceCullingEnabled(!1)},setPolygonOffset:v=>{v?(this.setPolygonOffsetFillEnabled(!0),this.setPolygonOffset(v.factor,v.units)):this.setPolygonOffsetFillEnabled(!1)},setDepthTest:v=>{v?(this.setDepthTestEnabled(!0),this.setDepthFunction(v.func)):
this.setDepthTestEnabled(!1)},setStencilTest:v=>{if(v){this.setStencilTestEnabled(!0);const w=v.function;this.setStencilFunction(w.func,w.ref,w.mask);v=v.operation;this.setStencilOp(v.fail,v.zFail,v.zPass)}else this.setStencilTestEnabled(!1)},setDepthWrite:v=>{v?(this.setDepthWriteEnabled(!0),this.setDepthRange(v.zNear,v.zFar)):this.setDepthWriteEnabled(!1)},setColorWrite:v=>{v?this.setColorMask(v.r,v.g,v.b,v.a):this.setColorMask(!1,!1,!1,!1)},setStencilWrite:v=>{v?this.setStencilWriteMask(v.mask):
this.setStencilWriteMask(0)}});this.enforceState();this._driverTest=new r.WebGLDriverTest(this)};h.dispose=function(){this.programCache.dispose();this.bindVAO(null);this.unbindBuffer(d.BufferType.ARRAY_BUFFER);this.unbindBuffer(d.BufferType.ELEMENT_ARRAY_BUFFER);c(this.gl)&&(this.unbindBuffer(d.BufferType.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(d.BufferType.PIXEL_PACK_BUFFER),this.unbindBuffer(d.BufferType.PIXEL_UNPACK_BUFFER),this.unbindBuffer(d.BufferType.COPY_READ_BUFFER),
this.unbindBuffer(d.BufferType.COPY_WRITE_BUFFER));this._state.textureUnitMap.length=0;x.webglDebugEnabled()&&this.instanceCounter.printResourceCount()};h.setPipelineState=function(t){this._stateTracker.setPipeline(t)};h.setBlendingEnabled=function(t){this._state.blend!==t&&(!0===t?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._state.blend=t,this._stateTracker.invalidateBlending())};h.externalProgramUpdate=function(){var t;null==(t=this._state.program)?void 0:t.stop();this._state.program=
null};h.externalTextureUnitUpdate=function(t,v){for(let w=0;w<t.length;++w)this._state.textureUnitMap[t[w]]=null;0<=v&&(this._state.activeTexture=v)};h.externalVertexArrayObjectUpdate=function(){const t=this.capabilities.vao;t&&(t.bindVertexArray(null),this._state.vertexArrayObject=null);this._state.vertexBuffer=null;this._state.indexBuffer=null};h.externalVertexBufferUpdate=function(){this._state.vertexBuffer=null};h.externalIndexBufferUpdate=function(){this._state.indexBuffer=null};h.setBlendColor=
function(t,v,w,A){if(t!==this._state.blendColor.r||v!==this._state.blendColor.g||w!==this._state.blendColor.b||A!==this._state.blendColor.a)this.gl.blendColor(t,v,w,A),this._state.blendColor.r=t,this._state.blendColor.g=v,this._state.blendColor.b=w,this._state.blendColor.a=A,this._stateTracker.invalidateBlending()};h.setBlendFunction=function(t,v){if(t!==this._state.blendFunction.srcRGB||v!==this._state.blendFunction.dstRGB)this.gl.blendFunc(t,v),this._state.blendFunction.srcRGB=t,this._state.blendFunction.srcAlpha=
t,this._state.blendFunction.dstRGB=v,this._state.blendFunction.dstAlpha=v,this._stateTracker.invalidateBlending()};h.setBlendFunctionSeparate=function(t,v,w,A){if(this._state.blendFunction.srcRGB!==t||this._state.blendFunction.srcAlpha!==w||this._state.blendFunction.dstRGB!==v||this._state.blendFunction.dstAlpha!==A)this.gl.blendFuncSeparate(t,v,w,A),this._state.blendFunction.srcRGB=t,this._state.blendFunction.srcAlpha=w,this._state.blendFunction.dstRGB=v,this._state.blendFunction.dstAlpha=A,this._stateTracker.invalidateBlending()};
h.setBlendEquation=function(t){this._state.blendEquation.mode!==t&&(this.gl.blendEquation(t),this._state.blendEquation.mode=t,this._state.blendEquation.modeAlpha=t,this._stateTracker.invalidateBlending())};h.setBlendEquationSeparate=function(t,v){if(this._state.blendEquation.mode!==t||this._state.blendEquation.modeAlpha!==v)this.gl.blendEquationSeparate(t,v),this._state.blendEquation.mode=t,this._state.blendEquation.modeAlpha=v,this._stateTracker.invalidateBlending()};h.setColorMask=function(t,v,
w,A){if(this._state.colorMask.r!==t||this._state.colorMask.g!==v||this._state.colorMask.b!==w||this._state.colorMask.a!==A)this.gl.colorMask(t,v,w,A),this._state.colorMask.r=t,this._state.colorMask.g=v,this._state.colorMask.b=w,this._state.colorMask.a=A,this._stateTracker.invalidateColorWrite()};h.setClearColor=function(t,v,w,A){if(this._state.clearColor.r!==t||this._state.clearColor.g!==v||this._state.clearColor.b!==w||this._state.clearColor.a!==A)this.gl.clearColor(t,v,w,A),this._state.clearColor.r=
t,this._state.clearColor.g=v,this._state.clearColor.b=w,this._state.clearColor.a=A};h.setFaceCullingEnabled=function(t){this._state.faceCulling!==t&&(!0===t?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._state.faceCulling=t,this._stateTracker.invalidateCulling())};h.setPolygonOffsetFillEnabled=function(t){this._state.polygonOffsetFill!==t&&(!0===t?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._state.polygonOffsetFill=t,this._stateTracker.invalidatePolygonOffset())};
h.setPolygonOffset=function(t,v){if(this._state.polygonOffset[0]!==t||this._state.polygonOffset[1]!==v)this._state.polygonOffset[0]=t,this._state.polygonOffset[1]=v,this.gl.polygonOffset(t,v),this._stateTracker.invalidatePolygonOffset()};h.setCullFace=function(t){this._state.cullFace!==t&&(this.gl.cullFace(t),this._state.cullFace=t,this._stateTracker.invalidateCulling())};h.setFrontFace=function(t){this._state.frontFace!==t&&(this.gl.frontFace(t),this._state.frontFace=t,this._stateTracker.invalidateCulling())};
h.setScissorTestEnabled=function(t){this._state.scissorTest!==t&&(!0===t?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._state.scissorTest=t)};h.setScissorRect=function(t,v,w,A){if(this._state.scissorRect.x!==t||this._state.scissorRect.y!==v||this._state.scissorRect.width!==w||this._state.scissorRect.height!==A)this.gl.scissor(t,v,w,A),this._state.scissorRect.x=t,this._state.scissorRect.y=v,this._state.scissorRect.width=w,this._state.scissorRect.height=A};h.setDepthTestEnabled=
function(t){this._state.depthTest!==t&&(!0===t?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._state.depthTest=t,this._stateTracker.invalidateDepthTest())};h.setClearDepth=function(t){this._state.clearDepth!==t&&(this.gl.clearDepth(t),this._state.clearDepth=t)};h.setDepthFunction=function(t){this._state.depthFunction!==t&&(this.gl.depthFunc(t),this._state.depthFunction=t,this._stateTracker.invalidateDepthTest())};h.setDepthWriteEnabled=function(t){this._state.depthWrite!==
t&&(this.gl.depthMask(t),this._state.depthWrite=t,this._stateTracker.invalidateDepthWrite())};h.setDepthRange=function(t,v){if(this._state.depthRange.zNear!==t||this._state.depthRange.zFar!==v)this.gl.depthRange(t,v),this._state.depthRange.zNear=t,this._state.depthRange.zFar=v,this._stateTracker.invalidateDepthWrite()};h.setStencilTestEnabled=function(t){this._state.stencilTest!==t&&(!0===t?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._state.stencilTest=t,this._stateTracker.invalidateStencilTest())};
h.setClearStencil=function(t){t!==this._state.clearStencil&&(this.gl.clearStencil(t),this._state.clearStencil=t)};h.setStencilFunction=function(t,v,w){if(this._state.stencilFunction.func!==t||this._state.stencilFunction.ref!==v||this._state.stencilFunction.mask!==w)this.gl.stencilFunc(t,v,w),this._state.stencilFunction.face=d.Face.FRONT_AND_BACK,this._state.stencilFunction.func=t,this._state.stencilFunction.ref=v,this._state.stencilFunction.mask=w,this._stateTracker.invalidateStencilTest()};h.setStencilFunctionSeparate=
function(t,v,w,A){if(this._state.stencilFunction.face!==t||this._state.stencilFunction.func!==v||this._state.stencilFunction.ref!==w||this._state.stencilFunction.mask!==A)this.gl.stencilFuncSeparate(t,v,w,A),this._state.stencilFunction.face=t,this._state.stencilFunction.func=v,this._state.stencilFunction.ref=w,this._state.stencilFunction.mask=A,this._stateTracker.invalidateStencilTest()};h.setStencilWriteMask=function(t){this._state.stencilWriteMask!==t&&(this.gl.stencilMask(t),this._state.stencilWriteMask=
t,this._stateTracker.invalidateStencilWrite())};h.setStencilOp=function(t,v,w){if(this._state.stencilOperation.face!==d.Face.FRONT_AND_BACK||this._state.stencilOperation.fail!==t||this._state.stencilOperation.zFail!==v||this._state.stencilOperation.zPass!==w)this.gl.stencilOp(t,v,w),this._state.stencilOperation.face=d.Face.FRONT_AND_BACK,this._state.stencilOperation.fail=t,this._state.stencilOperation.zFail=v,this._state.stencilOperation.zPass=w,this._stateTracker.invalidateStencilTest()};h.setStencilOpSeparate=
function(t,v,w,A){if(this._state.stencilOperation.face!==t||this._state.stencilOperation.fail!==v||this._state.stencilOperation.zFail!==w||this._state.stencilOperation.zPass!==A)this.gl.stencilOpSeparate(t,v,w,A),this._state.stencilOperation.face=t,this._state.stencilOperation.fail=v,this._state.stencilOperation.zFail=w,this._state.stencilOperation.zPass=A,this._stateTracker.invalidateStencilTest()};h.setActiveTexture=function(t,v=!1){const w=this._state.activeTexture;0<=t&&(v||t!==this._state.activeTexture)&&
(this.gl.activeTexture(d.BASE_TEXTURE_UNIT+t),this._state.activeTexture=t);return w};h.clear=function(t){t&&this.gl.clear(t)};h.clearSafe=function(t,v=255){t&&(t&d.ClearBufferBit.COLOR_BUFFER_BIT&&this.setColorMask(!0,!0,!0,!0),t&d.ClearBufferBit.DEPTH_BUFFER_BIT&&this.setDepthWriteEnabled(!0),t&d.ClearBufferBit.STENCIL_BUFFER_BIT&&this.setStencilWriteMask(v),this.gl.clear(t))};h.drawArrays=function(t,v,w){x.webglDebugEnabled()&&(this._numOfDrawCalls++,this._numOfTriangles+=q(t,w));this.gl.drawArrays(t,
v,w);x.webglDebugEnabled()&&(t=k.getErrorString(this))&&console.error("drawArrays:",t)};h.drawElements=function(t,v,w,A){x.webglDebugEnabled()&&(this._numOfDrawCalls++,this._numOfTriangles+=q(t,v));this.gl.drawElements(t,v,w,A);if(x.webglDebugEnabled()){const H=k.getErrorString(this);if(H){var E,G=this.getBoundVAO(),F=null==G?void 0:G.indexBuffer;G={indexBuffer:F,vertexBuffers:null==G?void 0:G.vertexBuffers};t={mode:t,count:v,type:w,offset:A};F=null!=(E=C.applySome(F,J=>J.size))?E:0;v=A+v;console.error(`drawElements: ${H}${F<
v?`. Buffer is too small. Attempted to draw index ${v} of ${F}`:""}`,{args:t,vao:G})}}};h.logInfo=function(){x.webglDebugEnabled()&&console.log(`DrawCalls: ${this._numOfDrawCalls}, Triangles: ${this._numOfTriangles}`)};h.resetInfo=function(){x.webglDebugEnabled()&&(this._numOfTriangles=this._numOfDrawCalls=0)};h.setViewport=function(t,v,w,A){w=Math.max(Math.round(w),1);A=Math.max(Math.round(A),1);const E=this._state.viewport;if(E.x!==t||E.y!==v||E.width!==w||E.height!==A)E.x=t,E.y=v,E.width=w,E.height=
A,this.gl.viewport(t,v,w,A)};h.getViewport=function(){return{x:this._state.viewport.x,y:this._state.viewport.y,width:this._state.viewport.width,height:this._state.viewport.height}};h.useProgram=function(t){var v,w;this._state.program!==t&&(null==(v=this._state.program)?void 0:v.stop(),this._state.program=t,this.gl.useProgram(null!=(w=null==t?void 0:t.glName)?w:null))};h.bindTexture=function(t,v,w=!1){(v>=this.parameters.maxTextureImageUnits||0>v)&&console.error("Input texture unit is out of range of available units!");
const A=this._state.textureUnitMap[v];if(C.isNone(t)||null==t.glName)return C.isSome(A)&&(this.setActiveTexture(v,w),this.gl.bindTexture(A.descriptor.target,null)),this._state.textureUnitMap[v]=null,A;if(!w&&A===t)return t.isDirty&&(this.setActiveTexture(v,w),t.applyChanges()),A;this.setActiveTexture(v,w);this.gl.bindTexture(t.descriptor.target,t.glName);t.applyChanges();this._state.textureUnitMap[v]=t;return A};h.unbindTexture=function(t){if(!C.isNone(t))for(let v=0;v<this.parameters.maxTextureImageUnits;v++)this._state.textureUnitMap[v]===
t&&(this.bindTexture(null,v),this._state.textureUnitMap[v]=null)};h.bindFramebuffer=function(t,v=!1){if(v||this._state.readFramebuffer!==t||this._state.drawFramebuffer!==t)C.isNone(t)?(this.gl.bindFramebuffer(d.FramebufferTarget.FRAMEBUFFER,null),this._state.readFramebuffer=null,this._state.drawFramebuffer=null):(t.initializeAndBind(d.FramebufferTarget.FRAMEBUFFER),this._state.readFramebuffer=t,this._state.drawFramebuffer=t)};h.bindFramebufferSeparate=function(t,v,w=!1){const A=v===d.FramebufferTarget.READ_FRAMEBUFFER,
E=A?this._state.readFramebuffer:this._state.drawFramebuffer;if(w||E!==t)C.isNone(t)?this.gl.bindFramebuffer(v,null):t.initializeAndBind(v),A?this._state.readFramebuffer=C.unwrapOr(t,null):this._state.drawFramebuffer=C.unwrapOr(t,null)};h.blitFramebuffer=function(t,v,w=0,A=0,E=t.width,G=t.height,F=0,H=0,J=v.width,I=v.height,N=d.ClearBufferBit.COLOR_BUFFER_BIT,M=d.TextureSamplingMode.NEAREST){this.bindFramebufferSeparate(t,d.FramebufferTarget.READ_FRAMEBUFFER);this.bindFramebufferSeparate(v,d.FramebufferTarget.DRAW_FRAMEBUFFER);
this.gl.blitFramebuffer(w,A,E,G,F,H,J,I,N,M)};h.bindBuffer=function(t,v){if(t){var w;null!=(w=v)?w:v=t.bufferType;switch(v){case d.BufferType.ARRAY_BUFFER:this._state.vertexBuffer=m(this.gl,t,v,this._state.vertexBuffer);break;case d.BufferType.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=m(this.gl,t,v,this._state.indexBuffer);break;case d.BufferType.UNIFORM_BUFFER:this._state.uniformBuffer=m(this.gl,t,v,this._state.uniformBuffer);break;case d.BufferType.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=
m(this.gl,t,v,this._state.pixelPackBuffer);break;case d.BufferType.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=m(this.gl,t,v,this._state.pixelUnpackBuffer);break;case d.BufferType.COPY_READ_BUFFER:this._state.copyReadBuffer=m(this.gl,t,v,this._state.copyReadBuffer);break;case d.BufferType.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=m(this.gl,t,v,this._state.copyWriteBuffer)}}};h.bindRenderbuffer=function(t){const v=this.gl;t||(v.bindRenderbuffer(v.RENDERBUFFER,null),this._state.renderbuffer=
null);this._state.renderbuffer!==t&&(v.bindRenderbuffer(v.RENDERBUFFER,t.glName),this._state.renderbuffer=t)};h._getBufferBinding=function(t,v){if(v>=this.parameters.maxUniformBufferBindings||0>v)return console.error("Uniform buffer binding point is out of range!"),null;t=this._state.uniformBufferBindingPoints;let w=t[v];C.isNone(w)&&(w={buffer:null,offset:0,size:0},t[v]=w);return w};h.bindBufferBase=function(t,v,w){const A=this._getBufferBinding(t,v);C.isNone(A)||A.buffer===w&&0===A.offset&&0===
A.size||(this.gl.bindBufferBase(t,v,w?w.glName:null),A.buffer=w,A.offset=0,A.size=0)};h.bindBufferRange=function(t,v,w,A,E){const G=this._getBufferBinding(t,v);C.isNone(G)||G.buffer===w&&G.offset===A&&G.size===E||(0!==A%this._parameters.uniformBufferOffsetAlignment?console.error("Uniform buffer binding offset is not a multiple of the context offset alignment"):(this.gl.bindBufferRange(t,v,w.glName,A,E),G.buffer=w,G.offset=A,G.size=E))};h.bindUBO=function(t,v,w,A){C.isNone(v)?this.bindBufferBase(d.BufferType.UNIFORM_BUFFER,
t,null):(x.webglDebugEnabled()&&(null!=A?A:v.byteLength)>this._parameters.maxUniformBlockSize&&console.error("Attempting to bind more data than the maximum uniform block size"),v.initialize(),void 0!==w&&void 0!==A?this.bindBufferRange(d.BufferType.UNIFORM_BUFFER,t,v.buffer,w,A):this.bindBufferBase(d.BufferType.UNIFORM_BUFFER,t,v.buffer))};h.unbindUBO=function(t){for(let v=0,w=this._state.uniformBufferBindingPoints.length;v<w;v++){const A=this._state.uniformBufferBindingPoints[v];C.isSome(A)&&A.buffer===
t.buffer&&this.bindBufferBase(d.BufferType.UNIFORM_BUFFER,v,null)}};h.unbindBuffer=function(t){switch(t){case d.BufferType.ARRAY_BUFFER:this._state.vertexBuffer=m(this.gl,null,t,this._state.vertexBuffer);break;case d.BufferType.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=m(this.gl,null,t,this._state.indexBuffer);break;case d.BufferType.UNIFORM_BUFFER:this._state.uniformBuffer=m(this.gl,null,t,this._state.uniformBuffer);break;case d.BufferType.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=m(this.gl,
null,t,this._state.pixelPackBuffer);break;case d.BufferType.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=m(this.gl,null,t,this._state.pixelUnpackBuffer);break;case d.BufferType.COPY_READ_BUFFER:this._state.copyReadBuffer=m(this.gl,null,t,this._state.copyReadBuffer);break;case d.BufferType.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=m(this.gl,null,t,this._state.copyWriteBuffer)}};h.bindVAO=function(t=null){C.isNone(t)?this._state.vertexArrayObject&&(this._state.vertexArrayObject.unbind(),this._state.vertexArrayObject=
null):this._state.vertexArrayObject!==t&&(t.bind(),this._state.vertexArrayObject=t)};h.clientWaitAsync=function(){var t=D._asyncToGenerator(function*(v=y.Milliseconds(10)){const w=this.gl,A=w.fenceSync(d.SyncCondition.SYNC_GPU_COMMANDS_COMPLETE,0);this.instanceCounter.increment(d.ResourceType.Sync,A);w.flush();let E;do yield B.after(v),E=w.clientWaitSync(A,0,0);while(E===d.ClientWaitSyncStatus.TIMEOUT_EXPIRED);this.instanceCounter.decrement(d.ResourceType.Sync,A);w.deleteSync(A);if(E===d.ClientWaitSyncStatus.WAIT_FAILED)throw Error("Client wait failed");
});return function(){return t.apply(this,arguments)}}();h.getBoundFramebufferObject=function(t=d.FramebufferTarget.FRAMEBUFFER){return t===d.FramebufferTarget.READ_FRAMEBUFFER?this._state.readFramebuffer:this._state.drawFramebuffer};h.getBoundVAO=function(){return this._state.vertexArrayObject};h.resetState=function(){this.useProgram(null);this.bindVAO(null);this.bindFramebuffer(null,!0);this.unbindBuffer(d.BufferType.ARRAY_BUFFER);this.unbindBuffer(d.BufferType.ELEMENT_ARRAY_BUFFER);c(this.gl)&&
(this.unbindBuffer(d.BufferType.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(d.BufferType.PIXEL_PACK_BUFFER),this.unbindBuffer(d.BufferType.PIXEL_UNPACK_BUFFER),this.unbindBuffer(d.BufferType.COPY_READ_BUFFER),this.unbindBuffer(d.BufferType.COPY_WRITE_BUFFER));for(let t=0;t<this.parameters.maxTextureImageUnits;++t)this.bindTexture(null,t);this.setBlendingEnabled(!1);this.setBlendFunction(d.BlendFactor.ONE,d.BlendFactor.ZERO);this.setBlendEquation(d.BlendOperation.ADD);
this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(d.Face.BACK);this.setFrontFace(d.CullMode.CCW);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(d.CompareFunction.LESS);this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(d.CompareFunction.ALWAYS,0,0);this.setStencilOp(d.StencilOperation.KEEP,
d.StencilOperation.KEEP,d.StencilOperation.KEEP);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};h.enforceState=function(){var t,v;const w=this.gl;var A=this.capabilities.vao;A&&A.bindVertexArray(null);for(let J=0;J<this.parameters.maxVertexAttributes;J++)w.disableVertexAttribArray(J);this._state.vertexBuffer?
w.bindBuffer(this._state.vertexBuffer.bufferType,this._state.vertexBuffer.glName):w.bindBuffer(d.BufferType.ARRAY_BUFFER,null);this._state.indexBuffer?w.bindBuffer(this._state.indexBuffer.bufferType,this._state.indexBuffer.glName):w.bindBuffer(d.BufferType.ELEMENT_ARRAY_BUFFER,null);if(c(w)){var E,G;this._state.uniformBuffer?w.bindBuffer(this._state.uniformBuffer.bufferType,this._state.uniformBuffer.glName):w.bindBuffer(d.BufferType.UNIFORM_BUFFER,null);for(var F=0;F<this._parameters.maxUniformBufferBindings;F++){var H=
this._state.uniformBufferBindingPoints[F];if(C.isSome(H)){const {buffer:J,offset:I,size:N}=H;null!==J?0===I&&0===N?w.bindBufferBase(d.BufferType.UNIFORM_BUFFER,F,J.glName):w.bindBufferRange(d.BufferType.UNIFORM_BUFFER,F,J.glName,I,N):w.bindBufferBase(d.BufferType.UNIFORM_BUFFER,F,null)}}this._state.pixelPackBuffer?w.bindBuffer(this._state.pixelPackBuffer.bufferType,this._state.pixelPackBuffer.glName):w.bindBuffer(d.BufferType.PIXEL_PACK_BUFFER,null);this._state.pixelUnpackBuffer?w.bindBuffer(this._state.pixelUnpackBuffer.bufferType,
this._state.pixelUnpackBuffer.glName):w.bindBuffer(d.BufferType.PIXEL_UNPACK_BUFFER,null);this._state.copyReadBuffer?w.bindBuffer(this._state.copyReadBuffer.bufferType,this._state.copyReadBuffer.glName):w.bindBuffer(d.BufferType.COPY_READ_BUFFER,null);this._state.copyWriteBuffer?w.bindBuffer(this._state.copyWriteBuffer.bufferType,this._state.copyWriteBuffer.glName):w.bindBuffer(d.BufferType.COPY_WRITE_BUFFER,null);w.bindFramebuffer(d.FramebufferTarget.READ_FRAMEBUFFER,null);w.readBuffer(w.BACK);this._state.readFramebuffer&&
(w.bindFramebuffer(d.FramebufferTarget.READ_FRAMEBUFFER,this._state.readFramebuffer.glName),w.readBuffer(d.ColorAttachment.COLOR_ATTACHMENT0));w.bindFramebuffer(d.FramebufferTarget.DRAW_FRAMEBUFFER,null!=(E=null==(G=this._state.drawFramebuffer)?void 0:G.glName)?E:null)}else this._state.readFramebuffer=this._state.drawFramebuffer,w.bindFramebuffer(d.FramebufferTarget.FRAMEBUFFER,null!=(F=null==(H=this._state.drawFramebuffer)?void 0:H.glName)?F:null);if(A&&this._state.vertexArrayObject){if(A=this._state.vertexArrayObject)this._state.vertexArrayObject.unbind(),
this._state.vertexArrayObject=null;this.bindVAO(A)}w.useProgram(null!=(t=null==(v=this._state.program)?void 0:v.glName)?t:null);w.blendColor(this._state.blendColor.r,this._state.blendColor.g,this._state.blendColor.b,this._state.blendColor.a);w.bindRenderbuffer(w.RENDERBUFFER,this._state.renderbuffer?this._state.renderbuffer.glName:null);!0===this._state.blend?w.enable(this.gl.BLEND):w.disable(this.gl.BLEND);w.blendEquationSeparate(this._state.blendEquation.mode,this._state.blendEquation.modeAlpha);
w.blendFuncSeparate(this._state.blendFunction.srcRGB,this._state.blendFunction.dstRGB,this._state.blendFunction.srcAlpha,this._state.blendFunction.dstAlpha);w.clearColor(this._state.clearColor.r,this._state.clearColor.g,this._state.clearColor.b,this._state.clearColor.a);w.clearDepth(this._state.clearDepth);w.clearStencil(this._state.clearStencil);w.colorMask(this._state.colorMask.r,this._state.colorMask.g,this._state.colorMask.b,this._state.colorMask.a);w.cullFace(this._state.cullFace);w.depthFunc(this._state.depthFunction);
w.depthRange(this._state.depthRange.zNear,this._state.depthRange.zFar);!0===this._state.depthTest?w.enable(w.DEPTH_TEST):w.disable(w.DEPTH_TEST);w.depthMask(this._state.depthWrite);w.frontFace(this._state.frontFace);w.lineWidth(1);!0===this._state.faceCulling?w.enable(w.CULL_FACE):w.disable(w.CULL_FACE);w.polygonOffset(this._state.polygonOffset[0],this._state.polygonOffset[1]);!0===this._state.polygonOffsetFill?w.enable(w.POLYGON_OFFSET_FILL):w.disable(w.POLYGON_OFFSET_FILL);w.scissor(this._state.scissorRect.x,
this._state.scissorRect.y,this._state.scissorRect.width,this._state.scissorRect.height);!0===this._state.scissorTest?w.enable(w.SCISSOR_TEST):w.disable(w.SCISSOR_TEST);w.stencilFunc(this._state.stencilFunction.func,this._state.stencilFunction.ref,this._state.stencilFunction.mask);w.stencilOpSeparate(this._state.stencilOperation.face,this._state.stencilOperation.fail,this._state.stencilOperation.zFail,this._state.stencilOperation.zPass);!0===this._state.stencilTest?w.enable(w.STENCIL_TEST):w.disable(w.STENCIL_TEST);
w.stencilMask(this._state.stencilWriteMask);for(t=0;t<this.parameters.maxTextureImageUnits;t++)w.activeTexture(d.BASE_TEXTURE_UNIT+t),w.bindTexture(d.TextureType.TEXTURE_2D,null),w.bindTexture(d.TextureType.TEXTURE_CUBE_MAP,null),c(w)&&(w.bindTexture(d.TextureType.TEXTURE_3D,null),w.bindTexture(d.TextureType.TEXTURE_2D_ARRAY,null)),v=this._state.textureUnitMap[t],C.isSome(v)&&w.bindTexture(v.descriptor.target,v.glName);w.activeTexture(d.BASE_TEXTURE_UNIT+this._state.activeTexture);w.viewport(this._state.viewport.x,
this._state.viewport.y,this._state.viewport.width,this._state.viewport.height);this.resetInfo()};h._loadExtensions=function(){this.type===n.ContextType.WEBGL1&&this.gl.getExtension("OES_element_index_uint");this.gl.getExtension("KHR_parallel_shader_compile")};h._loadParameters=function(t){var v,w=this.capabilities.textureFilterAnisotropic;t=null!=(v=t.maxAnisotropy)?v:Infinity;v=c(this.gl);const A=this.gl;w={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),
maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:w?Math.min(this.gl.getParameter(w.MAX_TEXTURE_MAX_ANISOTROPY),t):1,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),maxUniformBufferBindings:v?A.getParameter(A.MAX_UNIFORM_BUFFER_BINDINGS):0,maxVertexUniformBlocks:v?A.getParameter(A.MAX_VERTEX_UNIFORM_BLOCKS):0,maxFragmentUniformBlocks:v?A.getParameter(A.MAX_FRAGMENT_UNIFORM_BLOCKS):
0,maxUniformBlockSize:v?A.getParameter(A.MAX_UNIFORM_BLOCK_SIZE):0,uniformBufferOffsetAlignment:v?A.getParameter(A.UNIFORM_BUFFER_OFFSET_ALIGNMENT):1,maxArrayTextureLayers:v?A.getParameter(A.MAX_ARRAY_TEXTURE_LAYERS):1,maxSamples:v?A.getParameter(A.MAX_SAMPLES):1};l.Texture.TEXTURE_UNIT_FOR_UPDATES=w.maxTextureImageUnits-1;return w};D._createClass(u,[{key:"driverTest",get:function(){return this._driverTest}},{key:"contextAttributes",get:function(){return this.gl.getContextAttributes()}},{key:"parameters",
get:function(){return this._parameters}},{key:"capabilities",get:function(){return this._capabilities}}]);return u}();z.RenderingContext=p;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/ContextState":function(){define(["exports","./enums"],function(z,D){z.ContextState=function(){this.blend=!1;this.blendColor={r:0,g:0,b:0,a:0};this.blendFunction={srcRGB:D.BlendFactor.ONE,dstRGB:D.BlendFactor.ZERO,srcAlpha:D.BlendFactor.ONE,dstAlpha:D.BlendFactor.ZERO};
this.blendEquation={mode:D.BlendOperation.ADD,modeAlpha:D.BlendOperation.ADD};this.colorMask={r:!0,g:!0,b:!0,a:!0};this.faceCulling=!1;this.cullFace=D.Face.BACK;this.frontFace=D.CullMode.CCW;this.scissorTest=!1;this.scissorRect={x:0,y:0,width:0,height:0};this.depthTest=!1;this.depthFunction=D.CompareFunction.LESS;this.clearDepth=1;this.depthWrite=!0;this.depthRange={zNear:0,zFar:1};this.viewport=null;this.polygonOffsetFill=this.stencilTest=!1;this.polygonOffset=[0,0];this.stencilFunction={face:D.Face.FRONT_AND_BACK,
func:D.CompareFunction.ALWAYS,ref:0,mask:1};this.clearStencil=0;this.stencilWriteMask=1;this.stencilOperation={face:D.Face.FRONT_AND_BACK,fail:D.StencilOperation.KEEP,zFail:D.StencilOperation.KEEP,zPass:D.StencilOperation.KEEP};this.clearColor={r:0,g:0,b:0,a:0};this.copyWriteBuffer=this.copyReadBuffer=this.pixelUnpackBuffer=this.pixelPackBuffer=this.uniformBuffer=this.indexBuffer=this.vertexBuffer=this.program=null;this.uniformBufferBindingPoints=[];this.renderbuffer=this.drawFramebuffer=this.readFramebuffer=
null;this.activeTexture=0;this.textureUnitMap=[]};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/InstanceCounter":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../support/AllocationTracer","./enums"],function(z,D,C,B){const y={RECORD_ALLOCATIONS:!1};let x=function(){function n(){this._current=[];this._max=[];for(this._allocations=new C.AllocationTracer(y.RECORD_ALLOCATIONS);this._current.length<B.ResourceType.COUNT;)this._current.push(0),
this._max.push(0)}var f=n.prototype;f.resetMax=function(){for(this._max.length=0;this._max.length<this._current.length;)this._max.push(0)};f.increment=function(d,a){const b=++this._current[d];this._max[d]=Math.max(b,this._max[d]);this._allocations.add(a)};f.decrement=function(d,a){--this._current[d];this._allocations.remove(a)};f.printResourceCount=function(){if(0<this.total){console.log("Live objects:");for(let d=0;d<B.ResourceType.COUNT;++d){const a=this._current[d];0<a&&console.log(`${B.ResourceType[d]}: ${a}`)}}this._allocations.print()};
D._createClass(n,[{key:"max",get:function(){return this._max}},{key:"current",get:function(){return this._current}},{key:"total",get:function(){return this.current.reduce((d,a)=>d+a,0)}}]);return n}();z.InstanceCounter=x;z.test=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/support/AllocationTracer":function(){define(["exports"],function(z){let D=function(){function C(y){this._allocations=new Map;y?Error.stackTraceLimit=Infinity:(this.add=
()=>{},this.remove=()=>{})}var B=C.prototype;B.add=function(y){this._allocations.set(y,Error().stack)};B.remove=function(y){this._allocations.delete(y)};B.print=function(){if(0<this._allocations.size){console.log(`${this._allocations.size} live object allocations:`);const y=new Map;this._allocations.forEach(x=>{var n;y.set(x,(null!=(n=y.get(x))?n:0)+1)});y.forEach((x,n)=>{n=n.split("\n");n.shift();n.shift();console.log(`${x}: ${n.shift()}`);n.forEach(f=>console.log("   ",f))})}};return C}();z.AllocationTracer=
D;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/ProgramCache":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/maybe","../../core/NestedMap","./Program"],function(z,D,C,B,y){let x=function(){function n(d){this._rctx=d;this._store=new B.NestedMap}var f=n.prototype;f.dispose=function(){this._store.forEach(d=>d.forEach(a=>a.dispose()));this._store.clear()};f.acquire=function(d,a,b,e){const l=this._store.get(d,
a);if(C.isSome(l))return l.ref(),l;b=new y.Program(this._rctx,d,a,b,e);b.ref();this._store.set(d,a,b);return b};D._createClass(n,[{key:"test",get:function(){let d=0;this._store.forEach(a=>a.forEach(b=>d+=b.hasGLName?2:1));return{cachedWebGLObjects:d}}}]);return n}();z.ProgramCache=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/NestedMap":function(){define(["exports","../chunks/_rollupPluginBabelHelpers"],function(z,D){let C=function(){function B(){this._outer=
new Map}var y=B.prototype;y.clear=function(){this._outer.clear()};y.get=function(x,n){var f;return null==(f=this._outer.get(x))?void 0:f.get(n)};y.set=function(x,n,f){const d=this._outer.get(x);d?d.set(n,f):this._outer.set(x,new Map([[n,f]]))};y.delete=function(x,n){const f=this._outer.get(x);f&&(f.delete(n),0===f.size&&this._outer.delete(x))};y.forEach=function(x){this._outer.forEach((n,f)=>x(n,f))};D._createClass(B,[{key:"empty",get:function(){return 0===this._outer.size}}]);return B}();z.NestedMap=
C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/renderState":function(){define(["exports","../3d/webgl-engine/lib/basicInterfaces","./enums"],function(z,D,C){function B(N){return v.intern(N)}function y(N){return w.intern(N)}function x(N){return A.intern(N)}function n(N){return E.intern(N)}function f(N){return G.intern(N)}function d(N){return F.intern(N)}function a(N){return H.intern(N)}function b(N){return J.intern(N)}function e(N){return"["+
N.join(",")+"]"}function l(N){return N?e([N.srcRgb,N.srcAlpha,N.dstRgb,N.dstAlpha,N.opRgb,N.opAlpha,N.color.r,N.color.g,N.color.b,N.color.a]):null}function k(N){return N?e([N.face,N.mode]):null}function r(N){return N?e([N.factor,N.units]):null}function g(N){return N?e([N.func]):null}function c(N){return N?e([N.function.func,N.function.ref,N.function.mask,N.operation.fail,N.operation.zFail,N.operation.zPass]):null}function m(N){return N?e([N.zNear,N.zFar]):null}function q(N){return N?e([N.r,N.g,N.b,
N.a]):null}function p(N){return N?e([N.mask]):null}const u={face:C.Face.BACK,mode:C.CullMode.CCW},h={face:C.Face.FRONT,mode:C.CullMode.CCW};var t=function(){function N(M,K){this.makeKey=M;this.makeRef=K;this.interns=new Map}N.prototype.intern=function(M){if(!M)return null;const K=this.makeKey(M),O=this.interns;O.has(K)||O.set(K,this.makeRef(M));return O.get(K)};return N}();const v=new t(l,N=>({__tag:"Blending",...N})),w=new t(k,N=>({__tag:"Culling",...N})),A=new t(r,N=>({__tag:"PolygonOffset",...N})),
E=new t(g,N=>({__tag:"DepthTest",...N})),G=new t(c,N=>({__tag:"StencilTest",...N})),F=new t(m,N=>({__tag:"DepthWrite",...N})),H=new t(q,N=>({__tag:"ColorWrite",...N})),J=new t(p,N=>({__tag:"StencilWrite",...N})),I=new t(function(N){return N?e([l(N.blending),k(N.culling),r(N.polygonOffset),g(N.depthTest),c(N.stencilTest),m(N.depthWrite),q(N.colorWrite),p(N.stencilWrite)]):null},N=>({blending:B(N.blending),culling:y(N.culling),polygonOffset:x(N.polygonOffset),depthTest:n(N.depthTest),stencilTest:f(N.stencilTest),
depthWrite:d(N.depthWrite),colorWrite:a(N.colorWrite),stencilWrite:b(N.stencilWrite)}));t=function(){function N(K){this._stencilWriteInvalid=this._colorWriteInvalid=this._depthWriteInvalid=this._stencilTestInvalid=this._depthTestInvalid=this._polygonOffsetInvalid=this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=K}var M=N.prototype;M.setPipeline=function(K){if(this._pipelineInvalid||K!==this._pipeline)this._setBlending(K.blending),this._setCulling(K.culling),this._setPolygonOffset(K.polygonOffset),
this._setDepthTest(K.depthTest),this._setStencilTest(K.stencilTest),this._setDepthWrite(K.depthWrite),this._setColorWrite(K.colorWrite),this._setStencilWrite(K.stencilWrite),this._pipeline=K;this._pipelineInvalid=!1};M.invalidateBlending=function(){this._pipelineInvalid=this._blendingInvalid=!0};M.invalidateCulling=function(){this._pipelineInvalid=this._cullingInvalid=!0};M.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=!0};M.invalidateDepthTest=function(){this._pipelineInvalid=
this._depthTestInvalid=!0};M.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};M.invalidateDepthWrite=function(){this._pipelineInvalid=this._depthWriteInvalid=!0};M.invalidateColorWrite=function(){this._pipelineInvalid=this._colorWriteInvalid=!0};M.invalidateStencilWrite=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};M._setBlending=function(K){this._blending=this._setSubState(K,this._blending,this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=
!1};M._setCulling=function(K){this._culling=this._setSubState(K,this._culling,this._cullingInvalid,this._stateSetters.setCulling);this._cullingInvalid=!1};M._setPolygonOffset=function(K){this._polygonOffset=this._setSubState(K,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=!1};M._setDepthTest=function(K){this._depthTest=this._setSubState(K,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest);this._depthTestInvalid=
!1};M._setStencilTest=function(K){this._stencilTest=this._setSubState(K,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest);this._stencilTestInvalid=!1};M._setDepthWrite=function(K){this._depthWrite=this._setSubState(K,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=!1};M._setColorWrite=function(K){this._colorWrite=this._setSubState(K,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite);this._colorWriteInvalid=
!1};M._setStencilWrite=function(K){this._stencilWrite=this._setSubState(K,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite);this._stencilTestInvalid=!1};M._setSubState=function(K,O,X,aa){if(X||K!==O)aa(K),this._pipelineInvalid=!0;return K};return N}();z.StateTracker=t;z.backFaceCullingParams=u;z.cullingParams=N=>N===D.CullFaceOptions.Back?u:N===D.CullFaceOptions.Front?h:null;z.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0};z.defaultDepthWriteParams={zNear:0,zFar:1};z.frontFaceCullingParams=
h;z.makeBlending=B;z.makeColorWrite=a;z.makeCulling=y;z.makeDepthTest=n;z.makeDepthWrite=d;z.makePipelineState=function(N){return I.intern(N)};z.makePolygonOffset=x;z.makeStencilTest=f;z.makeStencilWrite=b;z.separateBlendingParams=function(N,M,K,O,X=C.BlendOperation.ADD,aa=C.BlendOperation.ADD,ba=[0,0,0,0]){return{srcRgb:N,srcAlpha:M,dstRgb:K,dstAlpha:O,opRgb:X,opAlpha:aa,color:{r:ba[0],g:ba[1],b:ba[2],a:ba[3]}}};z.simpleBlendingParams=function(N,M,K=C.BlendOperation.ADD,O=[0,0,0,0]){return{srcRgb:N,
srcAlpha:N,dstRgb:M,dstAlpha:M,opRgb:K,opAlpha:K,color:{r:O[0],g:O[1],b:O[2],a:O[3]}}};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/webgl-engine/lib/basicInterfaces":function(){define(["exports"],function(z){z.CullFaceOptions=void 0;(function(D){D[D.None=0]="None";D[D.Front=1]="Front";D[D.Back=2]="Back";D[D.COUNT=3]="COUNT"})(z.CullFaceOptions||(z.CullFaceOptions={}));z.DepthTestFunction=void 0;(function(D){D[D.Less=0]="Less";D[D.Lequal=
1]="Lequal";D[D.COUNT=2]="COUNT"})(z.DepthTestFunction||(z.DepthTestFunction={}));z.AntiAliasingMode=void 0;(function(D){D[D.NONE=0]="NONE";D[D.SMAA=1]="SMAA"})(z.AntiAliasingMode||(z.AntiAliasingMode={}));z.TransparencyPassType=void 0;(function(D){D[D.Color=0]="Color";D[D.Alpha=1]="Alpha";D[D.FrontFace=2]="FrontFace";D[D.NONE=3]="NONE";D[D.COUNT=4]="COUNT"})(z.TransparencyPassType||(z.TransparencyPassType={}));z.RenderRequestType=void 0;(function(D){D[D.BACKGROUND=0]="BACKGROUND";D[D.UPDATE=1]="UPDATE"})(z.RenderRequestType||
(z.RenderRequestType={}));z.ResourceState=void 0;(function(D){D[D.NOT_LOADED=0]="NOT_LOADED";D[D.LOADING=1]="LOADING";D[D.LOADED=2]="LOADED"})(z.ResourceState||(z.ResourceState={}));z.StencilBits=void 0;(function(D){D[D.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded";D[D.OutlineVisualElementMask=2]="OutlineVisualElementMask"})(z.StencilBits||(z.StencilBits={}));z.UpdatePolicy=void 0;(function(D){D[D.ASYNC=0]="ASYNC";D[D.SYNC=1]="SYNC"})(z.UpdatePolicy||(z.UpdatePolicy={}));z.Object3DState=
void 0;(function(D){D[D.Highlight=0]="Highlight";D[D.MaskOccludee=1]="MaskOccludee";D[D.COUNT=2]="COUNT"})(z.Object3DState||(z.Object3DState={}));z.PrimitiveType=void 0;(function(D){D[D.Triangle=0]="Triangle";D[D.Point=1]="Point";D[D.Line=2]="Line"})(z.PrimitiveType||(z.PrimitiveType={}));z.PowerOfTwoResizeMode=void 0;(function(D){D[D.STRETCH=1]="STRETCH";D[D.PAD=2]="PAD"})(z.PowerOfTwoResizeMode||(z.PowerOfTwoResizeMode={}));z.ValidationState=void 0;(function(D){D[D.CHANGED=0]="CHANGED";D[D.UNCHANGED=
1]="UNCHANGED"})(z.ValidationState||(z.ValidationState={}));z.AlphaDiscardMode=void 0;(function(D){D[D.Blend=0]="Blend";D[D.Opaque=1]="Opaque";D[D.Mask=2]="Mask";D[D.MaskBlend=3]="MaskBlend";D[D.COUNT=4]="COUNT"})(z.AlphaDiscardMode||(z.AlphaDiscardMode={}));z.Decorations=void 0;(function(D){D[D.OFF=0]="OFF";D[D.ON=1]="ON"})(z.Decorations||(z.Decorations={}));Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/WebGLDriverTest":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ./testDoublePrecisionArithmetic ./testFloatBufferBlend ./testSamplerPrecision ./testSVGPremultipliedAlpha".split(" "),
function(z,D,C,B,y,x,n){let f=function(){function d(a){this.context=a;this._floatBufferBlendWorking=y.testFloatBufferBlend(a);n.testSVGPremultipliedAlpha(a).then(b=>this._svgAlwaysPremultipliesAlpha=!b)}D._createClass(d,[{key:"floatBufferBlendWorking",get:function(){if(C.isNone(this._floatBufferBlendWorking))throw Error("floatBufferBlendWorking test not yet available");return this._floatBufferBlendWorking}},{key:"svgAlwaysPremultipliesAlpha",get:function(){if(C.isNone(this._svgAlwaysPremultipliesAlpha))throw Error("svgAlwaysPremultipliesAlpha test not yet available");
return this._svgAlwaysPremultipliesAlpha}},{key:"doublePrecisionRequiresObfuscation",get:function(){if(C.isNone(this._doublePrecisionRequiresObfuscation)){const a=B.testDoublePrecisionArithmetic(this.context,!1),b=B.testDoublePrecisionArithmetic(this.context,!0);this._doublePrecisionRequiresObfuscation=0!==a&&(0===b||5<a/b)}return this._doublePrecisionRequiresObfuscation}},{key:"ignoresSamplerPrecision",get:function(){C.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=x.testSamplerPrecision(this.context));
return this._ignoresSamplerPrecision}}]);return d}();z.WebGLDriverTest=f;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/testDoublePrecisionArithmetic":function(){define("exports ../../core/floatRGBA ../../chunks/vec3f64 ./BufferObject ./doublePrecisionUtils ./enums ./FramebufferObject ./VertexArrayObject ./VertexElementDescriptor".split(" "),function(z,D,C,B,y,x,n,f,d){z.testDoublePrecisionArithmetic=function(a,b){var e=new n.FramebufferObject(a,
{colorTarget:x.TargetType.TEXTURE,depthStencilTarget:x.DepthStencilTargetType.NONE},{target:x.TextureType.TEXTURE_2D,wrapMode:x.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:x.PixelFormat.RGBA,dataType:x.PixelType.UNSIGNED_BYTE,samplingMode:x.TextureSamplingMode.NEAREST,width:1,height:1});const l=B.BufferObject.createVertex(a,x.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),k=new f.VertexArrayObject(a,new Map([["position",0]]),{geometry:[new d.VertexElementDescriptor("position",2,x.DataType.UNSIGNED_SHORT,
0,4)]},{geometry:l}),r=C.fromValues(5633261.287538229,2626832.878767164,1434988.0495278358),g=C.fromValues(5633271.46742708,2626873.6381334523,1434963.231608387);b=a.programCache.acquire(`\n\n  precision highp float;\n\n  attribute vec2 position;\n\n  uniform vec3 u_highA;\n  uniform vec3 u_lowA;\n  uniform vec3 u_highB;\n  uniform vec3 u_lowB;\n\n  varying vec4 v_color;\n\n  ${b?"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION":""}\n\n  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION\n\n  vec3 dpPlusFrc(vec3 a, vec3 b) {\n    return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n  }\n\n  vec3 dpMinusFrc(vec3 a, vec3 b) {\n    return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n  }\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = dpPlusFrc(hiA, hiB);\n    vec3 e = dpMinusFrc(t1, hiA);\n    vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n    return t1 + t2;\n  }\n\n  #else\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = hiA + hiB;\n    vec3 e = t1 - hiA;\n    vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n    return t1 + t2;\n  }\n\n  #endif\n\n  const float MAX_RGBA_FLOAT =\n    255.0 / 256.0 +\n    255.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n  const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n  vec4 float2rgba(const float value) {\n    // Make sure value is in the domain we can represent\n    float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n    // Decompose value in 32bit fixed point parts represented as\n    // uint8 rgba components. Decomposition uses the fractional part after multiplying\n    // by a power of 256 (this removes the bits that are represented in the previous\n    // component) and then converts the fractional part to 8bits.\n    vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n    // Convert uint8 values (from 0 to 255) to floating point representation for\n    // the shader\n    const float toU8AsFloat = 1.0 / 255.0;\n\n    return fixedPointU8 * toU8AsFloat;\n  }\n\n  void main() {\n    vec3 val = dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);\n\n    v_color = float2rgba(val.z / 25.0);\n\n    gl_Position = vec4(position * 2.0 - 1.0, 0.0, 1.0);\n  }\n  `,
"\n  precision highp float;\n\n  varying vec4 v_color;\n\n  void main() {\n    gl_FragColor \x3d v_color;\n  }\n  ",new Map([["position",0]]));var c=new Float32Array(6);y.encodeDoubleArray(r,c,3);var m=new Float32Array(6);y.encodeDoubleArray(g,m,3);a.useProgram(b);b.setUniform3f("u_highA",c[0],c[2],c[4]);b.setUniform3f("u_lowA",c[1],c[3],c[5]);b.setUniform3f("u_highB",m[0],m[2],m[4]);b.setUniform3f("u_lowB",m[1],m[3],m[5]);c=b;m=a.getBoundFramebufferObject();const {x:q,y:p,width:u,height:h}=a.getViewport();
a.bindFramebuffer(e);a.setViewport(0,0,1,1);a.bindVAO(k);a.drawArrays(x.PrimitiveType.TRIANGLE_STRIP,0,4);b=new Uint8Array(4);e.readPixels(0,0,1,1,x.PixelFormat.RGBA,x.PixelType.UNSIGNED_BYTE,b);c.dispose();k.dispose(!1);l.dispose();e.dispose();a.setViewport(q,p,u,h);a.bindFramebuffer(m);a=(r[2]-g[2])/25;e=D.unpackFloatRGBA(b);return Math.abs(a-e)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/doublePrecisionUtils":function(){define(["exports"],
function(z){const D=new Float32Array(2);z.decodeDoubleArray=function(C,B,y){for(let x=0;x<y;++x)B[x]=C[2*x]+C[2*x+1]};z.encodeDoubleArray=function(C,B,y){for(let x=0;x<y;++x)B[2*x]=C[x],B[2*x+1]=C[x]-B[2*x]};z.encodeDoubleHi=function(C,B){const y=C.length;for(let x=0;x<y;++x)D[0]=C[x],B[x]=D[0];return B};z.encodeDoubleLo=function(C,B){const y=C.length;for(let x=0;x<y;++x)D[0]=C[x],D[1]=C[x]-D[0],B[x]=D[1];return B};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/webgl/testFloatBufferBlend":function(){define("exports ../3d/webgl-engine/lib/OrderIndependentTransparency ./BufferObject ./context-util ./enums ./FramebufferObject ./renderState ./VertexArrayObject ./VertexElementDescriptor".split(" "),function(z,D,C,B,y,x,n,f,d){var a={exports:{}};(function(b){(function(e){e=e();void 0!==e&&(b.exports=e)})(function(){function e(h){if(null==p){p={};u={};for(var t in h)"number"==typeof h[t]&&(p[h[t]]=t,u[t]=h[t])}}function l(){if(null==p)throw"WebGLDebugUtils.init(ctx) not called";
}function k(h){l();var t=p[h];return void 0!==t?"gl."+t:"/*UNKNOWN WebGL ENUM*/ 0x"+h.toString(16)}function r(h,t,v,w){h=q[h];if(void 0!==h&&(h=h[t],void 0!==h&&h[v])){if("object"===typeof h[v]&&void 0!==h[v].enumBitwiseOr){t=h[v].enumBitwiseOr;v=0;h=[];for(var A=0;A<t.length;++A){var E=u[t[A]];0!==(w&E)&&(v|=E,h.push(k(E)))}return v===w?h.join(" | "):k(w)}return k(w)}return null===w?"null":void 0===w?"undefined":w.toString()}function g(h,t,v){h.__defineGetter__(v,function(){return t[v]});h.__defineSetter__(v,
function(w){t[v]=w})}function c(h,t,v,w){function A(J,I){return function(){v&&v(I,arguments);var N=J[I].apply(J,arguments),M=w.getError();0!=M&&(E[M]=!0,t(M,I,arguments));return N}}w=w||h;e(h);t=t||function(J,I,N){for(var M="",K=N.length,O=0;O<K;++O)M+=(0==O?"":", ")+r(I,K,O,N[O]);J="WebGL error "+k(J)+" in "+I+"("+M+")";window.console&&window.console.error?window.console.error(J):window.console&&window.console.log&&window.console.log(J)};var E={},G={},F;for(F in h)if("function"==typeof h[F])if("getExtension"!=
F)G[F]=A(h,F);else{var H=A(h,F);G[F]=function(){var J=H.apply(h,arguments);return c(J,t,v,w)}}else g(G,h,F);G.getError=function(){for(var J in E)if(E.hasOwnProperty(J)&&E[J])return E[J]=!1,J;return h.NO_ERROR};return G}function m(h){var t=h.getParameter(h.MAX_VERTEX_ATTRIBS),v=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,v);for(var w=0;w<t;++w)h.disableVertexAttribArray(w),h.vertexAttribPointer(w,4,h.FLOAT,!1,0,0),h.vertexAttrib1f(w,0);h.deleteBuffer(v);t=h.getParameter(h.MAX_TEXTURE_IMAGE_UNITS);
for(w=0;w<t;++w)h.activeTexture(h.TEXTURE0+w),h.bindTexture(h.TEXTURE_CUBE_MAP,null),h.bindTexture(h.TEXTURE_2D,null);h.activeTexture(h.TEXTURE0);h.useProgram(null);h.bindBuffer(h.ARRAY_BUFFER,null);h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,null);h.bindFramebuffer(h.FRAMEBUFFER,null);h.bindRenderbuffer(h.RENDERBUFFER,null);h.disable(h.BLEND);h.disable(h.CULL_FACE);h.disable(h.DEPTH_TEST);h.disable(h.DITHER);h.disable(h.SCISSOR_TEST);h.blendColor(0,0,0,0);h.blendEquation(h.FUNC_ADD);h.blendFunc(h.ONE,h.ZERO);
h.clearColor(0,0,0,0);h.clearDepth(1);h.clearStencil(-1);h.colorMask(!0,!0,!0,!0);h.cullFace(h.BACK);h.depthFunc(h.LESS);h.depthMask(!0);h.depthRange(0,1);h.frontFace(h.CCW);h.hint(h.GENERATE_MIPMAP_HINT,h.DONT_CARE);h.lineWidth(1);h.pixelStorei(h.PACK_ALIGNMENT,4);h.pixelStorei(h.UNPACK_ALIGNMENT,4);h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,!1);h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);h.UNPACK_COLORSPACE_CONVERSION_WEBGL&&h.pixelStorei(h.UNPACK_COLORSPACE_CONVERSION_WEBGL,h.BROWSER_DEFAULT_WEBGL);
h.polygonOffset(0,0);h.sampleCoverage(1,!1);h.scissor(0,0,h.canvas.width,h.canvas.height);h.stencilFunc(h.ALWAYS,0,4294967295);h.stencilMask(4294967295);h.stencilOp(h.KEEP,h.KEEP,h.KEEP);h.viewport(0,0,h.canvas.width,h.canvas.height);for(h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT|h.STENCIL_BUFFER_BIT);h.getError(););}var q={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},
getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,
6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT",
"DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},
p=null,u=null;return{init:e,mightBeEnum:function(h){l();return void 0!==p[h]},glEnumToString:k,glFunctionArgToString:r,glFunctionArgsToString:function(h,t){for(var v="",w=t.length,A=0;A<w;++A)v+=(0==A?"":", ")+r(h,w,A,t[A]);return v},makeDebugContext:c,makeLostContextSimulatingCanvas:function(h){function t(L){return"function"==typeof L?L:function(P){L.handleEvent(P)}}function v(){for(var L=Object.keys(V),P=0;P<L.length;++P)delete V[L]}function w(){++X;M||O==X&&h.loseContext()}function A(L,P){var Y=
L[P];return function(){w();if(!M)return Y.apply(L,arguments)}}function E(L){return{statusMessage:L,preventDefault:function(){aa=!0}}}function G(L){for(var P in L)"function"==typeof L[P]?I[P]=A(L,P):g(I,L,P);I.getError=function(){w();if(!M)for(var Q;Q=F.getError();)V[Q]=!0;for(Q in V)if(V[Q])return delete V[Q],Q;return I.NO_ERROR};var Y="createBuffer createFramebuffer createProgram createRenderbuffer createShader createTexture".split(" ");for(P=0;P<Y.length;++P){var U=Y[P];I[U]=function(Q){return function(){w();
if(M)return null;var W=Q.apply(L,arguments);W.__webglDebugContextLostId__=N;K.push(W);return W}}(L[U])}Y="getActiveAttrib getActiveUniform getBufferParameter getContextAttributes getAttachedShaders getFramebufferAttachmentParameter getParameter getProgramParameter getProgramInfoLog getRenderbufferParameter getShaderParameter getShaderInfoLog getShaderSource getTexParameter getUniform getUniformLocation getVertexAttrib".split(" ");for(P=0;P<Y.length;++P)U=Y[P],I[U]=function(Q){return function(){w();
return M?null:Q.apply(L,arguments)}}(I[U]);Y="isBuffer isEnabled isFramebuffer isProgram isRenderbuffer isShader isTexture".split(" ");for(P=0;P<Y.length;++P)U=Y[P],I[U]=function(Q){return function(){w();return M?!1:Q.apply(L,arguments)}}(I[U]);I.checkFramebufferStatus=function(Q){return function(){w();return M?I.FRAMEBUFFER_UNSUPPORTED:Q.apply(L,arguments)}}(I.checkFramebufferStatus);I.getAttribLocation=function(Q){return function(){w();return M?-1:Q.apply(L,arguments)}}(I.getAttribLocation);I.getVertexAttribOffset=
function(Q){return function(){w();return M?0:Q.apply(L,arguments)}}(I.getVertexAttribOffset);I.isContextLost=function(){return M};return I}var F,H=[],J=[];var I={};var N=1,M=!1,K=[],O=0,X=0,aa=!1,ba=0,V={};h.getContext=function(L){return function(){var P=L.apply(h,arguments);if(P instanceof WebGLRenderingContext){if(P!=F){if(F)throw"got different context";F=P;I=G(F)}return I}return P}}(h.getContext);(function(L){var P=L.addEventListener;L.addEventListener=function(Y,U,Q){switch(Y){case "webglcontextlost":H.push(t(U));
break;case "webglcontextrestored":J.push(t(U));break;default:P.apply(L,arguments)}}})(h);h.loseContext=function(){if(!M){M=!0;O=0;for(++N;F.getError(););v();V[F.CONTEXT_LOST_WEBGL]=!0;var L=E("context lost"),P=H.slice();setTimeout(function(){for(var Y=0;Y<P.length;++Y)P[Y](L);0<=ba&&setTimeout(function(){h.restoreContext()},ba)},0)}};h.restoreContext=function(){M&&J.length&&setTimeout(function(){if(!aa)throw"can not restore. webglcontestlost listener did not call event.preventDefault";for(var L=0;L<
K.length;++L){var P=K[L];P instanceof WebGLBuffer?F.deleteBuffer(P):P instanceof WebGLFramebuffer?F.deleteFramebuffer(P):P instanceof WebGLProgram?F.deleteProgram(P):P instanceof WebGLRenderbuffer?F.deleteRenderbuffer(P):P instanceof WebGLShader?F.deleteShader(P):P instanceof WebGLTexture&&F.deleteTexture(P)}m(F);M=!1;X=0;aa=!1;L=J.slice();P=E("context restored");for(var Y=0;Y<L.length;++Y)L[Y](P)},0)};h.loseContextInNCalls=function(L){if(M)throw"You can not ask a lost contet to be lost";O=X+L};h.getNumCalls=
function(){return X};h.setRestoreTimeout=function(L){ba=L};return h},resetToInitialState:m}})})(a);z.testFloatBufferBlend=function(b){var e,l,k;if(!b.gl)return!1;if(b.type===B.ContextType.WEBGL1){var r,g;return!(null==(r=b.capabilities.textureFloat)||!r.textureFloat||null==(g=b.capabilities.colorBufferFloat)||!g.textureFloat)}if(!((null==(e=b.capabilities.textureFloat)?0:e.textureFloat)&&(null==(l=b.capabilities.colorBufferFloat)?0:l.textureFloat)&&(null==(k=b.capabilities.colorBufferFloat)?0:k.floatBlend)))return!1;
e=new x.FramebufferObject(b,{colorTarget:y.TargetType.TEXTURE,depthStencilTarget:y.DepthStencilTargetType.NONE},{target:y.TextureType.TEXTURE_2D,wrapMode:y.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:y.PixelFormat.RGBA,dataType:y.PixelType.FLOAT,internalFormat:y.SizedPixelFormat.RGBA32F,samplingMode:y.TextureSamplingMode.NEAREST,width:1,height:1});l=C.BufferObject.createVertex(b,y.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1]));k=new f.VertexArrayObject(b,new Map([["a_pos",0]]),{geometry:[new d.VertexElementDescriptor("a_pos",
2,y.DataType.UNSIGNED_SHORT,0,4)]},{geometry:l});r=b.programCache.acquire("\n  precision highp float;\n  attribute vec2 a_pos;\n\n  void main() {\n    gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ","\n   precision highp float;\n\n   void main() {\n    gl_FragColor \x3d vec4(0.5, 0.5, 0.5, 0.5);\n   }\n  ",new Map([["a_pos",0]]));b.useProgram(r);g=b.getBoundFramebufferObject();const {x:c,y:m,width:q,height:p}=b.getViewport();b.bindFramebuffer(e);b.setViewport(0,0,1,1);b.bindVAO(k);b.drawArrays(y.PrimitiveType.TRIANGLE_STRIP,
0,4);var u=n.makePipelineState({blending:D.blendingAlpha});b.setPipelineState(u);b.drawArrays(y.PrimitiveType.TRIANGLE_STRIP,0,4);a.exports.init(b);u=b.gl.getError();b.setViewport(c,m,q,p);b.bindFramebuffer(g);r.dispose();k.dispose(!1);l.dispose();e.dispose();return 1282===u?(console.warn("Device claims support for WebGL extension EXT_float_blend but does not support it. Using fall back."),!1):!0};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/3d/webgl-engine/lib/OrderIndependentTransparency":function(){define(["exports",
"./basicInterfaces","../../../webgl/enums","../../../webgl/renderState"],function(z,D,C,B){const y=B.separateBlendingParams(C.BlendFactor.SRC_ALPHA,C.BlendFactor.ONE,C.BlendFactor.ONE_MINUS_SRC_ALPHA,C.BlendFactor.ONE_MINUS_SRC_ALPHA),x=B.simpleBlendingParams(C.BlendFactor.ONE,C.BlendFactor.ONE),n=B.simpleBlendingParams(C.BlendFactor.ZERO,C.BlendFactor.ONE_MINUS_SRC_ALPHA),f={factor:-1,units:-2};z.OITPolygonOffset=f;z.OITPolygonOffsetLimit=5E5;z.blendingAlpha=n;z.blendingColor=x;z.blendingDefault=
y;z.getOITPolygonOffset=function(d){return d?f:null};z.oitBlending=function(d){return d===D.TransparencyPassType.FrontFace?null:d===D.TransparencyPassType.Alpha?n:x};z.oitDepthTest=function(d,a=C.CompareFunction.LESS){return d===D.TransparencyPassType.NONE||d===D.TransparencyPassType.FrontFace?a:C.CompareFunction.LEQUAL};z.oitDepthWrite=function(d){return d===D.TransparencyPassType.FrontFace?B.defaultDepthWriteParams:null};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/webgl/testSamplerPrecision":function(){define("exports ../../core/Logger ./BufferObject ./enums ./FramebufferObject ./Texture ./VertexArrayObject ./VertexElementDescriptor".split(" "),function(z,D,C,B,y,x,n,f){const d=D.getLogger("esri.views.WebGLDriverTest");z.testSamplerPrecision=function(a){var b=new y.FramebufferObject(a,{colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.NONE},{target:B.TextureType.TEXTURE_2D,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:B.PixelFormat.RGBA,
dataType:B.PixelType.UNSIGNED_BYTE,samplingMode:B.TextureSamplingMode.NEAREST,width:1,height:1});const e=new Uint8Array(4),l=C.BufferObject.createVertex(a,B.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),k=new n.VertexArrayObject(a,new Map([["a_position",0]]),{geometry:[new f.VertexElementDescriptor("a_position",2,B.DataType.SHORT,0,4)]},{geometry:l}),r=a.programCache.acquire("\nprecision highp float;\nattribute vec2 a_pos;\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",new Map([["a_pos",0]]));a.useProgram(r);var g=new x.Texture(a,{target:B.TextureType.TEXTURE_2D,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,samplingMode:B.TextureSamplingMode.NEAREST,width:1,height:1},new Uint8Array([2,255,0,0]));r.setUniform1i("u_texture",0);a.bindTexture(g,0);g=a.getBoundFramebufferObject();a.bindFramebuffer(b);a.useProgram(r);
const {x:c,y:m,width:q,height:p}=a.getViewport();a.setViewport(0,0,1,1);a.bindVAO(k);a.drawArrays(B.PrimitiveType.TRIANGLE_STRIP,0,4);a.setViewport(c,m,q,p);b.readPixels(0,0,1,1,B.PixelFormat.RGBA,B.PixelType.UNSIGNED_BYTE,e);r.dispose();k.dispose(!1);l.dispose();b.dispose();(b=255!==e[0]||255!==e[1]||255!==e[2]||255!==e[3])&&d.warn(`A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. [${e[0]}.${e[1]}.${e[2]}.${e[3]}]`);
a.bindFramebuffer(g);return b};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/testSVGPremultipliedAlpha":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../2d/engine/webgl/DefaultVertexAttributeLayouts ./BufferObject ./enums ./FramebufferObject ./Texture ./VertexArrayObject".split(" "),function(z,D,C,B,y,x,n,f){function d(){d=D._asyncToGenerator(function*(a){const b=new Image;b.src="data:image/svg+xml,%3C%3Fxml version\x3d'1.0' encoding\x3d'UTF-8'%3F%3E%3Csvg width\x3d'5' height\x3d'5' version\x3d'1.1' viewBox\x3d'0 0 5 5' xmlns\x3d'http://www.w3.org/2000/svg'%3E%3Crect width\x3d'5' height\x3d'5' fill\x3d'%23f00' fill-opacity\x3d'.5'/%3E%3C/svg%3E%0A";
b.width=5;b.height=5;yield b.decode();if(!a.gl)return!0;const e=new x.FramebufferObject(a,{colorTarget:y.TargetType.TEXTURE,depthStencilTarget:y.DepthStencilTargetType.NONE},{target:y.TextureType.TEXTURE_2D,wrapMode:y.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:y.PixelFormat.RGBA,dataType:y.PixelType.UNSIGNED_BYTE,samplingMode:y.TextureSamplingMode.NEAREST,width:1,height:1}),l=B.BufferObject.createVertex(a,y.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),k=new f.VertexArrayObject(a,new Map([["a_pos",
0]]),C.Pos2us,{geometry:l}),r=a.programCache.acquire("\n  precision highp float;\n\n  attribute vec2 a_pos;\n  varying vec2 v_uv;\n\n  void main() {\n    v_uv \x3d a_pos;\n    gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n  }\n  ","\n  precision highp float;\n\n  varying vec2 v_uv;\n  uniform sampler2D u_texture;\n\n  void main() {\n    gl_FragColor \x3d texture2D(u_texture, v_uv);\n  }\n  ",new Map([["a_pos",0]]));a.useProgram(r);const g=new n.Texture(a,{dataType:y.PixelType.UNSIGNED_BYTE,
pixelFormat:y.PixelFormat.RGBA,preMultiplyAlpha:!1,wrapMode:y.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:y.TextureSamplingMode.LINEAR},b);a.bindTexture(g,0);r.setUniform1i("u_texture",0);const c=a.getBoundFramebufferObject(),{x:m,y:q,width:p,height:u}=a.getViewport();a.bindFramebuffer(e);a.setViewport(0,0,1,1);a.setClearColor(0,0,0,0);a.setBlendingEnabled(!1);a.clearSafe(y.ClearBufferBit.COLOR_BUFFER_BIT);a.bindVAO(k);a.drawArrays(y.PrimitiveType.TRIANGLE_STRIP,0,4);const h=new Uint8Array(4);e.readPixels(0,
0,1,1,y.PixelFormat.RGBA,y.PixelType.UNSIGNED_BYTE,h);r.dispose();k.dispose(!1);l.dispose();e.dispose();g.dispose();a.setViewport(m,q,p,u);a.bindFramebuffer(c);b.src="";return 255===h[0]});return d.apply(this,arguments)}z.testSVGPremultipliedAlpha=function(a){return d.apply(this,arguments)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/Capabilities":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ./DisjointTimerQuery ./DrawBuffers ./Instancing ./load ./LoseContext ./VertexArrayObjects".split(" "),
function(z,D,C,B,y,x,n,f){let d=function(){function a(b,e){this.gl=b;this._textureFloatLinear=this._fragDepth=this._shaderTextureLOD=this._standardDerivatives=this._depthTexture=null;this._disabledExtensions=e.disabledExtensions||{};this._debugWebGLExtensions=e.debugWebGLExtensions||{}}a.prototype.enable=function(b){return this[b]};D._createClass(a,[{key:"drawBuffers",get:function(){this._drawBuffers||(this._drawBuffers=B.load(this.gl,this._disabledExtensions));return this._drawBuffers}},{key:"instancing",
get:function(){this._instancing||(this._instancing=y.load(this.gl));return this._instancing}},{key:"vao",get:function(){this._vertexArrayObject||(this._vertexArrayObject=f.load(this.gl,this._disabledExtensions));return this._vertexArrayObject}},{key:"compressedTextureETC",get:function(){this._compressedTextureETC||(this._compressedTextureETC=x.loadCompressedTextureETC(this.gl,this._disabledExtensions));return this._compressedTextureETC}},{key:"compressedTextureS3TC",get:function(){this._compressedTextureS3TC||
(this._compressedTextureS3TC=x.loadCompressedTextureS3TC(this.gl,this._disabledExtensions));return this._compressedTextureS3TC}},{key:"textureFilterAnisotropic",get:function(){this._textureFilterAnisotropic||(this._textureFilterAnisotropic=x.loadTextureFilterAnisotropicCapability(this.gl,this._disabledExtensions));return this._textureFilterAnisotropic}},{key:"disjointTimerQuery",get:function(){this._disjointTimerQuery||(this._disjointTimerQuery=C.createDisjointTimerQuery(this.gl,this._disabledExtensions));
return this._disjointTimerQuery}},{key:"textureFloat",get:function(){this._textureFloat||(this._textureFloat=x.loadTextureFloat(this.gl,this._disabledExtensions));return this._textureFloat}},{key:"colorBufferFloat",get:function(){this._colorBufferFloat||(this._colorBufferFloat=x.loadColorBufferFloat(this.gl,this._disabledExtensions));return this._colorBufferFloat}},{key:"blendMinMax",get:function(){this._minMaxBlending||(this._minMaxBlending=x.loadMinMaxBlending(this.gl,this._disabledExtensions));
return this._minMaxBlending}},{key:"depthTexture",get:function(){null===this._depthTexture&&(this._depthTexture=x.loadBooleanExtension(this.gl,this._disabledExtensions,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]));return this._depthTexture}},{key:"standardDerivatives",get:function(){null===this._standardDerivatives&&(this._standardDerivatives=x.loadBooleanExtension(this.gl,this._disabledExtensions,"standardDerivatives",!0,["OES_standard_derivatives"]));
return this._standardDerivatives}},{key:"shaderTextureLOD",get:function(){null===this._shaderTextureLOD&&(this._shaderTextureLOD=x.loadBooleanExtension(this.gl,this._disabledExtensions,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]));return this._shaderTextureLOD}},{key:"fragDepth",get:function(){null===this._fragDepth&&(this._fragDepth=x.loadBooleanExtension(this.gl,this._disabledExtensions,"fragDepth",!0,["EXT_frag_depth"]));return this._fragDepth}},{key:"loseContext",get:function(){this._loseContext||
(this._loseContext=n.load(this.gl,this._debugWebGLExtensions));return this._loseContext}},{key:"textureNorm16",get:function(){this._textureNorm16||(this._textureNorm16=x.loadTextureNorm16(this.gl,this._disabledExtensions));return this._textureNorm16}},{key:"textureFloatLinear",get:function(){null===this._textureFloatLinear&&(this._textureFloatLinear=x.loadBooleanExtension(this.gl,this._disabledExtensions,"textureFloatLinear",!1,["OES_texture_float_linear"]));return this._textureFloatLinear}}]);return a}();
z.Capabilities=d;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/DrawBuffers":function(){define(["exports","./isWebGL2Context"],function(z,D){z.load=function(C,B){return B.disjointTimerQuery?null:D(C)?{drawBuffers:C.drawBuffers.bind(C),MAX_DRAW_BUFFERS:C.MAX_DRAW_BUFFERS,MAX_COLOR_ATTACHMENTS:C.MAX_COLOR_ATTACHMENTS}:B.drawBuffers?null:(C=C.getExtension("WEBGL_draw_buffers"))?{drawBuffers:C.drawBuffersWEBGL.bind(C),MAX_DRAW_BUFFERS:C.MAX_DRAW_BUFFERS_WEBGL,
MAX_COLOR_ATTACHMENTS:C.MAX_COLOR_ATTACHMENTS_WEBGL}:null};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/Instancing":function(){define(["exports","./isWebGL2Context"],function(z,D){z.load=function(C){return D(C)?{drawArraysInstanced:C.drawArraysInstanced.bind(C),drawElementsInstanced:C.drawElementsInstanced.bind(C),vertexAttribDivisor:C.vertexAttribDivisor.bind(C)}:(C=C.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:C.drawArraysInstancedANGLE.bind(C),
drawElementsInstanced:C.drawElementsInstancedANGLE.bind(C),vertexAttribDivisor:C.vertexAttribDivisorANGLE.bind(C)}:null};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/load":function(){define(["exports","./isWebGL2Context"],function(z,D){z.loadBooleanExtension=function(C,B,y,x,n){if(x&&D(C))return!0;if(B[y])return!1;for(const f of n)if(C.getExtension(f))return!0;return!1};z.loadColorBufferFloat=function(C,B){if(D(C)){var y=
!B.colorBufferHalfFloat&&C.getExtension("EXT_color_buffer_half_float")||!B.colorBufferFloat&&C.getExtension("EXT_color_buffer_float"),x=!B.colorBufferFloat&&C.getExtension("EXT_color_buffer_float");B=!B.floatBlend&&!B.colorBufferFloat&&C.getExtension("EXT_float_blend");return y||x||B?{textureFloat:!!x,textureHalfFloat:!!y,floatBlend:!!B,R16F:C.R16F,RG16F:C.RG16F,RGBA16F:C.RGBA16F,R32F:C.R32F,RG32F:C.RG32F,RGBA32F:C.RGBA32F,R11F_G11F_B10F:C.R11F_G11F_B10F,RGB16F:C.RGB16F}:null}return C instanceof WebGLRenderingContext?
(y=!B.colorBufferHalfFloat&&C.getExtension("EXT_color_buffer_half_float"),x=!B.colorBufferFloat&&C.getExtension("WEBGL_color_buffer_float"),C=!B.floatBlend&&!B.colorBufferFloat&&C.getExtension("EXT_float_blend"),y||x||C?{textureFloat:!!x,textureHalfFloat:!!y,floatBlend:!!C,RGBA16F:y?y.RGBA16F_EXT:void 0,RGB16F:y?y.RGB16F_EXT:void 0,RGBA32F:x?x.RGBA32F_EXT:void 0}:null):null};z.loadCompressedTextureETC=function(C,B){return B.compressedTextureETC?null:(C=C.getExtension("WEBGL_compressed_texture_etc"))?
{COMPRESSED_R11_EAC:C.COMPRESSED_R11_EAC,COMPRESSED_SIGNED_R11_EAC:C.COMPRESSED_SIGNED_R11_EAC,COMPRESSED_RG11_EAC:C.COMPRESSED_RG11_EAC,COMPRESSED_SIGNED_RG11_EAC:C.COMPRESSED_SIGNED_RG11_EAC,COMPRESSED_RGB8_ETC2:C.COMPRESSED_RGB8_ETC2,COMPRESSED_SRGB8_ETC2:C.COMPRESSED_SRGB8_ETC2,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:C.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:C.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_RGBA8_ETC2_EAC:C.COMPRESSED_RGBA8_ETC2_EAC,
COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:C.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC}:null};z.loadCompressedTextureS3TC=function(C,B){return B.compressedTextureS3TC?null:(C=C.getExtension("WEBGL_compressed_texture_s3tc"))?{COMPRESSED_RGB_S3TC_DXT1:C.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:C.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:C.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:C.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null};z.loadMinMaxBlending=function(C,B){return D(C)?{MIN:C.MIN,
MAX:C.MAX}:B.blendMinMax?null:(C=C.getExtension("EXT_blend_minmax"))?{MIN:C.MIN_EXT,MAX:C.MAX_EXT}:null};z.loadTextureFilterAnisotropicCapability=function(C,B){return B.textureFilterAnisotropic?null:(C=C.getExtension("EXT_texture_filter_anisotropic")||C.getExtension("MOZ_EXT_texture_filter_anisotropic")||C.getExtension("WEBKIT_EXT_texture_filter_anisotropic"))?{MAX_TEXTURE_MAX_ANISOTROPY:C.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:C.TEXTURE_MAX_ANISOTROPY_EXT}:null};z.loadTextureFloat=
function(C,B){if(D(C))return{textureFloat:!0,textureFloatLinear:!B.textureFloatLinear&&!!C.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!0,HALF_FLOAT:C.HALF_FLOAT,R16F:C.R16F,RG16F:C.RG16F,RGBA16F:C.RGBA16F,R32F:C.R32F,RG32F:C.RG32F,RGBA32F:C.RGBA32F,R11F_G11F_B10F:C.R11F_G11F_B10F,RGB16F:C.RGB16F};if(C instanceof WebGLRenderingContext){const y=!B.textureHalfFloat&&C.getExtension("OES_texture_half_float");return{textureFloat:!B.textureFloat&&!!C.getExtension("OES_texture_float"),
textureFloatLinear:!B.textureFloatLinear&&!!C.getExtension("OES_texture_float_linear"),textureHalfFloat:!!y,textureHalfFloatLinear:!B.textureHalfFloatLinear&&!!C.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:y?y.HALF_FLOAT_OES:void 0}}return null};z.loadTextureNorm16=function(C,B){return!D(C)||B.textureNorm16?null:(C=C.getExtension("EXT_texture_norm16"))?{R16:C.R16_EXT,RG16:C.RG16_EXT,RGB16:C.RGB16_EXT,RGBA16:C.RGBA16_EXT,R16_SNORM:C.R16_SNORM_EXT,RG16_SNORM:C.RG16_SNORM_EXT,RGB16_SNORM:C.RGB16_SNORM_EXT,
RGBA16_SNORM:C.RGBA16_SNORM_EXT}:null};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/LoseContext":function(){define(["exports"],function(z){z.load=function(D,C){const B=C.loseContext&&D.getExtension("WEBGL_lose_context");return B?{loseRenderingContext:()=>B.loseContext()}:null};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/webgl/capabilities/VertexArrayObjects":function(){define(["exports",
"./isWebGL2Context"],function(z,D){z.load=function(C,B){return D(C)?{createVertexArray:C.createVertexArray.bind(C),deleteVertexArray:C.deleteVertexArray.bind(C),bindVertexArray:C.bindVertexArray.bind(C)}:B.vao?null:(C=C.getExtension("OES_vertex_array_object")||C.getExtension("MOZ_OES_vertex_array_object")||C.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:C.createVertexArrayOES.bind(C),deleteVertexArray:C.deleteVertexArrayOES.bind(C),bindVertexArray:C.bindVertexArrayOES.bind(C)}:
null};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/LabelManager":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Error ../../core/HandleOwner ../../core/has ../../core/Logger ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./engine/webgl/collisions/CollisionEngine".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l){n.getLogger("esri.views.2d.layers.labels.LabelManager");C=function(k){function r(c){c=k.call(this,c)||this;c._applyVisibilityPassThrottled=f.throttle(c._applyVisibilityPass,32,z._assertThisInitialized(c));c.lastUpdateId=-1;c.updateRequested=!1;c.view=null;return c}z._inheritsLoose(r,k);var g=r.prototype;g.initialize=function(){this.collisionEngine=new l.CollisionEngine};g.destroy=function(){this.collisionEngine=null;this._applyVisibilityPassThrottled.remove();this._applyVisibilityPassThrottled=
null};g.update=function(c){this._applyVisibilityPassThrottled(c)};g.viewChange=function(){this.requestUpdate()};g.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())};g.processUpdate=function(c){this._set("updateParameters",c);this.updateRequested&&(this.updateRequested=!1,this.update(c))};g._applyVisibilityPass=function(c){try{const m=this.view.featuresTilingScheme.getClosestInfoForScale(c.state.scale).level;this.collisionEngine.run(this.view.allLayerViews.items,
c,m)}catch(m){}};z._createClass(r,[{key:"updating",get:function(){return this.updateRequested}}]);return r}(y.HandleOwnerMixin(C));D.__decorate([d.property()],C.prototype,"updateRequested",void 0);D.__decorate([d.property({readOnly:!0})],C.prototype,"updateParameters",void 0);D.__decorate([d.property()],C.prototype,"updating",null);D.__decorate([d.property()],C.prototype,"view",void 0);return C=D.__decorate([e.subclass("esri.views.2d.layers.labels.LabelManager")],C)})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("exports ../../../../../core/maybe ../../../../../core/screenUtils ../definitions ./CollisionGrid ./visualVariableSimpleUtils".split(" "),
function(z,D,C,B,y,x){function n(b,e){const l=[];b.forEachTile(k=>l.push(k));l.sort((k,r)=>k.instanceId-r.instanceId);l.forEach(k=>{D.isSome(k.labelMetrics)&&k.isReady&&e(k,k.labelMetrics.getCursor())})}function f(b){return e=>C.pt2px(x.getSizeForValueSimple(e,b))}function d(b){for(const e of b)if(b="featureReduction"in e&&e.featureReduction&&"labelingInfo"in e.featureReduction&&e.featureReduction,b=(null==b?void 0:b.labelingInfo)||[],b=[...e.labelingInfo||[],...b],e.labelsVisible&&b.length&&b.some(l=>
"none"===l.deconflictionStrategy))return!0;return!1}let a=function(){function b(){}var e=b.prototype;e.run=function(l,k,r){const g=[];for(let p=l.length-1;0<=p;p--)a:{var c=void 0,m=g,q=l[p];if(!q.layer||"feature"!==q.layer.type&&"csv"!==q.layer.type&&"geojson"!==q.layer.type&&"ogc-feature"!==q.layer.type&&"stream"!==q.layer.type&&"subtype-group"!==q.layer.type&&"wfs"!==q.layer.type)break a;const u=q.layer.geometryType,h=!d("subtype-group"===q.layer.type?q.layer.sublayers.items:[q.layer]),t={};if("subtype-group"!==
q.layer.type){if("heatmap"===(null==(c=q.tileRenderer)?void 0:c.type))break a;b:{c=q.layer.renderer;if(c="visualVariables"in c&&c.visualVariables)for(const v of c)if("size"===v.type){c=f(v);break b}c=null}t[0]=c}c=q.tileRenderer;D.isNone(c)||m.push({tileRenderer:c,vvEvaluators:t,deconflictionEnabled:h,geometryType:u,visible:q.layer.visible&&!q.suspended})}this._transformMetrics(g,k);this._runCollision(g,k,r)};e._runCollision=function(l,k,r){const [g,c]=k.state.size;k=new y.CollisionBitsetGrid(g*k.pixelRatio,
c*k.pixelRatio);for(const {tileRenderer:m,deconflictionEnabled:q,visible:p}of l){const u=m.featuresView.attributeView;q?p?(this._prepare(m),this._collideVisible(k,m,r),this._collideInvisible(k,m)):n(m,(h,t)=>{for(;t.nextId();)u.setLabelMinZoom(t.id,255)}):n(m,(h,t)=>{for(;t.nextId();)u.setLabelMinZoom(t.id,0)})}};e._isFiltered=function(l,k,r){k=k.getFilterFlags(l);l=!r.hasFilter||!!(k&B.FILTER_FLAG_0);r=D.isNone(r.featureEffect)||r.featureEffect.excludedLabelsVisible||!!(k&B.EFFECT_FLAG_0);return!(l&&
r)};e._prepare=function(l){const k=l.featuresView.attributeView,r=new Set;n(l,(g,c)=>{for(;c.nextId();)r.has(c.id)||(r.add(c.id),this._isFiltered(c.id,k,l.layerView)?k.setLabelMinZoom(c.id,254):0!==k.getLabelMinZoom(c.id)?k.setLabelMinZoom(c.id,255):k.setLabelMinZoom(c.id,0))})};e._collideVisible=function(l,k,r){const g=k.featuresView.attributeView,c=new Set;n(k,(m,q)=>{for(;q.nextId();)if(!c.has(q.id))if(m.key.level!==r)g.setLabelMinZoom(q.id,254);else if(0===g.getLabelMinZoom(q.id))switch(l.insertMetrics(q)){case y.HAS_COLLISION:g.setLabelMinZoom(q.id,
254);c.add(q.id);break;case y.NONE:g.setLabelMinZoom(q.id,0),c.add(q.id)}})};e._collideInvisible=function(l,k){const r=k.featuresView.attributeView,g=new Set;n(k,(c,m)=>{for(;m.nextId();)if(!g.has(m.id)&&255===r.getLabelMinZoom(m.id))switch(l.insertMetrics(m)){case y.HAS_COLLISION:r.setLabelMinZoom(m.id,255);g.add(m.id);break;case y.NONE:r.setLabelMinZoom(m.id,0),g.add(m.id)}})};e._transformMetrics=function(l,k){for(const {tileRenderer:r,geometryType:g,vvEvaluators:c}of l)n(r,(m,q)=>{const p=r.featuresView.attributeView;
m=m.transforms.labelMat2d;m[4]=Math.round(m[4]);m[5]=Math.round(m[5]);const u=m[4],h=m[5],t="polyline"===g;for(;q.next();){const F=q.boundsCount,H=q.anchorX,J=q.anchorY;var v=q.size,w=c[0];if(D.isSome(w)){var A=p.getVVSize(q.id);w=w(A);v=isNaN(w)||null==w||Infinity===w?v:w}w=v/2*q.directionX;v=v/2*q.directionY;for(A=0;A<F;A++){var E=H,G=q.anchorY;t?(E=E+q.boundsX(A)+w,G=G+q.boundsY(A)+v,k.state.rotation?(E=m[0]*E+m[2]*G+m[4],G=m[1]*E+m[3]*G+m[5]):(E+=u,G+=h),q.setBoundsComputedAnchorX(A,Math.floor(E)),
q.setBoundsComputedAnchorY(A,Math.floor(G))):(k.state.rotation?(E=m[0]*H+m[2]*J+m[4],G=m[1]*H+m[3]*J+m[5]):(E+=u,G+=h),E=E+q.boundsX(A)+w,G=G+q.boundsY(A)+v,q.setBoundsComputedAnchorX(A,E),q.setBoundsComputedAnchorY(A,G))}}})};return b}();z.CollisionEngine=a;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["exports","../../../../../core/mathUtils","../definitions","../../../layers/features/support/StaticBitSet"],
function(z,D,C,B){let y=function(){function n(d,a){this.width=d;this.height=a;d=Math.ceil(d/1);a=Math.ceil(a/1);this._cols=d;this._rows=a;this._cells=B.StaticBitSet.create(d*a)}var f=n.prototype;f.insertMetrics=function(d){const a=this._hasCollision(d);0===a&&this._markMetrics(d);return a};f.getCellId=function(d,a){return d+a*this._cols};f.has=function(d){return this._cells.has(d)};f.hasRange=function(d,a){return this._cells.hasRange(d,a)};f.set=function(d){this._cells.set(d)};f.setRange=function(d,
a){this._cells.setRange(d,a)};f._hasCollision=function(d){const a=d.id;let b=0,e=0;d.save();do{const l=d.boundsCount;b+=l;for(let k=0;k<l;k++){const r=d.boundsComputedAnchorX(k),g=d.boundsComputedAnchorY(k),c=d.boundsWidth(k)+2,m=d.boundsHeight(k)+2;switch(this._collide(r,g,c,m)){case 2:return 2;case 1:e++}}}while(d.peekId()===a&&d.next());d.restore();return b===e?1:0};f._collide=function(d,a,b,e){d-=b/2;a-=e/2;b=d+b;var l=a+e;if(0>b||0>l||d>this.width||a>this.height)return 1;e=D.clamp(Math.floor(d/
1),0,this._cols);var k=D.clamp(Math.floor(a/1),0,this._rows);d=D.clamp(Math.ceil(b/1),0,this._cols);a=D.clamp(Math.ceil(l/1),0,this._rows);for(b=k;b<=a;b++)for(l=e;l<=d;l++)if(k=this.getCellId(l,b),this.has(k))return 2;return 0};f._mark=function(d,a,b,e){d-=b/2;a-=e/2;b=d+b;var l=a+e;e=D.clamp(Math.floor(d/1),0,this._cols);var k=D.clamp(Math.floor(a/1),0,this._rows);d=D.clamp(Math.ceil(b/1),0,this._cols);a=D.clamp(Math.ceil(l/1),0,this._rows);for(b=k;b<=a;b++)for(l=e;l<=d;l++)k=this.getCellId(l,b),
this.set(k);return!1};f._markMetrics=function(d){const a=d.id;do{const b=d.boundsCount;for(let e=0;e<b;e++){const l=d.boundsComputedAnchorX(e),k=d.boundsComputedAnchorY(e),r=d.boundsWidth(e)+2,g=d.boundsHeight(e)+2;this._mark(l,k,r,g)}}while(d.peekId()===a&&d.next())};return n}(),x=function(){function n(d,a=2){this._bucketSize=d;this._rowsLength=C.TILE_SIZE/d;this._colsLength=C.TILE_SIZE/d;this._elementsPerBucket=a;this._grid=this._initGrid()}var f=n.prototype;f.checkOverlap=function(d,a){d=Math.floor(d/
this._bucketSize);a=Math.floor(a/this._bucketSize);return 0>d||d>=this._rowsLength||0>a||a>=this._colsLength?!0:this._grid[a*this._colsLength+d]>=this._elementsPerBucket};f.markUsed=function(d,a){this._grid[Math.floor(a/this._bucketSize)*this._colsLength+Math.floor(d/this._bucketSize)]+=1};f.reset=function(){this._grid=this._initGrid()};f._initGrid=function(){return new Uint8Array(this._rowsLength*this._colsLength)};return n}();z.CollisionBitsetGrid=y;z.CollisionGrid=x;z.HAS_COLLISION=2;z.NONE=0;
z.OUTSIDE_EXTENT=1;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports"],function(z){let D=function(){function C(y,x){this._mask=0;this._buf=y;this._mask=x}C.fromBuffer=function(y,x){return new C(y,x)};C.create=function(y,x=4294967295){y=new Uint32Array(Math.ceil(y/32));return new C(y,x)};var B=C.prototype;B._getIndex=function(y){return Math.floor(y/32)};B.has=function(y){y&=this._mask;
return!!(this._buf[this._getIndex(y)]&1<<y%32)};B.hasRange=function(y,x){for(;y%32&&y!==x;){if(this.has(y))return!0;y++}for(;x%32&&y!==x;){if(this.has(y))return!0;x--}if(y===x)return!1;for(y/=32;y!==x/32;y++)if(this._buf[y])return!0;return!1};B.set=function(y){y&=this._mask;const x=this._getIndex(y);this._buf[x]|=1<<y%32};B.setRange=function(y,x){for(;y%32&&y!==x;)this.set(y++);for(;x%32&&y!==x;)this.set(x--);if(y!==x)for(y/=32;y!==x/32;y++)this._buf[y]=4294967295};B.unset=function(y){y&=this._mask;
const x=this._getIndex(y);this._buf[x]&=4294967295^1<<y%32};B.resize=function(y){const x=this._buf;y=new Uint32Array(Math.ceil(y/32));y.set(x);this._buf=y};B.or=function(y){for(let x=0;x<this._buf.length;x++)this._buf[x]|=y._buf[x];return this};B.and=function(y){for(let x=0;x<this._buf.length;x++)this._buf[x]&=y._buf[x];return this};B.xor=function(y){for(let x=0;x<this._buf.length;x++)this._buf[x]^=y._buf[x];return this};B.ior=function(y){for(let x=0;x<this._buf.length;x++)this._buf[x]|=~y._buf[x];
return this};B.iand=function(y){for(let x=0;x<this._buf.length;x++)this._buf[x]&=~y._buf[x];return this};B.ixor=function(y){for(let x=0;x<this._buf.length;x++)this._buf[x]^=~y._buf[x];return this};B.any=function(){for(let y=0;y<this._buf.length;y++)if(this._buf[y])return!0;return!1};B.copy=function(y){for(let x=0;x<this._buf.length;x++)this._buf[x]=y._buf[x];return this};B.clone=function(){return new C(this._buf.slice(),this._mask)};B.clear=function(){for(let y=0;y<this._buf.length;y++)this._buf[y]=
0};B.forEachSet=function(y){for(let x=0;x<this._buf.length;x++){let n=this._buf[x],f=32*x;if(n)for(;n;)n&1&&y(f),n>>>=1,f++}};B.countSet=function(){let y=0;this.forEachSet(x=>{y++});return y};return C}();z.StaticBitSet=D;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["exports","../../../../../core/mathUtils","../../../../../renderers/support/lengthUtils","../../../../../renderers/visualVariables/support/sizeVariableUtils"],
function(z,D,C,B){function y(d,a){switch(a.transformationType){case B.TransformationType.Additive:var b=x(a.minSize,d);return d+=b||a.minDataValue;case B.TransformationType.Constant:return b=(b=a.stops)&&b.length&&b[0].size,null==b&&(b=a.minSize),d=x(b,d);case B.TransformationType.ClampedLinear:b=(d-a.minDataValue)/(a.maxDataValue-a.minDataValue);var e=x(a.minSize,d),l=x(a.maxSize,d);d=d<=a.minDataValue?e:d>=a.maxDataValue?l:e+b*(l-e);return d;case B.TransformationType.Proportional:return b=d/a.minDataValue,
e=x(a.minSize,d),d=x(a.maxSize,d),d=D.clamp(b*e,e,d);case B.TransformationType.Stops:{const [k,r,g]=n(d,a.cache.ipData);k===r?d=x(a.stops[k].size,d):(b=x(a.stops[k].size,d),d=x(a.stops[r].size,d),d=b+(d-b)*g)}return d;case B.TransformationType.RealWorldSize:{b=C.meterIn[a.valueUnit];e=x(a.minSize,d);l=x(a.maxSize,d);({valueRepresentation:a}=a);let k=null;k="area"===a?2*Math.sqrt(d/f)/b:"radius"===a||"distance"===a?2*d/b:d/b;d=D.clamp(k,e,l)}return d;case B.TransformationType.Identity:return d;case B.TransformationType.Unknown:return null}}
function x(d,a){return"number"===typeof d?d:y(a,d)}function n(d,a){if(a){var b=0,e=a.length-1;a.some((l,k)=>{if(d<l)return e=k,!0;b=k;return!1});return[b,e,(d-a[b])/(a[e]-a[b])]}}const f=Math.PI;z.getSizeForValueSimple=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/graphics/GraphicsView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/BidiText ../../../../core/HandleOwner ../../../../core/has ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/coordsUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtilsSync ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/data/projectionSupport ../../../../symbols/cim/CIMSymbolHelper ../../../../symbols/support/defaults ../../engine/webgl/definitions ../../engine/webgl/enums ../../engine/webgl/GraphicTile ../../engine/webgl/TileData ../../engine/webgl/WGLDisplayObject ../../engine/webgl/mesh/MeshData ../../engine/webgl/mesh/factories/WGLMeshFactory ../../engine/webgl/mesh/templates/WGLTemplateStore ../../engine/webgl/util/Matcher ../features/schemaUtils ../features/support/AttributeStore ../features/support/ComputedAttributeStorage ../features/support/GraphicsReader ./GraphicStore ./graphicsUtils ../support/cimSymbolUtils ../../../layers/GraphicsView ../../../webgl/capabilities ../features/createSymbolSchema".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g,c,m,q,p,u,h,t,v,w,A,E,G,F,H,J,I,N,M,K,O,X,aa,ba,V,L){function P(U,Q,W){if(W.has(U))return W.get(U);Q={tile:Q,addedOrModified:[],removed:[]};W.set(U,Q);return Q}const Y=x("esri-2d-graphic-debug");C=function(U){function Q(R){R=U.call(this,R)||this;R._storage=new M.ComputedAttributeStorage;R._displayIds=new Map;R._controller=new AbortController;R._tiles=new Map;R._graphicStoreUpdate=!1;R._graphicsSet=new Set;R._matcher=Promise.resolve(null);R._tileUpdateSet=new Set;
R._tilesToUpdate=new Map;R._graphicIdToAbortController=new Map;R._attached=!1;R._updatingGraphicsTimer=null;R._hashToExpandedSymbol=new Map;R._hashToExpandedSymbolPromise=new Map;R._hashToCIMSymbolPromise=new Map;R._hashToCIM=new Map;R._processing=!1;R._needsProcessing=!1;R._pendingUpdate={added:new Set,updated:new Set,removed:new Set};R.lastUpdateId=-1;R.updateRequested=!1;R.graphicUpdateHandler=R.graphicUpdateHandler.bind(z._assertThisInitialized(R));return R}z._inheritsLoose(Q,U);var W=Q.prototype;
W.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating"));this._controller.abort();this.container.destroy();this._set("graphics",null);this._graphicStore.clear();this._attributeStore=null;this._hashToExpandedSymbol.clear();this.renderer=this.view=null;this._hashToCIM.clear();this._hashToCIMSymbolPromise.clear();this._hashToExpandedSymbolPromise.clear()};W._createMatcher=function(R,S,Z){R&&(R=I.createMatcherSchema({indexCount:0,
fields:{}},"feature",R),this._matcher=J.createMatcher(R,S,null,Z))};W._createDisplayId=function(R){this._displayIds.has(R)||this._displayIds.set(R,this._storage.createDisplayId());return this._displayIds.get(R)};W.initialize=function(){this._attributeStore=new N({type:"local",initialize:S=>Promise.resolve(this.container.attributeView.initialize(S)),update:S=>this.container.attributeView.requestUpdate(S),render:()=>this.container.requestRender()},V.getWebGLCapabilities("2d"),()=>this.notifyChange("updating"));
this.container.hasHighlight=()=>this._attributeStore.hasHighlight;const R=new H.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),this.view.featuresTilingScheme.tileInfo);this._graphicStore=new O(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,S=>{this._createDisplayId(S.uid);this._setFilterState(S.uid,S.visible)},S=>{const Z=this._displayIds.get(S.uid);this._displayIds.delete(S.uid);this._storage.releaseDisplayId(Z)},this._hashToCIM);this._meshFactory=
new F.WGLMeshFactory(null,this.uid,R);this._templateStore=R;this.handles.add([d.watch(()=>this.renderer,S=>{this._createMatcher(S,R,this.container.stage.resourceManager);for(const Z of this.graphics)this._pendingUpdate.updated.add(Z);this.requestUpdate()}),this.view.graphicsTileStore.on("update",S=>this._onTileUpdate(S)),this.container.on("attach",()=>{Y&&this.container.enableRenderingBounds(()=>this._graphicStore.getAllBounds());0<this.graphics.items.length&&this._graphicsChangeHandler({target:this.graphics,
added:this.graphics.items,removed:[],moved:[]});this.handles.add(this.graphics.on("change",Z=>this._graphicsChangeHandler(Z)),"graphics");const S=this.container.stage.resourceManager;this._createMatcher(this.renderer,R,S);this._graphicStore.setResourceManager(S);this._attached=!0;this.notifyChange("updating")})]);this._onTileUpdate({added:this.view.graphicsTileStore.tiles,removed:[]})};W.hitTest=function(R){if(!this.view||!this.view.position)return[];const {resolution:S,rotation:Z}=this.view.state;
return this._graphicStore.hitTest(R.x,R.y,2,S,Z)};W.update=function(R){f.throwIfAborted(this._controller.signal);({resolution:R}=R.state);this._graphicStore.updateLevel(R);this._graphicStoreUpdate=!0;this.updateRequested=!1;0<this._pendingUpdate.updated.size&&(this._processing?this._needsProcessing=!0:this._updateGraphics())};W.viewChange=function(){this.requestUpdate()};W.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.requestUpdateCallback())};W.processUpdate=function(R){this.updateRequested&&
(this.updateRequested=!1,this.update(R))};W.graphicUpdateHandler=function(R){const {graphic:S,property:Z,newValue:ca}=R;switch(Z){case "attributes":case "geometry":case "symbol":this._pendingUpdate.updated.add(S);this.requestUpdate();break;case "visible":this._setFilterState(S.uid,ca),this._attributeStore.sendUpdates()}};W.setHighlight=function(R){const S=R.map(Z=>this._displayIds.get(Z));this._attributeStore.setHighlight(R,S)};W._getIntersectingTiles=function(R){R=this._graphicStore.getBounds(R);
if(!R||0===r.width(R)||0===r.height(R))return[];const S=X.intersectingInternationalDateline(R,this.view.spatialReference);return n.isSome(S)?[...new Set([...this.view.graphicsTileStore.boundsIntersections(S[0]),...this.view.graphicsTileStore.boundsIntersections(S[1])])]:this.view.graphicsTileStore.boundsIntersections(R)};W._updateTile=function(){var R=z._asyncToGenerator(function*(S){f.throwIfAborted(this._controller.signal);const Z=S.tile;var ca=this._getGraphicsData(this._templateStore,Z,S.addedOrModified);
ca=yield this._processGraphics(Z,ca);f.throwIfAborted(this._controller.signal);this._patchTile(Z.key,{type:"update",addOrUpdate:ca,remove:S.removed,end:!0,clear:!1,sort:!1});return ca});return function(S){return R.apply(this,arguments)}}();W._patchTile=function(R,S){this._tiles.has(R)&&(R=this._tiles.get(R),this.container.onTileData(R,S),this.container.requestRender())};W._graphicsChangeHandler=function(R){const S=this._pendingUpdate;for(const Z of R.added)S.added.add(Z);for(const Z of R.moved)S.updated.add(Z);
for(const Z of R.removed)this._pendingUpdate.added.has(Z)?S.added.delete(Z):S.removed.add(Z);this._processing?this._needsProcessing=!0:this._updateGraphics()};W._getGraphicsToUpdate=function(){const R={added:[],removed:[],updated:[]};if(!this.graphics)return R;const S=this._pendingUpdate;for(const Z of this.graphics.items)S.added.has(Z)?R.added.push(Z):S.updated.has(Z)&&R.updated.push(Z);for(const Z of S.removed)this._graphicStore.has(Z)&&R.removed.push(Z);S.added.clear();S.removed.clear();S.updated.clear();
return R};W._updateGraphics=function(){var R=z._asyncToGenerator(function*(){this._processing=!0;const {added:S,removed:Z,updated:ca}=this._getGraphicsToUpdate(),ia=this._tilesToUpdate;try{if(!this._graphicStoreUpdate){var {resolution:T}=this.view.state;this._graphicStore.updateLevel(T)}T=[];const ea=Array(S.length+Z.length);for(let ja=0;ja<ca.length;ja++){var da=ca[ja];const la=this._getIntersectingTiles(da);for(const ma of la){var fa=ma.id;P(fa,ma,ia).removed.push(this._displayIds.get(da.uid))}T.push(this._updateGraphic(da,
null));ea[ja]=da}var ka=ca.length;for(da=0;da<S.length;da++){const ja=S[da];ea[ka+da]=ja;this._graphicsSet.add(ja);T.push(this._addGraphic(ja))}for(const ja of Z){this._abortProcessingGraphic(ja.uid);const la=this._getIntersectingTiles(ja);for(const ma of la)fa=ma.id,P(fa,ma,ia).removed.push(this._displayIds.get(ja.uid));this._graphicsSet.delete(ja);this._graphicStore.remove(ja)}this._flipUpdatingGraphics();yield Promise.all(T);let ha;for(ka=0;ka<ea.length;ka++){ha=ea[ka];const ja=this._getIntersectingTiles(ha);
for(const la of ja)fa=la.id,P(fa,la,ia).addedOrModified.push(ha)}this._graphicStore.updateZ();fa=[];for(const [,ja]of ia)fa.push(this._updateTile(ja));yield Promise.all(fa)}catch(ea){f.isAbortError(ea)}for(const ea of Z)try{const ha=yield this._getSymbolForGraphic(ea,null);if(ha){const ja=ha.hash();this._hashToExpandedSymbol.delete(ja)}}catch(ha){f.isAbortError(ha)}ia.clear();this.notifyChange("updating");this._processing=!1;this._needsProcessing&&(this._needsProcessing=!1,this._updateGraphics())});
return function(){return R.apply(this,arguments)}}();W._getArcadeInfo=function(R){const S=(R.attributes?Object.keys(R.attributes):[]).map(Z=>({name:Z,alias:Z,type:"string"===typeof R.attributes[Z]?"esriFieldTypeString":"esriFieldTypeDouble"}));return n.isNone(R.geometry)?null:{geometryType:c.getJsonType(R.geometry),spatialReference:k.fromJSON(R.geometry.spatialReference),fields:S}};W._getSymbolForGraphic=function(R,S){f.throwIfAborted(this._controller.signal);return n.isSome(R.symbol)?Promise.resolve(R.symbol):
n.isSome(this.renderer)?this.renderer.getSymbolAsync(R,{scale:this.view.scale,signal:n.isSome(S)?S.signal:null}):Promise.resolve(this._getNullSymbol(R))};W._getCIMSymbol=function(R,S,Z){var ca=this._hashToCIM.get(S);if(ca)return Promise.resolve(ca);R=u.symbolToCIM(R);if(n.isSome(R)){if("CIMSymbolReference"===R.type)return ca=R,this._hashToCIM.set(S,ca),Promise.resolve(ca);if(ca=this._hashToCIMSymbolPromise.get(S))return ca;ca=R.fetchCIMSymbol(Z).then(ia=>{this._hashToCIM.set(S,ia.data);this._hashToCIMSymbolPromise.delete(S);
return ia}).catch(ia=>{this._hashToCIMSymbolPromise.delete(S);f.throwIfAbortError(ia);return null});this._hashToCIMSymbolPromise.set(S,ca);return ca}return Promise.resolve(null)};W._expandCIMSymbol=function(R,S,Z,ca){var ia=this._hashToExpandedSymbol.get(Z);if(ia)return Promise.resolve(ia);if(ia=this._hashToExpandedSymbolPromise.get(Z))return ia;ia=this.container.stage;S=this._getArcadeInfo(S);const T=I.createSymbolSchemaOptions(null);R=L.createSymbolSchema(R,T);ia=aa.expandSymbol(R,S,ia.resourceManager,
ca);this._hashToExpandedSymbolPromise.set(Z,ia);ia.then(da=>{this._hashToExpandedSymbol.set(Z,da);this._hashToExpandedSymbolPromise.delete(Z);return da});return ia};W._getSymbolResources=function(){var R=z._asyncToGenerator(function*(S,Z){f.throwIfAborted(this._controller.signal);return this.container.stage?this._getSymbolForGraphic(S,Z).then(ca=>{const ia=ca.hash();return this._getCIMSymbol(ca,ia,Z).then(T=>n.isNone(T)?null:this._expandCIMSymbol(T,S,ia,Z).then(da=>{const fa=da.layers.filter(ka=>
"text"===ka.type&&"string"===typeof ka.text);if(fa&&0<fa.length){const ka=Array(fa.length);for(let ha=0;ha<fa.length;ha++){const ja=fa[ha],la=[],[ma]=B.bidiText(ja.text);ja.text=ma;for(let oa=0;oa<ma.length;oa++)la.push(ma.charCodeAt(oa));ka[ha]={symbol:ja,id:ha,glyphIds:la}}const ea=new Map;return this.container.getMaterialItems(ka).then(ha=>{for(let ja=0;ja<fa.length;ja++){const la=fa[ja];ea.set(la.cim,{text:la.text,mosaicItem:ha[ja].mosaicItem})}return{symbol:da,textInfo:ea,hash:ia}})}return{symbol:da,
hash:ia}}))}).catch(ca=>{f.throwIfAbortError(ca);return null}):null});return function(S,Z){return R.apply(this,arguments)}}();W._projectAndNormalizeGeometry=function(){var R=z._asyncToGenerator(function*(S,Z){f.throwIfAborted(this._controller.signal);if(n.isNone(S.geometry)||"mesh"===S.geometry.type)return null;var ca=S.geometry;c.isPolygon(ca)?ca.rings=ca.rings:c.isPolyline(ca)?ca.paths=ca.paths:c.isExtent(ca)&&(S=yield this._getSymbolForGraphic(S,Z),f.throwIfAborted(this._controller.signal),ca=
X.isMarkerSymbol(S.type)||X.isTextSymbol(S.type)?ca.center:X.polygonFromExtent(ca));yield p.checkProjectionSupport(ca.spatialReference,this.view.spatialReference);S=m.normalizeCentralMeridianForDisplay(ca);ca=p.project(S,ca.spatialReference,this.view.spatialReference);g.closeRingsAndFixWinding(ca);return ca});return function(S,Z){return R.apply(this,arguments)}}();W._onTileUpdate=function(R){const S=q.getInfo(this.view.spatialReference);if(R.added&&0<R.added.length)for(const Z of R.added)this._addNewTile(Z,
S);if(R.removed&&0<R.removed.length)for(const Z of R.removed)this._removeTile(Z.key)};W._addGraphic=function(){var R=z._asyncToGenerator(function*(S){this._abortProcessingGraphic(S.uid);f.throwIfAborted(this._controller.signal);var Z=new AbortController;this._graphicIdToAbortController.set(S.uid,Z);Z={signal:Z.signal};try{yield this._addOrUpdateGraphic(S,Z),f.throwIfAborted(this._controller.signal),this._graphicIdToAbortController.delete(S.uid)}catch(ca){if(this._graphicIdToAbortController.delete(S.uid),
!f.isAbortError(ca))throw ca;}});return function(S){return R.apply(this,arguments)}}();W._updateGraphic=function(R,S){f.throwIfAborted(this._controller.signal);const Z=this._projectAndNormalizeGeometry(R,S);S=this._getSymbolResources(R,S);return Promise.all([Z,S]).then(([ca,ia])=>{f.throwIfAborted(this._controller.signal);this._graphicStore.addOrModify(R,ia,ca)})};W._addOrUpdateGraphic=function(R,S){f.throwIfAborted(this._controller.signal);const Z=this._projectAndNormalizeGeometry(R,S);S=this._getSymbolResources(R,
S);return Promise.all([Z,S]).then(([ca,ia])=>{f.throwIfAborted(this._controller.signal);this._graphicsSet.has(R)&&this._graphicStore.addOrModify(R,ia,ca)})};W._addTile=function(R){var S=this.view.featuresTilingScheme.getTileBounds(r.create(),R);S=new w.GraphicTile(R,S[0],S[3]);this._tiles.set(R,S);this.container.addChild(S);return S};W._addNewTile=function(){var R=z._asyncToGenerator(function*(S,Z){const ca=this._addTile(S.key),ia=this._graphicStore.queryTileData(this._templateStore,S);if(0!==ia.length){if(Z){Z=
Math.round((Z.valid[1]-Z.valid[0])/S.resolution);for(var T of ia)T.geometry&&(c.isPoint(T.geometry)||c.isMultipoint(T.geometry))&&this._wrapPoints(T,Z)}T=S.key;this._tileUpdateSet.add(S.key);this.notifyChange("updating");try{const da={type:"update",clear:!1,addOrUpdate:yield this._processGraphics(S,ia),remove:[],end:!0,sort:!1};ca.patch(da);this._tileUpdateSet.delete(T);this.notifyChange("updating")}catch(da){if(this._tileUpdateSet.delete(T),this.notifyChange("updating"),!f.isAbortError(da))throw da;
}}});return function(S,Z){return R.apply(this,arguments)}}();W._removeTile=function(R){if(this._tiles.has(R)){var S=this._tiles.get(R);this.container.removeChild(S);S.destroy();this._tiles.delete(R)}};W._setFilterState=function(R,S){const Z=this._displayIds.get(R);R=this._attributeStore.getHighlightFlag(R);this._attributeStore.setData(Z,0,0,R|(S?t.FILTER_FLAG_0:0))};W._getGraphicsData=function(R,S,Z){const ca=q.getInfo(this.view.spatialReference);R=this._graphicStore.getGraphicsData(R,S,Z);if(ca){S=
Math.round((ca.valid[1]-ca.valid[0])/S.resolution);for(const ia of R)ia.geometry&&(c.isPoint(ia.geometry)||c.isMultipoint(ia.geometry))&&this._wrapPoints(ia,S)}return R};W._wrapPoints=function(R,S){const Z=R.geometry;c.isMultipoint(Z)?this._wrapMultipoint(Z,S):this._wrapPoint(R,S)};W._wrapMultipoint=function(R,S){var Z=R.points;const ca=[];let ia=0,T=0;for(const [da,fa]of Z)ca.push([da+ia,fa]),ia=0,S===X.TILE_SIZE?(Z=5*X.PIXEL_BUFFER,da+T<Z?(ca.push([S,0]),ia=-S):da+T>X.TILE_SIZE-Z&&(ca.push([-S,
0]),ia=S)):da+T<-X.PIXEL_BUFFER?(ca.push([S,0]),ia=-S):da+T>X.TILE_SIZE+X.PIXEL_BUFFER&&(ca.push([-S,0]),ia=S),T+=da;R.points=ca};W._wrapPoint=function(R,S){const Z=R.geometry;if(S===X.TILE_SIZE){const ca=5*X.PIXEL_BUFFER;Z.x<ca?R.geometry={points:[[Z.x,Z.y],[S,0]]}:Z.x>X.TILE_SIZE-ca&&(R.geometry={points:[[Z.x,Z.y],[-S,0]]})}else Z.x<-X.PIXEL_BUFFER?R.geometry={points:[[Z.x,Z.y],[S,0]]}:Z.x>X.TILE_SIZE+X.PIXEL_BUFFER&&(R.geometry={points:[[Z.x,Z.y],[-S,0]]})};W._processGraphics=function(R,S,Z){if(!S||
!S.length||!this._meshFactory)return null;const ca=K.GraphicsReader.from(S,this.uid),ia=this._meshFactory;return this._matcher.then(T=>ia.analyzeGraphics(ca,this.container.stage.resourceManager,T,null,null,Z).then(()=>{this._attributeStore.sendUpdates();return this._processAnalyzedGraphics(R,ca)}))};W._processAnalyzedGraphics=function(R,S){const Z=this._meshFactory;var ca=S.getSize();S=S.getCursor();const ia=new G.MeshData(R.key.id,{features:ca,records:ca,metrics:0},v.WGLSymbologyType.DEFAULT,!1,
!1);for(ca=[];S.next();){const T=S.readGraphic();T.insertAfter=-1===T.insertAfter?-1:this._displayIds.get(T.insertAfter);T.displayId=this._displayIds.get(T.attributes[this.uid]);const da=new E(T.displayId);da.insertAfter=T.insertAfter;ca.push(da);Z.writeGraphic(ia,S,R.level,this.container.stage.resourceManager)}R=ia.serialize(R.tileInfoView.tileInfo.isWrappable);return 1!==R.length?new A.TileData:A.TileData.fromVertexData(R[0].message,ca)};W._abortProcessingGraphic=function(R){this._graphicIdToAbortController.has(R)&&
this._graphicIdToAbortController.get(R).abort()};W._getNullSymbol=function(R){R=R.geometry;return c.isPolyline(R)?h.errorPolylineSymbol2D:c.isPolygon(R)||c.isExtent(R)?h.errorPolygonSymbol2D:h.errorPointSymbol2D};W._flipUpdatingGraphics=function(){this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer);this._updatingGraphicsTimer=setTimeout(()=>{this._updatingGraphicsTimer=null;this.notifyChange("updating")},160);this.notifyChange("updating")};z._createClass(Q,[{key:"updating",get:function(){return!this._attached||
null!==this._updatingGraphicsTimer||0<this._tileUpdateSet.size||0<this._tilesToUpdate.size||this._attributeStore.isUpdating()}}]);return Q}(ba.GraphicsView(y.HandleOwnerMixin(C)));D.__decorate([a.property({constructOnly:!0})],C.prototype,"requestUpdateCallback",void 0);D.__decorate([a.property()],C.prototype,"container",void 0);D.__decorate([a.property({constructOnly:!0})],C.prototype,"graphics",void 0);D.__decorate([a.property()],C.prototype,"updating",null);D.__decorate([a.property()],C.prototype,
"view",void 0);D.__decorate([a.property()],C.prototype,"updateRequested",void 0);return C=D.__decorate([l.subclass("esri.views.2d.layers.support.GraphicsView2D")],C)})},"esri/geometry/support/normalizeUtilsSync":function(){define("exports ../../core/maybe ./aaBoundingRect ./boundsUtils ./coordsUtils ./jsonUtils ./normalizeUtilsCommon ./spatialReferenceUtils".split(" "),function(z,D,C,B,y,x,n,f){function d(p,u){if(D.isNone(p))return null;var h=p.spatialReference,t=f.getInfo(h);p="toJSON"in p?p.toJSON():
p;if(!t)return p;h=f.isWebMercator(h)?102100:4326;const v=n.cutParams[h].maxX,w=n.cutParams[h].minX;if(x.isPoint(p))return b(p,v,w);if(x.isMultipoint(p))p.points=p.points.map(A=>b(A,v,w));else{if(x.isExtent(p))return a(p,t);if(x.isPolygon(p)||x.isPolyline(p)){h=B.getBoundsXY(m,p);t=h[0];h=h[2];const A=2*n.offsetMagnitude(t,w)*v;p=0===A?p:n.updatePolyGeometry(p,A);t+=A;h+=A;return h>v?g(p,v,u):t<w?g(p,w,u):p}}return p}function a(p,u){if(!u)return p;const h=e(p,u).map(t=>t.extent);return 2>h.length?
h[0]||p:2<h.length?(p.xmin=u.valid[0],p.xmax=u.valid[1],p):{rings:h.map(t=>[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]])}}function b(p,u,h){if(Array.isArray(p)){var t=p[0];t>u?(h=n.offsetMagnitude(t,u),p[0]=t+-2*h*u):t<h&&(u=n.offsetMagnitude(t,h),p[0]=t+-2*u*h)}else t=p.x,t>u?(h=n.offsetMagnitude(t,u),p.x+=-2*h*u):t<h&&(u=n.offsetMagnitude(t,h),p.x+=-2*u*h);return p}function e(p,u){const h=[],{ymin:t,ymax:v,xmin:w,xmax:A}=p;var E=p.xmax-p.xmin;const [G,F]=u.valid,
{x:H,frameId:J}=l(p.xmin,u),{x:I,frameId:N}=l(p.xmax,u);p=H===I&&0<E;if(E>2*F){E={xmin:w<A?H:I,ymin:t,xmax:F,ymax:v};p={xmin:G,ymin:t,xmax:w<A?I:H,ymax:v};u={xmin:0,ymin:t,xmax:F,ymax:v};const M={xmin:G,ymin:t,xmax:0,ymax:v},K=[],O=[];k(E,u)&&K.push(J);k(E,M)&&O.push(J);k(p,u)&&K.push(N);k(p,M)&&O.push(N);for(let X=J+1;X<N;X++)K.push(X),O.push(X);h.push(new c(E,[J]),new c(p,[N]),new c(u,K),new c(M,O))}else H>I||p?h.push(new c({xmin:H,ymin:t,xmax:F,ymax:v},[J]),new c({xmin:G,ymin:t,xmax:I,ymax:v},
[N])):h.push(new c({xmin:H,ymin:t,xmax:I,ymax:v},[J]));return h}function l(p,u){const [h,t]=u.valid;u=2*t;var v=0;p>t?(v=Math.ceil(Math.abs(p-t)/u),p-=v*u):p<h&&(v=Math.ceil(Math.abs(p-h)/u),p+=v*u,v=-v);return{x:p,frameId:v}}function k(p,u){const {xmin:h,ymin:t,xmax:v,ymax:w}=u;return r(p,h,t)&&r(p,h,w)&&r(p,v,w)&&r(p,v,t)}function r(p,u,h){return u>=p.xmin&&u<=p.xmax&&h>=p.ymin&&h<=p.ymax?!0:!1}function g(p,u,h=!0){const t=!x.isPolyline(p);t&&y.closeRings(p);if(h)return(new q).cut(p,u);h=t?p.rings:
p.paths;const v=t?4:2,w=h.length;u*=-2;for(let A=0;A<w;A++){const E=h[A];if(E&&E.length>=v){const G=[];for(const F of E)G.push([F[0]+u,F[1]]);h.push(G)}}t?p.rings=h:p.paths=h;return p}let c=function(p,u){this.extent=p;this.frameIds=u};const m=C.create();let q=function(){function p(){this.linesIn=[];this.linesOut=[]}var u=p.prototype;u.cut=function(h,t){this.xCut=t;if(h.rings)this.closed=!0,t=h.rings,this.minPts=4;else if(h.paths)this.closed=!1,t=h.paths,this.minPts=2;else return null;for(var v of t)if(v&&
!(v.length<this.minPts)){t=!0;for(const w of v)t?(this.moveTo(w),t=!1):this.lineTo(w);this.closed&&this.close()}this._pushLineIn();this._pushLineOut();t=[];for(const w of this.linesIn)w&&w.length>=this.minPts&&t.push(w);v=-2*this.xCut;for(const w of this.linesOut)if(w&&w.length>=this.minPts){for(const A of w)A[0]+=v;t.push(w)}this.closed?h.rings=t:h.paths=t;return h};u.moveTo=function(h){this._pushLineIn();this._pushLineOut();this._prevSide=this._side(h[0]);this._moveTo(h[0],h[1],this._prevSide);
this._firstPt=this._prevPt=h};u.lineTo=function(h){const t=this._side(h[0]);if(-1===t*this._prevSide){const v=this._intersect(this._prevPt,h);this._lineTo(this.xCut,v,0);this._prevSide=0}this._lineTo(h[0],h[1],t);this._prevSide=t;this._prevPt=h};u.close=function(){const h=this._firstPt,t=this._prevPt;h[0]===t[0]&&h[1]===t[1]||this.lineTo(h);this._checkClosingPt(this.lineIn);this._checkClosingPt(this.lineOut)};u._moveTo=function(h,t,v){this.closed?(this.lineIn.push([0>=v?h:this.xCut,t]),this.lineOut.push([0<=
v?h:this.xCut,t])):(0>=v&&this.lineIn.push([h,t]),0<=v&&this.lineOut.push([h,t]))};u._lineTo=function(h,t,v){this.closed?(this._addPolyVertex(this.lineIn,0>=v?h:this.xCut,t),this._addPolyVertex(this.lineOut,0<=v?h:this.xCut,t)):0>v?(0===this._prevSide&&this._pushLineOut(),this.lineIn.push([h,t])):0<v?(0===this._prevSide&&this._pushLineIn(),this.lineOut.push([h,t])):0>this._prevSide?(this.lineIn.push([h,t]),this.lineOut.push([h,t])):0<this._prevSide&&(this.lineOut.push([h,t]),this.lineIn.push([h,t]))};
u._addPolyVertex=function(h,t,v){const w=h.length;1<w&&h[w-1][0]===t&&h[w-2][0]===t?h[w-1][1]=v:h.push([t,v])};u._checkClosingPt=function(h){const t=h.length;3<t&&h[0][0]===this.xCut&&h[t-2][0]===this.xCut&&h[1][0]===this.xCut&&(h[0][1]=h[t-2][1],h.pop())};u._side=function(h){return h<this.xCut?-1:h>this.xCut?1:0};u._intersect=function(h,t){return h[1]+(this.xCut-h[0])/(t[0]-h[0])*(t[1]-h[1])};u._pushLineIn=function(){this.lineIn&&this.lineIn.length>=this.minPts&&this.linesIn.push(this.lineIn);this.lineIn=
[]};u._pushLineOut=function(){this.lineOut&&this.lineOut.length>=this.minPts&&this.linesOut.push(this.lineOut);this.lineOut=[]};return p}();z.CutVertical=q;z.normalizeCentralMeridianForDisplay=function(p){return d(p,!1)};z.normalizeCentralMeridianSync=function(p){return d(p,!0)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(z,D,C,B,y,x,n){function f(g,c){if(!c)return null;if("x"in c){var m={x:0,y:0};[m.x,m.y]=g(c.x,c.y,e);null!=c.z&&(m.z=c.z);null!=c.m&&(m.m=c.m);return m}if("xmin"in c)return m={xmin:0,ymin:0,xmax:0,ymax:0},[m.xmin,m.ymin]=g(c.xmin,c.ymin,e),[m.xmax,m.ymax]=g(c.xmax,c.ymax,e),c.hasZ&&(m.zmin=c.zmin,m.zmax=c.zmax,m.hasZ=!0),c.hasM&&(m.mmin=c.mmin,m.mmax=c.mmax,m.hasM=!0),m;if("rings"in c)return{rings:d(c.rings,g),hasM:c.hasM,hasZ:c.hasZ};if("paths"in c)return{paths:d(c.paths,g),hasM:c.hasM,hasZ:c.hasZ};
if("points"in c)return{points:a(c.points,g),hasM:c.hasM,hasZ:c.hasZ}}function d(g,c){const m=[];for(const q of g)m.push(a(q,c));return m}function a(g,c){const m=[];for(const q of g)g=c(q[0],q[1],[0,0]),m.push(g),2<q.length&&g.push(q[2]),3<q.length&&g.push(q[3]);return m}function b(){b=D._asyncToGenerator(function*(g,c){c&&(g=Array.isArray(g)?g.map(m=>C.isSome(m.geometry)&&m.geometry.spatialReference):[g],yield B.initializeProjection(g.map(m=>({source:m,dest:c}))))});return b.apply(this,arguments)}
const e=[0,0],l=f.bind(null,n.lngLatToXY),k=f.bind(null,n.xyToLngLat),r=new (function(){function g(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var c=g.prototype;c.push=function(){var m=D._asyncToGenerator(function*(q,p,u){if(!(q&&q.length&&p&&u)||x.equals(p,u))return q;const h={geometries:q,inSpatialReference:p,outSpatialReference:u,resolve:null};this._jobs.push(h);return new Promise(t=>{h.resolve=t;null===this._timer&&(this._timer=setTimeout(this._process,10))})});return function(q,
p,u){return m.apply(this,arguments)}}();c._process=function(){this._timer=null;const m=this._jobs.shift();if(m){var {geometries:q,inSpatialReference:p,outSpatialReference:u,resolve:h}=m;n.canProject(p,u)?x.isWebMercator(u)?h(q.map(l)):h(q.map(k)):h(B.projectMany(y.jsonAdapter,q,p,u,null,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return g}());z.checkProjectionSupport=function(g,c){return b.apply(this,arguments)};z.project=function(g,c,m,q){if(!g)return g;m||(m=c,c=g.spatialReference);
return x.isValid(c)&&x.isValid(m)&&!x.equals(c,m)?n.canProject(c,m)?(g=x.isWebMercator(m)?l(g):k(g),g.spatialReference=m,g):B.projectMany(y.jsonAdapter,[g],c,m,null,q)[0]:g};z.projectMany=function(g,c,m){return r.push(g,c,m)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(z){let D=function(n,f,d){this.x=n;this.y=f;this.spatialReference=d;this.m=this.z=void 0},C=function(n,f,d,
a){this.rings=n;this.spatialReference=f;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);a&&(this.hasM=a)},B=function(n,f,d,a){this.paths=n;this.spatialReference=f;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);a&&(this.hasM=a)},y=function(n,f,d,a){this.points=n;this.spatialReference=f;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);a&&(this.hasM=a)},x=function(n,f,d,a,b){this.xmin=n;this.ymin=f;this.xmax=d;this.ymax=a;this.spatialReference=b;this.mmax=this.mmin=this.zmax=this.zmin=void 0};z.jsonAdapter={convertToGEGeometry:function(n,
f){return null==f?null:n.convertJSONToGeometry(f)},exportPoint:function(n,f,d){d=new D(n.getPointX(f),n.getPointY(f),d);const a=n.hasZ(f),b=n.hasM(f);a&&(d.z=n.getPointZ(f));b&&(d.m=n.getPointM(f));return d},exportPolygon:function(n,f,d){return new C(n.exportPaths(f),d,n.hasZ(f),n.hasM(f))},exportPolyline:function(n,f,d){return new B(n.exportPaths(f),d,n.hasZ(f),n.hasM(f))},exportMultipoint:function(n,f,d){return new y(n.exportPoints(f),d,n.hasZ(f),n.hasM(f))},exportExtent:function(n,f,d){var a=n.hasZ(f);
const b=n.hasM(f);d=new x(n.getXMin(f),n.getYMin(f),n.getXMax(f),n.getYMax(f),d);a&&(a=n.getZExtent(f),d.zmin=a.vmin,d.zmax=a.vmax);b&&(n=n.getMExtent(f),d.mmin=n.vmin,d.mmax=n.vmax);return d}};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/GraphicTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ./DirtyMap ./DisplayRecordStore ./WGLBuffers ./WGLTile".split(" "),function(z,D,C,B,y,x){x=function(n){function f(){var a=
n.apply(this,arguments)||this;a._data=null;a._displayList=null;a._lastCommitTime=0;a._hasData=!1;a._invalidated=!1;a._wglBuffers=null;a._dirtyMap=new C;return a}D._inheritsLoose(f,n);var d=f.prototype;d.destroy=function(){n.prototype.destroy.call(this);this.clear()};d.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):null};d.getDisplayList=function(){return this._displayList};d.patch=function(a){if(!0===a.clear)this.clear(),this._hasData=!1;else{var b=
a.addOrUpdate,e=a.remove;!this._data&&b&&b.tileDisplayData.displayObjects.length?(b.tileDisplayData.computeDisplayList(),this._dirtyMap=new C,this._dispRecStore=B.fromTileData(b,this._dirtyMap),this._data=b,this._dirtyMap.markAllDirty(),this._hasData=!0,a.end&&this.ready()):this._data?b&&b.tileDisplayData.displayObjects.length||e.length?this._doPatchData(a):a.end&&this.ready():a.end&&this.ready();a.end&&!this._data&&this.clear();this.requestRender();this.emit("change")}};d.commit=function(a){if(!a.time||
a.time!==this._lastCommitTime)if(this._lastCommitTime=a.time,this.visible&&this._data&&(this._wglBuffers||(this._wglBuffers=new y(a.context)),this._dirtyMap.hasDirty()||this._invalidated))this._invalidated=!1,this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._displayList=this._data.tileDisplayData.displayList.clone(),this._displayObjects=this._data.tileDisplayData.displayObjects.slice(),this._dirtyMap.markAllClean()};d.clear=function(){this._dispRecStore=this._displayList=this._data=
null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};d._doPatchData=function(a){this._invalidated=!0;this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=B.fromTileData(this._data,this._dirtyMap));this.requestRender()};d._patchData=function(a){let b=!0;var e=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[],l=(a.remove||[]).slice();for(var k of e)null!=k.insertAfter&&l.push(k.id);for(var r of l)if(l=
this._data.tileDisplayData.displayObjectRegistry.get(r)){this._data.tileDisplayData.displayList.removeFromList(l.displayRecords);for(var g of l.displayRecords)this._dispRecStore.delete(g);this._data.tileDisplayData.displayObjectRegistry.delete(r);l=this._data.tileDisplayData.displayObjects.indexOf(l);this._data.tileDisplayData.displayObjects.splice(l,1)}for(const p of e){e=this._data.tileDisplayData.displayObjectRegistry.get(p.id);let u;if(e){r=e.displayRecords;e.set(p);e.displayRecords=r;r=e.displayRecords.length;
for(g=0;g<r;++g)if(l=e.displayRecords[g],k=p.displayRecords[g],g>=p.displayRecords.length||l.geometryType!==k.geometryType||l.symbolLevel!==k.symbolLevel||l.zOrder!==k.zOrder||l.materialKey!==k.materialKey)this._dispRecStore.delete(e.displayRecords[g]),g<p.displayRecords.length&&(e.displayRecords[g]=void 0);e.displayRecords.length=p.displayRecords.length}else if(e=p.copy(),e.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(p.id,e),r=this._data.tileDisplayData.displayObjects,
null!=e.insertAfter?(u={},0<=e.insertAfter?(g=this._data.tileDisplayData.displayObjectRegistry.get(e.insertAfter))?(k=r.indexOf(g)+1,k<r.length?r.splice(k,0,e):(r.push(e),k=r.length)):(r.push(e),k=r.length):(r.unshift(e),k=0)):(r.push(e),k=r.length),u)for(g=0<p.displayRecords.length?1:0,l=0,--k;0<=k&&l<g;--k)for(var c=r[k].displayRecords.length-1;0<=c&&l<g;--c){var m=r[k].displayRecords[c],q=this._data.tileDisplayData.displayList.getDPInfoType();u[q]||(u[q]=m,++l)}r=p.displayRecords.length;for(g=
0;g<r;++g){l=p.displayRecords[g];(k=e.displayRecords[g])?(k.meshData=l.meshData,k.materialKey=l.materialKey):(k=l.copy(),k.vertexFrom=void 0,k.indexFrom=void 0,e.displayRecords[g]=k);m=l.geometryType;c=this._data.tileDisplayData.displayList.getDPInfoType();q=a.addOrUpdate.tileBufferData.geometries[m];m=q.vertexBuffer;q=q.indexBuffer;let h=void 0;u&&(h=u[c]?this._data.tileDisplayData.displayList.splitAfter(u[c]):-1);b=this._dispRecStore.setMeshData(k,l,m,q,h)&&b;u&&null!=k.indexFrom&&null!=k.indexFrom&&
(u[c]=k)}}return b};D._createClass(f,[{key:"hasData",get:function(){return!!this._hasData}},{key:"displayObjects",get:function(){var a;return null!=(a=this._displayObjects)?a:[]}}]);return f}(x.WGLTile);z.GraphicTile=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(function(){return function(){function z(){this._dirties=[{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,
vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1}]}var D=z.prototype;D.hasDirty=function(){return this._dirties.some(C=>-1!==C.indexCount||C.allDirty)};D.markAllClean=function(){for(const C of this._dirties)C.indexFrom=-1,C.indexCount=-1,C.vertexFrom=-1,C.vertexCount=-1,C.allDirty=!1};
D.markAllDirty=function(){for(const C of this._dirties)C.allDirty=!0};D.forEach=function(C){for(let B=0;B<this._dirties.length;++B){const {indexCount:y,indexFrom:x,vertexCount:n,vertexFrom:f,allDirty:d}=this._dirties[B],a={};let b=void 0,e=!1;if(d||-1!==f&&0<n)a.geometry={count:n,from:f,allDirty:d},e=!0;if(d||-1!==x&&0<y)b={count:y,from:x,allDirty:d},e=!0;e&&C({indices:b,vertices:a},B)}};D.markDirtyIndices=function(C,B,y){C=this._dirties[C];if(!C.allDirty)if(-1!==C.indexCount){const x=Math.min(C.indexFrom,
B);B=Math.max(C.indexFrom+C.indexCount,B+y)-x;C.indexFrom=x;C.indexCount=B}else C.indexFrom=B,C.indexCount=y};D.markDirtyVertices=function(C,B,y,x){C=this._dirties[C];C.allDirty||(-1!==C.vertexCount?(B=Math.min(C.vertexFrom,y),y=Math.max(C.vertexFrom+C.vertexCount,y+x)-B,C.vertexFrom=B,C.vertexCount=y):(C.vertexFrom=y,C.vertexCount=x))};return z}()})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["../../../../core/has","./FreeList","./Utils"],function(z,D,C){const B=["FILL","LINE",
"MARKER","TEXT","LABEL"];return function(){function y(n,f,d,a){this._strides=n;this._displayList=f;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=d;for(const b in n){this._freeListsAndStorage[b]={vtxFreeList:a?new D.FreeList(a):null,idxFreeList:a?new D.FreeList(a):null,vertexBuffers:{},indexBuffer:a?new Uint32Array(a):null};for(const e in n[b])this._freeListsAndStorage[b].vertexBuffers[e]={data:a?C.allocateTypedArrayBuffer(a,n[b][e]):null,stride:n[b][e]}}}y.fromTileData=function(n,
f){var d,a=n.getStrides(),b={};for(d=0;d<a.length;d++)b[B[d]]=a[d];d=b;a=[0,0,0,0,0];b=[0,0,0,0,0];var e=n.tileDisplayData.displayObjects;for(var l of e)for(var k of l.displayRecords)a[k.geometryType]=Math.max(a[k.geometryType],k.vertexFrom+k.vertexCount),b[k.geometryType]=Math.max(b[k.geometryType],k.indexFrom+k.indexCount);f=new y(d,n.tileDisplayData.displayList,f,null);for(l=0;l<n.tileBufferData.geometries.length;++l){k=a[l];e=b[l];var r=n.tileBufferData.geometries[l];d=f._storageFor(B[l]);const g=
n.tileBufferData.geometries[l].indexBuffer;d.indexBuffer=g;d.idxFreeList=new D.FreeList(g.length);d.idxFreeList.allocate(e);let c;for(const m in r.vertexBuffer)e=n.tileBufferData.geometries[l].vertexBuffer[m],d.vertexBuffers[m].data=e.data,d.vertexBuffers[m].stride=e.stride,r=C.strideToPackingFactor(e.stride),e=e.data.length*r/e.stride,c||(c=e);d.vtxFreeList=new D.FreeList(c);d.vtxFreeList.allocate(k)}return f};var x=y.prototype;x.delete=function(n){const f=B[n.geometryType];this._freeVertices(f,
n.vertexFrom,n.vertexCount);this._freeIndices(f,n.indexFrom,n.indexCount);this._displayList.removeFromList(n);n.vertexFrom=void 0;n.indexFrom=void 0};x.setMeshData=function(n,f,d,a,b){const e=B[n.geometryType];n.meshData=null;let l=void 0,k=void 0;void 0===n.vertexFrom?(k=f.vertexCount,l=this._allocateVertices(e,k)):f.vertexCount>n.vertexCount?(this._freeVertices(e,n.vertexFrom,n.vertexCount),k=f.vertexCount,l=this._allocateVertices(e,k)):f.vertexCount===n.vertexCount?(l=n.vertexFrom,k=n.vertexCount):
(this._freeVertices(e,n.vertexFrom+f.vertexCount,n.vertexCount-f.vertexCount),l=n.vertexFrom,k=f.vertexCount);let r=!0,g=void 0,c=void 0,m=void 0;void 0===n.indexFrom?(g=b,m=f.indexCount,c=this._allocateIndices(e,m)):f.indexCount>n.indexCount?(g=this._displayList.removeFromList(n),this._freeIndices(e,n.indexFrom,n.indexCount),m=f.indexCount,c=this._allocateIndices(e,m)):f.indexCount===n.indexCount?(r=!1,c=n.indexFrom,m=n.indexCount):(g=this._displayList.removeFromList(n),this._freeIndices(e,n.indexFrom+
f.indexCount,n.indexCount-f.indexCount),c=n.indexFrom,m=f.indexCount);if(-1!==l&&-1!==c){b=this._storageFor(e);C.copyMeshData(l,c,b.vertexBuffers,b.indexBuffer,f,d,a);n.vertexFrom=l;n.indexFrom=c;n.vertexCount=f.vertexCount;n.indexCount=f.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(n.geometryType,n.indexFrom,n.indexCount);for(const q in d)this._dirtyMap.markDirtyVertices(n.geometryType,q,n.vertexFrom,n.vertexCount)}r&&this._displayList.addToList(n,g);return!0}-1!==l&&this._freeVertices(e,
l,k);-1!==c&&this._freeIndices(e,c,m);n.setMeshDataFromBuffers(f,d,a);n.vertexFrom=void 0;n.vertexCount=0;n.indexFrom=void 0;n.indexCount=0;return!1};x.tryAddMeshData=function(n,f){const d=f.vertexBuffer;f=f.indexBuffer;var a=B[n.geometryType];const b=this._allocateVertices(a,n.vertexCount);if(-1===b)return this._freeVertices(a,b,n.vertexCount),!1;const e=this._allocateIndices(a,n.indexCount);if(-1===e)return this._freeVertices(a,b,n.vertexCount),this._freeIndices(a,e,n.indexCount),!1;a=this._storageFor(a);
C.copyMeshData(b,e,a.vertexBuffers,a.indexBuffer,n,d,f);n.vertexFrom=b;n.indexFrom=e;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(n.geometryType,n.indexFrom,n.indexCount);for(const l in d)this._dirtyMap.markDirtyVertices(n.geometryType,l,b,n.vertexCount)}this._displayList.addToList(n);return!0};x._allocateVertices=function(n,f){n=this._storageFor(n);f=n.vtxFreeList.allocate(f);return-1===f||.5<n.vtxFreeList.fragmentation?-1:f};x._freeVertices=function(n,f,d){this._storageFor(n).vtxFreeList.free(f,
d)};x._freeIndices=function(n,f,d){this._storageFor(n).idxFreeList.free(f,d)};x._allocateIndices=function(n,f){n=this._storageFor(n);f=n.idxFreeList.allocate(f);return-1===f||.5<n.idxFreeList.fragmentation?-1:f};x._storageFor=function(n){return this._freeListsAndStorage[n]};x._stridesFor=function(n,f){return this._strides[n][f]};return y}()})},"esri/views/2d/engine/webgl/FreeList":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(z,D){let C=function(){function y(n){this._largestRange=
null;this._parent=n;this._updateLargestRange()}var x=y.prototype;x.rangeCreated=function(n){if(!this._largestRange||n.count>this._largestRange.count)this._largestRange=n};x.rangeResized=function(n,f){if(n===this._largestRange)n.count<f&&this._updateLargestRange();else if(!this._largestRange||n.count>this._largestRange.count)this._largestRange=n};x.findBestRange=function(n){let f=this._parent._freeHead,d=null;for(;null!==f;)f.count>=n&&(!d||f.count-n<d.count-n)&&(d=f),f=f.next;return d};x.findAdjacentRanges=
function(n,f){let d=!0,a=!1,b=null,e=this._parent._freeHead;for(;d&&!a;){const l=null!==e?e.from:this._parent._size;n>=(null!==b?b.from+b.count:0)&&n+f<=l?(d=!1,a=!0):null!==e?(b=e,e=e.next):d=!1}return[b,e]};x._updateLargestRange=function(){let n=null,f=this._parent._freeHead;for(;null!==f;){if(!n||f.count>n.count)n=f;f=f.next}this._largestRange=n};D._createClass(y,[{key:"largestRange",get:function(){return this._largestRange}}]);return y}(),B=function(){function y(n,f){this._allocated=0;this._size=
n;this._freeHead=0<n?{from:0,count:n,prev:null,next:null}:null;this._bookKeeper=f||new C(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}var x=y.prototype;x.allocate=function(n){const f=this._bookKeeper.findBestRange(n);if(null===f)return-1;const d=f.from,a=f.count;f.from+=n;f.count-=n;this._bookKeeper.rangeResized(f,d,a);this._allocated+=n;0===f.count&&(n=null!==f.prev?this._freeHead:f.next,y._removeRange(f),this._freeHead=n);return d};x.free=function(n,f){const [d,a]=this._bookKeeper.findAdjacentRanges(n,
f);n={from:n,count:f,prev:d,next:a};null!==d&&(d.next=n);null!==a&&(a.prev=n);this._bookKeeper.rangeCreated(n);this._allocated-=f;if(null!==a&&n.from+n.count===a.from){f=n.from;var b=n.count;y._fuse(n,a);y._removeRange(a);this._bookKeeper.rangeResized(n,f,b);this._bookKeeper.rangeResized(a,void 0,0)}null!==d&&d.from+d.count===n.from&&(f=d.from,b=d.count,y._fuse(d,n),y._removeRange(n),this._bookKeeper.rangeResized(d,f,b),this._bookKeeper.rangeResized(n,void 0,0));this._freeHead=null!==n.prev?this._freeHead:
n};y._removeRange=function(n){null!==n.prev?null!==n.next?(n.prev.next=n.next,n.next.prev=n.prev):n.prev.next=null:null!==n.next&&(n.next.prev=null)};y._fuse=function(n,f){n.count+=f.count;n.next=f.next;f.from+=f.count;f.count=0;null!==f.next&&(f.next.prev=n)};D._createClass(y,[{key:"fragmentation",get:function(){const n=this._size-this._allocated;return 0===n?0:1-this._bookKeeper.largestRange.count/n}}]);return y}();z.FreeList=B;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/engine/webgl/WGLBuffers":function(){define(["./Utils","../../../webgl/BufferObject","../../../webgl/enums","../../../webgl/VertexArrayObject"],function(z,D,C,B){return function(){function y(n){this.geometryMap=z.createGeometryData(()=>({indexBuffer:D.BufferObject.createIndex(n,C.Usage.STATIC_DRAW),vao:null}),(f,d)=>({vertexBuffer:D.BufferObject.createVertex(n,z.C_VBO_INFO[d])}))}var x=y.prototype;x.dispose=function(){for(let n=0;5>n;n++){const f=this.geometryMap[n];if(f){f.data.vao&&
f.data.vao.dispose(!1);f.data.indexBuffer&&f.data.indexBuffer.dispose();for(const d in f.buffers)f.buffers[d]&&f.buffers[d].data.vertexBuffer.dispose()}}};x.get=function(n){const f=this.geometryMap[n];return{getVAO(d,a,b){if(!f.data.vao){const e={};for(const l in f.buffers)e[l]=f.buffers[l].data.vertexBuffer;f.data.vao=new B.VertexArrayObject(d,b,a,e,f.data.indexBuffer)}return f.data.vao}}};x.has=function(n){return null!=this.geometryMap[n]};x.upload=function(n,f){f.forEach((d,a)=>{this._upload(d,
a,n)})};x._upload=function(n,f,d){n.indices&&(n.indices.allDirty?this._uploadIndices(d,f):null!=n.indices.from&&null!=n.indices.count&&this._uploadIndices(d,f,n.indices.from,n.indices.count));if(n.vertices){n=n.vertices;for(const a in n){const b=n[a];b.allDirty?this._uploadVertices(d,f,a):null!=b.from&&null!=b.count&&this._uploadVertices(d,f,a,b.from,b.count)}}};x._uploadVertices=function(n,f,d,a,b){const e=this.geometryMap[f];e&&(f=n.geometries[f].vertexBuffer[d])&&(n=f.stride,f=f.data.buffer,e.buffers[d]&&
0<f.byteLength&&(null!=a&&null!=b?e.buffers[d].data.vertexBuffer.setSubData(f,a*n,a*n,(a+b)*n):e.buffers[d].data.vertexBuffer.setData(f)))};x._uploadIndices=function(n,f,d,a){const b=this.geometryMap[f];b&&(n=n.geometries[f].indexBuffer.buffer,b.data.indexBuffer&&0<n.byteLength&&(null!=d&&null!=a?b.data.indexBuffer.setSubData(n,4*d,4*d,4*(d+a)):b.data.indexBuffer.setData(n)))};return y}()})},"esri/views/2d/engine/webgl/WGLTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/mat2d ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2 ../../../../chunks/vec2f32 ./definitions ./TiledDisplayObject".split(" "),
function(z,D,C,B,y,x,n,f,d){let a=function(){function b(){}var e=b.prototype;e.acquire=function(l){return{refCount:1,version:-1,labelMat2d:y.create(),tileMat3:y.create(),dvs:y.create()}};e.release=function(l){};return b}();d=function(b){function e(k,r,g){return b.call(this,k,r,g,f.TILE_SIZE,f.TILE_SIZE)||this}D._inheritsLoose(e,b);var l=e.prototype;l.destroy=function(){b.prototype.destroy.call(this);this._transforms&&e.TransformCache.release(this.key.hash)};l.setTransform=function(k,r){var g=r/(k.resolution*
k.pixelRatio),c=this.transforms.tileMat3;const [m,q]=k.toScreenNoRotation([0,0],[this.x,this.y]);B.set(c,this.width/this.rangeX*g,0,0,0,this.height/this.rangeY*g,0,m,q,1);B.multiply(this.transforms.dvs,k.displayViewMat3,c);g=this.transforms.labelMat2d;r=k.getScreenTransform(g,r);c=n.create();x.transformMat2d(c,[this.x,this.y],r);C.fromTranslation(g,c);C.multiply(g,k.viewMat2d,g)};l._createTransforms=function(){return e.TransformCache.acquire(this.key.hash)};return e}(d.TiledDisplayObject);d.TransformCache=
new a;z.WGLTile=d;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat3","../DisplayObject","../../tiling/TileKey"],function(z,D,C,B,y){B=function(x){function n(d,a,b,e,l,k=e,r=l){var g=x.call(this)||this;g.triangleCountReportedInDebug=0;g.triangleCount=0;g.texture=null;g.key=new y(d);g.x=a;g.y=b;g.width=e;g.height=
l;g.rangeX=k;g.rangeY=r;return g}D._inheritsLoose(n,x);var f=n.prototype;f.destroy=function(){this.texture&&(this.texture.dispose(),this.texture=null)};f.setTransform=function(d,a){a/=d.resolution*d.pixelRatio;const b=this.transforms.tileMat3,[e,l]=d.toScreenNoRotation([0,0],[this.x,this.y]);C.set(b,this.width/this.rangeX*a,0,0,0,this.height/this.rangeY*a,0,e,l,1);C.multiply(this.transforms.dvs,d.displayViewMat3,b)};return n}(B.DisplayObject);z.TiledDisplayObject=B;Object.defineProperties(z,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/TileData":function(){define("exports ../../../../core/maybe ./enums ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./WGLDisplayRecord ./cpuMapped/DisplayRecordReader ./mesh/VertexBuffer ./mesh/VertexVector ./util/Writer".split(" "),function(z,D,C,B,y,x,n,f,d,a,b,e){const l=new B,k=new B;B=function(){function r(){this.tileBufferData=this.tileDisplayData=null}var g=r.prototype;g.reshuffle=function(){l.reset();var c=
[[],[],[],[],[]];var m=this.tileDisplayData.displayObjects;for(var q of m)for(var p of q.displayRecords)c[p.geometryType].push(p);for(var u of c)for(var h of u)h&&l.needMore(h.geometryType,h.meshData?h.meshData.vertexCount:h.vertexCount,h.meshData?h.meshData.indexData.length:h.indexCount);u=c.length;h=new y;for(m=0;m<u;++m){h.geometries[m].indexBuffer=new Uint32Array(Math.round(1.5*l.indicesFor(m)));q=[];for(var t in this.tileBufferData.geometries[m].vertexBuffer)q.push(this.tileBufferData.geometries[m].vertexBuffer[t].stride);
q=r._computeVertexAlignment(q);p=Math.round(1.5*l.verticesFor(m));q=r._align(p,q);for(var v in this.tileBufferData.geometries[m].vertexBuffer)p=this.tileBufferData.geometries[m].vertexBuffer[v].stride,h.geometries[m].vertexBuffer[v]={stride:p,data:n.allocateTypedArrayBuffer(q,p)}}k.reset();this.tileDisplayData.displayList.clear();for(t=0;t<u;++t){v=c[t];for(const w of v){if(w.meshData)w.writeMeshDataToBuffers(k.verticesFor(t),h.geometries[t].vertexBuffer,k.indicesFor(t),h.geometries[t].indexBuffer),
w.meshData=null;else{v=this.tileBufferData.geometries[t].vertexBuffer;m=this.tileBufferData.geometries[t].indexBuffer;q=h.geometries[t].vertexBuffer;p=h.geometries[t].indexBuffer;const A=k.verticesFor(t),E=k.indicesFor(t);n.copyMeshData(A,E,q,p,w,v,m);w.vertexFrom=A;w.indexFrom=E}k.needMore(t,w.vertexCount,w.indexCount)}}for(const w of this.tileDisplayData.displayObjects)this.tileDisplayData.displayList.addToList(w.displayRecords);this.tileBufferData=h};g.getStrides=function(){const c=[];for(let m=
0;m<this.tileBufferData.geometries.length;++m){const q=this.tileBufferData.geometries[m];c[m]={};for(const p in q.vertexBuffer)c[m][p]=q.vertexBuffer[p].stride}return c};g.clone=function(){const c=new r;c.tileBufferData=this.tileBufferData.clone();c.tileDisplayData=this.tileDisplayData.clone();return c};g._guessSize=function(){const {displayObjects:c}=this.tileDisplayData,m=Math.min(c.length,4);let q=0;for(let p=0;p<m;p++)q=Math.max(q,c[p].displayRecords.length);return 2*(12*c.length+c.length*q*40)};
g.serialize=function(){const c=this.tileBufferData.serialize(),m=this.tileBufferData.getBuffers(),q=this.tileDisplayData.serialize(new e(Int32Array,this._guessSize())).buffer();m.push(q);return{result:{displayData:q,bufferData:c},transferList:m}};r.fromVertexData=function(c,m){const q={},p=new Map;for(const u of m)p.set(u.id,u);n.forEachGeometryType(u=>{const h=c.data[u];if(D.isSome(h)){const v=d.DisplayRecordReader.from(h.records).getCursor();for(;v.next();){var t=v.id;const w=v.materialKey,A=v.indexFrom,
E=v.indexCount,G=v.vertexFrom,F=v.vertexCount,H=p.get(t);t=new f(t,u,w);t.indexFrom=A;t.indexCount=E;t.vertexFrom=G;t.vertexCount=F;H.displayRecords.push(t)}q[u]=a.VertexBuffers.fromVertexData(h,u)}else q[u]=(new b.VertexVectors(u,0,C.WGLSymbologyType.DEFAULT)).intoBuffers()});return r.fromMeshData({displayObjects:m,vertexBuffersMap:q})};r.fromMeshData=function(c){const m=new r,q=new x,p=new y;q.displayObjects=c.displayObjects;for(const u in c.vertexBuffersMap){const h=c.vertexBuffersMap[u];p.geometries[u].indexBuffer=
h.indexBuffer;p.geometries[u].vertexBuffer=h.namedBuffers}m.tileDisplayData=q;m.tileBufferData=p;return m};r.bind=function(c,m){const q=new r;q.tileDisplayData=c;q.tileBufferData=m;return q};r.create=function(c,m){const q=new r;q.tileDisplayData=new x;q.tileDisplayData.displayObjects=c;const p=[0,0,0,0,0],u=[0,0,0,0,0],h=[[],[],[],[],[]];for(var t of c)for(var v of t.displayRecords)h[v.geometryType].push(v),p[v.geometryType]+=v.meshData.vertexCount,u[v.geometryType]+=v.meshData.indexData.length;c=
new y;m=[m.fill||{},m.line||{},m.icon||{},m.text||{},m.label||{}];for(t=0;5>t;t++){v=new Uint32Array(u[t]);{var w=m[t];var A=p[t];const E={};for(const G in w){const F={data:n.allocateTypedArrayBuffer(A,w[G]),stride:w[G]};E[G]=F}w=E}f.writeAllMeshDataToBuffers(h[t],w,v);c.geometries[t]={indexBuffer:v,vertexBuffer:w}}q.tileBufferData=c;return q};r._align=function(c,m){const q=c%m;return 0===q?c:c+(m-q)};r._computeVertexAlignment=function(c){let m=!1,q=!1;for(const p of c)2===p%4?m=!0:0!==p%4&&(q=!0);
return q?4:m?2:1};return r}();z.TileData=B;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(z){return function(){function D(){this._byGeometryType=null}var C=D.prototype;C.reset=function(){this._byGeometryType=null};C.verticesFor=function(B){return this._byGeometryType?this._byGeometryType[B].vertices:0};C.indicesFor=function(B){return this._byGeometryType?
this._byGeometryType[B].indices:0};C.needMore=function(B,y,x){if(y||x)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),B=this._byGeometryType[B],B.vertices+=y,B.indices+=x};z._createClass(D,[{key:"satisfied",get:function(){return!this._byGeometryType}}]);return D}()})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["./Utils"],function(z){return function(){function D(){this.geometries=
[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}var C=D.prototype;C.clone=function(){const B=new D;for(let y=0;y<this.geometries.length;y++){const x=this.geometries[y],n=B.geometries[y];n.indexBuffer=x.indexBuffer.slice();n.vertexBuffer={};for(const f in x.vertexBuffer){const {data:d,stride:a}=x.vertexBuffer[f];n.vertexBuffer[f]={data:d.slice(),stride:a}}}return B};
D.deserialize=function(B){const y=new D;for(let x=0;5>x;++x){y.geometries[x].indexBuffer=new Uint32Array(B.geometries[x].indexBuffer);y.geometries[x].vertexBuffer={};for(const n in B.geometries[x].vertexBuffer)y.geometries[x].vertexBuffer[n]={data:z.allocateTypedArrayBufferwithData(B.geometries[x].vertexBuffer[n].data,B.geometries[x].vertexBuffer[n].stride),stride:B.geometries[x].vertexBuffer[n].stride}}return y};C.serialize=function(){const B={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,
vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]};for(let y=0;5>y;++y)for(const x in this.geometries[y].vertexBuffer)B.geometries[y].vertexBuffer[x]={data:this.geometries[y].vertexBuffer[x].data.buffer,stride:this.geometries[y].vertexBuffer[x].stride};return B};
C.getBuffers=function(){const B=[];for(let y=0;5>y;++y){B.push(this.geometries[y].indexBuffer.buffer);for(const x in this.geometries[y].vertexBuffer)B.push(this.geometries[y].vertexBuffer[x].data.buffer)}return B};return D}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./GraphicDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(z,D,C,B){return function(){function y(){}var x=y.prototype;x.computeDisplayList=
function(){this._displayList=new D;for(const n of this.displayObjects)for(const f of n.displayRecords)this._displayList.addToList(f)};x.clone=function(){const n=new y;this.displayObjects&&(n.displayObjects=this.displayObjects.map(f=>f.clone()));return n};x.serialize=function(n){B.serializeList(n,this.displayObjects);return n};x._deserializeObjects=function(n){var f=n.readInt32();f=Array(f);const d=new Map;for(let a=0;a<f.length;++a){const b=C.deserialize(n);f[a]=b;d.set(b.id,b)}this.displayObjects=
f;this._displayList=null;this._displayObjectRegistry=d};y.deserialize=function(n){const f=new y;f._deserializeObjects(n);return f};z._createClass(y,[{key:"displayObjectRegistry",get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(const n of this.displayObjects)this._displayObjectRegistry.set(n.id,n)}return this._displayObjectRegistry}},{key:"displayList",get:function(){return this._displayList}}]);return y}()})},"esri/views/2d/engine/webgl/GraphicDisplayList":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./materialKey/MaterialKey"],function(z,D){function C(d,a,b,...e){a<d.length?d.splice(a,b,...e):d.push(...e)}let B=function(){function d(){this.symbolLevels=[]}var a=d.prototype;a.replay=function(b,e,l){for(const g of this.symbolLevels)for(const c of g.zLevels){var k=c.geometryDPInfo.unified;if(k)for(const m of k){const {geometryType:q,materialKey:p,indexFrom:u,indexCount:h}=m;k=D.MaterialKeyBase.load(p).symbologyType;k=b.painter.getBrush(q,k);var r=e.getGeometry(q);r={geometryType:q,materialKey:p,
indexFrom:u,indexCount:h,target:r};k.prepareState(b,e);k.drawGeometry(b,e,r,l)}}};a.clear=function(){this.symbolLevels.length=0};a.addToList=function(b,e){if(Array.isArray(b))for(const l of b)this._addToList(l,e);else this._addToList(b,e)};a.removeFromList=function(b){Array.isArray(b)||(b=[b]);let e=null;for(const l of b)e=this._removeFromList(l);return e};a.clone=function(){const b=new d;for(const e of this.symbolLevels)b.symbolLevels.push(e.clone());return b};a.splitAfter=function(b){const e=this._getDisplayList(b.symbolLevel,
b.zOrder),l=e.length,k=b.indexFrom+b.indexCount;for(let r=0;r<l;++r){const g=e[r];if(g.geometryType===b.geometryType&&k>g.indexFrom&&k<=g.indexFrom+g.indexCount)return k<g.indexFrom+g.indexCount&&(b=new y,b.geometryType=g.geometryType,b.materialKey=g.materialKey,b.indexFrom=k,b.indexCount=g.indexFrom+g.indexCount-k,e.splice(r+1,0,b),g.indexCount=k-g.indexFrom),r}};a._addToList=function(b,e){const l=this._getDisplayList(b.symbolLevel,b.zOrder);e=null!=e?e:l.length-1;var k=0<=e&&e<l.length?l[e]:null;
null!==k&&k.materialKey===b.materialKey&&k.indexFrom+k.indexCount===b.indexFrom&&k.geometryType===b.geometryType?k.indexCount+=b.indexCount:(k=new y,k.indexFrom=b.indexFrom,k.indexCount=b.indexCount,k.materialKey=b.materialKey,k.geometryType=b.geometryType,C(l,e+1,0,k))};a._removeFromList=function(b){const e=this._getDisplayList(b.symbolLevel,b.zOrder);var l=e.length;let k=void 0;for(var r=0;r<l;++r){var g=e[r];if(b.indexFrom+b.indexCount>g.indexFrom&&b.indexFrom<g.indexFrom+g.indexCount&&g.geometryType===
b.geometryType){k=r;break}}if(void 0!==k){l=e[k];if(b.indexFrom===l.indexFrom)return l.indexCount-=b.indexCount,l.indexFrom+=b.indexCount,0===l.indexCount&&C(e,k,1),k-1;if(b.indexFrom+b.indexCount===l.indexFrom+l.indexCount)return l.indexCount-=b.indexCount,0===l.indexCount?(C(e,k,1),k-1):k;{r=l.indexFrom;g=b.indexFrom-l.indexFrom;const c=b.indexCount;b=l.indexFrom+l.indexCount-(b.indexFrom+b.indexCount);l.indexCount=g;const m=new y;m.geometryType=l.geometryType;m.materialKey=l.materialKey;m.indexFrom=
r+g+c;m.indexCount=b;C(e,k+1,0,m);return k}}return null};a._getDisplayList=function(b,e){let l;var k=this.symbolLevels.length;for(let g=0;g<k;g++)if(this.symbolLevels[g].symbolLevel===b){l=this.symbolLevels[g];break}l||(l=new f,l.symbolLevel=b,this.symbolLevels.push(l));let r;b=l.zLevels.length;for(k=0;k<b;k++)if(l.zLevels[k].zLevel===e){r=l.zLevels[k];break}r||(r=new n,r.geometryDPInfo=new x,r.zLevel=e,l.zLevels.push(r));r.geometryDPInfo.unified||(r.geometryDPInfo.unified=[]);return r.geometryDPInfo.unified};
a.getDPInfoType=function(){return"unified"};z._createClass(d,[{key:"empty",get:function(){return!this.symbolLevels||0===this.symbolLevels.length}}]);return d}(),y=function(){function d(){this.materialKey=null;this.indexCount=this.indexFrom=0}d.prototype.clone=function(){const a=new d;a.geometryType=this.geometryType;a.materialKey=this.materialKey;a.indexFrom=this.indexFrom;a.indexCount=this.indexCount;return a};return d}(),x=function(){function d(){this.unified=this.label=this.text=this.marker=this.line=
this.fill=null}d.prototype.clone=function(){const a=new d;a.fill=this.fill&&this.fill.map(b=>b.clone());a.line=this.line&&this.line.map(b=>b.clone());a.marker=this.marker&&this.marker.map(b=>b.clone());a.text=this.text&&this.text.map(b=>b.clone());a.label=this.label&&this.label.map(b=>b.clone());a.unified=this.unified&&this.unified.map(b=>b.clone());return a};return d}(),n=function(){function d(){this.geometryDPInfo=new x}d.prototype.clone=function(){const a=new d;a.zLevel=this.zLevel;a.geometryDPInfo=
this.geometryDPInfo.clone();return a};return d}(),f=function(){function d(){this.zLevels=[]}d.prototype.clone=function(){const a=new d;a.symbolLevel=this.symbolLevel;for(const b of this.zLevels)a.zLevels.push(b.clone());return a};return d}();return B})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["./WGLDisplayRecord","./util/serializationUtils"],function(z,D){return function(){function C(y){this.insertAfter=null;this.id=y;this.displayRecords=[]}var B=C.prototype;B.copy=function(){const y=
new C(this.id);y.set(this);return y};B.clone=function(){const y=new C(this.id);y.displayRecords=this.displayRecords.map(x=>x.clone());y.insertAfter=this.insertAfter;return y};B.set=function(y){this.id=y.id;this.displayRecords=y.displayRecords;this.insertAfter=y.insertAfter};B.serialize=function(y){y.push(this.id);D.serializeList(y,this.displayRecords);return y};C.deserialize=function(y){const x=y.readInt32(),n=new C(x);n.displayRecords=D.deserializeList(y,z,{id:x});return n};return C}()})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./MeshData","./Utils"],function(z,D,C){return function(){function B(x,n,f,d=0,a=0){this.id=x;this.geometryType=n;this.materialKey=f;this.minZoom=d;this.maxZoom=a;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}var y=B.prototype;y.clone=function(){return this.copy()};y.copy=function(){const x=new B(this.id,this.geometryType,this.materialKey);x.vertexFrom=this.vertexFrom;x.vertexCount=this.vertexCount;x.indexFrom=this.indexFrom;x.indexCount=
this.indexCount;x.zOrder=this.zOrder;x.symbolLevel=this.symbolLevel;x.meshData=this.meshData;x.minZoom=this.minZoom;x.maxZoom=this.maxZoom;return x};y.setMeshDataFromBuffers=function(x,n,f){const d=new D;for(const a in n){const b=n[a].stride,e=n[a].data,l=[],k=C.strideToPackingFactor(b);for(let r=0;r<b*x.vertexCount/k;++r)l[r]=e[r+b*x.vertexFrom/k];d.vertexData.set(a,l)}d.indexData.length=0;for(n=0;n<x.indexCount;++n)d.indexData[n]=f[n+x.indexFrom]-x.vertexFrom;d.vertexCount=x.vertexCount;this.meshData=
d};y.readMeshDataFromBuffers=function(x,n){this.meshData?this.meshData.clear():this.meshData=new D;for(const f in x){const d=x[f].stride,a=x[f].data,b=[],e=C.strideToPackingFactor(d);for(let l=0;l<d*this.vertexCount/e;++l)b[l]=a[l+d*this.vertexFrom/e];this.meshData.vertexData.set(f,b)}this.meshData.indexData.length=0;for(x=0;x<this.indexCount;++x)this.meshData.indexData[x]=n[x+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};y.writeMeshDataToBuffers=function(x,n,f,d){for(const a in n){const b=
n[a].stride,e=this.meshData.vertexData.get(a),l=n[a].data,k=C.strideToPackingFactor(b);for(let r=0;r<b*this.meshData.vertexCount/k;++r)l[r+b*x/k]=e[r]}for(n=0;n<this.meshData.indexData.length;++n)d[n+f]=this.meshData.indexData[n]+x;this.vertexFrom=x;this.vertexCount=this.meshData.vertexCount;this.indexFrom=f;this.indexCount=this.meshData.indexData.length};B.writeAllMeshDataToBuffers=function(x,n,f){let d=0,a=0;for(const b of x)b.writeMeshDataToBuffers(d,n,a,f),d+=b.vertexCount,a+=b.indexCount};y._computeSortKey=
function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};y.serialize=function(x){x.push(this.geometryType);x.push(this.materialKey);x.push(this.vertexFrom);x.push(this.vertexCount);x.push(this.indexFrom);x.push(this.indexCount);x.push(this.minZoom);x.push(this.maxZoom);return x};B.deserialize=function(x,n){const f=x.readInt32(),d=x.readInt32();n=new B(n.id,f,d);n.vertexFrom=x.readInt32();n.vertexCount=x.readInt32();n.indexFrom=x.readInt32();n.indexCount=x.readInt32();
n.minZoom=x.readInt32();n.maxZoom=x.readInt32();return n};z._createClass(B,[{key:"sortKey",get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey}}]);return B}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(function(){return function(){function z(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}var D=z.prototype;D.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};D.update=function(C,B,y){for(const x in C)this.vertexData.set(x,
C[x]);for(const x in this.vertexData)null===C[x]&&this.vertexData.delete(x);this.vertexCount=B;this.indexData=y};return z}()})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["exports"],function(z){z.deserializeList=function(D,C,B){var y=D.readInt32();y=Array(y);for(let x=0;x<y.length;x++)y[x]=C.deserialize(D,B);return y};z.serializeList=function(D,C){if(null===C)D.push(0);else{D.push(C.length);for(const B of C)B.serialize(D);return D}};Object.defineProperties(z,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/cpuMapped/DisplayRecordReader":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions"],function(z,D,C,B){let y=function(){function n(d){this._cursor=this._head=d}n.from=function(d,a=0,b=d.byteLength/x.BYTES_PER_RECORD-a){d=new x(new Int32Array(d,a*x.BYTES_PER_RECORD,b*x.ELEMENTS_PER_RECORD));return new n(d)};var f=n.prototype;f.size=function(){let d=this._cursor,
a=0;for(;d;)a+=d.size(),d=d._link;return a};f.seekIndex=function(d){for(this._cursor=this._head;this._cursor;){const a=this._cursor.size();if(d<a)return this._cursor._index=d,!0;d-=a;this._cursor=this._cursor._link}return!1};f.forEach=function(d){const a=this.getCursor();for(;a.next();)d(a)};f.link=function(d){if(this._head){for(var a=this._head;a._link;)a=a._link;a._link=d._head;a._link._indexStart=a._indexStart+a.size()}else this._head=d._head};f.getCursor=function(){return this.copy()};f.lookup=
function(d){for(this._cursor=this._head;this._cursor&&!this._cursor.lookup(d);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor};f.copy=function(){var d;const a=new n(null==(d=this._head)?void 0:d.copy());if(!a._head)return a;d=a._head;let b=a._head._link;for(;b;)d._link=b.copy(),d=b,b=d._link;return a};f.next=function(){if(!this._cursor)return!1;if(!this._cursor.next()){if(!this._cursor._link)return!1;this._cursor=this._cursor._link;return this.next()}return!0};
f.peekId=function(){var d;return null!=(d=this._cursor.peekId())?d:this._cursor._link.peekId()};f.delete=function(d){let a=this._head,b=null;for(;a;){if(a.delete(d))return a.isEmpty()&&(C.isSome(b)&&(b._link=a._link),a===this._head&&(this._head=a._link),a===this._cursor&&(this._cursor=a._link)),!0;b=a;a=a._link}return!1};D._createClass(n,[{key:"id",get:function(){return this._cursor.id},set:function(d){this._cursor.id=d}},{key:"materialKey",get:function(){return this._cursor.materialKey},set:function(d){this._cursor.materialKey=
d}},{key:"insertAfter",get:function(){return this._cursor.insertAfter}},{key:"indexFrom",get:function(){return this._cursor.indexFrom},set:function(d){this._cursor.indexFrom=d}},{key:"indexCount",get:function(){return this._cursor.indexCount},set:function(d){this._cursor.indexCount=d}},{key:"vertexFrom",get:function(){return this._cursor.vertexFrom},set:function(d){this._cursor.vertexFrom=d}},{key:"vertexCount",get:function(){return this._cursor.vertexCount},set:function(d){this._cursor.vertexCount=
d}},{key:"sortKey",get:function(){return this._cursor.sortKey},set:function(d){this._cursor.sortKey=d}},{key:"index",get:function(){return this._cursor._indexStart+this._cursor._index}}]);return n}();y.ELEMENTS_PER_RECORD=B.DISPLAY_RECORD_INT_PER_ELEMENT;y.BYTES_PER_RECORD=y.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;let x=function(){function n(d){this._link=null;this._index=-1;this._deletedCount=this._indexStart=0;this._offsets={instance:null};this._packedRecords=d}n.from=function(d,a=0,b=
d.byteLength/this.BYTES_PER_RECORD-a){return new n(new Int32Array(d,a*this.BYTES_PER_RECORD,b*this.ELEMENTS_PER_RECORD))};var f=n.prototype;f.delete=function(d){const a=this._index,b=this.lookup(d);if(b)for(this.id=2147483647,++this._deletedCount;this.next()&&this.id===d;)this.id=2147483647,++this._deletedCount;this._index=a;return b};f.isEmpty=function(){return this._deletedCount===this.size()};f.link=function(d){this._link?this._link.link(d):this._link=d};f.lookup=function(d){if(C.isNone(this._offsets.instance)){this._offsets.instance=
new Map;var a=this.copy();a._index=-1;let b=0;for(;a.next();)a.id!==b&&(this._offsets.instance.set(a.id,a._index),b=a.id)}if(!this._offsets.instance.has(d))return!1;a=this._index;this._index=this._offsets.instance.get(d);return 2147483647===this.id?(this._index=a,!1):!0};f.size=function(){return this._packedRecords.length/n.ELEMENTS_PER_RECORD};f.next=function(){for(;++this._index<this.size()&&2147483647===this.id;);return this._index<this.size()};f.peekId=function(){const d=(this._index+1)*n.ELEMENTS_PER_RECORD;
return d>=this._packedRecords.length?0:this._packedRecords[d]};f.getCursor=function(){return this.copy()};f.copy=function(){const d=new n(this._packedRecords);d._indexStart=this._indexStart;d._link=this._link;d._index=this._index;d._offsets=this._offsets;d._deletedCount=this._deletedCount;return d};D._createClass(n,[{key:"id",get:function(){return this._packedRecords[this._index*n.ELEMENTS_PER_RECORD]},set:function(d){this._packedRecords[this._index*n.ELEMENTS_PER_RECORD]=d}},{key:"materialKey",get:function(){return this._packedRecords[this._index*
n.ELEMENTS_PER_RECORD+1]},set:function(d){this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+1]=d}},{key:"insertAfter",get:function(){return this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+2]}},{key:"indexFrom",get:function(){return this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+3]},set:function(d){this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+3]=d}},{key:"indexCount",get:function(){return this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+4]},set:function(d){this._packedRecords[this._index*
n.ELEMENTS_PER_RECORD+4]=d}},{key:"vertexFrom",get:function(){return this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+5]},set:function(d){this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+5]=d}},{key:"vertexCount",get:function(){return this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+6]},set:function(d){this._packedRecords[this._index*n.ELEMENTS_PER_RECORD+6]=d}},{key:"sortKey",get:function(){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));
return this._packedRecordsF32[this._index*n.ELEMENTS_PER_RECORD+7]},set:function(d){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));this._packedRecordsF32[this._index*n.ELEMENTS_PER_RECORD+7]=d}},{key:"index",get:function(){return this._index}}]);return n}();x.ELEMENTS_PER_RECORD=B.DISPLAY_RECORD_INT_PER_ELEMENT;x.BYTES_PER_RECORD=x.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;z.DisplayRecordReader=y;Object.defineProperties(z,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["exports","../Utils"],function(z,D){let C=function(){function y(x,n){this.data=x;this.stride=n}y.decode=function(x){const n=D.allocateTypedArrayBufferwithData(x.data,x.stride);return new y(n,x.stride)};y.fromVertexVector=function(x){const n=D.allocateTypedArrayBufferwithData(x.data.buffer(),x.stride);return new y(n,x.stride)};return y}(),B=function(){function y(x,n,f){this.geometryType=x;this.indexBuffer=
new Uint32Array(n);this.namedBuffers=f}y.decode=function(x){const n=x.geometryType,f=x.indexBuffer,d={};for(const a in x.namedBuffers)d[a]=C.decode(x.namedBuffers[a]);return new y(n,f,d)};y.fromVertexData=function(x,n){const f=x.indices,d=D.allocateTypedArrayBufferwithData(x.vertices,x.stride);x={geometry:new C(d,x.stride)};return new y(n,f,x)};y.fromVertexVectors=function(x){const n=x.geometryType,f=x.indexVector.buffer(),d={};for(const a in x.namedVectors)d[a]=C.fromVertexVector(x.namedVectors[a]);
return new y(n,f,d)};return y}();z.VertexBuffers=B;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../Utils","./VertexBuffer","../util/Writer"],function(z,D,C,B,y){let x=function(){function f(d,a){this.data=d;this.stride=a}f.prototype.transfer=function(d,a){const b=this.data.buffer();d.vertexCount=this.vertexCount;d.data=b;d.stride=
this.stride;a.push(b)};D._createClass(f,[{key:"vertexCount",get:function(){const d=this.data.length/(this.stride/4);d!==(d|0)&&console.debug("Corrupted stride");return d}}]);return f}(),n=function(){function f(a,b,e){this.geometryType=a;this.indexVector=new y(Uint32Array,6*b);this.namedVectors={};a=C.getStrides(a,e);for(const l in a){e=a[l];let k;switch(e%4){case 0:case 2:k=new y(Uint32Array,e*b);break;case 1:case 3:k=new y(Uint8Array,e*b)}this.namedVectors[l]=new x(k,e)}}var d=f.prototype;d.get=
function(a){return this.namedVectors[a].data};d.getVector=function(a){return this.namedVectors[a]};d.transfer=function(a,b){const e=this.indexVector.buffer(),l={};b.push(e);for(const k in this.namedVectors){const r=this.namedVectors[k];l[k]={};r.transfer(l[k],b)}a.geometryType=this.geometryType;a.indexBuffer=e;a.namedBuffers=l;this.destroy()};d.intoBuffers=function(){const a=B.VertexBuffers.fromVertexVectors(this);this.destroy();return a};d.destroy=function(){this.namedVectors=this.indexVector=null};
return f}();z.VertexVector=x;z.VertexVectors=n;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(z){return function(){function D(B,y){this._pos=0;y=y?this._roundToNearest(y,B.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(y);this._buffer=new B(this._array);this._ctor=B;this._i16View=new Int16Array(this._array)}var C=D.prototype;C._roundToNearest=
function(B,y){B=Math.round(B);return B+(y-B%y)};C._ensureSize=function(B){if(this._pos+B>=this._buffer.length){B=this._roundToNearest(1.25*(this._array.byteLength+B*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);B=new ArrayBuffer(B);const y=new this._ctor(B);y.set(this._buffer,0);this._array=B;this._buffer=y;this._i16View=new Int16Array(this._array)}};C.ensureSize=function(B){this._ensureSize(B)};C.writeF32=function(B){this._ensureSize(1);const y=this._pos;(new Float32Array(this._array,
4*this._pos,1))[0]=B;this._pos++;return y};C.push=function(B){this._ensureSize(1);const y=this._pos;this._buffer[this._pos++]=B;return y};C.writeFixed=function(B){this._buffer[this._pos++]=B};C.setValue=function(B,y){this._buffer[B]=y};C.i1616Add=function(B,y,x){this._i16View[2*B]+=y;this._i16View[2*B+1]+=x};C.getValue=function(B){return this._buffer[B]};C.incr=function(B){if(this._buffer.length<B)throw Error("Increment index overflows the target buffer");this._buffer[B]++};C.decr=function(B){this._buffer[B]--};
C.writeRegion=function(B){this._ensureSize(B.length);const y=this._pos;this._buffer.set(B,this._pos);this._pos+=B.length;return y};C.writeManyFrom=function(B,y,x){for(this._ensureSize(x-y);y!==x;y++)this.writeFixed(B._buffer[y])};C.buffer=function(){const B=this._array.slice(0,4*this._pos);this.destroy();return B};C.toArray=function(){const B=this._array,y=[];for(let x=0;x<B.byteLength/4;x++)y.push(B[x]);return y};C.seek=function(B){this._pos=B};C.destroy=function(){this._buffer=this._array=null};
z._createClass(D,[{key:"length",get:function(){return this._pos}}]);return D}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileKey ../../../tiling/TileQueue ../../../tiling/TileStrategy ../definitions ../DisplayId ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/tileUtils".split(" "),function(z,D,C,B,y,x,n,f,d,a,b,e,l){function k(g){switch(g){case 1:case 8:case 32:return-1;
case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function r(g){switch(g){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}C=function(){function g(m,q,p,u,h,t=0){this.hasRecords=this._hasAggregate=!1;this._data={self:new Map,neighbors:[]};this._version=0;this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=
q;this.tileKey=m;this._hasAggregate=u;this._pixelBufferEnabled=h;this._version=t;this._symbologyType=p}var c=g.prototype;c.serialize=function(m){const q=[];q.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self));this._data.neighbors.forEach((p,u)=>{var h=1<<u;u=k(h);h=r(h);u=l.getPow2NeighborKey(new y(this.tileKey),u,h,m);u=this._serializeTileVertexData(this.tileKey,u.id,p.vertexData);u.message.bufferIds=p.displayIds;q.push(u)});return q};c._serializeTileVertexData=function(m,
q,p){var u,h,t,v,w;const A=[];p={[a.WGLGeometryType.MARKER]:null==(u=p.get(a.WGLGeometryType.MARKER))?void 0:u.serialize(A),[a.WGLGeometryType.FILL]:null==(h=p.get(a.WGLGeometryType.FILL))?void 0:h.serialize(A),[a.WGLGeometryType.LINE]:null==(t=p.get(a.WGLGeometryType.LINE))?void 0:t.serialize(A),[a.WGLGeometryType.TEXT]:null==(v=p.get(a.WGLGeometryType.TEXT))?void 0:v.serialize(A),[a.WGLGeometryType.LABEL]:null==(w=p.get(a.WGLGeometryType.LABEL))?void 0:w.serialize(A)};return{message:{tileKeyOrigin:m,
tileKey:q,data:p,version:this._version},transferList:A}};c.featureStart=function(m,q){this._current.insertAfter=m;this._current.sortKey=q};c.featureEnd=function(){};c.recordStart=function(m,q,p,u){this._current.writer=this._getVertexWriter(p);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=u;this._current.id=m;this._current.materialKey=q;this._current.geometryType=p;this._current.isDotDensity=
!1;this._current.writer.recordStart()};c.recordCount=function(){return this._current.writer.recordCount};c.vertexCount=function(){return this._current.writer.vertexCount};c.indexCount=function(){return this._current.writer.indexCount};c.vertexEnsureSize=function(m){this._current.writer.vertexEnsureSize(m)};c.indexEnsureSize=function(m){this._current.writer.indexEnsureSize(m)};c.vertexBounds=function(m,q,p,u){this._current.bufferingEnabled&&this._addOverlap(m,q,p,u)};c.vertexWrite=function(m){this._current.writer.writeVertex(m)};
c.vertexWriteF32=function(m){this._current.writer.writeVertexF32(m)};c.vertexEnd=function(){};c.vertexWriter=function(){return this._current.writer.vertexWriter};c.indexWrite=function(m){this._current.writer.writeIndex(m)};c.indexWriter=function(){return this._current.writer.indexWriter};c.metricWriter=function(){return this._current.writer.metricWriter};c.metricStart=function(m,q,p,u,h,t,v,w){this._current.writer=this._getVertexWriter(a.WGLGeometryType.LABEL);const A=this._current.writer.metricWriter;
A.push(d.getDisplayIdTexel(m));A.push(q);A.push(p);A.push(u);A.push(h);A.push(t);A.push(v);A.push(w);A.push(255);this._current.metricBoxLenPointer=A.push(0)};c.metricEnd=function(){const m=this._current.writer.metricWriter;0===m.getValue(this._current.metricBoxLenPointer)&&m.seek(m.length-10)};c.metricBoxWrite=function(m,q,p,u){const h=this._current.writer.metricWriter;h.incr(this._current.metricBoxLenPointer);h.push(0);h.push(0);h.push(m);h.push(q);h.push(p);h.push(u)};c.recordEnd=function(){var m=
this._current.vertStart,q=this._current.writer.vertexCount-m;if(!q)return!1;this.hasRecords=!0;var p=this._current.indexStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,p,this._current.writer.indexCount-p,m,q,this._current.sortKey);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===a.WGLGeometryType.LABEL)return!0;m=this._current.writer;for(q=0;8>q;q++){var u=1<<q;if(this._current.overlaps&
u){this._data.neighbors[q]||(this._data.neighbors[q]={vertexData:new Map,displayIds:new Set});p=this._data.neighbors[q];var h=this._current.geometryType;if(!p.vertexData.has(h)){var t=b.getStrides(h,this._symbologyType).geometry;t=new e.VertexDataWriter(h,t,f.PATCH_PIXEL_BUFFER_ALLOC_SIZE);p.vertexData.set(h,t)}h=p.vertexData.get(this._current.geometryType);t=4096*-k(u);u=4096*-r(u);h.copyLastFrom(m,t,u);p.displayIds.add(this._current.id)}}return!0};c._addOverlap=function(m,q,p,u){this._current.overlaps|=
255^((m<0+p?148:m>=f.TILE_SIZE-p?41:189)|(q<0+u?224:q>=f.TILE_SIZE-u?7:231))};c._getVertexWriter=function(m){if(!this._data.self.has(m)){const q=this._data.self,p=b.getStrides(m,this._symbologyType).geometry;q.set(m,new e.VertexDataWriter(m,p,this.hint.records))}return this._data.self.get(m)};D._createClass(g,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);return g}();z.MeshData=C;Object.defineProperties(z,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/DisplayId":function(){define(["exports"],function(z){z.AGGREGATE_VALID_FILTERS_MASK=254;z.DISPLAY_ID_TEXEL_MASK=8388607;z.DISPLAY_ID_TYPE_AGGREGATE=1;z.DISPLAY_ID_TYPE_FEATURE=0;z.DISPLAY_ID_TYPE_MASK=8388608;z.NONAGGREGATE_VALID_FILTERS_MASK=255;z.createDisplayId=function(D,C){return((C?8388608:0)|D)>>>0};z.getDisplayIdFilterMask=D=>1===(D&8388608)>>>23?254:255;z.getDisplayIdTexel=D=>D&8388607;z.getDisplayIdType=
D=>(D&8388608)>>>23;z.isAggregateId=function(D){return 1===(D&8388608)>>>23};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(z,D,C,B,y){let x=function(){function n(d,a,b){this._start={index:0,vertex:0};b=B.getMeshSizeHint(d,a,b);a/=4;this.geometryType=d;this._records=
new y(Int32Array,b.recordBytes);this._indices=new y(Uint32Array,b.indexBytes);this._vertices=new y(Uint32Array,b.vertexBytes);this._metrics=new y(Float32Array,0);this._strideInt=a}var f=n.prototype;f.serialize=function(d){const a=this._records.buffer(),b=this._indices.buffer(),e=this._vertices.buffer(),l=this._metrics.length?this._metrics.buffer():null,k=4*this._strideInt;d.push(a,b,e);return{stride:k,records:a,indices:b,vertices:e,metrics:l}};f.vertexEnsureSize=function(d){this._vertices.ensureSize(d)};
f.indexEnsureSize=function(d){this._indices.ensureSize(d)};f.recordStart=function(){this._start.index=this._indices.length;this._start.vertex=this._vertices.length};f.recordEnd=function(d,a,b,e,l,k,r,g){this._records.push(d);this._records.push(a);this._records.push(b);this._records.push(e);this._records.push(l);this._records.push(k);this._records.push(r);this._records.writeF32(g)};f.writeIndex=function(d){this._indices.push(d)};f.writeVertex=function(d){this._vertices.push(d)};f.writeVertexF32=function(d){this._vertices.writeF32(d)};
f.copyLastFrom=function(d,a,b){var e=d._records.length-C.DISPLAY_RECORD_INT_PER_ELEMENT;const l=d._records.getValue(e),k=d._records.getValue(e+1),r=d._records.getValue(e+2),g=d._records.getValue(e+4),c=d._records.getValue(e+6);e=d._records.getValue(e+7);const m=this._vertices.length;var q=(d._start.vertex-this._vertices.length)/this._strideInt;const p=this._indices.length,u=this.vertexCount;for(var h=d._start.index;h!==d._indices.length;h++){const t=d._indices.getValue(h);this._indices.push(t-q)}for(q=
d._start.vertex;q!==d._vertices.length;q++)h=d._vertices.getValue(q),this._vertices.push(h);for(d=m;d<=this._vertices.length;d+=this._strideInt)this._vertices.i1616Add(d,a,b);this._records.push(l);this._records.push(k);this._records.push(r);this._records.push(p);this._records.push(g);this._records.push(u);this._records.push(c);this._records.push(e)};D._createClass(n,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/C.DISPLAY_RECORD_INT_PER_ELEMENT}},
{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return n}();z.VertexDataWriter=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports",
"../definitions","../enums"],function(z,D,C){const B=new Map;B.set(C.WGLGeometryType.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4});B.set(C.WGLGeometryType.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8});B.set(C.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});B.set(C.WGLGeometryType.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});B.set(C.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});z.getMeshHeuristic=
function(y){return B.get(y)};z.getMeshSizeHint=function(y,x,n){const {indicesPerRecord:f,multiplier:d,verticesPerRecord:a}=B.get(y);return{recordBytes:n*D.DISPLAY_RECORD_INT_PER_ELEMENT*Uint32Array.BYTES_PER_ELEMENT,indexBytes:d*f*n*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:d*a*n*x}};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports","./Tile"],function(z,D){function C(B,y,x,n){B=
B.clone();const f=1<<B.level;y=B.col+y;x=B.row+x;n&&0>y?(B.col=y+f,--B.world):y>=f?(B.col=y-f,B.world+=1):B.col=y;B.row=x;return B}z.getPow2NeighborKey=C;z.getPow2NeighborTile=function(B,y,x){y=C(B.key,y,x,B.tileInfoView.tileInfo.isWrappable);return new D.Tile(B.tileInfoView,y)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/libtess ../../DisplayId ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(z,D,C,B,y,x,n,f,d,a){C=function(){function b(l,k,r){this._loadPromise=x.loadLibtess();this._geometryType=l;this._idField=k;this._templateStore=r}var e=b.prototype;e.update=function(l,k){B.isSome(l.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(l.mesh.labels,k));this._schema=l};e._createLabelTemplates=function(l,k){const r=new Map;if("simple"===l.type){for(var g of l.classes)l=f.fromLabelClass(g,k),r.set(g.index,l);return r}for(const c in l.classes){g=l.classes[c];for(const m of g)g=
f.fromLabelClass(m,k),r.set(m.index,g)}return r};e.analyze=function(){var l=D._asyncToGenerator(function*(k,r,g,c,m,q,p){if(!y.isAborted(p)){var u;"dictionary"===g.type&&(u=yield g.analyze(this._idField,k.copy(),r,m,q,p));for(r=0;k.next();){var h=void 0;h=u?u[r++]:B.isSome(c)&&n.isAggregateId(k.getDisplayId())&&1!==k.readAttribute("cluster_count")?c.match(this._idField,k,this._geometryType,m,q):g.match(this._idField,k,this._geometryType,m,q);k.setGroupId(h);if(a.isDynamicId(h)){h=this._templateStore.getDynamicTemplateGroup(h);
for(const t of h)t&&t.analyze&&t.analyze(this._templateStore,k,m,q)}}yield this._loadPromise;return this._templateStore.finalize(p)}});return function(k,r,g,c,m,q,p){return l.apply(this,arguments)}}();e.analyzeGraphics=function(){var l=D._asyncToGenerator(function*(k,r,g,c,m,q){if(!y.isAborted(q)){k=k.getCursor();for(g&&(yield g.analyze(this._idField,k.copy(),r,c,m,q));k.next();){r=k.getGroupId();if(null==r||-1===r)r=g.match(this._idField,k,k.geometryType,c,m),k.setGroupId(r);if(a.isDynamicId(r)){const p=
this._templateStore.getDynamicTemplateGroup(r);for(const u of p)u&&u.analyze&&u.analyze(this._templateStore,k,c,m)}k.setGroupId(r)}yield this._loadPromise;return this._templateStore.finalize(q)}});return function(k,r,g,c,m,q){return l.apply(this,arguments)}}();e.writeGraphic=function(l,k,r,g){const c=k.getGroupId(),m=k.getDisplayId(),q=this._templateStore.getTemplateGroup(c);l.featureStart(k.insertAfter,0);if(null!=m){if(a.isDynamicId(c))for(const p of q)p&&p.bindFeature(k,null,null);if(q){for(const p of q)p&&
p.write(l,k,r,g);l.featureEnd()}}};e.writeCursor=function(l,k,r,g,c,m,q){const p=k.getGroupId(),u=k.getDisplayId(),h=this._templateStore.getTemplateGroup(p),t=this._schema.mesh.sortKey;let v=0;B.isSome(t)&&(v=null!=t.fieldIndex?k.getComputedNumericAtIndex(t.fieldIndex):null!=t.field?k.readAttribute(t.field):k.readAttribute(this._idField),v*="asc"===t.order?1:-1);l.featureStart(0,null==v||isNaN(v)?0:v);if(null!=u&&h){if(a.isDynamicId(p))for(const w of h)w.bindFeature(k,r,g);for(const w of h)w.write(l,
k,c,q);B.isSome(m)&&l.hasRecords&&(r=m&&this._findLabelRef(h),this._writeLabels(l,k,m,r,c,q));l.featureEnd()}};e._findLabelRef=function(l){for(const k of l)if(k instanceof d)return k;return null};e._writeLabels=function(l,k,r,g,c,m){for(const q of r)if(B.isSome(q)&&q){const {glyphs:p,rtl:u,index:h}=q;r=this._labelTemplates.get(h);r.setZoomLevel(c);r.bindReferenceTemplate(g);r.bindTextInfo(p,u);r.write(l,k,null,m)}};D._createClass(b,[{key:"templates",get:function(){return this._templateStore}}]);return b}();
z.WGLMeshFactory=C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./segmentUtils ./WGLTextTemplate".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r){const g=C.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),c=(q,p="mapview-labeling")=>g.error(new D(p,q)),m=function(q){const p=new Map;return u=>{p.has(u)||p.set(u,q(u));return p.get(u)}}(q=>{let p=0;if(0===q)return Infinity;for(;!(q%2);)p++,q/=2;return p});return function(q){function p(h,t,v,w){var A,E,G;var F=q.call(this,h,v.font.size,v.haloSize||0,v.font.size,v.color&&d.premultiplyAlphaRGBAArray(v.color)||0,v.haloColor&&d.premultiplyAlphaRGBAArray(v.haloColor)||
0,v.horizontalAlignment,v.verticalAlignment,f.isMapAligned(t.labelPlacement)?n.Alignment.MAP:n.Alignment.SCREEN,v.font.decoration,!1,v.angle||0,v.xoffset,v.yoffset,v.lineWidth,v.lineHeight,null,null,null,null,null)||this;F._outLineLabelAngle=0;F._refPlacementPadding=0;F._refPlacementDirX=0;F._refPlacementDirY=0;F._refOffsetX=0;F._refOffsetY=0;F._zoomLevel=0;F.geometryType=b.WGLGeometryType.LABEL;F._allowOverrun=null!=(A=t.allowOverrun)?A:!1;F._repeatLabel=null!=(E=t.repeatLabel)?E:!0;F._labelPosition=
null!=(G=t.labelPosition)?G:"curved";A=!!t.minScale&&w.scaleToZoom(t.minScale)||0;A=B.clamp(A,0,25.5);w=!!t.maxScale&&w.scaleToZoom(t.maxScale)||255;w=B.clamp(w,0,25.5);const [H,J]=f.getAlignmentFromPlacement(t.labelPlacement);F._xAlignD=H;F._yAlignD=J;F._minZoom=A;F._maxZoom=w;F._refPlacementPadding=x.pt2px(v.haloSize)+a.TEXT_PLACEMENT_PADDING;F._repeatLabelDistance=t.repeatLabelDistance?x.pt2px(t.repeatLabelDistance):128;h=l.LabelMaterialKey.load(h);h.sdf=!0;F._materialKey=h.data;return F}z._inheritsLoose(p,
q);p.fromLabelClass=function(h,t){if("esriServerLinePlacementCenterAlong"===h.labelPlacement){const v=h.symbol;v.xoffset=0;v.yoffset=0;v.angle=0;v.font.decoration="none"}return new p(h.materialKey,h,h.symbol,t)};var u=p.prototype;u.setZoomLevel=function(h){this._zoomLevel=h};u.bindReferenceTemplate=function(h){let t=f.getXDirection(this._xAlignD),v=f.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(y.isNone(h))this._refSymbolAndPlacementOffset=e.i8888to32(0,0,Math.floor(127*t+127),
Math.floor(127*v+127));else{if("circle"===h.boundsType&&(t||v)){var w=Math.sqrt(t*t+v*v);t/=w;v/=w}w=Math.max(h.height,h.width);this._refSymbolAndPlacementOffset=e.i8888to32(4*this._refPlacementPadding,w,Math.floor(127*t+127),Math.floor(127*v+127));this._referenceSize=w;this._refPlacementDirX=t;this._refPlacementDirY=v;this._refOffsetX=h.xOffset;this._refOffsetY=h.yOffset}};u._write=function(h,t){if(!y.isNone(this._shapingInfo)){var v=this._shapingInfo,w=t.getDisplayId(),A="esriGeometryPolygon"===
t.geometryType?t.readLegacyCentroid():t.readLegacyGeometry();if(A)switch(this.current={out:h,inId:w,inShaping:v,zoomLevel:this._zoomLevel},t.geometryType){case "esriGeometryPolyline":this._placeLineLabels(A);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(A);break;default:c("mapview-labeling",`Geometry of type ${t.geometryType} is not supported`)}}};u._isVisible=function(h,t){const v=Math.floor(10*this.current.zoomLevel);return Math.floor(10*h)<=v&&v<=Math.floor(10*
t)};u._placePointLabels=function(h){const {out:t,inId:v,inShaping:w}=this.current;this._writeGlyphs(t,v,h,w)};u._placeLineLabels=function(h){h=k.smoothPaths(h.paths,this.current.inShaping.bounds.width);const t=this._placeSubdivGlyphs.bind(this),v=(this._shapedBox.width+this._repeatLabelDistance)/2;for(const w of h)k.pathDivide(w,v,t,this._repeatLabel)};u._placeSubdivGlyphs=function(h,t,v,w){var A=m(t),E=this._shapedBox.width/2,G=Math.sqrt(this._repeatLabelDistance)/2;v=Math.min(v,w-v);E=this.current.inShaping.isMultiline?
25:Math.log2(v/(G+E/2));A=Math.max(this._minZoom,this.current.zoomLevel+1-(0===t?E:Math.min(A,E)));E=this.current.zoomLevel-A;G=this._shapedBox.width/2*2**E;this.current.inShaping.isMultiline?0===t&&this._placeStraight(h,A):this._allowOverrun&&0>E?this._placeStraightAlong(h,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(h,A):"curved"===this._labelPosition&&this._placeCurved(h,A,G)};u._placeStraight=function(h,t){const {out:v,inId:w,inShaping:A}=this.current,E=Math.ceil((180/
Math.PI*h.angle+180)%360);this._outLineLabelAngle=Math.round(254/360*Math.ceil(180/Math.PI*h.angle%360));this._writeGlyphs(v,w,h,A,t);this._outLineLabelAngle=Math.round(254/360*E);this._writeGlyphs(v,w,h,A,t)};u._placeCurved=function(h,t,v){const {out:w,inId:A}=this.current;w.metricStart(A,t,h.x,h.y,0,0,0,0);const E=h.clone(),G=(180/Math.PI*h.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*h.angle%360*(254/360));this._placeFirst(E,t,1);this._placeBack(h,E,t,v,1);this._placeForward(h,
E,t,v,1);this._outLineLabelAngle=Math.round(254/360*G);this._placeFirst(E,t,0);this._placeBack(h,E,t,v,0);this._placeForward(h,E,t,v,0);w.metricEnd()};u._placeStraightAlong=function(h,t){const {out:v,inId:w}=this.current;v.metricStart(w,t,h.x,h.y,0,0,0,0);const A=h.clone(),E=(180/Math.PI*h.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*h.angle%360*(254/360));this._placeFirst(A,t,1,!0);this._outLineLabelAngle=Math.round(254/360*E);this._placeFirst(A,t,0,!0);v.metricEnd()};u._placeBack=
function(h,t,v,w,A){const E=h.clone();for(h=h.backwardLength+0;E.prev()&&!(h>=w);)this._placeOnSegment(E,t,h,v,-1,A),h+=E.length+0};u._placeForward=function(h,t,v,w,A){const E=h.clone();for(h=h.remainingLength+0;E.next()&&!(h>=w);)this._placeOnSegment(E,t,h,v,1,A),h+=E.length+0};u._placeFirst=function(h,t,v,w=!1){const A=this.current.inShaping;var E=A.glyphs;const G=this.current.zoomLevel,{out:F,inId:H}=this.current;for(const J of E)E=J.x>A.bounds.x?v:1-v,E=Math.max(0,G+Math.log2(Math.abs(J.x+J.width/
2-A.bounds.x)/(E*h.remainingLength+(1-E)*h.backwardLength))),E=Math.max(t,w?0:E),J.maxZoom=25,J.angle=h.angle+(1-v)*Math.PI,J.minZoom=E,this._writeGlyph(F,H,h.x,h.y,J),v&&this._isVisible(J.minZoom,J.maxZoom)&&(E=J.bounds,F.metricBoxWrite(E.center[0],E.center[1],E.width,E.height))};u._placeOnSegment=function(h,t,v,w,A,E){var G=this.current.inShaping.glyphs;const {out:F,inId:H}=this.current,J=this.current.inShaping,I=this.current.zoomLevel;var N=h.x+h.dx/h.length*-A*v,M=h.y+h.dy/h.length*-A*v;for(const O of G)if((G=
O.x>J.bounds.x?E:1-E)&&1===A||!G&&-1===A){var K=Math.abs(O.x+O.width/2-J.bounds.x);G=Math.max(0,I+Math.log2(K/v)-.1);K=Math.max(w,I+Math.log2(K/(v+h.length+0)));0!==G&&(O.angle=h.angle+(1-E)*Math.PI,O.minZoom=K,O.maxZoom=G,this._writeGlyph(F,H,N,M,O),E&&this._isVisible(O.minZoom,O.maxZoom)&&(G=O.bounds,F.metricBoxWrite(G.center[0]+(h.x-t.x),G.center[1]+(h.y-t.y),G.width,G.height)))}};u._writeGlyphs=function(h,t,v,w,A=this._minZoom){if(!(0>v.x||512<=v.x||0>v.y||512<=v.y)){var E=v.x+this._refOffsetX;
v=v.y-this._refOffsetY;for(const G of w.glyphs)G.minZoom=A,G.maxZoom=this._maxZoom,this._writeGlyph(h,t,E,v,G);w=w.boundsT;h.metricStart(t,A,E,v,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey);h.metricBoxWrite(w.center[0],w.center[1],w.width,w.height);h.metricEnd()}};u._writeVertexCommon=function(h,t,v,w){const A=this._color,E=this._haloColor,G=e.i8888to32(0,0,this._size,this._haloSize);w=e.i8888to32(Math.floor(10*Math.max(w.minZoom,this._minZoom)),Math.floor(10*
Math.min(w.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);h.vertexWrite(v);h.vertexWrite(t);h.vertexWrite(A);h.vertexWrite(E);h.vertexWrite(G);h.vertexWrite(this._refSymbolAndPlacementOffset);h.vertexWrite(w)};z._createClass(p,[{key:"_shapedBox",get:function(){return y.unwrap(this._shapingInfo).bounds}}]);return p}(r)})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],
function(z,D,C,B){function y(a){return a.length-1}function x(a){let b=0;for(let e=0;e<y(a);e++)b+=n(a,e);return b}function n(a,b,e=1){const [l,k]=a[b+1];return Math.sqrt(l*l+k*k)*e}function f(a,b,e,l,k){if(!(e<b)){var r=l.clone().seek(e/2);C.isNone(r)||(a(r.clone(),e,k),e=(e-b)/2,r=C.unwrap(r.seek(b/2)),f(a,b,e,l,k+1),f(a,b,e,r,k+1))}}let d=function(){function a(e,l,k,r,g){this._segments=e;this._index=l;this._distance=k;this._xStart=r;this._yStart=g;this._done=!1}a.create=function(e){return new a(e,
0,0,e[0][0],e[0][1])};var b=a.prototype;b.clone=function(){return new a(this._segments,this._index,this._distance,this.xStart,this.yStart)};b.equals=function(e){return this._index===e._index||e._index===this._index-1&&(0===this._distance||1===e._distance)||e._index===this._index+1&&(1===this._distance||0===e._distance)};b.leq=function(e){return this._index<e._index||this._index===e._index&&this._distance<=e._distance};b.geq=function(e){return this._index>e._index||this._index===e._index&&this._distance>=
e._distance};b.hasPrev=function(){return 0<=this._index-1};b.hasNext=function(){return this._index+1<y(this._segments)};b.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};b.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};b._seekBackwards=function(e,l){var k=this.backwardLength;if(e<=k)return this._distance=(k-e)/
this.length,this;for(k=this.backwardLength;this.prev();){if(k+this.length>e)return this._seekBackwards(e-k);k+=this.length}this._distance=0;return l?this:null};b.seek=function(e,l=!1){if(0>e)return this._seekBackwards(Math.abs(e),l);if(e<=this.remainingLength)return this._distance=(this.backwardLength+e)/this.length,this;let k=this.remainingLength;for(;this.next();){if(k+this.length>e)return this.seek(e-k,l);k+=this.length}this._distance=1;return l?this:null};D._createClass(a,[{key:"_segment",get:function(){return this._segments[this._index+
1]}},{key:"angle",get:function(){const e=this.dy;let l=Math.acos((0*e+-1*-this.dx)/(1*this.length));0<e&&(l=2*Math.PI-l);return l}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+
.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:e,dy:l}=this;return Math.sqrt(e*e+l*l)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);
return a}();z.SegmentCursor=d;z.pathDivide=function(a,b,e,l=!0){const k=x(a);a=d.create(a);const r=k/2;if(l){l=Math.floor(Math.max((k-b)/2,0)/b);a.seek(r-l*b);for(let g=-l;g<=l;g++)512>a.x&&0<=a.x&&512>a.y&&0<=a.y&&e(a.clone(),g,r+g*b,k),a.seek(b)}else a.seek(r),e(a.clone(),0,r+0*b,k)};z.pathLength=x;z.pathSubdivide=function(a,b,e){f(e,b,x(a),d.create(a),0)};z.segmentAt=function(a,b){return a[b+1]};z.segmentCount=y;z.segmentLength=n;z.smoothPaths=function(a,b){for(let E=0;E<a.length;E++){var e=a[E];
const G=[];G.push(e[0]);for(var l=1;l<e.length;l++){let [F,H]=G[l-1];F+=e[l][0];H+=e[l][1];G.push([F,H])}a:{e=G;l=b;if(0>=l)break a;const F=e.length;if(3>F)break a;const H=[];var k=0;H.push(0);for(var r=1;r<F;r++)k+=B.dist(e[r],e[r-1]),H.push(k);l=Math.min(l,.2*k);k=[];k.push(e[0][0]);k.push(e[0][1]);r=e[F-1][0];const J=e[F-1][1];var g=B.sub([0,0],e[0],e[1]);B.normalize(g);e[0][0]+=l*g[0];e[0][1]+=l*g[1];B.sub(g,e[F-1],e[F-2]);B.normalize(g);e[F-1][0]+=l*g[0];e[F-1][1]+=l*g[1];for(g=1;g<F;g++)H[g]+=
l;H[F-1]+=l;g=.5*l;for(let I=1;I<F-1;I++){let N=0,M=0,K=0;for(var c=I-1;0<=c&&!(H[c+1]<H[I]-g);c--){var m=g+H[c+1]-H[I],q=H[c+1]-H[c],p=H[I]-H[c]<g?1:m/q;if(1E-6>Math.abs(p))break;var u=p*p,h=p*m-.5*u*q,t=p*q/l,v=e[c+1],w=e[c][0]-v[0],A=e[c][1]-v[1];N+=t/h*(v[0]*p*m+.5*u*(m*w-q*v[0])-u*p*q*w/3);M+=t/h*(v[1]*p*m+.5*u*(m*A-q*v[1])-u*p*q*A/3);K+=t}for(c=I+1;c<F&&!(H[c-1]>H[I]+g);c++){m=g-H[c-1]+H[I];q=H[c]-H[c-1];p=H[c]-H[I]<g?1:m/q;if(1E-6>Math.abs(p))break;u=p*p;h=p*m-.5*u*q;t=p*q/l;v=e[c-1];w=e[c][0]-
v[0];A=e[c][1]-v[1];N+=t/h*(v[0]*p*m+.5*u*(m*w-q*v[0])-u*p*q*w/3);M+=t/h*(v[1]*p*m+.5*u*(m*A-q*v[1])-u*p*q*A/3);K+=t}k.push(N/K);k.push(M/K)}k.push(r);k.push(J);for(let I=0,N=0;I<F;I++)e[I][0]=k[N++],e[I][1]=k[N++]}e=[];e.push(G[0]);for(l=1;l<G.length;l++){const [F,H]=G[l-1],[J,I]=G[l];e.push([Math.round(J-F),Math.round(I-H)])}a[E]=e}return a};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],
function(z){function D(C,B){return Math.sqrt(C*C+B*B)}z.DEFAULT_MAX_ZOOM=100;z.DEFAULT_MIN_ZOOM=0;z.dist=function(C,B){return D(C[0]-B[0],C[1]-B[1])};z.getLimitCosine=function(C=2){return 1/Math.max(C,1)};z.getMinMaxZoom=function(C,B){const y=!!C.minScale&&B.scaleToZoom(C.minScale)||0;C=!!C.maxScale&&B.scaleToZoom(C.maxScale)||100;return[y,C]};z.isExtent=function(C){return void 0!==C.xmin&&void 0!==C.ymin&&void 0!==C.xmax&&void 0!==C.ymax};z.isFunction=function(C){return"function"===typeof C};z.isMultipoint=
function(C){return void 0!==C.points};z.isPoint=function(C){return void 0!==C.x&&void 0!==C.y};z.isPolygon=function(C){return void 0!==C.rings};z.isPolyline=function(C){return void 0!==C.paths};z.len=D;z.normalize=function(C){const B=D(C[0],C[1]);C[0]/=B;C[1]/=B};z.sub=function(C,B,y){C[0]=B[0]-y[0];C[1]=B[1]-y[1];return C};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/BidiText ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLMeshTemplate".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e){return function(l){function k(r,g,c,m,q,p,u,h,t,v,w,A,E,G,F,H,J,I,N=!1,M,K){var O=l.call(this)||this;O._xOffset=C.pt2px(E);O._yOffset=C.pt2px(G);O._decoration=v||"none";O._color=q;O._haloColor=p;O._haloSize=Math.min(Math.floor(5*C.pt2px(C.toPt(c))),127);O._size=Math.min(Math.round(C.pt2px(g)),127);g=Math.min(Math.round(C.pt2px(m||g)),127);O._referenceSize=Math.round(Math.sqrt(256*g));O._scale=O._size/n.GLYPH_SIZE;O._angle=A;O._justify=y.getJustification(u||"center");
O._xAlignD=y.getXAnchorDirection(u||"center");O._yAlignD=y.getYAnchorDirection(h||"baseline");O._baseline="baseline"===(h||"baseline");O._bitset=(t===B.Alignment.MAP?1:0)|(w?1:0)<<1;r=d.MaterialKeyBase.load(r);r.sdf=!0;O._materialKey=r.data;O._lineWidth=C.pt2px(F)||512;O._lineHeight=H||1;O._textPlacement=J;O._effects=I;O._isCIM=N;O._minMaxZoom=f.i1616to32(Math.round(M*n.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(K*n.MIN_MAX_ZOOM_PRECISION_FACTOR));return O}z._inheritsLoose(k,l);k.fromText=function(r,
g){const c=new k(r.materialKey,r.font.size,r.haloSize||0,r.font.size,r.color&&x.premultiplyAlphaRGBAArray(r.color)||0,r.haloColor&&x.premultiplyAlphaRGBAArray(r.haloColor)||0,r.horizontalAlignment,r.verticalAlignment,B.Alignment.SCREEN,r.font.decoration,!1,r.angle||0,r.xoffset,r.yoffset,r.lineWidth,r.lineHeight,null,null,!1,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM),[,m]=D.bidiText(r.text);c.bindTextInfo(g,m);c._vertexBoundsScale=r.maxVVSize?r.maxVVSize/r.font.size:1;return c};k.fromCIMText=function(r,
g,c){var m=r.scaleFactor||1;const q=r.size*r.sizeRatio*m,[p,u]=a.getMinMaxZoom(r.scaleInfo,c);c=new k(r.materialKey,q,r.outlineSize*r.sizeRatio,r.referenceSize,x.premultiplyAlphaRGBA(r.color),x.premultiplyAlphaRGBA(r.outlineColor),r.horizontalAlignment,r.verticalAlignment,r.alignment,r.decoration,r.colorLocked,r.angle,r.offsetX*r.sizeRatio*m,r.offsetY*r.sizeRatio*m,512,1,r.markerPlacement,r.effects,!0,p,u);[,m]=D.bidiText(r.text);c.bindTextInfo(g,m);c._vertexBoundsScale=r.maxVVSize?r.maxVVSize/q:
1;return c};return k}(b(e))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),function(z,D,C,B,y,x,n,f,d,a){return b=>function(e){function l(...r){r=
e.call(this,...r)||this;r._isCIM=!1;r._vertexBoundsScale=1;r.geometryType=n.WGLGeometryType.TEXT;r._aux=f.i8888to32(0,0,r._referenceSize,r._bitset);return r}z._inheritsLoose(l,e);var k=l.prototype;k.bindTextInfo=function(r,g){this._shapingInfo=r&&r.length?D.applySome(r,c=>a.shapeGlyphs(c,g,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:x.MAGIC_LABEL_LINE_HEIGHT*
Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):null};k._write=function(r,g,c,m){const q=g.getDisplayId();this._writeGeometry(r,g,q,c,m)};k._writeGeometry=function(r,g,c,m,q){const p=this._shapingInfo;if(!D.isNone(p)){if(D.isSome(this._textPlacement))return g=null!=q?q:g.readLegacyGeometryForDisplay(),this._writePlacedText(r,c,g,p,m);m=q?B.deltaDecodeGeometry(B.convertFromGeometry(q),2):"esriGeometryPolygon"===g.geometryType?g.readCentroid():g.readGeometryForDisplay();
if(!D.isNone(m)){if(m.isPoint){const [u,h]=m.coords;return!r.hasAggregates&&r.hasPixelBufferEnabled&&(0>u||512<=u||0>h||512<=h)?void 0:this._writeGlyphs(r,c,{x:u,y:h},p)}m.forEachVertex((u,h)=>this._writeGlyphs(r,c,{x:u,y:h},p))}}};k._writePlacedText=function(r,g,c,m,q){var p=D.unwrap(this._textPlacement);if(c=y.CIMMarkerPlacementHelper.getPlacement(c,p,C.pt2px(1),q.geometryEngine))for(var u=c.next();null!=u;)q=-u.getAngle(),m.setRotation(q),p=u.tx,u=-u.ty,0>p||512<=p||0>u||512<=u||(this._writeGlyphs(r,
g,{x:p,y:u},m),m.setRotation(-q)),u=c.next()};k._writeGlyphs=function(r,g,c,m){const q=d.MaterialKeyBase.load(this._materialKey),p=f.i1616to32(Math.round(8*c.x),Math.round(8*c.y)),u=this._vertexBoundsScale,h=m.bounds,t=2*Math.max(h.width,h.height);for(const v of m.glyphs)q.textureBinding=v.textureBinding,r.recordStart(g,q.data,this.geometryType,!0),r.vertexBounds(c.x+h.x+this._xOffset,c.y+h.y-this._yOffset,t*u,t*u),this._writeVertices(r,g,p,v),r.recordEnd()};k._writeGlyph=function(r,g,c,m,q){var p=
d.MaterialKeyBase.load(this._materialKey);const u=f.i1616to32(Math.round(8*c),Math.round(8*m));p.textureBinding=q.textureBinding;r.recordStart(g,p.data,this.geometryType,!0);p=q.bounds;const h=this._vertexBoundsScale;r.vertexBounds(c+p.x*h,m+p.y*h,p.width*h,p.height*h);this._writeVertices(r,g,u,q);r.recordEnd()};k._writeVertices=function(r,g,c,m){const q=r.vertexCount();this._writeVertexCommon(r,g,c,m);r.vertexWrite(m.offsets.upperLeft);r.vertexWrite(m.texcoords.upperLeft);r.vertexEnd();this._writeVertexCommon(r,
g,c,m);r.vertexWrite(m.offsets.upperRight);r.vertexWrite(m.texcoords.upperRight);r.vertexEnd();this._writeVertexCommon(r,g,c,m);r.vertexWrite(m.offsets.lowerLeft);r.vertexWrite(m.texcoords.lowerLeft);r.vertexEnd();this._writeVertexCommon(r,g,c,m);r.vertexWrite(m.offsets.lowerRight);r.vertexWrite(m.texcoords.lowerRight);r.vertexEnd();r.indexWrite(q+0);r.indexWrite(q+1);r.indexWrite(q+2);r.indexWrite(q+1);r.indexWrite(q+3);r.indexWrite(q+2)};k._writeVertexCommon=function(r,g,c,m){m=this._color;const q=
this._haloColor,p=f.i8888to32(0,0,this._referenceSize,this._bitset),u=f.i8888to32(0,0,this._size,this._haloSize);r.vertexWrite(c);r.vertexWrite(g);r.vertexWrite(m);r.vertexWrite(q);r.vertexWrite(u);r.vertexWrite(p);r.vertexWrite(this._minMaxZoom)};return l}(b)})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../CIMCursor","../CIMOperators"],function(z,D,C){let B=function(){function y(){}y.getPlacement=function(x,n,f,d){const a=C.getPlacementOperator(n);if(!a)return null;
x=D.cloneAndDecodeGeometry(x);return a.execute(x,n,f,d)};return y}();z.CIMMarkerPlacementHelper=B;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../core/maybe","../../../../../../symbols/cim/effects/CIMEffectHelper"],function(z,D){return function(){function C(){}var B=C.prototype;B.bindFeature=function(y,x,n){};B.write=function(y,x,n,f){var d;if(z.isNone(this._effects)||
0===(null==(d=this._effects)?void 0:d.length))return this._write(y,x,f);n=D.CIMEffectHelper.executeEffects(this._effects,x.readLegacyGeometryForDisplay(),f.geometryEngine);for(d=D.CIMEffectHelper.next(n);d;)this._write(y,x,f,d),d=D.CIMEffectHelper.next(n)};B._write=function(y,x,n,f){};return C}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../CIMEffects","../CIMOperators"],function(z,D,C,B,y){const x=96/72;let n=
function(){function f(){}f.executeEffects=function(d,a,b){a=C.cloneAndDecodeGeometry(a);a=new B.SimpleGeometryCursor(a);for(const e of d)(d=y.getEffectOperator(e))&&(a=d.execute(a,e,x,b));return a};f.next=function(d){d=d.next();C.deltaEncodeGeometry(d);return d};f.applyEffects=function(d,a,b){if(!d)return a;a=new B.SimpleGeometryCursor(a);for(var e of d)(d=y.getEffectOperator(e))&&(a=d.execute(a,e,1,b));for(b=null;e=a.next();)b?D.isPolyline(b)?D.isPolyline(e)&&b.paths.push(...e.paths):D.isPolygon(b)&&
D.isPolygon(e)&&b.rings.push(...e.rings):b=e;return b};return f}();z.CIMEffectHelper=n;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k){return function(r){function g(c,m,q,p,u,h,t,v,w,A,E,G,F,H,J,I,N,M,K,O,X,aa,ba){var V=r.call(this)||this;V.angle=p;V.height=t;V.width=h;V.xOffset=m*K;V.yOffset=q*K;V._markerPlacement=O;V._effects=X;V._anchorX=.5-(.5+I)*J.width/J.width;V._anchorY=.5-(.5+N)*J.height/J.height;V._minMaxZoom=a.i1616to32(Math.round(aa*f.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(ba*f.MIN_MAX_ZOOM_PRECISION_FACTOR));m=(H===x.Alignment.MAP?f.BITSET_MARKER_ALIGNMENT_MAP:f.BITSET_MARKER_ALIGNMENT_SCREEN)|
(E?f.BITSET_GENERIC_LOCK_COLOR:0)|(F?f.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE:0)|(G?f.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);q=J&&J.sdf;c=b.MarkerMaterialKey.load(c);c.sdf=q;c.pattern=!0;c.textureBinding=J.textureBinding;V._materialKey=c.data;V._fillColor=u;V._outlineColor=w;V._sizeOutlineWidth=a.i8888to32(Math.round(Math.min(Math.sqrt(128*h),255)),Math.round(Math.min(Math.sqrt(128*t),255)),Math.round(Math.min(Math.sqrt(128*A),255)),Math.round(Math.min(Math.sqrt(128*v),255)));u=J.rect.x+
f.SPRITE_PADDING;v=J.rect.y+f.SPRITE_PADDING;w=u+J.width;J=v+J.height;V._offsets.xUpperLeft=u;V._offsets.yUpperLeft=v;V._offsets.xUpperRight=w;V._offsets.yUpperRight=v;V._offsets.xBottomLeft=u;V._offsets.yBottomLeft=J;V._offsets.xBottomRight=w;V._offsets.yBottomRight=J;c.symbologyType===d.WGLSymbologyType.PIE_CHART?(V._texUpperLeft=a.i1616to32(0,1),V._texUpperRight=a.i1616to32(1,1),V._texBottomLeft=a.i1616to32(0,0),V._texBottomRight=a.i1616to32(1,0)):(V._texUpperLeft=a.i1616to32(u,v),V._texUpperRight=
a.i1616to32(w,v),V._texBottomLeft=a.i1616to32(u,J),V._texBottomRight=a.i1616to32(w,J));h=h*M*K;t=t*M*K;V._bitestAndDistRatio=a.i1616to32(m,Math.round(64*M));V._computedWidth=h;V._computedHeight=t;h=y.create();t=B.create();V._applyTransformation(t,h);return V}z._inheritsLoose(g,r);g.fromCIMMarker=function(c,m,q){const p=c.size,u=(m&&m.width||1)/(m&&m.height||1)*c.scaleX;var h=c.scaleSymbolsProportionally&&c.frameHeight?p/c.frameHeight:1;let t=n.premultiplyAlphaRGBA(c.color);const v=n.premultiplyAlphaRGBA(c.outlineColor),
w=C.pt2px(p),A=w*u,E=C.pt2px(c.offsetX||0),G=C.pt2px(c.offsetY||0);h*=C.pt2px(c.outlineWidth||0);const F=c.alignment||x.Alignment.SCREEN,H=C.pt2px(c.referenceSize),[J,I]=e.getMinMaxZoom(c.scaleInfo,q);m.sdf||0!==t||(t=-1);q=c.rotation||0;c.rotateClockwise||(q=-q);let N=0,M=0;const K=c.anchorPoint;K&&(c.isAbsoluteAnchorPoint?p&&(N=-K.x/(p*u),M=K.y/p):(N=K.x,M=K.y));m=new g(c.materialKey,E,G,q,t,A,w,H,v,h,c.colorLocked,c.scaleSymbolsProportionally,!1,F,m,N,M,c.sizeRatio,D.unwrapOr(c.scaleFactor,1),
c.markerPlacement,c.effects,J,I);m._vertexBoundsScaleX=c.maxVVSize?c.maxVVSize/A:1;m._vertexBoundsScaleY=c.maxVVSize?c.maxVVSize/w:1;return m};g.fromPictureMarker=function(c,m){const q=Math.round(C.pt2px(c.width)),p=Math.round(C.pt2px(c.height)),u=f.PICTURE_FILL_COLOR,h=Math.round(C.pt2px(c.xoffset||0)),t=Math.round(C.pt2px(c.yoffset||0));m=new g(c.materialKey,h,t,c.angle,u,q,p,p,0,0,!1,!1,!1,x.Alignment.SCREEN,m,0,0,1,1,null,null,e.DEFAULT_MIN_ZOOM,e.DEFAULT_MAX_ZOOM);m._vertexBoundsScaleX=c.maxVVSize?
c.maxVVSize/c.width:1;m._vertexBoundsScaleY=c.maxVVSize?c.maxVVSize/c.height:1;return m};g.fromSimpleMarker=function(c,m){const q=n.premultiplyAlphaRGBAArray(c.color),p=Math.round(C.pt2px(c.size)),u=Math.round(C.pt2px(c.xoffset||0)),h=Math.round(C.pt2px(c.yoffset||0)),t=c.style;var v=c.outline;const w=(v&&v.color&&n.premultiplyAlphaRGBAArray(v.color))|0;v=(v&&v.width&&Math.round(C.pt2px(v.width)))|0;m=new g(c.materialKey,u,h,c.angle,q,p,p,p,w,v,!1,!1,"esriSMSCross"===t||"esriSMSX"===t,x.Alignment.SCREEN,
m,0,0,1.96875,1,null,null,e.DEFAULT_MIN_ZOOM,e.DEFAULT_MAX_ZOOM);m.boundsType="esriSMSCircle"===t?"circle":"square";m._vertexBoundsScaleX=c.maxVVSize?c.maxVVSize/c.size:1;m._vertexBoundsScaleY=c.maxVVSize?c.maxVVSize/c.size:1;return m};g.fromLineSymbolMarker=function(c,m){const q=n.premultiplyAlphaRGBAArray(c.color),p=Math.round(C.pt2px(6*c.lineWidth)),u="cross"===c.style||"x"===c.style;switch(c.placement){case "begin-end":var h=x.ExtremityPlacement.Both;break;case "begin":h=x.ExtremityPlacement.JustBegin;
break;case "end":h=x.ExtremityPlacement.JustEnd;break;default:h=x.ExtremityPlacement.None}h={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:h,offsetAlongLine:0};m=new g(c.materialKey,0,0,0,q,p,p,p/6,q,u?Math.round(C.pt2px(c.lineWidth)):0,!1,!1,u,x.Alignment.MAP,m,0,0,1.96875,1,h,null,e.DEFAULT_MIN_ZOOM,e.DEFAULT_MAX_ZOOM);m.boundsType="circle"===c.style?"circle":"square";return m};return g}(l(k))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l){const k=3.14159265359/180;return r=>function(g){function c(...q){q=g.call(this,...q)||this;q.angle=0;q.xOffset=0;q.yOffset=0;q.width=0;q.height=0;q.boundsType="square";q._anchorX=0;q._anchorY=0;q._computedWidth=0;q._computedHeight=0;q._vertexBoundsScaleX=1;q._vertexBoundsScaleY=1;q._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0};q.geometryType=b.WGLGeometryType.MARKER;return q}z._inheritsLoose(c,
g);var m=c.prototype;m._write=function(q,p,u,h){const t=p.getDisplayId();q.recordStart(t,this._materialKey,this.geometryType,!0);this._writeGeometry(q,p,t,u,h);q.recordEnd()};m._writeGeometry=function(q,p,u,h,t){if(D.isSome(this._markerPlacement))return this._writePlacedMarkers(q,p,h,t);if(!t&&"esriGeometryPoint"===p.geometryType)return h=p.getX(),p=p.getY(),!q.hasAggregates&&q.hasPixelBufferEnabled&&(0>h||513<=h||0>p||513<=p)?void 0:this._writeVertices(q,u,this._getPos(h,p),h,p);p=t?f.deltaDecodeGeometry(f.convertFromGeometry(t),
2):"esriGeometryPolygon"===p.geometryType?p.readCentroid():p.readGeometryForDisplay();if(!D.isNone(p)){if(p.isPoint){const [v,w]=p.coords;return!q.hasAggregates&&q.hasPixelBufferEnabled&&(0>v||512<=v||0>w||512<=w)?void 0:this._writeVertices(q,u,this._getPos(v,w),v,w)}p.forEachVertex((v,w)=>{const A=2*a.TILE_SIZE;v<-A||v>=A||w<-A||w>=A||this._writeVertices(q,u,this._getPos(v,w),v,w)})}};m._writePlacedMarkers=function(q,p,u,h){h=null!=h?h:p.readLegacyGeometryForDisplay();if(u=d.CIMMarkerPlacementHelper.getPlacement(h,
D.unwrap(this._markerPlacement),C.pt2px(1),u.geometryEngine)){p=p.getDisplayId();h=n.create();for(var t=y.create(),v=u.next();null!=v;){const w=v.tx,A=-v.ty;-128<=w&&640>=w&&-128<=A&&640>=A&&(this._applyTransformation(t,h,-v.getAngle()/k),this._writeVertices(q,p,this._getPos(w,A),w,A));v=u.next()}}};m._writeVertices=function(q,p,u,h,t){const v=l.MarkerMaterialKey.load(this._materialKey);switch(v.symbologyType){case b.WGLSymbologyType.HEATMAP:return this._writeHeatmapVertices(q,p,u,h,t);default:return this._writeMarkerVertices(q,
p,v,u,h,t)}};m._writeMarkerVertices=function(q,p,u,h,t,v){var w=u.vvRotation;u=q.vertexCount();let A=this._computedWidth*this._vertexBoundsScaleX;var E=this._computedHeight*this._vertexBoundsScaleY;this.angle&&(A=E=Math.max(A,E));w&&(w=Math.max(this.xOffset,this.yOffset),A+=w,E+=w);q.vertexBounds(t+this.xOffset,v-this.yOffset,A,E);q.vertexWrite(h);q.vertexWrite(this._offsetUpperLeft);q.vertexWrite(this._texUpperLeft);q.vertexWrite(this._bitestAndDistRatio);q.vertexWrite(p);q.vertexWrite(this._fillColor);
q.vertexWrite(this._outlineColor);q.vertexWrite(this._sizeOutlineWidth);q.vertexWrite(this._minMaxZoom);q.vertexEnd();q.vertexWrite(h);q.vertexWrite(this._offsetUpperRight);q.vertexWrite(this._texUpperRight);q.vertexWrite(this._bitestAndDistRatio);q.vertexWrite(p);q.vertexWrite(this._fillColor);q.vertexWrite(this._outlineColor);q.vertexWrite(this._sizeOutlineWidth);q.vertexWrite(this._minMaxZoom);q.vertexEnd();q.vertexWrite(h);q.vertexWrite(this._offsetBottomLeft);q.vertexWrite(this._texBottomLeft);
q.vertexWrite(this._bitestAndDistRatio);q.vertexWrite(p);q.vertexWrite(this._fillColor);q.vertexWrite(this._outlineColor);q.vertexWrite(this._sizeOutlineWidth);q.vertexWrite(this._minMaxZoom);q.vertexEnd();q.vertexWrite(h);q.vertexWrite(this._offsetBottomRight);q.vertexWrite(this._texBottomRight);q.vertexWrite(this._bitestAndDistRatio);q.vertexWrite(p);q.vertexWrite(this._fillColor);q.vertexWrite(this._outlineColor);q.vertexWrite(this._sizeOutlineWidth);q.vertexWrite(this._minMaxZoom);q.vertexEnd();
this._writeIndices(q,u)};m._writeHeatmapVertices=function(q,p,u,h,t){const v=q.vertexCount();q.vertexBounds(h+this.xOffset,t-this.yOffset,this.width,this.height);q.vertexWrite(u);q.vertexWrite(this._offsetUpperLeft);q.vertexWrite(p);q.vertexEnd();q.vertexWrite(u);q.vertexWrite(this._offsetUpperRight);q.vertexWrite(p);q.vertexEnd();q.vertexWrite(u);q.vertexWrite(this._offsetBottomLeft);q.vertexWrite(p);q.vertexEnd();q.vertexWrite(u);q.vertexWrite(this._offsetBottomRight);q.vertexWrite(p);q.vertexEnd();
this._writeIndices(q,v)};m._writeIndices=function(q,p){q.indexWrite(p+0);q.indexWrite(p+1);q.indexWrite(p+2);q.indexWrite(p+1);q.indexWrite(p+3);q.indexWrite(p+2)};m._applyTransformation=function(q,p,u=0){B.fromTranslation(q,n.fromValues(this.xOffset,-this.yOffset));0!==this.angle+u&&B.rotate(q,q,k*(this.angle+u));u=this._computedWidth;const h=this._computedHeight,t=(this._anchorX-.5)*u,v=(this._anchorY-.5)*h;x.set(p,t,v);x.transformMat2d(p,p,q);this._offsetUpperLeft=e.i1616to32(16*p[0],16*p[1]);
this._offsets.xUpperLeft=p[0];this._offsets.yUpperLeft=p[1];x.set(p,t+u,v);x.transformMat2d(p,p,q);this._offsetUpperRight=e.i1616to32(16*p[0],16*p[1]);this._offsets.xUpperRight=p[0];this._offsets.yUpperRight=p[1];x.set(p,t,v+h);x.transformMat2d(p,p,q);this._offsetBottomLeft=e.i1616to32(16*p[0],16*p[1]);this._offsets.xBottomLeft=p[0];this._offsets.yBottomLeft=p[1];x.set(p,t+u,v+h);x.transformMat2d(p,p,q);this._offsetBottomRight=e.i1616to32(16*p[0],16*p[1]);this._offsets.xBottomRight=p[0];this._offsets.yBottomRight=
p[1]};m._getPos=function(q,p){return e.i1616to32(Math.round(8*q),Math.round(8*p))};return c}(r)})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaultsJSON ../../enums ../../materialKey/MaterialKey ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils ../../../../layers/support/cimSymbolUtils".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g,c,m,q,p){function u(F,H){const J=F.length;F.push(null);H.then(I=>F[J]=I);return F}function h(F){return!!(F&1)}const t=B.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),v=[];B={isOutline:!1,placement:null,symbologyType:n.WGLSymbologyType.DEFAULT,vvFlags:0};const w={...x.errorPointSymbolJSON,hash:JSON.stringify(x.errorPointSymbolJSON),materialKey:f.createMaterialKey(n.WGLGeometryType.MARKER,B)},A={...x.errorPolylineSymbolJSON,hash:JSON.stringify(x.errorPolylineSymbolJSON),
materialKey:f.createMaterialKey(n.WGLGeometryType.LINE,B)},E={...x.errorPolygonSymbolJSON,hash:JSON.stringify(x.errorPolygonSymbolJSON),materialKey:f.createMaterialKey(n.WGLGeometryType.FILL,B)};x=function(){function F(J,I){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new c.Lock;this._fetchResource=J;this._tileInfo=I}var H=F.prototype;
H.createTemplateGroup=function(J,I){this._initErrorTemplates();const N=J.hash;if(this._symbolToTemplate.has(N))return this._symbolToTemplate.get(N);const M=[];I&&this._createMeshTemplates(M,I,!0);this._createMeshTemplates(M,J,!1);J=this._createGroupId("expanded-cim"===J.type&&G(J));this._idToTemplateGroup.set(J,M);this._symbolToTemplate.set(N,J);return J};H.getTemplateGroup=function(J){return this._idToTemplateGroup.has(J)?this._idToTemplateGroup.get(J):v};H.getDynamicTemplateGroup=function(J){if(!this._idToTemplateGroup.has(J))return v;
h(J)||t.error("mapview-template-store",`Id ${J} does not refer to a dynamic template`);return this._idToTemplateGroup.get(J)};H.getMosaicItem=function(J,I){const N=this._createTemplateId(),M=new Promise(K=>this._idToResolver.set(N,K));this._fetchQueue.push({symbol:J,id:N,glyphIds:I});return M};H.finalize=function(J){return this._fetchQueue.length||this._lock.isHeld()?c.withLock(this._lock,this._fetchAllQueuedResources.bind(this),J):Promise.resolve()};H._initErrorTemplates=function(){this._errorTemplates||
(this._errorTemplates={fill:this._createMeshTemplates([],E,!1),marker:this._createMeshTemplates([],w,!1),line:this._createMeshTemplates([],A,!1)})};H._fetchAllQueuedResources=function(J){if(!this._fetchQueue.length)return Promise.resolve();const I=this._fetchQueue,N=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return Promise.all(N).then(()=>this._fetchResource(I,J).then(M=>{for(const {id:K,mosaicItem:O}of M)this._idToResolver.get(K)(O),this._idToResolver.delete(K)})).catch(M=>{y.isAbortError(M)?
this._fetchQueue=this._fetchQueue.concat(I):"worker:port-closed"!==M.name&&t.error(new C("mapview-template-store","Unable to fetch requested texture resources",M))})};H._createGroupId=function(J){return this._idCounter++<<1|(J?1:0)};H._createTemplateId=function(){return this._templateIdCounter++};H._createSMS=function(){var J=D._asyncToGenerator(function*(I){const {spriteMosaicItem:N}=yield this.getMosaicItem(I);return m.ok(N,t)?r.fromSimpleMarker(I,N):this._markerError});return function(I){return J.apply(this,
arguments)}}();H._createPMS=function(){var J=D._asyncToGenerator(function*(I){const {spriteMosaicItem:N}=yield this.getMosaicItem(I);return m.ok(N,t)?r.fromPictureMarker(I,N):this._markerError});return function(I){return J.apply(this,arguments)}}();H._createSFS=function(){var J=D._asyncToGenerator(function*(I,N){const {spriteMosaicItem:M}=yield this.getMosaicItem(I);return m.ok(M,t)?l.fromSimpleFill(I,M,N):this._fillError});return function(I,N){return J.apply(this,arguments)}}();H._createPFS=function(){var J=
D._asyncToGenerator(function*(I,N){const {spriteMosaicItem:M}=yield this.getMosaicItem(I);return m.ok(M,t)?l.fromPictureFill(I,M,N):this._fillError});return function(I,N){return J.apply(this,arguments)}}();H._createSLS=function(){var J=D._asyncToGenerator(function*(I,N){({spriteMosaicItem:N}=yield this.getMosaicItem(I));return m.ok(N,t)?k.fromSimpleLine(I,N):this._lineError});return function(I,N){return J.apply(this,arguments)}}();H._createLMS=function(){var J=D._asyncToGenerator(function*(I){const {spriteMosaicItem:N}=
yield this.getMosaicItem(I);return m.ok(N,t)?r.fromLineSymbolMarker(I,N):this._markerError});return function(I){return J.apply(this,arguments)}}();H._createTS=function(){var J=D._asyncToGenerator(function*(I){const {glyphMosaicItems:N}=yield this.getMosaicItem(I);return g.fromText(I,N)});return function(I){return J.apply(this,arguments)}}();H._createCIMText=function(){var J=D._asyncToGenerator(function*(I){const {glyphMosaicItems:N}=yield this.getMosaicItem(p.cimLayerToRasterizationInfo(I),q.codepoints(I.text));
return m.ok(N,t)?g.fromCIMText(I,N,this._tileInfo):this._textError});return function(I){return J.apply(this,arguments)}}();H._createCIMFill=function(){var J=D._asyncToGenerator(function*(I){const {spriteMosaicItem:N}=yield this.getMosaicItem(p.cimLayerToRasterizationInfo(I));return m.ok(N,t)?l.fromCIMFill(I,N,this._tileInfo):this._fillError});return function(I){return J.apply(this,arguments)}}();H._createCIMLine=function(){var J=D._asyncToGenerator(function*(I){const {spriteMosaicItem:N}=yield this.getMosaicItem(p.cimLayerToRasterizationInfo(I));
return m.ok(N,t)?k.fromCIMLine(I,N,this._tileInfo):this._lineError});return function(I){return J.apply(this,arguments)}}();H._createCIMMarker=function(){var J=D._asyncToGenerator(function*(I){const {spriteMosaicItem:N}=yield this.getMosaicItem(p.cimLayerToRasterizationInfo(I));return m.ok(N,t)?r.fromCIMMarker(I,N,this._tileInfo):this._markerError});return function(I){return J.apply(this,arguments)}}();H._createCIM=function(){var J=D._asyncToGenerator(function*(I){const N=I.templateHash;if(this._cimTemplateCache.has(N))return this._cimTemplateCache.get(N);
let M;switch(I.type){case "marker":M=yield this._createCIMMarker(I);break;case "line":M=yield this._createCIMLine(I);break;case "fill":M=yield this._createCIMFill(I);break;case "text":M=yield this._createCIMText(I)}this._cimTemplateCache.set(N,M);return M});return function(I){return J.apply(this,arguments)}}();H._createDynamicCIM=function(){var J=D._asyncToGenerator(function*(I){const N=I.templateHash;if(this._cimTemplateCache.has(N))return this._cimTemplateCache.get(N);let M;switch(I.type){case "marker":M=
b.fromCIMMarker(I,this._tileInfo);break;case "line":M=a.fromCIMLine(I,this._tileInfo);break;case "fill":M=d.fromCIMFill(I,this._tileInfo);break;case "text":M=e.fromCIMText(I,this._tileInfo)}this._cimTemplateCache.set(N,M);return M});return function(I){return J.apply(this,arguments)}}();H._createPrimitiveMeshTemplates=function(J,I,N){switch(I.type){case "esriSMS":return u(J,this._createSMS(I));case "esriPMS":return u(J,this._createPMS(I));case "esriSFS":return u(J,this._createSFS(I,N));case "line-marker":return u(J,
this._createLMS(I));case "esriPFS":return u(J,this._createPFS(I,N));case "esriSLS":return u(J,this._createSLS(I,!1));case "esriTS":return u(J,this._createTS(I));default:return t.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),J}};H._createMeshTemplates=function(J,I,N){if(I.type.includes("3d"))return t.error("3D symbols are not supported with MapView"),J;if("expanded-cim"===I.type){for(const M of I.layers)"function"===typeof M.materialHash?u(J,this._createDynamicCIM(M)):
u(J,this._createCIM(M));return J}if("composite-symbol"===I.type){for(const M of I.layers)this._createPrimitiveMeshTemplates(J,M,N);return J}return"cim"===I.type||"label"===I.type||"web-style"===I.type?J:this._createPrimitiveMeshTemplates(J,I,N)};D._createClass(F,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);
return F}();const G=F=>{if(!F.layers)return!1;for(const H of F.layers)if("function"===typeof H.materialHash)return!0;return!1};z.WGLTemplateStore=x;z.errorPointSchema2D=w;z.errorPolygonSchema2D=E;z.errorPolylineSchema2D=A;z.isDynamicId=h;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e){return function(l){function k(r,g,c){var m;var q=l.call(this,r)||this;q._minMaxZoom=n.i1616to32(Math.round(g*y.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(c*y.MIN_MAX_ZOOM_PRECISION_FACTOR));d.isFunction(r.color)?q._dynamicPropertyMap.set("fillColor",(w,A,E)=>(w=r.color(w,A,E))&&B.premultiplyAlphaRGBA(w)||0):(g=r.color,q.fillColor=g&&B.premultiplyAlphaRGBA(g)||0);const p="CIMMarkerPlacementInsidePolygon"===(null==(m=r.cim.placement)?void 0:m.type)&&r.cim.placement.shiftOddRows?
2:1,u=r.height;d.isFunction(u)?q._dynamicPropertyMap.set("_height",(w,A,E)=>u(w,A,E)*p):q._height=(u||0)*p;const h=r.offsetX;d.isFunction(h)?q._dynamicPropertyMap.set("_offsetX",(w,A,E)=>C.pt2px(h(w,A,E))):q._offsetX=C.pt2px(h||0);const t=r.offsetY;d.isFunction(t)?q._dynamicPropertyMap.set("_offsetY",(w,A,E)=>C.pt2px(-t(w,A,E))):q._offsetY=C.pt2px(-t||0);m=r.scaleX;d.isFunction(m)?q._dynamicPropertyMap.set("_scaleX",m):q._scaleX=m||1;const v=r.angle;d.isFunction(v)?q._dynamicPropertyMap.set("_angle",
(w,A,E)=>x.radToByte(v(w,A,E))):q._angle=x.radToByte(v)||0;D.isSome(r.effects)&&(m=r.effects,d.isFunction(m)?q._dynamicPropertyMap.set("_effects",m):q._effects=m);q._cimFillLayer=r;q._bitset=(r.colorLocked?y.BITSET_GENERIC_LOCK_COLOR:0)|(r.applyRandomOffset?y.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(r.sampleAlphaOnly?y.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);q._fillMaterialKey=f.FillMaterialKey.load(r.materialKey);return q}z._inheritsLoose(k,l);k.fromCIMFill=function(r,g){const [c,m]=d.getMinMaxZoom(r.scaleInfo,
g);return new k(r,c,m)};k.prototype.bindFeature=function(r,g,c){const m=r.readLegacyFeature();this._dynamicPropertyMap.forEach((u,h)=>{this[h]=u(m,g,c)});r=this._fillMaterialKey;var q=this._materialCache,p=this._cimFillLayer.materialHash;p=p(m,g,c);p=q.get(p);q=null;p&&e.ok(p.spriteMosaicItem)&&(q=p.spriteMosaicItem);if(q){const {rect:u,width:h,height:t}=q;p=u.x+y.SPRITE_PADDING;const v=u.y+y.SPRITE_PADDING,w=p+h,A=v+t;let E=Math.round(C.pt2px(this._height));0>=E&&(E=A-v);let G=Math.round(C.pt2px(this._height/
t*h||0));0>=G&&(G=w-p);const F=this._scaleX;this.tl=n.i1616to32(p,v);this.br=n.i1616to32(w,A);this.aux2_1=n.i1616to32(G,E);this.aux2_2=n.i1616to32(this._offsetX,this._offsetY);this.aux3=n.i8888to32(F,1,this._angle,0);r.sdf=q.sdf;r.pattern=!0;r.textureBinding=q.textureBinding}else this.aux3=this.aux2_2=this.aux2_1=this.br=this.tl=0,r.sdf=!1,r.pattern=!1,r.textureBinding=0;this._materialKey=r.data};return k}(a(b))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../Utils ../../materialKey/MaterialKey ./templateUtils ./WGLLineTemplate".split(" "),
function(z,D,C,B,y,x,n,f,d){return a=>function(b){function e(...k){k=b.call(this,...k)||this;k.forceLibtess=!1;k._bitset=0;k._lineTemplate=null;k.geometryType=B.WGLGeometryType.FILL;return k}z._inheritsLoose(e,b);var l=e.prototype;l._maybeAddLineTemplate=function(k){this._lineTemplate=d.fromFillOutline(k)};l._write=function(k,r,g,c){g="esriGeometryPoint"===r.geometryType;const m=n.FillMaterialKey.load(this._materialKey);k.recordStart(r.getDisplayId(),this._materialKey,this.geometryType,g);this._writeGeometry(k,
r,m,c,g);n.hasOutlineFillSymbology(m)&&D.isSome(this._lineTemplate)&&this._lineTemplate.writeGeometry(k,r,c,g);k.recordEnd()};l._writeGeometry=function(k,r,g,c,m){c=this._getGeometry(r,c,m);D.isNone(c)||(m=[],100<c.maxLength||this.forceLibtess||!f.triangulate(m,c)?(c=f.triangulateLibtess(c),this._writeVertices(k,r,c,[c.length/2],g)):m.length&&this._writeVertices(k,r,c.coords,c.lengths,g,m))};l._writeVertex=function(k,r,g,c,m,q){const p=y.i1616to32(1*c,1*m);k.vertexBounds(c,m,0,0);k.vertexWrite(p);
k.vertexWrite(r);g.symbologyType===B.WGLSymbologyType.DOT_DENSITY?k.vertexWriteF32(1/Math.abs(q.readGeometryArea())):(k.vertexWrite(this.fillColor),r=n.hasSimpleSymbology(g),r||(k.vertexWrite(this.tl),k.vertexWrite(this.br)),k.vertexWrite(this.aux2_1),k.vertexWrite(this.aux2_2),k.vertexWrite(this.aux3),r||k.vertexWrite(this._minMaxZoom))};l._writeVertices=function(k,r,g,c,m,q){var p=r.getDisplayId();p|=this._bitset<<24;var u=c.reduce((t,v)=>t+v);const h=x.getStrides(m.geometryType,m.symbologyType).geometry/
4;c=k.vertexCount();k.vertexEnsureSize(h*u);u=0;if(q)for(const t of q)this._writeVertex(k,p,m,g[2*t],g[2*t+1],r),u++;else for(q=0;q<g.length;q+=2)this._writeVertex(k,p,m,Math.round(g[q]),Math.round(g[q+1]),r),u++;k.indexEnsureSize(u);for(r=0;r<u;r++)k.indexWrite(r+c)};l._getGeometry=function(k,r,g){return(k=r?C.deltaDecodeGeometry(C.convertFromGeometry(r),2):k.readGeometryForDisplay())?f.clipMarshall(k,g?256:8):null};return e}(a)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../chunks/earcut ../../../../../../geometry/libtess ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../../Geometry ../../TileClipper ../bufcut".split(" "),
function(z,D,C,B,y,x,n,f,d){function a(k,r,g){let c=0;for(let m=1;m<g;m++)c+=(k[2*(r+m)]-k[2*(r+m-1)])*(k[2*(r+m)+1]+k[2*(r+m-1)+1]);return c}function b(k,r,g,c,m){let q=0;for(;g<c;g+=3){const p=2*(k[g]-m),u=2*(k[g+1]-m),h=2*(k[g+2]-m);q+=Math.abs((r[p]-r[h])*(r[u+1]-r[p+1])-(r[p]-r[u])*(r[h+1]-r[p+1]))}return q}const e=new f.TileClipper(0,0,0,1,0),l=new f.TileClipper(0,0,0,1,0);e.setExtent(x.TILE_SIZE);l.setExtent(x.TILE_SIZE);z.area=a;z.clipLinesMarshall=function(k,r){l.setPixelMargin(r);const g=
-r;r=x.TILE_SIZE+r;let c=[];var m=!1;let q=0;for(;q<k.length;){const p=[],u=k[q];if(!u)return null;l.reset(n.GeometryType.LineString);let [h,t]=u[0];if(m)l.moveTo(h,t);else{if(h<g||h>r||t<g||t>r){m=!0;continue}p.push({x:h,y:t})}let v=!1;const w=u.length;for(let A=1;A<w;++A)if(h+=u[A][0],t+=u[A][1],m)l.lineTo(h,t);else{if(h<g||h>r||t<g||t>r){v=!0;break}p.push({x:h,y:t})}if(v)m=!0;else{if(m){if(m=l.resultWithStarts())for(const A of m)c.push(A)}else c.push({line:p,start:0});q++;m=!1}}c=c.filter(p=>1<
p.line.length);return 0===c.length?null:c};z.clipMarshall=function(k,r){if(D.isNone(k))return null;a:{var g=x.TILE_SIZE+128;var c=0;for(var m=0;m<k.lengths.length;m++){var q=k.lengths[m];for(var p=0;p<q;p++){const u=k.coords[2*(p+c)],h=k.coords[2*(p+c)+1];if(-128>u||u>g||-128>h||h>g){g=!0;break a}}c+=q}g=!1}if(!g)return k;e.setPixelMargin(r);e.reset(n.GeometryType.Polygon);r=0;for(g=0;g<k.lengths.length;g++){c=k.lengths[g];m=k.coords[2*(0+r)];q=k.coords[2*(0+r)+1];e.moveTo(m,q);for(p=1;p<c;p++)m=
k.coords[2*(p+r)],q=k.coords[2*(p+r)+1],e.lineTo(m,q);e.close();r+=c}g=e.result(!1);if(!g)return null;k=[];r=[];for(const u of g){g=0;for(const h of u)r.push(h.x),r.push(h.y),g++;k.push(g)}return new y(k,r)};z.triangleArea=function(k,r,g,c,m){let q=0;for(;g<c;g+=3){const p=2*(k.getValue(g)-m),u=2*(k.getValue(g+1)-m),h=2*(k.getValue(g+2)-m);q+=Math.abs((r[p]-r[h])*(r[u+1]-r[p+1])-(r[p]-r[u])*(r[h+1]-r[p+1]))}return q};z.triangleAreaArray=b;z.triangulate=function(k,r){const {coords:g,lengths:c,hasIndeterminateRingOrder:m}=
r;if(m)return!1;r=0;for(var q=0;q<c.length;){let h=q,t=c[q];q=a(g,r,t);for(var p=[];++h<c.length;){var u=c[h];const v=a(g,r+t,u);if(!(0<v))break;q+=v;p.push(r+t);t+=u}u=k.length;d.bufcut(k,g,r,r+t,p,2,0);p=b(k,g,u,k.length,0);q=Math.abs(q);if(1E-5<Math.abs((p-q)/Math.max(1E-7,q)))return k.length=0,!1;q=h;r+=t}return!0};z.triangulateEarcut=function(k,r,g){const {coords:c,lengths:m,hasIndeterminateRingOrder:q}=r;if(q)return!1;let p=0;for(var u=0;u<m.length;){let t=u,v=m[u];for(u=[];++t<m.length;){var h=
m[t];if(!(0<a(c,p+v,h)))break;u.push(p+v-p);v+=h}h=r.coords.slice(2*p,2*(p+v));u=C.earcut(h,u,2);for(const w of u)k.push(w+g+p);u=t;p+=v}return!0};z.triangulateLibtess=function(k){const {coords:r,lengths:g}=k;({buffer:k}=B.triangulate(r,g));return k};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports"],function(z){function D(h,t,v,w,A,E,G){let F;v=0;for(let H=w,J=A-E;H<A;H+=E)v+=(h[J+t*E]-
h[H+t*E])*(h[H+1+t*E]+h[J+1+t*E]),J=H;if(G===0<v)for(;w<A;w+=E)F=x(w+t*E,h[w+t*E],h[w+1+t*E],F);else for(A-=E;A>=w;A-=E)F=x(A+t*E,h[A+t*E],h[A+1+t*E],F);F&&g(F,F.next)&&(n(F),F=F.next);return F}function C(h,t=h){if(!h)return h;let v;do if(v=!1,h.steiner||!g(h,h.next)&&0!==b(h.prev,h,h.next))h=h.next;else{n(h);h=t=h.prev;if(h===h.next)break;v=!0}while(v||h!==t);return t}function B(h,t,v,w,A,E,G,F){if(h){!F&&E&&(h=a(h,w,A,E));for(var H=h;h.prev!==h.next;){var J=h.prev,I=h.next;if(E)var N=y(h,w,A,E);
else a:{N=h;var M=N.prev,K=N;const O=N.next;if(0<=b(M,K,O)){N=!1;break a}let X=N.next.next;const aa=X;let ba=0;for(;X!==N.prev&&(0===ba||X!==aa);){ba++;if(l(M.x,M.y,K.x,K.y,O.x,O.y,X.x,X.y)&&0<=b(X.prev,X,X.next)){N=!1;break a}X=X.next}N=!0}if(N)t.push(J.index/v+G),t.push(h.index/v+G),t.push(I.index/v+G),n(h),H=h=I.next;else if(h=I,h===H){if(!F)B(C(h),t,v,w,A,E,G,1);else if(1===F){F=t;H=v;J=G;I=h;do N=I.prev,M=I.next.next,!g(N,M)&&e(N,I,I.next,M)&&k(N,M)&&k(M,N)&&(F.push(N.index/H+J),F.push(I.index/
H+J),F.push(M.index/H+J),n(I),n(I.next),I=h=M),I=I.next;while(I!==h);h=I;B(h,t,v,w,A,E,G,2)}else if(2===F)a:{F=h;do{for(H=F.next.next;H!==F.prev;){if(J=F.index!==H.index){N=N=N=void 0;J=F;I=H;if(N=J.next.index!==I.index&&J.prev.index!==I.index){b:{N=J;do{if(N.index!==J.index&&N.next.index!==J.index&&N.index!==I.index&&N.next.index!==I.index&&e(N,N.next,J,I)){N=!0;break b}N=N.next}while(N!==J);N=!1}N=!N}if(N=N&&k(J,I)&&k(I,J)){N=J;M=!1;K=(J.x+I.x)/2;I=(J.y+I.y)/2;do N.y>I!==N.next.y>I&&N.next.y!==
N.y&&K<(N.next.x-N.x)*(I-N.y)/(N.next.y-N.y)+N.x&&(M=!M),N=N.next;while(N!==J);N=M}J=N}if(J){h=m(F,H);F=C(F,F.next);h=C(h,h.next);B(F,t,v,w,A,E,G,0);B(h,t,v,w,A,E,G,0);break a}H=H.next}F=F.next}while(F!==h)}break}}}}function y(h,t,v,w){const A=h.prev,E=h.next;if(0<=b(A,h,E))return!1;const G=A.x>h.x?A.x>E.x?A.x:E.x:h.x>E.x?h.x:E.x,F=A.y>h.y?A.y>E.y?A.y:E.y:h.y>E.y?h.y:E.y,H=r(A.x<h.x?A.x<E.x?A.x:E.x:h.x<E.x?h.x:E.x,A.y<h.y?A.y<E.y?A.y:E.y:h.y<E.y?h.y:E.y,t,v,w);t=r(G,F,t,v,w);v=h.prevZ;for(w=h.nextZ;v&&
v.z>=H&&w&&w.z<=t;){if(v!==h.prev&&v!==h.next&&l(A.x,A.y,h.x,h.y,E.x,E.y,v.x,v.y)&&0<=b(v.prev,v,v.next))return!1;v=v.prevZ;if(w!==h.prev&&w!==h.next&&l(A.x,A.y,h.x,h.y,E.x,E.y,w.x,w.y)&&0<=b(w.prev,w,w.next))return!1;w=w.nextZ}for(;v&&v.z>=H;){if(v!==h.prev&&v!==h.next&&l(A.x,A.y,h.x,h.y,E.x,E.y,v.x,v.y)&&0<=b(v.prev,v,v.next))return!1;v=v.prevZ}for(;w&&w.z<=t;){if(w!==h.prev&&w!==h.next&&l(A.x,A.y,h.x,h.y,E.x,E.y,w.x,w.y)&&0<=b(w.prev,w,w.next))return!1;w=w.nextZ}return!0}function x(h,t,v,w){h=
q.create(h,t,v);w?(h.next=w.next,h.prev=w,w.next.prev=h,w.next=h):(h.prev=h,h.next=h);return h}function n(h){h.next.prev=h.prev;h.prev.next=h.next;h.prevZ&&(h.prevZ.nextZ=h.nextZ);h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function f(h){let t=h,v=h;do{if(t.x<v.x||t.x===v.x&&t.y<v.y)v=t;t=t.next}while(t!==h);return v}function d(h,t){let v=t;const w=h.x,A=h.y;let E=-Infinity,G;do{if(A<=v.y&&A>=v.next.y&&v.next.y!==v.y){var F=v.x+(A-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(F<=w&&F>E){E=F;if(F===w){if(A===v.y)return v;
if(A===v.next.y)return v.next}G=v.x<v.next.x?v:v.next}}v=v.next}while(v!==t);if(!G)return null;if(w===E)return G.prev;t=G;F=G.x;const H=G.y;let J=Infinity,I;for(v=G.next;v!==t;)w>=v.x&&v.x>=F&&w!==v.x&&l(A<H?w:E,A,F,H,A<H?E:w,A,v.x,v.y)&&(I=Math.abs(A-v.y)/(w-v.x),(I<J||I===J&&v.x>G.x)&&k(v,h)&&(G=v,J=I)),v=v.next;return G}function a(h,t,v,w){for(var A;A!==h;A=A.next){A=A||h;null===A.z&&(A.z=r(A.x,A.y,t,v,w));if(A.prev.next!==A||A.next.prev!==A)return A.prev.next=A,A.next.prev=A,a(h,t,v,w);A.prevZ=
A.prev;A.nextZ=A.next}h.prevZ.nextZ=null;h.prevZ=null;a:for(v=1;;){w=h;t=h=null;let E=0;for(;w;){E++;A=w;let G=0;for(;G<v&&A;G++)A=A.nextZ;let F=v;for(;0<G||0<F&&A;){let H;0===G?(H=A,A=A.nextZ,F--):0!==F&&A?w.z<=A.z?(H=w,w=w.nextZ,G--):(H=A,A=A.nextZ,F--):(H=w,w=w.nextZ,G--);t?t.nextZ=H:h=H;H.prevZ=t;t=H}w=A}t.nextZ=null;v*=2;if(2>E)break a}return h}function b(h,t,v){return(t.y-h.y)*(v.x-t.x)-(t.x-h.x)*(v.y-t.y)}function e(h,t,v,w){return g(h,t)&&g(v,w)||g(h,w)&&g(v,t)?!0:0<b(h,t,v)!==0<b(h,t,w)&&
0<b(v,w,h)!==0<b(v,w,t)}function l(h,t,v,w,A,E,G,F){return 0<=(A-G)*(t-F)-(h-G)*(E-F)&&0<=(h-G)*(w-F)-(v-G)*(t-F)&&0<=(v-G)*(E-F)-(A-G)*(w-F)}function k(h,t){return 0>b(h.prev,h,h.next)?0<=b(h,t,h.next)&&0<=b(h,h.prev,t):0>b(h,t,h.prev)||0>b(h,h.next,t)}function r(h,t,v,w,A){h=32767*(h-v)*A;t=32767*(t-w)*A;h=(h|h<<8)&16711935;h=(h|h<<4)&252645135;h=(h|h<<2)&858993459;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;return(h|h<<1)&1431655765|((t|t<<1)&1431655765)<<1}function g(h,t){return h.x===
t.x&&h.y===t.y}function c(h,t){return h.x-t.x}function m(h,t){const v=q.create(h.index,h.x,h.y),w=q.create(t.index,t.x,t.y),A=h.next,E=t.prev;h.next=t;t.prev=h;v.next=A;A.prev=v;w.next=v;v.prev=w;E.next=w;w.prev=E;return w}let q=function(){function h(){this.y=this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}h.create=function(t,v,w){const A=u<p.length?p[u++]:new h;A.index=t;A.x=v;A.y=w;A.prev=null;A.next=null;A.z=null;A.prevZ=null;A.nextZ=null;A.steiner=!1;
return A};return h}();const p=[];let u=0;for(let h=0;8096>h;h++)p.push(new q);z.bufcut=function(h,t,v,w,A,E,G){u=0;var F=(w-v)*E,H=A&&A.length;const J=H?(A[0]-v)*E:F;var I=D(t,v,w,0,J,E,!0);if(I&&I.next!==I.prev){var N;if(H){H=[];for(let X=0,aa=A.length;X<aa;X++){const ba=D(t,v,w,A[X]*E,X<aa-1?A[X+1]*E:w*E,E,!1);ba===ba.next&&(ba.steiner=!0);H.push(f(ba))}H.sort(c);for(var M of H){w=M;A=I;if(A=d(w,A))w=m(A,w),C(w,w.next);I=C(I,I.next)}}if(F>80*E){var K=F=t[v*E];var O=N=t[1+v*E];for(M=E;M<J;M+=E)w=
t[M+v*E],A=t[M+1+v*E],K=Math.min(K,w),O=Math.min(O,A),F=Math.max(F,w),N=Math.max(N,A);N=Math.max(F-K,N-O);N=0!==N?1/N:0}B(I,h,E,K,O,N,G,0)}};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e){const l=D.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");return function(k){function r(g,c,m,q,p,u,h,t,v,w,A,E,G,F,H,J,I,N,M,K){var O=k.call(this)||this;g=d.LineMaterialKey.load(g);c&&(g.sdf=c.sdf,g.pattern=!0,g.textureBinding=c.textureBinding);O._capType=q;O._joinType=p;O._miterLimitCosine=a.getLimitCosine(u);O.tessellationProperties._fillColor=h;O.tessellationProperties._tl=t;O.tessellationProperties._br=v;O._hasPattern=w;O._isDashed=A;O._zOrder=I;O._effects=
N;O._minMaxZoom=n.i1616to32(Math.round(M*x.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(K*x.MIN_MAX_ZOOM_PRECISION_FACTOR));O._materialKey=g.data;O.tessellationProperties._bitset=(G?x.BITSET_GENERIC_LOCK_COLOR:0)|(F?x.BITSET_TYPE_FILL_OUTLINE:0)|(E?x.BITSET_LINE_SCALE_DASH:0)|(H?x.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);O.tessellationProperties._halfWidth=.5*m;O.tessellationProperties._halfReferenceWidth=.5*J;O.tessellationProperties.offset=0;O._initializeTessellator(!1);return O}z._inheritsLoose(r,k);
r.fromCIMLine=function(g,c,m){var q=g.color,p=g.scaleFactor||1;const u=!!g.dashTemplate;let h=g.cap;u&&h===B.CapType.ROUND&&(h=B.CapType.SQUARE);const t=g.join;p*=C.pt2px(g.width);const v=C.pt2px(g.referenceWidth),w=C.pt2px(g.miterLimit);q=q&&y.premultiplyAlphaRGBA(q)||0;const [A,E]=a.getMinMaxZoom(g.scaleInfo,m);if(!c)return new r(g.materialKey,c,p,h,t,w,q,0,0,!1,u,g.scaleDash,g.colorLocked,!1,g.sampleAlphaOnly,v,g.zOrder,g.effects,A,E);const {rect:G,width:F,height:H}=c;var J=G.x+x.SPRITE_PADDING;
const I=G.y+x.SPRITE_PADDING;m=J+F;const N=I+H;J=n.i1616to32(J,I);m=n.i1616to32(m,N);return new r(g.materialKey,c,p,h,t,w,q,J,m,!0,u,g.scaleDash,g.colorLocked,!1,g.sampleAlphaOnly,v,g.zOrder,g.effects,A,E)};r.fromFillOutline=function(g){var c;const m=d.FillMaterialKey.load(g.materialKey);return d.hasOutlineFillSymbology(m)&&g.outline&&"esriSLSSolid"===(null==(c=g.outline)?void 0:c.style)?r.fromSimpleLine({hash:"",materialKey:g.materialKey,...g.outline},null,!0):null};r.fromSimpleLine=function(g,c,
m=!1){var {color:q}=g;const p="esriSLSSolid"!==g.style&&"esriSLSNull"!==g.style,u=f.getCapType(g.cap||"round"),h=f.getJoinType(g.join||"round");q=q&&"esriSLSNull"!==g.style&&y.premultiplyAlphaRGBAArray(q)||0;"esriSLSNull"===g.style&&(q=0);const t=C.pt2px(g.width),v=g.miterLimit;if(!c)return new r(g.materialKey,c,t,u,h,v,q,0,0,!1,p,!0,!1,m,!1,t,0,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM);const {rect:w,width:A,height:E}=c;var G=w.x+x.SPRITE_PADDING;const F=w.y+x.SPRITE_PADDING;var H=G+A;const J=F+
E;G=n.i1616to32(G,F);H=n.i1616to32(H,J);return new r(g.materialKey,c,t,u,h,v,q,G,H,!0,p,!0,!1,m,!1,t,0,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM)};r.fromPictureLineSymbol=function(g,c,m,q){l.error("PictureLineSymbol support does not exist!");return null};return r}(b(e))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../enums ../../number ../../TurboLine ../../materialKey/MaterialKey ./templateUtils".split(" "),
function(z,D,C,B,y,x,n,f){const d=(e,l,k)=>(r,g,c,m,q,p,u,h,t,v,w)=>{c=y.i1616to32(w,Math.ceil(16*e._halfWidth));u=y.i8888to32(Math.round(16*u),Math.round(16*h),Math.round(16*t),Math.round(16*v));q=y.i8888to32(16*q,16*p,0,e._bitset);p=e.out;p.vertexBounds(r,g,l,k);p.vertexWrite(y.i1616to32(8*r,8*g));p.vertexWrite(e.id);p.vertexWrite(e._fillColor);p.vertexWrite(u);p.vertexWrite(c);p.vertexWrite(e._tl);p.vertexWrite(e._br);p.vertexWrite(q);p.vertexWrite(y.i1616to32(Math.ceil(16*e._halfReferenceWidth),
0));p.vertexWrite(e.minMaxZoom);p.vertexEnd();return e.offset+e.vertexCount++},a=(e,l,k)=>(r,g,c,m,q,p,u,h,t,v,w)=>{c=y.i1616to32(16*e._halfWidth,16*e._halfReferenceWidth);u=y.i8888to32(16*u+128,16*h+128,16*t+128,16*v+128);h=e.out;t=e._bitset<<24|e.id;h.vertexBounds(r,g,l,k);h.vertexWrite(y.i1616to32(8*r,8*g));h.vertexWrite(t);h.vertexWrite(e._fillColor);r=n.hasSimpleSymbology(e.key);r||(h.vertexWrite(0),h.vertexWrite(0));h.vertexWrite(0);h.vertexWrite(c);h.vertexWrite(u);r||h.vertexWrite(e.minMaxZoom);
h.vertexEnd();return e.offset+e.vertexCount++},b=e=>(l,k,r)=>{const g=e.out;g.indexWrite(l);g.indexWrite(k);g.indexWrite(r);e.indexCount+=3};return e=>function(l){function k(...g){g=l.call(this,...g)||this;g.tessellationProperties={};g._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0};g.geometryType=B.WGLGeometryType.LINE;return g}z._inheritsLoose(k,l);var r=k.prototype;r.writeGeometry=function(g,c,m,q){this._writeGeometry(g,c,m,q)};r._initializeTessellator=function(g){var c=n.LineMaterialKey.load(this._materialKey),
m=n.FillMaterialKey.load(this._materialKey),q=this._tessellationOptions;c=c.vvSizeFieldStops||c.vvSizeMinMaxValue||c.vvSizeScaleStops||c.vvSizeUnitValue;g=this.tessellationProperties._halfWidth<C.THIN_LINE_HALF_WIDTH_THRESHOLD&&!g&&!c;this.tessellationProperties.minMaxZoom=this._minMaxZoom;q.wrapDistance=65535;q.textured=this._isDashed||this._hasPattern;q.offset=this.tessellationProperties.offset;q.halfWidth=this.tessellationProperties._halfWidth;q=g?0:1;m=n.hasOutlineFillSymbology(m)?a:d;this._lineTessellator=
new x.LineTessellation(m(this.tessellationProperties,q,q),b(this.tessellationProperties),g)};r._write=function(g,c,m,q){m="esriGeometryPoint"===c.geometryType;g.recordStart(c.getDisplayId(),this._materialKey,this.geometryType,m);this._writeGeometry(g,c,q,m);g.recordEnd()};r._writeGeometry=function(g,c,m,q){m=null!=m?m:c.readLegacyGeometryForDisplay();q=this._getLines(m,q);D.isNone(q)||this._writeVertices(g,c,q)};r._getLines=function(g,c){if(D.isNone(g))return null;g=g.paths||g.rings;return D.isNone(g)?
null:f.clipLinesMarshall(g,c?256:16)};r._writeVertices=function(g,c,m){const q=c.getDisplayId(),p=g.vertexCount(),u=this.tessellationProperties;c=this._tessellationOptions;u.out=g;u.id=q;u.indexCount=0;u.vertexCount=0;u.offset=p;c.capType=this._capType;c.joinType=this._joinType;g=n.FillMaterialKey.load(this._materialKey);this.tessellationProperties.key=n.hasOutlineFillSymbology(g)?g:n.LineMaterialKey.load(this._materialKey);for(const {line:h,start:t}of m)c.initialDistance=t%65535,this._lineTessellator.tessellate(h,
c)};return k}(e)})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/Logger","../../../../../../symbols/cim/cimAnalyzer","../../../../../../symbols/cim/utils","./WGLMeshTemplate"],function(z,D,C,B,y){const x=D.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(n){function f(d){var a=n.call(this)||this;a._ongoingMaterialRequestMap=new Map;a._materialCache=new Map;
a._dynamicPropertyMap=new Map;a._cimLayer=d;return a}z._inheritsLoose(f,n);f.prototype.analyze=function(d,a,b,e,l){if(l&&0===l.length)return null;const k=l&&0<l.length,r=a.readLegacyFeature();a=a.getObjectId();const g=this._materialCache;var c=this._cimLayer.materialHash;if(!c)return x.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);const m="function"===typeof c?c(r,b,e,a):c;if(g.has(m))return d=g.get(m),Promise.resolve(d);if(c=this._ongoingMaterialRequestMap.get(m))return c;
c=this._cimLayer;const q=C.analyzeCIMResource(c.cim,this._cimLayer.materialOverrides);q.mosaicHash=m;const {type:p,url:u}=c;a={cim:q,type:p,mosaicHash:m,url:u,size:null,dashTemplate:null,text:null,fontName:null,objectId:a,animatedSymbolProperties:null};switch(p){case "marker":a.size=B.evaluateValueOrFunction(c.size,r,b,e);a.animatedSymbolProperties=B.evaluateValueOrFunction(c.animatedSymbolProperties,r,b,e);break;case "line":a.dashTemplate=c.dashTemplate;break;case "text":a.text=B.evaluateValueOrFunction(c.text,
r,b,e),a.fontName=B.evaluateValueOrFunction(c.fontName,r,b,e)}d=d.getMosaicItem(a,l).then(h=>{k||(this._ongoingMaterialRequestMap.delete(m),g.set(m,h));return h}).catch(h=>{this._ongoingMaterialRequestMap.delete(m);x.error(".analyze()",h.message);return null});k||this._ongoingMaterialRequestMap.set(m,d);return d};return f}(y)})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/lang ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./SDFHelper ./utils ./effects/CIMEffectHelper ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/fontUtils ../../views/2d/engine/webgl/grouping".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g,c,m){function q(T){switch(T){case "Butt":return b.CapType.BUTT;case "Square":return b.CapType.SQUARE;default:return b.CapType.ROUND}}function p(T){switch(T){case "Bevel":return b.JoinType.BEVEL;case "Miter":return b.JoinType.MITER;default:return b.JoinType.ROUND}}function u(T){switch(T){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return ca.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),
"center"}}function h(T){switch(T){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}}function t(T){let da="",fa="";T&&(T=T.toLowerCase(),T.includes("italic")?da="italic":T.includes("oblique")&&(da="oblique"),T.includes("bold")?fa="bold":T.includes("light")&&(fa="lighter"));return{style:da,weight:fa}}function v(T,da,fa,ka){let ea;T[da]?ea=T[da]:(ea={},T[da]=ea);ea[fa]=ka}function w(T){return(T=T.markerPlacement)&&T.angleToLine?b.Alignment.MAP:
b.Alignment.SCREEN}function A(){A=D._asyncToGenerator(function*(T,da,fa,ka,ea){ka=null!=ka?ka:[];if(!T)return ka;let ha;const ja={};if("CIMSymbolReference"===T.type){if(ha=T.symbol,T=T.primitiveOverrides){var la=[];for(const oa of T){var ma=oa.valueExpressionInfo;ma&&da?(ma=d.createRendererExpression(ma.expression,da.spatialReference,da.fields).then(pa=>{pa&&v(ja,oa.primitiveName,oa.propertyName,pa)}),la.push(ma)):null!=oa.value&&v(ja,oa.primitiveName,oa.propertyName,oa.value)}0<la.length&&(yield Promise.all(la))}}else return ca.error("Expect cim type to be 'CIMSymbolReference'"),
ka;la=[];S(ha,fa,la);0<la.length&&(yield Promise.all(la));switch(ha.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":E(ha,T,ja,da,ka,fa,ea)}return ka});return A.apply(this,arguments)}function E(T,da,fa,ka,ea,ha,ja){if(T){var la=T.symbolLayers;if(la){var ma=T.effects,oa=a.CIMSymbolHelper.getSize(T);if("CIMPointSymbol"===T.type&&"Map"===T.angleAlignment)var pa=b.Alignment.MAP;for(var ua=la.length;ua--;){var na=la[ua];if(!na||!1===na.enable)continue;let xa;ma&&ma.length&&(xa=
[...ma]);var ra=na.effects;ra&&ra.length&&(ma?xa.push(...ra):xa=[...ra]);ra=[];a.OverrideHelper.findEffectOverrides(xa,da,ra);ra=0<ra.length?Y(xa,ra,fa,ka):xa;var ta=[];a.OverrideHelper.findApplicableOverrides(na,da,ta);switch(na.type){case "CIMSolidFill":G(na,ra,fa,ta,ka,ea);break;case "CIMPictureFill":F(na,ra,fa,ta,ka,ha,ea);break;case "CIMHatchFill":H(na,ra,fa,ta,ka,ea);break;case "CIMGradientFill":{var sa=fa,qa=ka,wa=ea;const [Ca,Ha]=R(ta,na.primitiveName,ra,null,null);var va=f.numericHash(JSON.stringify(na)+
Ha).toString();wa.push({type:"fill",templateHash:va,materialHash:Ca?W(va,sa,ta,qa):va,cim:na,materialOverrides:null,colorLocked:na.colorLocked,effects:ra,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,sampleAlphaOnly:!1})}break;case "CIMSolidStroke":J(na,ra,fa,ta,ka,ea,"CIMPolygonSymbol"===T.type,oa);break;case "CIMPictureStroke":I(na,ra,fa,ta,ka,ea,"CIMPolygonSymbol"===T.type,oa);break;case "CIMGradientStroke":{sa=fa;qa=ka;wa=ea;va="CIMPolygonSymbol"===
T.type;var za=oa,ya=na.primitiveName,Ea=void 0!==na.width?na.width:4,Ba=q(na.capStyle),Aa=p(na.joinStyle),Da=na.miterLimit;const [Ca,Ha]=R(ta,ya,ra,null,null),Ga=f.numericHash(JSON.stringify(na)+Ha).toString();wa.push({type:"line",templateHash:Ga,materialHash:Ca?W(Ga,sa,ta,qa):Ga,cim:na,materialOverrides:null,isOutline:va,colorLocked:na.colorLocked,effects:ra,color:{r:128,g:128,b:128,a:1},width:L(ya,sa,"Width",qa,Ea),cap:L(ya,sa,"CapStyle",qa,Ba),join:L(ya,sa,"JoinStyle",qa,Aa),miterLimit:L(ya,sa,
"MiterLimit",qa,Da),referenceWidth:za,zOrder:ba(na.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1})}break;case "CIMCharacterMarker":N(na,ra,fa,ta,ka,ea);break;case "CIMPictureMarker":if(N(na,ra,fa,ta,ka,ea))break;"CIMLineSymbol"===T.type&&(pa=w(na));M(na,ra,fa,ta,ka,ha,ea,pa,oa);break;case "CIMVectorMarker":if(N(na,ra,fa,ta,ka,ea))break;"CIMLineSymbol"===T.type&&(pa=w(na));sa=fa;qa=ka;wa=ea;va=ha;za=pa;ya=oa;Ea=ja;if(Aa=na.markerGraphics){Ba=0;na.scaleSymbolsProportionally&&(Da=na.frame)&&
(Ba=Da.ymax-Da.ymin);Da=U(na.markerPlacement,ta,sa,qa);for(const Ca of Aa)if(Ca&&(Aa=Ca.symbol))switch(Aa.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":O(na,ra,Da,null,Ca,ta,sa,qa,wa,va,za,ya,Ba,Ea);break;case "CIMTextSymbol":K(na,ra,Da,Ca,sa,ta,qa,wa,za,ya,Ba)}}break;default:ca.error("Cannot analyze CIM layer",na.type)}}}}}function G(T,da,fa,ka,ea,ha){const ja=T.primitiveName,la=l.fromCIMColor(T.color),[ma,oa]=R(ka,ja,da,null,null),pa=f.numericHash(JSON.stringify(T)+oa).toString();
ha.push({type:"fill",templateHash:pa,materialHash:ma?()=>pa:pa,cim:T,materialOverrides:null,colorLocked:T.colorLocked,color:L(ja,fa,"Color",ea,la,V),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:da,applyRandomOffset:!1,sampleAlphaOnly:!0})}function F(T,da,fa,ka,ea,ha,ja){const la=T.primitiveName,ma=T.tintColor?l.fromCIMColor(T.tintColor):{r:255,g:255,b:255,a:1},[oa,pa]=R(ka,la,da,null,null);ka=f.numericHash(JSON.stringify(T)+pa).toString();const ua=f.numericHash(`${T.url}${JSON.stringify(T.colorSubstitutions)}`).toString();
let na=l.getValue(T.scaleX);if("width"in T){const ra=T.width;let ta=1;ha=ha.getResource(T.url);x.isSome(ha)&&(ta=ha.width/ha.height);na/=T.height/ra*ta}ja.push({type:"fill",templateHash:ka,materialHash:oa?()=>ua:ua,cim:T,materialOverrides:null,colorLocked:T.colorLocked,effects:da,color:L(la,fa,"TintColor",ea,ma,V),height:L(la,fa,"Height",ea,T.height),scaleX:L(la,fa,"ScaleX",ea,na),angle:L(la,fa,"Rotation",ea,l.getValue(T.rotation)),offsetX:L(la,fa,"OffsetX",ea,l.getValue(T.offsetX)),offsetY:L(la,
fa,"OffsetY",ea,l.getValue(T.offsetY)),url:T.url,applyRandomOffset:!1,sampleAlphaOnly:!1})}function H(T,da,fa,ka,ea,ha){const ja=["Rotation","OffsetX","OffsetY"],la=ka.filter(ta=>ta.primitiveName!==T.primitiveName&&!ja.includes(ta.propertyName)),ma=T.primitiveName,[oa,pa]=R(ka,ma,da,null,null);ka=f.numericHash(JSON.stringify(T)+pa).toString();const ua=f.numericHash(`${T.separation}${JSON.stringify(T.lineSymbol)}`).toString();let na={r:255,g:255,b:255,a:1};if(T.lineSymbol){var ra;const ta=null==(ra=
T.lineSymbol)?void 0:ra.symbolLayers.find(sa=>"CIMSolidStroke"===sa.type);ta&&(na=l.fromCIMColor(ta.color))}ha.push({type:"fill",templateHash:ka,materialHash:oa?W(ua,fa,la,ea):ua,cim:T,materialOverrides:la,colorLocked:T.colorLocked,effects:da,color:na,height:L(ma,fa,"Separation",ea,T.separation),scaleX:1,angle:L(ma,fa,"Rotation",ea,l.getValue(T.rotation)),offsetX:L(ma,fa,"OffsetX",ea,l.getValue(T.offsetX)),offsetY:L(ma,fa,"OffsetY",ea,l.getValue(T.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!0})}
function J(T,da,fa,ka,ea,ha,ja,la){const ma=T.primitiveName,oa=l.fromCIMColor(T.color),pa=void 0!==T.width?T.width:4,ua=q(T.capStyle),na=p(T.joinStyle),ra=T.miterLimit,[ta,sa]=R(ka,ma,da,null,null),qa=f.numericHash(JSON.stringify(T)+sa).toString();let wa;if(da&&da instanceof Array&&0<da.length&&(ka=da[da.length-1],"CIMGeometricEffectDashes"===ka.type&&"NoConstraint"===ka.lineDashEnding&&null===ka.offsetAlongLine)){da=[...da];var va=da.pop();wa=va.dashTemplate;va=va.scaleDash}ha.push({type:"line",
templateHash:qa,materialHash:ta?()=>qa:qa,cim:T,materialOverrides:null,isOutline:ja,colorLocked:T.colorLocked,effects:da,color:L(ma,fa,"Color",ea,oa,V),width:L(ma,fa,"Width",ea,pa),cap:L(ma,fa,"CapStyle",ea,ua),join:L(ma,fa,"JoinStyle",ea,na),miterLimit:L(ma,fa,"MiterLimit",ea,ra),referenceWidth:la,zOrder:ba(T.name),dashTemplate:wa,scaleDash:va,sampleAlphaOnly:!0})}function I(T,da,fa,ka,ea,ha,ja,la){const ma=f.numericHash(`${T.url}${JSON.stringify(T.colorSubstitutions)}`).toString(),oa=T.primitiveName,
pa=l.fromCIMColor(T.tintColor),ua=void 0!==T.width?T.width:4,na=q(T.capStyle),ra=p(T.joinStyle),ta=T.miterLimit,[sa,qa]=R(ka,oa,da,null,null);ka=f.numericHash(JSON.stringify(T)+qa).toString();ha.push({type:"line",templateHash:ka,materialHash:sa?()=>ma:ma,cim:T,materialOverrides:null,isOutline:ja,colorLocked:T.colorLocked,effects:da,color:L(oa,fa,"TintColor",ea,pa,V),width:L(oa,fa,"Width",ea,ua),cap:L(oa,fa,"CapStyle",ea,na),join:L(oa,fa,"JoinStyle",ea,ra),miterLimit:L(oa,fa,"MiterLimit",ea,ta),referenceWidth:la,
zOrder:ba(T.name),dashTemplate:null,scaleDash:!1,url:T.url,sampleAlphaOnly:!1})}function N(T,da,fa,ka,ea,ha){const ja=T.markerPlacement;if(!ja||"CIMMarkerPlacementInsidePolygon"!==ja.type)return!1;var la=Math.abs(ja.stepX),ma=Math.abs(ja.stepY);if(0===la||0===ma)return!0;const oa=["Rotation","OffsetX","OffsetY"],pa=ka.filter(qa=>qa.primitiveName!==T.primitiveName&&!oa.includes(qa.propertyName)),ua="url"in T?T.url:null,[na,ra]=R(ka,ja.primitiveName,da,null,null);ka=f.numericHash(JSON.stringify(T)+
ra).toString();let ta=null;if("Random"===ja.gridType){var sa=n.px2pt(g.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const qa=Math.max(Math.floor(sa/la),1),wa=Math.max(Math.floor(sa/ma),1);sa=ma*wa;ta=va=>va?va*wa:0;la=qa*la/sa}else ja.shiftOddRows?(sa=2*ma,ta=qa=>qa?2*qa:0,la=la/ma*.5):(sa=ma,ta=null,la/=ma);ma={r:255,g:255,b:255,a:1};"tintColor"in T&&(ma=l.fromCIMColor(T.tintColor));ha.push({type:"fill",templateHash:ka,materialHash:na?W(ka,fa,pa,ea):ka,cim:T,materialOverrides:pa,colorLocked:T.colorLocked,
effects:da,color:L(ja.primitiveName,fa,"TintColor",ea,ma,V),height:L(ja.primitiveName,fa,"StepY",ea,sa,ta),scaleX:la,angle:L(ja.primitiveName,fa,"GridAngle",ea,ja.gridAngle),offsetX:L(ja.primitiveName,fa,"OffsetX",ea,l.getValue(ja.offsetX)),offsetY:L(ja.primitiveName,fa,"OffsetY",ea,l.getValue(ja.offsetY)),url:ua,applyRandomOffset:"Random"===ja.gridType,sampleAlphaOnly:!ua});return!0}function M(T,da,fa,ka,ea,ha,ja,la,ma){var oa;const pa=T.primitiveName,ua=l.getValue(T.size);let na=l.getValue(T.scaleX);
const ra=l.getValue(T.rotation),ta=l.getValue(T.offsetX),sa=l.getValue(T.offsetY),qa=T.tintColor?l.fromCIMColor(T.tintColor):{r:255,g:255,b:255,a:1},wa=f.numericHash(`${T.url}${JSON.stringify(T.colorSubstitutions)}${JSON.stringify(T.animatedSymbolProperties)}`).toString(),va=U(T.markerPlacement,ka,fa,ea),za=Q(T.animatedSymbolProperties,ka,fa,ea),[ya,Ea]=R(ka,pa,da,va,za);ka=f.numericHash(JSON.stringify(T)+Ea).toString();const Ba=null!=(oa=T.anchorPoint)?oa:{x:0,y:0};if("width"in T){oa=T.width;let Aa=
1;ha=ha.getResource(T.url);x.isSome(ha)&&(Aa=ha.width/ha.height);na/=ua/oa*Aa}ja.push({type:"marker",templateHash:ka,materialHash:T.animatedSymbolProperties&&!0===T.animatedSymbolProperties.randomizeStartTime?(Aa,Da,xa,Ca)=>{xa=m.getMaterialGroup(Ca);Aa=l.evaluateValueOrFunction(za,Aa,Da);return wa+`-MATERIALGROUP(${xa})`+`-ASP(${JSON.stringify(Aa)})`}:ya?(Aa,Da)=>{Aa=l.evaluateValueOrFunction(za,Aa,Da);return wa+`-ASP(${JSON.stringify(Aa)})`}:wa,cim:T,materialOverrides:null,colorLocked:T.colorLocked,
effects:da,scaleSymbolsProportionally:!1,alignment:la,size:L(pa,fa,"Size",ea,ua),scaleX:L(pa,fa,"ScaleX",ea,na),rotation:L(pa,fa,"Rotation",ea,ra),offsetX:L(pa,fa,"OffsetX",ea,ta),offsetY:L(pa,fa,"OffsetY",ea,sa),color:L(pa,fa,"TintColor",ea,qa,V),anchorPoint:{x:Ba.x,y:-Ba.y},isAbsoluteAnchorPoint:"Relative"!==T.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:T.rotateClockwise,referenceSize:ma,sizeRatio:1,markerPlacement:va,url:T.url,animatedSymbolProperties:za})}
function K(T,da,fa,ka,ea,ha,ja,la,ma,oa,pa){a.OverrideHelper.findApplicableOverrides(ka,ha,[]);var ua=ka.geometry;if("x"in ua&&"y"in ua){var na=ka.symbol;var ra=na.underline?"underline":na.strikethrough?"line-through":"none";var ta=t(na.fontStyleName),sa=c.getFontFamily(na.fontFamilyName);na.font={family:sa,decoration:ra,...ta};var qa=T.frame,wa=ua.x-.5*(qa.xmin+qa.xmax),va=ua.y-.5*(qa.ymin+qa.ymax),za=T.size/pa;pa=T.primitiveName;ua=l.getValue(na.height)*za;qa=l.getValue(na.angle);wa=l.getValue(T.offsetX)+
(l.getValue(na.offsetX)+wa)*za;va=l.getValue(T.offsetY)+(l.getValue(na.offsetY)+va)*za;var ya=l.fromCIMColor(a.CIMSymbolHelper.getFillColor(na)),Ea=l.fromCIMColor(a.CIMSymbolHelper.getStrokeColor(na)),Ba=a.CIMSymbolHelper.getStrokeWidth(na);Ba||(Ea=l.fromCIMColor(a.CIMSymbolHelper.getFillColor(na.haloSymbol)),Ba=na.haloSize*za);var [Aa,Da]=R(ha,pa,da,fa,null);ha=JSON.stringify(T.effects)+Number(T.colorLocked)+JSON.stringify(T.anchorPoint)+T.anchorPointUnits+JSON.stringify(T.markerPlacement);ha=f.numericHash(JSON.stringify(ka)+
ha+Da).toString();var xa=L(ka.primitiveName,ea,"TextString",ja,ka.textString,l._adjustTextCase,na.textCase);if(null!=xa){({fontStyleName:ka}=na);var Ca=sa+(ka?"-"+ka.toLowerCase():"-regular");"string"===typeof xa&&xa.includes("[")&&na.fieldMap&&(xa=l.createLabelOverrideFunction(na.fieldMap,xa,na.textCase));la.push({type:"text",templateHash:ha,materialHash:Aa||"function"===typeof xa||xa.match(/\[(.*?)\]/)?(Ha,Ga,Ia)=>Ca+"-"+l.evaluateValueOrFunction(xa,Ha,Ga,Ia):Ca+"-"+f.numericHash(xa),cim:na,materialOverrides:null,
colorLocked:T.colorLocked,effects:da,alignment:ma,anchorPoint:{x:T.anchorPoint?T.anchorPoint.x:0,y:T.anchorPoint?T.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==T.anchorPointUnits,fontName:Ca,decoration:ra,weight:L(pa,ea,"Weight",ja,ta.weight),style:L(pa,ea,"Size",ja,ta.style),size:L(pa,ea,"Size",ja,ua),angle:L(pa,ea,"Rotation",ja,qa),offsetX:L(pa,ea,"OffsetX",ja,wa),offsetY:L(pa,ea,"OffsetY",ja,va),horizontalAlignment:u(na.horizontalAlignment),verticalAlignment:h(na.verticalAlignment),text:xa,
color:ya,outlineColor:Ea,outlineSize:Ba,referenceSize:oa,sizeRatio:1,markerPlacement:fa})}}}function O(T,da,fa,ka,ea,ha,ja,la,ma,oa,pa,ua,na,ra){var ta=ea.symbol;const sa=ta.symbolLayers;if(sa)if(ra)aa(T,da,fa,ka,ea,ja,ha,la,ma,oa,pa,ua,na);else if(ra=sa.length,sa&&2===sa.length&&sa[0].enable&&sa[1].enable&&"CIMSolidStroke"===sa[0].type&&"CIMSolidFill"===sa[1].type&&!sa[0].effects&&!sa[1].effects)X(T,da,fa,ka,ea,sa,ha,ja,la,ma,pa,ua,na);else if(ta=k.CIMEffectHelper.applyEffects(ta.effects,ea.geometry,
oa.geometryEngine))for(;ra--;){var qa=sa[ra];if(qa&&!1!==qa.enable)switch(qa.type){case "CIMSolidFill":case "CIMSolidStroke":{var wa,va=k.CIMEffectHelper.applyEffects(qa.effects,ta,oa.geometryEngine),za=e.getExtent(va);if(!za)continue;const [Ba,Aa,Da]=e.getSDFMetrics(za,T.frame,T.size,T.anchorPoint,"Relative"!==T.anchorPointUnits);var ya="CIMSolidFill"===qa.type;va={type:"sdf",geom:va,asFill:ya};var Ea=T.primitiveName;za=null!=(wa=l.getValue(T.size))?wa:10;const xa=l.getValue(T.rotation),Ca=l.getValue(T.offsetX),
Ha=l.getValue(T.offsetY),Ga=qa.path,Ia=qa.primitiveName,Ka=ya?l.fromCIMColor(a.CIMSymbolHelper.getFillColor(qa)):l.fromCIMColor(a.CIMSymbolHelper.getStrokeColor(qa)),La=ya?{r:0,g:0,b:0,a:0}:l.fromCIMColor(a.CIMSymbolHelper.getStrokeColor(qa)),Fa=a.CIMSymbolHelper.getStrokeWidth(qa);if(!ya&&!Fa)break;ya=!1;let Ma="";for(const Ja of ha)if(Ja.primitiveName===Ia||Ja.primitiveName===Ea)void 0!==Ja.value?Ma+=`-${Ja.primitiveName}-${Ja.propertyName}-${JSON.stringify(Ja.value)}`:Ja.valueExpressionInfo&&(ya=
!0);x.isSome(da)&&"function"===typeof da&&(ya=!0);Ea=JSON.stringify({...T,markerGraphics:null});const Na=f.numericHash(JSON.stringify(va)+Ga).toString();qa={type:"marker",templateHash:f.numericHash(JSON.stringify(ea)+JSON.stringify(qa)+Ea+Ma).toString(),materialHash:ya?()=>Na:Na,cim:va,materialOverrides:null,colorLocked:T.colorLocked,effects:da,scaleSymbolsProportionally:T.scaleSymbolsProportionally,alignment:pa,anchorPoint:{x:Aa,y:Da},isAbsoluteAnchorPoint:!1,size:L(T.primitiveName,ja,"Size",la,
za),rotation:L(T.primitiveName,ja,"Rotation",la,xa),offsetX:L(T.primitiveName,ja,"OffsetX",la,Ca),offsetY:L(T.primitiveName,ja,"OffsetY",la,Ha),scaleX:1,frameHeight:na,rotateClockwise:T.rotateClockwise,referenceSize:ua,sizeRatio:Ba,color:L(Ia,ja,"Color",la,Ka,V),outlineColor:L(Ia,ja,"Color",la,La,V),outlineWidth:L(Ia,ja,"Width",la,Fa),markerPlacement:fa,animatedSymbolProperties:ka,path:Ga};ma.push(qa);break}default:aa(T,da,fa,ka,ea,ja,ha,la,ma,oa,pa,ua,na)}}}function X(T,da,fa,ka,ea,ha,ja,la,ma,oa,
pa,ua,na){var ra=ea.geometry;const ta=ha[0];ha=ha[1];var sa=e.getExtent(ra);if(sa){var [qa,wa,va]=e.getSDFMetrics(sa,T.frame,T.size,T.anchorPoint,"Relative"!==T.anchorPointUnits);ra={type:"sdf",geom:ra,asFill:!0};var za=T.primitiveName;sa=l.getValue(T.size);var ya=l.getValue(T.rotation),Ea=l.getValue(T.offsetX),Ba=l.getValue(T.offsetY),Aa=ha.path,Da=ha.primitiveName,xa=ta.primitiveName,Ca=l.fromCIMColor(a.CIMSymbolHelper.getFillColor(ha)),Ha=l.fromCIMColor(a.CIMSymbolHelper.getStrokeColor(ta)),Ga=
a.CIMSymbolHelper.getStrokeWidth(ta),Ia=!1,Ka="";for(const Fa of ja)if(Fa.primitiveName===Da||Fa.primitiveName===xa||Fa.primitiveName===za)void 0!==Fa.value?Ka+=`-${Fa.primitiveName}-${Fa.propertyName}-${JSON.stringify(Fa.value)}`:Fa.valueExpressionInfo&&(Ia=!0);ja=JSON.stringify({...T,markerGraphics:null});var La=f.numericHash(JSON.stringify(ra)+Aa).toString();T={type:"marker",templateHash:f.numericHash(JSON.stringify(ea)+JSON.stringify(ha)+JSON.stringify(ta)+ja+Ka).toString(),materialHash:Ia?()=>
La:La,cim:ra,materialOverrides:null,colorLocked:T.colorLocked,effects:da,scaleSymbolsProportionally:T.scaleSymbolsProportionally,alignment:pa,anchorPoint:{x:wa,y:va},isAbsoluteAnchorPoint:!1,size:L(T.primitiveName,la,"Size",ma,sa),rotation:L(T.primitiveName,la,"Rotation",ma,ya),offsetX:L(T.primitiveName,la,"OffsetX",ma,Ea),offsetY:L(T.primitiveName,la,"OffsetY",ma,Ba),scaleX:1,frameHeight:na,rotateClockwise:T.rotateClockwise,referenceSize:ua,sizeRatio:qa,color:L(Da,la,"Color",ma,Ca,V),outlineColor:L(xa,
la,"Color",ma,Ha,V),outlineWidth:L(xa,la,"Width",ma,Ga),markerPlacement:fa,path:Aa,animatedSymbolProperties:ka};oa.push(T)}}function aa(T,da,fa,ka,ea,ha,ja,la,ma,oa,pa,ua,na){ea={type:T.type,enable:!0,name:T.name,colorLocked:T.colorLocked,primitiveName:T.primitiveName,anchorPoint:T.anchorPoint,anchorPointUnits:T.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:T.rotateClockwise,rotation:0,size:T.size,billboardMode3D:T.billboardMode3D,depth3D:T.depth3D,frame:T.frame,markerGraphics:[ea],scaleSymbolsProportionally:T.scaleSymbolsProportionally,
respectFrame:T.respectFrame,clippingPath:T.clippingPath};let ra=[];const ta=["Rotation","OffsetX","OffsetY"];ra=ja.filter(Ba=>Ba.primitiveName!==T.primitiveName||!ta.includes(Ba.propertyName));var sa="";for(var qa of ja)void 0!==qa.value&&(sa+=`-${qa.primitiveName}-${qa.propertyName}-${JSON.stringify(qa.value)}`);const [wa,va,za]=a.CIMSymbolHelper.getTextureAnchor(ea,oa);ja=T.primitiveName;oa=l.getValue(T.rotation);qa=l.getValue(T.offsetX);const ya=l.getValue(T.offsetY);sa=f.numericHash(JSON.stringify(ea)+
sa).toString();const Ea=0<ra.length||x.isSome(da)&&"function"===typeof da;da={type:"marker",templateHash:sa,materialHash:Ea?W(sa,ha,ra,la):sa,cim:ea,materialOverrides:ra,colorLocked:T.colorLocked,effects:da,scaleSymbolsProportionally:T.scaleSymbolsProportionally,alignment:pa,anchorPoint:{x:wa,y:va},isAbsoluteAnchorPoint:!1,size:T.size,rotation:L(ja,ha,"Rotation",la,oa),offsetX:L(ja,ha,"OffsetX",la,qa),offsetY:L(ja,ha,"OffsetY",la,ya),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,
scaleX:1,frameHeight:na,rotateClockwise:T.rotateClockwise,referenceSize:ua,sizeRatio:za/n.pt2px(T.size),markerPlacement:fa,animatedSymbolProperties:ka};ma.push(da)}function ba(T){return T&&0===T.indexOf("Level_")&&(T=parseInt(T.substr(6),10),!isNaN(T))?T:0}function V(T){if(!T||0===T.length)return null;T=(new C(T)).toRgba();return{r:T[0],g:T[1],b:T[2],a:T[3]}}function L(T,da,fa,ka,ea,ha,ja){if(T=da[T]){const la=T[fa];if("string"===typeof la||"number"===typeof la||la instanceof Array)return ha?ha.call(null,
la,ja):la;if(null!=la&&la instanceof d.ArcadeExpression)return(ma,oa,pa)=>{ma=r(la,ma,{$view:pa},ka.geometryType,oa);null!==ma&&ha&&(ma=ha.call(null,ma,ja));return null!==ma?ma:ea}}return ea}function P(T){return T?T.charAt(0).toLowerCase()+T.substr(1):T}function Y(T,da,fa,ka){for(const ea of da)if(ea.valueExpressionInfo){const ha=fa[ea.primitiveName]&&fa[ea.primitiveName][ea.propertyName];ha instanceof d.ArcadeExpression&&(ea.fn=(ja,la,ma)=>r(ha,ja,{$view:ma},ka.geometryType,la))}return(ea,ha,ja)=>
{for(var la of da)la.fn&&(la.value=la.fn(ea,ha,ja));ea=[];for(let oa of T){var ma;if(ha=null==(ma=oa)?void 0:ma.primitiveName){ja=!1;for(const pa of da)pa.primitiveName===ha&&(la=P(pa.propertyName),null!=pa.value&&pa.value!==oa[la]&&(ja||(oa=B.clone(oa),ja=!0),oa[la]=pa.value))}ea.push(oa)}return ea}}function U(T,da,fa,ka){const ea=[];a.OverrideHelper.findApplicableOverrides(T,da,ea);if(0===ea.length)return T;for(const ha of ea)if(ha.valueExpressionInfo){const ja=fa[ha.primitiveName]&&fa[ha.primitiveName][ha.propertyName];
ja instanceof d.ArcadeExpression&&(ha.fn=(la,ma,oa)=>r(ja,la,{$view:oa},ka.geometryType,ma))}return(ha,ja,la)=>{for(const ma of ea)ma.fn&&(ma.value=ma.fn(ha,ja,la));ha=B.clone(T);ja=T.primitiveName;for(const ma of ea)ma.primitiveName===ja&&(la=P(ma.propertyName),null!=ma.value&&ma.value!==ha[la]&&(ha[la]=ma.value));return ha}}function Q(T,da,fa,ka){const ea=[];a.OverrideHelper.findApplicableOverrides(T,da,ea);if(0===ea.length)return T;for(const ha of ea)if(ha.valueExpressionInfo){const ja=fa[ha.primitiveName]&&
fa[ha.primitiveName][ha.propertyName];ja instanceof d.ArcadeExpression&&(ha.fn=(la,ma,oa)=>r(ja,la,{$view:oa},ka.geometryType,ma))}return(ha,ja,la)=>{for(const ma of ea)ma.fn&&(ma.value=ma.fn(ha,ja,la));ha=B.clone(T);ja=T.primitiveName;for(const ma of ea)ma.primitiveName===ja&&(la=P(ma.propertyName),null!=ma.value&&ma.value!==ha[la]&&(ha[la]=ma.value));return ha}}function W(T,da,fa,ka){for(const ea of fa)if(ea.valueExpressionInfo){const ha=da[ea.primitiveName]&&da[ea.primitiveName][ea.propertyName];
ha instanceof d.ArcadeExpression&&(ea.fn=(ja,la,ma)=>r(ha,ja,{$view:ma},ka.geometryType,la))}return(ea,ha,ja)=>{for(const la of fa)la.fn&&(la.value=la.fn(ea,ha,ja));return f.numericHash(T+a.OverrideHelper.buildOverrideKey(fa)).toString()}}function R(T,da,fa,ka,ea){let ha=!1,ja="";for(const la of T)la.primitiveName===da&&(void 0!==la.value?ja+=`-${la.primitiveName}-${la.propertyName}-${JSON.stringify(la.value)}`:la.valueExpressionInfo&&(ha=!0));x.isSome(fa)&&"function"===typeof fa&&(ha=!0);x.isSome(ka)&&
"function"===typeof ka&&(ha=!0);x.isSome(ea)&&"function"===typeof ea&&(ha=!0);return[ha,ja]}function S(T,da,fa){if(T&&da)switch(T.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(T=T.symbolLayers)for(const ka of T)switch(Z(ka,da,fa),ka.type){case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMCharacterMarker":case "CIMPictureMarker":"url"in ka&&ka.url&&fa.push(da.fetchResource(ka.url,null));break;case "CIMVectorMarker":if(T=
ka.markerGraphics)for(const ea of T)ea&&(T=ea.symbol)&&S(T,da,fa)}}}function Z(T,da,fa){T.effects&&!x.isSome(da.geometryEngine)&&(ia?fa.push(ia):l.isGeometryEngineRequired(T.effects)&&(ia=l.importGeometryEngine(),fa.push(ia),ia.then(ka=>da.geometryEngine=ka)))}const ca=y.getLogger("esri.symbols.cim.cimAnalyzer");let ia;z.analyzeCIMResource=function(T,da){if(!da||0===da.length)return T;T=JSON.parse(JSON.stringify(T));a.OverrideHelper.applyOverrides(T,da);return T};z.analyzeCIMSymbol=function(T,da,
fa,ka,ea){return A.apply(this,arguments)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Error","../../../core/Logger","../../../geometry/support/quantizationUtils"],function(z,D,C){function B(x){const n={};switch(x){case "esriGeometryPoint":return(f,d,a,b)=>C.unquantizePoint(d,n,f,a,b);case "esriGeometryPolygon":return(f,d,a,b)=>C.unquantizePolygon(d,n,f,a,b);case "esriGeometryPolyline":return(f,
d,a,b)=>C.unquantizePolyline(d,n,f,a,b);case "esriGeometryMultipoint":return(f,d,a,b)=>C.unquantizeMultipoint(d,n,f,a,b);default:return D.getLogger("esri.views.2d.support.arcadeOnDemand").error(new z("mapview-arcade",`Unable to handle geometryType: ${x}`)),f=>f}}const y=new Map;return function(x,n,f,d,a){if(x.referencesGeometry()&&a){{const {transform:b,hasZ:e,hasM:l}=a;y.has(d)||y.set(d,B(d));d=y.get(d)(n.geometry,b,e,l);n={...n,geometry:d}}}n=x.repurposeFeature(n);try{return x.evaluate({...f,$feature:n})}catch(b){return D.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",
b),null}}})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe","./jsonUtils"],function(z,D,C){function B({scale:E,translate:G},F){return Math.round((F-G[0])/E[0])}function y({scale:E,translate:G},F){return Math.round((G[1]-F)/E[1])}function x(E,G,F){const H=[];let J,I,N,M;for(let K=0;K<F.length;K++){const O=F[K];if(0<K){if(N=B(E,O[0]),M=y(E,O[1]),N!==J||M!==I)H.push(G(O,N-J,M-I)),J=N,I=M}else J=B(E,O[0]),I=y(E,O[1]),H.push(G(O,J,I))}return 0<H.length?H:null}
function n(E,G,F,H){return x(E,F?H?A:w:H?w:v,G)}function f(E,G,F,H){const J=[];F=F?H?A:w:H?w:v;for(H=0;H<G.length;H++){const I=x(E,F,G[H]);I&&3<=I.length&&J.push(I)}return J.length?J:null}function d(E,G,F,H){const J=[];F=F?H?A:w:H?w:v;for(H=0;H<G.length;H++){const I=x(E,F,G[H]);I&&2<=I.length&&J.push(I)}return J.length?J:null}function a({scale:E,translate:G},F){return F*E[0]+G[0]}function b({scale:E,translate:G},F){return G[1]-F*E[1]}function e(E,G,F){const H=Array(F.length);if(!F.length)return H;
const [J,I]=E.scale;let N=a(E,F[0][0]);E=b(E,F[0][1]);H[0]=G(F[0],N,E);for(let M=1;M<F.length;M++){const K=F[M];N+=K[0]*J;E-=K[1]*I;H[M]=G(K,N,E)}return H}function l(E,G,F){const H=Array(F.length);for(let J=0;J<F.length;J++)H[J]=e(E,G,F[J]);return H}function k(E,G,F,H){return e(E,F?H?A:w:H?w:v,G)}function r(E,G,F,H){return l(E,F?H?A:w:H?w:v,G)}function g(E,G,F,H){return l(E,F?H?A:w:H?w:v,G)}function c(E,G,F){let [H,J]=F[0],I=Math.min(H,G[0]),N=Math.min(J,G[1]),M=Math.max(H,G[2]);G=Math.max(J,G[3]);
for(let K=1;K<F.length;K++){const [O,X]=F[K];H+=O;J+=X;0>O&&(I=Math.min(I,H));0<O&&(M=Math.max(M,H));0>X?N=Math.min(N,J):0<X&&(G=Math.max(G,J))}E[0]=I;E[1]=N;E[2]=M;E[3]=G;return E}function m(E,G){if(!G.length)return null;E[0]=E[1]=Number.POSITIVE_INFINITY;E[2]=E[3]=Number.NEGATIVE_INFINITY;for(let F=0;F<G.length;F++)c(E,E,G[F]);return E}function q(E,G,F,H,J){G.xmin=B(E,F.xmin);G.ymin=y(E,F.ymin);G.xmax=B(E,F.xmax);G.ymax=y(E,F.ymax);G!==F&&(H&&(G.zmin=F.zmin,G.zmax=F.zmax),J&&(G.mmin=F.mmin,G.mmax=
F.mmax));return G}function p(E,G,F,H,J){G.points=n(E,F.points,H,J);return G}function u(E,G,F,H,J){G.x=B(E,F.x);G.y=y(E,F.y);G!==F&&(H&&(G.z=F.z),J&&(G.m=F.m));return G}function h(E,G,F,H,J){E=f(E,F.rings,H,J);if(!E)return null;G.rings=E;return G}function t(E,G,F,H,J){E=d(E,F.paths,H,J);if(!E)return null;G.paths=E;return G}const v=(E,G,F)=>[G,F],w=(E,G,F)=>[G,F,E[2]],A=(E,G,F)=>[G,F,E[2],E[3]];z.equals=function(E,G){if(E===G||null==E&&null==G)return!0;if(null==E||null==G)return!1;let F,H,J,I;E&&"upperLeft"===
E.originPosition?(F=E.translate[0],H=E.translate[1],E=E.scale[0]):(F=D.isSome(E.extent)?E.extent.xmin:0,H=D.isSome(E.extent)?E.extent.ymax:0,E=E.tolerance);G&&"upperLeft"===G.originPosition?(J=G.translate[0],I=G.translate[1],G=G.scale[0]):(J=D.isSome(G.extent)?G.extent.xmin:0,I=D.isSome(G.extent)?G.extent.ymax:0,G=G.tolerance);return F===J&&H===I&&E===G};z.getQuantizedBoundsCoordsArray=c;z.getQuantizedBoundsCoordsArrayArray=m;z.getQuantizedBoundsPaths=function(E){return m([0,0,0,0],E)};z.getQuantizedBoundsPoints=
function(E){const G=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return c(G,G,E)};z.getQuantizedBoundsRings=function(E){return m([0,0,0,0],E)};z.quantizeBounds=function(E,G,F){G[0]=B(E,F[0]);G[3]=y(E,F[1]);G[2]=B(E,F[2]);G[1]=y(E,F[3]);return G};z.quantizeExtent=q;z.quantizeGeometry=function(E,G){return E&&G?C.isPoint(G)?u(E,{},G,!1,!1):C.isPolyline(G)?t(E,{},G,!1,!1):C.isPolygon(G)?h(E,{},G,!1,!1):C.isMultipoint(G)?p(E,{},G,!1,!1):C.isExtent(G)?
q(E,{},G,!1,!1):null:null};z.quantizeMultipoint=p;z.quantizePaths=d;z.quantizePoint=u;z.quantizePoints=n;z.quantizePolygon=h;z.quantizePolyline=t;z.quantizeRings=f;z.quantizeX=B;z.quantizeY=y;z.toQuantizationTransform=function(E){return E?{originPosition:"upper-left"===E.originPosition?"upperLeft":"lower-left"===E.originPosition?"lowerLeft":E.originPosition,scale:E.tolerance?[E.tolerance,E.tolerance]:[1,1],translate:D.isSome(E.extent)?[E.extent.xmin,E.extent.ymax]:[0,0]}:null};z.unquantizeBounds=
function(E,G,F){return F?(G[0]=a(E,F[0]),G[1]=b(E,F[3]),G[2]=a(E,F[2]),G[3]=b(E,F[1]),G):[a(E,G[0]),b(E,G[3]),a(E,G[2]),b(E,G[1])]};z.unquantizeCoordsArray=e;z.unquantizeCoordsArrayArray=l;z.unquantizeExtent=function(E,G,F,H,J){G.xmin=a(E,F.xmin);G.ymin=b(E,F.ymin);G.xmax=a(E,F.xmax);G.ymax=b(E,F.ymax);G!==F&&(H&&(G.zmin=F.zmin,G.zmax=F.zmax),J&&(G.mmin=F.mmin,G.mmax=F.mmax));return G};z.unquantizeMultipoint=function(E,G,F,H,J){D.isSome(F)&&(G.points=k(E,F.points,H,J));return G};z.unquantizePaths=
r;z.unquantizePoint=function(E,G,F,H,J){if(D.isNone(F))return G;G.x=a(E,F.x);G.y=b(E,F.y);G!==F&&(H&&(G.z=F.z),J&&(G.m=F.m));return G};z.unquantizePoints=k;z.unquantizePolygon=function(E,G,F,H,J){D.isSome(F)&&(G.rings=g(E,F.rings,H,J));return G};z.unquantizePolyline=function(E,G,F,H,J){D.isSome(F)&&(G.paths=r(E,F.paths,H,J));return G};z.unquantizeRings=g;z.unquantizeX=a;z.unquantizeY=b;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b){return function(e){function l(k,r,g){var c=e.call(this,k)||this;c._minMaxZoom=x.i1616to32(Math.round(r*y.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(g*y.MIN_MAX_ZOOM_PRECISION_FACTOR));c._cimLineLayer=k;let m=0;f.isFunction(k.width)||(m=.5*C.pt2px(k.width));c._dynamicPropertyMap.set("_halfWidth",(u,h,t)=>f.isFunction(k.width)?.5*C.pt2px(k.width(u,h,t)):m);f.isFunction(k.cap)?c._dynamicPropertyMap.set("_capType",k.cap):c._capType=k.cap;f.isFunction(k.join)?c._dynamicPropertyMap.set("_joinType",
k.join):c._joinType=k.join;const q=k.color;f.isFunction(q)?c._dynamicPropertyMap.set("_fillColor",(u,h,t)=>B.premultiplyAlphaRGBA(q(u,h,t))):c._fillColor=q&&B.premultiplyAlphaRGBA(q)||0;const p=k.miterLimit;f.isFunction(p)?c._dynamicPropertyMap.set("_miterLimitCosine",(u,h,t)=>f.getLimitCosine(p(u,h,t))):c._miterLimitCosine=f.getLimitCosine(p);D.isSome(k.effects)&&(r=k.effects,f.isFunction(r)?c._dynamicPropertyMap.set("_effects",r):c._effects=r);c._scaleFactor=k.scaleFactor||1;c._isDashed=null!=k.dashTemplate;
c.tessellationProperties._bitset=(k.colorLocked?y.BITSET_GENERIC_LOCK_COLOR:0)|(k.scaleDash?y.BITSET_LINE_SCALE_DASH:0)|(k.sampleAlphaOnly?y.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);c._materialKey=k.materialKey;c._initializeTessellator(!0);return c}z._inheritsLoose(l,e);l.fromCIMLine=function(k,r){const [g,c]=f.getMinMaxZoom(k.scaleInfo,r);return new l(k,g,c)};l.prototype.bindFeature=function(k,r,g){const c=k.readLegacyFeature();this._dynamicPropertyMap.forEach((q,p)=>{this[p]=q(c,r,g)});this._halfWidth*=
this._scaleFactor;k=this._materialCache;var m=this._cimLineLayer.materialHash;m=m(c,r,g);m=k.get(m);k=null;m&&b.ok(m.spriteMosaicItem)&&(k=m.spriteMosaicItem);if(k){this._hasPattern=!0;const {rect:q,width:p,height:u}=k;m=q.x+y.SPRITE_PADDING;const h=q.y+y.SPRITE_PADDING,t=m+p,v=h+u;this.tessellationProperties._tl=x.i1616to32(m,h);this.tessellationProperties._br=x.i1616to32(t,v)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=
this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;m=n.LineMaterialKey.load(this._materialKey);k&&(m.sdf=k.sdf,m.pattern=!0,m.textureBinding=k.textureBinding);this._materialKey=m.data};return l}(d(a))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g){const c=n.create(),m=x.create(),q=C.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");return function(p){function u(h,t,v){var w=p.call(this,h)||this;w._cimMarkerLayer=h;w._minMaxZoom=b.i1616to32(Math.round(t*a.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(v*a.MIN_MAX_ZOOM_PRECISION_FACTOR));const A=h.color;l.isFunction(A)?w._dynamicPropertyMap.set("_fillColor",(I,N,M)=>d.premultiplyAlphaRGBA(A(I,N,M))):w._fillColor=d.premultiplyAlphaRGBA(A);const E=
h.outlineColor;l.isFunction(E)?w._dynamicPropertyMap.set("_outlineColor",(I,N,M)=>d.premultiplyAlphaRGBA(E(I,N,M))):w._outlineColor=d.premultiplyAlphaRGBA(E);const G=h.size;l.isFunction(G)?w._dynamicPropertyMap.set("_size",(I,N,M)=>y.pt2px(G(I,N,M))):w._size=y.pt2px(G)||0;t=h.scaleX;l.isFunction(t)?w._dynamicPropertyMap.set("_scaleX",t):w._scaleX=t||1;const F=h.offsetX;l.isFunction(F)?w._dynamicPropertyMap.set("xOffset",(I,N,M)=>y.pt2px(F(I,N,M))):w.xOffset=y.pt2px(F)||0;const H=h.offsetY;l.isFunction(H)?
w._dynamicPropertyMap.set("yOffset",(I,N,M)=>y.pt2px(H(I,N,M))):w.yOffset=y.pt2px(H)||0;const J=h.outlineWidth;l.isFunction(J)?w._dynamicPropertyMap.set("_outlineWidth",(I,N,M)=>y.pt2px(J(I,N,M))):w._outlineWidth=y.pt2px(J)||0;t=h.rotation;l.isFunction(t)?w._dynamicPropertyMap.set("_angle",t):w._angle=t||0;B.isSome(h.effects)&&(t=h.effects,l.isFunction(t)?w._dynamicPropertyMap.set("_effects",t):w._effects=t);B.isSome(h.markerPlacement)&&(t=h.markerPlacement,l.isFunction(t)?w._dynamicPropertyMap.set("_markerPlacement",
t):w._markerPlacement=t);w._scaleFactor=B.unwrapOr(h.scaleFactor,1);w._bitSet=(h.alignment===f.Alignment.MAP?1:0)|(h.colorLocked?1:0)<<1|(h.scaleSymbolsProportionally?1:0)<<3;w._materialKey=h.materialKey;return w}z._inheritsLoose(u,p);u.fromCIMMarker=function(h,t){const [v,w]=l.getMinMaxZoom(h.scaleInfo,t);return new u(h,v,w)};u.prototype.bindFeature=function(h,t,v){const w=h.readLegacyFeature();h=h.getObjectId();this._dynamicPropertyMap.forEach((aa,ba)=>{this[ba]=aa(w,t,v)});var A=this._cimMarkerLayer.materialHash;
h="function"===typeof A?A(w,t,v,h):A;if((h=this._materialCache.get(h))&&g.ok(h.spriteMosaicItem)&&h.spriteMosaicItem){h=h.spriteMosaicItem;A=this._cimMarkerLayer.sizeRatio;var E=h.width/h.height*this._scaleX,G=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,F=this._size,H=F*E,J=this.xOffset,I=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var N=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/y.pt2px(this._cimMarkerLayer.frameHeight):
1,M=this._outlineWidth*N,K=y.pt2px(this._cimMarkerLayer.referenceSize),O=N=0,X=this._cimMarkerLayer.anchorPoint;X&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(N=-X.x/(this._size*E),O=X.y/this._size):(N=X.x,O=X.y));this._sizeOutlineWidth=b.i8888to32(Math.round(Math.min(Math.sqrt(128*H),255)),Math.round(Math.min(Math.sqrt(128*F),255)),Math.round(Math.min(Math.sqrt(128*M),255)),Math.round(Math.min(Math.sqrt(128*K),255)));this.angle=G;this._bitestAndDistRatio=b.i1616to32(this._bitSet,Math.round(64*
A));E=h.rect.x+a.SPRITE_PADDING;G=h.rect.y+a.SPRITE_PADDING;M=E+h.width;K=G+h.height;this._texUpperLeft=b.i1616to32(E,G);this._texUpperRight=b.i1616to32(M,G);this._texBottomLeft=b.i1616to32(E,K);this._texBottomRight=b.i1616to32(M,K);E=e.MarkerMaterialKey.load(this._materialKey);E.sdf=h.sdf;E.pattern=!0;E.textureBinding=h.textureBinding;this._materialKey=E.data;this._anchorX=.5-(.5+N)*h.width/h.width;this._anchorY=.5-(.5+O)*h.height/h.height;H=H*A*this._scaleFactor;F=F*A*this._scaleFactor;H*=h.rect.width/
h.width;F*=h.rect.height/h.height;this._computedWidth=H;this._computedHeight=F;this._applyTransformation(m,c);this.xOffset=J;this.yOffset=I}else q.error(new D("mapview-cim","Encountered an error when binding feature"))};return u}(k(r))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l){return function(k){function r(c,m,q){var p=k.call(this,c)||this;p._horizontalAlignment="center";p._verticalAlignment="middle";p._textToGlyphs=new Map;p._minMaxZoom=f.i1616to32(Math.round(m*n.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(q*n.MIN_MAX_ZOOM_PRECISION_FACTOR));m=c.scaleFactor||1;p._cimTextLayer=c;const u=c.color;a.isFunction(u)?p._dynamicPropertyMap.set("_color",(A,E,G)=>x.premultiplyAlphaRGBA(u(A,E,G))):p._color=x.premultiplyAlphaRGBA(u);const h=c.outlineColor;
a.isFunction(h)?p._dynamicPropertyMap.set("_haloColor",(A,E,G)=>x.premultiplyAlphaRGBA(h(A,E,G))):p._haloColor=x.premultiplyAlphaRGBA(h);let t;a.isFunction(c.size)||(t=Math.min(Math.round(C.pt2px(c.size*c.sizeRatio)),127));p._dynamicPropertyMap.set("_size",(A,E,G)=>a.isFunction(c.size)?Math.min(Math.round(C.pt2px(c.size(A,E,G)*c.sizeRatio)),127):t);a.isFunction(c.outlineSize)?p._dynamicPropertyMap.set("_haloSize",(A,E,G)=>Math.min(Math.floor(5*C.pt2px(c.outlineSize(A,E,G)*c.sizeRatio)),127)):p._haloSize=
Math.min(Math.floor(5*C.pt2px(c.outlineSize*c.sizeRatio)),127);let v;a.isFunction(c.offsetX)||(v=Math.round(C.pt2px(c.offsetX*c.sizeRatio)));p._dynamicPropertyMap.set("_xOffset",(A,E,G)=>a.isFunction(c.offsetX)?Math.round(C.pt2px(c.offsetX(A,E,G)*c.sizeRatio)):v);let w;a.isFunction(c.offsetY)||(w=Math.round(C.pt2px(c.offsetY*c.sizeRatio)));p._dynamicPropertyMap.set("_yOffset",(A,E,G)=>a.isFunction(c.offsetY)?Math.round(C.pt2px(c.offsetY(A,E,G)*c.sizeRatio)):w);a.isFunction(c.angle)?p._dynamicPropertyMap.set("_angle",
c.angle):p._angle=c.angle;a.isFunction(c.horizontalAlignment)?p._dynamicPropertyMap.set("_horizontalAlignment",c.horizontalAlignment):p._horizontalAlignment=c.horizontalAlignment;a.isFunction(c.verticalAlignment)?p._dynamicPropertyMap.set("_verticalAlignment",c.verticalAlignment):p._verticalAlignment=c.verticalAlignment;D.isSome(c.effects)&&(q=c.effects,a.isFunction(q)?p._dynamicPropertyMap.set("_effects",q):p._effects=q);D.isSome(c.markerPlacement)&&(q=c.markerPlacement,a.isFunction(q)?p._dynamicPropertyMap.set("_markerPlacement",
q):p._textPlacement=q);a.isFunction(c.text)?p._dynamicPropertyMap.set("_text",c.text):p._text=c.text;p._scaleFactor=m;m=Math.min(Math.round(C.pt2px(c.referenceSize*c.sizeRatio)),127);p._referenceSize=Math.round(Math.sqrt(256*m));p._materialKey=c.materialKey;m=d.TextMaterialKey.load(p._materialKey);m.sdf=!0;p._bitset=(c.alignment===B.Alignment.MAP?1:0)|(c.colorLocked?1:0)<<1;p._materialKey=m.data;p._decoration="none";p._lineHeight=1;p._lineWidth=512;p._isCIM=!0;return p}z._inheritsLoose(r,k);r.fromCIMText=
function(c,m){const [q,p]=a.getMinMaxZoom(c.scaleInfo,m);return new r(c,q,p)};var g=r.prototype;g.analyze=function(){var c=z._asyncToGenerator(function*(m,q,p,u){var h=q.readLegacyFeature();var t=this._cimTextLayer;h="string"===typeof t.text?t.text:"function"===typeof t.text?t.text(h,p,u):"";(m=yield k.prototype.analyze.call(this,m,q,p,u,l.codepoints(h)))&&m.glyphMosaicItems&&this._textToGlyphs.set(h,m.glyphMosaicItems);return m});return function(m,q,p,u){return c.apply(this,arguments)}}();g.bindFeature=
function(c,m,q){const p=c.readLegacyFeature();this._dynamicPropertyMap.forEach((u,h)=>{this[h]=u(p,m,q)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/n.GLYPH_SIZE,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=y.getXAnchorDirection(D.unwrapOr(this._horizontalAlignment,"center")),this._yAlignD=y.getYAnchorDirection(D.unwrapOr(this._verticalAlignment,"baseline")),c=this._textToGlyphs.get(this._text),this.bindTextInfo(c,!1)):
this._shapingInfo=null};return r}(b(e))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],function(z){z.codepoints=function(D){const C=Array(D.length);for(let B=0;B<D.length;B++)C[B]=D.charCodeAt(B);return C};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),
function(z,D,C,B,y,x,n,f,d,a){return function(b){function e(l,k,r,g,c,m,q,p,u,h,t,v,w,A,E,G){var F=b.call(this)||this;F._effects=A;l=n.FillMaterialKey.load(l);k&&(l.sdf=k.sdf,l.pattern=!0,l.textureBinding=k.textureBinding);F.fillColor=r;F.tl=g;F.br=c;F.aux2_1=x.i1616to32(m,q);F.aux2_2=x.i1616to32(p,u);F.aux3=x.i8888to32(h,t,v,0);F._bitset=w;F._minMaxZoom=x.i1616to32(Math.round(E*B.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(G*B.MIN_MAX_ZOOM_PRECISION_FACTOR));F._materialKey=l.data;return F}z._inheritsLoose(e,
b);e.fromCIMFill=function(l,k,r){var g=l.color;g=g&&C.premultiplyAlphaRGBA(g)||0;const c=l.materialKey,[m,q]=f.getMinMaxZoom(l.scaleInfo,r);r=(l.colorLocked?B.BITSET_GENERIC_LOCK_COLOR:0)|(l.applyRandomOffset?B.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(l.sampleAlphaOnly?B.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);if(!k)return new e(c,null,g,0,0,0,0,0,0,0,0,0,r,l.effects,m,q);const {rect:p,width:u,height:h}=k;var t=l.scaleX||1,v=p.x+B.SPRITE_PADDING;const w=p.y+B.SPRITE_PADDING;var A=v+u;const E=w+h;var G=
l.height;let F=Math.round(G);0>=F&&(F=E-w);t=Math.round(t*G);0>=t&&(t=A-v);G=D.pt2px(l.offsetX||0);const H=D.pt2px(-l.offsetY||0);v=x.i1616to32(v,w);A=x.i1616to32(A,E);return new e(c,k,g,v,A,t,F,G,H,128,128,y.degToByte(l.angle),r,l.effects,m,q)};e.fromSimpleFill=function(l,k,r=!1){var {color:g}=l;g=g&&"esriSFSNull"!==l.style&&C.premultiplyAlphaRGBAArray(g)||0;r=r?B.BITSET_GENERIC_LOCK_COLOR:0;const c=l.materialKey;if(k){const {rect:p,width:u,height:h}=k;var m=p.x+B.SPRITE_PADDING;const t=p.y+B.SPRITE_PADDING;
var q=m+u;const v=t+h;m=x.i1616to32(m,t);q=x.i1616to32(q,v);k=new e(c,k,g,m,q,u,h,0,0,128,128,0,r,null,f.DEFAULT_MIN_ZOOM,f.DEFAULT_MAX_ZOOM)}else k=new e(c,null,g,0,0,0,0,0,0,0,0,0,r,null,f.DEFAULT_MIN_ZOOM,f.DEFAULT_MAX_ZOOM);k._maybeAddLineTemplate(l);return k};e.fromPictureFill=function(l,k,r=!1){const g=B.PICTURE_FILL_COLOR,{rect:c,width:m,height:q}=k;var p=c.x+B.SPRITE_PADDING,u=c.y+B.SPRITE_PADDING,h=p+m,t=u+q;p=x.i1616to32(p,u);h=x.i1616to32(h,t);t=Math.round(D.pt2px(l.width));u=Math.round(D.pt2px(l.height));
const v=D.pt2px(l.xoffset),w=D.pt2px(-l.yoffset);k=new e(l.materialKey,k,g,p,h,t,u,v,w,128*l.xscale,128*l.yscale,0,r?B.BITSET_GENERIC_LOCK_COLOR:0,null,f.DEFAULT_MIN_ZOOM,f.DEFAULT_MAX_ZOOM);k._maybeAddLineTemplate(l);return k};return e}(d(a))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/promiseUtils"],function(z,D,C){function B(){B=D._asyncToGenerator(function*(x,n,f){try{yield x.acquire(),yield n(f),
x.release()}catch(d){throw x.release(),d;}});return B.apply(this,arguments)}let y=function(){function x(){this._resolver=null}var n=x.prototype;n.isHeld=function(){return!!this._resolver};n.acquire=function(){var f=D._asyncToGenerator(function*(){this._resolver?(yield this._resolver.promise,yield this.acquire()):this._resolver=C.createResolver()});return function(){return f.apply(this,arguments)}}();n.release=function(){const f=this._resolver;this._resolver=null;f.resolve()};return x}();z.Lock=y;
z.withLock=function(x,n,f){return B.apply(this,arguments)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/support/cimSymbolUtils":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../symbols/cim/cimAnalyzer","../../../../symbols/cim/ExpandedCIM","./webStyleUtils"],function(z,D,C,B,y){const x=function(){var d=D._asyncToGenerator(function*(a,b,e,l){return Promise.all(a.map(k=>f(k,b,e,l)))});return function(a,
b,e,l){return d.apply(this,arguments)}}(),n=function(){var d=D._asyncToGenerator(function*(a,b,e){return new B.ExpandedCIM(yield C.analyzeCIMSymbol(a.data,b,e),a.data,a.rendererKey,a.maxVVSize)});return function(a,b,e){return d.apply(this,arguments)}}(),f=function(){var d=D._asyncToGenerator(function*(a,b,e,l){return a?"cim"===a.type?n(a,b,e):"web-style"===a.type?(a={type:"cim",data:yield y.fetchCIMSymbolReference(a,null,l),rendererKey:a.rendererKey,maxVVSize:a.maxVVSize},n(a,b,e)):a:null});return function(a,
b,e,l){return d.apply(this,arguments)}}();z.cimLayerToRasterizationInfo=function(d){if(!d)return null;const {type:a,cim:b,url:e,materialHash:l}=d,k={cim:b,type:a,mosaicHash:l,url:e,size:null,dashTemplate:null,path:null,text:null,fontName:null,animatedSymbolProperties:null};switch(a){case "marker":k.size=d.size;k.path=d.path;k.animatedSymbolProperties=d.animatedSymbolProperties;break;case "line":k.dashTemplate=d.dashTemplate;break;case "text":k.text=d.text,k.fontName=d.fontName}return k};z.expandSymbol=
f;z.expandSymbols=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(z,D,C,B){const y={marker:C.WGLGeometryType.MARKER,fill:C.WGLGeometryType.FILL,line:C.WGLGeometryType.LINE,text:C.WGLGeometryType.TEXT};let x=function(){function n(f,d,a,b){const e={minScale:null==
d?void 0:d.minScale,maxScale:null==d?void 0:d.maxScale};var l=e.minScale||e.maxScale?e.minScale+"-"+e.maxScale:"";this.layers=f;this.data=d;this.hash=this._createHash()+l;this.rendererKey=a;d={isOutline:!1,placement:null,symbologyType:C.WGLSymbologyType.DEFAULT,vvFlags:a};for(const k of f)f=y[k.type],d.isOutline="line"===k.type&&k.isOutline,k.materialKey=B.createMaterialKey(f,d),k.maxVVSize=b,k.scaleInfo=e,k.templateHash+=l}n.prototype._createHash=function(){let f="";for(const d of this.layers)f+=
d.templateHash;return f};D._createClass(n,[{key:"type",get:function(){return"expanded-cim"}}]);return n}();z.ExpandedCIM=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/support/webStyleUtils":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/devEnvironmentUtils ../../../../core/Error ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../portal/Portal ../../../../chunks/persistableUrlUtils ../../../../symbols/support/styleUtils".split(" "),
function(z,D,C,B,y,x,n,f,d,a){function b(){b=D._asyncToGenerator(function*(g,c,m){if(!g.name)throw new B("style-symbol-reference-name-missing","Missing name in style symbol reference");if(g.styleName&&"Esri2DPointSymbolsStyle"===g.styleName)return e(g,m);try{const q=yield a.fetchStyle(g,c,m);return k(q,g.name,c,m)}catch(q){return x.throwIfAborted(q),null}});return b.apply(this,arguments)}function e(g,c){return l.apply(this,arguments)}function l(){l=D._asyncToGenerator(function*(g,c){g=a.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,
g.name);try{const m=yield a.requestJSON(g,c);return a.makeCIMSymbolRef(m.data)}catch(m){return x.throwIfAborted(m),null}});return l.apply(this,arguments)}function k(g,c,m,q){return r.apply(this,arguments)}function r(){r=D._asyncToGenerator(function*(g,c,m,q){var p=g.data;g={portal:m&&y.isSome(m.portal)?m.portal:f.getDefault(),url:n.urlToObject(g.baseUrl),origin:"portal-item"};p=p.items.find(u=>u.name===c);if(!p)throw new B("symbolstyleutils:symbol-name-not-found",`The symbol name '${c}' could not be found`,
{symbolName:c});p=d.fromJSON(a.symbolUrlFromStyleItem(p,"cimRef"),g);C.isDevEnvironment()&&(p=C.adjustStaticAGOUrl(p));try{const u=yield a.requestJSON(p,q);return a.makeCIMSymbolRef(u.data)}catch(u){return x.throwIfAborted(u),null}});return r.apply(this,arguments)}z.fetchCIMSymbolReference=function(g,c,m){return b.apply(this,arguments)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(z){const D=
/^devext.arcgis.com$/,C=/^qaext.arcgis.com$/,B=/^[\w-]*\.mapsdevext.arcgis.com$/,y=/^[\w-]*\.mapsqa.arcgis.com$/,x=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,D,C,/^jsapps.esri.com$/,B,y];z.adjustStaticAGOUrl=function(n,f){return n?(f=f||globalThis.location.hostname)?null!=f.match(D)||null!=f.match(B)?n.replace("static.arcgis.com","staticdev.arcgis.com"):null!=f.match(C)||null!=f.match(y)?n.replace("static.arcgis.com","staticqa.arcgis.com"):n:n:n};z.isDevEnvironment=function(n){n=n||globalThis.location.hostname;
return x.some(f=>{var d;return null!=(null==(d=n)?void 0:d.match(f))})};z.isTelemetryDevEnvironment=function(n){n=n||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(x).some(f=>{var d;return null!=(null==(d=n)?void 0:d.match(f))})};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../support/arcadeOnDemand ../../../arcade/callExpressionWithFeature ../../../layers/support/cimSymbolUtils".split(" "),
function(z,D,C,B,y,x,n,f,d){function a(t,v,w,A){return b.apply(this,arguments)}function b(){b=C._asyncToGenerator(function*(t,v,w,A){switch(t.type){case "simple":case "heatmap":return c.fromBasicRenderer(t,v,w,A);case "map":return p.fromUVRenderer(t,v,w,A);case "interval":return q.fromCBRenderer(t,v,w,A);case "dictionary":return h.fromDictionaryRenderer(t,v,w,A);case "pie-chart":return m.fromPieChartRenderer(t,v,w,A);case "subtype":return m.fromSubtypes(t,v,w,A)}});return b.apply(this,arguments)}
function e(t,v){return l.apply(this,arguments)}function l(){l=C._asyncToGenerator(function*(t,v){const w=t||1;if("number"===typeof w)return(E,G,F)=>w;const A=yield n.createRendererExpression(w,v.spatialReference,v.fields);return(E,G,F)=>f(A,E,{$view:F},v.geometryType,G)||1});return l.apply(this,arguments)}function k(){return r.apply(this,arguments)}function r(){r=C._asyncToGenerator(function*(){u||(u=new Promise((t,v)=>z(["../../../layers/features/createSymbolSchema"],t,v)));return u});return r.apply(this,
arguments)}const g=y.getLogger("esri/views/2d/engine/webgl/util/Matcher");let c=function(){function t(){this.type="feature";this._defaultResult=null}t.fromBasicRenderer=function(){var w=C._asyncToGenerator(function*(A,E,G,F){const H=new t;A.symbol&&(A=yield d.expandSymbol(A.symbol,G,F),E=E.createTemplateGroup(A,null),H.setDefault(E));return H});return function(A,E,G,F){return w.apply(this,arguments)}}();t.fromPieChartRenderer=function(){var w=C._asyncToGenerator(function*(A,E,G,F){const H=new t;if(A.markerSymbol){const J=
yield d.expandSymbol(A.markerSymbol,G,F);let I;A.fillSymbol&&(I=yield d.expandSymbol(A.fillSymbol,G,F));A=E.createTemplateGroup(J,I);H.setDefault(A)}return H});return function(A,E,G,F){return w.apply(this,arguments)}}();var v=t.prototype;v.size=function(){return 1};v.getDefault=function(){return this._defaultResult};v.setDefault=function(w){this._defaultResult=w};v.match=function(w,A,E,G,F){return this.getDefault()};v.analyze=function(){var w=C._asyncToGenerator(function*(A,E,G,F,H,J){return null});
return function(A,E,G,F,H,J){return w.apply(this,arguments)}}();return t}(),m=function(t){function v(w,A){var E=t.call(this)||this;E._subMatchers=w;E._subtypeField=A;return E}C._inheritsLoose(v,t);v.fromSubtypes=function(){var w=C._asyncToGenerator(function*(A,E,G,F){const H=new Map,J=[];for(const I in A.renderers){const N=parseInt(I,10),M=a(A.renderers[I],E,G,F).then(K=>H.set(N,K));J.push(M)}yield Promise.all(J);return new v(H,A.subtypeField)});return function(A,E,G,F){return w.apply(this,arguments)}}();
v.prototype.match=function(w,A,E,G,F){var H=A.readAttribute(this._subtypeField);return(H=this._subMatchers.get(H))?H.match(w,A,E,G,F):null};return v}(c),q=function(t){function v(A,E,G,F){var H=t.call(this)||this;H.type="interval";H._intervals=[];H._isMaxInclusive=E;H._fieldIndex=F;H._field=A;H._normalizationInfo=G;return H}C._inheritsLoose(v,t);v.fromCBRenderer=function(){var A=C._asyncToGenerator(function*(E,G,F,H){const {isMaxInclusive:J,normalizationField:I,normalizationTotal:N,normalizationType:M}=
E,K=new v(E.field,J,{normalizationField:I,normalizationTotal:N,normalizationType:M},E.fieldIndex),O=yield d.expandSymbol(E.backgroundFillSymbol,F,H);yield Promise.all(E.intervals.map(function(){var X=C._asyncToGenerator(function*(aa){var ba=yield d.expandSymbol(aa.symbol,F,H);ba=yield G.createTemplateGroup(ba,O);K.add({min:aa.min,max:aa.max},ba)});return function(aa){return X.apply(this,arguments)}}()));if(E=yield d.expandSymbol(E.defaultSymbol,F,H))E=yield G.createTemplateGroup(E,O),K.setDefault(E);
return K});return function(E,G,F,H){return A.apply(this,arguments)}}();var w=v.prototype;w.add=function(A,E){this._intervals.push({interval:A,result:E});this._intervals.sort((G,F)=>G.interval.min-F.interval.min)};w.size=function(){return t.prototype.size.call(this)+this._intervals.length};w.match=function(A,E,G,F,H){if(null==this._fieldIndex&&!this._field)return this.getDefault();A=null!=this._fieldIndex?E.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(E);if(!A&&(null===A||void 0===
A||isNaN(A)))return this.getDefault();for(E=0;E<this._intervals.length;E++){const {interval:J,result:I}=this._intervals[E];G=this._isMaxInclusive?A<=J.max:A<J.max;if(A>=J.min&&G)return I}return this.getDefault()};w._needsNormalization=function(){const A=this._normalizationInfo;return A&&(A.normalizationField||A.normalizationTotal||A.normalizationType)};w._getValueFromField=function(A){const E=A.readAttribute(this._field);if(!this._needsNormalization()||null==E)return E;const {normalizationField:G,
normalizationTotal:F,normalizationType:H}=this._normalizationInfo;A=!!G&&A.readAttribute(G);if(H)switch(H){case "esriNormalizeByField":return(A||void 0)&&E/A;case "esriNormalizeByLog":return Math.log(E)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return E/F*100;default:g.error(`Found unknown normalization type: ${H}`)}else g.error("Normalization is required, but no type was set!")};return v}(c),p=function(t){function v(A,E,G){var F=t.call(this)||this;F.type="map";F._nullResult=null;F._resultsMap=
new Map;F._fieldsIndex=G;F._fields=A;F._seperator=E||"";return F}C._inheritsLoose(v,t);v.fromUVRenderer=function(){var A=C._asyncToGenerator(function*(E,G,F,H){const J=E.fieldDelimiter,I=[E.field];E.field2&&I.push(E.field2);E.field3&&I.push(E.field3);const N=yield d.expandSymbol(E.backgroundFillSymbol,F,H),M=new v(I,J,E.fieldIndex);yield Promise.all(E.map.map(function(){var K=C._asyncToGenerator(function*(O){var X=yield d.expandSymbol(O.symbol,F,H);X=yield G.createTemplateGroup(X,N);"\x3cNull\x3e"===
O.value?M.setNullResult(X):M.add(O.value,X)});return function(O){return K.apply(this,arguments)}}()));if(E=yield d.expandSymbol(E.defaultSymbol,F,H))E=yield G.createTemplateGroup(E,N),M.setDefault(E);return M});return function(E,G,F,H){return A.apply(this,arguments)}}();var w=v.prototype;w.setNullResult=function(A){this._nullResult=A};w.add=function(A,E){this._resultsMap.set(A.toString(),E)};w.size=function(){return t.prototype.size.call(this)+this._resultsMap.size};w.match=function(A,E,G,F,H){if(null==
this._fieldsIndex&&!this._fields)return this.getDefault();A=null!=this._fieldsIndex?E.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(E);if(null!==this._nullResult&&(null==A||""===A||"\x3cNull\x3e"===A))return this._nullResult;if(!A&&null==A)return this.getDefault();A=A.toString();return this._resultsMap.has(A)?this._resultsMap.get(A):this.getDefault()};w._getValueFromFields=function(A){const E=[];for(const G of this._fields){const F=A.readAttribute(G);null==F||""===F?E.push("\x3cNull\x3e"):
E.push(F)}return E.join(this._seperator)};return v}(c),u,h=function(t){function v(A,E,G,F,H,J){var I=t.call(this)||this;I.type="dictionary";I._groupIdCache=new x(100);I._loader=A;I._fieldMap=A.fieldMap;I._symbolFields=A.getSymbolFields();I._templates=E;I._info=G;I._scaleFn=F;I._schemaUtilsModule=H;I._symbolOptions=J;return I}C._inheritsLoose(v,t);v.fromDictionaryRenderer=function(){var A=C._asyncToGenerator(function*(E,G,F,H){const [{DictionaryLoader:J},I]=yield Promise.all([new Promise((M,K)=>z(["../../../../../renderers/support/DictionaryLoader"],
M,K)),k()]);H=new J(E.url,E.config,E.fieldMap);yield H.fetchResources({spatialReference:F.spatialReference,fields:F.fields});const N=yield e(E.scaleExpression,F);return new v(H,G,F,N,I,E.symbolOptions)});return function(E,G,F,H){return A.apply(this,arguments)}}();var w=v.prototype;w._analyzeFeature=function(){var A=C._asyncToGenerator(function*(E,G,F,H,J){E=E.readLegacyFeature();const I=this._scaleFn(E,F,H);F=this._attributeHash(E)+"-"+I;const N=this._groupIdCache.get(F);if(N)return N;H=yield this._loader.getSymbolAsync(E,
{...H,spatialReference:this._info.spatialReference,abortOptions:J,fields:this._info.fields});H=this._schemaUtilsModule.createSymbolSchema(H,this._symbolOptions);G=d.expandSymbol(H,this._info,G,J).then(M=>{if("expanded-cim"!==M.type)return g.error(new B("mapview-bad-type",`Found unexpected type ${M.type} in dictionary response`)),null;M.hash+="-"+I;for(const K of M.layers)K.scaleFactor=I,K.templateHash+="-"+I;return this._templates.createTemplateGroup(M,null)});this._groupIdCache.put(F,G,1);return G});
return function(E,G,F,H,J){return A.apply(this,arguments)}}();w.analyze=function(){var A=C._asyncToGenerator(function*(E,G,F,H,J,I){E=G.getCursor();for(G=[];E.next();)G.push(this._analyzeFeature(E,F,H,J,I));return Promise.all(G)});return function(E,G,F,H,J,I){return A.apply(this,arguments)}}();w.match=function(A,E,G,F,H){return null};w._attributeHash=function(A){let E="";for(const G of this._symbolFields){const F=this._fieldMap[G];F&&(E+=A.attributes[F]+"-")}return E};return v}(c);D.DictionaryMatcher=
h;D.FeatureMatcher=c;D.IntervalMatcher=q;D.MapMatcher=p;D.SubtypeMatcher=m;D.createMatcher=a;Object.defineProperties(D,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/schemaUtils":function(){define("exports ../../../../core/Error ../../../../core/has ../../../../core/lang ../../../../core/Logger ../../../../core/maybe ../../../../core/screenUtils ../../../../core/sql ../../engine/webgl/enums ../../engine/webgl/Utils ../../engine/webgl/techniques/utils ../../engine/webgl/util/vvFlagUtils ./createSymbolSchema ./support/pixelBuffering ./support/rendererUtils ../support/clusterUtils ../support/util".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g,c){function m(U){let Q=0,W=0,R=d.WGLSymbologyType.DEFAULT;if(x.isSome(U)){W=k.getPtMaxVVSize(U);"visualVariables"in U&&(Q=e.getVVFlags(U.visualVariables||[]),"dot-density"===U.type&&(R=d.WGLSymbologyType.DOT_DENSITY));"heatmap"===U.type&&(R=d.WGLSymbologyType.HEATMAP);if("dictionary"===U.type)return{maxVVSize:W,vvFlags:Q,symbologyType:d.WGLSymbologyType.DEFAULT};if("pie-chart"===U.type)return{maxVVSize:W,vvFlags:Q,symbologyType:d.WGLSymbologyType.PIE_CHART};
if(R!==d.WGLSymbologyType.DOT_DENSITY&&R!==d.WGLSymbologyType.HEATMAP){var S=U.getSymbols();"backgroundFillSymbol"in U&&U.backgroundFillSymbol&&S.push(U.backgroundFillSymbol);let ca=U=!0;for(const ia of S)if("cim"===ia.type&&(ca=!1),"simple-fill"===ia.type||"picture-fill"===ia.type){S=(S=ia.outline)&&"none"!==S.style&&"solid"!==S.style;var Z="simple-fill"===ia.type&&"none"!==ia.style&&"solid"!==ia.style;Z="picture-fill"===ia.type||Z||S;S&&(U=!1);Z&&(ca=!1)}U?R=ca?d.WGLSymbologyType.OUTLINE_FILL_SIMPLE:
d.WGLSymbologyType.OUTLINE_FILL:ca&&(R=d.WGLSymbologyType.SIMPLE)}}return{vvFlags:Q,maxVVSize:W,symbologyType:R}}function q(U,Q){U=B.clone(U);return U.some(W=>{{const S=W.labelPlacement;var R=Y[Q];W.symbol?R?(R.includes(S)||(R=R[0],S&&P.warn(`Found invalid label placement type ${S} for ${Q}. Defaulting to ${R}`),W.labelPlacement=R),W=!1):(P.error(new D("mapview-labeling:unsupported-geometry-type",`Unable to create labels for Feature Layer, ${Q} is not supported`)),W=!0):(P.warn("No ILabelClass symbol specified."),
W=!0)}return W})?[]:U}function p(U,Q=!1){try{var W,R;const S=A(U,Q),Z=H(U),ca={};S.map(T=>{a:{switch(T.target){case "feature":t(ca,h(U),T);T=void 0;break a;case "aggregate":if(!("featureReduction"in U)){T=void 0;break a}var da=U.featureReduction;switch(da.type){case "selection":throw new D("ValidationError","Mapview does not support `selection` reduction type",da);case "binning":t(ca,h(U),T);ca.aggregate||(ca.aggregate={name:"aggregate",type:"bin",filters:null,input:"feature",params:{fixedBinLevel:da.fixedBinLevel},
attributes:{}});u(ca.aggregate,T.attributes.fields);T=void 0;break a;case "cluster":t(ca,h(U),T);ca.aggregate||(ca.aggregate={name:"aggregate",type:"cluster",input:"feature",filters:null,attributes:{},params:{clusterRadius:n.pt2px(da.clusterRadius/2),clusterPixelBuffer:64*Math.ceil(n.pt2px(da.clusterMaxSize)/64),fields:T.aggregateFields}});u(ca.aggregate,T.attributes.fields);T=void 0;break a}}T=void 0}return T});const ia=x.isSome(U.subtypeCode)?`${U.subtypeField} = ${U.subtypeCode}`:null;return{source:{definitionExpression:f.sqlAnd(U.definitionExpression,
ia),fields:U.fields.map(T=>T.toJSON()),gdbVersion:U.gdbVersion,historicMoment:null==(W=U.historicMoment)?void 0:W.getTime(),outFields:U.availableFields,pixelBuffer:U.pixelBuffer,spatialReference:U.spatialReference.toJSON(),timeExtent:null==(R=U.timeExtent)?void 0:R.toJSON(),customParameters:U.customParameters},attributes:{fields:{},indexCount:0},processors:S,tileRenderer:Z,targets:ca}}catch(S){if("ValidationError"===S.fieldName)return P.error(S),null;throw S;}}function u(U,Q){for(const W in Q){const R=
Q[W];if(R.target!==U.name)continue;const S=U.attributes[W];S?(S.context.mesh=S.context.mesh||R.context.mesh,S.context.storage=S.context.storage||R.context.storage):U.attributes[W]=R}return U}function h(U){var Q,W,R,S,Z;return[null!=(Q=null==(W=x.unwrap(U.filter))?void 0:W.toJSON())?Q:null,null!=(R=null==(S=x.unwrap(null==(Z=x.unwrap(U.featureEffect))?void 0:Z.filter))?void 0:S.toJSON())?R:null]}function t(U,Q,W){U.feature||(U.feature={name:"feature",input:"source",filters:Q,attributes:{}});u(U.feature,
W.attributes.fields);return U}function v(U,Q){return Q.field?w(U,{...Q,type:"field",field:Q.field}):Q.valueExpression?w(U,{...Q,type:"expression",valueExpression:Q.valueExpression}):{field:null,fieldIndex:null}}function w(U,Q){switch(Q.type){case "expression":var W=Q.valueExpression;if(!U.fields[W]){var R=U.indexCount++;U.fields[W]={...Q,name:W,fieldIndex:R}}return{fieldIndex:U.fields[W].fieldIndex};case "label-expression":return W=JSON.stringify(Q.label),U.fields[W]||(R=U.indexCount++,U.fields[W]=
{...Q,name:W,fieldIndex:R}),{fieldIndex:U.fields[W].fieldIndex};case "field":W=Q.field;if("aggregate"===Q.target&&U.fields[W])return{field:W};U.fields[W]={...Q,name:W};return{field:W};case "statistic":return U.fields[Q.name]={...Q},{field:Q.name}}}function A(U,Q=!1){const W=[];let R=0;W.push(F(U,R++,Q));return W}function E(U,Q,W,R,S,Z=!1){Q=w(Q,{type:"label-expression",target:R,context:{mesh:!0},resultType:"string",label:{labelExpression:W.labelExpression,labelExpressionInfo:W.labelExpressionInfo?
{expression:W.labelExpressionInfo.expression}:null,symbol:!!W.symbol,where:W.where}});({fieldIndex:Q}=Q);U=m(U);return{...l.createSymbolSchema(W,U,Z),fieldIndex:Q,target:R,index:S}}function G(U,Q,W){const R="featureReduction"in Q&&Q.featureReduction;if(!R)return{fields:[],labels:[],matcher:null,rendererOverride:null};const S=[];let Z=null,ca=c.toJSONGeometryType(Q.geometryType),ia=[],T=null;if(R)switch(R.type){case "selection":throw new D("ValidationError","Mapview does not support `selection` reduction type",
R);case "cluster":case "binning":if("cluster"===R.type?ca="esriGeometryPoint":"binning"===R.type&&(ca="esriGeometryPolygon"),R.renderer){for(const da of R.fields)g.convertAggregateFieldFromPublic(S,da);T=R.renderer;Z=O(null,"aggregate",R.renderer,W);ia=R&&R.labelsVisible&&R.labelingInfo||[]}else"cluster"===R.type&&(T=g.createClusterRenderer(S,Q.renderer,R,null),R.symbol&&(Q=m(T),Z={type:"simple",symbol:l.createSymbolSchema(R.symbol,Q,W),symbologyType:Q.symbologyType}),ia=R&&R.labelsVisible&&R.labelingInfo||
[])}I(U,S);return{labels:q(ia,"binning"===R.type?"esriGeometryPolygon":ca),matcher:Z,fields:S,rendererOverride:T}}function F(U,Q,W=!1){const R={indexCount:0,fields:{}};Q="featureReduction"in U&&U.featureReduction?"aggregate":"feature";if("sublayers"in U){var S={type:"subtype",subtypeField:U.subtypeField,renderers:{},symbologyType:d.WGLSymbologyType.DEFAULT},Z={type:"subtype",mapping:{},target:"feature"};var ca={type:"subtype",classes:{}};var ia={type:"symbol",target:"feature",aggregateFields:[],attributes:R,
storage:Z,mesh:{matcher:S,aggregateMatcher:null,labels:ca,sortKey:null}},T=new Set;let ka=0;for(const {renderer:ea,subtypeCode:ha,labelingInfo:ja,labelsVisible:la}of U.sublayers){U=O(R,Q,ea,W);const ma=N(R,Q,ea),oa=la&&ja;if("visualVariables"in ea&&ea.visualVariables&&ea.visualVariables.length)throw new D("ValidationError","Visual variables are currently not supported for subtype layers");if("dictionary"===U.type)throw new D("ValidationError","Dictionary renderer is not supported in subtype layers");
if("subtype"===U.type)throw new D("ValidationError","Nested subtype renderers is not supported");if(x.isSome(ma)&&"subtype"===ma.type)throw new D("ValidationError","Nested subtype storage is not supported");if(x.isSome(ma)&&x.isSome(ma.attributeMapping))throw new D("ValidationError","Non-visual-variable attributes are not supported in subtype layers");if("heatmap"===U.type)throw new D("ValidationError","Heatmaps are not supported in subtype layers");if("pie-chart"===U.type)throw new D("ValidationError",
"Pie-charts are not supported in subtype layers");if(T.has(ha))throw new D("ValidationError","Subtype codes for sublayers must be unique");T.add(ha);S.renderers[ha]=U;Z.mapping[ha]=ma;oa&&(ca.classes[ha]=oa.map(pa=>E(ea,R,pa,"feature",ka++,W)))}return ia}if("heatmap"===U.renderer.type&&"raster"===r.getSupportedHeatmapRenderer()){const {radius:ka,fieldOffset:ea,field:ha}=U.renderer;return{type:"heatmap",aggregateFields:[],attributes:R,target:Q,storage:null,mesh:{radius:ka,fieldOffset:ea,field:v(R,
{target:Q,field:ha,resultType:"numeric"}).field}}}S=G(R,U,W);Z=c.toJSONGeometryType(U.geometryType);const da=null!=(ca=S.rendererOverride)?ca:U.renderer;ca=O(R,Q,da,W);ia=N(R,Q,da);T=J(R,U.orderBy);let fa=0;U=[...q(U.labelsVisible&&U.labelingInfo||[],Z).map(ka=>E(da,R,ka,"feature",fa++,W)),...S.labels.map(ka=>E(da,R,ka,"aggregate",fa++,W))];return{type:"symbol",target:Q,attributes:R,aggregateFields:S.fields,storage:ia,mesh:{matcher:ca,labels:{type:"simple",classes:U},aggregateMatcher:S.matcher,sortKey:T}}}
function H(U){var Q;return"heatmap"===(null==(Q=U.renderer)?void 0:Q.type)&&"raster"===r.getSupportedHeatmapRenderer()?{type:"heatmap"}:{type:"symbol"}}function J(U,Q){if(x.isNone(Q)||!Q.length)return null;1<Q.length&&P.warn(`Layer rendering currently only supports ordering by 1 orderByInfo, but found ${Q.length}. All but the first will be discarded`);Q=Q[0];const W="ascending"===Q.order?"asc":"desc";if(Q.field)return{field:Q.field,order:W};if(Q.valueExpression)return{fieldIndex:w(U,{type:"expression",
target:"feature",valueExpression:Q.valueExpression,resultType:"numeric"}).fieldIndex,order:W};P.error(new D("ValidationError","Expected to find a field or valueExpression for OrderByInfo",Q));return null}function I(U,Q){const W={mesh:!0,storage:!0};for(const R of Q){const {name:S,outStatistic:Z}=R,{statisticType:ca,onStatisticField:ia}=Z;let T=Q=null,da=null;"onStatisticValueExpression"in Z?T=w(U,{type:"expression",target:"feature",valueExpression:Z.onStatisticValueExpression,resultType:"numeric"}).fieldIndex:
"onStatisticNormalizationField"in Z?(Q=w(U,{type:"field",target:"feature",field:ia,resultType:"numeric"}).field,da=Z.onStatisticNormalizationField):Q=w(U,{type:"field",target:"feature",field:ia,resultType:"numeric"}).field;w(U,{type:"statistic",target:"aggregate",name:S,context:W,inField:Q,inNormalizationField:da,inFieldIndex:T,statisticType:ca})}}function N(U,Q,W){let R;switch(W.type){case "simple":case "class-breaks":case "unique-value":case "dictionary":R={visualVariables:!0,attributes:null};break;
default:R=b.getTechniqueFromRenderer(W).getStorageSpec(W)}return M(U,Q,R,W)}function M(U,Q,W,R){if(x.isNone(W))return null;const {visualVariables:S,attributes:Z}=W;W=null;S&&"visualVariables"in R&&(W=K(U,Q,R.visualVariables));const ca=x.isSome(W)?4:0;R=null;x.isSome(Z)&&(R=Z.map((ia,T)=>{const {field:da,fieldIndex:fa}=v(U,{valueExpression:ia.valueExpression,field:ia.field,resultType:"numeric",target:Q});return{binding:T+ca,field:da,fieldIndex:fa}}));return{type:"simple",target:Q,attributeMapping:R,
vvMapping:W}}function K(U,Q,W){if(!W||!W.length)return[];const R={storage:!0};return r.simplifyVisualVariables(W).map(S=>{var Z;const ca=a.getVVType(S.type),{field:ia,fieldIndex:T}=v(U,{target:Q,valueExpression:S.valueExpression,field:S.field,context:R,resultType:"numeric"});switch(S.type){case "size":return"$view.scale"===S.valueExpression?null:{type:"size",binding:ca,field:ia,fieldIndex:T,normalizationField:v(U,{target:Q,field:S.normalizationField,context:R,resultType:"numeric"}).field,valueRepresentation:null!=
(Z=S.valueRepresentation)?Z:null};case "color":return{type:"color",binding:ca,field:ia,fieldIndex:T,normalizationField:v(U,{target:Q,field:S.normalizationField,context:R,resultType:"numeric"}).field};case "opacity":return{type:"opacity",binding:ca,field:ia,fieldIndex:T,normalizationField:v(U,{target:Q,field:S.normalizationField,context:R,resultType:"numeric"}).field};case "rotation":return{type:"rotation",binding:ca,field:ia,fieldIndex:T}}}).filter(S=>S)}function O(U,Q,W,R=!1){U=x.unwrapOr(U,{indexCount:0,
fields:{}});switch(W.type){case "simple":case "dot-density":return X(U,W,R);case "class-breaks":return ba(U,Q,W,R);case "unique-value":return V(U,Q,W,R);case "dictionary":return Q=m(W),W={type:"dictionary",config:W.config,fieldMap:W.fieldMap,scaleExpression:W.scaleExpression,url:W.url,symbolOptions:Q,symbologyType:Q.symbologyType};case "heatmap":return L(U,W,R);case "pie-chart":return aa(U,W,R)}}function X(U,Q,W=!1){U=Q.getSymbols();U=U.length?U[0]:null;Q=m(Q);return{type:"simple",symbol:l.createSymbolSchema(U,
Q,W),symbologyType:Q.symbologyType}}function aa(U,Q,W=!1){var R=Q.getSymbols();U=R[0];R=1<R.length?R[1]:null;Q=m(Q);return{type:"pie-chart",markerSymbol:l.createSymbolSchema(U,Q,W),fillSymbol:l.createSymbolSchema(R,Q,W),symbologyType:Q.symbologyType}}function ba(U,Q,W,R=!1){const S=W.backgroundFillSymbol,{field:Z,fieldIndex:ca}=v(U,{target:Q,field:W.field,valueExpression:W.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}});Q=W.normalizationType;Q="log"===Q?"esriNormalizeByLog":
"percent-of-total"===Q?"esriNormalizeByPercentOfTotal":"field"===Q?"esriNormalizeByField":null;const ia=m(W),T=W.classBreakInfos.map(da=>({symbol:l.createSymbolSchema(da.symbol,ia,R),min:da.minValue,max:da.maxValue})).sort((da,fa)=>da.min-fa.min);return{type:"interval",attributes:U.fields,field:Z,fieldIndex:ca,backgroundFillSymbol:l.createSymbolSchema(S,ia,R),defaultSymbol:l.createSymbolSchema(W.defaultSymbol,ia,R),intervals:T,normalizationField:W.normalizationField,normalizationTotal:W.normalizationTotal,
normalizationType:Q,isMaxInclusive:W.isMaxInclusive,symbologyType:ia.symbologyType}}function V(U,Q,W,R=!1){const S=[],Z=W.backgroundFillSymbol;Q={target:Q,context:{mesh:!0},resultType:"string"};if(W.field&&"string"!==typeof W.field)throw new D("ValidationError","Expected renderer.field to be a string",W);const {field:ca,fieldIndex:ia}=v(U,{...Q,field:W.field,valueExpression:W.valueExpression}),T=m(W);for(const da of W.uniqueValueInfos)S.push({value:""+da.value,symbol:l.createSymbolSchema(da.symbol,
T,R)});return{type:"map",attributes:U.fields,field:ca,fieldIndex:ia,field2:v(U,{...Q,field:W.field2}).field,field3:v(U,{...Q,field:W.field3}).field,fieldDelimiter:W.fieldDelimiter,backgroundFillSymbol:l.createSymbolSchema(Z,T),defaultSymbol:l.createSymbolSchema(W.defaultSymbol,T),map:S,symbologyType:T.symbologyType}}function L(U,Q,W=!1){U=Q.getSymbols();U=U.length?U[0]:null;Q=m(Q);return{type:"heatmap",symbol:l.createSymbolSchema(U,Q,W),symbologyType:Q.symbologyType}}const P=y.getLogger("esri.views.2d.layers.features.schemaUtils"),
Y={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};z.createSymbolSchema=l.createSymbolSchema;z.addAggregateFields=I;z.createMatcherSchema=O;z.createRendererAttributeSchema=v;z.createSchema=function(U){C("esri-2d-update-debug")&&console.debug("Created new schema",p(U,!0));return p(U)};z.createSymbolSchemaOptions=
m;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["exports","../enums","../visualVariablesUtils"],function(z,D,C){z.getVVFlags=function(B){if(!B)return D.WGLVVFlag.NONE;let y=0;for(const x of B)"size"===x.type?(B=C.getTypeOfSizeVisualVariable(x),y|=B,"outline"===x.target&&(y|=B<<4)):"color"===x.type?y|=D.WGLVVFlag.COLOR:"opacity"===x.type?y|=D.WGLVVFlag.OPACITY:"rotation"===x.type&&(y|=D.WGLVVFlag.ROTATION);
return y};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports","../../../../core/Error","../../../../core/Logger","./enums","./Utils"],function(z,D,C,B,y){const x=C.getLogger("esri.views.2d.engine.webgl");z.getTypeOfSizeVisualVariable=function(n){if(y.isNumber(n.minDataValue)&&y.isNumber(n.maxDataValue)&&null!=n.minSize&&null!=n.maxSize)return B.WGLVVFlag.SIZE_MINMAX_VALUE;if((n.expression&&
"view.scale"===n.expression||n.valueExpression&&"$view.scale"===n.valueExpression)&&Array.isArray(n.stops))return B.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=n.field||n.expression&&"view.scale"!==n.expression||n.valueExpression&&"$view.scale"!==n.valueExpression)&&(Array.isArray(n.stops)||"levels"in n&&n.levels))return B.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=n.field||n.expression&&"view.scale"!==n.expression||n.valueExpression&&"$view.scale"!==n.valueExpression)&&null!=n.valueUnit)return B.WGLVVFlag.SIZE_UNIT_VALUE;
x.error(new D("mapview-bad-type","Found invalid size VisualVariable",n));return B.WGLVVFlag.NONE};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/createSymbolSchema":function(){define(["exports","../../engine/webgl/enums","../../engine/webgl/materialKey/MaterialKey"],function(z,D,C){function B(n){switch(n.type){case "line-marker":var f;return{type:"line-marker",color:null==(f=n.color)?void 0:f.toJSON(),placement:n.placement,
style:n.style};default:return n.constructor.fromJSON(n.toJSON()).toJSON()}}function y(n,f,d){var a=C.createMaterialKey(D.WGLGeometryType.FILL,f);a=d?C.hydrateMaterialKey(a):a;var b=n.clone();n=b.outline;const e=C.isOutlineFillSymbology(f.symbologyType);e||(b.outline=null);b={materialKey:a,hash:b.hash(),...B(b)};if(e)return b;a=[];a.push(b);n&&(f=C.createMaterialKey(D.WGLGeometryType.LINE,{...f,isOutline:!0}),d={materialKey:d?C.hydrateMaterialKey(f):f,hash:n.hash(),...B(n)},a.push(d));return{type:"composite-symbol",
layers:a,hash:a.reduce((l,k)=>k.hash+l,"")}}function x(n,f,d){var a=C.isOutlineFillSymbology(f.symbologyType)?D.WGLSymbologyType.DEFAULT:f.symbologyType;a=C.createMaterialKey(D.WGLGeometryType.LINE,{...f,symbologyType:a});const b=d?C.hydrateMaterialKey(a):a;n=n.clone();a=n.marker;n.marker=null;const e=[];e.push({materialKey:b,hash:n.hash(),...B(n)});if(a){var l;f=C.createMaterialKey(D.WGLGeometryType.MARKER,f);d=d?C.hydrateMaterialKey(f):f;a.color=null!=(l=a.color)?l:n.color;e.push({materialKey:d,
hash:a.hash(),lineWidth:n.width,...B(a)})}return{type:"composite-symbol",layers:e,hash:e.reduce((k,r)=>r.hash+k,"")}}z.createSymbolSchema=function(n,f,d){if(!n)return null;switch(n.type){case "simple-fill":case "picture-fill":return y(n,f,d);case "simple-marker":case "picture-marker":var a=C.createMaterialKey(D.WGLGeometryType.MARKER,f);d=d?C.hydrateMaterialKey(a):a;a=B(n);return n={materialKey:d,hash:n.hash(),...a,angle:n.angle,maxVVSize:f.maxVVSize};case "simple-line":return x(n,f,d);case "text":return a=
C.createMaterialKey(D.WGLGeometryType.TEXT,f),d=d?C.hydrateMaterialKey(a):a,a=B(n),n={materialKey:d,hash:n.hash(),...a,angle:n.angle,maxVVSize:f.maxVVSize};case "label":return a=n.toJSON(),f=C.createMaterialKey(D.WGLGeometryType.LABEL,{...f,placement:a.labelPlacement}),n={materialKey:d?C.hydrateMaterialKey(f):f,hash:n.hash(),...a,labelPlacement:a.labelPlacement};case "cim":return{type:"cim",rendererKey:f.vvFlags,data:n.data,maxVVSize:f.maxVVSize};case "CIMSymbolReference":return{type:"cim",rendererKey:f.vvFlags,
data:n,maxVVSize:f.maxVVSize};case "web-style":return{...B(n),type:"web-style",hash:n.hash(),rendererKey:f.vvFlags,maxVVSize:f.maxVVSize};default:throw Error(`symbol not supported ${n.type}`);}};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/pixelBuffering":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/screenUtils ../../../../../symbols/cim/CIMSymbolHelper ../../../../../symbols/cim/Rect ../../../engine/webgl/definitions ../../graphics/graphicsUtils ../../support/cimSymbolUtils".split(" "),
function(z,D,C,B,y,x,n,f){function d(u){if(!("visualVariables"in u&&u.hasVisualVariables("size")))return 0;u=u.getVisualVariablesForType("size");if(!u[0])return 0;u=u[0];if("outline"===u.target)return 0;if("stops"===u.transformationType)return u.stops.map(h=>h.size).reduce(c,0);if("clamped-linear"===u.transformationType){let h=-Infinity,t=-Infinity;h="number"===typeof u.maxSize?u.maxSize:u.maxSize.stops.map(v=>v.size).reduce(c,0);t="number"===typeof u.minSize?u.minSize:u.minSize.stops.map(v=>v.size).reduce(c,
0);return Math.max(h,t)}if("real-world-size"===u.transformationType)return 30}function a(){a=D._asyncToGenerator(function*(u,h,t,v,w,A){if(!u||A&&"cluster"===A.type)return 0;if("heatmap"===u.type)return Math.round(C.pt2px(u.radius));if("dot-density"===u.type)return 0;if("dictionary"===u.type)return"esriGeometryPoint"===h||"esriGeometryMultipoint"===h?100:200;A=u.getSymbols();u=d(u);const E=[];for(const G of A)E.push(k(G,u,t,h,v,w));h=yield Promise.all(E);return C.pt2px(h.reduce(c,0))});return a.apply(this,
arguments)}function b(u,h){return null==u?h:u}function e(u,h,t,v,w,A){return l.apply(this,arguments)}function l(){l=D._asyncToGenerator(function*(u,h,t,v,w,A){if("simple-marker"===u.type)return h=Math.max(b(u.size,12),h),g(u)+.707*h;if("picture-marker"===u.type)return t=Math.max(b(u.height,12),h),h=b(u.width,12)*(t/b(u.height,12))/2,t/=2,g(u)+Math.sqrt(h*h+t*t);if("text"===u.type){if(t=u.text&&u.text.length){h=[];for(v=0;v<t;v++)h.push({...p,code:u.text.charCodeAt(v)});h={glyphMosaicItems:h}}else h=
{glyphMosaicItems:[p]};n.getTextSymbolSize(q,u.toJSON(),h);return Math.max(Math.abs(q[0]),Math.abs(q[1]))+Math.max(q[2],q[3])}return"simple-line"===u.type?(t=Math.max(b(u.width,.75),h)/2,u.marker?Math.max(6*u.width,2*h):t):"simple-fill"===u.type||"picture-fill"===u.type?Math.max(null==u.outline?0:b(u.outline.width,0),h)/2:"cim"===u.type?(yield f.expandSymbol({type:"cim",rendererKey:0,data:u.data,maxVVSize:h},{geometryType:v,fields:w,spatialReference:A},t),(u=B.CIMSymbolHelper.getEnvelope(u.data,t))?
Math.sqrt(u.width*u.width+u.height*u.height):0):"web-style"===u.type?e(yield u.fetchCIMSymbol(),h,t,v,w,A):0});return l.apply(this,arguments)}function k(u,h,t,v,w,A){return r.apply(this,arguments)}function r(){r=D._asyncToGenerator(function*(u,h,t,v,w,A){return u.type in m?Math.min(yield e(u,h,t,v,w,A),75):0});return r.apply(this,arguments)}function g(u){const h=b(u.xoffset,0);u=b(u.yoffset,0);return Math.sqrt(h*h+u*u)}function c(u,h){return Math.max(u,h)}const m={"simple-marker":1,"picture-marker":1,
text:0,"simple-line":0,"simple-fill":0,"picture-fill":0,cim:1,"web-style":1},q=[0,0,0,0],p={sdf:!0,code:99,metrics:x.AVERAGE_GLYPH_MOSAIC_ITEM.metrics,rect:new y(0,0,24,24),page:0,textureBinding:2};z.computePxBuffer=function(u,h,t,v,w,A){return a.apply(this,arguments)};z.getPtMaxVVSize=d;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("exports ../../../../core/BidiText ../../../../core/maybe ../../../../core/screenUtils ../../../../geometry/Polygon ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/spatialReferenceUtils ../../engine/webgl/alignmentUtils ../../engine/webgl/definitions ../../engine/webgl/mesh/templates/shapingUtils".split(" "),
function(z,D,C,B,y,x,n,f,d,a){z.PIXEL_BUFFER=50;z.TILE_SIZE=512;z.getTextSymbolSize=function(b,e,l){var k,r,g;if(!l||0===l.glyphMosaicItems.length)return b;const c=D.bidiText(e.text)[1];e=a.shapeGlyphs(l.glyphMosaicItems,c,{scale:B.pt2px(e.font.size)/d.GLYPH_SIZE,angle:null!=(k=e.angle)?k:0,xOffset:null!=(r=e.xoffset)?r:0,yOffset:null!=(g=e.yoffset)?g:0,hAlign:f.getXAnchorDirection(e.horizontalAlignment||"center"),vAlign:f.getYAnchorDirection(e.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,
Math.min(e.lineWidth||512,512)),lineHeight:d.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(e.lineHeight||1,4)),decoration:e.font.decoration||"none",isCIM:!1}).bounds;b[0]=B.pt2px(e.x-e.halfWidth);b[1]=B.pt2px(e.y-e.halfHeight);b[2]=B.pt2px(e.width);b[3]=B.pt2px(e.height);return b};z.graphicGeometryToNumber=function(b){switch(C.unwrap(b.geometry).type){case "polyline":return 1;case "polygon":case "extent":return 2}return 0};z.intersectingInternationalDateline=function(b,e){e=n.getInfo(e);if(!e)return null;
const [l,k]=e.valid;return b[2]>k?[x.create([b[0],b[1],k,b[3]]),x.create([l,b[1],l+b[2]-k,b[3]])]:b[0]<l?[x.create([l,b[1],b[2],b[3]]),x.create([k-(l-b[0]),b[1],k,b[3]])]:null};z.isMarkerSymbol=function(b){return"simple-marker"===b||"picture-marker"===b||"esriSMS"===b||"esriPMS"===b};z.isTextSymbol=function(b){return"text"===b||"esriTS"===b};z.polygonFromExtent=function(b){if(!b)return null;const {xmin:e,ymin:l,xmax:k,ymax:r,spatialReference:g}=b;return new y({rings:[[[e,l],[e,r],[k,r],[k,l],[e,l]]],
spatialReference:g})};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/rendererUtils":function(){define("exports ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/screenUtils ../../../../webgl/capabilities".split(" "),function(z,D,C,B,y,x){function n(b){return("size"===b.type||"color"===b.type||"opacity"===b.type)&&null!=b.stops}function f(b){var e=b.type;var l=b.stops;
if(8>=l.length)e=l;else if(a.warn(`Found ${l.length} Visual Variable stops, but MapView only supports ${8}. Displayed stops will be simplified.`),16<l.length){{const [h,...t]=l;var k=t.pop(),r=t[0].value,g=t[t.length-1].value,c=(g-r)/6;const v=[];for(;r<g;r+=c){for(var m=0;r>=t[m].value;)m++;var q=t[m],p=l[m-1],u=r-p.value;q=q.value===p.value?1:u/(q.value-p.value);"color"===e?(p=t[m],m=l[m-1],u=p.color.clone(),u.r=(1-q)*m.color.r+q*u.r,u.g=(1-q)*m.color.g+q*u.g,u.b=(1-q)*m.color.b+q*u.b,u.a=(1-q)*
m.color.a+q*u.a,v.push({value:r,color:u,label:p.label})):"size"===e?(p=t[m],u=l[m-1],m=y.toPt(p.size),u=y.toPt(u.size),v.push({value:r,size:(1-q)*u+q*m,label:p.label})):(p=t[m],v.push({value:r,opacity:(1-q)*l[m-1].opacity+q*p.opacity,label:p.label}))}e=[h,...v,k]}}else{{const [h,...t]=l;for(e=t.pop();6<t.length;){k=l=0;for(g=1;g<t.length;g++)c=Math.abs(t[g].value-t[g-1].value),c>k&&(k=c,l=g);t.splice(l,1)}e=[h,...t,e]}}b.stops=e;return b}function d(){if(C("heatmap-force-raster"))return"raster";const {supportsTextureFloat:b,
supportsTextureHalfFloat:e,supportsColorBufferFloat:l,supportsColorBufferFloatBlend:k,supportsColorBufferHalfFloat:r}=x.getWebGLCapabilities("2d");return b&&l&&k||e&&r?"symbol":C("heatmap-allow-raster-fallback")?"raster":"none"}const a=B.getLogger("esri.views.2d.layers.features.support.rendererUtils");z.getSupportedHeatmapRenderer=d;z.isRendererSupported=function(b){if(!b)return!0;switch(b.type){case "dot-density":if(!x.getWebGLCapabilities("2d").supportsTextureFloat)return a.error(new D("webgl-missing-extension",
"Missing WebGL extension OES_Texture_Float which is required for DotDensity")),!1;break;case "heatmap":if(b=d(),"none"===b||"raster"===b&&!C("heatmap-force-raster")){const e=x.getWebGLCapabilities("2d"),l=["supportsTextureFloat","supportsTextureHalfFloat","supportsColorBufferFloat","supportsColorBufferFloatBlend","supportsColorBufferHalfFloat"].filter(k=>!e[k]).join(", ");if("none"===b)return a.errorOnce(new D("webgl-missing-extension",`Missing WebGL${e.type} requirements for Heatmap: ${l}`)),!1;
"raster"===b&&a.warnOnce(`Missing WebGL${e.type} requirements for accelerated Heatmap: ${l}. Feature support may be limited.`)}}return!0};z.simplifyVVRenderer=b=>{if(!("visualVariables"in b&&b.visualVariables&&b.visualVariables.length))return b;b=b.clone();const e=b.visualVariables.map(l=>n(l)?f(l):l);b.visualVariables=e;return b};z.simplifyVisualVariables=function(b){return b.map(e=>n(e)?f(e.clone()):e)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/layers/support/clusterUtils":function(){define("exports ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/MD5 ../../../../renderers/visualVariables/SizeVariable ../../../../renderers/visualVariables/support/SizeStop ../../engine/LevelDependentSizeVariable".split(" "),function(z,D,C,B,y,x,n,f,d){function a(p,u,h){switch(p){case "avg":case "avg_angle":return`cluster_avg_${u}`;case "mode":return`cluster_type_${u}`;case "norm":return p=
u.toLowerCase()+",norm:field,"+h.toLowerCase(),"cluster_avg_"+x.createMD5Hash(p)}}function b(p,u){const {name:h,outStatistic:t}=u,{onStatisticField:v,onStatisticValueExpression:w,statisticType:A}=t;w?(u=x.createMD5Hash(w.toLowerCase()),p.push({name:h,outStatistic:{onStatisticField:u,onStatisticValueExpression:w,statisticType:A}})):v?p.push({name:h,outStatistic:{onStatisticField:v,statisticType:A}}):k.error(new D("mapview-unsupported-field","Unable to handle field",{field:u}))}function e(p,u,h){const t=
x.createMD5Hash(u),v="mode"===h?`cluster_type_${t}`:`cluster_avg_${t}`;p.some(w=>w.name===v)||p.push({name:v,outStatistic:{onStatisticField:t,onStatisticValueExpression:u,statisticType:h}});return v}function l(p,u,h,t){if("cluster_count"===u||p.some(w=>w.name===u))return u;const v=a(h,u,t);p.some(w=>w.name===v)||("norm"===h?p.push({name:v,outStatistic:{onStatisticField:u,onStatisticNormalizationField:t,statisticType:h}}):p.push({name:v,outStatistic:{onStatisticField:u,statisticType:h}}));return v}
const k=B.getLogger("esri.views.2d.layers.support.clusterUtils");C.add("esri-cluster-arcade-enabled",!0);const r=C("esri-cluster-arcade-enabled"),g=p=>{for(const u of p)if("size"===u.type)return u;return null},c=p=>{for(const u of p)if("cluster_count"===u.field)return!0;return!1},m=(p,u)=>{const h=[new f({value:0,size:0}),new f({value:1})];if(y.isNone(u))return new n({field:"cluster_count",stops:[...h,new f({value:2,size:0})]});const t=Object.keys(u).reduce((v,w)=>({...v,[w]:[...h,new f({value:Math.max(2,
u[w].minValue),size:p.clusterMinSize}),new f({value:Math.max(3,u[w].maxValue),size:p.clusterMaxSize})]}),{});return new d.LevelDependentSizeVariable({field:"cluster_count",levels:t})},q=p=>{const u=h=>k.error(new D("Unsupported-renderer",h,{renderer:p}));if("unique-value"===p.type){if(p.field2||p.field3)return u("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===p.type){if(p.normalizationField){const h=p.normalizationType;if("field"!==h)return u(`FeatureReductionCluster does not support a normalizationType of ${h}`),
!1}}else if("simple"!==p.type)return u(`FeatureReductionCluster does not support renderers of type ${p.type}`),!1;if(!r){if("valueExpression"in p&&p.valueExpression)return u("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in p&&p.visualVariables||[]).some(h=>!!("valueExpression"in h&&h.valueExpression)))return u("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),
!1}return!0};z.convertAggregateFieldFromPublic=b;z.createClusterCountSizeVariable=m;z.createClusterRenderer=(p,u,h,t)=>{u=u.clone();if(!q(u))return u;if(h.fields)for(var v of h.fields)b(p,v);if("visualVariables"in u){v=(u.visualVariables||[]).filter(A=>"$view.scale"!==A.valueExpression);const w=g(v);v.forEach(A=>{"rotation"===A.type?A.field?A.field=l(p,A.field,"avg_angle"):A.valueExpression&&(A.field=e(p,A.valueExpression,"avg_angle"),A.valueExpression=null):A.normalizationField?(A.field=l(p,A.field,
"norm",A.normalizationField),A.normalizationField=null):A.field?A.field=l(p,A.field,"avg"):(A.field=e(p,A.valueExpression,"avg"),A.valueExpression=null)});y.isNone(w)&&!c(v)&&(v.push(m(h,t)),u.dynamicClusterSize=!0);u.visualVariables=v}switch(u.type){case "unique-value":u.field?u.field=l(p,u.field,"mode"):u.valueExpression&&(u.field=e(p,u.valueExpression,"mode"),u.valueExpression=null);break;case "class-breaks":u.normalizationField?(u.field=l(p,u.field,"norm",u.normalizationField),u.normalizationField=
null):u.field?u.field=l(p,u.field,"avg"):(u.field=e(p,u.valueExpression,"avg"),u.valueExpression=null)}return u};z.findSizeVV=g;z.hasClusterCountVV=c;z.isClusterCompatibleRenderer=q;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/MD5":function(){define(["exports"],function(z){function D(f,d){const a=(f&65535)+(d&65535);return(f>>16)+(d>>16)+(a>>16)<<16|a&65535}function C(f,d,a,b,e,l){f=D(D(d,f),D(b,l));return D(f<<e|f>>>32-e,a)}function B(f,d,
a,b,e,l,k){return C(d&a|~d&b,f,d,e,l,k)}function y(f,d,a,b,e,l,k){return C(d&b|a&~b,f,d,e,l,k)}function x(f,d,a,b,e,l,k){return C(a^(d|~b),f,d,e,l,k)}const n={Base64:0,Hex:1,String:2,Raw:3};z.createMD5Hash=function(f,d=n.Hex){d=d||n.Base64;var a=[];for(let e=0,l=8*f.length;e<l;e+=8)a[e>>5]|=(f.charCodeAt(e/8)&255)<<e%32;{f=8*f.length;a[f>>5]|=128<<f%32;a[(f+64>>>9<<4)+14]=f;f=1732584193;var b=-271733879;let e=-1732584194,l=271733878;for(let k=0;k<a.length;k+=16){const r=f,g=b,c=e,m=l;f=B(f,b,e,l,
a[k+0],7,-680876936);l=B(l,f,b,e,a[k+1],12,-389564586);e=B(e,l,f,b,a[k+2],17,606105819);b=B(b,e,l,f,a[k+3],22,-1044525330);f=B(f,b,e,l,a[k+4],7,-176418897);l=B(l,f,b,e,a[k+5],12,1200080426);e=B(e,l,f,b,a[k+6],17,-1473231341);b=B(b,e,l,f,a[k+7],22,-45705983);f=B(f,b,e,l,a[k+8],7,1770035416);l=B(l,f,b,e,a[k+9],12,-1958414417);e=B(e,l,f,b,a[k+10],17,-42063);b=B(b,e,l,f,a[k+11],22,-1990404162);f=B(f,b,e,l,a[k+12],7,1804603682);l=B(l,f,b,e,a[k+13],12,-40341101);e=B(e,l,f,b,a[k+14],17,-1502002290);b=B(b,
e,l,f,a[k+15],22,1236535329);f=y(f,b,e,l,a[k+1],5,-165796510);l=y(l,f,b,e,a[k+6],9,-1069501632);e=y(e,l,f,b,a[k+11],14,643717713);b=y(b,e,l,f,a[k+0],20,-373897302);f=y(f,b,e,l,a[k+5],5,-701558691);l=y(l,f,b,e,a[k+10],9,38016083);e=y(e,l,f,b,a[k+15],14,-660478335);b=y(b,e,l,f,a[k+4],20,-405537848);f=y(f,b,e,l,a[k+9],5,568446438);l=y(l,f,b,e,a[k+14],9,-1019803690);e=y(e,l,f,b,a[k+3],14,-187363961);b=y(b,e,l,f,a[k+8],20,1163531501);f=y(f,b,e,l,a[k+13],5,-1444681467);l=y(l,f,b,e,a[k+2],9,-51403784);e=
y(e,l,f,b,a[k+7],14,1735328473);b=y(b,e,l,f,a[k+12],20,-1926607734);f=C(b^e^l,f,b,a[k+5],4,-378558);l=C(f^b^e,l,f,a[k+8],11,-2022574463);e=C(l^f^b,e,l,a[k+11],16,1839030562);b=C(e^l^f,b,e,a[k+14],23,-35309556);f=C(b^e^l,f,b,a[k+1],4,-1530992060);l=C(f^b^e,l,f,a[k+4],11,1272893353);e=C(l^f^b,e,l,a[k+7],16,-155497632);b=C(e^l^f,b,e,a[k+10],23,-1094730640);f=C(b^e^l,f,b,a[k+13],4,681279174);l=C(f^b^e,l,f,a[k+0],11,-358537222);e=C(l^f^b,e,l,a[k+3],16,-722521979);b=C(e^l^f,b,e,a[k+6],23,76029189);f=C(b^
e^l,f,b,a[k+9],4,-640364487);l=C(f^b^e,l,f,a[k+12],11,-421815835);e=C(l^f^b,e,l,a[k+15],16,530742520);b=C(e^l^f,b,e,a[k+2],23,-995338651);f=x(f,b,e,l,a[k+0],6,-198630844);l=x(l,f,b,e,a[k+7],10,1126891415);e=x(e,l,f,b,a[k+14],15,-1416354905);b=x(b,e,l,f,a[k+5],21,-57434055);f=x(f,b,e,l,a[k+12],6,1700485571);l=x(l,f,b,e,a[k+3],10,-1894986606);e=x(e,l,f,b,a[k+10],15,-1051523);b=x(b,e,l,f,a[k+1],21,-2054922799);f=x(f,b,e,l,a[k+8],6,1873313359);l=x(l,f,b,e,a[k+15],10,-30611744);e=x(e,l,f,b,a[k+6],15,-1560198380);
b=x(b,e,l,f,a[k+13],21,1309151649);f=x(f,b,e,l,a[k+4],6,-145523070);l=x(l,f,b,e,a[k+11],10,-1120210379);e=x(e,l,f,b,a[k+2],15,718787259);b=x(b,e,l,f,a[k+9],21,-343485551);f=D(f,r);b=D(b,g);e=D(e,c);l=D(l,m)}a=[f,b,e,l]}switch(d){case n.Raw:return a;case n.Hex:d=[];for(let e=0,l=4*a.length;e<l;e++)d.push("0123456789abcdef".charAt(a[e>>2]>>e%4*8+4&15)+"0123456789abcdef".charAt(a[e>>2]>>e%4*8&15));return d=d.join("");case n.String:d=[];for(let e=0,l=32*a.length;e<l;e+=8)d.push(String.fromCharCode(a[e>>
5]>>>e%32&255));return d=d.join("");case n.Base64:d=[];for(let e=0,l=4*a.length;e<l;e+=3)for(f=(a[e>>2]>>e%4*8&255)<<16|(a[e+1>>2]>>(e+1)%4*8&255)<<8|a[e+2>>2]>>(e+2)%4*8&255,b=0;4>b;b++)8*e+6*b>32*a.length?d.push("\x3d"):d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(f>>6*(3-b)&63));return d=d.join("")}};z.outputTypes=n;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),
function(z,D,C,B,y,x,n,f,d,a){var b;z.LevelDependentSizeVariable=b=function(e){function l(){return e.apply(this,arguments)||this}D._inheritsLoose(l,e);var k=l.prototype;k.writeLevels=function(r,g,c){for(const m in r){g.stops=this.levels[m];break}};k.clone=function(){return new b({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:a.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,
minDataValue:this.minDataValue,minSize:a.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(r=>r.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:B.clone(this.levels)})};return l}(d);C.__decorate([y.property()],z.LevelDependentSizeVariable.prototype,"levels",void 0);
C.__decorate([f.writer("levels")],z.LevelDependentSizeVariable.prototype,"writeLevels",null);z.LevelDependentSizeVariable=b=C.__decorate([n.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],z.LevelDependentSizeVariable);Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/support/util":function(){define(["exports","../../../../core/jsonMap"],function(z,D){const C=new D.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",
esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});z.analyzeRings=function(B,y,x){const n=[],f=[];let d=0,a=0;for(const b of B){B=a;let e=b[0][0],l=b[0][1];n[a++]=e;n[a++]=l;let k=0;for(let r=1;r<b.length;++r){const g=e,c=l;e=b[r][0];l=b[r][1];k+=l*g-e*c;n[a++]=e;n[a++]=l}y(k/2);0<k?(0<B-d&&(x(d,B,n,f),d=B),f.length=0):0>k?0<B-d?f.push(.5*(B-d)):a=B:a=B}0<a-d&&x(d,a,n,f)};z.canUseMajorityInterpolationOnDataSource=function(B){const {bandCount:y,
attributeTable:x,colormap:n,pixelType:f}=B.rasterInfo;return 1===y&&(null!=x||null!=n||"u8"===f||"s8"===f)};z.toJSONGeometryType=function(B){return C.toJSON(B)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils ../../../../webgl/enums".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g){function c(t,v){return w=>v(t(w))}const m=y.getLogger("esri.views.layers.2d.features.support.AttributeStore"),q=k.createDebugLogger(k.DEBUG_ATTR_UPDATES,m);var p=B("esri-shared-array-buffer"),u=B("esri-atomics");let h=function(){function t(w,A,E,G){this.size=0;this.texelSize=4;const {pixelType:F,layout:H,textureOnly:J}=G;this.textureOnly=J||!1;this.pixelType=F;this._ctype=A;this.layout=H;this._resetRange();this._shared=w;this.size=E;J||(this.data=this._initData(F,
E,w,A))}var v=t.prototype;v.unsetComponentAllTexels=function(w,A){const E=n.unwrap(this.data);for(let G=0;G<this.size*this.size;G++)E[G*this.texelSize+w]&=~A;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};v.setComponentAllTexels=function(w,A){const E=n.unwrap(this.data);for(let G=0;G<this.size*this.size;G++)E[G*this.texelSize+w]|=255&A;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};v.setComponent=function(w,A,E){const G=n.unwrap(this.data);for(const F of E)G[F*this.texelSize+w]|=A,
this.dirtyStart=Math.min(this.dirtyStart,F),this.dirtyEnd=Math.max(this.dirtyEnd,F)};v.setComponentTexel=function(w,A,E){n.unwrap(this.data)[E*this.texelSize+w]|=A;this.dirtyStart=Math.min(this.dirtyStart,E);this.dirtyEnd=Math.max(this.dirtyEnd,E)};v.unsetComponentTexel=function(w,A,E){n.unwrap(this.data)[E*this.texelSize+w]&=~A;this.dirtyStart=Math.min(this.dirtyStart,E);this.dirtyEnd=Math.max(this.dirtyEnd,E)};v.getData=function(w,A){w=e.getDisplayIdTexel(w);return n.unwrap(this.data)[w*this.texelSize+
A]};v.setData=function(w,A,E){w=e.getDisplayIdTexel(w);0===(this.layout&1<<A)?m.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[w*this.texelSize+A]=E,this.dirtyStart=Math.min(this.dirtyStart,w),this.dirtyEnd=Math.max(this.dirtyEnd,w))};v.lock=function(){this.pixelType===g.PixelType.UNSIGNED_BYTE&&this._shared&&u&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};v.unlock=function(){this.pixelType===g.PixelType.UNSIGNED_BYTE&&this._shared&&u&&
"local"!==this._ctype&&Atomics.store(this.data,0,0)};v.expand=function(w){this.size=w;if(!this.textureOnly){w=this._initData(this.pixelType,w,this._shared,this._ctype);const A=n.unwrap(this.data);w.set(A);this.data=w}};v.toMessage=function(){const w=this.dirtyStart,A=this.dirtyEnd;var E=this.texelSize;if(w>A)return null;this._resetRange();const G=!this._shared&&"local"!==this._ctype,F=this.pixelType,H=this.layout,J=n.unwrap(this.data);E=G&&J.slice(w*E,(A+1)*E)||null;return{start:w,end:A,data:E,pixelType:F,
layout:H}};v._initData=function(w,A,E,G){E=E&&"local"!==G?SharedArrayBuffer:ArrayBuffer;w=l.getPixelArrayCtor(w);A=new w(new E(A*A*4*w.BYTES_PER_ELEMENT));for(w=0;w<A.length;w+=4)A[w+1]=255;return A};v._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};D._createClass(t,[{key:"buffer",get:function(){return n.applySome(this.data,w=>w.buffer)}}]);return t}();return function(){function t(w,A,E=()=>{}){this._client=w;this.config=A;this._notifyChange=E;this._attributeComputeMap=new Map;
this._blocks=[];this._filters=Array(b.MAX_FILTERS);this._targetType=0;this._abortController=new AbortController;this._hasScaleExpr=!1;this._size=32;this._idsToHighlight=new Set;w=A.supportsTextureFloat?g.PixelType.FLOAT:g.PixelType.UNSIGNED_BYTE;q(`Creating AttributeStore ${p?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:g.PixelType.UNSIGNED_BYTE,layout:1},{pixelType:g.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:g.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},
{pixelType:w,layout:15},{pixelType:w,layout:15},{pixelType:w,layout:15},{pixelType:w,layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var v=t.prototype;v.destroy=function(){this._abortController.abort()};v.isUpdating=function(){return!!this._currUpdate||!!this._nextUpdate};v.update=function(w,A){this.config=A;A=A.schema.processors[0].storage;const E=d.diff(this._schema,A);if(w.targets.feature||w.targets.aggregate)w.storage.data=!0;if(E&&(B("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",
E),w.storage.data=!0,this._schema=A,this._attributeComputeMap.clear(),!n.isNone(A))){switch(A.target){case "feature":this._targetType=e.DISPLAY_ID_TYPE_FEATURE;break;case "aggregate":this._targetType=e.DISPLAY_ID_TYPE_AGGREGATE}if("subtype"===A.type)for(const G in A.mapping){if(w=A.mapping[G],n.isSome(w)&&n.isSome(w.vvMapping))for(const F of w.vvMapping)this._bindAttribute(F)}else{if(n.isSome(A.vvMapping))for(const G of A.vvMapping)this._bindAttribute(G);if(n.isSome(A.attributeMapping))for(const G of A.attributeMapping)this._bindAttribute(G)}}};
v.onTileData=function(w,A){if(!n.isNone(A.addOrUpdate))for(w=A.addOrUpdate.getCursor();w.next();)A=w.getDisplayId(),this.setAttributeData(A,w)};v.invalidateResources=function(){this._createResourcesPromise=null;this._abortController.abort();this._abortController=new AbortController};v.setHighlight=function(){var w=D._asyncToGenerator(function*(A,E){const G=this._getBlock(0);E=E.map(F=>e.getDisplayIdTexel(F));G.lock();G.unsetComponentAllTexels(0,1);G.setComponent(0,1,E);G.unlock();this._idsToHighlight.clear();
for(const F of A)this._idsToHighlight.add(F);yield this.sendUpdates()});return function(A,E){return w.apply(this,arguments)}}();v.updateFilters=function(){var w=D._asyncToGenerator(function*(A,E,G){const {service:F,spatialReference:H}=G;({filters:E}=E);E=E.map((J,I)=>this._updateFilter(J,I,F,H));(yield Promise.all(E)).some(J=>J)&&(A.storage.filters=!0,B("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))});return function(A,E,G){return w.apply(this,arguments)}}();
v.setData=function(w,A,E,G){const F=e.getDisplayIdTexel(w);this._ensureSizeForTexel(F);this._getBlock(A).setData(w,E,G)};v.getData=function(w,A,E){return this._getBlock(A).getData(w,E)};v.getHighlightFlag=function(w){return this._idsToHighlight.has(w)?b.HIGHLIGHT_FLAG:0};v.unsetAttributeData=function(w){w=e.getDisplayIdTexel(w);this._getBlock(0).setData(w,0,0)};v.setAttributeData=function(w,A){const E=e.getDisplayIdTexel(w);this._ensureSizeForTexel(E);this._getBlock(0).setData(E,0,this.getFilterFlags(A));
if(this._targetType===e.getDisplayIdType(w)){w=this._attributeComputeMap;var G=this.config.supportsTextureFloat?1:2;w.size&&w.forEach((F,H)=>{const J=H*G%4;H=this._getBlock(Math.floor(H*G/4)+b.ATTRIBUTE_DATA_VV);F=F(A);if(this.config.supportsTextureFloat)H.setData(E,J,F);else if(F===b.NAN_MAGIC_NUMBER)H.setData(E,J,255),H.setData(E,J+1,255);else{F=x.clamp(Math.round(F),-32767,32766)+32768;const I=(F&65280)>>8;H.setData(E,J,F&255);H.setData(E,J+1,I)}})}};v.sendUpdates=function(){B("esri-2d-update-debug")&&
console.debug("AttributeStore::sendUpdate");this._notifyChange();if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=f.createResolver(),this._nextUpdate.promise;const w={blocks:this._blocks.map(A=>n.isSome(A)?A.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var A=()=>{this._currUpdate=null;if(this._nextUpdate){const E=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>E.resolve())}else B("esri-2d-update-debug")&&
console.debug("AttributeStore::sendUpdate::No additional updates queued");this._notifyChange()};B("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::client.update");A=this._client.update(w,this._signal).then(A).catch(A);this._client.render(this._signal);return A}).catch(A=>{if(f.isAbortError(A))return this._createResourcesPromise=null,this._createResources();this._notifyChange();m.error(new C("mapview-attribute-store","Encountered an error during client update",A))})};v._ensureSizeForTexel=
function(w){for(;w>=this._size*this._size&&!this._expand(););};v._bindAttribute=function(w){function A(){return w.normalizationField?F=>{const H=F.readAttribute(w.normalizationField);return H?F.readAttribute(w.field)/H:null}:F=>F.readAttribute(w.field)}function E(){w.normalizationField&&m.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");return F=>F.getComputedNumericAtIndex(w.fieldIndex)}let G;if(null!=w.fieldIndex)G=E();else if(w.field)G=
A();else return;w.valueRepresentation&&(G=c(G,F=>r.getVisualVariableSizeValueRepresentationRatio(F,w.valueRepresentation)));this._attributeComputeMap.set(w.binding,c(G,F=>null===F||isNaN(F)||Infinity===F?b.NAN_MAGIC_NUMBER:F))};v._createResources=function(){if(n.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(b.ATTRIBUTE_DATA_ANIMATION);this._getBlock(b.ATTRIBUTE_DATA_GPGPU);q("Initializing AttributeStore");var w={shared:p&&"local"!==this._client.type,size:this._size,
blocks:n.mapMany(this._blocks,A=>({textureOnly:A.textureOnly,buffer:A.buffer,pixelType:A.pixelType}))};this._createResourcesPromise=w=this._client.initialize(w,this._signal).catch(A=>{f.isAbortError(A)?this._createResourcesPromise=null:m.error(new C("mapview-attribute-store","Encountered an error during client initialization",A))});w.then(()=>n.isNone(this._createResourcesPromise)?this._createResources():void 0);return w};v._getBlock=function(w){var A=this._blocks[w];if(n.isSome(A))return A;q(`Initializing AttributeBlock at index ${w}`);
A=new h(p,this._client.type,this._size,this._blockDescriptors[w]);this._blocks[w]=A;this._createResourcesPromise=null;return A};v._expand=function(){if(this._size<this.config.maxTextureSize){const w=this._size<<=1;q("Expanding block size to",w,this._blocks);n.forEachSome(this._blocks,A=>A.expand(w));this._createResourcesPromise=null;this._size=w;return 0}m.error(new C("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};v._updateFilter=function(){var w=D._asyncToGenerator(function*(A,
E,G,F){const H=this._filters[E],J=n.isSome(H)&&H.hash;if(!H&&!A||J===JSON.stringify(A))return!1;if(n.isNone(A)){if(!H)return!1;A=1<<E+1;G=this._getBlock(0);this._filters[E]=null;G.setComponentAllTexels(0,A);this.sendUpdates();return!0}yield(yield this._getFilter(E,G)).update(A,F);return!0});return function(A,E,G,F){return w.apply(this,arguments)}}();v._getFilter=function(){var w=D._asyncToGenerator(function*(A,E){var G=this._filters[A];if(n.isSome(G))return G;({default:G}=yield new Promise((F,H)=>
z(["./FeatureFilter"],J=>F(Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}))),H)));E=new G({geometryType:E.geometryType,hasM:!1,hasZ:!1,timeInfo:E.timeInfo,fieldsIndex:new a(E.fields)});return this._filters[A]=E});return function(A,E){return w.apply(this,arguments)}}();v.isVisible=function(w){return!!(this._getBlock(0).getData(w,0)&2)};v.getFilterFlags=function(w){let A=0;var E=e.getDisplayIdFilterMask(w.getDisplayId());for(let F=0;F<this._filters.length;F++){var G=
this._filters[F];G=!(E&1<<F)||n.isNone(G)||G.check(w);A|=(G?1:0)<<F}E=0;this._idsToHighlight.size&&(w=w.getObjectId(),E=this.getHighlightFlag(w));return A<<1|E};D._createClass(t,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",get:function(){return this._abortController.signal}},{key:"hasHighlight",get:function(){return 0<this._idsToHighlight.size}}]);return t}()})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(z){z.DEBUG_ATTR_UPDATES=
!1;z.createDebugLogger=(D,C)=>D&&((...B)=>C.warn("DEBUG:",...B))||(()=>null);Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils".split(" "),function(z,
D,C,B,y,x,n){function f(r){return{value:r.value,size:C.toPt(r.size)}}function d(r){return r.map(g=>f(g))}function a(r){return"string"===typeof r||"number"===typeof r?C.toPt(r):{type:"size",expression:r.expression,stops:d(r.stops)}}function b(r){const g={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof r.field)if(r.stops){if(8<r.stops.length)return null;r=r.stops;for(var c=0;8>c;++c){const m=r[Math.min(c,r.length-1)];g.values[c]=m.value;g.opacities[c]=m.opacity}}else return null;
else if(r.stops&&0<=r.stops.length)for(r=r.stops&&0<=r.stops.length&&r.stops[0].opacity,c=0;8>c;c++)g.values[c]=Infinity,g.opacities[c]=r;else return null;return g}function e(r,g,c){r[4*g]=c.r/255;r[4*g+1]=c.g/255;r[4*g+2]=c.b/255;r[4*g+3]=c.a}function l(r){if(D.isNone(r)||r.normalizationField)return null;const g={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof r.field)if(r.stops){if(8<r.stops.length)return null;g.field=
r.field;r=r.stops;for(var c=0;8>c;++c){const m=r[Math.min(c,r.length-1)];g.values[c]=m.value;e(g.colors,c,m.color)}}else return null;else if(r.stops&&0<=r.stops.length)for(r=r.stops&&0<=r.stops.length&&r.stops[0].color,c=0;8>c;c++)g.values[c]=Infinity,e(g.colors,c,r);else return null;for(r=0;32>r;r+=4)B.premultiplyAlpha(g.colors,r,!0);return g}const k=r=>{const g=[],c=[];r=d(r);const m=r.length;for(let q=0;6>q;q++){const p=r[Math.min(q,m-1)];g.push(p.value);c.push(null==p.size?y.NAN_MAGIC_NUMBER:
C.pt2px(p.size))}return{values:new Float32Array(g),sizes:new Float32Array(c)}};z.convertColorVariable=l;z.convertVisualVariables=function(r){const g=r&&0<r.length?{}:null,c=g?{}:null;if(!g)return{vvFields:g,vvRanges:c};for(const m of r)if(m.field&&(g[m.type]=m.field),"size"===m.type)switch(c.size||(c.size={}),r=m,n.getTypeOfSizeVisualVariable(r)){case x.WGLVVFlag.SIZE_MINMAX_VALUE:c.size.minMaxValue={minDataValue:r.minDataValue,maxDataValue:r.maxDataValue,minSize:a(r.minSize),maxSize:a(r.maxSize)};
break;case x.WGLVVFlag.SIZE_SCALE_STOPS:c.size.scaleStops={stops:d(r.stops)};break;case x.WGLVVFlag.SIZE_FIELD_STOPS:if(r.levels){const q={};for(const p in r.levels)q[p]=k(r.levels[p]);c.size.fieldStops={type:"level-dependent",levels:q}}else c.size.fieldStops={type:"static",...k(r.stops)};break;case x.WGLVVFlag.SIZE_UNIT_VALUE:c.size.unitValue={unit:r.valueUnit,valueRepresentation:r.valueRepresentation}}else"color"===m.type?c.color=l(m):"opacity"===m.type?c.opacity=b(m):"rotation"===m.type&&(c.rotation=
{type:m.rotationType});return{vvFields:g,vvRanges:c}};z.getVisualVariableSizeValueRepresentationRatio=function(r,g){if(!r||!g)return r;switch(g){case "radius":case "distance":return 2*r;case "area":return Math.sqrt(r)}return r};z.getVisualVariablesFields=function(r){const g=r&&0<r.length?{}:null;g&&r.forEach(c=>{const m=c.type;c.field&&(g[m]=c.field)});return g};z.normalizeSizeElement=a;z.normalizeSizeStops=d;z.stopToSizeStop=f;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports","../../../engine/webgl/DisplayId","./DisplayIdGenerator","./StaticBitSet"],function(z,D,C,B){function y(n,f,d){if(!(n.length>f))for(;n.length<=f;)n.push(d)}let x=function(){function n(){this._numerics=[];this._strings=[];this._idGenerator=new C.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}var f=n.prototype;f.createBitset=function(){const d=this._bitsets.length;
this._bitsets.push(B.StaticBitSet.create(this._allocatedSize,D.DISPLAY_ID_TEXEL_MASK));return d+1};f.getBitset=function(d){return this._bitsets[d-1]};f._expand=function(){this._allocatedSize<<=1;for(const d of this._bitsets)d.resize(this._allocatedSize)};f._ensureNumeric=function(d,a){this._numerics[d]||(this._numerics[d]=[]);y(this._numerics[d],a,0)};f._ensureInstanceId=function(d){y(this._instanceIds,d,0)};f._ensureString=function(d,a){this._strings[d]||(this._strings[d]=[]);y(this._strings[d],
a,null)};f.createDisplayId=function(d=!1){const a=this._idGenerator.createId();a>this._allocatedSize&&this._expand();return D.createDisplayId(a,d)};f.releaseDisplayId=function(d){for(const a of this._bitsets)a.unset(d);return this._idGenerator.releaseId(d&D.DISPLAY_ID_TEXEL_MASK)};f.getComputedNumeric=function(d,a){return this.getComputedNumericAtIndex(d&D.DISPLAY_ID_TEXEL_MASK,0)};f.setComputedNumeric=function(d,a,b){return this.setComputedNumericAtIndex(d&D.DISPLAY_ID_TEXEL_MASK,b,0)};f.getComputedString=
function(d,a){return this.getComputedStringAtIndex(d&D.DISPLAY_ID_TEXEL_MASK,0)};f.setComputedString=function(d,a,b){return this.setComputedStringAtIndex(d&D.DISPLAY_ID_TEXEL_MASK,0,b)};f.getComputedNumericAtIndex=function(d,a){d&=D.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(a,d);return this._numerics[a][d]};f.setComputedNumericAtIndex=function(d,a,b){d&=D.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(a,d);this._numerics[a][d]=b};f.getInstanceId=function(d){d&=D.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(d);
return this._instanceIds[d]};f.setInstanceId=function(d,a){d&=D.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(d);this._instanceIds[d]=a};f.getComputedStringAtIndex=function(d,a){d&=D.DISPLAY_ID_TEXEL_MASK;this._ensureString(a,d);return this._strings[a][d]};f.setComputedStringAtIndex=function(d,a,b){d&=D.DISPLAY_ID_TEXEL_MASK;this._ensureString(a,d);this._strings[a][d]=b};f.getXMin=function(d){return this._bounds[4*(d&D.DISPLAY_ID_TEXEL_MASK)]};f.getYMin=function(d){return this._bounds[4*(d&D.DISPLAY_ID_TEXEL_MASK)+
1]};f.getXMax=function(d){return this._bounds[4*(d&D.DISPLAY_ID_TEXEL_MASK)+2]};f.getYMax=function(d){return this._bounds[4*(d&D.DISPLAY_ID_TEXEL_MASK)+3]};f.setBounds=function(d,a){a=a.readHydratedGeometry();if(!a||!a.coords.length)return!1;let b=Infinity,e=Infinity,l=-Infinity,k=-Infinity;a.forEachVertex((r,g)=>{b=Math.min(b,r);e=Math.min(e,g);l=Math.max(l,r);k=Math.max(k,g)});d&=D.DISPLAY_ID_TEXEL_MASK;y(this._bounds,4*d+4,0);this._bounds[4*d]=b;this._bounds[4*d+1]=e;this._bounds[4*d+2]=l;this._bounds[4*
d+3]=k;return!0};return n}();z.ComputedAttributeStorage=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/DisplayIdGenerator":function(){define(["exports","../../../engine/webgl/DisplayId"],function(z,D){let C=function(){function B(){this._freeIds=[];this._idCounter=1}var y=B.prototype;y.createId=function(x=!1){return D.createDisplayId(this._getFreeId(),x)};y.releaseId=function(x){this._freeIds.push(x)};y._getFreeId=
function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++};return B}();z.DisplayIdGenerator=C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/GraphicsReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry/support/jsonUtils ../../../../../layers/graphics/featureConversionUtils ./FeatureSetReader ./FeatureSetReaderJSON".split(" "),function(z,D,C,B,
y,x){x=function(n){function f(a,b){return n.call(this,a,b,null)||this}D._inheritsLoose(f,n);f.from=function(a,b){const e=y.FeatureSetReader.createInstance(),l=[];a=a.filter(k=>!!k.geometry);for(const k of a)a=C.getJsonType(k.geometry),B.convertFromGraphics(l,[k],a,!1,!1,b);return new f(e,l)};var d=f.prototype;d.readGraphic=function(){return this._current};d.getCursor=function(){return this.copy()};d.copy=function(){const a=new f(this.instance,this._features);this.copyInto(a);return a};D._createClass(f,
[{key:"geometryType",get:function(){const a=this._current;return a?a.geometryType:null}},{key:"insertAfter",get:function(){return this._current.insertAfter}}]);return f}(x.FeatureSetReaderJSON);z.GraphicsReader=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/has ../../../../../core/maybe ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ./StaticBitSet ../../../../../geometry/support/jsonUtils".split(" "),
function(z,D,C,B,y,x,n,f,d,a){var b,e,l;let k=0;C=null!=(b=B("featurelayer-simplify-thresholds"))?b:[.5,.5,.5,.5];const r=C[0],g=C[1],c=C[2],m=C[3];b=null!=(e=B("featurelayer-simplify-payload-size-factors"))?e:[1,2,4];const q=b[0],p=b[1],u=b[2],h=null!=(l=B("featurelayer-simplify-mobile-factor"))?l:2,t=B("esri-mobile");B=function(){function v(A,E){this.type="FeatureSetReader";this.arcadeDeclaredClass="esri.arcade.Feature";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._deleted=
null;this._joined=[];this._objectIdToIndex=null;this._level=0;this.instance=A;this._layerSchema=E}v.createInstance=function(){k++;return k=65535<k?0:k};var w=v.prototype;w.getAreaSimplificationThreshold=function(A,E){let G=1;const F=t?h:1;4E6<E?G=u*F:1E6<E?G=p*F:5E5<E?G=q*F:1E5<E&&(G=F);E=0;4E3<A?E=m*G:2E3<A?E=c*G:100<A?E=g:15<A&&(E=r);A=8;4>this._level?A=1:5>this._level?A=2:6>this._level&&(A=4);return E*A};w.setArcadeSpatialReference=function(A){this._arcadeSpatialReference=A};w.attachStorage=function(A){this._storage=
A};w.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");};w.getStorage=function(){return this._storage};w.getComputedNumeric=function(A){return this.getComputedNumericAtIndex(0)};w.setComputedNumeric=function(A,E){return this.setComputedNumericAtIndex(E,0)};w.getComputedString=function(A){return this.getComputedStringAtIndex(0)};w.setComputedString=function(A,E){return this.setComputedStringAtIndex(0,E)};w.getComputedNumericAtIndex=function(A){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),
A)};w.setComputedNumericAtIndex=function(A,E){this._storage.setComputedNumericAtIndex(this.getDisplayId(),A,E)};w.getComputedStringAtIndex=function(A){return this._storage.getComputedStringAtIndex(this.getDisplayId(),A)};w.setComputedStringAtIndex=function(A,E){return this._storage.setComputedStringAtIndex(this.getDisplayId(),A,E)};w.transform=function(A,E,G,F){const H=this.copy();H._tx+=A;H._ty+=E;H._sx*=G;H._sy*=F;return H};w.readAttribute=function(A,E=!1){var G=this._readAttribute(A,E);if(void 0!==
G)return G;for(const F of this._joined)if(F.setIndex(this.getIndex()),G=F._readAttribute(A,E),void 0!==G)return G};w.readAttributes=function(){const A=this._readAttributes();for(const E of this._joined){E.setIndex(this.getIndex());const G=E._readAttributes();for(const F of Object.keys(G))A[F]=G[F]}return A};w.joinAttributes=function(A){this._joined.push(A)};w.readArcadeFeature=function(){return this};w.geometry=function(){var A=this.readHydratedGeometry();A=n.convertToGeometry(A,this.geometryType,
this.hasZ,this.hasM);if(A=a.fromJSON(A))A.spatialReference=this._arcadeSpatialReference;return A};w.field=function(A){if(this.hasField(A))return this.readAttribute(A,!0);for(const E of this._joined)if(E.setIndex(this.getIndex()),E.hasField(A))return E._readAttribute(A,!0);throw Error(`Field ${A} does not exist`);};w.setField=function(A,E){throw Error("Unable to update feature attribute values, feature is readonly");};w.keys=function(){return this.getFieldNames()};w.castToText=function(){return JSON.stringify(this.readLegacyFeature())};
w.gdbVersion=function(){return null};w.fullSchema=function(){return this._layerSchema};w.castAsJson=function(A=null){return{attributes:this._readAttributes(),geometry:!0===(null==A?void 0:A.keepGeometryType)?this.geometry():this.geometry().toJSON()}};w.castAsJsonAsync=function(A,E=null){return Promise.resolve(this.castAsJson(E))};w.removeIds=function(A){if(y.isNone(this._objectIdToIndex)){var E=new Map;const G=this.getCursor();for(;G.next();)E.set(G.getObjectId(),G.getIndex());this._objectIdToIndex=
E}E=this._objectIdToIndex;for(const G of A)E.has(G)&&this.removeAtIndex(E.get(G))};w.removeAtIndex=function(A){y.isNone(this._deleted)&&(this._deleted=d.StaticBitSet.create(this.getSize()));this._deleted.set(A)};w.readGeometryForDisplay=function(){return this.readUnquantizedGeometry(!0)};w.readLegacyGeometryForDisplay=function(){return this.readLegacyGeometry(!0)};w.features=function*(){const A=this.getCursor();for(;A.next();)yield A.readOptimizedFeature()};w._getExists=function(){return y.isNone(this._deleted)||
!this._deleted.has(this.getIndex())};w._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;const A=this.readUnquantizedGeometry();if(!A||A.hasIndeterminateRingOrder)return null;const E=y.unwrapOr(this.getQuantizationTransform(),null);return x.getCentroidOptimizedGeometry(new f,A,this.hasM,this.hasZ,E)};w.copyInto=function(A){A.seen=this.seen;A._storage=this._storage;A._arcadeSpatialReference=this._arcadeSpatialReference;A._joined=this._joined;A._tx=this._tx;A._ty=
this._ty;A._sx=this._sx;A._sy=this._sy;A._deleted=this._deleted;A._objectIdToIndex=this._objectIdToIndex};D._createClass(v,[{key:"isEmpty",get:function(){return y.isSome(this._deleted)&&this._deleted.countSet()===this.getSize()}},{key:"level",set:function(A){this._level=A}}]);return v}();z.FeatureSetReader=B;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/graphics/centroid":function(){define(["exports","../../core/maybe"],function(z,D){function C(y,
x,n,f,d,a,b=1){a=d?a?4:3:a?3:2;let e=n,l=n+a,k=0,r=0,g=n=0,c=0;for(let m=0,q=f-1;m<q;m++,e+=a,l+=a){f=x[e];const p=x[e+1],u=x[e+2],h=x[l],t=x[l+1],v=x[l+2];let w=f*t-h*p;g+=w;k+=(f+h)*w;r+=(p+t)*w;d&&(w=f*v-h*u,n+=(u+v)*w,c+=w);f<y[0]&&(y[0]=f);f>y[1]&&(y[1]=f);p<y[2]&&(y[2]=p);p>y[3]&&(y[3]=p);d&&(u<y[4]&&(y[4]=u),u>y[5]&&(y[5]=u))}0<g*b&&(g*=-1);0<c*b&&(c*=-1);if(!g)return null;y=[k,r,.5*g];d&&(y[3]=n,y[4]=.5*c);return y}function B(y,x,n,f,d){d=f?d?4:3:d?3:2;let a=x,b=x+d,e=0,l=0,k=0,r=0;for(let q=
0,p=n-1;q<p;q++,a+=d,b+=d){var g=y[a];const u=y[a+1],h=y[a+2],t=y[b],v=y[b+1],w=y[b+2];if(f){{var c=t-g;var m=v-u;const A=w-h;c=Math.sqrt(c*c+m*m+A*A)}}else c=t-g,m=v-u,c=Math.sqrt(c*c+m*m);c&&(e+=c,f?(g=[g+.5*(t-g),u+.5*(v-u),h+.5*(w-h)],l+=c*g[0],k+=c*g[1],r+=c*g[2]):(g=[g+.5*(t-g),u+.5*(v-u)],l+=c*g[0],k+=c*g[1]))}return 0<e?f?[l/e,k/e,r/e]:[l/e,k/e]:0<n?f?[y[x],y[x+1],y[x+2]]:[y[x],y[x+1]]:null}z.getCentroidOptimizedGeometry=function(y,x,n,f,d){if(D.isNone(x)||!x.lengths.length)return null;const a=
"upperLeft"===(null==d?void 0:d.originPosition)?-1:1;y.lengths.length&&(y.lengths.length=0);y.coords.length&&(y.coords.length=0);d=y.coords;const b=[],e=n?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:l,coords:k}=x,r=n?f?4:3:f?3:2;let g=0;for(var c of l){const m=C(e,k,g,c,n,f,a);m&&b.push(m);
g+=c*r}b.sort((m,q)=>{let p=a*m[2]-a*q[2];0===p&&n&&(p=m[4]-q[4]);return p});b.length&&(c=6*b[0][2],d[0]=b[0][0]/c,d[1]=b[0][1]/c,n&&(c=6*b[0][4],d[2]=0!==c?b[0][3]/c:0),d[0]<e[0]||d[0]>e[1]||d[1]<e[2]||d[1]>e[3]||n&&(d[2]<e[4]||d[2]>e[5]))&&(d.length=0);if(!d.length)if(x=x.lengths[0]?B(k,0,l[0],n,f):null)d[0]=x[0],d[1]=x[1],n&&2<x.length&&(d[2]=x[2]);else return null;return y};z.lineCentroid=B;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ./FeatureSetReader".split(" "),
function(z,D,C,B,y,x){function n({coords:d,lengths:a}){let b=0;for(const e of a){for(a=1;a<e;a++)d[2*(b+a)]+=d[2*(b+a)-2],d[2*(b+a)+1]+=d[2*(b+a)-1];b+=e}}let f=function(d){function a(e,l,k){e=d.call(this,e,k)||this;e._featureIndex=-1;e._dateFields=new Set;e._geometryType=null==k?void 0:k.geometryType;e._features=l;return e}D._inheritsLoose(a,d);a.fromFeatures=function(e,l){const {objectIdField:k,geometryType:r}=l,g=B.convertFromFeatures([],e,r,!1,!1,k);for(let c=0;c<g.length;c++)g[c].displayId=e[c].displayId;
return a.fromOptimizedFeatures(g,l)};a.fromFeatureSet=function(e,l){e=B.convertFromFeatureSet(e,l.objectIdField);return a.fromOptimizedFeatureSet(e,l)};a.fromOptimizedFeatureSet=function(e,l){const {features:k}=e;l=a.fromOptimizedFeatures(k,l);l._exceededTransferLimit=e.exceededTransferLimit;l._transform=e.transform;for(const r of e.fields)"esriFieldTypeDate"===r.type&&l._dateFields.add(r.name);return l};a.fromOptimizedFeatures=function(e,l,k){const r=x.FeatureSetReader.createInstance();e=new a(r,
e,l);e._transform=k;return e};var b=a.prototype;b.removeIds=function(e){const l=new Set(e);this._features=this._features.filter(k=>!l.has(k.objectId))};b.append=function(e){for(const l of e)this._features.push(l)};b.getSize=function(){return this._features.length};b.getCursor=function(){return this.copy()};b.getQuantizationTransform=function(){return this._transform};b.getAttributeHash=function(){let e="";for(const l in this._current.attributes)e+=this._current.attributes[l];return e};b.getIndex=
function(){return this._featureIndex};b.setIndex=function(e){this._featureIndex=e};b.getObjectId=function(){return this._current.objectId};b.getDisplayId=function(){return this._current.displayId};b.setDisplayId=function(e){this._current.displayId=e};b.getGroupId=function(){return this._current.groupId};b.setGroupId=function(e){this._current.groupId=e};b.copy=function(){const e=new a(this.instance,this._features,this.fullSchema());this.copyInto(e);return e};b.next=function(){for(;++this._featureIndex<
this._features.length&&!this._getExists(););return this._featureIndex<this._features.length};b.readLegacyFeature=function(){return B.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};b.readOptimizedFeature=function(){return this._current};b.readLegacyPointGeometry=function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null};b.readLegacyGeometry=function(){const e=this.readGeometry();return B.convertToGeometry(e,this.geometryType,this.hasZ,this.hasM)};b.readLegacyCentroid=
function(){const e=this.readCentroid();return C.isNone(e)?null:{x:e.coords[0]*this._sx+this._tx,y:e.coords[1]*this._sy+this._ty}};b.readGeometryArea=function(){return y.hasGeometry(this._current)?B.getQuantizedArea(this._current.geometry,2):0};b.readUnquantizedGeometry=function(){var e=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!e)return e;e=e.clone();n(e);return e};b.readHydratedGeometry=function(){var e=this._current.geometry;if(C.isNone(e))return null;e=e.clone();C.isSome(this._transform)&&
B.unquantizeOptimizedGeometry(e,e,this.hasZ,this.hasM,this._transform);return e};b.getXHydrated=function(){if(!y.hasGeometry(this._current))return 0;const e=this._current.geometry.coords[0],l=this.getQuantizationTransform();return C.isNone(l)?e:e*l.scale[0]+l.translate[0]};b.getYHydrated=function(){if(!y.hasGeometry(this._current))return 0;const e=this._current.geometry.coords[1],l=this.getQuantizationTransform();return C.isNone(l)?e:l.translate[1]-e*l.scale[1]};b.getX=function(){return y.hasGeometry(this._current)?
this._current.geometry.coords[0]*this._sx+this._tx:0};b.getY=function(){return y.hasGeometry(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0};b.readGeometry=function(){if(!y.hasGeometry(this._current))return null;const e=this._current.geometry.clone();if(e.isPoint)return e.coords[0]=e.coords[0]*this._sx+this._tx,e.coords[1]=e.coords[1]*this._sy+this._ty,e;let l=0;for(const k of e.lengths)e.coords[2*l]=e.coords[2*l]*this._sx+this._tx,e.coords[2*l+1]=e.coords[2*l+1]*this._sy+this._ty,
l+=k;return e};b.readCentroid=function(){if(!y.hasGeometry(this._current))return null;if(C.isNone(this._current.centroid)){var e=this._computeCentroid();if(C.isNone(e))return null;e.coords[0]=(e.coords[0]-this._tx)/this._sx;e.coords[1]=(e.coords[1]-this._ty)/this._sy;this._current.centroid=e}e=this._current.centroid.clone();e.coords[0]=e.coords[0]*this._sx+this._tx;e.coords[1]=e.coords[1]*this._sx+this._ty;return e};b.hasField=function(e){return e in this._current.attributes?!0:this.getFieldNames().map(l=>
l.toLowerCase()).includes(e.toLowerCase())};b.getFieldNames=function(){return Object.keys(this._current.attributes)};b._readAttribute=function(e,l){var k=this._current.attributes[e];if(void 0!==k)return null!=k&&l&&this._dateFields.has(e)?new Date(k):k;k=this.readAttributes();e=e.toLocaleLowerCase().trim();for(const r in k)if(r.toLocaleLowerCase().trim()===e)return e=this._current.attributes[r],null!=e&&l&&this._dateFields.has(r)?new Date(e):e};b.copyInto=function(e){d.prototype.copyInto.call(this,
e);e._featureIndex=this._featureIndex;e._transform=this._transform;e._dateFields=this._dateFields};b._readAttributes=function(){return this._current.attributes};D._createClass(a,[{key:"_current",get:function(){return this._features[this._featureIndex]}},{key:"geometryType",get:function(){return this._geometryType}},{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},
{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return a}(x.FeatureSetReader);z.FeatureSetReaderJSON=f;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/graphics/GraphicStore":function(){define("../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/rbush ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/boundsUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/spatialReferenceUtils ../../../../symbols/cim/CIMSymbolDrawHelper ../../../../symbols/cim/CIMSymbolHelper ./GraphicStoreItem ./graphicsUtils".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b){function e(c,m,q,p,u){k.minX=m;k.minY=q;k.maxX=p;k.maxY=u;return c.search(k)}function l(c){return{minX:c.bounds[0],minY:c.bounds[1],maxX:c.bounds[2],maxY:c.bounds[3]}}const k={minX:0,minY:0,maxX:0,maxY:0},r=B.create(),g=(c,m)=>{const q=b.graphicGeometryToNumber(c.graphic),p=b.graphicGeometryToNumber(m.graphic);return q===p?m.zorder-c.zorder:q-p};return function(){function c(q,p,u,h,t,v,w){this._graphics=h;this._onAdd=t;this._onRemove=v;this._hashToCIM=w;this._index=
C.rbush(9,l);this._itemByGraphic=new Map;this._inflatedSizeHelper=new d.CIMSimbolInflatedSizeHelper;this._tileInfoView=q;this._uidFieldName=u;if(q=q.getClosestInfoForScale(p))this._resolution=this._tileInfoView.getTileResolution(q.level)}var m=c.prototype;m.setResourceManager=function(q){this._cimResourceManager=q;this._hittestDrawHelper=new f.HittestDrawHelper(q)};m.hitTest=function(q,p,u,h,t){q=x.normalizeMapX(q,this._tileInfoView.spatialReference);var v=.5*h*window.devicePixelRatio*u;r[0]=q-v;
r[1]=p-v;r[2]=q+v;r[3]=p+v;u=.5*h*(u+b.PIXEL_BUFFER);p=e(this._index,q-u,p-u,q+u,p+u);if(!p||0===p.length)return[];q=[];u=B.create();v=B.create();for(var w of p){const {geometry:A,symbolResource:E}=w;this._getSymbolBounds(u,E,A,v,t);v[3]=v[2]=v[1]=v[0]=0;B.intersects(u,r)&&w.graphic.visible&&q.push(w)}if(0===q.length)return[];w=this._hittestDrawHelper;p=[];for(const A of q){const {geometry:E,symbolResource:G}=A,{hash:F,textInfo:H}=G;(q=this._hashToCIM.get(F))&&w.hitTest(r,q.symbol,E,H,t,h)&&p.push(A)}p.sort(g);
return p.map(A=>A.graphic)};m.getGraphicsData=function(q,p,u){const h=this._searchForItems(p);if(0===h.length||0===u.length)return[];h.sort((F,H)=>F.zorder-H.zorder);h[0].insertAfter=-1;for(var t=1;t<h.length;t++)h[t].insertAfter=h[t-1].graphic.uid;h.sort((F,H)=>F.graphic.uid-H.graphic.uid);u.sort((F,H)=>F.uid-H.uid);let v=t=0,w;const A=p.resolution,E=[],G={originPosition:"upperLeft",scale:[A,A],translate:[p.bounds[0],p.bounds[3]]};for(const F of u){for(v=-2;t<h.length;)if(w=h[t],t++,F.uid===w.graphic.uid){v=
w.insertAfter;break}if(!w.geometry||-2===v)continue;u=w.getGeometryQuantized(G,p.bounds,this._tileInfoView.spatialReference,A);const H={...w.graphic.attributes};H[this._uidFieldName]=F.uid;null==w.groupId&&(w.groupId=q.createTemplateGroup(w.symbol,null));E.push({centroid:a.getCentroidQuantized(w,G),geometry:u,attributes:H,symbol:w.symbol,groupId:w.groupId,insertAfter:v,zorder:w.zorder})}E.sort((F,H)=>F.zorder-H.zorder);return E};m.queryTileData=function(q,p){if(0===this._graphics.length)return[];
const {bounds:u,resolution:h}=p,t=this._searchForItems(p),v=[];if(0===t.length)return v;this._createTileGraphics(v,q,t,{originPosition:"upperLeft",scale:[h,h],translate:[u[0],u[3]]},p);return v};m.has=function(q){return this._itemByGraphic.has(q)};m.getBounds=function(q){return(q=this._itemByGraphic.get(q))?q.bounds:null};m.getAllBounds=function(){return Array.from(this._itemByGraphic.values()).filter(q=>q.graphic.visible).map(q=>q.bounds)};m.addOrModify=function(q,p,u){if(q&&!z.isNone(p)){this.has(q)&&
this.remove(q);this._onAdd(q);var h=[0,0,0,0],t=this._getSymbolBounds(null,p,u,h,0);p=a.acquire(q,p,u,z.isSome(t)?t:null,h);this._itemByGraphic.set(q,p);u&&this._index.insert(p);return p.bounds}};m.remove=function(q){if(this._itemByGraphic.has(q)){this._onRemove(q);var p=this._itemByGraphic.get(q);p.bounds&&this._index.remove(p);this._itemByGraphic.delete(q)}};m.updateZ=function(){const q=this._graphics.items;for(let u=0;u<q.length;u++){var p=q[u];if(p=this._itemByGraphic.get(p))p.zorder=u}};m.update=
function(q,p,u){const h=this._itemByGraphic.get(q);h.groupId=null;const t=B.clone(h.bounds);this._index.remove(h);const v=this._getSymbolBounds(h.bounds,p,u,h.size,0);z.isSome(v)&&h.set(q,p,u,v,h.size);u&&this._index.insert(h);return{oldBounds:t,newBounds:h.bounds}};m.updateLevel=function(q){if(this._resolution!==q){this._resolution=q;this._index.clear();var p=this._itemByGraphic;q=[];for(const [,u]of p)p=this._getSymbolBounds(u.bounds,u.symbolResource,u.geometry,u.size,0),u.geometry&&z.isSome(p)&&
(u.bounds=p,q.push(u));this._index.load(q)}};m.clear=function(){this._itemByGraphic.clear();this._index.clear()};m._createTileGraphics=function(q,p,u,h,t){const v=this._uidFieldName,w=this._tileInfoView.spatialReference,{bounds:A,resolution:E}=t;u.sort((J,I)=>J.zorder-I.zorder);let G,F,H;for(let J=0;J<u.length;J++){F=u[J];t=F.graphic;G=F.getGeometryQuantized(h,A,w,E);H=0===J?-1:u[J-1].graphic.uid;const I={...F.graphic.attributes};I[v]=t.uid;null==F.groupId&&(F.groupId=p.createTemplateGroup(F.symbol,
null));q.push({centroid:a.getCentroidQuantized(F,h),geometry:G,attributes:I,symbol:F.symbol,groupId:F.groupId,insertAfter:H,zorder:F.zorder})}};m._searchForItems=function(q){var p=this._tileInfoView.spatialReference,u=q.bounds;if(p.isWrappable){const [h,t]=n.getInfo(p).valid;p=1E-5>Math.abs(u[2]-t);const v=1E-5>Math.abs(u[0]-h);if(!(p&&v||!p&&!v))return q=q.resolution,q=p?B.create([h,u[1],h+q*b.PIXEL_BUFFER,u[3]]):B.create([t-q*b.PIXEL_BUFFER,u[1],t,u[3]]),u=e(this._index,u[0],u[1],u[2],u[3]),q=e(this._index,
q[0],q[1],q[2],q[3]),[...new Set([...u,...q])]}return e(this._index,u[0],u[1],u[2],u[3])};m._getSymbolBounds=function(q,p,u,h,t){if(!p||!p.symbol||!u)return null;q||(q=B.create());y.getBoundsXY(q,u);if(!h||0===h[0]&&0===h[1]&&0===h[2]&&0===h[3]){const {hash:v,textInfo:w}=p;p=this._hashToCIM.get(v);if(!p)return null;h||(h=[0,0,0,0]);t=this._inflatedSizeHelper.getSymbolInflateSize(h,p.symbol,this._cimResourceManager,t,w);h[0]=D.pt2px(t[0]);h[1]=D.pt2px(t[1]);h[2]=D.pt2px(t[2]);h[3]=D.pt2px(t[3])}t=
this._resolution;h=d.CIMSimbolInflatedSizeHelper.safeSize(h);q[0]-=h*t;q[1]-=h*t;q[2]+=h*t;q[3]+=h*t;return q};return c}()})},"esri/views/2d/layers/graphics/GraphicStoreItem":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/jsonUtils ../../../../geometry/support/quantizationUtils ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry".split(" "),
function(z,D,C,B,y,x,n,f,d){function a(l){l.coords.length=0;l.lengths.length=0}const b=new d,e=new d;d=function(){function l(){this.bounds=C.create();this.graphic=null}l.acquire=function(r=null,g,c,m,q){let p;0===l._pool.length?p=new l:(p=l._pool.pop(),this._set.delete(p));p.acquire(r,g,c,m,q);return p};l.release=function(r){r&&!this._set.has(r)&&(r.release(),this._pool.push(r),this._set.add(r))};l.getCentroidQuantized=function(r,g){if(y.isPolygon(r.geometry)){const c=r.symbol;if(D.isNone(c))return null;
if(0<(null==c?void 0:c.layers.length)&&c.layers.some(m=>"text"===m.type||"marker"===m.type))return r=B.polygonCentroid(r.geometry),null!==r?x.quantizePoint(g,{},{x:r[0],y:r[1]},!1,!1):null}return null};var k=l.prototype;k.acquire=function(r=null,g,c,m,q){r&&this.set(r,g,c,m,q)};k.release=function(){this.geometry=this.symbolResource=this.graphic=null};k.set=function(r,g,c,m,q){this.graphic=r;this.geometry=c;this.symbolResource=g;this.bounds=m;q&&(this.size=q)};k.getGeometryQuantized=function(r,g,c,
m){var q=this.geometry;if(y.isPolygon(q)){if(q=q.rings,1===q.length&&2===q[0].length)return x.quantizeGeometry(r,{paths:[[q[0][0],q[0][1]]]})}else{if(y.isPolyline(q))return a(b),a(e),f.convertFromPolyline(b,q),f.generalizeOptimizedGeometry(e,b,q.hasZ,q.hasM,"esriGeometryPolyline",r.scale[0]),f.quantizeOptimizedGeometry(b,e,q.hasZ,q.hasM,"esriGeometryPolyline",r),f.convertToPolyline(b,q.hasZ,q.hasM);if(y.isMultipoint(q)){const p=.5*m*Math.max(Math.abs(this.size[0])+this.size[2]-this.size[0],Math.abs(this.size[1])+
this.size[3]-this.size[1]);c=n.getInfo(c);q=q.points;if(c){const [u,h]=c.valid,t=h-u;q=q.filter(v=>{if(v[0]+p>h||v[0]-p<u){const w=[...v];w[0]=v[0]+p>h?w[0]-t:w[0]+t;return C.containsPointWithMargin(g,v,p)||C.containsPointWithMargin(g,w,p)}return C.containsPointWithMargin(g,v,p)})}return 0===q.length?{points:q}:x.quantizeGeometry(r,{points:q})}}return x.quantizeGeometry(r,this.geometry)};z._createClass(l,[{key:"symbol",get:function(){return this.symbolResource.symbol}}]);return l}();d._pool=[];d._set=
new Set;return d})},"esri/views/layers/GraphicsView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(z,D,C,B,y,x,n,f,d){z.GraphicsView=a=>{a=function(b){function e(){var l=b.apply(this,arguments)||this;l.graphics=null;l.renderer=null;return l}D._inheritsLoose(e,
b);return e}(B.IdentifiableMixin(a));C.__decorate([y.property()],a.prototype,"graphics",void 0);C.__decorate([y.property()],a.prototype,"renderer",void 0);C.__decorate([y.property()],a.prototype,"updating",void 0);C.__decorate([y.property()],a.prototype,"view",void 0);return a=C.__decorate([d.subclass("esri.views.layers.GraphicsView")],a)};Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/layers/graphics/GraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"../../engine/webgl/enums","./BaseGraphicContainer"],function(z,D,C){return function(B){function y(){return B.apply(this,arguments)||this}z._inheritsLoose(y,B);var x=y.prototype;x.renderChildren=function(n){this.attributeView.bindTextures(n.context,!1);this.children.some(f=>f.hasData)&&(B.prototype.renderChildren.call(this,n),n.drawPhase===D.WGLDrawPhase.MAP&&this._renderChildren(n),this.hasHighlight()&&n.drawPhase===D.WGLDrawPhase.HIGHLIGHT&&this._renderHighlight(n),this._boundsRenderer&&this._boundsRenderer.doRender(n))};
x._renderHighlight=function(n){var {painter:f}=n;f=f.effects.highlight;f.bind(n);this._renderChildren(n,f.defines);f.draw(n);f.unbind()};return y}(C)})},"esri/views/2d/layers/graphics/BaseGraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../engine/FeatureContainer","./GraphicBoundsRenderer","../../../webgl/enums"],function(z,D,C,B){return function(y){function x(f){f=y.call(this,f)||this;f.hasHighlight=()=>!0;return f}z._inheritsLoose(x,y);var n=x.prototype;n.destroy=
function(){y.prototype.destroy.call(this);this._boundsRenderer&&(this._boundsRenderer.destroy(),this._boundsRenderer=null)};n.enableRenderingBounds=function(f){this._boundsRenderer=new C(f);this.requestRender()};n.onTileData=function(f,d){f.patch(d);this.contains(f)||this.addChild(f);this.requestRender()};n.onTileError=function(f){f.clear();this.contains(f)||this.addChild(f)};n._renderChildren=function(f,d){for(const a of this.children)a.isReady&&a.hasData&&(a.commit(f),f.context.setStencilFunction(B.CompareFunction.EQUAL,
a.stencilRef,255),a._displayList.replay(f,a,d))};z._createClass(x,[{key:"hasLabels",get:function(){return!1}}]);return x}(D.FeatureContainer)})},"esri/views/2d/engine/FeatureContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/promiseUtils ../../../core/Queue ./webgl/AttributeStoreView ./webgl/TileContainer ./webgl/WGLRendererInfo".split(" "),function(z,D,C,B,y,x,n){x=function(f){function d(b){var e=f.call(this,b)||this;e._rendererInfo=new n.WGLRendererInfo;
e._materialItemsRequestQueue=new B;e.attributeView=new y.AttributeStoreView(()=>e.onAttributeStoreUpdate());return e}D._inheritsLoose(d,f);var a=d.prototype;a.destroy=function(){this.removeAllChildren();this.children.forEach(b=>b.destroy());this.attributeView.destroy();this._materialItemsRequestQueue.clear()};a.setRendererInfo=function(b,e,l){this._rendererInfo.setInfo(b,e,l);this.requestRender()};a.getMaterialItems=function(){var b=D._asyncToGenerator(function*(e,l){if(!e||0===e.length)return null;
const k=C.createResolver();this._materialItemsRequestQueue.push({items:e,abortOptions:l,resolver:k});this.requestRender();return k.promise});return function(e,l){return b.apply(this,arguments)}}();a.doRender=function(b){b.context.capabilities.enable("textureFloat");b.context.capabilities.enable("vao");if(0<this._materialItemsRequestQueue.length){let e=this._materialItemsRequestQueue.pop();for(;e;)this._processMaterialItemRequest(b,e),e=this._materialItemsRequestQueue.pop()}f.prototype.doRender.call(this,
b)};a.renderChildren=function(b){for(const e of this.children)e.commit(b);this._rendererInfo.update(b.state);f.prototype.renderChildren.call(this,b)};a.createRenderParams=function(b){b=f.prototype.createRenderParams.call(this,b);b.rendererInfo=this._rendererInfo;b.attributeView=this.attributeView;return b};a.onAttributeStoreUpdate=function(){};a._processMaterialItemRequest=function(b,{items:e,abortOptions:l,resolver:k}){const {painter:r,pixelRatio:g}=b;b=e.map(c=>r.textureManager.rasterizeItem(c.symbol,
g,c.glyphIds,l));Promise.all(b).then(c=>{this.stage?(c=c.map((m,q)=>({id:e[q].id,mosaicItem:m})),k.resolve(c)):k.reject()},k.reject)};return d}(x);z.FeatureContainer=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ./definitions ./DisplayId ./Utils ./util/debug ../../../webgl/enums ../../../webgl/FramebufferObject ../../../webgl/Texture".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k){const r=y.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),g=b.createDebugLogger(b.DEBUG_ATTR_UPDATES,r);let c=function(){function m(p,u,h){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;const {buffer:t,pixelType:v,textureOnly:w}=p;p=a.getPixelArrayCtor(v);this.shared=h;this.pixelType=v;this.size=u;this.textureOnly=w;w||(this.data=new p(x.unwrap(t)));this._resetRange()}var q=m.prototype;q.destroy=function(){x.applySome(this._texture,
p=>p.dispose());for(const p in this._fbos)x.applySome(this._fbos[p],u=>{"0"===p&&u.detachColorTexture();u.dispose()}),this._fbos[p]=null;this._texture=null};q.setData=function(p,u,h){p=d.getDisplayIdTexel(p);const t=x.unwrap(this.data);u=p*this.texelSize+u;!t||u>=t.length||(t[u]=h,this.dirtyStart=Math.min(this.dirtyStart,p),this.dirtyEnd=Math.max(this.dirtyEnd,p))};q.getData=function(p,u){if(x.isNone(this.data))return null;p=d.getDisplayIdTexel(p)*this.texelSize+u;return!this.data||p>=this.data.length?
null:this.data[p]};q.getTexture=function(p){return x.unwrapOr(this._texture,()=>this._initTexture(p))};q.getFBO=function(p,u=0){if(x.isNone(this._fbos[u])){const h={colorTarget:e.TargetType.TEXTURE,depthStencilTarget:e.DepthStencilTargetType.NONE},t=0===u?this.getTexture(p):this._textureDesc;this._fbos[u]=new l.FramebufferObject(p,h,t)}return this._fbos[u]};q.updateTexture=function(p,u){if(!this.locked){try{const h=this.dirtyStart,t=this.dirtyEnd;if(!this.hasDirty)return;this._resetRange();const v=
x.unwrap(this.data).buffer,w=this.getTexture(p),A=(h-h%this.size)/this.size,E=(t-t%this.size)/this.size,G=A*this.size*4,F=4*(this.size+E*this.size)-G,H=a.getPixelArrayCtor(this.pixelType),J=new H(v,G*H.BYTES_PER_ELEMENT,F),I=this.size;p=E-A+1;if(p>this.size){r.error(new C("mapview-webgl","Out-of-bounds index when updating AttributeData"));return}w.updateData(0,0,A,I,p,J)}catch(h){}u()}};q.update=function(p){const {data:u,start:h,end:t}=p;if(x.isSome(u)){const v=this.data,w=h*this.texelSize;for(let A=
0;A<u.length;A++)p.layout&1<<A%this.texelSize&&(v[w+A]=u[A])}this.dirtyStart=Math.min(this.dirtyStart,h);this.dirtyEnd=Math.max(this.dirtyEnd,t)};q.resize=function(p,u){const h=this.size;this.size=u;this.textureOnly?h!==this.size&&(this._lastTexture=this._texture,this._texture=null):(u=a.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new u(x.unwrap(p.buffer)))};q._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};q._initTexture=function(p){const u=new k.Texture(p,this._textureDesc,
x.unwrapOr(this.data,void 0));if(x.isSome(this._lastTexture)&&this._fbos[0]){const v=this._lastTexture.descriptor.width,w=this._lastTexture.descriptor.height,A=this._lastTexture.descriptor.dataType,E=this._lastTexture.descriptor.pixelFormat,G=this.getFBO(p);var h=a.getPixelBytes(A),t=a.getPixelArrayCtor(A);h=new ArrayBuffer(v*w*h*this.texelSize);t=new t(h);h=p.getBoundFramebufferObject();const {x:F,y:H,width:J,height:I}=p.getViewport();p.bindFramebuffer(G);G.readPixels(0,0,v,w,E,A,t);u.updateData(0,
0,0,2*v,w/2,t);p.setViewport(F,H,J,I);p.bindFramebuffer(h)}this.destroy();return this._texture=u};D._createClass(m,[{key:"_textureDesc",get:function(){return{target:e.TextureType.TEXTURE_2D,wrapMode:e.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:e.PixelFormat.RGBA,dataType:this.pixelType,samplingMode:e.TextureSamplingMode.NEAREST,width:this.size,height:this.size}}},{key:"locked",get:function(){return this.pixelType===e.PixelType.UNSIGNED_BYTE&&this.shared&&!this.textureOnly&&B("esri-atomics")&&this.data?
1===Atomics.load(this.data,0):!1}},{key:"hasDirty",get:function(){return this.dirtyEnd>=this.dirtyStart}}]);return m}();y=function(){function m(p){this._onUpdate=p;this._locked=this._forceNextUpload=this._initialized=!1}var q=m.prototype;q.initialize=function(p){const {blocks:u,shared:h,size:t}=p;this.shared=h;this.size=t;g("Initializing AttributeStoreView",p);if(x.isNone(this._data))this._data=x.mapMany(u,v=>new c(v,t,h));else for(p=0;p<this._data.length;p++){const v=this._data[p],w=u[p];x.isSome(w)&&
(x.isNone(v)?this._data[p]=new c(w,t,h):v.resize(w,t))}this._initialized=!0};q.destroy=function(){x.applySome(this._data,p=>x.mapMany(p,u=>u.destroy()));x.applySome(this._defaultTexture,p=>p.dispose())};q.isEmpty=function(){return x.isNone(this._data)};q.isUpdating=function(){const p=x.isSome(this._pendingAttributeUpdate);B("esri-2d-log-updating")&&console.log(`Updating AttributeStoreView ${p}\n  -> hasPendingUpdate ${p}`);return p};q.getBlock=function(p){return x.isNone(this._data)?null:this._data[p]};
q.setLabelMinZoom=function(p,u){this.setData(p,0,1,u)};q.getLabelMinZoom=function(p){return this.getData(p,0,1,255)};q.getFilterFlags=function(p){return this.getData(p,0,0,0)};q.getVVSize=function(p){return this.getData(p,f.ATTRIBUTE_DATA_VV,0,0)};q.getData=function(p,u,h,t){if(!this._data)return 0;u=x.unwrap(this._data)[u];if(x.isNone(u))return 0;p=u.getData(p,h);return x.isSome(p)?p:t};q.setData=function(p,u,h,t){u=x.unwrap(this._data)[u];x.unwrap(u).setData(p,h,t)};q.lockTextureUpload=function(){this._locked=
!0};q.unlockTextureUpload=function(){this._locked=!1};q.forceTextureUpload=function(){this._forceNextUpload=!0};q.requestUpdate=function(){var p=D._asyncToGenerator(function*(u){if(this._pendingAttributeUpdate)r.error(new C("mapview-webgl","Tried to update attribute data with a pending update"));else{var h=n.createResolver();g("AttributeStoreView Update Requested",u);this._pendingAttributeUpdate={data:u,resolver:h};return h.promise}});return function(u){return p.apply(this,arguments)}}();q.update=
function(){if(this._initialized&&x.isSome(this._pendingAttributeUpdate)){B("esri-2d-update-debug")&&console.debug("AttributeStoreView::update");const {data:p,resolver:u}=this._pendingAttributeUpdate,h=x.unwrap(this._data);for(let t=0;t<p.blocks.length;t++){const v=p.blocks[t];x.applySome(h[t],w=>x.applySome(v,A=>{g(`Updating block ${t}`,A);w.update(A)}))}this._pendingAttributeUpdate=null;u();this._onUpdate()}};q.bindTextures=function(p,u=!0){this.update();const h=this._getDefaultTexture(p);if(this._initialized){var t=
x.unwrap(this._data);if(!this._locked||this._forceNextUpload)x.forEachSome(t,v=>v.updateTexture(p,()=>this._onUpdate())),this._forceNextUpload=!1;p.bindTexture(x.mapOr(t[f.ATTRIBUTE_DATA_FILTER_FLAGS],h,v=>v.getTexture(p)),f.TEXTURE_BINDING_ATTRIBUTE_DATA_0);u&&(p.bindTexture(x.mapOr(t[f.ATTRIBUTE_DATA_GPGPU],h,v=>v.getTexture(p)),f.TEXTURE_BINDING_GPGPU),p.bindTexture(x.mapOr(t[f.ATTRIBUTE_DATA_ANIMATION],h,v=>v.getTexture(p)),f.TEXTURE_BINDING_ATTRIBUTE_DATA_1),p.bindTexture(x.mapOr(t[f.ATTRIBUTE_DATA_VV],
h,v=>v.getTexture(p)),f.TEXTURE_BINDING_ATTRIBUTE_DATA_2),p.bindTexture(x.mapOr(t[f.ATTRIBUTE_DATA_DD1],h,v=>v.getTexture(p)),f.TEXTURE_BINDING_ATTRIBUTE_DATA_3),p.bindTexture(x.mapOr(t[f.TEXTURE_BINDING_ATTRIBUTE_DATA_4],h,v=>v.getTexture(p)),f.TEXTURE_BINDING_ATTRIBUTE_DATA_4),p.bindTexture(x.mapOr(t[f.TEXTURE_BINDING_ATTRIBUTE_DATA_5],h,v=>v.getTexture(p)),f.TEXTURE_BINDING_ATTRIBUTE_DATA_5))}else p.bindTexture(h,f.TEXTURE_BINDING_ATTRIBUTE_DATA_0),u&&(p.bindTexture(h,f.TEXTURE_BINDING_ATTRIBUTE_DATA_1),
p.bindTexture(h,f.TEXTURE_BINDING_ATTRIBUTE_DATA_2),p.bindTexture(h,f.TEXTURE_BINDING_ATTRIBUTE_DATA_3),p.bindTexture(h,f.TEXTURE_BINDING_ATTRIBUTE_DATA_4),p.bindTexture(h,f.TEXTURE_BINDING_ATTRIBUTE_DATA_5),p.bindTexture(h,f.TEXTURE_BINDING_GPGPU))};q._getDefaultTexture=function(p){x.isNone(this._defaultTexture)&&(this._defaultTexture=new k.Texture(p,{wrapMode:e.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:e.PixelFormat.RGBA,dataType:e.PixelType.UNSIGNED_BYTE,samplingMode:e.TextureSamplingMode.NEAREST,
width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return m}();z.AttributeStoreView=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/webgl/TileContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(z,D,C,B,y,x){const n=(f,d)=>0!==f.key.level-d.key.level?f.key.level-d.key.level:0!==f.key.row-
d.key.row?f.key.row-d.key.row:f.key.col-d.key.col;return function(f){function d(b){var e=f.call(this)||this;e._tileInfoView=b;return e}z._inheritsLoose(d,f);var a=d.prototype;a.renderChildren=function(b){this.sortChildren(n);this.setStencilReference(b);f.prototype.renderChildren.call(this,b)};a.createRenderParams=function(b){const {state:e}=b;b=f.prototype.createRenderParams.call(this,b);b.requiredLevel=this._tileInfoView.getClosestInfoForScale(e.scale).level;b.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(e.scale);
return b};a.prepareRenderPasses=function(b){const e=f.prototype.prepareRenderPasses.call(this,b);e.push(b.registerRenderPass({name:"stencil",brushes:[x],drawPhase:C.WGLDrawPhase.DEBUG|C.WGLDrawPhase.MAP|C.WGLDrawPhase.HIGHLIGHT,target:()=>this.getStencilTarget()}));D("esri-tiles-debug")&&e.push(b.registerRenderPass({name:"tileInfo",brushes:[y],drawPhase:C.WGLDrawPhase.DEBUG,target:()=>this.children}));return e};a.getStencilTarget=function(){return this.children};a.updateTransforms=function(b){for(const e of this.children){const l=
this._tileInfoView.getTileResolution(e.key);e.setTransform(b,l)}};a.setStencilReference=function(b){b=1;for(const e of this.children)e.stencilRef=b++};z._createClass(d,[{key:"requiresDedicatedFBO",get:function(){return!1}}]);return d}(B)})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../chunks/mat3f32 ../brushes ../Container ./ClippingInfo ./enums".split(" "),function(z,D,C,B,y,x,n,f){return function(d){function a(){var e=
d.apply(this,arguments)||this;e.name=e.constructor.name;return e}z._inheritsLoose(a,d);var b=a.prototype;b._createTransforms=function(){return{dvs:B.create()}};b.doRender=function(e){const l=this.createRenderParams(e),{painter:k,globalOpacity:r,profiler:g,drawPhase:c}=l,m=c===f.WGLDrawPhase.LABEL||c===f.WGLDrawPhase.HIGHLIGHT?1:r*this.computedOpacity;g.recordContainerStart(this.name);k.beforeRenderLayer(l,this._clippingInfos?255:0,m);this.updateTransforms(e.state);this.renderChildren(l);k.compositeLayer(l,
m);g.recordContainerEnd()};b.renderChildren=function(e){C.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(e.painter));for(const l of this.children)l.beforeRender(e);for(const l of this._renderPasses)try{l.render(e)}catch(k){}for(const l of this.children)l.afterRender(e)};b.createRenderParams=function(e){e.requireFBO=this.requiresDedicatedFBO;return e};b.prepareRenderPasses=function(e){return[e.registerRenderPass({name:"clip",brushes:[y.brushes.clip],target:()=>this._clippingInfos,
drawPhase:f.WGLDrawPhase.MAP|f.WGLDrawPhase.LABEL|f.WGLDrawPhase.LABEL_ALPHA|f.WGLDrawPhase.DEBUG|f.WGLDrawPhase.HIGHLIGHT})]};b.updateTransforms=function(e){for(const l of this.children)l.setTransform(e)};b.onAttach=function(){d.prototype.onAttach.call(this);this._updateClippingInfo()};b.onDetach=function(){d.prototype.onDetach.call(this);this._updateClippingInfo()};b._updateClippingInfo=function(){C.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(l=>l.destroy()),this._clippingInfos=null);
if(this.stage){var e=this._clips;C.isSome(e)&&e.length&&(this._clippingInfos=e.items.map(l=>n.fromClipArea(this.stage,l)));this.requestRender()}};z._createClass(a,[{key:"clips",set:function(e){this._clips=e;this.children.forEach(l=>l.clips=e);this._updateClippingInfo()}}]);return a}(x.Container)})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/reactiveUtils ../../../../chunks/mat3f32 ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),
function(z,D,C,B,y,x,n,f,d){const a=C.getLogger("esri.views.2d.engine.webgl.ClippingInfo");return function(b){function e(k,r){var g=b.call(this)||this;g._clip=r;g._cache={};g.stage=k;g._handle=y.watch(()=>r.version,()=>g._invalidate());g.ready();return g}z._inheritsLoose(e,b);e.fromClipArea=function(k,r){return new e(k,r)};var l=e.prototype;l._destroyGL=function(){B.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);B.isSome(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=
null)};l.destroy=function(){this._destroyGL();this._handle.remove()};l.getVAO=function(k,r,g,c){const [m,q]=r.size;if("geometry"===this._clip.type||this._lastWidth!==m||this._lastHeight!==q)this._lastWidth=m,this._lastHeight=q,this._destroyGL();if(B.isNone(this._cache.vao)){r=this._createMesh(r,this._clip);const p=r.getIndexBuffer(k),u=r.getVertexBuffers(k);this._cache.mesh=r;this._cache.vao=new d.VertexArrayObject(k,g,c,u,p)}return this._cache.vao};l._createTransforms=function(){return{dvs:x.create()}};
l._invalidate=function(){this._destroyGL();this.requestRender()};l._createScreenRect=function(k,r){const [g,c]=k.size;k="string"===typeof r.left?parseFloat(r.left)/100*g:r.left;const m="string"===typeof r.right?parseFloat(r.right)/100*g:r.right,q="string"===typeof r.top?parseFloat(r.top)/100*c:r.top;r="string"===typeof r.bottom?parseFloat(r.bottom)/100*c:r.bottom;return{x:k,y:q,width:Math.max(g-m-k,0),height:Math.max(c-r-q,0)}};l._createMesh=function(k,r){switch(r.type){case "rect":return f.fromRect(this._createScreenRect(k,
r));case "path":return f.fromPath(r);case "geometry":return f.fromGeometry(k,r);default:return a.error(new D("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),f.fromRect({x:0,y:0,width:1,height:1})}};return e}(n.DisplayObject)})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../chunks/earcut ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject ../../../webgl/enums".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e){const l=C.getLogger("esri.views.2d.engine.webgl.Mesh2D"),k=({coords:r,lengths:g},c)=>{const m=[];for(let u=0,h=0;u<g.length;h+=g[u],u+=1){const t=h;for(var q=[];u<g.length-1;u+=1,h+=g[u]){{var p=h+g[u];let v=0;for(let w=1;w<g[u+1];w++)v+=(r[2*(p+w)]-r[2*(p+w-1)])*(r[2*(p+w)+1]+r[2*(p+w-1)+1]);p=c?0<v:0>v}if(!p)break;q.push(h+g[u]-t)}p=r.slice(2*t,2*(h+g[u]));q=y.earcut(p,q,2);for(const v of q)m.push(v+t)}return m};return function(){function r(c,m,q,p=!1){this._cache=
{};this.vertices=c;this.indices=m;this.primitiveType=q;this.isMapSpace=p}r.fromRect=function({x:c,y:m,width:q,height:p}){return r.fromScreenExtent({xmin:c,ymin:m,xmax:c+q,ymax:m+p})};r.fromPath=function(c){var m=f.convertFromNestedArray(new d,c.path,!1,!1);c=m.coords;m=new Uint32Array(k(m,!0));const q=new Uint32Array(c.length/2);for(let p=0;p<q.length;p++)q[p]=a.i1616to32(Math.floor(c[2*p]),Math.floor(c[2*p+1]));return new r({geometry:q},m,e.PrimitiveType.TRIANGLES)};r.fromGeometry=function(c,m){const q=
m.geometry.type;switch(q){case "polygon":return r.fromPolygon(c,m.geometry);case "extent":return r.fromMapExtent(c,m.geometry);default:return l.error(new D("mapview-bad-type",`Unable to create a mesh from type ${q}`,m)),r.fromRect({x:0,y:0,width:1,height:1})}};r.fromPolygon=function(c,m){var q=f.convertFromPolygon(new d,m,!1,!1);m=q.coords;q=new Uint32Array(k(q,!1));const p=new Uint32Array(m.length/2),u=n.create(),h=n.create();for(let t=0;t<p.length;t++)x.set(u,m[2*t],m[2*t+1]),c.toScreen(h,u),p[t]=
a.i1616to32(Math.floor(h[0]),Math.floor(h[1]));return new r({geometry:p},q,e.PrimitiveType.TRIANGLES,!0)};r.fromScreenExtent=function({xmin:c,xmax:m,ymin:q,ymax:p}){c={geometry:new Uint32Array([a.i1616to32(c,q),a.i1616to32(m,q),a.i1616to32(c,p),a.i1616to32(c,p),a.i1616to32(m,q),a.i1616to32(m,p)])};m=new Uint32Array([0,1,2,3,4,5]);return new r(c,m,e.PrimitiveType.TRIANGLES)};r.fromMapExtent=function(c,m){const [q,p]=c.toScreen([0,0],[m.xmin,m.ymin]),[u,h]=c.toScreen([0,0],[m.xmax,m.ymax]);c={geometry:new Uint32Array([a.i1616to32(q,
p),a.i1616to32(u,p),a.i1616to32(q,h),a.i1616to32(q,h),a.i1616to32(u,p),a.i1616to32(u,h)])};m=new Uint32Array([0,1,2,3,4,5]);return new r(c,m,e.PrimitiveType.TRIANGLES)};var g=r.prototype;g.destroy=function(){B.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const c in this._cache.vertexBuffers)B.isSome(this._cache.vertexBuffers[c])&&this._cache.vertexBuffers[c].dispose()};g.getIndexBuffer=function(c,m=e.Usage.STATIC_DRAW){this._cache.indexBuffer||(this._cache.indexBuffer=b.BufferObject.createIndex(c,
m,this.indices));return this._cache.indexBuffer};g.getVertexBuffers=function(c,m=e.Usage.STATIC_DRAW){this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((q,p)=>({...q,[p]:b.BufferObject.createVertex(c,m,this.vertices[p])}),{}));return this._cache.vertexBuffers};z._createClass(r,[{key:"elementType",get:function(){a:switch(this.indices.BYTES_PER_ELEMENT){case 1:var c=e.DataType.UNSIGNED_BYTE;break a;case 2:c=e.DataType.UNSIGNED_SHORT;break a;case 4:c=e.DataType.UNSIGNED_INT;
break a;default:throw new D("Cannot get DataType of array");}return c}}]);return r}()})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../renderers/support/lengthUtils ./Utils ./techniques/Technique ./techniques/utils ../../../webgl/capabilities".split(" "),function(z,D,C,B,y,x,n,f,d,a){function b(l,k){const r=k.length;if(l<k[0].value||1===
r)return k[0].size;for(let g=1;g<r;g++)if(l<k[g].value)return k[g-1].size+(l-k[g-1].value)/(k[g].value-k[g-1].value)*(k[g].size-k[g-1].size);return k[r-1].size}let e=function(){function l(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",
vvOpacityEnabled:!1};this._technique=f.Technique}var k=l.prototype;k.getSizeVVFieldStops=function(r){const g=this._vvSizeFieldStops;switch(g.type){case "static":return g;case "level-dependent":return C.unwrapOr(g.levels[r],()=>{var c=Infinity,m=0;for(var q in g.levels){const p=parseFloat(q),u=Math.abs(r-p);u<c&&(c=u,m=p)}if(Infinity===c)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};c=2**((r-m)/2);m=C.unwrap(g.levels[m]);q=new Float32Array(m.values);q[2]*=c;q[3]*=
c;return{sizes:C.unwrap(m.sizes),values:q}})}};k.update=function(r){C.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,r)};k.setInfo=function(r,g,c){this._updateEffects(c);this._vvInfo=g;this._technique=d.getTechniqueFromRenderer(r);this.rendererSchema=this._technique.createOrUpdateRendererSchema(this.rendererSchema,r)};k.getVariation=function(){return{...this._technique.getVariation(this.rendererSchema),outsideLabelsVisible:this.outsideLabelsVisible,supportsTextureFloat:a.getWebGLCapabilities("2d").supportsTextureFloat}};
k.getVariationHash=function(){return this._technique.getVariationHash(this.rendererSchema)<<1|(this.outsideLabelsVisible?1:0)};k._updateEffects=function(r){C.isSome(r)?this.outsideLabelsVisible=r.excludedLabelsVisible:this.outsideLabelsVisible=!1};k._updateVisualVariables=function(r,g){const c=this._vvMaterialParameters;c.vvOpacityEnabled=!1;c.vvSizeEnabled=!1;c.vvColorEnabled=!1;c.vvRotationEnabled=!1;if(r){var m=r.size;if(m){c.vvSizeEnabled=!0;if(m.minMaxValue){const p=m.minMaxValue;let u;if(n.isDefined(p.minSize)&&
n.isDefined(p.maxSize))if(n.isNumber(p.minSize)&&n.isNumber(p.maxSize)){u=B.pt2px(p.minSize);var q=B.pt2px(p.maxSize)}else q=g.scale,u=B.pt2px(b(q,p.minSize.stops)),q=B.pt2px(b(q,p.maxSize.stops));this.vvSizeMinMaxValue.set([p.minDataValue,p.maxDataValue,u,q])}m.scaleStops&&(this.vvSizeScaleStopsValue=B.pt2px(b(g.scale,m.scaleStops.stops)));m.unitValue&&(this.vvSizeUnitValueToPixelsRatio=y.getMetersPerUnitForSR(g.spatialReference)/x.meterIn[m.unitValue.unit]/g.resolution);m.fieldStops&&(this._vvSizeFieldStops=
m.fieldStops)}if(g=r.color)c.vvColorEnabled=!0,this.vvColorValues.set(g.values),this.vvColors.set(g.colors);if(g=r.opacity)c.vvOpacityEnabled=!0,this.vvOpacityValues.set(g.values),this.vvOpacities.set(g.opacities);if(r=r.rotation)c.vvRotationEnabled=!0,c.vvRotationType=r.type}};D._createClass(l,[{key:"vvMaterialParameters",get:function(){return this._vvMaterialParameters}}]);return l}();z.WGLRendererInfo=e;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/2d/layers/graphics/GraphicBoundsRenderer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f32 ../../../../chunks/vec3f32 ../../../../geometry/support/normalizeUtils ../../engine/DisplayObject ../../engine/webgl/Utils ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/VertexArrayObject".split(" "),function(z,D,C,B,y,x,n,f,d,a,b){const e=Math.PI/180,l=()=>f.createProgramDescriptor("bounds",
{geometry:[{location:0,name:"a_position",count:2,type:a.DataType.FLOAT}]});return function(k){function r(c){var m=k.call(this)||this;m._dvsMat3=C.create();m._localOrigin={x:0,y:0};m._getBounds=c;return m}z._inheritsLoose(r,k);var g=r.prototype;g.destroy=function(){this._vao&&(this._vao.dispose(!0),this._indexBuffer=this._vertexBuffer=this._vao=null);this._program&&(this._program.dispose(),this._program=null)};g.doRender=function(c){const {context:m}=c,q=this._getBounds();1>q.length||(this._createShaderProgram(m),
this._updateMatricesAndLocalOrigin(c),this._updateBufferData(m,q),m.setBlendingEnabled(!0),m.setDepthTestEnabled(!1),m.setStencilWriteMask(0),m.setStencilTestEnabled(!1),m.setBlendFunction(a.BlendFactor.ONE,a.BlendFactor.ONE_MINUS_SRC_ALPHA),m.setColorMask(!0,!0,!0,!0),c=this._program,m.bindVAO(this._vao),m.useProgram(c),c.setUniformMatrix3fv("u_dvsMat3",this._dvsMat3),m.gl.lineWidth(1),m.drawElements(a.PrimitiveType.LINES,8*q.length,a.DataType.UNSIGNED_INT,0),m.bindVAO())};g._createTransforms=function(){return{dvs:C.create()}};
g._createShaderProgram=function(c){this._program||(this._program=c.programCache.acquire("precision highp float;\n        uniform mat3 u_dvsMat3;\n\n        attribute vec2 a_position;\n\n        void main() {\n          mediump vec3 pos \x3d u_dvsMat3 * vec3(a_position, 1.0);\n          gl_Position \x3d vec4(pos.xy, 0.0, 1.0);\n        }","precision mediump float;\n      void main() {\n        gl_FragColor \x3d vec4(0.75, 0.0, 0.0, 0.75);\n      }",l().attributes))};g._updateMatricesAndLocalOrigin=
function(c){var {state:m}=c;const {displayMat3:q,size:p,resolution:u,pixelRatio:h,rotation:t,viewpoint:v}=m;c=e*t;const {x:w,y:A}=v.targetGeometry;m=x.normalizeMapX(w,m.spatialReference);this._localOrigin.x=m;this._localOrigin.y=A;m=h*p[0];const E=h*p[1],G=u*m,F=u*E,H=D.identity(this._dvsMat3);D.multiply(H,H,q);D.translate(H,H,B.fromValues(m/2,E/2));D.scale(H,H,y.fromValues(p[0]/G,-E/F,1));D.rotate(H,H,-c)};g._updateBufferData=function(c,m){const {x:q,y:p}=this._localOrigin,u=new Float32Array(8*m.length),
h=new Uint32Array(8*m.length);let t=0,v=0;for(const w of m)w&&(u[2*t]=w[0]-q,u[2*t+1]=w[1]-p,u[2*t+2]=w[0]-q,u[2*t+3]=w[3]-p,u[2*t+4]=w[2]-q,u[2*t+5]=w[3]-p,u[2*t+6]=w[2]-q,u[2*t+7]=w[1]-p,h[v+0]=t+0,h[v+1]=t+3,h[v+2]=t+3,h[v+3]=t+2,h[v+4]=t+2,h[v+5]=t+1,h[v+6]=t+1,h[v+7]=t+0,t+=4,v+=8);this._vertexBuffer?this._vertexBuffer.setData(u.buffer):this._vertexBuffer=d.BufferObject.createVertex(c,a.Usage.DYNAMIC_DRAW,u.buffer);this._indexBuffer?this._indexBuffer.setData(h):this._indexBuffer=d.BufferObject.createIndex(c,
a.Usage.DYNAMIC_DRAW,h);this._vao||(m=l(),this._vao=new b.VertexArrayObject(c,m.attributes,m.bufferLayouts,{geometry:this._vertexBuffer},this._indexBuffer))};return r}(n.DisplayObject)})},"esri/chunks/vec3f32":function(){define(["exports"],function(z){function D(){return new Float32Array(3)}function C(c){const m=new Float32Array(3);m[0]=c[0];m[1]=c[1];m[2]=c[2];return m}function B(c,m,q){const p=new Float32Array(3);p[0]=c;p[1]=m;p[2]=q;return p}function y(c,m){return new Float32Array(c,m,3)}function x(){return D()}
function n(){return B(1,1,1)}function f(){return B(1,0,0)}function d(){return B(0,1,0)}function a(){return B(0,0,1)}const b=D(),e=n(),l=f(),k=d(),r=a(),g=Object.freeze(Object.defineProperty({__proto__:null,create:D,clone:C,fromValues:B,createView:y,zeros:x,ones:n,unitX:f,unitY:d,unitZ:a,ZEROS:b,ONES:e,UNIT_X:l,UNIT_Y:k,UNIT_Z:r},Symbol.toStringTag,{value:"Module"}));z.ONES=e;z.UNIT_X=l;z.UNIT_Y=k;z.UNIT_Z=r;z.ZEROS=b;z.clone=C;z.create=D;z.createView=y;z.fromValues=B;z.ones=n;z.unitX=f;z.unitY=d;
z.unitZ=a;z.vec3f32=g;z.zeros=x})},"esri/views/2d/navigation/MapViewNavigation":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Viewpoint ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../geometry/Point ../viewpointUtils ./ZoomBox ./actions/Pan ./actions/Pinch ./actions/Rotate".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r){const g=new C({targetGeometry:new a}),c=[0,0];C=function(m){function q(u){u=m.call(this,u)||this;u._endTimer=null;u.animationManager=null;return u}z._inheritsLoose(q,m);var p=q.prototype;p.initialize=function(){this.pan=new l({navigation:this});this.rotate=new r({navigation:this});this.pinch=new k({navigation:this});this.zoomBox=new e({view:this.view,navigation:this})};p.destroy=function(){this.pan.destroy();this.rotate.destroy();this.pinch.destroy();this.zoomBox.destroy();
this.pan=this.rotate=this.pinch=this.zoomBox=this.animationManager=null};p.begin=function(){this._set("interacting",!0)};p.end=function(){this._lastEventTimestamp=performance.now();this._startTimer(250)};p.zoom=function(){var u=z._asyncToGenerator(function*(h,t=this._getDefaultAnchor()){this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>h?this.zoomIn(t):this.zoomOut(t);this.setViewpoint(t,h,0,[0,0])});return function(h){return u.apply(this,arguments)}}();
p.zoomIn=function(){var u=z._asyncToGenerator(function*(h){var t=this.view;t=t.constraints.snapToNextScale(t.scale);return this._zoomToScale(t,h)});return function(h){return u.apply(this,arguments)}}();p.zoomOut=function(){var u=z._asyncToGenerator(function*(h){var t=this.view;t=t.constraints.snapToPreviousScale(t.scale);return this._zoomToScale(t,h)});return function(h){return u.apply(this,arguments)}}();p.setViewpoint=function(u,h,t,v){this.begin();this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,
u,h,t,v);this.end()};p.setViewpointImmediate=function(u,h=0,t=[0,0],v=this._getDefaultAnchor()){this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,v,u,h,t)};p.continousRotateClockwise=function(){const u=this.get("view.viewpoint");this.animationManager.animateContinous(u,h=>{b.rotateBy(h,h,-1)})};p.continousRotateCounterclockwise=function(){const u=this.get("view.viewpoint");this.animationManager.animateContinous(u,h=>{b.rotateBy(h,h,1)})};p.resetRotation=function(){this.view.rotation=
0};p.continousPanLeft=function(){this._continuousPan([-10,0])};p.continousPanRight=function(){this._continuousPan([10,0])};p.continousPanUp=function(){this._continuousPan([0,10])};p.continousPanDown=function(){this._continuousPan([0,-10])};p.stop=function(){this.pan.stopMomentumNavigation();this.animationManager.stop();this.end();null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null,this._set("interacting",!1))};p._continuousPan=function(u){this.animationManager.animateContinous(this.view.viewpoint,
h=>{b.translateBy(h,h,u);this.view.constraints.constrainByGeometry(h)})};p._startTimer=function(u){return null!==this._endTimer?this._endTimer:this._endTimer=setTimeout(()=>{this._endTimer=null;const h=performance.now()-this._lastEventTimestamp;250>h?this._endTimer=this._startTimer(h):this._set("interacting",!1)},u)};p._getDefaultAnchor=function(){const {size:u,padding:{left:h,right:t,top:v,bottom:w}}=this.view;c[0]=.5*(u[0]-t+h);c[1]=.5*(u[1]-w+v);return c};p._zoomToScale=function(){var u=z._asyncToGenerator(function*(h,
t=this._getDefaultAnchor()){const {view:v}=this,{constraints:w,scale:A,viewpoint:E,size:G,padding:F}=v,H=w.canZoomInTo(h),J=w.canZoomOutTo(h);if(!(h<A&&!H||h>A&&!J))return b.padAndScaleAndRotateBy(g,E,h/A,0,t,G,F),w.constrainByGeometry(g),v.goTo(g,{animate:!0})});return function(h){return u.apply(this,arguments)}}();p._scaleRotateTranslateViewpoint=function(u,h,t,v,w){var {view:A}=this;const {size:E,padding:G,constraints:F,scale:H,viewpoint:J}=A;var I=H*t;A=F.canZoomInTo(I);I=F.canZoomOutTo(I);if(1>
t&&!A||1<t&&!I)t=1;b.translateBy(J,J,w);b.padAndScaleAndRotateBy(u,J,t,v,h,E,G);return F.constrainByGeometry(u)};return q}(B);D.__decorate([y.property()],C.prototype,"animationManager",void 0);D.__decorate([y.property({type:Boolean,readOnly:!0})],C.prototype,"interacting",void 0);D.__decorate([y.property()],C.prototype,"pan",void 0);D.__decorate([y.property()],C.prototype,"pinch",void 0);D.__decorate([y.property()],C.prototype,"rotate",void 0);D.__decorate([y.property()],C.prototype,"view",void 0);
D.__decorate([y.property()],C.prototype,"zoomBox",void 0);return C=D.__decorate([d.subclass("esri.views.2d.navigation.MapViewNavigation")],C)})},"esri/views/2d/navigation/ZoomBox":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../input/InputManager".split(" "),
function(z,D,C,B,y,x,n,f,d,a){C=function(b){function e(k){k=b.call(this,k)||this;k._container=null;k._overlay=null;k._backgroundShape=null;k._boxShape=null;k._box={x:0,y:0,width:0,height:0};k._redraw=k._redraw.bind(z._assertThisInitialized(k));return k}z._inheritsLoose(e,b);var l=e.prototype;l.destroy=function(){this.view=null};l._start=function(){this._createContainer();this._createOverlay();this.navigation.begin()};l._update=function(k,r,g,c){this._box.x=k;this._box.y=r;this._box.width=g;this._box.height=
c;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};l._end=function(k,r,g,c,m){const q=this.view;k=q.toMap(B.createScreenPoint(k+.5*g,r+.5*c));g=Math.max(g/q.width,c/q.height);-1===m&&(g=1/g);this._destroyOverlay();this.navigation.end();q.goTo({center:k,scale:q.scale*g})};l._updateBox=function(k,r,g,c){const m=this._boxShape;m.setAttributeNS(null,"x",""+k);m.setAttributeNS(null,"y",""+r);m.setAttributeNS(null,"width",""+g);m.setAttributeNS(null,"height",""+c);m.setAttributeNS(null,"class",
"esri-zoom-box__outline")};l._updateBackground=function(k,r,g,c){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(k,r,g,c,this.view.width,this.view.height))};l._createContainer=function(){const k=document.createElement("div");k.className="esri-zoom-box__container";this.view.root.appendChild(k);this._container=k};l._createOverlay=function(){var k=this.view.width,r=this.view.height;const g=document.createElementNS("http://www.w3.org/2000/svg","path");g.setAttributeNS(null,"d","M 0 0 L "+
k+" 0 L "+k+" "+r+" L 0 "+r+" Z");g.setAttributeNS(null,"class","esri-zoom-box__overlay-background");k=document.createElementNS("http://www.w3.org/2000/svg","rect");r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");r.setAttributeNS(null,"class","esri-zoom-box__overlay");r.appendChild(g);r.appendChild(k);this._container.appendChild(r);this._backgroundShape=g;this._boxShape=k;this._overlay=r};
l._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null};l._toSVGPath=function(k,r,g,c,m,q){g=k+g;c=r+c;return"M 0 0 L "+m+" 0 L "+m+" "+q+" L 0 "+q+" ZM "+k+" "+r+" L "+k+" "+c+" L "+g+" "+c+" L "+g+" "+r+" Z"};l._handleDrag=function(k,r){var g=k.x,c=k.y,m=k.origin.x;const q=k.origin.y;let p;g>m?(p=m,m=g-m):(p=g,m-=g);c>q?(g=q,c-=q):(g=c,c=q-c);switch(k.action){case "start":this._start();
break;case "update":this._update(p,g,m,c);break;case "end":this._end(p,g,m,c,r)}k.stopPropagation()};l._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var {x:k,y:r,width:g,height:c}=this._box;this._updateBox(k,r,g,c);this._updateBackground(k,r,g,c);this._rafId=requestAnimationFrame(this._redraw)}};z._createClass(e,[{key:"view",set:function(k){this._handles&&this._handles.forEach(r=>{r.remove()});this._handles=null;this._destroyOverlay();this._set("view",k);k&&(k.on("drag",["Shift"],
r=>this._handleDrag(r,1),a.ViewEventPriorities.INTERNAL),k.on("drag",["Shift","Ctrl"],r=>this._handleDrag(r,-1),a.ViewEventPriorities.INTERNAL))}}]);return e}(C);D.__decorate([y.property()],C.prototype,"navigation",void 0);D.__decorate([y.property()],C.prototype,"view",null);return C=D.__decorate([d.subclass("esri.views.2d.navigation.ZoomBox")],C)})},"esri/views/2d/navigation/actions/Pan":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/reactiveUtils ../../../../core/screenUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../viewpointUtils ../../../navigation/PanPlanarMomentumEstimator ../../../../geometry/Point".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g,c){C=function(m){function q(u){var h=m.call(this,u)||this;h.animationTime=0;h.momentumEstimator=new g.PanPlanarMomentumEstimator(500,6,.92);h.momentum=null;h.tmpMomentum=k.create();h.momentumFinished=!1;h.viewpoint=new B({targetGeometry:new c,scale:0,rotation:0});x.when(()=>h.momentumFinished,()=>h.navigation.stop());return h}z._inheritsLoose(q,m);var p=q.prototype;p.begin=function(u,h){this.navigation.begin();this.momentumEstimator.reset();this.addToEstimator(h);
this.previousDrag=h};p.update=function(u,h){this.addToEstimator(h);let t=h.center.x,v=h.center.y;const w=this.previousDrag;t=w?w.center.x-t:-t;v=w?v-w.center.y:v;u.viewpoint=r.translateBy(this.viewpoint,u.viewpoint,[t||0,v||0]);this.previousDrag=h};p.end=function(u,h){this.addToEstimator(h);this.momentum=u.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null;this.animationTime=0;if(this.momentum)this.onAnimationUpdate(u);this.previousDrag=null;this.navigation.end()};p.addToEstimator=
function(u){var h=u.center.x;const t=u.center.y,v=n.createScreenPointArray(-h,t);h=k.fromValues(-h,t,0);this.momentumEstimator.add(v,h,.001*u.timestamp)};p.onAnimationUpdate=function(u){this.navigation.animationManager.animateContinous(u.viewpoint,(h,t)=>{this.momentumFinished=!this.momentum||this.momentum.isFinished(this.animationTime);t*=.001;if(!this.momentumFinished){const v=this.momentum.valueDelta(this.animationTime,t);l.scale(this.tmpMomentum,this.momentum.direction,v);r.translateBy(h,h,this.tmpMomentum);
u.constraints.constrainByGeometry(h)}this.animationTime+=t})};p.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())};return q}(y);D.__decorate([f.property()],C.prototype,"momentumFinished",void 0);D.__decorate([f.property()],C.prototype,"viewpoint",void 0);D.__decorate([f.property()],C.prototype,"navigation",void 0);return C=D.__decorate([e.subclass("esri.views.2d.navigation.actions.Pan")],C)})},"esri/views/navigation/PanPlanarMomentumEstimator":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/vec3 ../../chunks/vec3f64 ./FilteredFiniteDifference ./Momentum".split(" "),
function(z,D,C,B,y,x){let n=function(f){function d(a,b,e,l,k){a=f.call(this,a,b,e)||this;a.sceneVelocity=l;a.direction=k;return a}D._inheritsLoose(d,f);d.prototype.value=function(a){return f.prototype.valueFromInitialVelocity.call(this,this.sceneVelocity,a)};return d}(x.Momentum);x=function(){function f(a=300,b=12,e=.84){this.minimumInitialVelocity=a;this.stopVelocity=b;this.friction=e;this.enabled=!0;this.time=new y.FilteredFiniteDifference(.6);this.screen=[new y.FilteredFiniteDifference(.4),new y.FilteredFiniteDifference(.4)];
this.scene=[new y.FilteredFiniteDifference(.6),new y.FilteredFiniteDifference(.6),new y.FilteredFiniteDifference(.6)];this.tmpDirection=B.create()}var d=f.prototype;d.add=function(a,b,e){!this.enabled||this.time.hasLastValue&&.015>this.time.computeDelta(e)||(this.screen[0].update(a[0]),this.screen[1].update(a[1]),this.scene[0].update(b[0]),this.scene[1].update(b[1]),this.scene[2].update(b[2]),this.time.update(e))};d.reset=function(){this.screen[0].reset();this.screen[1].reset();this.scene[0].reset();
this.scene[1].reset();this.scene[2].reset();this.time.reset()};d.evaluateMomentum=function(){if(!this.enabled||!this.screen[0].hasFilteredDelta)return null;var a=this.screen[0].filteredDelta;const b=this.screen[1].filteredDelta;a=Math.sqrt(a*a+b*b)/this.time.filteredDelta;return Math.abs(a)<this.minimumInitialVelocity?null:this.createMomentum(a,this.stopVelocity,this.friction)};d.createMomentum=function(a,b,e){C.set(this.tmpDirection,this.scene[0].filteredDelta,this.scene[1].filteredDelta,this.scene[2].filteredDelta);
const l=C.length(this.tmpDirection);0<l&&C.scale(this.tmpDirection,this.tmpDirection,1/l);return new n(a,b,e,l/this.time.filteredDelta,this.tmpDirection)};return f}();z.PanPlanarMomentum=n;z.PanPlanarMomentumEstimator=x;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/navigation/FilteredFiniteDifference":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(z,D){let C=function(){function B(x){this.gain=x}var y=B.prototype;
y.update=function(x){if(this.hasLastValue){const n=this.computeDelta(x);this._updateDelta(n)}this.lastValue=x};y.reset=function(){this.filteredDelta=this.lastValue=void 0};y.computeDelta=function(x){return x-this.lastValue};y._updateDelta=function(x){this.filteredDelta=this.hasFilteredDelta?(1-this.gain)*this.filteredDelta+this.gain*x:x};D._createClass(B,[{key:"hasLastValue",get:function(){return void 0!==this.lastValue}},{key:"hasFilteredDelta",get:function(){return void 0!==this.filteredDelta}}]);
return B}();z.FilteredFiniteDifference=C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/navigation/Momentum":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(z,D){let C=function(){function B(x,n,f){this._initialVelocity=x;this._stopVelocity=n;this._friction=f;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}var y=B.prototype;y.isFinished=function(x){return x>
this.duration};y.value=function(x){return this.valueFromInitialVelocity(this._initialVelocity,x)};y.valueDelta=function(x,n){const f=this.value(x);return this.value(x+n)-f};y.valueFromInitialVelocity=function(x,n){n=Math.min(n,this.duration);const f=1-this.friction;return x*(f**n-1)/Math.log(f)};D._createClass(B,[{key:"duration",get:function(){return this._duration}},{key:"friction",get:function(){return this._friction}}]);return B}();z.Momentum=C;Object.defineProperties(z,{__esModule:{value:!0},
[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/navigation/actions/Pinch":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../navigation/RotationMomentumEstimator ../../../navigation/ZoomMomentumEstimator ../../../../geometry/Point".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g,c){C=function(m){function q(u){var h=m.call(this,u)||this;h._animationTime=0;h._momentumFinished=!1;h._rotationMomentumEstimator=new r.RotationMomentumEstimator(.6,.15,.95);h._rotationDirection=1;h._zoomDirection=1;h._zoomMomentumEstimator=new g.ZoomMomentumEstimator;h._zoomOnly=null;h.zoomMomentum=null;h.rotateMomentum=null;h.viewpoint=new B({targetGeometry:new c,scale:0,rotation:0});h.own(x.when(()=>h._momentumFinished,()=>h.navigation.stop()));return h}
z._inheritsLoose(q,m);var p=q.prototype;p.begin=function(u,h){this.navigation.begin();this._rotationMomentumEstimator.reset();this._zoomMomentumEstimator.reset();this._zoomOnly=null;this._previousAngle=this._startAngle=h.angle;this._previousRadius=this._startRadius=h.radius;this._previousCenter=h.center;this._updateTimestamp=null;u.constraints.rotationEnabled&&this.addToRotateEstimator(0,h.timestamp);this.addToZoomEstimator(h,1)};p.update=function(u,h){null===this._updateTimestamp&&(this._updateTimestamp=
h.timestamp);const t=h.angle,v=h.radius,w=h.center,A=Math.abs(180*(t-this._startAngle)/Math.PI),E=Math.abs(v-this._startRadius),G=this._startRadius/v;if(this._previousRadius){const F=v/this._previousRadius;let H=180*(t-this._previousAngle)/Math.PI;this._rotationDirection=0<=H?1:-1;this._zoomDirection=1<=F?1:-1;u.constraints.rotationEnabled?(null===this._zoomOnly&&200<h.timestamp-this._updateTimestamp&&(this._zoomOnly=0<E-A),null===this._zoomOnly||this._zoomOnly?H=0:this.addToRotateEstimator(t-this._startAngle,
h.timestamp)):H=0;this.addToZoomEstimator(h,G);this.navigation.setViewpoint([w.x,w.y],1/F,H,[this._previousCenter.x-w.x,w.y-this._previousCenter.y])}this._previousAngle=t;this._previousRadius=v;this._previousCenter=w};p.end=function(u){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum();this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum();this._animationTime=0;if(this.rotateMomentum||this.zoomMomentum)this.onAnimationUpdate(u);this.navigation.end()};p.addToRotateEstimator=
function(u,h){this._rotationMomentumEstimator.add(u,.001*h)};p.addToZoomEstimator=function(u,h){this._zoomMomentumEstimator.add(h,.001*u.timestamp)};p.canZoomIn=function(u){const h=u.scale;u=u.constraints.effectiveMaxScale;return 0===u||h>u};p.canZoomOut=function(u){const h=u.scale;u=u.constraints.effectiveMinScale;return 0===u||h<u};p.onAnimationUpdate=function(u){this.navigation.animationManager.animateContinous(u.viewpoint,(h,t)=>{var v=!this.canZoomIn(u)&&1<this._zoomDirection||!this.canZoomOut(u)&&
1>this._zoomDirection,w=!this.rotateMomentum||this.rotateMomentum.isFinished(this._animationTime);v=v||!this.zoomMomentum||this.zoomMomentum.isFinished(this._animationTime);t*=.001;this._momentumFinished=w&&v;if(!this._momentumFinished){w=this.rotateMomentum?Math.abs(this.rotateMomentum.valueDelta(this._animationTime,t))*this._rotationDirection*180/Math.PI:0;v=this.zoomMomentum?Math.abs(this.zoomMomentum.valueDelta(this._animationTime,t)):1;const E=l.create();var A=l.create();if(this._previousCenter){e.set(E,
this._previousCenter.x,this._previousCenter.y);k.getPaddingScreenTranslation(A,u.size,u.padding);e.add(E,E,A);const {constraints:G,scale:F}=u;A=F*v;1>v&&!G.canZoomInTo(A)?(v=F/G.effectiveMaxScale,this.rotateMomentum=this.zoomMomentum=null):1<v&&!G.canZoomOutTo(A)&&(v=F/G.effectiveMinScale,this.rotateMomentum=this.zoomMomentum=null);k.scaleAndRotateBy(h,u.viewpoint,v,w,E,u.size);u.constraints.constrainByGeometry(h)}}this._animationTime+=t})};p.stopMomentumNavigation=function(){if(this.rotateMomentum||
this.zoomMomentum)this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop()};return q}(y);D.__decorate([n.property()],C.prototype,"_momentumFinished",void 0);D.__decorate([n.property()],C.prototype,"viewpoint",void 0);D.__decorate([n.property()],C.prototype,"navigation",void 0);return C=D.__decorate([b.subclass("esri.views.2d.navigation.actions.Pinch")],C)})},"esri/views/navigation/RotationMomentumEstimator":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./MomentumEstimator"],function(z,D,C){C=function(B){function y(x=3,n=.01,f=.95,d=12){return B.call(this,x,n,f,d)||this}D._inheritsLoose(y,B);y.prototype.add=function(x,n){if(this.value.hasLastValue){const f=this.value.lastValue;for(x-=f;x>Math.PI;)x-=2*Math.PI;for(;x<-Math.PI;)x+=2*Math.PI;x=f+x}B.prototype.add.call(this,x,n)};return y}(C.MomentumEstimator);z.RotationMomentumEstimator=C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/views/navigation/MomentumEstimator":function(){define(["exports","../../core/mathUtils","./FilteredFiniteDifference","./Momentum"],function(z,D,C,B){let y=function(){function x(f=2.5,d=.01,a=.95,b=12){this.minimumInitialVelocity=f;this.stopVelocity=d;this.friction=a;this.maxVelocity=b;this.enabled=!0;this.value=new C.FilteredFiniteDifference(.8);this.time=new C.FilteredFiniteDifference(.3)}var n=x.prototype;n.add=function(f,d){if(this.enabled){if(this.time.hasLastValue){if(.01>this.time.computeDelta(d))return;
if(this.value.hasFilteredDelta){const a=this.value.computeDelta(f);0>this.value.filteredDelta*a&&this.value.reset()}}this.time.update(d);this.value.update(f)}};n.reset=function(){this.value.reset();this.time.reset()};n.evaluateMomentum=function(){if(!this.enabled||!this.value.hasFilteredDelta)return null;let f=this.value.filteredDelta/this.time.filteredDelta;f=D.clamp(f,-this.maxVelocity,this.maxVelocity);return Math.abs(f)<this.minimumInitialVelocity?null:this.createMomentum(f,this.stopVelocity,
this.friction)};n.createMomentum=function(f,d,a){return new B.Momentum(f,d,a)};return x}();z.MomentumEstimator=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/navigation/ZoomMomentumEstimator":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./Momentum","./MomentumEstimator"],function(z,D,C,B){let y=function(x){function n(d,a,b){return x.call(this,d,a,b)||this}D._inheritsLoose(n,x);var f=n.prototype;f.value=function(d){d=
x.prototype.value.call(this,d);return Math.exp(d)};f.valueDelta=function(d,a){const b=x.prototype.value.call(this,d);d=x.prototype.value.call(this,d+a);return Math.exp(d-b)};return n}(C.Momentum);C=function(x){function n(d=2.5,a=.01,b=.95,e=12){return x.call(this,d,a,b,e)||this}D._inheritsLoose(n,x);var f=n.prototype;f.add=function(d,a){x.prototype.add.call(this,Math.log(d),a)};f.createMomentum=function(d,a,b){return new y(d,a,b)};return n}(B.MomentumEstimator);z.ZoomMomentum=y;z.ZoomMomentumEstimator=
C;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/navigation/actions/Rotate":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators/property ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../../geometry/Point".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k){const r=e.create(),g=e.create();C=function(c){function m(p){p=c.call(this,p)||this;p._previousCenter=e.create();p.viewpoint=new B({targetGeometry:new k,scale:0,rotation:0});return p}z._inheritsLoose(m,c);var q=m.prototype;q.begin=function(p,u){this.navigation.begin();b.set(this._previousCenter,u.center.x,u.center.y)};q.update=function(p,u){const {state:{size:h,padding:t}}=p;b.set(r,u.center.x,u.center.y);l.getAnchor(g,h,t);p.viewpoint=l.rotateBy(this.viewpoint,
p.state.paddedViewState.viewpoint,l.angleBetween(g,this._previousCenter,r));b.copy(this._previousCenter,r)};q.end=function(){this.navigation.end()};return m}(y);D.__decorate([x.property()],C.prototype,"viewpoint",void 0);D.__decorate([x.property()],C.prototype,"navigation",void 0);return C=D.__decorate([a.subclass("esri.views.2d.actions.Rotate")],C)})},"esri/views/2d/magnifier/MagnifierView2D":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/Handles ../../../core/mathUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/urlUtils ../../../chunks/mat3f32 ../engine/DisplayObject ../engine/webgl/DefaultVertexAttributeLayouts ../engine/webgl/enums ../engine/webgl/shaders/MagnifierPrograms ../../magnifier/resources ../../webgl/BufferObject ../../webgl/enums ../../webgl/Texture ../../webgl/VertexArrayObject".split(" "),
function(z,D,C,B,y,x,n,f,d,a,b,e,l,k,r,g,c,m){return function(q){function p(){var h=q.call(this)||this;h._handles=new C;h._resourcePixelRatio=1;h.visible=!1;return h}z._inheritsLoose(p,q);var u=p.prototype;u.destroy=function(){this._handles.destroy();this._handles=null;this._disposeRenderResources();this._resourcesTask&&(this._resourcesTask.abort(),this._resourcesTask=null)};u._createTransforms=function(){return{dvs:d.create()}};u.doRender=function(h){const t=h.context;if(!this._resourcesTask)this._reloadResources();
else if(h.drawPhase===e.WGLDrawPhase.MAP&&this._canRender()){this._updateResources(h);var v=this._magnifier;if(!y.isNone(v.position)){var w=h.pixelRatio,A=v.size*w,E=Math.ceil(1/v.factor*A);this._readbackTexture.resize(E,E);var {size:G}=h.state;h=w*G[0];G=w*G[1];var F=.5*E,H=.5*E,J=B.clamp(w*v.position.x,F,h-F-1),I=B.clamp(G-w*v.position.y,H,G-H-1);t.setBlendingEnabled(!0);F=J-F;H=I-H;var N=this._readbackTexture;t.bindTexture(N,0);t.gl.copyTexImage2D(N.descriptor.target,0,N.descriptor.pixelFormat,
F,H,E,E,0);var M=(E=null==(M=this.background)?void 0:M.color)?[E.a*E.r/255,E.a*E.g/255,E.a*E.b/255,E.a]:[1,1,1,1];E=-1+(J+v.offset.x*w)/h*2;w=-1+(I-v.offset.y*w)/G*2;h=A/h*2;A=A/G*2;G=this._program;t.bindVAO(this._vertexArrayObject);t.bindTexture(this._overlayTexture,6);t.bindTexture(this._maskTexture,7);t.useProgram(G);G.setUniform4fv("u_background",M);G.setUniform1i("u_readbackTexture",0);G.setUniform1i("u_overlayTexture",6);G.setUniform1i("u_maskTexture",7);G.setUniform4f("u_drawPos",E,w,h,A);
G.setUniform1i("u_maskEnabled",v.maskEnabled?1:0);G.setUniform1i("u_overlayEnabled",v.overlayEnabled?1:0);t.setStencilTestEnabled(!1);t.setColorMask(!0,!0,!0,!0);t.drawArrays(g.PrimitiveType.TRIANGLE_STRIP,0,4);t.bindVAO()}}};u._canRender=function(){return this.mask&&this.overlay&&null!=this._magnifier};u._reloadResources=function(){var h=this;this._resourcesTask&&this._resourcesTask.abort();const t=y.isSome(this._magnifier)?this._magnifier.maskUrl:null,v=y.isSome(this._magnifier)?this._magnifier.overlayUrl:
null;this._resourcesTask=x.createTask(function(){var w=z._asyncToGenerator(function*(A){const E=y.isNone(t)||y.isNone(v)?k.loadMagnifierResources(A):null,G=y.isSome(t)?D(t,{responseType:"image",signal:A}).then(J=>J.data):E.then(J=>J.mask);A=y.isSome(v)?D(v,{responseType:"image",signal:A}).then(J=>J.data):E.then(J=>J.overlay);const [F,H]=yield Promise.all([G,A]);h.mask=F;h.overlay=H;h._disposeRenderResources();h.requestRender()});return function(A){return w.apply(this,arguments)}}())};u._disposeRenderResources=
function(){this._readbackTexture=y.disposeMaybe(this._readbackTexture);this._overlayTexture=y.disposeMaybe(this._overlayTexture);this._maskTexture=y.disposeMaybe(this._maskTexture);this._vertexArrayObject=y.disposeMaybe(this._vertexArrayObject);this._program=y.disposeMaybe(this._program)};u._updateResources=function(h){h.pixelRatio!==this._resourcePixelRatio&&this._disposeRenderResources();if(!this._readbackTexture){var t=h.context;this._resourcePixelRatio=h.pixelRatio;var v=Math.ceil(this._magnifier.size*
h.pixelRatio);this._program=l.createMagnifierProgram(t);var w=new Uint16Array([0,1,0,0,1,1,1,0]);this._vertexArrayObject=new m.VertexArrayObject(t,l.magnifierProgramTemplate.attributes,b.Pos2us,{geometry:r.BufferObject.createVertex(t,g.Usage.STATIC_DRAW,w)});this.overlay.width=v;this.overlay.height=v;this._overlayTexture=new c.Texture(t,{target:g.TextureType.TEXTURE_2D,pixelFormat:g.PixelFormat.RGBA,internalFormat:g.PixelFormat.RGBA,dataType:g.PixelType.UNSIGNED_BYTE,wrapMode:g.TextureWrapMode.CLAMP_TO_EDGE,
samplingMode:g.TextureSamplingMode.NEAREST,flipped:!0,preMultiplyAlpha:f.isSVG(this.overlay.src)&&h.context.driverTest.svgAlwaysPremultipliesAlpha?!1:!0},this.overlay);this.mask.width=v;this.mask.height=v;this._maskTexture=new c.Texture(t,{target:g.TextureType.TEXTURE_2D,pixelFormat:g.PixelFormat.ALPHA,internalFormat:g.PixelFormat.ALPHA,dataType:g.PixelType.UNSIGNED_BYTE,wrapMode:g.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:g.TextureSamplingMode.NEAREST,flipped:!0},this.mask);h=1/this._magnifier.factor;
this._readbackTexture=new c.Texture(t,{target:g.TextureType.TEXTURE_2D,pixelFormat:g.PixelFormat.RGBA,internalFormat:g.PixelFormat.RGBA,dataType:g.PixelType.UNSIGNED_BYTE,wrapMode:g.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:g.TextureSamplingMode.LINEAR,flipped:!1,width:Math.ceil(h*v),height:Math.ceil(h*v)})}};z._createClass(p,[{key:"background",get:function(){return this._background},set:function(h){this._background=h;this.requestRender()}},{key:"magnifier",get:function(){return this._magnifier},
set:function(h){this._magnifier=h;this._handles.removeAll();this._handles.add([n.watch(()=>h.version,()=>{this.visible=h.visible&&y.isSome(h.position)&&0<h.size;this.requestRender()},n.initial),n.watch(()=>[h.maskUrl,h.overlayUrl],()=>this._reloadResources()),n.watch(()=>h.size,()=>{this._disposeRenderResources();this.requestRender()})])}}]);return p}(a.DisplayObject)})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define(["exports","./sources/resolver","../../../../webgl/ProgramTemplate"],
function(z,D,C){const B={shaders:{vertexShader:D.resolveIncludes("magnifier/magnifier.vert"),fragmentShader:D.resolveIncludes("magnifier/magnifier.frag")},attributes:new Map([["a_pos",0]])};z.createMagnifierProgram=function(y){return C.createProgram(y,B)};z.magnifierProgramTemplate=B;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/magnifier/resources":function(){define(["require","exports","../../chunks/_rollupPluginBabelHelpers","../../core/promiseUtils",
"../../support/requestImageUtils"],function(z,D,C,B,y){function x(){x=C._asyncToGenerator(function*(f){var d=new Promise((b,e)=>z(["./mask-svg"],l=>b(n(l)),e)),a=new Promise((b,e)=>z(["./overlay-svg"],l=>b(n(l)),e));d=y.requestImage((yield d).default,{signal:f});a=y.requestImage((yield a).default,{signal:f});a={mask:yield d,overlay:yield a};B.throwIfAborted(f);return a});return x.apply(this,arguments)}const n=f=>Object.freeze(Object.defineProperty({__proto__:null,default:f},Symbol.toStringTag,{value:"Module"}));
D.loadMagnifierResources=function(f){return x.apply(this,arguments)};Object.defineProperties(D,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/support/requestImageUtils":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","../request"],function(z,D,C){function B(){B=D._asyncToGenerator(function*(y,x){({data:y}=yield C(y,{responseType:"image",...x}));return y});return B.apply(this,arguments)}z.requestImage=function(y,x){return B.apply(this,arguments)};Object.defineProperties(z,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["exports","../../../chunks/mat4"],function(z,D){z.mat4=D.mat4;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["exports","../../../chunks/mat4f32"],function(z,D){z.mat4f32=D.mat4f32;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["exports",
"../../../chunks/vec3f32"],function(z,D){z.vec3f32=D.vec3f32;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["exports","../../../chunks/vec4f32"],function(z,D){z.vec4f32=D.vec4f32;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/Bitmap":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/mat3 ../../../chunks/mat3f32 ../../../chunks/vec2f32 ./DisplayObject ./ImageryBitmapSource ../../webgl/enums ../../webgl/Texture".split(" "),
function(z,D,C,B,y,x,n,f,d,a){function b(k){return k&&"render"in k}function e(k){const r=document.createElement("canvas");r.width=k.width;r.height=k.height;k.render(r.getContext("2d"));return r}function l(k,r,g){const c={target:d.TextureType.TEXTURE_2D,pixelFormat:d.PixelFormat.RGBA,internalFormat:d.PixelFormat.RGBA,dataType:d.PixelType.UNSIGNED_BYTE,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE};r&&g&&(c.width=r,c.height=g);return new a.Texture(k,c)}n=function(k){function r(c=null,m,q=!0){var p=k.call(this)||
this;p.requestRenderOnSourceChangedEnabled=q;p._textureInvalidated=!0;p.stencilRef=0;p.coordScale=[1,1];p._height=void 0;p.pixelRatio=1;p.resolution=0;p.rotation=0;p._source=null;p._width=void 0;p.x=0;p.y=0;p.blendFunction=m;p.source=c;p.requestRender=p.requestRender.bind(D._assertThisInitialized(p));return p}D._inheritsLoose(r,k);var g=r.prototype;g.destroy=function(){this._texture&&(this._texture.dispose(),this._texture=null)};g.beforeRender=function(c){k.prototype.beforeRender.call(this,c);this.updateTexture(c.context)};
g.invalidateTexture=function(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())};g._createTransforms=function(){return{dvs:y.create()}};g.setTransform=function(c){const m=B.identity(this.transforms.dvs),[q,p]=c.toScreenNoRotation([0,0],[this.x,this.y]);var u=this.resolution/this.pixelRatio/c.resolution;const h=u*this.width;u*=this.height;const t=Math.PI*this.rotation/180;B.translate(m,m,x.fromValues(q,p));B.translate(m,m,x.fromValues(h/
2,u/2));B.rotate(m,m,-t);B.translate(m,m,x.fromValues(-h/2,-u/2));B.scaleByVec2(m,m,x.fromValues(h,u));B.multiply(this.transforms.dvs,c.displayViewMat3,m)};g.setSamplingProfile=function(c){this._texture&&(c.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(c.samplingMode))};g.bind=function(c,m){this._texture&&c.bindTexture(this._texture,m)};g.updateTexture=function(c){if(this.stage)this._textureInvalidated&&(this._textureInvalidated=!1,this._texture||
(this._texture=this.source?l(c,this.sourceWidth,this.sourceHeight):l(c)),(c=this.source)?(this._texture.resize(this.sourceWidth,this.sourceHeight),b(c)?c instanceof f?(c=c.getRenderedRasterPixels(),this._texture.setData(C.isSome(c)?c.renderedRasterPixels:null)):this._texture.setData(e(c)):!c||"render"in c||this._texture.setData(c),this.ready()):this._texture.setData(null));else{var m;null==(m=this._texture)?void 0:m.dispose();this._texture=null}};g.onAttach=function(){this.invalidateTexture()};g.onDetach=
function(){this.invalidateTexture()};D._createClass(r,[{key:"isSourceScaled",get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}},{key:"height",get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(c){this._height=c}},{key:"source",get:function(){return this._source},set:function(c){this._source=c;this.invalidateTexture()}},{key:"sourceHeight",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:
this._source.height}},{key:"sourceWidth",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}},{key:"width",get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(c){this._width=c}}]);return r}(n.DisplayObject);z.Bitmap=n;z.isImageSource=b;z.rasterize=e;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["../../../chunks/_rollupPluginBabelHelpers",
"../../../core/maybe"],function(z,D){return function(){function C(y,x,n){this.pixelBlock=y;this.extent=x;this.originalPixelBlock=n}var B=C.prototype;B.render=function(y){var x=this.pixelBlock;if(!D.isNone(x)){var n=this.filter({pixelBlock:x});D.isNone(n.pixelBlock)||(x=n.pixelBlock.getAsRGBA(),n=y.createImageData(n.pixelBlock.width,n.pixelBlock.height),n.data.set(x),y.putImageData(n,0,0))}};B.getRenderedRasterPixels=function(){const y=this.filter({pixelBlock:this.pixelBlock});return D.isNone(y.pixelBlock)?
null:{width:y.pixelBlock.width,height:y.pixelBlock.height,renderedRasterPixels:new Uint8Array(y.pixelBlock.getAsRGBA().buffer)}};z._createClass(C,[{key:"width",get:function(){return D.isSome(this.pixelBlock)?this.pixelBlock.width:0}},{key:"height",get:function(){return D.isSome(this.pixelBlock)?this.pixelBlock.height:0}}]);return C}()})},"esri/views/2d/engine/BitmapContainer":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","./brushes","./webgl/enums","./webgl/WGLContainer"],
function(z,D,C,B,y){y=function(x){function n(){return x.apply(this,arguments)||this}D._inheritsLoose(n,x);n.prototype.prepareRenderPasses=function(f){const d=f.registerRenderPass({name:"bitmap",brushes:[C.brushes.bitmap],target:()=>this.children,drawPhase:B.WGLDrawPhase.MAP});return[...x.prototype.prepareRenderPasses.call(this,f),d]};D._createClass(n,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(f=>"additive"===f.blendFunction)}}]);return n}(y);z.BitmapContainer=y;Object.defineProperties(z,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/BitmapTile":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../chunks/mat3f32","./Bitmap","./webgl/TiledDisplayObject"],function(z,D,C,B,y){y=function(x){function n(d,a,b,e,l,k=null){var r=x.call(this,d,a,b,e,l)||this;r.bitmap=new B.Bitmap(k,"standard",!1);r.bitmap.coordScale=[e,l];r.bitmap.once("isReady",()=>r.ready());return r}D._inheritsLoose(n,x);var f=n.prototype;f.destroy=
function(){x.prototype.destroy.call(this);this.bitmap.destroy()};f.beforeRender=function(d){x.prototype.beforeRender.call(this,d);this.bitmap.beforeRender(d)};f.afterRender=function(d){x.prototype.afterRender.call(this,d);this.bitmap.afterRender(d)};f._createTransforms=function(){return{dvs:C.create(),tileMat3:C.create()}};f.setTransform=function(d,a){x.prototype.setTransform.call(this,d,a);this.bitmap.transforms.dvs=this.transforms.dvs};f.onAttach=function(){this.bitmap.stage=this.stage};f.onDetach=
function(){this.bitmap&&(this.bitmap.stage=null)};D._createClass(n,[{key:"stencilRef",get:function(){return this.bitmap.stencilRef},set:function(d){this.bitmap.stencilRef=d}}]);return n}(y.TiledDisplayObject);z.BitmapTile=y;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/views/2d/engine/BitmapTileContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/aaBoundingRect ./BitmapTile ./brushes ./webgl/enums ./webgl/TileContainer".split(" "),
function(z,D,C,B,y,x,n){n=function(f){function d(){return f.apply(this,arguments)||this}D._inheritsLoose(d,f);var a=d.prototype;a.createTile=function(b){const e=this._tileInfoView.getTileBounds(C.create(),b),[l,k]=this._tileInfoView.tileInfo.size;return new B.BitmapTile(b,e[0],e[3],l,k)};a.prepareRenderPasses=function(b){const e=b.registerRenderPass({name:"bitmap (tile)",brushes:[y.brushes.bitmap],target:()=>this.children.map(l=>l.bitmap),drawPhase:x.WGLDrawPhase.MAP});return[...f.prototype.prepareRenderPasses.call(this,
b),e]};a.doRender=function(b){this.visible&&b.drawPhase===x.WGLDrawPhase.MAP&&f.prototype.doRender.call(this,b)};D._createClass(d,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(b=>"additive"===b.bitmap.blendFunction)}}]);return d}(n);z.BitmapTileContainer=n;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})}}});
define("exports ./engine/Stage ./LabelManager ./layers/graphics/GraphicsView2D ./layers/graphics/GraphicContainer ./navigation/MapViewNavigation ./magnifier/MagnifierView2D".split(" "),function(z,D,C,B,y,x,n){z.Stage=D.Stage;z.LabelManager=C;z.GraphicsView2D=B;z.GraphicContainer=y;z.MapViewNavigation=x;z.MagnifierView2D=n;Object.defineProperties(z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});