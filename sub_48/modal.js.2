(function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define("build/shared/js/modal",[],o):"object"==typeof exports?exports["build/shared/js/modal"]=o():e["build/shared/js/modal"]=o()}(this,function(){
var __EXPORTS__=(()=>{var a=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols;var g=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var m=(n,t,e)=>t in n?a(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,d=(n,t)=>{for(var e in t||(t={}))g.call(t,e)&&m(n,e,t[e]);if(h)for(var e of h(t))E.call(t,e)&&m(n,e,t[e]);return n};var w=(n,t)=>{for(var e in t)a(n,e,{get:t[e],enumerable:!0})},O=(n,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of y(t))!g.call(n,s)&&s!==e&&a(n,s,{get:()=>t[s],enumerable:!(i=f(t,s))||i.enumerable});return n};var L=n=>O(a({},"__esModule",{value:!0}),n);var u=(n,t,e)=>new Promise((i,s)=>{var v=r=>{try{l(e.next(r))}catch(p){s(p)}},b=r=>{try{l(e.throw(r))}catch(p){s(p)}},l=r=>r.done?i(r.value):Promise.resolve(r.value).then(v,b);l((e=e.apply(n,t)).next())});var P={};w(P,{default:()=>C});var x={closeable:!0,blurred:!1,parameters:new URLSearchParams,data:new Map},c=class{constructor(t,e){this.content=null;this.container=null;this.__events={};this.name=t,this.options=d(d({},x),e),this.options.parameters=new URLSearchParams(this.options.parameters),this.container=this.createContainer()}on(t,e){this.__events[t]||(this.__events[t]=[]),this.__events[t].push(e)}emit(t){var e;(e=this.__events[t])==null||e.forEach(i=>i.call(this))}setOptions(t){return Object.entries(t).forEach(([e,i])=>{this.options[e]=i}),this}getParam(t){let e=this.options.parameters.get(t);return e||this.getData(t)}setParam(t,e){return this.options.parameters.set(t,e),this}getData(t){return this.options.data.get(t)}setData(t,e){return this.options.data.set(t,e),this}getKey(){return`${this.name}_${this.options.parameters}`}createUrl(){let t=new URL(`/layer/${this.name}/`,window.location.origin);return this.options.parameters.forEach((e,i)=>{e&&e!=="undefined"&&t.searchParams.append(i,e)}),t}load(){return u(this,null,function*(){let t=this.createUrl(),e=yield fetch(t.toString());return e.status!==200?"":e.text()})}open(){return u(this,null,function*(){this.emit("beforeOpen"),document.body.append(this.container),this.content===null&&(this.content=yield this.load()),this.container.innerHTML=this.getContent(),this.executeScripts(),this.emit("open")})}close(){this.emit("close"),document.body.removeChild(this.container),this.emit("afterClose")}setContent(t){this.content=t}getContent(){return this.content}getContainer(){return this.container}createContainer(){let t=document.createElement("div");return t.classList.add("z-modal-overlay"),this.options.blurred&&t.classList.add("z-modal-overlay--blurred"),t.addEventListener("mousedown",e=>{let i=e.target;!i.closest('[data-modal="close"]')&&t!==i||!this.options.closeable||(e.preventDefault(),this.close())}),t}executeScripts(){let t=this.container.querySelectorAll("script:not([src])");for(let e=0;e<t.length;++e){let i=document.createElement("script");i.textContent=t[e].textContent,this.container.appendChild(i),i.remove()}}};var o=class{constructor(){this.items=[];this.initEvents()}static getInstance(){return o.instance||(o.instance=new o),o.instance}create(t,e){let i=new c(t,e);return i.on("beforeOpen",()=>{this.items.length===0&&(document.body.style.overflow="hidden",document.body.classList.add("z-modal--opened")),this.items.push(i)}),i.on("afterClose",()=>{this.items.pop(),this.items.length===0&&(document.body.style.overflow="",document.body.classList.remove("z-modal--opened"))}),i}get(){return this.items[this.items.length-1]}getItems(){return this.items}initEvents(){document.addEventListener("click",t=>{let e=t.target;if(!e.closest('[data-modal="open"]'))return;let i=e.getAttribute("data-modal-name");if(i===null){console.error("modal name is empty");return}t.preventDefault(),this.create(i).open()})}},C=o.getInstance();return L(P);})();
return __EXPORTS__ ? __EXPORTS__.default : null;}));
