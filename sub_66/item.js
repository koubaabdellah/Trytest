// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.41/esri/copyright.txt for details.
// See https://www.arcgis.com/home/copyright.txt for further details.
//>>built
/*
 layerInfo.showLabels && layer.url ||*/
require({cache:{"arcgisonline/pages/basePage":function(){define("require exports tslib calcite-web/js/calcite-web dojo/_base/kernel dojo/Deferred dojo/when dojo/_base/lang dojo/_base/window dojo/query dojo/debounce dijit/_WidgetBase dijit/registry dojo/on dojo/string dojo/topic dojo/dom-attr dojo/dom-construct dojo/dom-class esri/Evented esri/config arcgisonline/sharing/util ./utils/alerts ./utils/dom ./utils/organization arcgisonline/telemetry ../sharing/dijit/SiteHeader ./components/SiteFooter dojo/i18n!../nls/arcgisonline ./components/ManageBlockedApps/blocked-apps-service ../tsutils/declareDecorator arcgisonline/esriGeowConfig preact ./utils/queryHandler".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D,K,G,I,R,A){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);y=q.__importDefault(y);C=q.__importDefault(C);
z=q.__importDefault(z);F=q.__importDefault(F);O=q.__importDefault(O);V=q.__importDefault(V);N=q.__importDefault(N);J=q.__importDefault(J);D=q.__importDefault(D);K=q.__importDefault(K);G=q.__importDefault(G);I=q.__importDefault(I);A=q.__importStar(A);return function(){function B(H){this.i18n=D["default"];this.esriPortalConfig=I["default"];this._handles=[];this._forceErrorToast=this._hideErrors=this._showErrors=this.hideFooter=this.hideHeader=this.isLoaded=!1;this.page=q.__assign({},H);this.portalUser=
H.portalUser||null;this.portal=H.portal||null}B.prototype.destroy=function(){R.render(null,this.footerDiv)};B.prototype.postMixInProperties=function(){this.inherited(arguments);y["default"].defaults.io.errorHandler=this._showError.bind(this);this._queryStringParams=A.queryToObject(window.location.search.slice(1))};B.prototype.startup=function(){this.inherited(arguments);this.telemetry=V["default"].init({config:this.portal});var H=getComputedStyle(document.documentElement);"rgba(0, 0, 0, 0)"===(null===
H||void 0===H?void 0:H["background-color"])&&document.body.classList.contains("dj_a11y")&&document.documentElement.classList.add("a11y-black");this._buildPage();this._addEventListeners()};B.prototype.toggleErrors=function(H){this._hideErrors=!H;this._showErrors=H};B.prototype._setPageTitleAttr=function(H){window.document.title=H};B.prototype._setIsLoadedAttr=function(H){this.isLoaded=H};B.prototype.showLoader=function(){F["default"].activateNode(this._loader);F["default"].hideNode(this._content)};
B.prototype.hideLoader=function(){F["default"].deactivateNode(document.querySelector(".js-page-loader"));F["default"].showNode(document.querySelector(".js-content-wrapper"));F["default"].deactivateNode(this._loader);F["default"].showNode(this._content)};B.prototype.removeError=function(){var H=document.querySelector(".js-alert");H&&u["default"].destroy(H)};B.prototype.hideErrors=function(){var H=document.querySelector(".js-alert");H&&u["default"].empty(H)};B.prototype.showAlert=function(H){var T=
H.type||"success";H=H.text||"";this._alert&&this._alert.destroy();this._alert=z["default"].showAlert(T,H)};B.prototype.showError=function(H){this._showError(H)};B.prototype._addEventListeners=function(){this.own(t["default"].subscribe("alert/show",this.showAlert.bind(this)),t["default"].subscribe("tabs/disable",this._disableTabs.bind(this)),t["default"].subscribe("tabs/enable",this._enableTabs.bind(this)),t["default"].subscribe("page/showError",this._showError.bind(this)),n["default"](window,"resize",
h["default"](function(){return t["default"].publish("window/resize")},300)))};B.prototype._buildPage=function(){var H=this,T;this.set("pageTitle",I["default"].portalName||this.i18n.common.arcgis);var M=l["default"].locale.split("-");document.documentElement.lang=-1!==l["default"].locale.indexOf("-")?[M[0],M[1].toUpperCase()].join("-"):M[0];this.pageNode=this.pageNode||c["default"].body();this.flexFix=u["default"].create("div",{"class":"flex-column"},this.pageNode,"next");this.contentWrapper=u["default"].create("div",
{"class":"js-content-wrapper content-wrapper flex-column flex-1 hide"},this.flexFix,"next");this.hideHeader||(this.header=new N["default"]({page:this,id:"header",esriPortalConfig:this.esriPortalConfig,relativePath:this.relativePath,telemetry:this.telemetry}),this.header.placeAt(this.contentWrapper,"first"),this.header.startup());u["default"].place(this.domNode,this.contentWrapper);this.hideFooter||(this.footerDiv=u["default"].create("div",null,this.contentWrapper,"last"),this.footer=R.h(J["default"],
{id:"footer",portal:this.portal}),R.render(this.footer,this.footerDiv));this.skipToContent&&(M=m["default"].substitute('\x3ca href\x3d"#${skipToContent}" class\x3d"skip-to-content js-skip-to-content"\x3e${i18n.common.skipToContent}\x3c/a\x3e',{skipToContent:this.skipToContent,i18n:D["default"]}),u["default"].place(M,this.pageNode,"first"),document.querySelector(".js-skip-to-content").addEventListener("click",function(L){L.preventDefault();L.stopPropagation();if(L=document.getElementById(H.skipToContent))L.tabIndex=
-1,L.focus()}));this.set("htmlCssClasses");(null===(T=this.portalUser)||void 0===T?0:T.orgId)&&this.setBlockedClasses()};B.prototype.setBlockedClasses=function(){K["default"].getBlockedApps().then(function(H){var T={webappbuilder:"wab-blocked",arcgisstorymaps:"storymap-blocked",opsdashboard:"dashboard-blocked",experienceBuilder:"exp-builder-blocked",HubforArcGIS:"hub-blocked"};Object.keys(T).forEach(function(M){-1<(null===H||void 0===H?void 0:H.indexOf(M))&&(M=T[M],document.documentElement.classList.add(M),
document.body.classList.add(M))})})};B.prototype._setHtmlCssClassesAttr=function(){var H=[],T=this.portal,M=T.getPortalUser(),L=M&&M.isOrgUser,X=M&&M.licenses,ba;H.push(T.isPortal?"is-on-premise":"is-online");H.push(M?"is-signed-in":"is-signed-out");Object.keys(X||{}).forEach(function(ma){ba=X[ma];!ba.valid&&ba.className&&H.push(ba.className)});H.push(I["default"].webAppBuilderEnabled&&L?"is-wab-enabled":"");H.push(I["default"].showCreateDashboard&&L?"is-createDashboard-enabled":"");H.push(I["default"].sceneViewerEnabled?
"is-sceneViewer-enabled":"");v["default"].add(document.querySelector("html"),H.join(" "))};B.prototype._request=function(H,T){return C["default"].request(H,T)};B.prototype._showError=function(H){var T=null;T=H&&H.message||this.i18n.common.errors.genericError.message;var M=document.querySelector(".js-alert")||u["default"].toDom('\x3cdiv class\x3d"flex-center js-alert leader-2 trailer-2"\x3e\x3c/div\x3e'),L=null;if(!(this._hideErrors||H&&("SB_0001"===H.messageCode||"SB_0002"===H.messageCode)||403!==
H.code&&"GWM_0003"===H.messageCode)){if(!this._item&&this.portalUser&&H&&403===H.code){if(-1!==H.message.indexOf("world/utilities.gpserver"))return;T=this.i18n.errorWidget.accessDeniedResource;this._showErrors=!0}else"GWM_0011"===(null===H||void 0===H?void 0:H.messageCode)?(T=-1<window.location.href.indexOf("/group.html")?this.i18n.common.errors.spamContentGroupUpdate:this.i18n.common.errors.spamContentItemUpdate,this._showErrors=!0):T&&"Item does not exist or is inaccessible."===T?(T=this.i18n.errorWidget.itemNotFound+
" "+this.i18n.errorWidget.invalidItem,this._showErrors=!0):T&&"Your request has timed out."===T?T=this.i18n.contentCategories.errors.timedOut:this.portal.isPortal&&H&&"string"===typeof H&&-1<H.indexOf("ERROR 002555")?(T=this.i18n.itemProperties.error.dataStoreReadOnlyMode,this._showErrors=!0):T&&-1<T.indexOf("Your account is out of storage space and your item cannot be updated.")?(T=this.i18n.common.errors.outOfStorageSpace,this._showErrors=!0):T=H.messageHTML?H.messageHTML:C["default"].htmlEncode(T);
L=u["default"].toDom('\x3cdiv class\x3d"column-12 alert alert-red alert-inline break-word is-active"\x3e'+T+"\x3c/div\x3e");if(this._showErrors&&H&&499!==H.code&&498!==H.code&&404!==H.code)if(this._forceErrorToast||this.isLoaded&&!H.forceErrorNode)z["default"].showAlert("error",T);else{d["default"](".content-wrapper .loader, .js-page-loader").removeClass("is-active");d["default"](".js-content-wrapper").removeClass("hide");T=document.querySelector(".view-background");var X=document.querySelectorAll("header.subnav").length?
1:0;u["default"].place(M,T,X);u["default"].place(L,M,"only")}t["default"].publish("ago/page/error",{error:H});return H}};B.prototype._createTab=function(H,T){var M=this.tabDijit=new H(a["default"].mixin({page:this,i18n:this.i18n,portal:this.portal,portalUser:this.portalUser,telemetry:this.telemetry},T||{}),u["default"].create("div",{},this._content)),L=new p["default"];M.startup().then(function(){b["default"].init();L.resolve(M)});return L};B.prototype._destroyTab=function(){var H=this,T=new p["default"],
M=this.tabDijit&&this.tabDijit.canDestroy?this.tabDijit.canDestroy():!0;r["default"](M,function(){H.showLoader();(g["default"].findWidgets(H._content)||[]).forEach(function(L){L.destroy?L.destroy():L.destroyRecursive&&L.destroyRecursive()});u["default"].empty(H._content);z["default"].clearAlerts();T.resolve(!0)});return T};B.prototype._disableTabs=function(){var H=this;this._clearTabHandlerOverrides();var T=document.querySelectorAll(".js-subnav-link");F["default"].forEachNode(T,function(M){H._disabledTabHandlers.push(n["default"](M,
"click",function(L){L.stopPropagation();L.preventDefault()}));w["default"].set(M,"aria-disabled",!0);v["default"].add(M,"disabled")})};B.prototype._enableTabs=function(){var H=this;setTimeout(function(){H._clearTabHandlerOverrides();var T=document.querySelectorAll(".js-subnav-link");F["default"].forEachNode(T,function(M){w["default"].set(M,"aria-disabled",!1);v["default"].remove(M,"disabled")})},500)};B.prototype._clearTabHandlerOverrides=function(){this._disabledTabHandlers=this._disabledTabHandlers||
[];this._disabledTabHandlers.forEach(function(H){return H.remove()})};B.prototype.getMemberDefaults=function(){var H,T=null===(H=this.portalUser)||void 0===H?void 0:H.userRole;H=(null===T||void 0===T?void 0:T.isAdmin())||(null===T||void 0===T?void 0:T.canManageSecurity());return this.portalUser&&this.portal.id&&H?this.portal.getMemberDefaults():(H=new p["default"],H.resolve(),H)};B.prototype.getHomePageConfig=function(){var H=new p["default"];if(!this.portalUser||!this.portal.id)return H.resolve(),
H;var T=O["default"].hasModernHomePageEnabled(this.portal);(this.portal.hasModernHomePageEnabled=T)?this.portal.getHomePageConfig().then(function(){H.resolve()}):H.resolve();return H};return B=q.__decorate([G["default"](f["default"],x["default"])],B)}()})},"arcgisonline/pages/components/SiteFooter":function(){define("require exports tslib ../../esriGeowConfig ../../pages/utils/organization ../utils/arrays dojo/topic preact preact/hooks dojo/i18n!../../nls/arcgisonline".split(" "),function(e,U,q,b,
l,p,r,a,c,d){Object.defineProperty(U,"__esModule",{value:!0});b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);d=q.__importDefault(d);U["default"]=function(h){var f=h.id,g=h.portal;h=c.useState(!1);var n=h[0],m=h[1];h=c.useState([]);var t=h[0],w=h[1];c.useEffect(function(){var z=r["default"].subscribe("contact-us-link/update",v);return function(){var F;null===(F=null===z||void 0===z?void 0:z.remove)||void 0===F?void 0:F.call(z)}},[]);c.useEffect(function(){u()},
[t]);var u=function(){var z,F,O=q.__assign(q.__assign(q.__assign({},d["default"].common),d["default"].siteFooter),{helpLabel:d["default"].supportPage.helpLabel}),V=g.portalUser,N=g.isPortal,J=window.location.href;-1<J.indexOf("?useExisting\x3d1")&&(J=J.substring(0,J.length-14));m(-1<J.indexOf("viewer.html")&&-1===J.indexOf("returnUrl")&&!l["default"].isMobile());var D=[];(b["default"].footerLinks||[]).forEach(function(K){var G,I,R="${i18n.legal}"===(null===K||void 0===K?void 0:K.title),A=!!(R&&(null===
V||void 0===V?0:V.accountId)),B="${i18n.help}"===(null===K||void 0===K?void 0:K.title)||"support.html"===(null===K||void 0===K?void 0:K.url),H=!(B&&!V&&"public"===g.access&&(N||!N&&g.customBaseUrl));R=!R&&!B||R&&!A||B&&!H;A=null===(G=K.title)||void 0===G?void 0:G.indexOf("${i18n.");G=null===(I=K.title)||void 0===I?void 0:I.indexOf("}");I=-1<A&&-1<G?""+O[K.title.substring(A+7,G)]:K.title;if(K.url){-1===K.url.indexOf("http")&&-1===K.url.indexOf("mailto:")&&n&&(K.url="support.html"===K.url?g.helpBase||
""+b["default"].baseUrl+K.url:""+b["default"].baseUrl+K.url);if("${i18n.help}"===K.title||"support.html"===K.url)K.url=g.helpBase;R&&D.push({href:K.url,target:"_blank",title:I})}else N&&"contactUs"===K.type?(G=b["default"].portalName||"ArcGIS.com",R=escape(J),K="mailto:"+K.email,D.push({id:f+"_contactEsri",href:K+('?subject\x3d"A comment about '+G+'"\x26body\x3d"I have the following comment about the ')+(G+" Web site. %0AReferring page: "+R+' %0A %0A(Please provide as much detail as possible. Note: Contact Us is not meant for obtaining technical support or general product information.)"'),
title:I})):"reportAbuse"===K.type&&(R=escape(J),K="mailto:"+K.email+'?subject\x3d"Concerns about an item"',D.push({href:K+('\x26body\x3d"I have concerns about the following. %0AReferring page: '+R+" %0A %0A(Please describe your concerns. If you have concerns about a particular item, it's best to click the 'Report Abuse' link while viewing the item description. Doing so will include the URL to the specific item in this e-mail.)\""),title:I}))});v(null===(F=null===(z=g.portalProperties)||void 0===z?
void 0:z.links)||void 0===F?void 0:F.contactUs,D)},v=function(z,F){F=null!==F&&void 0!==F?F:t;z=null!==z&&void 0!==z?z:{visible:!1,url:""};var O={id:f+"_customContactUs",href:z.url,title:d["default"].siteFooter.customContactUs,className:z.visible?"footer__contact-us":"footer__contact-us hide"},V=p["default"].findIndex(F,function(N){return N.id===f+"_customContactUs"});-1<V?F[V]=O:(V=p["default"].findIndex(F,function(N){return N.id===f+"_contactEsri"}),-1<V?F.splice(V,0,O):F.push(O));w(F)};h=f+"_links";
var x=n?"\x26nbsp;. ":"",y=t.filter(function(z){return!z.className||-1===z.className.indexOf("hide")}),C=y.map(function(z,F){var O,V,N,J=null!==(O=z.id)&&void 0!==O?O:f+"_link"+F;O=z.href;var D=null!==(V=z.target)&&void 0!==V?V:"";V=null!==(N=z.className)&&void 0!==N?N:"";N=F===y.length-1;return a.h(a.Fragment,null,a.h("a",{id:J,href:O,className:V,target:D},z.title),N?null:a.h("span",null,x))});return a.h("div",{"class":"padding-leader-2 footer text-center padding-trailer-1 font-size--2 text-light-gray",
role:"contentinfo"},a.h("span",{id:h,"class":"esriItemLinks"},C),a.h("div",{"class":"esri-footer-barrier"}))}})},"arcgisonline/pages/item/widgets/_datasets":function(){define("require exports tslib dojo/Deferred arcgisonline/tsutils/declareDecorator dijit/_TemplatedMixin dijit/_WidgetBase preact arcgisonline/pages/item/components/bigdatafileshare/Datasets".split(" "),function(e,U,q,b,l,p,r,a,c){Object.defineProperty(U,"__esModule",{value:!0});b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);
r=q.__importDefault(r);c=q.__importDefault(c);e=function(){function d(){this.templateString='\x3cdiv class\x3d"datasetsWrapper"\x3e\x3cdiv id\x3d"datasetsTab"\x3e\x3c/div\x3e\x3cdiv\x3e'}d.prototype.startup=function(){this.inherited(arguments);var h=new b["default"];h.resolve(!0);return h};d.prototype.destroy=function(){this.inherited(arguments)};d.prototype.postCreate=function(){a.render(a.h(c["default"],{url:this.item.url,isOwner:this.item.isOwner}),this.domNode.querySelector("#datasetsTab"))};
return d=q.__decorate([l["default"](r["default"],p["default"])],d)}();U["default"]=e})},"arcgisonline/pages/item/components/bigdatafileshare/Datasets":function(){define("require exports tslib preact arcgisonline/sharing/util arcgisonline/pages/utils/arrays arcgisonline/pages/utils/clone ./DataSyncing ./DataFiltering ./DatasetsHeader ./DatasetsTable ./DatasetsPagination ./PropertyEditing ./AdvancedSettings ./NotificationModal dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),function(e,U,q,b,l,p,
r,a,c,d,h,f,g,n,m,t){Object.defineProperty(U,"__esModule",{value:!0});l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);e=function(w){function u(){var v=null!==w&&w.apply(this,arguments)||this;v.state={isSyncDisabled:!1,dataFilterText:"",datasetsStatus:"downloading",datasetsSource:[],
datasetsForRendering:[],dataSortOrder:"ascend",selectedDataItemIDMap:{},matchedDataItemNum:0,shouldDisplayDeleteIcon:!1,isDeletingDataset:!1,counts:{start:0,num:0,total:0},itemPerPage:20,shouldDisplayPagination:!1,shouldDisplayAdvancedSetting:!1,datasetsManifestStatus:"downloading",datasetsManifest:[],isManifestActive:!1,activeManifestName:"",isSidebarDisabled:!0,isNotificationModalActive:!1,alertIndicator:{alertIndicatorActive:!1,alertIndicatorColor:"",alertIndicatorInfo:""}};v.datasetsRequestURL=
"";v.manifestRequestURL="";v.manifestAdminURL="";v.hintsAdminURL="";v.manifestRegenerateURL="";v.portalURL="";v.adminURL="";v.globalDataFilterText="";v.filterTextLength=0;return v}q.__extends(u,w);u.prototype.componentDidMount=function(){this.generateURLs();this.requestDatasets();this.requestDatasetsManifest()};u.prototype.generateURLs=function(){var v=this.props.url.split("/"),x=v[0]+"//"+v[2]+"/"+v[3],y=v.filter(function(C){return"bigDataFileShares"===C.substring(0,17)})[0];v=y.split("_")[0];y=
y.split("_").slice(1).join("_");v=v+"/"+y;this.adminURL=x+"/admin/data/items/"+v;this.datasetsRequestURL=this.props.url;this.manifestRequestURL=this.props.url+"/manifest";this.manifestAdminURL=this.adminURL+"/manifest";this.hintsAdminURL=this.adminURL+"/hints";this.manifestRegenerateURL=this.manifestAdminURL+"/regenerate";x=this.adminURL.split("/");this.portalURL=x[0]+"//"+x[2]+":6443/arcgis/admin/data/items/"+v};u.prototype.regenerateManifestFromServer=function(){var v=this;l["default"].request({url:this.adminURL},
{useProxy:l["default"].shouldUseProxy(this.adminURL)}).then(function(x){x?v.regenerateDatastoreFromServer(JSON.stringify(x)):v.regenerateManifestFromPortal()},function(x){v.regenerateManifestFromPortal()})};u.prototype.regenerateManifestFromPortal=function(){var v=this;l["default"].request({url:this.portalURL},{useProxy:l["default"].shouldUseProxy(this.portalURL)}).then(function(x){x?v.regenerateDatastoreFromPortal(JSON.stringify(x)):v.syncupErrorHandler()},function(x){v.syncupErrorHandler()})};u.prototype.regenerateDatastoreFromServer=
function(v){var x=this;l["default"].request({url:this.manifestRegenerateURL,content:{item:v}},{useProxy:l["default"].shouldUseProxy(this.manifestRegenerateURL),usePost:!0}).then(function(y){"success"===(null===y||void 0===y?void 0:y.status)?x.syncupSuccessHandler():x.syncupErrorHandler()},function(y){x.syncupErrorHandler()})};u.prototype.regenerateDatastoreFromPortal=function(v){var x=this;l["default"].request({url:this.portalURL+"/manifest/regenerate",content:{item:v}},{useProxy:l["default"].shouldUseProxy(this.portalURL+
"/manifest/regenerate"),usePost:!0}).then(function(y){"success"===(null===y||void 0===y?void 0:y.status)?x.syncupSuccessHandler():x.syncupErrorHandler()},function(y){x.syncupErrorHandler()})};u.prototype.syncupSuccessHandler=function(){var v=this;this.displayNotificationIndicator(!0,t["default"].itemProperties.notificationIndicator.alertIndicatorColor.green,t["default"].itemProperties.notificationIndicator.alertIndicatorInfo.datasetSyncUp.success);var x=(new Date).getTime(),y=setInterval(function(){3E4<
(new Date).getTime()-x?clearInterval(y):(v.requestDatasets(),v.requestDatasetsManifest())},5E3)};u.prototype.syncupErrorHandler=function(){this.displayNotificationIndicator(!0,t["default"].itemProperties.notificationIndicator.alertIndicatorColor.red,t["default"].itemProperties.notificationIndicator.alertIndicatorInfo.datasetSyncUp.failure);this.requestDatasets();this.requestDatasetsManifest()};u.prototype.requestDatasets=function(){var v=this,x=this.datasetsRequestURL;l["default"].request({url:x},
{useProxy:l["default"].shouldUseProxy(x)}).then(function(y){y=null===y||void 0===y?void 0:y.children;y.forEach(function(C){C.isItemFiltered=!0});v.setState({datasetsStatus:"success",datasetsSource:r["default"](y),datasetsForRendering:r["default"](y),shouldDisplayPagination:!0,counts:{start:1,num:v.state.itemPerPage,total:y.length},isSyncDisabled:!1})},function(y){v.setState({datasetsStatus:"fail",shouldDisplayPagination:!1,counts:{start:0,num:0,total:0},isSyncDisabled:!1})})};u.prototype.requestDatasetsManifest=
function(){var v=this,x=this.manifestRequestURL;l["default"].request({url:x},{useProxy:l["default"].shouldUseProxy(x)}).then(function(y){v.setState({datasetsManifestStatus:"success",datasetsManifest:r["default"](y.datasets),isSidebarDisabled:!1})},function(y){v.setState({datasetsManifestStatus:"fail",isSidebarDisabled:!0})})};u.prototype.syncDatasets=function(v){this.setState({selectedDataItemIDMap:{},shouldDisplayDeleteIcon:!1,dataFilterText:"",isSyncDisabled:v,datasetsStatus:"downloading",datasetsManifestStatus:"downloading",
dataSortOrder:"ascend",shouldDisplayPagination:!1,counts:{start:0,num:0,total:0},itemPerPage:20,shouldDisplayAdvancedSetting:!1});this.regenerateManifestFromServer()};u.prototype.openEditingModal=function(v){this.setState({isManifestActive:!0,activeManifestName:v})};u.prototype.selectDataItem=function(v){var x=r["default"](this.state.selectedDataItemIDMap),y=!1;x[v]?(delete x[v],this.state.datasetsForRendering.forEach(function(C){C.isItemFiltered&&p["default"].includes(Object.keys(x),C.name)&&(y=
!0)})):(x[v]=v,y=!0);this.setState({selectedDataItemIDMap:x,shouldDisplayDeleteIcon:y})};u.prototype.flipSortOrder=function(v){this.setState({dataSortOrder:"ascend"===v?"descend":"ascend"})};u.prototype.deleteEmptyGeometryZField=function(v){v.forEach(function(x){var y,C,z;""===(null===(z=null===(C=null===(y=null===x||void 0===x?void 0:x.geometry)||void 0===y?void 0:y.fields)||void 0===C?void 0:C[2])||void 0===z?void 0:z.name)&&x.geometry.fields.pop()});return v};u.prototype.deleteDatasetItemFromServer=
function(v){var x=this;this.setState({isDeletingDataset:v});var y=r["default"](this.state.selectedDataItemIDMap),C=r["default"](this.state.datasetsManifest);C=C.filter(function(J){return!y[J.name]});v=this.manifestAdminURL+"/update";var z={};z.datasets=this.deleteEmptyGeometryZField(C);l["default"].request({url:v,content:{fileData:JSON.stringify(z)}},{useProxy:l["default"].shouldUseProxy(v),usePost:!0}).then(function(J){"success"===J.status?O():F(z)},function(J){F(z)});var F=function(J){var D=x.portalURL+
"/manifest/update";l["default"].request({url:D,content:{fileData:JSON.stringify(J)}},{useProxy:l["default"].shouldUseProxy(D),usePost:!0}).then(function(K){"success"===K.status?O():V()},function(K){V()})},O=function(){x.displayNotificationIndicator(!0,t["default"].itemProperties.notificationIndicator.alertIndicatorColor.green,t["default"].itemProperties.notificationIndicator.alertIndicatorInfo.manifestDelete.success);N()},V=function(){x.displayNotificationIndicator(!0,t["default"].itemProperties.notificationIndicator.alertIndicatorColor.red,
t["default"].itemProperties.notificationIndicator.alertIndicatorInfo.manifestDelete.failure);x.setState({datasetsManifest:x.state.datasetsManifest,isDeletingDataset:!1})},N=function(){var J=r["default"](x.state.datasetsForRendering),D=x.state.matchedDataItemNum;if(2<x.filterTextLength){J=J.filter(function(A){return A.isItemFiltered&&y[A.name]?(D--,delete y[A.name],!1):!0});var K=D;var G="success"}else G=J.length-Object.keys(y).length,J=J.filter(function(A){return y[A.name]?(delete y[A.name],!1):!0}),
K=G,G=0===K?"deleted":x.state.datasetsStatus;var I=0===K?0:x.state.counts.num,R=x.recalculatePagination(K,I);x.setState({datasetsManifest:C,datasetsForRendering:J,datasetsStatus:G,counts:{start:R.start,num:I,total:K},matchedDataItemNum:D,selectedDataItemIDMap:y,shouldDisplayPagination:R.shouldDisplayPagination,shouldDisplayDeleteIcon:!1,isDeletingDataset:!1})}};u.prototype.onFilterChanged=function(v){var x=this,y=v.trim();this.filterTextLength=y.length;2>=this.filterTextLength&&(y="");if(y!==this.globalDataFilterText){this.globalDataFilterText=
y;y=r["default"](this.state.datasetsForRendering);var C=this.filterDataSource(y);y=C.datasetsForRendering;C=C.filteredDatasets.length;var z=0===C?0:this.state.itemPerPage;var F=this.recalculatePagination(C,z),O=F.shouldDisplayPagination;F={start:F.start,num:z,total:C};this.globalDataFilterText?(y=this.processFilteredResults(y),z="success"):(z=0===C?"deleted":this.state.datasetsStatus,F.total=C);var V=!1;y.forEach(function(N){N.isItemFiltered&&p["default"].includes(Object.keys(x.state.selectedDataItemIDMap),
N.name)&&(V=!0)});this.setState({counts:F,dataFilterText:v,datasetsStatus:z,datasetsForRendering:y,matchedDataItemNum:C,shouldDisplayPagination:O,shouldDisplayDeleteIcon:V})}else this.setState({dataFilterText:v})};u.prototype.filterDataSource=function(v){var x=this,y=v.filter(function(C){return x.doesFilterMatch(C)});return{datasetsForRendering:v,filteredDatasets:y}};u.prototype.doesFilterMatch=function(v){if(this.globalDataFilterText){var x=this.globalDataFilterText.split(" ");v.isItemFiltered=x.some(function(y){return-1<
v.name.toLowerCase().indexOf(y.toLocaleLowerCase())})}else v.isItemFiltered=!0;return v.isItemFiltered};u.prototype.processFilteredResults=function(v){var x=[],y=0,C=v.length-1;v.forEach(function(z){z.isItemFiltered?(x[y]=z,y++):(x[C]=z,C--)});return x};u.prototype.changePage=function(v){this.setState({counts:v})};u.prototype.setItemPerPage=function(v){var x=this.state.counts.total;v=0===x?0:Number(v);x={start:this.recalculatePagination(x,v).start,num:v,total:x};this.setState({itemPerPage:v,counts:x})};
u.prototype.recalculatePagination=function(v,x){if(0===v)return{start:0,shouldDisplayPagination:!1};var y=Math.ceil(this.state.counts.start/this.state.counts.num);return{start:Math.ceil(v/x)>=y?(y-1)*x+1:1,shouldDisplayPagination:!0}};u.prototype.onToggleAdvancedSetting=function(v){this.setState({shouldDisplayAdvancedSetting:v})};u.prototype.viewManifest=function(){var v=this.deleteEmptyGeometryZField(r["default"](this.state.datasetsManifest));return JSON.stringify(v,null,2)};u.prototype.closeEditingModal=
function(v){this.setState({isManifestActive:v})};u.prototype.updateManifest=function(v){this.setState({datasetsManifest:v})};u.prototype.displayNotificationIndicator=function(v,x,y){this.setState({isNotificationModalActive:!0,alertIndicator:{alertIndicatorActive:v,alertIndicatorColor:x,alertIndicatorInfo:y}})};u.prototype.closeNotificationIndicator=function(v){this.setState({isNotificationModalActive:v})};u.prototype.render=function(){var v=this.state,x=v.isSyncDisabled,y=v.datasetsStatus,C=v.datasetsForRendering,
z=v.dataFilterText,F=v.shouldDisplayDeleteIcon,O=v.isDeletingDataset,V=v.dataSortOrder,N=v.counts,J=v.selectedDataItemIDMap,D=v.shouldDisplayPagination,K=v.itemPerPage,G=v.activeManifestName,I=v.isSidebarDisabled,R=v.datasetsManifestStatus,A=v.datasetsManifest,B=v.shouldDisplayAdvancedSetting;v=v.alertIndicator;var H=this.props.isOwner;return b.h(b.Fragment,null,b.h("div",{"class":"datasetsHeader"},b.h("div",{"class":"grid-container"},b.h("div",{"class":"column-24 flex"},H&&b.h(a["default"],{entryComponent:"datasets",
isSyncDisabled:x,syncDatasets:this.syncDatasets.bind(this)}),b.h(c["default"],{page:"datasets",datasetsStatus:y,datasetsForRendering:C,dataFilterText:z,onFilterChanged:this.onFilterChanged.bind(this)})))),b.h("div",{"class":"grid-container"},b.h(d["default"],{isOwner:H,shouldDisplayDeleteIcon:F,isDeletingDataset:O,counts:N,deleteDatasetItem:this.deleteDatasetItemFromServer.bind(this)}),b.h(h["default"],{datasetsStatus:y,datasetsForRendering:C,datasetsManifest:A,dataSortOrder:V,counts:N,selectedDataItemIDMap:J,
openEditingModal:this.openEditingModal.bind(this),selectDataItem:this.selectDataItem.bind(this),flipSortOrder:this.flipSortOrder.bind(this)})),b.h(f["default"],{shouldDisplayPagination:D,counts:N,itemPerPage:K,changePage:this.changePage.bind(this),setItemPerPage:this.setItemPerPage.bind(this)}),this.state.isManifestActive&&b.h(g["default"],{isOwner:H,activeManifestName:G,isSidebarDisabled:I,datasetsManifestStatus:R,datasetsManifest:A,manifestAdminURL:this.manifestAdminURL,portalURL:this.portalURL,
displayNotificationIndicator:this.displayNotificationIndicator.bind(this),closeEditingModal:this.closeEditingModal.bind(this),updateManifest:this.updateManifest.bind(this)}),H&&b.h(n["default"],{displayNotificationIndicator:this.displayNotificationIndicator.bind(this),portalURL:this.portalURL,manifestAdminURL:this.manifestAdminURL,hintsAdminURL:this.hintsAdminURL,shouldDisplayAdvancedSetting:B,viewManifest:this.viewManifest.bind(this),onToggleAdvancedSetting:this.onToggleAdvancedSetting.bind(this)}),
this.state.isNotificationModalActive&&b.h(m["default"],{alertIndicator:v,closeNotificationIndicator:this.closeNotificationIndicator.bind(this)}))};return u}(b.Component);U["default"]=e})},"arcgisonline/pages/item/components/bigdatafileshare/DataSyncing":function(){define(["require","exports","tslib","preact","dojo/i18n!arcgisonline/nls/arcgisonline"],function(e,U,q,b,l){Object.defineProperty(U,"__esModule",{value:!0});l=q.__importDefault(l);e=function(p){function r(){return null!==p&&p.apply(this,
arguments)||this}q.__extends(r,p);r.prototype.syncDatasets=function(){this.props.syncDatasets(!0)};r.prototype.render=function(){var a=this.props,c=a.isSyncDisabled;a=a.entryComponent;return b.h(b.Fragment,null,b.h("div",{"class":"sync-button flex flex-center"},b.h("div",{"class":"full-width"},b.h("div",{"class":"trailer-quarter leader-quarter margin-right-half margin-left-0 flex-1"},b.h("button",{"class":"btn btn-clear btn-fill",disabled:c,onClick:this.syncDatasets.bind(this)},c?"datasets"===a?l["default"].itemProperties.datasetsSync.syncing:
l["default"].itemProperties.datasetsSync.adding:"datasets"===a?l["default"].itemProperties.datasetsSync.sync:l["default"].itemProperties.datasetsSync.addOutputsTemplate)))))};return r}(b.Component);U["default"]=e})},"arcgisonline/pages/item/components/bigdatafileshare/DataFiltering":function(){define(["require","exports","tslib","preact","dojo/i18n!arcgisonline/nls/arcgisonline"],function(e,U,q,b,l){Object.defineProperty(U,"__esModule",{value:!0});l=q.__importDefault(l);e=function(p){function r(){return null!==
p&&p.apply(this,arguments)||this}q.__extends(r,p);r.prototype.onFilterChanged=function(a){a=a.target.value.toLowerCase();this.props.onFilterChanged(a)};r.prototype.render=function(){var a=this.props,c=a.page;a=a.dataFilterText;return b.h(b.Fragment,null,b.h("div",{"class":"filtering-section flex"},b.h("span",{"class":"filtering-section-icon"},b.h("svg",{viewBox:"0 0 24 24",width:"24",height:"24","class":"icon-inline"},b.h("path",{d:"M22.289 20.91l-6.847-6.846a7.524 7.524 0 1 0-1.419 1.409l6.852 6.852zM4 9.5A5.5 5.5 0 1 1 9.5 15 5.506 5.506 0 0 1 4 9.5z"}))),
b.h("div",{"class":"full-width position-relative"},b.h("input",{type:"search",placeholder:"datasets"===c?l["default"].itemProperties.datasetsFiltering.searchDatasets:l["default"].itemProperties.datasetsFiltering.searchOutputTemplates,"class":"filtering-section-input",onInput:this.onFilterChanged.bind(this),value:a}))))};return r}(b.Component);U["default"]=e})},"arcgisonline/pages/item/components/bigdatafileshare/DatasetsHeader":function(){define("require exports tslib preact dojo/i18n!arcgisonline/nls/arcgisonline arcgisonline/pages/pageUtil".split(" "),
function(e,U,q,b,l,p){Object.defineProperty(U,"__esModule",{value:!0});l=q.__importDefault(l);p=q.__importDefault(p);e=function(r){function a(){return null!==r&&r.apply(this,arguments)||this}q.__extends(a,r);a.prototype.deleteDatasetItem=function(){this.props.deleteDatasetItem(!0)};a.prototype.displayPageInfo=function(){return p["default"].getPageRangeString({start:0===this.props.counts.total?0:this.props.counts.start,end:0===this.props.counts.total?0:this.props.counts.start-1+this.props.counts.num>=
this.props.counts.total?this.props.counts.total:this.props.counts.start-1+this.props.counts.num,total:this.props.counts.total})};a.prototype.render=function(){var c=this.props,d=c.isOwner,h=c.shouldDisplayDeleteIcon,f=(c=c.isDeletingDataset)?" dataset-deleting":"";return b.h(b.Fragment,null,b.h("div",{"class":"column-24 clearfix padding-leader-1 padding-trailer-quarter flex"},b.h("div",{"class":"font-size--1 inline-block flex-1 flex flex-align-center filter-status-wrap"},b.h("span",{"class":"padding-right-1 padding-left-0 padding-leader-quarter padding-trailer-quarter font-size--2 flex-0 break-word border-box"},
this.displayPageInfo()),d&&h&&b.h("div",{"class":"datasets-delete-icon"+f,onClick:this.deleteDatasetItem.bind(this)},b.h("span",null,c?b.h(b.Fragment,null,b.h("calcite-loader",{"class":"margin-right-quarter",label:"deletingDataset",scale:"m",inline:!0,active:c}),b.h("calcite-icon",{"class":"icon-ui-trash",scale:"s"}),l["default"].itemProperties.datasetsDelete.deleting):b.h(b.Fragment,null,b.h("calcite-icon",{"class":"icon-ui-trash",scale:"s"}),l["default"].itemProperties.datasetsDelete["delete"]))))))};
return a}(b.Component);U["default"]=e})},"arcgisonline/pages/item/components/bigdatafileshare/DatasetsTable":function(){define(["require","exports","tslib","preact","dojo/i18n!arcgisonline/nls/arcgisonline"],function(e,U,q,b,l){Object.defineProperty(U,"__esModule",{value:!0});l=q.__importDefault(l);e=function(p){function r(){return null!==p&&p.apply(this,arguments)||this}q.__extends(r,p);r.prototype.sortDatasetByName=function(a){var c=this;a.sort(function(d,h){if(d.isItemFiltered&&h.isItemFiltered)return d.name.toLowerCase()>
h.name.toLowerCase()?"ascend"===c.props.dataSortOrder?1:-1:d.name.toLowerCase()<h.name.toLowerCase()?"ascend"===c.props.dataSortOrder?-1:1:0});return a};r.prototype.processDatasets=function(a){var c=this;return a.map(function(d,h){d.isItemOnCurrentPage=h>=c.props.counts.start-1&&h<c.props.counts.start+c.props.counts.num-1?!0:!1;return d})};r.prototype.configureDatasetIcon=function(a){var c="",d="",h="",f="";this.props.datasetsManifest.forEach(function(g){var n,m,t,w,u;g.name===a.name&&("esriGeometryPoint"===
(null===(n=null===g||void 0===g?void 0:g.geometry)||void 0===n?void 0:n.geometryType)?(c="pin",d="Points"):"esriGeometryPolygon"===(null===(m=null===g||void 0===g?void 0:g.geometry)||void 0===m?void 0:m.geometryType)?(c="polygon",d="Areas"):"esriGeometryPolyline"===(null===(t=null===g||void 0===g?void 0:g.geometry)||void 0===t?void 0:t.geometryType)?(c="line",d="Lines"):"None"===(null===(w=null===g||void 0===g?void 0:g.geometry)||void 0===w?void 0:w.geometryType)?(c="table",d="Table"):"table"===(null===
a||void 0===a?void 0:a.type)&&(c="table",d="Table"),h=(g=null===(u=null===g||void 0===g?void 0:g.time)||void 0===u?void 0:u.timeType)||"icon-grey-out-color-class",f=g?"Time Enabled: "+g:"No Time Enabled")});return{geometryIconName:c,geometryIconTitle:d,timeIconClass:h,timeIconTitle:f}};r.prototype.createDatasetsTSX=function(a,c){var d=this,h=this.sortDatasetByName(a);h=this.processDatasets(h).map(function(t){var w=t.isItemFiltered&&t.isItemOnCurrentPage?"":" hide",u=!!d.props.selectedDataItemIDMap[t.name],
v=d.configureDatasetIcon(t),x=v.geometryIconName,y=v.geometryIconTitle,C=v.timeIconClass;v=v.timeIconTitle;return b.h("div",{key:t.name,"class":"datasets-table-row"+w,role:"row"},b.h("label",{"class":"datasets-table-cell datasets-table-checkbox",role:"cell"},b.h("input",{type:"checkbox",checked:u,"aria-label":"Select Item",onChange:d.selectDataItem.bind(d,t.name)})),b.h("span",{"class":"datasets-table-cell datasets-table-cell-medium",role:"cell"},x&&b.h("calcite-icon",{icon:x,"class":"dataset-icon",
scale:"s",title:y}),b.h("calcite-icon",{icon:"clock","class":"dataset-icon "+C,scale:"s",title:v}),b.h("span",{"class":"datasets-table-cell-name"},t.name)),b.h("span",{"class":"datasets-table-cell datasets-table-cell-medium datasets-table-edit",onClick:d.openEditingModal.bind(d,t.name),role:"cell"},b.h("calcite-icon",{"class":"icon-ui-edit"}),b.h("span",null,l["default"].itemProperties.datasetsTable.edit)))});var f="ascend"===this.props.dataSortOrder?["0 6px 8px 6px","transparent transparent #007ac2 transparent",
"0.5em","0.75em"]:["8px 6px 0 6px","#007ac2 transparent transparent transparent","0.5em","1em"],g=f[0],n=f[1],m=f[2];f=f[3];h=b.h("div",{key:"datasetkey","class":"datasets-table"},b.h("div",{"class":"datasets-table-head",role:"rowgroup"},b.h("div",{"class":"datasets-table-row datasets-table-row-header",role:"row"},b.h("span",{"class":"datasets-table-cell datasets-table-cell-th datasets-table-cell-extra-small",role:"columnheader"},b.h("div",{"class":"datasets-table-cell-sort"})),b.h("span",{"class":"datasets-table-cell datasets-table-cell-th datasets-table-cell-medium",
role:"columnheader",onClick:this.flipSortOrder.bind(this)},b.h("div",{"class":"datasets-table-cell-sort datasets-table-header"},l["default"].itemProperties.datasetsTable.dataset),b.h("div",{style:{content:"",width:0,height:0,position:"absolute","border-style":"solid","border-width":g,"border-color":n,right:m,top:f}})),b.h("span",{"class":"datasets-table-cell datasets-table-cell-th datasets-table-cell-medium",role:"columnheader"},b.h("div",{"class":"datasets-table-cell-sort"},l["default"].itemProperties.datasetsTable.operation)))),
b.h("div",{"class":"datasets-table-rows",role:"rowgroup"},h));g="";"downloading"===c?g=l["default"].itemProperties.datasetsTable.datasetsStatusMessage.downloading:"fail"===c?g=l["default"].itemProperties.datasetsTable.datasetsStatusMessage.fail:"success"===c?0===this.props.counts.total&&(h=b.h("div",{"class":"text-center leader-1 text-constrain margin-auto"},l["default"].itemProperties.datasetsTable.datasetsStatusMessage.success)):"deleted"===c&&(h=b.h("div",{"class":"text-center leader-1 text-constrain margin-auto"},
l["default"].itemProperties.datasetsTable.datasetsStatusMessage.deleted));""!==g&&(h=b.h("div",{"class":"padding-leader-half"},b.h("em",null,g)));return h};r.prototype.flipSortOrder=function(){this.props.flipSortOrder(this.props.dataSortOrder)};r.prototype.selectDataItem=function(a){this.props.selectDataItem(a)};r.prototype.openEditingModal=function(a){this.props.openEditingModal(a)};r.prototype.render=function(){var a=this.props;a=this.createDatasetsTSX(a.datasetsForRendering,a.datasetsStatus);return b.h(b.Fragment,
null,b.h("div",{"class":"column-24 padding-leader-half padding-trailer-5 datasets-table-wrapper"},a))};return r}(b.Component);U["default"]=e})},"arcgisonline/pages/item/components/bigdatafileshare/DatasetsPagination":function(){define(["require","exports","tslib","preact","dojo/i18n!arcgisonline/nls/arcgisonline"],function(e,U,q,b,l){Object.defineProperty(U,"__esModule",{value:!0});l=q.__importDefault(l);e=function(p){function r(){return null!==p&&p.apply(this,arguments)||this}q.__extends(r,p);r.prototype.changePage=
function(a){this.props.changePage(a.detail)};r.prototype.setItemPerPage=function(a){this.props.setItemPerPage(a.target.value)};r.prototype.render=function(){var a=this.props,c=a.counts,d=a.itemPerPage;return b.h(b.Fragment,null,a.shouldDisplayPagination&&b.h("div",{"class":"grid-container"},b.h("div",{"class":"flex text-center trailer-half padding-leader-half"},b.h("div",{"class":"pagination-space-wrapper"},b.h("calcite-pagination",{"class":"datasetsPagination",start:c.start,num:c.num,total:c.total,
oncalcitePaginationUpdate:this.changePage.bind(this)})),b.h("div",{"class":"itemPerPage flex"},b.h("div",{"class":"padding-leader-quarter padding-right-half text-right pagination-space-wrapper"},l["default"].itemProperties.pagination.itemPerPage),b.h("div",{"class":"pagination-space-wrapper"},b.h("select",{"class":"inline-block select-full",value:d,onChange:this.setItemPerPage.bind(this)},b.h("option",{value:"20"},"20"),b.h("option",{value:"60"},"60"),b.h("option",{value:"100"},"100")))))))};return r}(b.Component);
U["default"]=e})},"arcgisonline/pages/item/components/bigdatafileshare/PropertyEditing":function(){define("require exports tslib preact dojo/i18n!arcgisonline/nls/arcgisonline arcgisonline/pages/components/BodyAppender arcgisonline/sharing/util ../../../utils/arrays arcgisonline/pages/utils/clone ../../../../esriGeowConfig".split(" "),function(e,U,q,b,l,p,r,a,c,d){Object.defineProperty(U,"__esModule",{value:!0});l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);
c=q.__importDefault(c);d=q.__importDefault(d);e=function(h){function f(){var g=null!==h&&h.apply(this,arguments)||this;g.state={datasetsManifest:[],datasetsManifestStatus:"downloading",activeManifestIndex:0,modalActive:!1,isSidebarDisabled:!0,sidebarMenu:[{label:l["default"].itemProperties.datasetsManifest.sidebarMenu.fields,value:"Fields"},{label:l["default"].itemProperties.datasetsManifest.sidebarMenu.geometry,value:"Geometry"},{label:l["default"].itemProperties.datasetsManifest.sidebarMenu.time,
value:"Time"},{label:l["default"].itemProperties.datasetsManifest.sidebarMenu.file,value:"File"}],activeMenuItem:"Fields",isModalButtonDisabled:!1,progressIndicatorActive:!1,isReadOnly:!g.props.isOwner,isGeometryErrorActive:!1,isTimeErrorActive:!1,validationErrorType:"",timeTypeChanged:!1};g.originalDatasetsManifest=[];g.geometryFieldsListLength=0;g.hasGeometryValidationError=!1;g.hasTimeValidationError=!1;g.dataItemFields=[];g.availableTimeZones=[{canonicalID:"Etc/GMT+12"},{canonicalID:"Etc/GMT+11"},
{canonicalID:"Etc/GMT+10"},{canonicalID:"Pacific/Marquesas"},{canonicalID:"Etc/GMT+9"},{canonicalID:"Etc/GMT+8"},{canonicalID:"Etc/GMT+7"},{canonicalID:"Etc/GMT+6"},{canonicalID:"Etc/GMT+5"},{canonicalID:"Etc/GMT+4"},{canonicalID:"America/St_Johns"},{canonicalID:"Etc/GMT+3"},{canonicalID:"Etc/GMT+2"},{canonicalID:"Etc/GMT+1"},{canonicalID:"Etc/GMT"},{canonicalID:"UTC"},{canonicalID:"Etc/GMT-1"},{canonicalID:"Etc/GMT-2"},{canonicalID:"Etc/GMT-3"},{canonicalID:"Asia/Tehran"},{canonicalID:"Etc/GMT-4"},
{canonicalID:"Asia/Kabul"},{canonicalID:"Etc/GMT-5"},{canonicalID:"Asia/Colombo"},{canonicalID:"Asia/Kathmandu"},{canonicalID:"Etc/GMT-6"},{canonicalID:"Asia/Yangon"},{canonicalID:"Etc/GMT-7"},{canonicalID:"Etc/GMT-8"},{canonicalID:"Australia/Eucla"},{canonicalID:"Etc/GMT-9"},{canonicalID:"Australia/Adelaide"},{canonicalID:"Etc/GMT-10"},{canonicalID:"Australia/Lord_Howe"},{canonicalID:"Etc/GMT-11"},{canonicalID:"Etc/GMT-12"},{canonicalID:"Pacific/Chatham"},{canonicalID:"Etc/GMT-13"},{canonicalID:"Etc/GMT-14"},
{canonicalID:"custom"}];return g}q.__extends(f,h);f.prototype.componentDidMount=function(){this.originalDatasetsManifest=c["default"](this.props.datasetsManifest);this.setState({isSidebarDisabled:this.props.isSidebarDisabled,datasetsManifestStatus:this.props.datasetsManifestStatus,datasetsManifest:this.props.datasetsManifest});this.openEditingModal(this.props.activeManifestName)};f.prototype.convertFromEsriGeometryType=function(g){return"esriGeometryPoint"===g?"Point":"esriGeometryPolyline"===g?"Polyline":
"esriGeometryPolygon"===g?"Polygon":"None"};f.prototype.convertToEsriGeometryType=function(g){return"Point"===g?"esriGeometryPoint":"Polyline"===g?"esriGeometryPolyline":"Polygon"===g?"esriGeometryPolygon":"None"};f.prototype.retrieveDatasetProperty=function(g,n,m){var t;if(n[g]){m=n[g];g=m.format;n=m.geometry;var w=m.schema;m=m.time;var u=w.fields;this.dataItemFields=w.fields;w=(null===n||void 0===n?0:n.geometryType)?this.convertFromEsriGeometryType(n.geometryType):"None";var v=this.initializeTimeProperty(m),
x=v.timeInstantArr,y=v.timeIntervalStartArr,C=v.timeIntervalEndArr,z=v.timeZone,F=v.customTimeZone;v=v.timeType;"\t"===(null===g||void 0===g?void 0:g.fieldDelimiter)&&(g.fieldDelimiter=this.handleEscapeChars(g.fieldDelimiter));1===(null===(t=null===g||void 0===g?void 0:g.recordTerminator)||void 0===t?void 0:t.length)&&(g.recordTerminator=this.handleEscapeChars(g.recordTerminator));return{dataItemFields:u,geometry:n,geometryType:w,dataItemTime:m,timeInstantArr:x,timeIntervalStartArr:y,timeIntervalEndArr:C,
timeZone:z,customTimeZone:F,timeType:v,fileFormat:g}}u=[];this.dataItemFields=[];n={};m={};x=[];y=[];C=[];g={};return{dataItemFields:u,geometry:n,geometryType:"Point",dataItemTime:m,timeInstantArr:x,timeIntervalStartArr:y,timeIntervalEndArr:C,timeZone:"",customTimeZone:"",timeType:"instant",fileFormat:g}};f.prototype.handleEscapeChars=function(g){g=JSON.stringify(g);return g=g.substring(1,g.length-1)};f.prototype.createDatasetsPropertyMenu=function(g,n){var m=this;return g.map(function(t,w){return b.h("button",
{key:w,"class":"btn-link btn-link-darker-gray font-size--1 data-property-sidebar-menu-item"+(m.state.activeMenuItem===t.value?" data-property-sidebar-menu-item--active":""),disabled:n,onClick:m.checkSidebarItem.bind(m,t.value)},t.label)})};f.prototype.openEditingModal=function(g){var n=0;c["default"](this.props.datasetsManifest).forEach(function(m,t){m.name===g&&(n=t)});this.renderEditingModal(n,this.props.datasetsManifest,this.state.activeMenuItem)};f.prototype.renderEditingModal=function(g,n,m){this.setState({datasetsManifest:n,
modalActive:!0,activeManifestIndex:g,isModalButtonDisabled:!1,activeMenuItem:m})};f.prototype.closeEditingModal=function(g){if(this.state.modalActive){var n=[];"save"===g?(n=c["default"](this.state.datasetsManifest),this.originalDatasetsManifest=c["default"](this.state.datasetsManifest)):n=c["default"](this.originalDatasetsManifest);this.setState({modalActive:!1,activeMenuItem:"Fields",datasetsManifest:n,isGeometryErrorActive:!1,isTimeErrorActive:!1,validationErrorType:""})}this.props.closeEditingModal(!1)};
f.prototype.createFieldFormatTSX=function(g){var n=[l["default"].itemProperties.datasetsManifest.fields.integer,l["default"].itemProperties.datasetsManifest.fields.smallInteger,l["default"].itemProperties.datasetsManifest.fields.bigInteger,l["default"].itemProperties.datasetsManifest.fields.string,l["default"].itemProperties.datasetsManifest.fields["double"],l["default"].itemProperties.datasetsManifest.fields.date,l["default"].itemProperties.datasetsManifest.fields.single];a["default"].includes(["orc",
"parquet"],g)&&n.push(l["default"].itemProperties.datasetsManifest.fields.binary);return n.map(function(m){return b.h("option",{value:m},m)})};f.prototype.isFieldDisabled=function(g,n){return"delimited"!==g&&!a["default"].includes(["csv","orc","parquet"],n)||this.state.isReadOnly};f.prototype.createDataItemFieldsTSX=function(g,n,m){var t=this,w=n.type,u=n.extension,v=this.createFieldFormatTSX(u);g=g.map(function(x,y){var C="schema_value_"+t.state.activeManifestIndex+"_"+x.name+"_"+y;return b.h("tr",
{key:"key_"+t.state.activeManifestIndex+"_itemname_"+y},b.h("td",null," ",b.h("input",{name:"schema_name_"+t.state.activeManifestIndex+"_"+x.name+"_"+y,value:x.name,onChange:t.changeDataFieldName.bind(t,t.state.activeManifestIndex,y),disabled:t.isFieldDisabled(w,u)})," "),b.h("td",null," ",b.h("select",{"class":"select-full bdfs-select",name:C,value:t.convertFromEsriType(x.type),onChange:t.changeDataFieldType.bind(t,t.state.activeManifestIndex,y),disabled:t.isFieldDisabled(w,u)},v)," "))});g=b.h("table",
{"class":"table"},b.h("thead",null,b.h("tr",null,b.h("th",null," ",l["default"].itemProperties.datasetsManifest.fields.name," "),b.h("th",null," ",l["default"].itemProperties.datasetsManifest.fields.type," "))),b.h("tbody",null,g));n="";"downloading"===m?n=l["default"].itemProperties.datasetsManifest.statusMessage.downloading:"fail"===m&&(n=l["default"].itemProperties.datasetsManifest.statusMessage.fail);""!==n&&(g=b.h("div",{"class":"padding-leader-half"},b.h("em",null,n)));return g};f.prototype.convertFromEsriType=
function(g){if("esriFieldTypeBigInteger"===g)return l["default"].itemProperties.datasetsManifest.fields.bigInteger;if("esriFieldTypeSmallInteger"===g)return l["default"].itemProperties.datasetsManifest.fields.smallInteger;if("esriFieldTypeInteger"===g)return l["default"].itemProperties.datasetsManifest.fields.integer;if("esriFieldTypeSingle"===g)return l["default"].itemProperties.datasetsManifest.fields.single;if("esriFieldTypeString"===g)return l["default"].itemProperties.datasetsManifest.fields.string;
if("esriFieldTypeDouble"===g)return l["default"].itemProperties.datasetsManifest.fields["double"];if("esriFieldTypeBlob"===g)return l["default"].itemProperties.datasetsManifest.fields.binary;if("esriFieldTypeDate"===g)return l["default"].itemProperties.datasetsManifest.fields.date};f.prototype.convertToEsriItemType=function(g){if(g===l["default"].itemProperties.datasetsManifest.fields.bigInteger)return"esriFieldTypeBigInteger";if(g===l["default"].itemProperties.datasetsManifest.fields.smallInteger)return"esriFieldTypeSmallInteger";
if(g===l["default"].itemProperties.datasetsManifest.fields.integer)return"esriFieldTypeInteger";if(g===l["default"].itemProperties.datasetsManifest.fields.single)return"esriFieldTypeSingle";if(g===l["default"].itemProperties.datasetsManifest.fields.string)return"esriFieldTypeString";if(g===l["default"].itemProperties.datasetsManifest.fields["double"])return"esriFieldTypeDouble";if(g===l["default"].itemProperties.datasetsManifest.fields.binary)return"esriFieldTypeBlob";if(g===l["default"].itemProperties.datasetsManifest.fields.date)return"esriFieldTypeDate"};
f.prototype.changeDataFieldName=function(g,n,m){m=m.target.value;var t=c["default"](this.state.datasetsManifest);t[g].schema.fields[n].name=m;this.setState({datasetsManifest:t})};f.prototype.changeDataFieldType=function(g,n,m){m=m.target.value;var t=c["default"](this.state.datasetsManifest);t[g].schema.fields[n].type=this.convertToEsriItemType(m);this.setState({datasetsManifest:t})};f.prototype.filterDataFields=function(g,n){if("XYZ"===n)g=g.filter(function(m){if("esriFieldTypeString"===m.type||"esriFieldTypeDouble"===
m.type||"esriFieldTypeBigInteger"===m.type)return m});else if("WKB"===n||"EsriShape"===n)g=g.filter(function(m){if("esriFieldTypeBlob"===m.type)return m});else if("WKT"===n||"GeoJSON"===n||"EsriJSON"===n)g=g.filter(function(m){if("esriFieldTypeString"===m.type)return m});this.geometryFieldsListLength=g.length;return this.createDataFieldsList(g)};f.prototype.createDataFieldsList=function(g){return g.map(function(n){return b.h("option",{value:n.name},n.name)})};f.prototype.createGeometryTSX=function(g,
n){var m=this,t=(null===n||void 0===n?0:n.spatialReference)?n.spatialReference:{},w=(null===n||void 0===n?0:n.fields)?n.fields:[],u=w?w.length:0;this.hasGeometryValidationError=!1;var v="",x="",y="",C="";if(3===u){if(""===w[0].name||""===w[1].name)this.hasGeometryValidationError=!0;"unavailable"===this.state.validationErrorType?(x=l["default"].itemProperties.bdfsValidation.geometry.unavailable.errorMessageX,y=l["default"].itemProperties.bdfsValidation.geometry.unavailable.errorMessageY):"unselected"===
this.state.validationErrorType&&(x=l["default"].itemProperties.bdfsValidation.geometry.unselected.errorMessageX,y=l["default"].itemProperties.bdfsValidation.geometry.unselected.errorMessageY);var z=this.filterDataFields(g,"XYZ");C="XYZ";u=["X","Y","Z"];var F=u.map(function(D,K){var G="";w.forEach(function(I){a["default"].includes(I.formats,D.toLocaleLowerCase())&&(G=I.name)});return b.h(b.Fragment,null,b.h("div",null,D+" "+l["default"].itemProperties.datasetsManifest.geometry.Field),0===K&&b.h(b.Fragment,
null,b.h("select",{"class":"select-full bdfs-select XYZ-geometry-field "+(m.state.isGeometryErrorActive&&""===G?" input-error":"")+" ",name:"geometryFieldsValue_"+K,value:G,disabled:m.state.isReadOnly,onChange:m.geometryFieldXYZUpdate.bind(m,K)},z),b.h("div",{"class":"input-error-message XYZ-geometry-field "+(m.state.isGeometryErrorActive&&""===G?" is-active":"")},x)),1===K&&b.h(b.Fragment,null,b.h("select",{"class":"select-full bdfs-select XYZ-geometry-field "+(m.state.isGeometryErrorActive&&""===
G?" input-error":""),name:"geometryFieldsValue_"+K,value:G,disabled:m.state.isReadOnly,onChange:m.geometryFieldXYZUpdate.bind(m,K)},z),b.h("div",{"class":"input-error-message XYZ-geometry-field "+(m.state.isGeometryErrorActive&&""===G?" is-active":"")},y)),2===K&&b.h("select",{"class":"select-full bdfs-select XYZ-geometry-field",name:"geometryFieldsValue_"+K,value:G,disabled:m.state.isReadOnly,onChange:m.geometryFieldXYZUpdate.bind(m,K)},z,b.h("option",{value:""})))})}else if(2===u){if(""===w[0].name||
""===w[1].name)this.hasGeometryValidationError=!0;"unavailable"===this.state.validationErrorType?(x=l["default"].itemProperties.bdfsValidation.geometry.unavailable.errorMessageX,y=l["default"].itemProperties.bdfsValidation.geometry.unavailable.errorMessageY):"unselected"===this.state.validationErrorType&&(x=l["default"].itemProperties.bdfsValidation.geometry.unselected.errorMessageX,y=l["default"].itemProperties.bdfsValidation.geometry.unselected.errorMessageY);var O=this.filterDataFields(g,"XYZ"),
V=c["default"](w);V.push({name:"",formats:["Z"]});C="XYZ";u=["X","Y","Z"];F=u.map(function(D,K){var G="";V.forEach(function(I){a["default"].includes(I.formats,D.toLocaleLowerCase())&&(G=I.name)});return b.h(b.Fragment,null,b.h("div",null,D+" "+l["default"].itemProperties.datasetsManifest.geometry.Field),0===K&&b.h(b.Fragment,null,b.h("select",{"class":"select-full bdfs-select XYZ-geometry-field "+(m.state.isGeometryErrorActive&&""===G?" input-error":""),name:"geometryFieldsValue_"+K,value:G,disabled:m.state.isReadOnly,
onChange:m.geometryFieldXYZUpdate.bind(m,K)},O),b.h("div",{"class":"input-error-message XYZ-geometry-field "+(m.state.isGeometryErrorActive&&""===G?" is-active":"")},x)),1===K&&b.h(b.Fragment,null,b.h("select",{"class":"select-full bdfs-select XYZ-geometry-field "+(m.state.isGeometryErrorActive&&""===G?" input-error":""),name:"geometryFieldsValue_"+K,value:G,disabled:m.state.isReadOnly,onChange:m.geometryFieldXYZUpdate.bind(m,K)},O),b.h("div",{"class":"input-error-message XYZ-geometry-field "+(m.state.isGeometryErrorActive&&
""===G?" is-active":"")},y)),2===K&&b.h("select",{"class":"select-full bdfs-select XYZ-geometry-field",name:"geometryFieldsValue_"+K,value:G,disabled:m.state.isReadOnly,onChange:m.geometryFieldXYZUpdate.bind(m,K)},O,b.h("option",{value:""})))})}else if(1===u){C=w[0].formats[0];""===w[0].name&&(this.hasGeometryValidationError=!0);"unavailable"===this.state.validationErrorType?"WKB"===C?v=l["default"].itemProperties.bdfsValidation.geometry.unavailable.errorMessageWKB:"EsriShape"===C?v=l["default"].itemProperties.bdfsValidation.geometry.unavailable.errorMessageEsriShape:
"GeoJSON"===C?v=l["default"].itemProperties.bdfsValidation.geometry.unavailable.errorMessageGeoJSON:"EsriJSON"===C?v=l["default"].itemProperties.bdfsValidation.geometry.unavailable.errorMessageEsriJSON:"WKT"===C&&(v=l["default"].itemProperties.bdfsValidation.geometry.unavailable.errorMessageWKT):"unselected"===this.state.validationErrorType&&("WKB"===C?v=l["default"].itemProperties.bdfsValidation.geometry.unselected.errorMessageWKB:"EsriShape"===C?v=l["default"].itemProperties.bdfsValidation.geometry.unselected.errorMessageEsriShape:
"GeoJSON"===C?v=l["default"].itemProperties.bdfsValidation.geometry.unselected.errorMessageGeoJSON:"EsriJSON"===C?v=l["default"].itemProperties.bdfsValidation.geometry.unselected.errorMessageEsriJSON:"WKT"===C&&(v=l["default"].itemProperties.bdfsValidation.geometry.unselected.errorMessageWKT));var N=this.filterDataFields(g,C);F=w.map(function(D,K){var G=D.name;return b.h(b.Fragment,null,b.h("div",null,C+" "+l["default"].itemProperties.datasetsManifest.geometry.Field),b.h("select",{"class":"select-full bdfs-select nonXYZ-geometry-field "+
(m.state.isGeometryErrorActive&&""===G?" input-error":""),name:"geometryFieldsValue_"+K,value:G,disabled:m.state.isReadOnly,onChange:m.nonXYZGeometryFieldChange.bind(m)},N),b.h("div",{"class":"input-error-message nonXYZ-geometry-field "+(m.state.isGeometryErrorActive&&""===G?" is-active":"")},v))})}else if(!w||0===u){"unavailable"===this.state.validationErrorType?(x=l["default"].itemProperties.bdfsValidation.geometry.unavailable.errorMessageX,y=l["default"].itemProperties.bdfsValidation.geometry.unavailable.errorMessageY):
"unselected"===this.state.validationErrorType&&(x=l["default"].itemProperties.bdfsValidation.geometry.unselected.errorMessageX,y=l["default"].itemProperties.bdfsValidation.geometry.unselected.errorMessageY);var J=this.filterDataFields(g,"XYZ");C="XYZ";u=["X","Y","Z"];F=u.map(function(D,K){var G="";G="";return b.h(b.Fragment,null,b.h("div",null,D+" "+l["default"].itemProperties.datasetsManifest.geometry.Field),0===K&&b.h(b.Fragment,null,b.h("select",{"class":"select-full bdfs-select XYZ-geometry-field "+
(m.state.isGeometryErrorActive&&""===G?" input-error":""),name:"geometryFieldsValue_"+K,value:G,disabled:m.state.isReadOnly,onChange:m.geometryFieldXYZUpdate.bind(m,K)},J),b.h("div",{"class":"input-error-message XYZ-geometry-field "+(m.state.isGeometryErrorActive&&""===G?" is-active":"")},x)),1===K&&b.h(b.Fragment,null,b.h("select",{"class":"select-full bdfs-select XYZ-geometry-field "+(m.state.isGeometryErrorActive&&""===G?" input-error":""),name:"geometryFieldsValue_"+K,value:G,disabled:m.state.isReadOnly,
onChange:m.geometryFieldXYZUpdate.bind(m,K)},J),b.h("div",{"class":"input-error-message nonXYZ-geometry-field "+(m.state.isGeometryErrorActive&&""===G?" is-active":"")},y)),2===K&&b.h("select",{"class":"select-full bdfs-select XYZ-geometry-field",name:"geometryFieldsValue_"+K,value:G,disabled:m.state.isReadOnly,onChange:m.geometryFieldXYZUpdate.bind(m,K)},J,b.h("option",{value:""})))})}return{geometrySpatialReference:t,geometryFieldsTSX:F,geometryFormatType:C}};f.prototype.geometryTypeChange=function(g){g=
g.target;var n=c["default"](this.state.datasetsManifest);n[this.state.activeManifestIndex].geometry||(n[this.state.activeManifestIndex].geometry={geometryType:"",spatialReference:{wkid:4326}});if("Polyline"===g.value||"Polygon"===g.value)n[this.state.activeManifestIndex].geometry.fields=[],n[this.state.activeManifestIndex].geometry.fields.push({formats:["WKT"],name:""});"Point"===g.value&&(n[this.state.activeManifestIndex].geometry.fields=[],n[this.state.activeManifestIndex].geometry.fields.push({formats:["x"],
name:""}),n[this.state.activeManifestIndex].geometry.fields.push({formats:["y"],name:""}),n[this.state.activeManifestIndex].geometry.fields.push({formats:["z"],name:""}));n[this.state.activeManifestIndex].geometry.geometryType=this.convertToEsriGeometryType(g.value);"None"===g.value&&delete n[this.state.activeManifestIndex].geometry;this.setState({datasetsManifest:n,isGeometryErrorActive:!1})};f.prototype.geometrySpatialReferenceChange=function(g){g=g.target;var n=c["default"](this.state.datasetsManifest);
n[this.state.activeManifestIndex].geometry.spatialReference.wkid=g.value;this.setState({datasetsManifest:n})};f.prototype.geometryFormatTypeChange=function(g){g=g.target;var n=c["default"](this.state.datasetsManifest),m=[];"XYZ"===g.value?(m.push({name:"",formats:["x"]}),m.push({name:"",formats:["y"]}),m.push({name:"",formats:["z"]})):m.push({name:"",formats:[g.value]});n[this.state.activeManifestIndex].geometry.fields=c["default"](m);this.setState({datasetsManifest:n,isGeometryErrorActive:!1})};
f.prototype.nonXYZGeometryFieldChange=function(g){g=g.target;var n=c["default"](this.state.datasetsManifest);n[this.state.activeManifestIndex].geometry.fields[0].name=g.value;this.setState({datasetsManifest:n})};f.prototype.geometryFieldXYZUpdate=function(g,n){var m=n.target,t=c["default"](this.state.datasetsManifest);2!==g||t[this.state.activeManifestIndex].geometry.fields[g]?t[this.state.activeManifestIndex].geometry.fields[g].name=m.value:t[this.state.activeManifestIndex].geometry.fields[g]={formats:["z"],
name:m.value};this.setState({datasetsManifest:t})};f.prototype.timeTypeChange=function(g){g=g.target;var n=c["default"](this.state.datasetsManifest);n[this.state.activeManifestIndex].time||(n[this.state.activeManifestIndex].time={timeReference:{timeZone:"UTC"}});n[this.state.activeManifestIndex].time.timeType=g.value;n[this.state.activeManifestIndex].time.fields=[];"instant"===g.value?n[this.state.activeManifestIndex].time.fields.push({name:"",formats:[""]}):"interval"===g.value?(n[this.state.activeManifestIndex].time.fields.push({name:"",
role:"start",formats:[""]}),n[this.state.activeManifestIndex].time.fields.push({name:"",role:"end",formats:[""]})):"none"===g.value&&delete n[this.state.activeManifestIndex].time;this.setState({datasetsManifest:n,isTimeErrorActive:!1,timeTypeChanged:!0})};f.prototype.timeZoneChange=function(g){g=g.target;var n=c["default"](this.state.datasetsManifest);n[this.state.activeManifestIndex].time.timeReference.timeZone=g.value;"custom"===g.value?n[this.state.activeManifestIndex].time.timeReference.customTimeZone=
"":delete n[this.state.activeManifestIndex].time.timeReference.customTimeZone;this.setState({datasetsManifest:n})};f.prototype.customTimeZoneChange=function(g){g=g.target;var n=c["default"](this.state.datasetsManifest);n[this.state.activeManifestIndex].time.timeReference.customTimeZone=g.value;this.setState({datasetsManifest:n})};f.prototype.processCustomTimezone=function(g){var n,m=(null===(n=null===g||void 0===g?void 0:g.timeReference)||void 0===n?void 0:n.timeZone)||"UTC",t=!0;this.availableTimeZones.forEach(function(w){"custom"!==
w.canonicalID&&m===w.canonicalID&&(t=!1)});t&&"custom"!==m&&(g.timeReference.customTimeZone=m,m=g.timeReference.timeZone="custom");return q.__assign({},null===g||void 0===g?void 0:g.timeReference)};f.prototype.initializeTimeProperty=function(g){var n=this.processCustomTimezone(g),m=n.timeZone;n=n.customTimeZone;var t=[],w=[],u=[],v=(null===g||void 0===g?0:g.timeType)?g.timeType:"none";if(g)if(g=g.fields,"instant"===v){w.push({id:0,timeField:"",timeFormat:""});u.push({id:0,timeField:"",timeFormat:""});
var x=0;g.forEach(function(z){t.push({id:x,timeField:z.name,timeFormat:z.formats?z.formats[0]:""});x++})}else{if("interval"===v){t.push({id:0,timeField:"",timeFormat:""});var y=0,C=0;g.forEach(function(z){var F=z.formats?z.formats[0]:"";"start"===z.role?(w.push({id:y,timeField:z.name,timeFormat:F}),y++):"end"===z.role&&(u.push({id:C,timeField:z.name,timeFormat:F}),C++)})}}else t.push({id:0,timeField:"",timeFormat:""}),w.push({id:0,timeField:"",timeFormat:""}),u.push({id:0,timeField:"",timeFormat:""});
return{timeInstantArr:t,timeIntervalStartArr:w,timeIntervalEndArr:u,timeZone:m,customTimeZone:n,timeType:v}};f.prototype.createTimeZoneList=function(){return this.availableTimeZones.map(function(g){return b.h("option",{key:g.canonicalID,value:g.canonicalID},g.canonicalID)})};f.prototype.hasValidationError=function(g,n){return"date"!==g.timeField.toLocaleLowerCase()&&(""===g.timeField||""===g.timeFormat)&&!this.checkFieldDateType(g,n)};f.prototype.displayValidationError=function(g,n){return this.state.isTimeErrorActive&&
""===g.timeFormat&&"date"!==g.timeField.toLocaleLowerCase()&&!this.checkFieldDateType(g,n)};f.prototype.checkFieldDateType=function(g,n){return n.some(function(m){return m.name===g.timeField&&"esriFieldTypeDate"===m.type})};f.prototype.createTimeFieldsTSX=function(g,n,m,t,w){var u=this,v=this.createDataFieldsList(w),x=this.createTimeZoneList();this.hasTimeValidationError=!1;var y=n.map(function(F,O){u.hasValidationError(F,w)&&"instant"===g&&(u.hasTimeValidationError=!0);""===F.timeField&&""===F.timeFormat&&
(u.hasTimeValidationError=!1);var V=b.h(b.Fragment,null,b.h("td",null,b.h("select",{"class":"select-full bdfs-select"+(u.state.isTimeErrorActive&&""===F.timeField?" input-error":""),name:"timeFields_"+O,value:F.timeField,onChange:u.changeTimeFieldName.bind(u,F.id,"instant"),disabled:u.state.isReadOnly},v),b.h("div",{"class":"input-error-message-wrapper"},b.h("span",{"class":"bdfs-error-message input-error-message"+(u.state.isTimeErrorActive&&""===F.timeField?" is-active":"")},l["default"].itemProperties.bdfsValidation.time.errorMessageField))),
b.h("td",null,b.h("input",{"class":"bdfs-time-input"+(u.displayValidationError(F,w)?" input-error":""),type:"text",name:"timeFormat_"+O,value:F.timeFormat,onChange:u.changeTimeFormat.bind(u,F.id,"instant"),disabled:u.state.isReadOnly||u.checkFieldDateType(F,w)}),b.h("div",{"class":"input-error-message-wrapper"},b.h("span",{"class":"bdfs-error-message input-error-message"+(u.displayValidationError(F,w)?" is-active":"")},l["default"].itemProperties.bdfsValidation.time.errorMessageFormat))));return 1>
F.id?b.h("tr",{key:"instant"+F.id},V,b.h("td",null,b.h("span",null))):b.h("tr",{key:"instant"+F.id},V,b.h("td",null,b.h("span",null,b.h("button",{type:"button","class":"timeFieldBtn",onClick:u.deleteTimeFields.bind(u,F.id,"instant"),disabled:u.state.isReadOnly},"x"))))}),C=m.map(function(F,O){u.hasValidationError(F,w)&&"interval"===g&&(u.hasTimeValidationError=!0);""===F.timeField&&""===F.timeFormat&&(u.hasTimeValidationError=!1);var V=b.h(b.Fragment,null,b.h("td",null,b.h("select",{"class":"select-full bdfs-select"+
(u.state.isTimeErrorActive&&""===F.timeField?" input-error":""),name:"timeIntervalStart_"+O,value:F.timeField,onChange:u.changeTimeFieldName.bind(u,F.id,"intervalStart"),disabled:u.state.isReadOnly},v),b.h("div",{"class":"input-error-message-wrapper"},b.h("span",{"class":"bdfs-error-message input-error-message"+(u.state.isTimeErrorActive&&""===F.timeField?" is-active":"")},l["default"].itemProperties.bdfsValidation.time.errorMessageField))),b.h("td",null,b.h("input",{"class":"bdfs-time-input"+(u.displayValidationError(F,
w)?" input-error":""),type:"text",name:"timeIntervalStartFormat_"+O,value:F.timeFormat,onChange:u.changeTimeFormat.bind(u,F.id,"intervalStart"),disabled:u.state.isReadOnly||u.checkFieldDateType(F,w)}),b.h("div",{"class":"input-error-message-wrapper"},b.h("span",{"class":"bdfs-error-message input-error-message"+(u.displayValidationError(F,w)?" is-active":"")},l["default"].itemProperties.bdfsValidation.time.errorMessageFormat))));return 1>F.id?b.h("tr",{key:"intervalStart"+F.id},V,b.h("td",null,b.h("span",
null))):b.h("tr",{key:"intervalStart"+F.id},V,b.h("td",null,b.h("span",null,b.h("button",{type:"button","class":"timeFieldBtn",onClick:u.deleteTimeFields.bind(u,F.id,"intervalStart"),disabled:u.state.isReadOnly},"x"))))}),z=t.map(function(F,O){u.hasValidationError(F,w)&&"interval"===g&&(u.hasTimeValidationError=!0);""===F.timeField&&""===F.timeFormat&&(u.hasTimeValidationError=!1);var V=b.h(b.Fragment,null,b.h("td",null,b.h("select",{"class":"select-full bdfs-select"+(u.state.isTimeErrorActive&&""===
F.timeField?" input-error":""),name:"timeIntervalEnd_"+O,value:F.timeField,onChange:u.changeTimeFieldName.bind(u,F.id,"intervalEnd"),disabled:u.state.isReadOnly},v),b.h("div",{"class":"input-error-message-wrapper"},b.h("span",{"class":"bdfs-error-message input-error-message"+(u.state.isTimeErrorActive&&""===F.timeField?" is-active":"")},l["default"].itemProperties.bdfsValidation.time.errorMessageField))),b.h("td",null,b.h("input",{"class":"bdfs-time-input"+(u.displayValidationError(F,w)?" input-error":
""),type:"text",name:"timeIntervalEndFormat_"+O,value:F.timeFormat,onChange:u.changeTimeFormat.bind(u,F.id,"intervalEnd"),disabled:u.state.isReadOnly||u.checkFieldDateType(F,w)}),b.h("div",{"class":"input-error-message-wrapper"},b.h("span",{"class":"bdfs-error-message input-error-message"+(u.displayValidationError(F,w)?" is-active":"")},l["default"].itemProperties.bdfsValidation.time.errorMessageFormat))));return 1>F.id?b.h("tr",{key:"intervalEnd"+F.id},V,b.h("td",null,b.h("span",null))):b.h("tr",
{key:"intervalEnd"+F.id},V,b.h("td",null,b.h("span",null,b.h("button",{type:"button","class":"timeFieldBtn",onClick:u.deleteTimeFields.bind(u,F.id,"intervalEnd"),disabled:u.state.isReadOnly},"x"))))});this.disableAddButtonIfChange(g,n,m,t);return{timeInstantFieldsTSX:y,timeIntervalStartFieldsTSX:C,timeIntervalEndFieldsTSX:z,timeZoneListTSX:x}};f.prototype.disableAddButtonIfChange=function(g,n,m,t){0!==n.length&&"instant"===g&&""===n[n.length-1].timeField&&""===n[n.length-1].timeFormat&&document.getElementById("timeInstantButton")&&
(n=document.getElementById("timeInstantButton"),n.disabled=!0);0!==m.length&&"interval"===g&&""===m[m.length-1].timeField&&""===m[m.length-1].timeFormat&&document.getElementById("timeIntervalStartButton")&&(n=document.getElementById("timeIntervalStartButton"),n.disabled=!0);0!==t.length&&"interval"===g&&""===t[t.length-1].timeField&&""===t[t.length-1].timeFormat&&document.getElementById("timeIntervalEndButton")&&(n=document.getElementById("timeIntervalEndButton"),n.disabled=!0)};f.prototype.addTimeFields=
function(g,n){var m=c["default"](this.state.datasetsManifest);if("instant"===g){m[this.state.activeManifestIndex].time.fields.push({name:"",formats:[""]});var t=document.getElementById("timeInstantButton");t.disabled=!0}else"intervalStart"===g?(m[this.state.activeManifestIndex].time.fields.push({name:"",role:"start",formats:[""]}),t=document.getElementById("timeIntervalStartButton"),t.disabled=!0):"intervalEnd"===g&&(t=document.getElementById("timeIntervalEndButton"),t.disabled=!0,m[this.state.activeManifestIndex].time.fields.push({name:"",
role:"end",formats:[""]}));this.setState({datasetsManifest:m})};f.prototype.deleteTimeFields=function(g,n){var m=c["default"](this.state.datasetsManifest),t=m[this.state.activeManifestIndex].time.fields,w=0;"instant"===n?t=t.filter(function(u,v){return g!==v}):"intervalStart"===n?t=t.filter(function(u){if("start"===u.role){if(w!==g)return w++,!0;w++;return!1}return!0}):"intervalEnd"===n&&(t=t.filter(function(u){if("end"===u.role){if(w!==g)return w++,!0;w++;return!1}return!0}));m[this.state.activeManifestIndex].time.fields=
t;this.setState({datasetsManifest:m});document.getElementsByClassName("timeFieldBtn")[0].disabled=!1};f.prototype.disableAddButtonForTimeFieldChange=function(g,n){if("instant"===n){var m=document.getElementsByClassName("timeFieldBtn")[0],t=document.getElementsByClassName("bdfs-time-input");t=t[t.length-1];g.toUpperCase().includes("DATE")?m.disabled=!1:g.toUpperCase().includes("DATE")||""===t.value?m.disabled=!0:m.disabled=!1}else if("intervalStart"===n){m=document.getElementById("timeIntervalStartButton");
var w=document.getElementsByClassName("intervalStartTbody")[0],u=w.childNodes.length-1;t=w.children[u].getElementsByTagName("td")[0].getElementsByTagName("select")[0];u=w.children[u].getElementsByTagName("td")[1].getElementsByTagName("input")[0];t.value.toUpperCase().includes("DATE")?m.disabled=!1:t.value.toUpperCase().includes("DATE")||""===u.value||""===t.value?m.disabled=!0:m.disabled=!1}else"intervalEnd"===n&&(m=document.getElementById("timeIntervalEndButton"),w=document.getElementsByClassName("intervalEndTbody")[0],
u=w.childNodes.length-1,t=w.children[u].getElementsByTagName("td")[0].getElementsByTagName("select")[0],u=w.children[u].getElementsByTagName("td")[1].getElementsByTagName("input")[0],t.value.toUpperCase().includes("DATE")?m.disabled=!1:t.value.toUpperCase().includes("DATE")||""===u.value||""===t.value?m.disabled=!0:m.disabled=!1)};f.prototype.changeTimeFieldName=function(g,n,m){m=m.target.value;this.modifyTimeFieldsData(g,m,"",n);this.disableAddButtonForTimeFieldChange(m,n)};f.prototype.disableAddButtonForTimeFormatChange=
function(g,n){if("instant"===n){var m=document.getElementsByClassName("select-full bdfs-select"),t=m[m.length-2].value;m=document.getElementsByClassName("timeFieldBtn")[0];m.disabled=""!==t&&""!==g?!1:!0}else if("intervalStart"===n){m=document.getElementById("timeIntervalStartButton");var w=document.getElementsByClassName("intervalStartTbody")[0],u=w.childNodes.length-1;t=w.children[u].getElementsByTagName("td")[0].getElementsByTagName("select")[0];u=w.children[u].getElementsByTagName("td")[1].getElementsByTagName("input")[0];
t.value.toUpperCase().includes("DATE")?m.disabled=!1:t.value.toUpperCase().includes("DATE")||""===u.value||""===t.value?m.disabled=!0:m.disabled=!1}else"intervalEnd"===n&&(m=document.getElementById("timeIntervalEndButton"),w=document.getElementsByClassName("intervalEndTbody")[0],u=w.childNodes.length-1,t=w.children[u].getElementsByTagName("td")[0].getElementsByTagName("select")[0],u=w.children[u].getElementsByTagName("td")[1].getElementsByTagName("input")[0],t.value.toUpperCase().includes("DATE")?
m.disabled=!1:t.value.toUpperCase().includes("DATE")||""===u.value||""===t.value?m.disabled=!0:m.disabled=!1)};f.prototype.changeTimeFormat=function(g,n,m){m=m.target.value;this.modifyTimeFieldsData(g,"",m,n);this.disableAddButtonForTimeFormatChange(m,n)};f.prototype.modifyTimeFieldsData=function(g,n,m,t){var w=this,u=c["default"](this.state.datasetsManifest),v=u[this.state.activeManifestIndex].time.fields,x=0;"instant"===t?v.forEach(function(y,C){C===g&&(""===n?y.formats=[m]:""===m&&(w.checkFieldDateType({timeField:n},
w.dataItemFields)&&(y.formats=[""]),y.name=n))}):"intervalStart"===t?v.forEach(function(y){"start"===y.role&&(x===g&&(""===n?y.formats=[m]:""===m&&(w.checkFieldDateType({timeField:n},w.dataItemFields)&&(y.formats=[""]),y.name=n)),x++)}):"intervalEnd"===t&&v.forEach(function(y){"end"===y.role&&(x===g&&(""===n?y.formats=[m]:""===m&&(w.checkFieldDateType({timeField:n},w.dataItemFields)&&(y.formats=[""]),y.name=n)),x++)});u[this.state.activeManifestIndex].time.fields=v;this.setState({datasetsManifest:u})};
f.prototype.fieldDelimiterChange=function(g){g=g.target;var n=c["default"](this.state.datasetsManifest);n[this.state.activeManifestIndex].format.fieldDelimiter=g.value;"custom"===g.value?n[this.state.activeManifestIndex].format.customFieldDelimiter="":delete n[this.state.activeManifestIndex].format.customFieldDelimiter;this.setState({datasetsManifest:n})};f.prototype.customFieldDelimiterChange=function(g){g=g.target;var n=c["default"](this.state.datasetsManifest);n[this.state.activeManifestIndex].format.customFieldDelimiter=
g.value;this.setState({datasetsManifest:n})};f.prototype.recordTerminatorChange=function(g){g=g.target;var n=c["default"](this.state.datasetsManifest);n[this.state.activeManifestIndex].format.recordTerminator=g.value;"custom"===g.value?n[this.state.activeManifestIndex].format.customRecordTerminator="":delete n[this.state.activeManifestIndex].format.customRecordTerminator;this.setState({datasetsManifest:n})};f.prototype.customRecordTerminatorChange=function(g){g=g.target;var n=c["default"](this.state.datasetsManifest);
n[this.state.activeManifestIndex].format.customRecordTerminator=g.value;this.setState({datasetsManifest:n})};f.prototype.quoteCharChange=function(g){g=g.target;var n=c["default"](this.state.datasetsManifest);n[this.state.activeManifestIndex].format.quoteChar=g.value;this.setState({datasetsManifest:n})};f.prototype.hasHeaderRowChange=function(){var g=c["default"](this.state.datasetsManifest);g[this.state.activeManifestIndex].format.hasHeaderRow=!g[this.state.activeManifestIndex].format.hasHeaderRow;
this.setState({datasetsManifest:g})};f.prototype.encodingChange=function(g){g=g.target;var n=c["default"](this.state.datasetsManifest);n[this.state.activeManifestIndex].format.encoding=g.value;"custom"===g.value?n[this.state.activeManifestIndex].format.customEncoding="":delete n[this.state.activeManifestIndex].format.customEncoding;this.setState({datasetsManifest:n})};f.prototype.customEncodingChange=function(g){g=g.target;var n=c["default"](this.state.datasetsManifest);n[this.state.activeManifestIndex].format.customEncoding=
g.value;this.setState({datasetsManifest:n})};f.prototype.checkSidebarItem=function(g,n){n.preventDefault();this.renderEditingModal(this.state.activeManifestIndex,this.state.datasetsManifest,g)};f.prototype.deleteEmptyGeometryZField=function(g){g.forEach(function(n){var m,t,w;""===(null===(w=null===(t=null===(m=null===n||void 0===n?void 0:n.geometry)||void 0===m?void 0:m.fields)||void 0===t?void 0:t[2])||void 0===w?void 0:w.name)&&n.geometry.fields.pop()});return g};f.prototype.deleteCustomFields=
function(g){var n,m;g.format.customFieldDelimiter&&(g.format.fieldDelimiter=g.format.customFieldDelimiter);delete g.format.customFieldDelimiter;g.format.customRecordTerminator&&(g.format.recordTerminator=g.format.customRecordTerminator);delete g.format.customRecordTerminator;g.format.customEncoding&&(g.format.encoding=g.format.customEncoding);delete g.format.customEncoding;if(null===(m=null===(n=null===g||void 0===g?void 0:g.time)||void 0===n?void 0:n.timeReference)||void 0===m?0:m.customTimeZone)g.time.timeReference.timeZone=
g.time.timeReference.customTimeZone,delete g.time.timeReference.customTimeZone};f.prototype.deleteUnnecessaryKeys=function(g){a["default"].includes(["shapefile","orc","parquet"],g.format.type)&&(delete g.format.fieldDelimiter,delete g.format.recordTerminator,delete g.format.encoding)};f.prototype.deleteDataFormat=function(g){var n=this,m;null===(m=null===g||void 0===g?void 0:g.time)||void 0===m?void 0:m.fields.forEach(function(t){n.checkFieldDateType({timeField:t.name},n.dataItemFields)&&delete t.formats})};
f.prototype.reformatEscapeCharacters=function(g){return"\\r"===g?"\r":"\\n"===g?"\n":"\\t"===g?"\t":"\\b"===g?"\b":"\\f"===g?"\f":g};f.prototype.saveEditingModal=function(){var g=this;if(this.hasGeometryValidationError||this.hasTimeValidationError)this.setState({isGeometryErrorActive:this.hasGeometryValidationError,isTimeErrorActive:this.hasTimeValidationError,validationErrorType:0===this.geometryFieldsListLength?"unavailable":"unselected"});else{this.setState({isModalButtonDisabled:!0,progressIndicatorActive:!0,
isGeometryErrorActive:!1,isTimeErrorActive:!1,validationErrorType:""});var n=this.props.manifestAdminURL+"/update",m={},t=c["default"](this.state.datasetsManifest);t.forEach(function(w){w.time&&2<=w.time.fields.length&&""===w.time.fields[w.time.fields.length-1].name&&""===w.time.fields[w.time.fields.length-1].formats[0]&&(g.deleteTimeFields(w.time.fields.length-1,w.time.timeType),w.time.fields.pop());g.deleteCustomFields(w);w.format.fieldDelimiter=g.reformatEscapeCharacters(w.format.fieldDelimiter);
w.format.recordTerminator=g.reformatEscapeCharacters(w.format.recordTerminator);g.deleteUnnecessaryKeys(w);g.deleteDataFormat(w)});m.datasets=this.deleteEmptyGeometryZField(t);r["default"].request({url:n,content:{fileData:JSON.stringify(m)}},{useProxy:r["default"].shouldUseProxy(n),usePost:!0}).then(function(w){"success"===w.status?g.handleManifestUpdateSuccess():g.updateEditingModal(m)},function(w){g.updateEditingModal(m)})}};f.prototype.updateEditingModal=function(g){var n=this,m=this.props.portalURL+
"/manifest/update";r["default"].request({url:m,content:{fileData:JSON.stringify(g)}},{useProxy:r["default"].shouldUseProxy(m),usePost:!0}).then(function(w){"success"===w.status?n.handleManifestUpdateSuccess():t(w.error)},function(w){t(w)});var t=function(w){n.setState({isModalButtonDisabled:!1,progressIndicatorActive:!1,datasetsManifest:n.state.datasetsManifest});n.displayNotificationIndicator(!0,l["default"].itemProperties.notificationIndicator.alertIndicatorColor.red,l["default"].itemProperties.notificationIndicator.alertIndicatorInfo.manifestUpdate.failure)}};
f.prototype.handleManifestUpdateSuccess=function(){this.props.updateManifest(this.state.datasetsManifest);this.closeEditingModal("save");this.setState({isModalButtonDisabled:!1,progressIndicatorActive:!1});this.displayNotificationIndicator(!0,l["default"].itemProperties.notificationIndicator.alertIndicatorColor.green,l["default"].itemProperties.notificationIndicator.alertIndicatorInfo.manifestUpdate.success)};f.prototype.displayNotificationIndicator=function(g,n,m){this.props.displayNotificationIndicator(g,
n,m)};f.prototype.processCustomCharacters=function(g){-1===", \\t ; ' \" | / \\".split(" ").indexOf(g.fieldDelimiter)&&(g.customFieldDelimiter="custom"===g.fieldDelimiter?g.customFieldDelimiter:g.fieldDelimiter,g.fieldDelimiter="custom");-1===["\\t","\\n","\\r"].indexOf(g.recordTerminator)&&(g.customRecordTerminator="custom"===g.recordTerminator?g.customRecordTerminator:g.recordTerminator,g.recordTerminator="custom");-1==="US-ASCII UTF-8 UTF-16 UTF-32 ISO-8859-1 UTF-16LE UTF-16BE".split(" ").indexOf(g.encoding)&&
(g.customEncoding="custom"===g.encoding?g.customEncoding:g.encoding,g.encoding="custom")};f.prototype.getHelpLink=function(){return""+d["default"].self.helpBase+d["default"].self.helpMap.m["120002874"]};f.prototype.render=function(){var g=this,n=this.state,m=n.datasetsManifest,t=n.activeManifestIndex,w=n.activeMenuItem,u=n.datasetsManifestStatus,v=n.modalActive,x=n.isReadOnly,y=n.timeTypeChanged,C=n.isModalButtonDisabled,z=n.progressIndicatorActive,F=l["default"].itemProperties.datasetsManifest.edittingModal,
O=F.title,V=F.cancel,N=F.save;F=F.saveLoading;n=this.createDatasetsPropertyMenu(n.sidebarMenu,n.isSidebarDisabled);var J=this.retrieveDatasetProperty(t,m,w),D=J.dataItemFields,K=J.geometry;m=J.geometryType;t=J.dataItemTime;var G=J.timeInstantArr,I=J.timeIntervalStartArr,R=J.timeIntervalEndArr,A=J.timeZone,B=J.customTimeZone,H=J.timeType;J=J.fileFormat;u=this.createDataItemFieldsTSX(D,J,u);var T=this.createGeometryTSX(D,K);K=T.geometrySpatialReference;var M=T.geometryFieldsTSX;T=T.geometryFormatType;
var L=l["default"].itemProperties.datasetsManifest.geometry,X=L.spatialReference,ba=L.spatialReferenceValue,ma=L.point,ta=L.polyline,Ea=L.polygon,wa=L.geomtryFormatType,Q=L.XYZ,Z=L.WKT,aa=L.WKB,ea=L.GeoJSON,oa=L.EsriJSON,ra=L.EsriShape,za=L.none;L=L.geometryFields;R=this.createTimeFieldsTSX(H,G,I,R,D);D=R.timeInstantFieldsTSX;G=R.timeIntervalStartFieldsTSX;I=R.timeIntervalEndFieldsTSX;R=R.timeZoneListTSX;var ya=l["default"].itemProperties.datasetsManifest.time;H=ya.timeType;var Ha=ya.instant,ua=ya.interval,
Y=ya.timeFields,da=ya.field,ka=ya.format,W=ya.startTimeFields,fa=ya.endTimeFields;ya=ya.timeZone;var ha=l["default"].itemProperties.datasetsManifest.file,sa=ha.fileExtension,Fa=ha.fieldDelimiter,Ma=ha.inputDelimiter,Oa=ha.recordTerminator,Ra=ha.inputTerminator,Da=ha.custom,E=ha.quoteCharacter,S=ha.hasHeaderRow,ia=ha.fileEncoding;ha=ha.inputEncoding;this.processCustomCharacters(J);return b.h(b.Fragment,null,b.h(p["default"],{id:"data-editing-modal"},b.h("calcite-modal",{"aria-labelledby":"modal-title",
active:v,fullscreen:!0,oncalciteModalClose:function(){return g.closeEditingModal("cancel")}},b.h("h3",{slot:"header",id:"modal-title"},O),b.h("div",{slot:"content","class":"data-editing-content"},b.h("div",{"class":"grid-container flex"},b.h("div",{"class":"data-fields-sidebar-menu margin-right-2 flex-0"},n),b.h("div",{"class":"flex-1 leader-1"},b.h("div",{"class":"panel panel-white"},"Fields"===w&&b.h("div",{"class":"overflow-auto"},u),"Geometry"===w&&b.h("div",{"class":"overflow-auto"},b.h("div",
{"class":"geometryType"},b.h("div",null,m),b.h("label",{"class":"padding-left-2"},b.h("select",{"class":"select-full bdfs-select",name:"geometryTypeValue",disabled:x||"shp"===J.extension?!0:!1,value:m,onChange:this.geometryTypeChange.bind(this)},b.h("option",{value:"Point"},ma),b.h("option",{value:"Polyline"},ta),b.h("option",{value:"Polygon"},Ea),b.h("option",{value:"None"},za)))),"None"!==m&&""!==m&&b.h(b.Fragment,null,b.h("div",{"class":"spatialReference"},b.h("div",null,X),b.h("label",{"class":"padding-left-2"},
b.h("input",{type:"text",name:"spatialReferenceValue",value:K.wkid,placeholder:ba,onChange:this.geometrySpatialReferenceChange.bind(this),disabled:x||"shp"===J.extension}))),"shp"!==J.extension&&b.h(b.Fragment,null,b.h("div",{"class":"geometryFormatType"},b.h("div",null,wa),b.h("label",{"class":"padding-left-2"},b.h("select",{"class":"select-full bdfs-select",name:"geometryFormatTypeValue",value:T,onChange:this.geometryFormatTypeChange.bind(this),disabled:x},!a["default"].includes(["csv","shp"],J.extension)&&
b.h("option",{value:"WKB"},aa),b.h("option",{value:"WKT"},Z),"Point"===m&&b.h("option",{value:"XYZ"}," ",Q),b.h("option",{value:"GeoJSON"},ea),b.h("option",{value:"EsriJSON"},oa),b.h("option",{value:"EsriShape"},ra)))),b.h("div",{"class":"geometryFields"},b.h("div",null,L),b.h("label",{"class":"padding-left-2"},M))))),"Time"===w&&b.h("div",{"class":"overflow-auto"},b.h("form",{name:"time",id:"datasetTimeType"},b.h("div",{"class":"timeType"},b.h("div",null,H),b.h("label",{"class":"padding-left-2"},
b.h("select",{"class":"select-full bdfs-select",name:"timeType",value:(null===t||void 0===t?void 0:t.timeType)||"none",onChange:this.timeTypeChange.bind(this),disabled:this.state.isReadOnly},b.h("option",{value:"interval"},ua),b.h("option",{value:"instant"},Ha),b.h("option",{value:"none"},za))))),(null===t||void 0===t?void 0:t.timeType)&&"none"!==t.timeType&&b.h(b.Fragment,null,"instant"===t.timeType&&b.h("div",{"class":"timeFields"},b.h("div",null,Y),b.h("div",{"class":"padding-left-2"},b.h("table",
{"class":"table"},b.h("thead",null,b.h("tr",null,b.h("th",null," ",da," "),b.h("th",null," ",ka," "),b.h("th",null,b.h("span",null,b.h("button",{type:"button","class":"timeFieldBtn",id:"timeInstantButton",onClick:this.addTimeFields.bind(this,"instant"),disabled:x||y},"+"))))),b.h("tbody",null,D)))),"interval"===t.timeType&&b.h(b.Fragment,null,b.h("div",{"class":"timeFields"},b.h("div",null,W),b.h("div",{"class":"padding-left-2"},b.h("table",{"class":"table"},b.h("thead",null,b.h("tr",null,b.h("th",
null," ",da," "),b.h("th",null," ",ka," "),b.h("th",null,b.h("span",null,b.h("button",{type:"button","class":"timeFieldBtn",id:"timeIntervalStartButton",onClick:this.addTimeFields.bind(this,"intervalStart"),disabled:x||y},"+"))))),b.h("tbody",{"class":"intervalStartTbody"},G)))),b.h("div",{"class":"timeFields"},b.h("div",null,fa),b.h("div",{"class":"padding-left-2"},b.h("table",{"class":"table"},b.h("thead",null,b.h("tr",null,b.h("th",null," ",da," "),b.h("th",null," ",ka," "),b.h("th",null,b.h("span",
null,b.h("button",{type:"button","class":"timeFieldBtn",id:"timeIntervalEndButton",onClick:this.addTimeFields.bind(this,"intervalEnd"),disabled:x||y},"+"))))),b.h("tbody",{"class":"intervalEndTbody"},I))))),b.h("div",{"class":"timeZone"},b.h("div",null,ya),b.h("label",{"class":"padding-left-2"},b.h("select",{"class":"select-full bdfs-select",name:"timeZone",value:A,onChange:this.timeZoneChange.bind(this),disabled:x},R)),"custom"===A&&b.h("label",{"class":"padding-left-2"},b.h("input",{type:"text",
name:"customTimeZone",value:B,onChange:this.customTimeZoneChange.bind(this),disabled:x}))))),"File"===w&&b.h("div",{"class":"overflow-auto"},b.h("div",{"class":"fileExtension"},b.h("div",null,sa),b.h("label",{"class":"padding-left-2"},b.h("div",{id:"fileExtension"},J.extension))),"csv"===J.extension&&b.h(b.Fragment,null,b.h("div",{"class":"fieldDelimiter"},b.h("div",null,Fa),b.h("label",{"class":"padding-left-2"},b.h("select",{"class":"select-full bdfs-select",name:"fieldDelimiter",value:J.fieldDelimiter,
onChange:this.fieldDelimiterChange.bind(this),disabled:x},b.h("option",{value:","},","),b.h("option",{value:"\\t"},"\\t"),b.h("option",{value:";"},";"),b.h("option",{value:"'"},"'"),b.h("option",{value:'"'},'"'),b.h("option",{value:"|"},"|"),b.h("option",{value:"/"},"/"),b.h("option",{value:"\\"},"\\"),b.h("option",{value:"custom"},Da))),"custom"===J.fieldDelimiter&&b.h("label",{"class":"padding-left-2"},b.h("input",{type:"text",name:"customFieldDelimiter",value:J.customFieldDelimiter,onChange:this.customFieldDelimiterChange.bind(this),
placeholder:Ma,disabled:x}))),b.h("div",{"class":"recordTerminator"},b.h("div",null,Oa),b.h("label",{"class":"padding-left-2"},b.h("select",{"class":"select-full bdfs-select",name:"recordTerminator",value:J.recordTerminator,onChange:this.recordTerminatorChange.bind(this),disabled:x},b.h("option",{value:"\\t"},"\\t"),b.h("option",{value:"\\n"},"\\n"),b.h("option",{value:"\\r"},"\\r"),b.h("option",{value:"custom"},Da))),"custom"===J.recordTerminator&&b.h("label",{"class":"padding-left-2"},b.h("input",
{type:"text",name:"customRecordTerminator",value:J.customRecordTerminator,onChange:this.customRecordTerminatorChange.bind(this),placeholder:Ra,disabled:x}))),b.h("div",{"class":"quoteCharacter"},b.h("div",null,E),b.h("label",{"class":"padding-left-2"},b.h("input",{type:"text",placeholder:"''",name:"quoteCharacter",value:J.quoteChar,onChange:this.quoteCharChange.bind(this),disabled:x}))),b.h("div",{"class":"headRow"},b.h("div",null,S),b.h("label",{"class":"padding-left-2"},b.h("input",{type:"checkbox",
name:"headRow",checked:J.hasHeaderRow,onChange:this.hasHeaderRowChange.bind(this),disabled:x}))),b.h("div",{"class":"fileEncoding"},b.h("div",null,ia),b.h("label",{"class":"padding-left-2"},b.h("select",{"class":"select-full bdfs-select",name:"fileEncoding",value:J.encoding,onChange:this.encodingChange.bind(this),disabled:x},b.h("option",{value:"US-ASCII"},"US-ASCII"),b.h("option",{value:"UTF-8"},"UTF-8"),b.h("option",{value:"UTF-16"},"UTF-16"),b.h("option",{value:"UTF-32"},"UTF-32"),b.h("option",
{value:"ISO-8859-1"},"ISO-8859-1"),b.h("option",{value:"UTF-16LE"},"UTF-16LE"),b.h("option",{value:"UTF-16BE"},"UTF-16BE"),b.h("option",{value:"custom"},Da))),"custom"===J.encoding&&b.h("label",{"class":"padding-left-2"},b.h("input",{type:"text",name:"customInputFileEncoding",value:J.customEncoding,onChange:this.customEncodingChange.bind(this),placeholder:ha,disabled:x})))))))),b.h("div",{"class":"padding-left-1"},b.h("a",{href:this.getHelpLink(),target:"_blank"},b.h("span",{"class":"bdfsHelpIcon"})))),
!x&&b.h("calcite-button",{slot:"secondary",width:"full",disabled:C,onClick:function(){return g.saveEditingModal()}},z?b.h("div",{style:"display: inline-flex; align-items: center; justify-content: center; width: 100%;"},b.h("calcite-loader",{label:"savingManifest",scale:"m",inline:!0,active:z}),b.h("span",{style:"margin:0 10px"},F)):b.h("div",null,N)),b.h("calcite-button",{slot:"primary",width:"full",appearance:"outline",disabled:C,onClick:function(){return g.closeEditingModal("cancel")}},V))))};return f}(b.Component);
U["default"]=e})},"arcgisonline/pages/components/BodyAppender":function(){define(["require","exports","tslib","preact","preact/compat"],function(e,U,q,b,l){Object.defineProperty(U,"__esModule",{value:!0});e=function(p){function r(a){var c,d=p.call(this,a)||this;d.el=document.createElement("div");d.el.setAttribute("id",a.id);(null===(c=a.classes)||void 0===c?0:c.length)&&d.el.classList.add(a.classes.join(" "));return d}q.__extends(r,p);r.prototype.componentDidMount=function(){document.body.appendChild(this.el)};
r.prototype.componentWillUnmount=function(){document.body.removeChild(this.el)};r.prototype.render=function(){return l.createPortal(this.props.children,this.el)};return r}(b.Component);U["default"]=e})},"arcgisonline/pages/item/components/bigdatafileshare/AdvancedSettings":function(){define("require exports tslib preact dojo/i18n!arcgisonline/nls/arcgisonline arcgisonline/pages/components/BodyAppender arcgisonline/sharing/util esri/request".split(" "),function(e,U,q,b,l,p,r,a){Object.defineProperty(U,
"__esModule",{value:!0});l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);e=function(c){function d(){var h=null!==c&&c.apply(this,arguments)||this;h.state={manifestJson:"",manifestViewerActive:!1,manifestUploaderActive:!1,isUploaderButtonDisabled:!1,uploadingProgressIndicatorActive:!1,alertIndicatorActive:!1,alertIndicatorColor:l["default"].itemProperties.notificationIndicator.alertIndicatorColor.blue,alertIndicatorInfo:"",hintsInfo:"",hintsViewerActive:!1,
hintsUploaderActive:!1};return h}q.__extends(d,c);d.prototype.onToggleAdvancedSetting=function(){this.props.onToggleAdvancedSetting(!this.props.shouldDisplayAdvancedSetting)};d.prototype.viewInfo=function(h){"Manifest"===h?this.viewManifest():"Hints"===h&&this.viewHintsThroughPortal()};d.prototype.uploadInfo=function(h){"Manifest"===h?this.openManifestUploader():"Hints"===h&&this.openHintsUploader()};d.prototype.downloadInfo=function(h){"Manifest"===h?this.downloadManifestThroughPortal():"Hints"===
h&&this.downloadHintsThroughPortal()};d.prototype.viewManifest=function(){var h=this.props.viewManifest();this.setState({manifestViewerActive:!0,manifestJson:h})};d.prototype.closeManifestViewModal=function(){this.setState({manifestViewerActive:!1})};d.prototype.openManifestUploader=function(){this.setState({manifestUploaderActive:!0})};d.prototype.closeManifestUploader=function(){this.setState({manifestUploaderActive:!1})};d.prototype.uploadManifestThroughPortal=function(){var h=this,f=document.getElementById("manifestFile"),
g=null===f||void 0===f?void 0:f.files;f=null===g||void 0===g?void 0:g[0];if(0===(null===g||void 0===g?void 0:g.length))this.displayNotificationIndicator(!0,l["default"].itemProperties.notificationIndicator.alertIndicatorColor.red,l["default"].itemProperties.notificationIndicator.alertIndicatorInfo.noFileChosen);else{this.setState({isUploaderButtonDisabled:!0,uploadingProgressIndicatorActive:!0});var n=this.props.manifestAdminURL+"/update";g=new FileReader;g.readAsText(f,"UTF-8");g.onload=function(m){r["default"].request({url:n,
content:{fileData:this.result}},{useProxy:r["default"].shouldUseProxy(n),usePost:!0}).then(function(t){"success"===t.status?(h.closeManifestUploader(),h.setState({isUploaderButtonDisabled:!1,uploadingProgressIndicatorActive:!1}),h.displayNotificationIndicator(!0,l["default"].itemProperties.notificationIndicator.alertIndicatorColor.green,l["default"].itemProperties.notificationIndicator.alertIndicatorInfo.manifestUpload.success)):h.uploadManifestThroughServer()},function(t){h.uploadManifestThroughServer()})}}};
d.prototype.uploadManifestThroughServer=function(){var h=this,f=document.getElementById("manifestFile"),g=null===f||void 0===f?void 0:f.files;f=null===g||void 0===g?void 0:g[0];if(0===(null===g||void 0===g?void 0:g.length))this.displayNotificationIndicator(!0,l["default"].itemProperties.notificationIndicator.alertIndicatorColor.red,l["default"].itemProperties.notificationIndicator.alertIndicatorInfo.noFileChosen);else{this.setState({isUploaderButtonDisabled:!0,uploadingProgressIndicatorActive:!0});
var n=this.props.portalURL+"/manifest/update";g=new FileReader;g.readAsText(f,"UTF-8");g.onload=function(t){r["default"].request({url:n,content:{fileData:this.result}},{useProxy:r["default"].shouldUseProxy(n),usePost:!0}).then(function(w){"success"===w.status?(h.closeManifestUploader(),h.setState({isUploaderButtonDisabled:!1,uploadingProgressIndicatorActive:!1}),h.displayNotificationIndicator(!0,l["default"].itemProperties.notificationIndicator.alertIndicatorColor.green,l["default"].itemProperties.notificationIndicator.alertIndicatorInfo.manifestUpload.success)):
m(w.error)},function(w){m(w)})};var m=function(t){h.setState({isUploaderButtonDisabled:!1,uploadingProgressIndicatorActive:!1});h.displayNotificationIndicator(!0,l["default"].itemProperties.notificationIndicator.alertIndicatorColor.red,l["default"].itemProperties.notificationIndicator.alertIndicatorInfo.manifestUpload.failure)}}};d.prototype.displayNotificationIndicator=function(h,f,g){this.props.displayNotificationIndicator(h,f,g)};d.prototype.downloadManifestThroughPortal=function(){var h=this,
f=r["default"].getToken(),g=this.props.manifestAdminURL+"?f\x3djson\x26download\x3dtrue\x26token\x3d"+f;r["default"].request({url:this.props.manifestAdminURL,content:{download:!0}},{useProxy:r["default"].shouldUseProxy(this.props.manifestAdminURL)}).then(function(n){window.open(g,"_blank")},function(n){h.downloadFileThroughServer("manifest")})};d.prototype.viewHintsThroughPortal=function(){var h=this,f=this.props.hintsAdminURL;a["default"]({url:f,content:{read:!0,token:r["default"].getToken()},handleAs:"text"},
{useProxy:r["default"].shouldUseProxy(f),removeFormatProp:!0}).then(function(g){h.handleHintsViewSuccess(g)},function(g){h.viewHintsThroughServer()})};d.prototype.viewHintsThroughServer=function(){var h=this,f=this.props.portalURL+"/hints";a["default"]({url:f,content:{read:!0,token:r["default"].getToken()},handleAs:"text"},{useProxy:r["default"].shouldUseProxy(f),removeFormatProp:!0}).then(function(g){h.handleHintsViewSuccess(g)},function(g){})};d.prototype.handleHintsViewSuccess=function(h){h=this.createHintsTable(h);
this.setState({hintsViewerActive:!0,hintsInfo:h})};d.prototype.createHintsTable=function(h){if(h)return h=h.trim().split("\n").map(function(f){var g=f.split("\x3d")[0];f=f.split("\x3d")[1];return b.h("tr",{key:g},b.h("td",null,g),b.h("td",null,f))}),h=b.h("table",{id:"hintsTable"},b.h("thead",null,b.h("tr",null,b.h("th",null,l["default"].itemProperties.advancedSettings.hintsTableProperty),b.h("th",null,l["default"].itemProperties.advancedSettings.hintsTableValue))),b.h("tbody",null,h))};d.prototype.closeHintsViewModal=
function(){this.setState({hintsViewerActive:!1})};d.prototype.openHintsUploader=function(){this.setState({hintsUploaderActive:!0})};d.prototype.closeHintsUploader=function(){this.setState({hintsUploaderActive:!1})};d.prototype.uploadHintsThroughPortal=function(){var h=this,f,g=document.getElementById("hintsFile");0===(null===(f=null===g||void 0===g?void 0:g.files)||void 0===f?void 0:f.length)?this.displayNotificationIndicator(!0,l["default"].itemProperties.notificationIndicator.alertIndicatorColor.red,
l["default"].itemProperties.notificationIndicator.alertIndicatorInfo.noFileChosen):(f=document.getElementById("hintsUploadWrapper"),this.setState({isUploaderButtonDisabled:!0,uploadingProgressIndicatorActive:!0}),g=this.props.hintsAdminURL+"/update",r["default"].request({url:g,form:f},{useProxy:r["default"].shouldUseProxy(g),usePost:!0}).then(function(n){"success"===n.status?h.handleHintsUploadSuccess():h.uploadHintsThroughServer()},function(n){h.uploadHintsThroughServer()}))};d.prototype.uploadHintsThroughServer=
function(){var h=this,f,g=document.getElementById("hintsFile");if(0===(null===(f=null===g||void 0===g?void 0:g.files)||void 0===f?void 0:f.length))this.displayNotificationIndicator(!0,l["default"].itemProperties.notificationIndicator.alertIndicatorColor.red,l["default"].itemProperties.notificationIndicator.alertIndicatorInfo.noFileChosen);else{f=document.getElementById("hintsUploadWrapper");this.setState({isUploaderButtonDisabled:!0,uploadingProgressIndicatorActive:!0});g=this.props.portalURL+"/hints/update";
r["default"].request({url:g,form:f},{useProxy:r["default"].shouldUseProxy(g),usePost:!0}).then(function(m){"success"===m.status?h.handleHintsUploadSuccess():n(m.error)},function(m){n(m)});var n=function(m){h.setState({isUploaderButtonDisabled:!1,uploadingProgressIndicatorActive:!1});h.displayNotificationIndicator(!0,l["default"].itemProperties.notificationIndicator.alertIndicatorColor.red,l["default"].itemProperties.notificationIndicator.alertIndicatorInfo.hintsUpload.failure)}}};d.prototype.handleHintsUploadSuccess=
function(){this.closeHintsUploader();this.setState({isUploaderButtonDisabled:!1,uploadingProgressIndicatorActive:!1});this.displayNotificationIndicator(!0,l["default"].itemProperties.notificationIndicator.alertIndicatorColor.green,l["default"].itemProperties.notificationIndicator.alertIndicatorInfo.hintsUpload.success)};d.prototype.downloadHintsThroughPortal=function(){var h=this,f=r["default"].getToken(),g=this.props.hintsAdminURL+"?download\x3dtrue\x26token\x3d"+f;r["default"].request({url:this.props.hintsAdminURL,
content:{download:!0},handleAs:"text"},{useProxy:r["default"].shouldUseProxy(this.props.hintsAdminURL),removeFormatProp:!0}).then(function(n){window.open(g,"_blank")},function(n){h.downloadFileThroughServer("hints")})};d.prototype.downloadFileThroughServer=function(h){var f=r["default"].getToken();window.open(this.props.portalURL+"/"+h+"?"+("manifest"===h?"f\x3djson\x26":"")+"download\x3dtrue\x26token\x3d"+f,"_blank")};d.prototype.render=function(){var h=this,f=this.state,g=f.manifestViewerActive,
n=f.manifestJson,m=f.manifestUploaderActive,t=f.isUploaderButtonDisabled,w=f.uploadingProgressIndicatorActive,u=f.hintsViewerActive,v=f.hintsInfo;f=f.hintsUploaderActive;var x=this.props.shouldDisplayAdvancedSetting,y=[{title:l["default"].itemProperties.advancedSettings.manifest,description:l["default"].itemProperties.advancedSettings.manifestDescription,value:"Manifest"},{title:l["default"].itemProperties.advancedSettings.hints,description:l["default"].itemProperties.advancedSettings.hintsDescription,
value:"Hints"}].map(function(C,z){return b.h("div",{key:C.title+"_"+z,"class":"datasets-manifest"},b.h("div",{"class":"leader-half trailer-half margin-left-quarter"},C.title),b.h("div",{"class":"leader-half trailer-1 margin-left-quarter"},C.description),b.h("div",{"class":"full-width padding-trailer-1 margin-left-quarter"},b.h("div",{"class":"grid-container"},b.h("div",{"class":"column-9 leader-quarter"},b.h("div",{"class":"leader-quarter margin-right-half margin-left-0 flex flex-1"},b.h("button",
{"class":"btn btn-clear btn-fill",onClick:h.viewInfo.bind(h,C.value)}," ",l["default"].itemProperties.advancedSettings.view," "),b.h("button",{"class":"btn btn-clear btn-fill",onClick:h.uploadInfo.bind(h,C.value)}," ",l["default"].itemProperties.advancedSettings.upload," "),b.h("button",{"class":"btn btn-clear btn-fill",onClick:h.downloadInfo.bind(h,C.value)}," ",l["default"].itemProperties.advancedSettings.download," "))))))});return b.h(b.Fragment,null,b.h("div",{"class":"grid-container"},b.h("div",
{"class":"column-24 padding-leader-quarter"},b.h("label",{"class":"toggle-switch modifier-class clearfix trailer-0"},b.h("span",{"class":"toggle-switch-label margin-right-1"},l["default"].itemProperties.advancedSettings.showAdvanced),b.h("input",{checked:x,type:"checkbox",name:"userAdvancedSetting","class":"toggle-switch-input",onChange:this.onToggleAdvancedSetting.bind(this)}),b.h("span",{"class":"toggle-switch-track"})))),b.h("div",{"class":x?"grid-container":"grid-container hide"},b.h("div",{id:"advancedSettingsSection",
"class":"column-24 leader-half padding-left-1 padding-right-1"},y)),b.h(p["default"],{id:"manifestViewer"},b.h("calcite-modal",{"aria-labelledby":"modal-title",active:g,fullscreen:!0,oncalciteModalClose:function(){return h.closeManifestViewModal()}},b.h("h3",{slot:"header"},l["default"].itemProperties.advancedSettings.manifest),b.h("div",{slot:"content","class":"manifestViewer"},b.h("div",null,l["default"].itemProperties.advancedSettings.datasetsTitle),b.h("pre",{id:"manifest"},n)))),b.h(p["default"],
{id:"manifestUploader"},b.h("calcite-modal",{"aria-labelledby":"modal-title",active:m,scale:"m",width:"m",oncalciteModalClose:function(){return h.closeManifestUploader()}},b.h("h3",{slot:"header"},l["default"].itemProperties.advancedSettings.manifestUploaderTitle),b.h("div",{slot:"content","class":"manifest-uploader-content"},b.h("div",{"class":"leader-half trailer-half"},l["default"].itemProperties.advancedSettings.manifestFileSelectorTitle),b.h("div",{"class":"trailer-half"},b.h("input",{id:"manifestFile",
name:"manifestFile",type:"file",accept:".json, .txt"}))),b.h("calcite-button",{slot:"secondary",width:"full",disabled:t,onClick:function(){return h.uploadManifestThroughPortal()}},w?b.h("div",{"class":"manifest-uploader-indicator"},b.h("calcite-loader",{label:"uploadingManifest",scale:"m",inline:!0,active:w}),b.h("span",{"class":"manifest-uploading-indicator"},l["default"].itemProperties.advancedSettings.uploading)):b.h("div",null,l["default"].itemProperties.advancedSettings.upload)),b.h("calcite-button",
{slot:"primary",width:"full",disabled:t,onClick:function(){return h.closeManifestUploader()}},l["default"].itemProperties.advancedSettings.cancel))),b.h(p["default"],{id:"hintsViewer"},b.h("calcite-modal",{"aria-labelledby":"modal-title",active:u,fullscreen:!0,oncalciteModalClose:function(){return h.closeHintsViewModal()}},b.h("h3",{slot:"header"},l["default"].itemProperties.advancedSettings.hints),b.h("div",{slot:"content","class":"hintsViewer"},v))),b.h(p["default"],{id:"hintsUploader"},b.h("calcite-modal",
{"aria-labelledby":"modal-title",active:f,scale:"m",width:"m",oncalciteModalClose:function(){return h.closeHintsUploader()}},b.h("h3",{slot:"header"},l["default"].itemProperties.advancedSettings.hintsUploaderTitle),b.h("div",{slot:"content","class":"hints-uploader-content"},b.h("div",{"class":"leader-half trailer-half"},l["default"].itemProperties.advancedSettings.browseHints),b.h("div",{"class":"trailer-half"},b.h("form",{id:"hintsUploadWrapper",encType:"multipart/form-data"},b.h("input",{id:"hintsFile",
name:"hints",type:"file",accept:".json, .txt"})))),b.h("calcite-button",{slot:"secondary",width:"full",disabled:t,onClick:function(){return h.uploadHintsThroughPortal()}},w?b.h("div",{"class":"hints-uploader-indicator"},b.h("calcite-loader",{label:"uploadingHints",scale:"m",inline:!0,active:w}),b.h("span",{"class":"hints-uploading-indicator"},l["default"].itemProperties.advancedSettings.uploading)):b.h("div",null,l["default"].itemProperties.advancedSettings.upload)),b.h("calcite-button",{slot:"primary",
width:"full",disabled:t,onClick:function(){return h.closeHintsUploader()}},l["default"].itemProperties.advancedSettings.cancel))))};return d}(b.Component);U["default"]=e})},"arcgisonline/pages/item/components/bigdatafileshare/NotificationModal":function(){define(["require","exports","tslib","preact"],function(e,U,q,b){Object.defineProperty(U,"__esModule",{value:!0});e=function(l){function p(){return null!==l&&l.apply(this,arguments)||this}q.__extends(p,l);p.prototype.componentDidMount=function(){var r=
this.props.alertIndicator;this.setState({alertIndicatorActive:r.alertIndicatorActive,alertIndicatorColor:r.alertIndicatorColor,alertIndicatorInfo:r.alertIndicatorInfo})};p.prototype.closeNotificationIndicator=function(){this.setState({alertIndicatorActive:!1});this.props.closeNotificationIndicator(!1)};p.prototype.render=function(){var r=this.state,a=r.alertIndicatorActive,c=r.alertIndicatorInfo;return b.h(b.Fragment,null,b.h("calcite-alert",{"class":"display-above",icon:"",label:"notificationIndicator",
"auto-dismiss":!0,"auto-dismiss-duration":"medium",active:a,scale:"m",color:r.alertIndicatorColor,"aria-hidden":!a,oncalciteAlertClose:this.closeNotificationIndicator.bind(this)},b.h("div",{slot:"message"},c)))};return p}(b.Component);U["default"]=e})},"arcgisonline/pages/item/widgets/_outputs":function(){define("require exports tslib dojo/Deferred arcgisonline/tsutils/declareDecorator dijit/_TemplatedMixin dijit/_WidgetBase preact arcgisonline/pages/item/components/bigdatafileshare/Outputs".split(" "),
function(e,U,q,b,l,p,r,a,c){Object.defineProperty(U,"__esModule",{value:!0});b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);c=q.__importDefault(c);e=function(){function d(){this.templateString='\x3cdiv class\x3d"outputsWrapper"\x3e\x3cdiv id\x3d"outputsTab"\x3e\x3c/div\x3e\x3cdiv\x3e'}d.prototype.startup=function(){var h=new b["default"];h.resolve(!0);return h};d.prototype.destroy=function(){this.inherited(arguments)};d.prototype.postCreate=function(){a.render(a.h(c["default"],
{itemId:this.item.id,url:this.item.url,portalUrl:this.item.portal.url,isOwner:this.item.isOwner,userContentUrl:this.item.portalUser.userContentUrl}),this.domNode.querySelector("#outputsTab"))};return d=q.__decorate([l["default"](r["default"],p["default"])],d)}();U["default"]=e})},"arcgisonline/pages/item/components/bigdatafileshare/Outputs":function(){define("require exports tslib preact arcgisonline/sharing/util ../../../utils/arrays arcgisonline/pages/utils/clone ./DataSyncing ./DataFiltering ./DatasetsHeader ./OutputTemplatesBody ./DatasetsPagination ./OutputTemplatesEditing ./NotificationModal dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m){Object.defineProperty(U,"__esModule",{value:!0});l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);e=function(t){function w(){var u=null!==t&&t.apply(this,arguments)||this;u.state={isSyncDisabled:!1,templateFilterText:"",templatesStatus:"downloading",templatesForRendering:[],
selectedTemplateItemIDMap:{},matchedTemplateItemNum:0,shouldDisplayDeleteIcon:!1,isDeletingDataset:!1,sortTemplatesByName:!0,templateNameSortOrder:"ascend",sortTemplatesByType:!1,templateTypeSortOrder:"ascend",counts:{start:0,num:0,total:0},itemPerPage:20,shouldDisplayPagination:!1,isManifestActive:!1,outputTemplatesModalActive:!1,sidebarMenu:["Geometry","Time","Files"],activeMenuItem:"Geometry",isSidebarDisabled:!0,activeTemplateIndex:0,activeTemplateName:"",outputTemplatesAction:"edit",isNotificationModalActive:!1,
alertIndicator:{alertIndicatorActive:!1,alertIndicatorColor:"",alertIndicatorInfo:""}};u.dataStoreID="";u.dataStoreType="";u.templatesAdminURL="";u.portalRequestURL="";u.templateResults={};u.globalTemplateFilterText="";u.filterTextLength=0;return u}q.__extends(w,t);w.prototype.componentDidMount=function(){this.generateURLs();this.getRelatedItems()};w.prototype.generateURLs=function(){var u=this.props.url.split("/"),v=u[0]+"//"+u[2]+"/"+u[3];u=u.filter(function(x){return"bigDataFileShares"===x.substring(0,
17)})[0].split("_");u=u[0]+"/"+u.slice(1).join("_");this.templatesAdminURL=v=v+"/admin/data/items/"+u;v=v.split("/");this.portalRequestURL=v[0]+"//"+v[2]+":6443/arcgis/admin/data/items/"+u};w.prototype.getRelatedItems=function(){var u=this,v=this.props.portalUrl+"content/items/"+this.props.itemId+"/relatedItems";l["default"].request({url:v,content:{relationshipType:"BDFSDataStore2BDFSCatalogService",direction:"reverse"}},{useProxy:l["default"].shouldUseProxy(v)}).then(function(x){x.total?(u.dataStoreType=
"portalBDFS",p["default"].includes(x.relatedItems[0].typeKeyWords,"bigDataFileShare")&&p["default"].includes(x.relatedItems[0].typeKeyWords,"dataStore")?(x=u.props.portalUrl+"content/items/"+x.relatedItems[0].id+"/relatedItems",l["default"].request({url:x,content:{relationshipType:"CloudDataStore2BDFSDataStore",direction:"reverse"}},{useProxy:l["default"].shouldUseProxy(x)}).then(function(y){u.dataStoreID=y.relatedItems[0].id},function(y){u.requestOutputTemplatesErrorHandler()})):u.dataStoreID=x.relatedItems[0].id,
u.requestPortalBDFSData()):(u.dataStoreType="serverBDFS",u.requestServerBDFSDataByAdmin())},function(x){u.requestOutputTemplatesErrorHandler()})};w.prototype.requestPortalBDFSData=function(){var u=this,v=this.props.portalUrl+"content/items/"+this.dataStoreID+"/data";l["default"].request({url:v},{useProxy:l["default"].shouldUseProxy(v)}).then(function(x){u.outputTemplatesRequestSuccessHandler(x)},function(x){u.requestOutputTemplatesErrorHandler()})};w.prototype.requestServerBDFSDataByAdmin=function(){var u=
this,v=this.templatesAdminURL;l["default"].request({url:v},{useProxy:l["default"].shouldUseProxy(v)}).then(function(x){u.dataStoreID=x.id;u.outputTemplatesRequestSuccessHandler(x)},function(x){u.requestServerBDFSDataByPortal()})};w.prototype.requestServerBDFSDataByPortal=function(){var u=this,v=this.portalRequestURL;l["default"].request({url:v},{useProxy:l["default"].shouldUseProxy(v)}).then(function(x){u.dataStoreID=x.id;u.outputTemplatesRequestSuccessHandler(x)},function(x){u.requestOutputTemplatesErrorHandler()})};
w.prototype.outputTemplatesRequestSuccessHandler=function(u){this.templateResults=r["default"](u);u.info.outputTemplates&&u.info.outputTemplates.length?(u=u.info.outputTemplates,u.forEach(function(v){v.isItemFiltered=!0}),this.setState({templatesStatus:"success",templatesForRendering:r["default"](u),shouldDisplayPagination:!0,isSyncDisabled:!1,counts:{start:1,num:this.state.itemPerPage,total:u.length}})):this.requestOutputTemplatesErrorHandler()};w.prototype.requestOutputTemplatesErrorHandler=function(){this.setState({templatesStatus:"fail",
shouldDisplayPagination:!1,counts:{start:0,num:0,total:0}})};w.prototype.requestOutputTemplates=function(u){"portal sharing api"===u?this.requestPortalBDFSData():"admin"===u?this.requestServerBDFSDataByAdmin():"portal"===u&&this.requestServerBDFSDataByPortal()};w.prototype.addNewTemplates=function(u){this.setState({isManifestActive:!0,outputTemplatesAction:"add",isSyncDisabled:u})};w.prototype.disableSyncOutputTemplates=function(u){this.setState({isSyncDisabled:u})};w.prototype.openEditingModal=function(u){this.setState({isManifestActive:!0,
outputTemplatesAction:"edit",activeTemplateName:u})};w.prototype.selectTemplateItem=function(u){var v=r["default"](this.state.selectedTemplateItemIDMap),x=!1;v[u]?(delete v[u],this.state.templatesForRendering.forEach(function(y){y.isItemFiltered&&p["default"].includes(Object.keys(v),y.name)&&(x=!0)})):(v[u]=u,x=!0);this.setState({selectedTemplateItemIDMap:v,shouldDisplayDeleteIcon:x})};w.prototype.flipSortOrder=function(u){"name"===u?this.state.sortTemplatesByName?this.setState({templateNameSortOrder:"ascend"===
this.state.templateNameSortOrder?"descend":"ascend"}):this.setState({sortTemplatesByName:!0,sortTemplatesByType:!1}):"type"===u&&(this.state.sortTemplatesByType?this.setState({templateTypeSortOrder:"ascend"===this.state.templateTypeSortOrder?"descend":"ascend"}):this.setState({sortTemplatesByName:!1,sortTemplatesByType:!0}))};w.prototype.removePropertyBeforeSave=function(u){u.forEach(function(v){delete v.isItemFiltered;delete v.isItemOnCurrentPage});return u};w.prototype.deleteTemplateItem=function(u){var v=
this;this.setState({isDeletingDataset:u});var x=r["default"](this.state.templatesForRendering),y=this.state.matchedTemplateItemNum,C=r["default"](this.state.selectedTemplateItemIDMap);if(2<this.filterTextLength){x=x.filter(function(G){return G.isItemFiltered&&C[G.name]?(y--,delete C[G.name],!1):!0});var z=y;var F="success"}else u=x.length-Object.keys(C).length,x=x.filter(function(G){return C[G.name]?(delete C[G.name],!1):!0}),z=u,F=0===z?"deleted":this.state.templatesStatus;this.templateResults.info.outputTemplates=
this.removePropertyBeforeSave(r["default"](x));u="portalBDFS"===this.dataStoreType?this.props.userContentUrl+"/items/"+this.dataStoreID+"/update":this.templatesAdminURL+"/edit";var O="portalBDFS"===this.dataStoreType?{text:JSON.stringify(this.templateResults)}:{item:JSON.stringify(this.templateResults)};l["default"].request({url:u,content:O},{useProxy:l["default"].shouldUseProxy(u),usePost:!0}).then(function(G){"portalBDFS"===v.dataStoreType?G.success?V():K():"success"===G.status?(D(),v.requestServerBDFSDataByAdmin()):
J()},function(G){J()});var V=function(){var G=v.props.portalUrl+"portals/self/servers";l["default"].request({url:G},{useProxy:l["default"].shouldUseProxy(G)}).then(function(I){(null===I||void 0===I?0:I.servers)?I.servers.some(function(R){-1<R.serverFunction.indexOf("GeoAnalytics")&&N(R.id);return-1<R.serverFunction.indexOf("GeoAnalytics")}):K()},function(I){K()})},N=function(G){var I=v.props.portalUrl+"portals/self/datastores/refreshServer";l["default"].request({url:I,content:{datastoreId:v.dataStoreID,
serverId:G}},{useProxy:l["default"].shouldUseProxy(I),usePost:!0}).then(function(R){R.success?(D(),v.requestPortalBDFSData()):K()},function(R){K()})},J=function(){var G=v.portalRequestURL+"/edit";l["default"].request({url:G,content:O},{useProxy:l["default"].shouldUseProxy(G),usePost:!0}).then(function(I){"success"===I.status?(D(),v.requestServerBDFSDataByPortal()):K()},function(I){K()})},D=function(){v.displayNotificationIndicator(!0,m["default"].itemProperties.notificationIndicator.alertIndicatorColor.green,
m["default"].itemProperties.notificationIndicator.alertIndicatorInfo.outputTemplateDelete.success);var G=0===z?0:v.state.counts.num,I=v.recalculatePagination(z,G);v.setState({templatesForRendering:x,templatesStatus:F,counts:{start:I.start,num:G,total:z},matchedTemplateItemNum:y,selectedTemplateItemIDMap:C,shouldDisplayPagination:I.shouldDisplayPagination,shouldDisplayDeleteIcon:!1,isDeletingDataset:!1})},K=function(){v.displayNotificationIndicator(!0,m["default"].itemProperties.notificationIndicator.alertIndicatorColor.red,
m["default"].itemProperties.notificationIndicator.alertIndicatorInfo.outputTemplateDelete.failure);v.setState({templatesForRendering:v.state.templatesForRendering,isDeletingDataset:!1})}};w.prototype.onFilterChanged=function(u){var v=this,x=u.trim();this.filterTextLength=x.length;2>=this.filterTextLength&&(x="");if(x!==this.globalTemplateFilterText){this.globalTemplateFilterText=x;x=r["default"](this.state.templatesForRendering);var y=this.filterTemplateSource(x);x=y.templatesForRendering;y=y.filteredTemplates.length;
var C=0===y?0:this.state.itemPerPage;var z=this.recalculatePagination(y,C),F=z.shouldDisplayPagination;z={start:z.start,num:C,total:y};this.globalTemplateFilterText?(x=this.processFilteredResults(x),C="success"):(C=0===y?"deleted":this.state.templatesStatus,z.total=y);var O=!1;x.forEach(function(V){V.isItemFiltered&&p["default"].includes(Object.keys(v.state.selectedTemplateItemIDMap),V.name)&&(O=!0)});this.setState({counts:z,templateFilterText:u,templatesStatus:C,templatesForRendering:r["default"](x),
matchedTemplateItemNum:y,shouldDisplayPagination:F,shouldDisplayDeleteIcon:O})}else this.setState({templateFilterText:u})};w.prototype.filterTemplateSource=function(u){var v=this,x=u.filter(function(y){return v.doesFilterMatch(y)});return{templatesForRendering:u,filteredTemplates:x}};w.prototype.doesFilterMatch=function(u){if(this.globalTemplateFilterText){var v=this.globalTemplateFilterText.split(" ");u.isItemFiltered=v.some(function(x){return-1<u.name.toLowerCase().indexOf(x.toLocaleLowerCase())})}else u.isItemFiltered=
!0;return u.isItemFiltered};w.prototype.processFilteredResults=function(u){var v=[],x=0,y=u.length-1;u.forEach(function(C){C.isItemFiltered?(v[x]=C,x++):(v[y]=C,y--)});return v};w.prototype.changePage=function(u){this.setState({counts:u})};w.prototype.setItemPerPage=function(u){var v=this.state.counts.total;u=0===v?0:Number(u);v={start:this.recalculatePagination(v,u).start,num:u,total:v};this.setState({itemPerPage:u,counts:v})};w.prototype.recalculatePagination=function(u,v){if(0===u)return{start:0,
shouldDisplayPagination:!1};var x=Math.ceil(this.state.counts.start/this.state.counts.num);return{start:Math.ceil(u/v)>=x?(x-1)*v+1:1,shouldDisplayPagination:!0}};w.prototype.closeEditingModal=function(u){this.setState({isManifestActive:u})};w.prototype.updateManifest=function(u){this.setState({templatesForRendering:u})};w.prototype.displayNotificationIndicator=function(u,v,x){this.setState({isNotificationModalActive:!0,alertIndicator:{alertIndicatorActive:u,alertIndicatorColor:v,alertIndicatorInfo:x}})};
w.prototype.closeNotificationIndicator=function(u){this.setState({isNotificationModalActive:u})};w.prototype.render=function(){var u=this.state,v=u.isSyncDisabled,x=u.templatesStatus,y=u.templatesForRendering,C=u.templateFilterText,z=u.shouldDisplayDeleteIcon,F=u.isDeletingDataset,O=u.counts,V=u.selectedTemplateItemIDMap,N=u.sortTemplatesByName,J=u.templateNameSortOrder,D=u.sortTemplatesByType,K=u.templateTypeSortOrder,G=u.outputTemplatesAction,I=u.isManifestActive,R=u.shouldDisplayPagination,A=u.itemPerPage,
B=u.activeTemplateName,H=u.isSidebarDisabled,T=u.alertIndicator;u=u.isNotificationModalActive;var M=this.props.isOwner;return b.h(b.Fragment,null,b.h("div",{"class":"outputTemplatesHeader"},b.h("div",{"class":"grid-container"},b.h("div",{"class":"column-24 flex"},M&&b.h(a["default"],{entryComponent:"outputs",isSyncDisabled:v,syncDatasets:this.addNewTemplates.bind(this)}),b.h(c["default"],{page:"Outputs",datasetsStatus:x,datasetsForRendering:y,dataFilterText:C,onFilterChanged:this.onFilterChanged.bind(this)})))),
b.h("div",{"class":"grid-container"},b.h(d["default"],{isOwner:M,shouldDisplayDeleteIcon:z,isDeletingDataset:F,counts:O,deleteDatasetItem:this.deleteTemplateItem.bind(this)}),b.h(h["default"],{templatesStatus:x,templatesForRendering:y,counts:O,selectedTemplateItemIDMap:V,sortTemplatesByName:N,templateNameSortOrder:J,sortTemplatesByType:D,templateTypeSortOrder:K,openEditingModal:this.openEditingModal.bind(this),selectTemplateItem:this.selectTemplateItem.bind(this),flipSortOrder:this.flipSortOrder.bind(this)})),
b.h(f["default"],{shouldDisplayPagination:R,counts:O,itemPerPage:A,changePage:this.changePage.bind(this),setItemPerPage:this.setItemPerPage.bind(this)}),I&&b.h(g["default"],{isOwner:M,dataStoreType:this.dataStoreType,portalUrl:this.props.portalUrl,portalRequestURL:this.portalRequestURL,userContentUrl:this.props.userContentUrl,dataStoreID:this.dataStoreID,activeTemplateName:B,isSidebarDisabled:H,templatesStatus:x,templatesForRendering:y,templatesAdminURL:this.templatesAdminURL,templateResults:this.templateResults,
outputTemplatesAction:G,disableSyncOutputTemplates:this.disableSyncOutputTemplates.bind(this),requestOutputTemplates:this.requestOutputTemplates.bind(this),displayNotificationIndicator:this.displayNotificationIndicator.bind(this),closeOutputTemplatesModal:this.closeEditingModal.bind(this),updateManifest:this.updateManifest.bind(this)}),u&&b.h(n["default"],{alertIndicator:T,closeNotificationIndicator:this.closeNotificationIndicator.bind(this)}))};return w}(b.Component);U["default"]=e})},"arcgisonline/pages/item/components/bigdatafileshare/OutputTemplatesBody":function(){define(["require",
"exports","tslib","preact","dojo/i18n!arcgisonline/nls/arcgisonline"],function(e,U,q,b,l){Object.defineProperty(U,"__esModule",{value:!0});l=q.__importDefault(l);e=function(p){function r(){return null!==p&&p.apply(this,arguments)||this}q.__extends(r,p);r.prototype.sortTemplates=function(a){var c=this;if(!this.props.sortTemplatesByName&&!this.props.sortTemplatesByType)return a;a.sort(function(d,h){var f,g,n,m;if(d.isItemFiltered&&h.isItemFiltered){var t=null===(g=c.props.sortTemplatesByName?d.name:
null===(f=d.format)||void 0===f?void 0:f.type)||void 0===g?void 0:g.toLowerCase();f=null===(m=c.props.sortTemplatesByName?h.name:null===(n=h.format)||void 0===n?void 0:n.type)||void 0===m?void 0:m.toLowerCase();n=c.props.sortTemplatesByName?c.props.templateNameSortOrder:c.props.templateTypeSortOrder;return t>f?"ascend"===n?1:-1:t<f?"ascend"===n?-1:1:0}});return a};r.prototype.processTemplates=function(a){var c=this;return a.map(function(d,h){var f=h>=c.props.counts.start-1&&h<c.props.counts.start+
c.props.counts.num-1;return q.__assign(q.__assign({},d),{isItemOnCurrentPage:f})})};r.prototype.flipSortOrder=function(a){this.props.flipSortOrder(a)};r.prototype.generateSortStylings=function(){var a=function(c,d){return b.h("div",{"class":"output-template-sort output-template-sort--"+(d||"descend")+" "+(c?"":"hide")})};return{sortDivByName:a(this.props.sortTemplatesByName,this.props.templateNameSortOrder),sortDivByType:a(this.props.sortTemplatesByType,this.props.templateTypeSortOrder)}};r.prototype.displayTemplateTypeLabel=
function(a){return l["default"].itemProperties.datasetsManifest.file[a]};r.prototype.createTemplatesTSX=function(a,c){var d=this,h=this.sortTemplates(a);h=this.processTemplates(h).map(function(n){var m=n.isItemFiltered&&n.isItemOnCurrentPage?"":" hide",t=d.props.selectedTemplateItemIDMap[n.name]?!0:!1,w=d.displayTemplateTypeLabel(n.format.type);return b.h("div",{key:n.name,"class":"datasets-table-row"+m,role:"row"},b.h("label",{"class":"datasets-table-cell datasets-table-checkbox",role:"cell"},b.h("input",
{type:"checkbox",checked:t,"aria-label":"Select Item",onChange:d.selectTemplateItem.bind(d,n.name)})),b.h("span",{"class":"datasets-table-cell datasets-table-cell-medium",role:"cell"},b.h("span",{"class":"datasets-table-cell-name"},n.name)),b.h("span",{"class":"datasets-table-cell datasets-table-cell-medium",role:"cell"},b.h("span",{"class":"datasets-table-cell-name"},w)),b.h("span",{"class":"datasets-table-cell datasets-table-cell-medium datasets-table-edit",onClick:d.openEditingModal.bind(d,n.name),
role:"cell"},b.h("calcite-icon",{"class":"icon-ui-edit"}),b.h("span",null,l["default"].itemProperties.datasetsTable.edit)))});var f=this.generateSortStylings(),g=f.sortDivByName;f=f.sortDivByType;h=b.h("div",{key:"outputTemplateskey","class":"datasets-table"},b.h("div",{"class":"datasets-table-head",role:"rowgroup"},b.h("div",{"class":"datasets-table-row datasets-table-row-header",role:"row"},b.h("span",{"class":"datasets-table-cell datasets-table-cell-th datasets-table-cell-extra-small",role:"columnheader"},
b.h("div",{"class":"datasets-table-cell-sort"})),b.h("span",{"class":"datasets-table-cell datasets-table-cell-th datasets-table-cell-medium",role:"columnheader",onClick:this.flipSortOrder.bind(this,"name")},b.h("div",{"class":"datasets-table-cell-sort"+(this.props.sortTemplatesByName?" output-templates-table-header":"")},l["default"].itemProperties.datasetsTable.dataset),g),b.h("span",{"class":"datasets-table-cell datasets-table-cell-th datasets-table-cell-medium",role:"columnheader",onClick:this.flipSortOrder.bind(this,
"type")},b.h("div",{"class":"datasets-table-cell-sort"+(this.props.sortTemplatesByType?" output-templates-table-header":"")},l["default"].itemProperties.datasetsTable.type),f),b.h("span",{"class":"datasets-table-cell datasets-table-cell-th datasets-table-cell-medium",role:"columnheader"},b.h("div",{"class":"datasets-table-cell-sort"},l["default"].itemProperties.datasetsTable.operation)))),b.h("div",{"class":"datasets-table-rows",role:"rowgroup"},h));g="";"downloading"===c?g=l["default"].itemProperties.datasetsTable.datasetsStatusMessage.downloading:
"fail"===c?g=l["default"].itemProperties.datasetsTable.datasetsStatusMessage.fail:"success"===c?0===this.props.counts.total&&(h=b.h("div",{"class":"text-center leader-1 text-constrain margin-auto"},l["default"].itemProperties.datasetsTable.datasetsStatusMessage.success)):"deleted"===c&&(h=b.h("div",{"class":"text-center leader-1 text-constrain margin-auto"},l["default"].itemProperties.datasetsTable.datasetsStatusMessage.deleted));""!==g&&(h=b.h("div",{"class":"padding-leader-half"},b.h("em",null,
g)));return h};r.prototype.selectTemplateItem=function(a){this.props.selectTemplateItem(a)};r.prototype.openEditingModal=function(a){this.props.openEditingModal(a)};r.prototype.render=function(){var a=this.props;a=this.createTemplatesTSX(a.templatesForRendering,a.templatesStatus);return b.h(b.Fragment,null,b.h("div",{"class":"column-24 padding-leader-half padding-trailer-5 templates-table-wrapper"},a))};return r}(b.Component);U["default"]=e})},"arcgisonline/pages/item/components/bigdatafileshare/OutputTemplatesEditing":function(){define("require exports tslib preact dojo/i18n!arcgisonline/nls/arcgisonline arcgisonline/pages/components/BodyAppender arcgisonline/sharing/util ../../../utils/arrays arcgisonline/pages/utils/clone".split(" "),
function(e,U,q,b,l,p,r,a,c){Object.defineProperty(U,"__esModule",{value:!0});l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);e=function(d){function h(){var f=null!==d&&d.apply(this,arguments)||this;f.state={templatesForRendering:[],templatesStatus:"downloading",activeTemplateIndex:0,modalActive:!1,isSidebarDisabled:!0,sidebarMenu:[{label:l["default"].itemProperties.datasetsManifest.sidebarMenu.geometry,value:"Geometry"},{label:l["default"].itemProperties.datasetsManifest.sidebarMenu.time,
value:"Time"}],activeMenuItem:"Geometry",isModalButtonDisabled:!1,progressIndicatorActive:!1,isReadOnly:!f.props.isOwner,isTimeErrorActive:!1,isGeometryErrorActive:!1,disableInstantAddButton:!0,disableIntervalStartAddButton:!0,disableIntervalEndAddButton:!0};f.templateResults={};f.originalOutputTemplates=[];f.hasTimeValidationError=!1;f.hasGeometryValidationError=!1;return f}q.__extends(h,d);h.prototype.componentDidMount=function(){var f=this.preprocessTimeProperty(c["default"](this.props.templatesForRendering));
f=this.preprocessGeometryProperty(f);this.templateResults=c["default"](this.props.templateResults);this.originalOutputTemplates=c["default"](f);this.setState({isSidebarDisabled:this.props.isSidebarDisabled,templatesForRendering:f,templatesStatus:this.props.templatesStatus});"edit"===this.props.outputTemplatesAction?this.openEditingModal(this.props.activeTemplateName,f):this.addOutputTemplates(f);this.props.disableSyncOutputTemplates(!1)};h.prototype.addOutputTemplates=function(f){var g={name:"Template Example",
title:"Template Example",format:{}};g.format.type="delimited";g.isItemFiltered=!1;f=c["default"](f);f.push(g);f=this.preprocessGeometryProperty(f);f=this.preprocessTimeProperty(f);this.renderEditingModal(f.length-1,f,"Geometry","add")};h.prototype.preprocessGeometryProperty=function(f){var g=this;f.forEach(function(n,m){n.geometry||(n.geometry={});n.geometry.spatialReference||(n.geometry.spatialReference={},n.geometry.spatialReference.wkid="");if(!n.geometry.encodings){n.geometry.encodings=[];var t=
[{name:"",formats:[]}];["esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon"].forEach(function(N){var J=[];J=[N];n.geometry.encodings.push({types:J,fields:t})})}if(3===n.geometry.encodings.length){var w=n.geometry.encodings;w.forEach(function(N){"esriGeometryPoint"===N.types[0]&&2===N.fields.length&&g.organizePointXYZField(N)})}else if(2===n.geometry.encodings.length){w=c["default"](n.geometry.encodings);var u,v=["esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon"],x=[],y=
[];n.geometry.encodings.forEach(function(N){2===N.types.length&&(u=N);N.types.forEach(function(J){y.push(J)})});v.forEach(function(N){-1===y.indexOf(N)&&x.push(N)});2===y.length?(n.geometry.encodings=[],x.forEach(function(N){n.geometry.encodings.push({types:[N],fields:[{name:"",formats:[]}]})}),w.forEach(function(N){if(1===N.fields.length)var J={types:[N.types[0]],fields:[{name:N.fields[0].name?N.fields[0].name:"",formats:[N.fields[0].formats[0]]}]};else 3===N.fields.length?J={types:[N.types[0]],
fields:[{name:N.fields[0].name?N.fields[0].name:"",formats:[N.fields[0].formats[0]]},{name:N.fields[1].name?N.fields[1].name:"",formats:[N.fields[1].formats[0]]},{name:N.fields[2].name?N.fields[2].name:"",formats:[N.fields[2].formats[0]]}]}:2===N.fields.length&&(g.organizePointXYZField(N),J=N);n.geometry.encodings.push(J)})):3===y.length&&(n.geometry.encodings=[],w=w.filter(function(N){return 2===N.types.length?!1:!0}),u.types.forEach(function(N){n.geometry.encodings.push({types:[N],fields:[{name:u.fields[0].name?
u.fields[0].name:"",formats:[u.fields[0].formats[0]]}]})}),w.forEach(function(N){if(1===N.fields.length)var J={types:[N.types[0]],fields:[{name:N.fields[0].name?N.fields[0].name:"",formats:[N.fields[0].formats[0]]}]};else 3===N.fields.length?J={types:[N.types[0]],fields:[{name:N.fields[0].name?N.fields[0].name:"",formats:[N.fields[0].formats[0]]},{name:N.fields[1].name?N.fields[1].name:"",formats:[N.fields[1].formats[0]]},{name:N.fields[2].name?N.fields[2].name:"",formats:[N.fields[2].formats[0]]}]}:
2===N.fields.length&&(g.organizePointXYZField(N),J=N);n.geometry.encodings.push(J)}))}else if(1===n.geometry.encodings.length){var C=n.geometry.encodings[0].types,z=n.geometry.encodings[0].fields;if(3===C.length)n.geometry.encodings=[],["esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon"].forEach(function(N){var J=[];J=[N];n.geometry.encodings.push({types:J,fields:[{name:z[0].name?z[0].name:"",formats:[z[0].formats[0]]}]})});else if(2===C.length||1===C.length&&1===z.length){n.geometry.encodings=
[];var F=[{name:z[0].name?z[0].name:"",formats:[z[0].formats[0]]}];v=["esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon"];var O=v.filter(function(N){return-1<C.indexOf(N)?!1:!0});v.forEach(function(N){if(-1===O.indexOf(N)){var J=[];J=[N];n.geometry.encodings.push({types:J,fields:F})}});O.forEach(function(N){n.geometry.encodings.push({types:[N],fields:[{name:"",formats:[]}]})})}else if(1===C.length&&3===z.length){n.geometry.encodings=[];v=["esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon"];
var V=v.filter(function(N){return-1<C.indexOf(N)?!1:!0});v.forEach(function(N){if(-1===V.indexOf(N)){var J=[];J=[N];n.geometry.encodings.push({types:J,fields:[{name:z[0].name?z[0].name:"",formats:[z[0].formats[0]]},{name:z[1].name?z[1].name:"",formats:[z[1].formats[0]]},{name:z[2].name?z[2].name:"",formats:[z[2].formats[0]]}]})}});V.forEach(function(N){n.geometry.encodings.push({types:[N],fields:[{name:"",formats:[]}]})})}else 1===C.length&&2===z.length&&g.organizePointXYZField(n.geometry.encodings[0])}});
return f};h.prototype.organizePointXYZField=function(f){f.fields.push({name:"",formats:["z"]})};h.prototype.preprocessTimeProperty=function(f){var g=this;f.forEach(function(n){n.time||(n.time={});n.time.timeReference||(n.time.timeReference={},n.time.timeReference.timeZone="UTC");n.time.encodings||(n.time.encodings=[],n=g.constructTimeInstantProperty(n),n=g.constructTimeIntervalProperty(n));if(1===n.time.encodings.length)if("instant"===n.time.encodings[0].types[0])n=g.constructTimeIntervalProperty(n);
else{var m=[];n.time.encodings[0].fields.forEach(function(w){a["default"].includes(m,w.role)||m.push(w.role)});1===m.length&&(a["default"].includes(m,"start")?g.constructTimeIntervalFields(n,0,"end"):g.constructTimeIntervalFields(n,0,"start"));n=g.constructTimeInstantProperty(n)}else if(2===n.time.encodings.length){var t=[];n.time.encodings.forEach(function(w,u){a["default"].includes(w.types,"interval")&&(w.fields.forEach(function(v){a["default"].includes(t,v.role[0])||t.push(v.role[0])}),1===t.length&&
(a["default"].includes(t,"start")?g.constructTimeIntervalFields(n,u,"end"):g.constructTimeIntervalFields(n,u,"start")))})}});return f};h.prototype.constructTimeInstantProperty=function(f){var g={types:[]};g.types.push("instant");g.fields=[];g.fields.push({name:"",formats:[]});f.time.encodings.push(g);return f};h.prototype.constructTimeIntervalProperty=function(f){var g={types:[]};g.types.push("interval");g.fields=[];g.fields.push({name:"",formats:[],role:["start"]});g.fields.push({name:"",formats:[],
role:["end"]});f.time.encodings.push(g);return f};h.prototype.constructTimeIntervalFields=function(f,g,n){var m={name:"",formats:[]};m.role=[n];f.time.encodings[g].fields.push(m);return f};h.prototype.openEditingModal=function(f,g){var n=0;c["default"](g).forEach(function(m,t){m.name===f&&(n=t)});this.renderEditingModal(n,g,this.state.activeMenuItem,"edit")};h.prototype.renderEditingModal=function(f,g,n,m){this.setState({modalActive:!0,activeTemplateIndex:f,templatesForRendering:g,activeMenuItem:n,
isModalButtonDisabled:!1})};h.prototype.closeOutputTemplatesModal=function(f){if(this.state.modalActive){var g=[];"save"===f?(g=c["default"](this.state.templatesForRendering),this.originalOutputTemplates=c["default"](this.state.templatesForRendering)):g=c["default"](this.originalOutputTemplates);this.setState({modalActive:!1,activeMenuItem:"Geometry",templatesForRendering:g,isTimeErrorActive:!1,isGeometryErrorActive:!1})}this.props.closeOutputTemplatesModal(!1)};h.prototype.removePropertyBeforeSave=
function(f){f.forEach(function(g){delete g.isItemFiltered;delete g.isItemOnCurrentPage});return f};h.prototype.saveOutputTemplatesModal=function(){var f=this;if(this.hasTimeValidationError||this.hasGeometryValidationError)this.setState({isTimeErrorActive:this.hasTimeValidationError,isGeometryErrorActive:this.hasGeometryValidationError});else{this.setState({isModalButtonDisabled:!0,progressIndicatorActive:!0,isTimeErrorActive:!1,isGeometryErrorActive:!1});var g=this.removePropertyBeforeSave(c["default"](this.state.templatesForRendering));
this.templateResults.info.outputTemplates=this.removeEmptyProperty(g);g="portalBDFS"===this.props.dataStoreType?this.props.userContentUrl+"/items/"+this.props.dataStoreID+"/update":this.props.templatesAdminURL+"/edit";var n="portalBDFS"===this.props.dataStoreType?{text:JSON.stringify(this.templateResults)}:{item:JSON.stringify(this.templateResults)};r["default"].request({url:g,content:n},{useProxy:r["default"].shouldUseProxy(g),usePost:!0}).then(function(x){"portalBDFS"===f.props.dataStoreType?x.success?
m():v():"success"===x.status?(u(),f.props.requestOutputTemplates("admin")):w()},function(x){w()});var m=function(){var x=f.props.portalUrl+"portals/self/servers";r["default"].request({url:x},{useProxy:r["default"].shouldUseProxy(x)}).then(function(y){(null===y||void 0===y?0:y.servers)?y.servers.some(function(C){-1<C.serverFunction.indexOf("GeoAnalytics")&&t(C.id);return-1<C.serverFunction.indexOf("GeoAnalytics")}):v()},function(y){v()})},t=function(x){var y=f.props.portalUrl+"portals/self/datastores/refreshServer";
r["default"].request({url:y,content:{datastoreId:f.props.dataStoreID,serverId:x}},{useProxy:r["default"].shouldUseProxy(y),usePost:!0}).then(function(C){C.success?(u(),f.props.requestOutputTemplates("portal sharing api")):v()},function(C){v()})},w=function(){var x=f.props.portalRequestURL+"/edit";r["default"].request({url:x,content:n},{useProxy:r["default"].shouldUseProxy(x),usePost:!0}).then(function(y){"success"===y.status?(u(),f.props.requestOutputTemplates("portal")):v()},function(y){v()})},u=
function(){f.props.updateManifest(f.state.templatesForRendering);f.closeOutputTemplatesModal("save");f.setState({isModalButtonDisabled:!1,progressIndicatorActive:!1});f.props.displayNotificationIndicator(!0,l["default"].itemProperties.notificationIndicator.alertIndicatorColor.green,"edit"===f.props.outputTemplatesAction?l["default"].itemProperties.notificationIndicator.alertIndicatorInfo.outputTemplateUpdate.success:l["default"].itemProperties.notificationIndicator.alertIndicatorInfo.outputTemplateAdd.success)},
v=function(){f.setState({isModalButtonDisabled:!1,progressIndicatorActive:!1,templatesForRendering:f.state.templatesForRendering});f.props.displayNotificationIndicator(!0,l["default"].itemProperties.notificationIndicator.alertIndicatorColor.red,"edit"===f.props.outputTemplatesAction?l["default"].itemProperties.notificationIndicator.alertIndicatorInfo.outputTemplateUpdate.failure:l["default"].itemProperties.notificationIndicator.alertIndicatorInfo.outputTemplateAdd.failure)}}};h.prototype.checkSidebarItem=
function(f,g){g.preventDefault();this.renderEditingModal(this.state.activeTemplateIndex,this.state.templatesForRendering,f,this.props.outputTemplatesAction)};h.prototype.convertFromEsriGeometryType=function(f){var g,n;f=null===(n=null===(g=null===f||void 0===f?void 0:f[0])||void 0===g?void 0:g.types)||void 0===n?void 0:n[0];return"esriGeometryPoint"===f?l["default"].itemProperties.datasetsManifest.geometry.point:"esriGeometryPolyline"===f?l["default"].itemProperties.datasetsManifest.geometry.polyline:
"esriGeometryPolygon"===f?l["default"].itemProperties.datasetsManifest.geometry.polygon:l["default"].itemProperties.datasetsManifest.geometry.none};h.prototype.convertToEsriGeometryType=function(f){return f===l["default"].itemProperties.datasetsManifest.geometry.point?"esriGeometryPoint":f===l["default"].itemProperties.datasetsManifest.geometry.polyline?"esriGeometryPolyline":f===l["default"].itemProperties.datasetsManifest.geometry.polygon?"esriGeometryPolygon":l["default"].itemProperties.datasetsManifest.geometry.none};
h.prototype.retrieveTemplateProperty=function(f,g,n){if(g[f]){var m=g[f];f=m.format;g=m.geometry;n=m.name;var t=m.time;m=null===g||null===g.encodings?"None":this.convertFromEsriGeometryType(g.encodings);t=this.initializeTimeProperty(t);var w=t.timeInstantArr,u=t.timeIntervalStartArr,v=t.timeIntervalEndArr;return{templateName:n,geometry:g,geometryType:m,timeInstantArr:w,timeIntervalStartArr:u,timeIntervalEndArr:v,timeZone:t.timeZone,fileFormat:f}}g={};w=[];u=[];v=[];f={};return{templateName:"",geometry:g,
geometryType:"None",timeInstantArr:w,timeIntervalStartArr:u,timeIntervalEndArr:v,timeZone:"",fileFormat:f}};h.prototype.templateNameChange=function(f){f=f.target;var g=this.getTemplatesAndEncodings().outputTemplates;g[this.state.activeTemplateIndex].name=f.value;g[this.state.activeTemplateIndex].title=f.value;this.setState({templatesForRendering:g})};h.prototype.createTemplatesPropertyMenu=function(f){var g=this;return f.map(function(n,m){return b.h("button",{key:m,"class":"btn-link btn-link-darker-gray font-size--1 data-property-sidebar-menu-item"+
(g.state.activeMenuItem===n.value?" data-property-sidebar-menu-item--active":""),onClick:g.checkSidebarItem.bind(g,n.value)},n.label)})};h.prototype.checkGeometryError=function(f,g){var n=null===g||void 0===g?void 0:g.some(function(m){var t;return null===(t=null===m||void 0===m?void 0:m.fields)||void 0===t?void 0:t.some(function(w){var u,v;return(null===(u=null===w||void 0===w?void 0:w.formats)||void 0===u?void 0:u[0])&&"None"!==(null===(v=null===w||void 0===w?void 0:w.formats)||void 0===v?void 0:
v[0])})});return""===(null===f||void 0===f?void 0:f.wkid)&&n};h.prototype.createGeometryTSX=function(f){var g=f.spatialReference;f=f.encodings;this.hasGeometryValidationError=this.checkGeometryError(g,f);return{geometrySpatialReference:g,encodings:f}};h.prototype.spatialReferenceChange=function(f){f=f.target;var g=this.getTemplatesAndEncodings().outputTemplates,n=g[this.state.activeTemplateIndex].geometry.spatialReference;n||(n={});n.wkid=f.value;this.setState({templatesForRendering:g})};h.prototype.pointGeometryFormatTypeChange=
function(f){f=f.target;var g=this.getTemplatesAndEncodings().outputTemplates,n=[];"XYZ"===f.value?(n.push({name:"",formats:["x"]}),n.push({name:"",formats:["y"]}),n.push({name:"",formats:["z"]})):n.push({name:"",formats:[f.value]});g[this.state.activeTemplateIndex].geometry.encodings.forEach(function(m){-1<m.types.indexOf("esriGeometryPoint")&&(m.fields=n)});this.setState({templatesForRendering:g})};h.prototype.geometryFieldXChange=function(f){var g=f.target;f=this.getTemplatesAndEncodings();var n=
f.outputTemplates;f.encodings.forEach(function(m){-1<m.types.indexOf("esriGeometryPoint")&&(m.fields[0].name=g.value)});this.setState({templatesForRendering:n})};h.prototype.geometryFieldYChange=function(f){var g=f.target;f=this.getTemplatesAndEncodings();var n=f.outputTemplates;f.encodings.forEach(function(m){-1<m.types.indexOf("esriGeometryPoint")&&(m.fields[1].name=g.value)});this.setState({templatesForRendering:n})};h.prototype.geometryFieldZChange=function(f){var g=f.target;f=this.getTemplatesAndEncodings();
var n=f.outputTemplates;f.encodings.forEach(function(m){-1<m.types.indexOf("esriGeometryPoint")&&(m.fields[2].name=g.value)});this.setState({templatesForRendering:n})};h.prototype.geometryFieldNonXYZChange=function(f){var g=f.target;f=this.getTemplatesAndEncodings();var n=f.outputTemplates;f.encodings.forEach(function(m){-1<m.types.indexOf("esriGeometryPoint")&&(m.fields[0].name=g.value)});this.setState({templatesForRendering:n})};h.prototype.polylineGeometryFormatTypeChange=function(f){var g=f.target;
f=this.getTemplatesAndEncodings();var n=f.outputTemplates;f.encodings.forEach(function(m){-1<m.types.indexOf("esriGeometryPolyline")&&(m.fields[0].formats[0]=g.value)});this.setState({templatesForRendering:n})};h.prototype.polylineGeometryFieldValueChange=function(f){var g=f.target;f=this.getTemplatesAndEncodings();var n=f.outputTemplates;f.encodings.forEach(function(m){-1<m.types.indexOf("esriGeometryPolyline")&&(m.fields[0].name=g.value)});this.setState({templatesForRendering:n})};h.prototype.polygonGeometryFormatTypeChange=
function(f){var g=f.target;f=this.getTemplatesAndEncodings();var n=f.outputTemplates;f.encodings.forEach(function(m){-1<m.types.indexOf("esriGeometryPolygon")&&(m.fields[0].formats[0]=g.value)});this.setState({templatesForRendering:n})};h.prototype.polygonGeometryFieldValueChange=function(f){var g=f.target;f=this.getTemplatesAndEncodings();var n=f.outputTemplates;f.encodings.forEach(function(m){-1<m.types.indexOf("esriGeometryPolygon")&&(m.fields[0].name=g.value)});this.setState({templatesForRendering:n})};
h.prototype.getTemplatesAndEncodings=function(){var f=c["default"](this.state.templatesForRendering);return{outputTemplates:f,encodings:f[this.state.activeTemplateIndex].geometry.encodings}};h.prototype.initializeTimeProperty=function(f){var g,n=(null===(g=null===f||void 0===f?void 0:f.timeReference)||void 0===g?void 0:g.timeZone)||"UTC",m=[],t=[],w=[];f.encodings.forEach(function(u){var v=u.fields;if("instant"===u.types[0]){var x=0;v.forEach(function(z){m.push({id:x,timeField:z.name?z.name:"",timeFormat:z.formats?
z.formats[0]:""});x++})}else if("interval"===u.types[0]){var y=0,C=0;v.forEach(function(z){var F=z.formats?z.formats[0]:"",O=z.name?z.name:"";a["default"].includes(z.role,"start")?(t.push({id:y,timeField:O,timeFormat:F}),y++):a["default"].includes(z.role,"end")&&(w.push({id:C,timeField:O,timeFormat:F}),C++)})}});1>=m.length&&""!==m[0].timeField&&""!==m[0].timeFormat&&(this.state.disableInstantAddButton=!1);1>=t.length&&""!==t[0].timeField&&""!==t[0].timeFormat&&(this.state.disableIntervalStartAddButton=
!1);1>=w.length&&""!==w[0].timeField&&""!==w[0].timeFormat&&(this.state.disableIntervalEndAddButton=!1);return{timeInstantArr:m,timeIntervalStartArr:t,timeIntervalEndArr:w,timeZone:n}};h.prototype.createTimeZoneList=function(){return[{canonicalID:"Etc/GMT+12"},{canonicalID:"Etc/GMT+11"},{canonicalID:"Etc/GMT+10"},{canonicalID:"Pacific/Marquesas"},{canonicalID:"Etc/GMT+9"},{canonicalID:"Etc/GMT+8"},{canonicalID:"Etc/GMT+7"},{canonicalID:"Etc/GMT+6"},{canonicalID:"Etc/GMT+5"},{canonicalID:"Etc/GMT+4"},
{canonicalID:"America/St_Johns"},{canonicalID:"Etc/GMT+3"},{canonicalID:"Etc/GMT+2"},{canonicalID:"Etc/GMT+1"},{canonicalID:"Etc/GMT"},{canonicalID:"UTC"},{canonicalID:"Etc/GMT-1"},{canonicalID:"Etc/GMT-2"},{canonicalID:"Etc/GMT-3"},{canonicalID:"Asia/Tehran"},{canonicalID:"Etc/GMT-4"},{canonicalID:"Asia/Kabul"},{canonicalID:"Etc/GMT-5"},{canonicalID:"Asia/Colombo"},{canonicalID:"Asia/Kathmandu"},{canonicalID:"Etc/GMT-6"},{canonicalID:"Asia/Yangon"},{canonicalID:"Etc/GMT-7"},{canonicalID:"Etc/GMT-8"},
{canonicalID:"Australia/Eucla"},{canonicalID:"Etc/GMT-9"},{canonicalID:"Australia/Adelaide"},{canonicalID:"Etc/GMT-10"},{canonicalID:"Australia/Lord_Howe"},{canonicalID:"Etc/GMT-11"},{canonicalID:"Etc/GMT-12"},{canonicalID:"Pacific/Chatham"},{canonicalID:"Etc/GMT-13"},{canonicalID:"Etc/GMT-14"}].map(function(f){return b.h("option",{value:f.canonicalID},f.canonicalID)})};h.prototype.createTimeFieldsTSX=function(f,g,n){var m=this,t=this.createTimeZoneList();this.hasTimeValidationError=!1;f=f.map(function(w,
u){var v=""!==w.timeField&&!w.timeFormat,x=""===w.timeField&&w.timeFormat;if(v||x)m.hasTimeValidationError=!0;v=b.h(b.Fragment,null,b.h("td",null,b.h("input",{"class":m.state.isTimeErrorActive&&x?" input-error":"",name:"timeFields_"+u,value:w.timeField,onChange:m.changeTimeFieldName.bind(m,w.id,"instant"),disabled:m.state.isReadOnly}),b.h("div",{"class":"input-error-message"+(m.state.isTimeErrorActive&&x?" is-active":"")},l["default"].itemProperties.bdfsValidation.time.errorMessageField)),b.h("td",
null,b.h("input",{"class":m.state.isTimeErrorActive&&v?"input-error":"",type:"text",name:"timeFormat_"+u,value:w.timeFormat,onChange:m.changeTimeFormat.bind(m,w.id,"instant"),disabled:m.state.isReadOnly}),b.h("div",{"class":"input-error-message"+(m.state.isTimeErrorActive&&v?" is-active":"")},l["default"].itemProperties.bdfsValidation.time.errorMessageFormat)));return 1>w.id?b.h("tr",{key:"instant"+w.id},v,b.h("td",null,b.h("span",null))):b.h("tr",{key:"instant"+w.id},v,b.h("td",null,b.h("span",null,
b.h("button",{type:"button","class":"timeFieldBtn",onClick:m.deleteTimeFields.bind(m,w.id,"instant"),disabled:m.state.isReadOnly},"x"))))});g=g.map(function(w,u){var v=""!==w.timeField&&!w.timeFormat,x=""===w.timeField&&w.timeFormat;if(v||x)m.hasTimeValidationError=!0;v=b.h(b.Fragment,null,b.h("td",null,b.h("input",{"class":m.state.isTimeErrorActive&&x?" input-error":"",name:"timeIntervalStart_"+u,value:w.timeField,onChange:m.changeTimeFieldName.bind(m,w.id,"intervalStart"),disabled:m.state.isReadOnly}),
b.h("div",{"class":"input-error-message"+(m.state.isTimeErrorActive&&x?" is-active":"")},l["default"].itemProperties.bdfsValidation.time.errorMessageField)),b.h("td",null,b.h("input",{"class":m.state.isTimeErrorActive&&v?"input-error":"",type:"text",name:"timeIntervalStartFormat_"+u,value:w.timeFormat,onChange:m.changeTimeFormat.bind(m,w.id,"intervalStart"),disabled:m.state.isReadOnly}),b.h("div",{"class":"input-error-message"+(m.state.isTimeErrorActive&&v?" is-active":"")},l["default"].itemProperties.bdfsValidation.time.errorMessageFormat)));
return 1>w.id?b.h("tr",{key:"intervalStart"+w.id},v,b.h("td",null,b.h("span",null))):b.h("tr",{key:"intervalStart"+w.id},v,b.h("td",null,b.h("span",null,b.h("button",{type:"button","class":"timeFieldBtn",onClick:m.deleteTimeFields.bind(m,w.id,"intervalStart"),disabled:m.state.isReadOnly},"x"))))});n=n.map(function(w,u){var v=""!==w.timeField&&!w.timeFormat,x=""===w.timeField&&w.timeFormat;if(v||x)m.hasTimeValidationError=!0;v=b.h(b.Fragment,null,b.h("td",null,b.h("input",{"class":m.state.isTimeErrorActive&&
x?" input-error":"",name:"timeIntervalEnd_"+u,value:w.timeField,onChange:m.changeTimeFieldName.bind(m,w.id,"intervalEnd"),disabled:m.state.isReadOnly}),b.h("div",{"class":"input-error-message"+(m.state.isTimeErrorActive&&x?" is-active":"")},l["default"].itemProperties.bdfsValidation.time.errorMessageField)),b.h("td",null,b.h("input",{"class":m.state.isTimeErrorActive&&v?"input-error":"",type:"text",name:"timeIntervalEndFormat_"+u,value:w.timeFormat,onChange:m.changeTimeFormat.bind(m,w.id,"intervalEnd"),
disabled:m.state.isReadOnly}),b.h("div",{"class":"input-error-message"+(m.state.isTimeErrorActive&&v?" is-active":"")},l["default"].itemProperties.bdfsValidation.time.errorMessageFormat)));return 1>w.id?b.h("tr",{key:"intervalEnd"+w.id},v,b.h("td",null,b.h("span",null))):b.h("tr",{key:"intervalEnd"+w.id},v,b.h("td",null,b.h("span",null,b.h("button",{type:"button","class":"timeFieldBtn",onClick:m.deleteTimeFields.bind(m,w.id,"intervalEnd"),disabled:m.state.isReadOnly},"x"))))});return{timeInstantFieldsTSX:f,
timeIntervalStartFieldsTSX:g,timeIntervalEndFieldsTSX:n,timeZoneListTSX:t}};h.prototype.timeZoneChange=function(f){f=f.target;var g=c["default"](this.state.templatesForRendering);g[this.state.activeTemplateIndex].time||(g[this.state.activeTemplateIndex].time={timeReference:{}});g[this.state.activeTemplateIndex].time.timeReference||(g[this.state.activeTemplateIndex].time.timeReference={});g[this.state.activeTemplateIndex].time.timeReference.timeZone=f.value;this.setState({templatesForRendering:g})};
h.prototype.addTimeFields=function(f,g){var n=c["default"](this.state.templatesForRendering),m=n[this.state.activeTemplateIndex].time.encodings;"instant"===f?(m.forEach(function(t){a["default"].includes(t.types,"instant")&&t.fields.push({name:"",formats:[]})}),document.getElementById("timeInstantButton").disabled=!0,this.state.disableInstantAddButton=!1):"intervalStart"===f?(m.forEach(function(t){a["default"].includes(t.types,"interval")&&t.fields.push({name:"",role:["start"],formats:[]})}),document.getElementById("timeIntervalStartButton").disabled=
!0,this.state.disableIntervalStartAddButton=!1):"intervalEnd"===f&&(m.forEach(function(t){a["default"].includes(t.types,"interval")&&t.fields.push({name:"",role:["end"],formats:[]})}),document.getElementById("timeIntervalEndButton").disabled=!0,this.state.disableIntervalEndAddButton=!1);this.setState({templatesForRendering:n})};h.prototype.removeEmptyProperty=function(f){f.forEach(function(g){for(var n=c["default"](g.time.encodings),m=!0,t=n.length-1;0<=t;t--){for(var w=!0,u=n[t].fields.length-1;0<=
u;u--)n[t].fields[u].name||n[t].fields[u].formats[0]?(m=w=!1,g.time.timeReference.timeZone="UTC"):g.time.encodings[t].fields.splice(u,1);w&&g.time.encodings.splice(t,1)}m&&delete g.time;var v=c["default"](g.geometry.encodings);n=function(x){(-1<v[x].fields[0].formats.indexOf("None")||!v[x].fields[0].formats[0])&&g.geometry.encodings.splice(x,1);v[x].fields.forEach(function(y,C){var z;y.name||(null===(z=g.geometry.encodings[x])||void 0===z?!0:delete z.fields[C].name)})};for(t=v.length-1;0<=t;t--)n(t);
0===g.geometry.encodings.length&&delete g.geometry});return f};h.prototype.deleteTimeFields=function(f,g){var n=0,m=c["default"](this.state.templatesForRendering),t=m[this.state.activeTemplateIndex].time.encodings;"instant"===g?(t.forEach(function(w){if(a["default"].includes(w.types,"instant")){var u=w.fields.filter(function(v,x){return f!==x});w.fields=u}}),t=document.getElementById("timeInstantButton"),t.disabled=!1):"intervalStart"===g?(t.forEach(function(w){if(a["default"].includes(w.types,"interval")){var u=
w.fields.filter(function(v){if(a["default"].includes(v.role,"start"))if(n!==f)n++;else return n++,!1;return!0});w.fields=u}}),t=document.getElementById("timeIntervalStartButton"),t.disabled=!1):"intervalEnd"===g&&(t.forEach(function(w){if(a["default"].includes(w.types,"interval")){var u=w.fields.filter(function(v){if(a["default"].includes(v.role,"end")){if(n!==f)return n++,!0;n++;return!1}return!0});w.fields=u}}),t=document.getElementById("timeIntervalEndButton"),t.disabled=!1);this.setState({templatesForRendering:m})};
h.prototype.modifyTimeFields=function(f,g,n,m){var t=0,w=c["default"](this.state.templatesForRendering),u=w[this.state.activeTemplateIndex].time.encodings;"instant"===m?u.forEach(function(v){a["default"].includes(v.types,m)&&v.fields.forEach(function(x,y){y===f&&("timeFormat"===n?x.formats=[g]:"timeField"===n&&(x.name=g))})}):"intervalStart"===m?u.forEach(function(v){a["default"].includes(v.types,"interval")&&v.fields.forEach(function(x){a["default"].includes(x.role,"start")&&(t===f&&("timeFormat"===
n?x.formats=[g]:"timeField"===n&&(x.name=g)),t++)})}):"intervalEnd"===m&&u.forEach(function(v){a["default"].includes(v.types,"interval")&&v.fields.forEach(function(x){a["default"].includes(x.role,"end")&&(t===f&&("timeFormat"===n?x.formats=[g]:"timeField"===n&&(x.name=g)),t++)})});w[this.state.activeTemplateIndex].time.encodings=u;this.setState({templatesForRendering:w})};h.prototype.unlockAddButton=function(f){if("instant"===f){var g=document.getElementById("timeInstantButton"),n=document.getElementsByClassName("instantTbody")[0],
m=n.childNodes.length-1,t=n.children[m].getElementsByTagName("td")[0].getElementsByTagName("input")[0];m=n.children[m].getElementsByTagName("td")[1].getElementsByTagName("input")[0];g.disabled=""!==t.value&&""!==m.value?!1:!0}"intervalStart"===f?(g=document.getElementById("timeIntervalStartButton"),f=document.getElementsByClassName("intervalStartTbody")[0],m=f.childNodes.length-1,t=f.children[m].getElementsByTagName("td")[0].getElementsByTagName("input")[0],m=f.children[m].getElementsByTagName("td")[1].getElementsByTagName("input")[0],
g.disabled=""!==t.value&&""!==m.value?!1:!0):"intervalEnd"===f&&(g=document.getElementById("timeIntervalEndButton"),f=document.getElementsByClassName("intervalEndTbody")[0],m=f.childNodes.length-1,t=f.children[m].getElementsByTagName("td")[0].getElementsByTagName("input")[0],m=f.children[m].getElementsByTagName("td")[1].getElementsByTagName("input")[0],g.disabled=""!==t.value&&""!==m.value?!1:!0)};h.prototype.changeTimeFieldName=function(f,g,n){this.modifyTimeFields(f,n.target.value,"timeField",g);
this.unlockAddButton(g)};h.prototype.changeTimeFormat=function(f,g,n){this.modifyTimeFields(f,n.target.value,"timeFormat",g);this.unlockAddButton(g)};h.prototype.fileFormatChange=function(f){f=f.target.value;var g=c["default"](this.state.templatesForRendering);g[this.state.activeTemplateIndex].format.type=f;this.setState({templatesForRendering:g})};h.prototype.getFields=function(f,g){for(var n=0;n<(null===f||void 0===f?void 0:f.length);n++){var m=f[n];if(-1<(null===m||void 0===m?void 0:m.types.indexOf(g)))return m.fields}};
h.prototype.getFormat=function(f,g){for(var n=0;n<(null===f||void 0===f?void 0:f.length);n++){var m=f[n];if(-1<(null===m||void 0===m?void 0:m.types.indexOf(g)))return m.fields[0].formats[0]}};h.prototype.formatNotEmpty=function(f){return f&&"None"!==f};h.prototype.render=function(){var f=this,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J=this.state,D=J.activeTemplateIndex,K=J.templatesForRendering,G=J.activeMenuItem,I=J.modalActive,R=J.isReadOnly,A=J.isModalButtonDisabled,B=J.progressIndicatorActive,H=J.isGeometryErrorActive,
T=this.props.outputTemplatesAction;J=this.createTemplatesPropertyMenu(J.sidebarMenu);var M=l["default"].itemProperties.outputTemplateModal,L=M.addTitle,X=M.editTitle,ba=M.name,ma=M.cancel,ta=M.save;M=M.saveLoading;var Ea=this.retrieveTemplateProperty(D,K,G);D=Ea.templateName;K=Ea.timeInstantArr;var wa=Ea.timeIntervalStartArr,Q=Ea.timeIntervalEndArr,Z=Ea.timeZone,aa=Ea.fileFormat,ea="shapefile"===aa.type?!0:!1,oa=this.createGeometryTSX(Ea.geometry);Ea=oa.geometrySpatialReference;oa=oa.encodings;var ra=
l["default"].itemProperties.datasetsManifest.geometry,za=ra.spatialReference,ya=ra.spatialReferenceValue,Ha=ra.point,ua=ra.polyline,Y=ra.polygon,da=ra.geomtryFormatType,ka=ra.XYZ,W=ra.Field,fa=ra.WKT,ha=ra.WKB,sa=ra.GeoJSON,Fa=ra.EsriJSON,Ma=ra.EsriShape,Oa=ra.none;ra=ra.geometryFields;var Ra=this.getFormat(oa,"esriGeometryPoint"),Da=this.getFormat(oa,"esriGeometryPolyline"),E=this.getFormat(oa,"esriGeometryPolygon"),S=this.createTimeFieldsTSX(K,wa,Q),ia=S.timeInstantFieldsTSX,na=S.timeIntervalStartFieldsTSX,
qa=S.timeIntervalEndFieldsTSX;S=S.timeZoneListTSX;var xa=l["default"].itemProperties.datasetsManifest.time,Ca=xa.instant,Ga=xa.interval,Na=xa.timeFields,Ba=xa.field,P=xa.format,ca=xa.startTimeFields,ja=xa.endTimeFields;xa=xa.timeZone;var la=l["default"].itemProperties.datasetsManifest.file,pa=la.fileExtension,Aa=la.delimited,va=la.parquet,Ja=la.orc;la=la.shapefile;return b.h(b.Fragment,null,b.h(p["default"],{id:"outputTemplates-editing-modal"},b.h("calcite-modal",{"aria-labelledby":"modal-title",
active:I,fullscreen:!0,oncalciteModalClose:function(){return f.closeOutputTemplatesModal("cancel")}},b.h("h3",{slot:"header"},"edit"===T?X:L),b.h("div",{slot:"content","class":"data-editing-content",style:"align-items: flex-start"},b.h("div",{"class":"grid-container flex"},b.h("div",{"class":"output-templates-sidebar-menu margin-right-2 flex-0"},J),b.h("div",{"class":"flex-1"},b.h("div",{"class":"panel panel-white"},ba,b.h("label",{"class":"padding-left-2"},b.h("input",{type:"text",name:"outputTemplatesName",
value:D,onChange:this.templateNameChange.bind(this),disabled:R})),b.h("div",{"class":"overflow-auto"},b.h("div",{"class":"fileExtension"},b.h("div",null,pa),b.h("label",{"class":"padding-left-2"},"edit"===T?b.h("div",{id:"fileExtension"},aa.type):b.h("div",null,b.h("select",{"class":"select-full",name:"fileFormat",value:aa.type,onChange:this.fileFormatChange.bind(this),disabled:R},b.h("option",{value:"delimited"},Aa),b.h("option",{value:"parquet"},va),b.h("option",{value:"orc"},Ja),b.h("option",{value:"shapefile"},
la))))))),b.h("div",{"class":"panel panel-white margin-top-half"},"Geometry"===G&&b.h("div",{"class":"overflow-auto"},b.h(b.Fragment,null,b.h("div",{"class":"spatialReference"},b.h("div",null,za),b.h("label",{"class":"padding-left-2"},b.h("input",{"class":H?" input-error":"",type:"text",name:"spatialReferenceValue",value:Ea?Ea.wkid:"",placeholder:ya,onChange:this.spatialReferenceChange.bind(this),disabled:R}),b.h("div",{"class":"input-error-message"+(H?" is-active":"")},l["default"].itemProperties.bdfsValidation.time.errorMessageField))),
b.h("div",{"class":"geometry"},b.h("div",null,Ha),b.h("div",{"class":"geometryFormatType"},b.h("div",{"class":"padding-left-2"},da),b.h("label",{"class":"padding-left-2"},b.h("select",{"class":"select-full",name:"geometryFormatTypeValue",value:Ra?3===(null===(g=this.getFields(oa,"esriGeometryPoint"))||void 0===g?void 0:g.length)?"XYZ":Ra:"",onChange:this.pointGeometryFormatTypeChange.bind(this),disabled:R||ea},b.h("option",{value:"XYZ"},ka),b.h("option",{value:"WKT"},fa),!a["default"].includes(["delimited",
"shapefile"],aa.type)&&b.h("option",{value:"WKB"},ha),b.h("option",{value:"GeoJSON"},sa),b.h("option",{value:"EsriJSON"},Fa),b.h("option",{value:"EsriShape"},Ma),b.h("option",{value:"None"},Oa)))),b.h("div",{"class":"geometryFields"},b.h("div",{"class":"padding-left-2"},ra),b.h("label",{"class":"padding-left-2"},oa&&1===(null===(n=this.getFields(oa,"esriGeometryPoint"))||void 0===n?void 0:n.length)&&b.h(b.Fragment,null,b.h("div",null,this.formatNotEmpty(Ra)&&b.h(b.Fragment,null," ",Ra," ",W," ")),
b.h("input",{type:"text",name:"polylineGeometryField",value:null===(t=null===(m=this.getFields(oa,"esriGeometryPoint"))||void 0===m?void 0:m[0])||void 0===t?void 0:t.name,onChange:this.geometryFieldNonXYZChange.bind(this),disabled:R||ea})),oa&&3===(null===(w=this.getFields(oa,"esriGeometryPoint"))||void 0===w?void 0:w.length)&&b.h(b.Fragment,null,"X "+W,b.h("input",{type:"text",name:"polylineGeometryFieldX",value:null===(v=null===(u=this.getFields(oa,"esriGeometryPoint"))||void 0===u?void 0:u[0])||
void 0===v?void 0:v.name,onChange:this.geometryFieldXChange.bind(this),disabled:R||ea}),"Y "+W,b.h("input",{type:"text",name:"polylineGeometryFieldY",value:null===(y=null===(x=this.getFields(oa,"esriGeometryPoint"))||void 0===x?void 0:x[1])||void 0===y?void 0:y.name,onChange:this.geometryFieldYChange.bind(this),disabled:R||ea}),"Z "+W,b.h("input",{type:"text",name:"polylineGeometryFieldZ",value:null===(z=null===(C=this.getFields(oa,"esriGeometryPoint"))||void 0===C?void 0:C[2])||void 0===z?void 0:
z.name,onChange:this.geometryFieldZChange.bind(this),disabled:R||ea}))))),b.h("div",{"class":"geometry"},b.h("div",null,ua),b.h("div",{"class":"geometryFormatType"},b.h("div",{"class":"padding-left-2"},da),b.h("label",{"class":"padding-left-2"},b.h("select",{"class":"select-full",name:"geometryPolylineFormatTypeValue",value:Da||"",onChange:this.polylineGeometryFormatTypeChange.bind(this),disabled:R||ea},b.h("option",{value:"WKT"},fa),!a["default"].includes(["delimited","shapefile"],aa.type)&&b.h("option",
{value:"WKB"},ha),b.h("option",{value:"GeoJSON"},sa),b.h("option",{value:"EsriJSON"},Fa),b.h("option",{value:"EsriShape"},Ma),b.h("option",{value:"None"},Oa)))),b.h("div",{"class":"geometryFields"},b.h("div",{"class":"padding-left-2"},ra),b.h("label",{"class":"padding-left-2"},b.h("div",null,this.formatNotEmpty(Da)&&b.h(b.Fragment,null," ",Da," ",W," ")),b.h("input",{type:"text",name:"polylineGeometryField",value:oa?null===(O=null===(F=this.getFields(oa,"esriGeometryPolyline"))||void 0===F?void 0:
F[0])||void 0===O?void 0:O.name:"",onChange:this.polylineGeometryFieldValueChange.bind(this),disabled:R||ea})))),b.h("div",{"class":"geometry"},b.h("div",null,Y),b.h("div",{"class":"geometryFormatType"},b.h("div",{"class":"padding-left-2"},da),b.h("label",{"class":"padding-left-2"},b.h("select",{"class":"select-full",name:"geometryPolygonFormatTypeValue",value:E?E:"",onChange:this.polygonGeometryFormatTypeChange.bind(this),disabled:R||ea},b.h("option",{value:"WKT"},fa),!a["default"].includes(["delimited",
"shapefile"],aa.type)&&b.h("option",{value:"WKB"},ha),b.h("option",{value:"GeoJSON"},sa),b.h("option",{value:"EsriJSON"},Fa),b.h("option",{value:"EsriShape"},Ma),b.h("option",{value:"None"},Oa)))),b.h("div",{"class":"geometryFields"},b.h("div",{"class":"padding-left-2"},ra),b.h("label",{"class":"padding-left-2"},b.h("div",null,this.formatNotEmpty(E)&&b.h(b.Fragment,null," ",E," ",W," ")),b.h("input",{type:"text",name:"polygonGeometryField",value:oa?null===(N=null===(V=this.getFields(oa,"esriGeometryPolygon"))||
void 0===V?void 0:V[0])||void 0===N?void 0:N.name:"",onChange:this.polygonGeometryFieldValueChange.bind(this),disabled:R||ea})))))),"Time"===G&&b.h("div",{"class":"overflow-auto"},b.h(b.Fragment,null,b.h("div",{"class":"timeZone"},b.h("div",null,xa),b.h("div",{"class":"padding-left-2"},b.h("select",{"class":"select-full",name:"timeZone",value:Z,onChange:this.timeZoneChange.bind(this),disabled:R},S))),b.h("div",null,Ca),b.h("div",{"class":"timeFields"},b.h("div",null,Na),b.h("div",{"class":"padding-left-2"},
b.h("table",{"class":"table"},b.h("thead",null,b.h("tr",null,b.h("th",null," ",Ba," "),b.h("th",null," ",P," "),b.h("th",null,b.h("span",null,b.h("button",{type:"button","class":"timeFieldBtn",id:"timeInstantButton",onClick:this.addTimeFields.bind(this,"instant"),disabled:R||1>=K.length&&this.state.disableInstantAddButton},"+"))))),b.h("tbody",{className:"instantTbody"},ia)))),b.h("div",null,Ga),b.h("div",{"class":"timeFields"},b.h("div",null,ca),b.h("div",{"class":"padding-left-2"},b.h("table",{"class":"table"},
b.h("thead",null,b.h("tr",null,b.h("th",null," ",Ba," "),b.h("th",null," ",P," "),b.h("th",null,b.h("span",null,b.h("button",{type:"button","class":"timeFieldBtn",id:"timeIntervalStartButton",onClick:this.addTimeFields.bind(this,"intervalStart"),disabled:R||1>=wa.length&&this.state.disableIntervalStartAddButton},"+"))))),b.h("tbody",{className:"intervalStartTbody"},na)))),b.h("div",{"class":"timeFields"},b.h("div",null,ja),b.h("div",{"class":"padding-left-2"},b.h("table",{"class":"table"},b.h("thead",
null,b.h("tr",null,b.h("th",null," ",Ba," "),b.h("th",null," ",P," "),b.h("th",null,b.h("span",null,b.h("button",{type:"button","class":"timeFieldBtn",id:"timeIntervalEndButton",onClick:this.addTimeFields.bind(this,"intervalEnd"),disabled:R||1>=Q.length&&this.state.disableIntervalEndAddButton},"+"))))),b.h("tbody",{className:"intervalEndTbody"},qa)))))))))),!R&&b.h("calcite-button",{slot:"secondary",width:"full",disabled:A,onClick:function(){return f.saveOutputTemplatesModal()}},B?b.h("div",{style:"display: inline-flex; align-items: center; justify-content: center; width: 100%;"},
b.h("calcite-loader",{label:"savingManifest",scale:"m",inline:!0,active:B}),b.h("span",{style:"margin:0 10px"},M)):b.h("div",null,ta)),b.h("calcite-button",{slot:"primary",width:"full",appearance:"outline",disabled:A,onClick:function(){return f.closeOutputTemplatesModal("cancel")}},ma))))};return h}(b.Component);U["default"]=e})},"arcgisonline/pages/item/widgets/_overview":function(){define("require exports tslib ../../../esriGeowConfig preact ../../pageUtil ../../serviceUtil ../../statusUtil ../../dijit/InlineEdit ../../dijit/ImageViewer ../../dijit/ItemShareSummary ../../dijit/MemberThumb ../../dijit/_CheckReadonlyMixin ../../dijit/OrgPopup/OrgPopup ../_Actions ../_Info ./_sublayer ../_servicesDirectoryViewModal ../../utils/alerts ../../utils/arrays ../../utils/dom ../../utils/formatters ../../utils/icons ../../utils/productGlyphs ../../utils/verified ../../utils/item ../../utils/itemsgroups ../../utils/setItemUrls ../../utils/queryHandler ../../../sharing/util ../../../sharing/geow/Content ../../../sharing/dijit/CopyToClipboard ../../../sharing/dijit/dialog/_CreateItemUtilMixin ../../../sharing/dijit/dialog/ConfirmDialog ../../../sharing/dijit/dialog/SubscriptionStatusDlg ../../components/Ratings ../../../tsutils/declareDecorator ../../../sharing/dijit/RasterFunctionEditor calcite-web/js/calcite-web esri/libs/sanitizer/Sanitizer dijit/_WidgetBase dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/event dojo/string dojo/query dojo/on dojo/topic dojo/dom dojo/dom-attr dojo/dom-construct dojo/promise/all dojo/Deferred dojo/when dojo/has ../../utils/layer esri/Evented esri/lang esri/WKIDUnitConversion dojo/text!./templates/_comment.html dojo/text!./templates/_reply.html dojo/text!./templates/_layerActions.html dojo/text!./templates/_layerRenameActions.html dojo/text!./templates/_modelCharacteristics.html dojo/text!./templates/_toolActions.html dojo/text!./templates/_owner.html dojo/text!./templates/_ownerVerified.html dojo/text!./templates/_overview.html dojo/text!./templates/_solutionContent.html dojo/text!./templates/_solutionItem.html dojo/text!./templates/_workflowContent.html dojo/i18n!../../../nls/arcgisonline arcgisonline/pages/utils/url arcgisonline/pages/utils/mapViewer ../_export arcgisonline/pages/components/LayerCard".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D,K,G,I,R,A,B,H,T,M,L,X,ba,ma,ta,Ea,wa,Q,Z,aa,ea,oa,ra,za,ya,Ha,ua,Y,da,ka,W,fa,ha,sa,Fa,Ma,Oa,Ra,Da,E,S,ia,na,qa,xa,Ca,Ga,Na){b=q.__importDefault(b);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);v=q.__importDefault(v);
x=q.__importDefault(x);y=q.__importDefault(y);C=q.__importDefault(C);z=q.__importDefault(z);F=q.__importDefault(F);O=q.__importDefault(O);V=q.__importDefault(V);N=q.__importStar(N);J=q.__importDefault(J);D=q.__importStar(D);K=q.__importDefault(K);G=q.__importDefault(G);I=q.__importDefault(I);R=q.__importDefault(R);A=q.__importDefault(A);B=q.__importDefault(B);T=q.__importDefault(T);M=q.__importDefault(M);L=q.__importDefault(L);X=q.__importDefault(X);ba=q.__importDefault(ba);ma=q.__importDefault(ma);
ta=q.__importDefault(ta);Ea=q.__importDefault(Ea);wa=q.__importDefault(wa);Q=q.__importDefault(Q);Z=q.__importDefault(Z);aa=q.__importDefault(aa);ea=q.__importDefault(ea);oa=q.__importDefault(oa);ra=q.__importDefault(ra);za=q.__importDefault(za);ya=q.__importDefault(ya);Ha=q.__importDefault(Ha);ua=q.__importDefault(ua);da=q.__importDefault(da);ka=q.__importDefault(ka);W=q.__importDefault(W);fa=q.__importDefault(fa);ha=q.__importDefault(ha);sa=q.__importDefault(sa);Fa=q.__importDefault(Fa);Ma=q.__importDefault(Ma);
Oa=q.__importDefault(Oa);Ra=q.__importDefault(Ra);Da=q.__importDefault(Da);E=q.__importDefault(E);S=q.__importDefault(S);ia=q.__importDefault(ia);na=q.__importDefault(na);qa=q.__importDefault(qa);Na=q.__importDefault(Na);return function(){function Ba(P,ca){this.NO_THUMBNAIL_PATH="js/arcgisonline/css/images/no-user-thumb.jpg";this.CACHE_CHECK_INTERVAL=3E3;this.icons=z["default"];this.productGlyphs=F["default"];this.i18n=qa["default"];this.basePath=e.toUrl("arcgisonline/sharing/dijit");this.sanitizer=
new X["default"]}Ba.prototype.startup=function(){this.inherited(arguments);return this.initUI()};Ba.prototype.destroy=function(){this.inherited(arguments);this._subscriptionStatusDlg&&(this._subscriptionStatusDlg.subscriptionStatusDlg.destroyRecursive(),this._subscriptionStatusDlg.destroyRecursive());this.cancelInlineEdit()};Ba.prototype._setIsFavoriteAttr=function(P){var ca=P.isFavorite?'\x3cspan class\x3d"btn-link-yellow"\x3e'+z["default"].inline["star-f"]["16"]+"\x3c/span\x3e":z["default"].inline.star["16"],
ja=P.isFavorite?this.i18n.common.unfavorite:this.i18n.common.favorite,la=P.isFavorite?this.i18n.common.isFavorite:this.i18n.common.notFavorite;document.querySelector(".js-favorite-text").innerHTML=""+ca+ja;y["default"].forEachNode(document.querySelectorAll(".js-in-favorites"),function(pa){return pa.textContent=la})};Ba.prototype._getDefaultOpenButtonAttr=function(){return y["default"].nodeListToArray(document.querySelectorAll(".js-open-btn")).filter(function(P){return 0!==P.offsetHeight}).shift()};
Ba.prototype.initUI=function(){var P=this,ca,ja,la,pa,Aa,va,Ja,Ka,Ia,Qa=new ya["default"],Ta=this.i18n,Ua=this.portalUser,Sa=this.item,$a=this.sublayer,Xa=this.productGlyphs,Za=this.basePath;this.item.badges=V["default"].getBadges(this.item,!0,this.portalUser);this.item.set("navigatorUrl","https://navigator.arcgis.app?routeItemID\x3d"+this.item.id);J["default"].instantApps(Sa);J["default"].createDashboard(Sa);J["default"].experienceBuilder(Sa);J["default"].configureStoryMapTheme(Sa);var bb=ta["default"].mixin(this.page,
C["default"],{sanitizeUrl:function(Ya){return 0===P.item.owner.indexOf("esri_")?Ya:Ya?P.sanitizer.sanitizeUrl(Ya):""}});ra["default"].place(wa["default"].substitute(E["default"],{item:Sa,productGlyphs:Xa,i18n:Ta,currentHref:window.location.href,portalUser:Ua,icons:z["default"],basePath:Za},function(Ya){return 0===Ya?""+Ya:Ya||""},bb),this.domNode);this._snippetSection=new c["default"]({inputType:"textArea",rows:4,maxLength:2048,showCharactersLeft:!0,inputLabel:this.i18n.itemProperties.editSummary,
prop:"snippet",value:this.item.snippet,pattern:"^[^\x3c\x3e]*$",invalidText:this.i18n.itemProperties.error.badCharacterSnippet,formatter:this.page._linkify},document.querySelector(".js-snippet-section"));this._descriptionSection=new c["default"]({inputId:"item-description-edit",inputType:"richText",inputLabel:this.i18n.itemProperties.editDescription,prop:"description",value:this.item.description},document.querySelector(".js-description-section"));this._licenseInfoSection=new c["default"]({inputId:"item-licenseInfo-edit",
inputType:"richText",inputLabel:this.i18n.itemProperties.editAttribution,prop:"licenseInfo",value:this.item.licenseInfo},document.querySelector(".js-licenseInfo-section"));this._tagsSection=new c["default"]({prop:"tags",inputType:"tags",inputId:"saveItemTags",viewTitle:this.i18n.itemProperties.tags,formTitle:this.i18n.itemProperties.editTags,formClass:"leader-1 padding-leader-half trailer-1",buttonsClass:"leader-half",value:null!==(ca=this.item.tags)&&void 0!==ca?ca:[],knownTags:this.item.itemOwner?
this.item.itemOwner.contentTags||[]:null!==(ja=this.portalUser.contentTags)&&void 0!==ja?ja:[]},this.domNode.querySelector(".js-tags-section"));this._accessInfo=new c["default"]({inputType:"textArea",rows:6,inputLabel:this.i18n.itemProperties.editCredits,prop:"accessInformation",value:this.item.accessInformation,pattern:"^[^\x3c\x3e]*$",invalidText:this.i18n.itemProperties.error.badCharacterCredits,formatter:this.page._linkify},this.domNode.querySelector(".js-accessInformation-section"));this.set("isFavorite",
this.item);this.updateRatings();this.portalUser?this._tagsSection.initTagsEditor():this.own(Q["default"](".js-action-update-rating, .js-action-signin").on("click",function(){window.location.href="signin.html?returnUrl\x3d"+escape(window.location.href)+"\x26error\x3d403"}));try{var ab=K["default"].getAbsoluteUrl(this.item.url)||this.item.itemUrl+"/data"}catch(Ya){ab=this.item.url||this.item.itemUrl+"/data"}ab&&-1<ab.indexOf(".arcgis.com")&&-1<ab.indexOf("http://")&&(ab=ab.replace("http://","https://"));
this.item.url||"Dashboard"!==this.item.type||(this.item.dashboardUrl||J["default"].dashboard(this.item),ca="https://"+this.page.portal.portalHostname+this.item.dashboardUrl.replace("../","/"),ja=xa.redirectExternalAppURL(this.item,this.item.dashboardUrl),ab=-1<(null===ja||void 0===ja?void 0:ja.indexOf("http"))?ja:ca,document.documentElement.classList.add("has-url"),this.domNode.querySelector(".js-view-url").href=ab);this.item.url||"raster function template"!==this.item.type.toLowerCase()||(this.domNode.querySelector(".js-open-rfxEditor").onclick=
function(Ya){return P.openInRFxEditor({user:P.item.portalUser,parent:P.page,item:P.item,entryPoint:"itemDetailsPage"})});this._copyUrlDijit=new I["default"]({text:ab,tooltipModifier:"tooltip-left",id:"url"},document.getElementById("copyToClipBoardURL"));this._copyShortUrlDijit=new I["default"]({text:"",id:"shortUrl",tooltipModifier:"tooltip-left"},ea["default"].byId("copyToClipBoardShortURL"));this._copyNavigatorUrlDijit=new I["default"]({text:this.item.navigatorUrl,id:"navUrl"},ea["default"].byId("copyToClipBoardNavURL"));
(ua["default"]("ios")||ua["default"]("android"))&&[".navigator-button-mobile",".navigator-button-mobile"].forEach(function(Ya){y["default"].showNodes(P.domNode.querySelectorAll(Ya))});this.page._queryStringParams.emptyLayer&&(p["default"].removeQueryParams(["emptyLayer"]),document.querySelector(".js-empty-layer-notice").active=!0);ca=this.item.owner!==(null===(la=this.portalUser)||void 0===la?void 0:la.username)&&"update"===(null===(pa=this.item.itemControl)||void 0===pa?void 0:pa[0]);la=0<(null===
(va=null===(Aa=this.item.relatedItems)||void 0===Aa?void 0:Aa.Service2Data_forward)||void 0===va?void 0:va.map(function(Ya){return Ya.type}).filter(function(Ya){return"Feature Service"===Ya}).length);(!this.portalUser||ca||la)&&y["default"].hideNodes(this.domNode.querySelectorAll(".js-action-replaceLayer"));this.showReplaceLayer(this.item);this.showInstantApps(this.item);this.showOwner(this.item);this.showLayers(this.item);this.showRelationships(this.item);this.showItemCompleteness(this.item);this.showProjectContent(this.item,
this.portalUser);this.showSolutionContent(this.item);this.showWorkflowContent(this.item);this.showFormContent(this.item);this.showComments(this.item);this.showUrbanModelInfo(this.item);this.showFolders(this.item);this.showScreenshots(this.item);this.showCategories(this.item);this.showOpenInRFxEditorOption(this.item);this.showThumbnailActions(this.item);this.showShareStatus(this.item);this.initHandlers();this.checkForCachingJob(this.item);this.page.set("attributeCssClasses",this.item);this.page.set("bodyCssClasses",
this.item);"processing"===this.item.status&&this.item.set("status","processing");this.updateLoaderText();this.configureViewUI();this.showManageTile();Qa.resolve("processing"!==this.item.status||this.page._queryStringParams.jobid||(null===(Ja=this.item.properties)||void 0===Ja?void 0:Ja.jobId)&&(null===(Ka=this.item.properties)||void 0===Ka?void 0:Ka.jobUrl)&&"GPServer"===(null===(Ia=this.item.properties)||void 0===Ia?void 0:Ia.jobType));$a?(this.toggleSubLayer($a),document.body.classList.remove("is-parent-item")):
document.body.classList.add("is-parent-item");(this.item.isRetiredApp||this.item.isRetiredStoryMap)&&y["default"].hideNodes([this.domNode.querySelector(".js-view-btn"),this.domNode.querySelector(".js-configure-btn")]);return Qa};Ba.prototype.showManageTile=function(){var P=p["default"].getHashParts().includes("manageTiles"),ca=this.item.types.some(function(ja){return["is-tile","is-vectorTile","is-tiled-imagery"].includes(ja)});P&&ca&&(document.querySelector(".tile-layer-auto-cache-alert").active=
!0)};Ba.prototype.configureViewUI=function(){var P=this,ca,ja,la=this.domNode.querySelector("span.js-service-link \x3e a"),pa=this.domNode.querySelector(".js-view-url"),Aa=function(va,Ja){u.shouldOpenViewModal(P.item,P.portalUser)&&(va.preventDefault(),va.stopPropagation(),u.handleViewModalClick(P.item,P.portalUser,Ja))};la&&(null===(ca=this.serviceLinkClickHandler)||void 0===ca?void 0:ca.remove(),this.serviceLinkClickHandler=void 0,la.dataset.url=la.href,"Feature Collection"!==this.item.type&&(la.href=
""+J["default"].removeToken(la.href)),this.serviceLinkClickHandler=Z["default"](la,"click",function(va){Aa(va,la)}),this.own(this.serviceLinkClickHandler));pa&&(null===(ja=this.viewLinkClickHandler)||void 0===ja?void 0:ja.remove(),this.viewLinkClickHandler=void 0,pa.dataset.url=pa.href,pa.href=""+J["default"].removeToken(pa.href),this.viewLinkClickHandler=Z["default"](pa,"click",function(va){Aa(va,pa)}),this.own(this.viewLinkClickHandler))};Ba.prototype.toggleSubLayer=function(P,ca){var ja,la=this.domNode.querySelector(".js-item-pane"),
pa=this.domNode.querySelector(".js-sublayer-pane");window.scroll({top:0,left:0,behavior:"smooth"});P?(this.sublayer=P,null===(ja=this._sublayerDijit)||void 0===ja?void 0:ja.destroy(),this._sublayerDijit=new w["default"]({item:this.item,sublayer:P,page:this.page,portalUser:this.portalUser},ra["default"].place(ra["default"].create("div"),this.domNode.querySelector(".js-sublayer"),"last")),la.classList.remove("item-pane--active"),pa.classList.add("item-pane--active"),document.body.classList.remove("is-parent-item")):
(this.sublayer=null,la.classList.add("item-pane--active"),pa.classList.remove("item-pane--active"),document.body.classList.add("is-parent-item"));this.page.toggleSubLayer(P,ca);this.page.subnav.updateActiveTab("overview")};Ba.prototype.updateLoaderText=function(){var P,ca,ja;"Image Service"===this.item.type&&(null===(P=this.item.properties)||void 0===P?0:P.jobId)&&(null===(ca=this.item.properties)||void 0===ca?0:ca.jobUrl)&&"GPServer"===(null===(ja=this.item.properties)||void 0===ja?void 0:ja.jobType)?
r["default"].isImageManagementTask(this.item.properties.jobUrl)&&(this.domNode.querySelector(".js-service-status .loader-text").innerHTML=this.i18n.itemProperties.updatingService):a["default"].isVectorTileFromFeatures(this.item)&&(this.domNode.querySelector(".js-service-status .loader-text").innerHTML=this.i18n.itemProperties.buildingCache)};Ba.prototype.getLayerStatus=function(P){return q.__awaiter(this,void 0,void 0,function(){var ca,ja,la,pa,Aa,va,Ja,Ka,Ia;return q.__generator(this,function(Qa){switch(Qa.label){case 0:if(!P.layers)return[2];
ca=[];ja=function(Ta){Ta.forEach(function(Ua){if(Ua.layers)return ja(Ua.layers);Ua.itemId&&!ca.includes(Ua.itemId)&&ca.push(Ua.itemId)})};ja(P.layers);return(la=ca.map(function(Ta){return"id: "+Ta}).join(" OR "))?[4,K["default"].request({url:b["default"].restBaseUrl+"/search",content:{filter:la,start:1,num:100}})]:[3,6];case 1:pa=Qa.sent().results,Aa=0,va=pa,Qa.label=2;case 2:if(!(Aa<va.length))return[3,5];Ja=va[Aa];Ja.portal=this.item.portal;Ka=Ja;return[4,O["default"].getVerifiedInfo(Ja)];case 3:Ka.verified=
Qa.sent(),Ja.badges=V["default"].getContentStatusBadges(Ja),Qa.label=4;case 4:return Aa++,[3,2];case 5:Ia=function(Ta){for(var Ua,Sa=function(Xa){Xa.layers&&Ia(Xa.layers);var Za=pa.find(function(bb){return bb.id===Xa.itemId});null!==(Ua=Xa.url)&&void 0!==Ua?Ua:Xa.url=null===Za||void 0===Za?void 0:Za.url;Xa.contentStatus=null===Za||void 0===Za?void 0:Za.contentStatus;Xa.badges=null===Za||void 0===Za?void 0:Za.badges;Xa.itemId&&"ArcGISMapServiceLayer"===Xa.layerType&&(Xa.layerType="MapImageLayer")},
$a=0;$a<Ta.length;$a++)Sa(Ta[$a])},Ia(P.layers),Qa.label=6;case 6:return[2]}})})};Ba.prototype.showInstantApps=function(P){P.typeKeywords.includes("instantApp")&&y["default"].hideNode(this.domNode.querySelector(".js-open-downloadAttachment"))};Ba.prototype.showOpenInRFxEditorOption=function(P){var ca=this.portalUser;ca=!(null===ca||void 0===ca?0:ca.username);x["default"].includes(P.typeKeywords,"Function Template")&&!ca||y["default"].hideNode(this.domNode.querySelector(".js-open-rfxEditor"))};Ba.prototype.openInRFxEditor=
function(P){P=P||{};this._rasterFunctionEditor?(this._rasterFunctionEditor.set("parent",P.parent),this._rasterFunctionEditor.set("item",P.item),this._rasterFunctionEditor.open()):(P.showOnStart=!0,P=new M["default"](P,document.createElement("div")),P.startup(),document.body.appendChild(P.domNode),this._rasterFunctionEditor=P)};Ba.prototype.showReplaceLayer=function(P){var ca,ja=P.types.some(function(Ia){return["is-tile","is-vectorTile","is-tiled-imagery"].includes(Ia)}),la=P.typeKeywords.includes("Tiled Imagery");
P.types.includes("is-vectorTile");var pa=P.types.some(function(Ia){return["is-3d","is-scene"].includes(Ia)})&&!P.types.includes("is-tiled-imagery"),Aa=P.types.includes("is-scene-2"),va=P.relatedItems&&0<Object.keys(P.relatedItems).filter(function(Ia){return Ia.includes("Service2Data")}).length,Ja=["Feature Service"].includes(null===(ca=P.sourceData)||void 0===ca?void 0:ca.type);ca=P.types.includes("is-hosted");var Ka=P.typeKeywords.includes("ExtractedCache");(!ja||la||!ca&&!Ka||ca&&-1<P.types.indexOf("is-tile")&&
Ja)&&y["default"].hideNodes(this.domNode.querySelectorAll(".js-action-replaceLayer"));(!pa||!va||!ca&&!Ka||ja&&Aa)&&y["default"].hideNodes(this.domNode.querySelectorAll(".js-action-replaceSceneLayer"))};Ba.prototype.showOwner=function(P){if(P.verified){var ca=this.i18n;this.domNode.querySelector(".js-owner-info").innerHTML=wa["default"].substitute(Da["default"],{item:P,i18n:ca});new f["default"]({cssClasses:"margin-right-quarter inline-block flex-0 member-thumb--extra-small",member:P.itemOwner},this.domNode.querySelector(".js-owner-thumbnail"));
new f["default"]({cssClasses:"margin-right-half inline-block flex-0 member-thumb--small org-thumb",member:{username:P.verified.name,fullName:P.verified.name,id:P.verified.name,thumbnailUrl:P.verified.thumbnail,thumbnail:P.verified.thumbnail,defaultThumbnailUrl:"./images/group-no-image.png"}},this.domNode.querySelector(".js-verified-thumbnail"))}else this.domNode.querySelector(".js-owner-info").innerHTML=wa["default"].substitute(Ra["default"],{item:P,i18n:qa["default"]}),new f["default"]({cssClasses:"margin-right-half inline-block flex-0 member-thumb--small",
member:P.itemOwner},this.domNode.querySelector(".js-owner-thumbnail"));ra["default"].place(C["default"].formatOwnerText(P,!1,!0),this.domNode.querySelector(".js-owner-section"),"replace");P.verified&&(this.domNode.querySelector(".js-by-owner").textContent=this.i18n.itemProperties.from);ca=this.domNode.querySelector(".js-typeOwner-info");p["default"].registerItemActions(this,ca,m["default"],this.page);(ca=this.domNode.querySelector(".js-verified-owner-link"))&&this.own(Z["default"](ca,"click",function(ja){ja.preventDefault();
ja.stopPropagation();(new n["default"]({item:P,opener:ja.target})).open()}))};Ba.prototype.showShareStatus=function(P){var ca=this,ja=this.portalUser;N.getItemGroups({item:P,url:this.page.portal.url,portalUser:ja,contentUser:P.itemOwner}).then(function(la){var pa;null===(pa=ca._itemShareSummary)||void 0===pa?void 0:pa.destroy();ca._itemShareSummary=new h["default"]({item:la,portalUser:ja,canShare:la.canShare,responsive:!1,telemetry:ca.page.telemetry,showShareGroups:!0},ra["default"].place(ra["default"].create("div"),
ca.domNode.querySelector(".js-item-share-summary"),"last"))})};Ba.prototype.showLayers=function(P){var ca;if(null===(ca=P.layers)||void 0===ca?0:ca.length)"Web Map"===P.type||"Web Scene"===P.type?this.showMapLayers(P):-1<P.types.indexOf("is-tool")?this.showToolLayers(P):this.showServiceLayers(P)};Ba.prototype._showDataUpdatedLast=function(P){var ca=this,ja,la,pa;(null===(ja=P.layers)||void 0===ja?0:ja.length)&&"Feature Service"===P.type&&x["default"].includes(P.typeKeywords,"Hosted Service")&&(P.layers.forEach(function(Aa){var va;
(la=null===(va=Aa.editingInfo)||void 0===va?void 0:va.lastEditDate)&&(!pa||pa<la)&&(pa=la)}),pa&&y["default"].forEachNode(document.querySelectorAll(".js-dataUpdatedLast"),function(Aa){return Aa.innerHTML=ca.i18n.itemProperties.dataLastModified+" "+ca.page._formatDateTime(pa)}))};Ba.prototype.showServiceLayers=function(P){var ca=this,ja,la=null!==(ja=P.layers)&&void 0!==ja?ja:[],pa=P.isLoaded&&!P.isFeatureCollection&&(x["default"].includes(P.types,"is-feature")||x["default"].includes(P.types,"is-table")),
Aa=document.querySelector(".js-tables"),va=document.querySelector(".js-layers"),Ja,Ka=va;la.length&&(Aa&&ra["default"].empty(Aa),va&&ra["default"].empty(va),la.forEach(function(Ia){var Qa=Y.getLayerGeometryInfo(Ia,P),Ta=Qa.geometryIcon;Qa=Qa.geometryType;if(pa){ca.setLayerAttributes(Ia,P);var Ua=Ia.hasAttachments?"disableAttachments":"enableAttachments",Sa=Ia.hasAttachments?"hideAttachments":"showAttachments";p["default"].canEditViewAttachments(P);Ja=wa["default"].substitute(sa["default"],{item:P,
geometryIcon:Ta,geometryType:Qa,icons:z["default"],url:""+window.location.origin+window.location.pathname+"?id\x3d"+P.id+"\x26sublayer\x3d"+Ia.id,attributes:Ia.attributes.join(" "),layer:Ia,i18n:ca.i18n,attachmentLabel:ca.i18n.itemProperties[Ua],viewAttachmentLabel:ca.i18n.itemProperties[Sa],hideViewAttachmentsClass:""})}else Ja=P.isHostedService&&"Map Service"===P.type&&(P.isAdmin||P.isOwner)&&ca.isTilesFromFeatureLayer()?Fa["default"]:ca.getLayerNode(Ia,P);(Ka="Table"===Ia.type?Aa:va)&&ra["default"].place(Ja,
Ka);document.querySelector(".js-layer-rename")&&(ca._layerRename=new c["default"]({inputType:"layerRename",prop:"layerRename",value:Ia.name,layerUrl:Ia.url,layerId:Ia.id,required:!0,pattern:"^[^\x3c|\x3e]+$",emptyText:ca.i18n.itemProperties.error.needTitle,invalidText:ca.i18n.itemProperties.error.badCharacter,showLoader:K["default"].isPortal()},document.querySelector(".js-layer-rename")));(null===Ia||void 0===Ia?0:Ia.subLayers)&&"Group Layer"!==(null===Ia||void 0===Ia?void 0:Ia.type)&&Ia.subLayers.forEach(function($a){ra["default"].place(ca.getLayerNode($a,
P,"padding-left-1"),Ka)})}),this.sublayer||this.toggleSubLayer())};Ba.prototype.isTilesFromFeatureLayer=function(){var P=this.item.sourceData;P="Feature Service"===(null===P||void 0===P?void 0:P.type);return b["default"].tilesOnDemandEnabled&&P};Ba.prototype.showToolLayers=function(P){var ca=this.i18n,ja=P.mapViewerUrl,la=P.tools,pa=ja.substring(ja.indexOf("?")+1,ja.length),Aa=D.queryToObject(pa),va=document.querySelector(".js-tools");la.length&&(ra["default"].empty(va),delete Aa.layers,(la||[]).forEach(function(Ja){Ja.attributes=
[];var Ka=Ja.attributes.join(" ");Aa.url=Ja.url;Ja.mapViewerUrl=ja.substring(0,ja.indexOf("?")+1)+D.objectToQuery(Aa);Ja=wa["default"].substitute(Oa["default"],{item:P,attributes:Ka,tool:Ja,i18n:ca});ra["default"].place(Ja,va)}))};Ba.prototype.showMapLayers=function(P){var ca=[].concat(P.operationalLayers||[]).reverse(),ja=P.baseMapLayers||[],la=P.elevationLayers||[];P=P.tables||[];var pa=document.querySelector(".js-layers"),Aa=document.querySelector(".js-baseMapLayers"),va=document.querySelector(".js-elevationLayers"),
Ja=document.querySelector(".js-tables"),Ka={opLayers:{layers:ca,node:pa},baseMapLayers:{layers:ja,node:Aa},elevationLayers:{layers:la,node:va},tables:{layers:P,node:Ja}};y["default"].forEachNode(document.querySelectorAll(".js-layerNode"),function(Ia){return ra["default"].empty(Ia)});Object.keys(Ka).forEach(function(Ia){var Qa=Ka[Ia],Ta=Qa.layers,Ua=Qa.node;"baseMapLayers"===Ia&&0<ja.length?(Qa={title:ja[0].baseMapTitle,layerType:"Basemap",layers:q.__spreadArray([],Ta).reverse(),isBaseMapLayer:!0},
Ta=y["default"].createElement("div",{},Ua),y["default"].addClasses(Ta,["layer-card-container"]),l.render(l.h(Na["default"],{layer:Qa}),Ta)):Ta.forEach(function(Sa){"tables"===Ia&&(Sa.type="Table");var $a=y["default"].createElement("div",{},Ua);y["default"].addClasses($a,["layer-card-container"]);l.render(l.h(Na["default"],{layer:Sa}),$a)})})};Ba.prototype.getLayerNode=function(P,ca,ja){ca=P.name||P.title||p["default"].getServiceNameFromUrl(ca);ca=this.sanitizer.sanitize(ca)||"";P=P.itemUrl||P.url;
ja=null!==ja&&void 0!==ja?ja:"";P=P?'\x3ca target\x3d"_blank" href\x3d"'+encodeURI(P)+'"\x3e'+ca+"\x3c/a\x3e":ca;return'\x3cdiv class\x3d"padding-leader-quarter padding-trailer-quarter '+ja+'"\x3e'+P+"\x3c/div\x3e"};Ba.prototype.renderGroupLayer=function(P,ca,ja){var la=this,pa,Aa=this.getLayerNode(P,ca,"subLayer"),va=ra["default"].place(Aa,ja);null===(pa=P.layers)||void 0===pa?void 0:pa.forEach(function(Ja){return la.renderGroupLayer(Ja,ca,va)})};Ba.prototype.getItemUrl=function(P){return b["default"].baseUrl+
"item.html?id\x3d"+P};Ba.prototype.showRelationships=function(P){var ca=this,ja,la,pa="Feed"===P.type,Aa=P.sourceData,va={"Map Service":1,"Scene Service":1,WFS:1,"Feature Service":1,"Vector Tile Service":1,"Image Service":1,OGCFeatureServer:1},Ja={"Feature Service":1},Ka=null===(ja=P.resultData)||void 0===ja?void 0:ja.map(function(La){return La});ja=null===Ka||void 0===Ka?void 0:Ka.filter(function(La){return(null===La||void 0===La?void 0:La.type)in Ja&&pa});var Ia=null===Ka||void 0===Ka?void 0:Ka.filter(function(La){return La&&
!x["default"].includes(La.typeKeywords,"View Service")&&La.type in va&&!(pa&&"Feature Service"===La.type)}),Qa=null===Ka||void 0===Ka?void 0:Ka.filter(function(La){return La&&x["default"].includes(La.typeKeywords,"View Service")&&La.type in Ja}),Ta=document.querySelector(".js-relationshipsCreatedFrom"),Ua=document.querySelector(".js-resultCreatingIn"),Sa=document.querySelector(".js-relationshipsVisualizedTo"),$a=document.querySelector(".js-relationshipsDataViews"),Xa=document.querySelector(".related-items-section");
if(x["default"].includes(P.typeKeywords,"cloudStore_azure")||x["default"].includes(P.typeKeywords,"cloudStore_amazon")){var Za="\x3cdiv\x3e\x3ch4\x3e"+this.i18n.itemProperties.dataStores+"\x3c/h4\x3e";P.getRelatedItems("CloudDataStore2BDFSDataStore","forward").then(function(La){if(null===La||void 0===La?0:La.length){La=La[0];var Wa=ca.getItemUrl(La.id);Za=Za+"\x3cdiv\x3e\x3ca href\x3d"+Wa+"\x3e"+La.title+" ("+ca.i18n.itemProperties.relatedItemDataStore+")\x3c/a\x3e\x3c/div\x3e";Xa.innerHTML=Za;La.getRelatedItems("BDFSDataStore2BDFSCatalogService",
"forward").then(function(Pa){if(null===Pa||void 0===Pa?0:Pa.length){Pa=Pa[0];var Va=ca.getItemUrl(Pa.id);Za=Za.substring(0,Za.length-6)+"\x3cdiv\x3e\x3ca href\x3d"+Va+"\x3e"+Pa.title+" ("+ca.i18n.itemProperties.relatedItemBDFS+")\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e";Xa.innerHTML=Za}},function(Pa){return 0})}},function(La){return 0})}else if(x["default"].includes(P.typeKeywords,"fileShare")||x["default"].includes(P.typeKeywords,"hdfs")||x["default"].includes(P.typeKeywords,"hive"))P.getRelatedItems("BDFSDataStore2BDFSCatalogService",
"forward").then(function(La){if(null===La||void 0===La?0:La.length){La=La[0];var Wa=ca.getItemUrl(La.id);Xa.innerHTML="\x3cdiv\x3e\x3ch4\x3e"+ca.i18n.itemProperties.dataStores+"\x3c/h4\x3e\x3cdiv\x3e\x3ca href\x3d"+Wa+"\x3e"+La.title+" ("+ca.i18n.itemProperties.relatedItemBDFS+")\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e"}},function(La){return 0});else if(x["default"].includes(P.typeKeywords,"bigDataFileShare")&&x["default"].includes(P.typeKeywords,"dataStore")){var bb="\x3cdiv\x3e\x3ch4\x3e"+this.i18n.itemProperties.dataStores+
"\x3c/h4\x3e";P.getRelatedItems("CloudDataStore2BDFSDataStore","reverse").then(function(La){if(null===La||void 0===La?0:La.length){La=La[0];var Wa=ca.getItemUrl(La.id);bb=bb+"\x3cdiv\x3e\x3ca href\x3d"+Wa+"\x3e"+La.title+" ("+ca.i18n.itemProperties.relatedItemCloudDS+")\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e";Xa.innerHTML=bb;P.getRelatedItems("BDFSDataStore2BDFSCatalogService","forward").then(function(Pa){if(null===Pa||void 0===Pa?0:Pa.length){Pa=Pa[0];var Va=ca.getItemUrl(Pa.id);bb=bb.substring(0,bb.length-
6)+"\x3cdiv\x3e\x3ca href\x3d"+Va+"\x3e"+Pa.title+" ("+ca.i18n.itemProperties.relatedItemBDFS+")\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e";Xa.innerHTML=bb}},function(Pa){return 0})}},function(La){return 0})}else if(x["default"].includes(P.typeKeywords,"Big Data Catalog Service")){var ab="\x3cdiv\x3e\x3ch4\x3e"+this.i18n.itemProperties.dataStores+"\x3c/h4\x3e";P.getRelatedItems("BDFSDataStore2BDFSCatalogService","reverse").then(function(La){if(null===La||void 0===La?0:La.length){La=La[0];var Wa=ca.getItemUrl(La.id);
ab=ab+"\x3cdiv\x3e\x3ca href\x3d"+Wa+"\x3e"+La.title+" ("+ca.i18n.itemProperties.relatedItemDataStore+")\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e";Xa.innerHTML=ab;La.getRelatedItems("CloudDataStore2BDFSDataStore","reverse").then(function(Pa){if(null===Pa||void 0===Pa?0:Pa.length){Pa=Pa[0];var Va=ca.getItemUrl(Pa.id);ab=ab.substring(0,ab.length-6)+"\x3cdiv\x3e\x3ca href\x3d"+Va+"\x3e"+Pa.title+" ("+ca.i18n.itemProperties.relatedItemCloudDS+")\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e";Xa.innerHTML=ab}},function(Pa){return 0})}},
function(La){return 0})}"Feature Service"===P.type&&(null===Ka||void 0===Ka?0:Ka.length)&&Ka.some(function(La){return"Feed"===La.type})&&(Ka=x["default"].find(Ka,function(La){return"Feed"===La.type}),Ta.innerHTML=wa["default"].substitute(this.i18n.itemProperties.createdFrom+' \x3ca href\x3d"item.html?id\x3d${relItem.id}"\x3e${relItem.title}\x3c/a\x3e, ${relItem.displayName}',{relItem:Ka,i18n:this.i18n}));Aa?P.isMultiServicesView?P.getRelatedItems("Service2Data","forward").then(function(La){Ya=La.slice(0,
5);db=Ya.reduce(function(Wa,Pa,Va,eb){return ca.renderResultItems(Wa,Pa,Va,eb)},"");db+=ca.toSearchString(La,5);Ta.innerHTML=ca.i18n.itemProperties.createdFrom;ra["default"].create("ul",{innerHTML:db,"class":"other-views trailer-0 font-size--1"},Ta,"after")}):Ta.innerHTML=wa["default"].substitute(this.i18n.itemProperties.createdFrom+' \x3ca href\x3d"item.html?id\x3d${relItem.id}"\x3e${relItem.title}\x3c/a\x3e, ${relItem.displayName}',{relItem:Aa,i18n:this.i18n}):-1!==P.attributes.indexOf("has-cloudDriveData")&&
P.isOwner&&P.isAdmin&&R["default"].getCloudProviderItemResource(P).then(function(La){P.cloudProviderInfo=La;var Wa="",Pa="",Va=La.mimeType,eb=La.cloudDriveFileName,kb=La.id,gb=La.zipItemType,cb=ca.i18n.itemProperties;Wa=cb.cloudFileTypeGoogleSheets;var fb=cb.cloudFileTypeCsv,hb=cb.cloudFileTypeExcel,ib=cb.cloudFileTypeShapefile,jb=cb.cloudFileTypeFgdb,lb=cb.cloudFileTypeGeojson;Pa=cb.cloudDriveProviderBox;var mb=cb.cloudDriveProviderDropbox,nb=cb.cloudDriveProviderOneDrive,ob=cb.cloudDriveProviderGoogleDrive,
pb=cb.fromCloudDrive;cb=cb.createdFrom;-1===Va.indexOf("google-apps")&&-1===Va.indexOf("googlesheets")&&(-1!==Va.indexOf("csv")?Wa=fb:-1!==Va.indexOf("excel")||-1!==Va.indexOf("spreadsheetml")?Wa=hb:-1!==Va.indexOf("shapeFile")?Wa=ib:-1!==Va.indexOf("fgdb")?Wa=jb:-1!==Va.indexOf("geojson")?Wa=lb:(Wa=hb,fb={shapefile:ib,"csv collection":fb,"file geodatabase":jb},"zip"===Va&&gb&&(Va=gb.toLowerCase(),Va in fb&&(Wa=fb[Va]))));Va="";"boxConnect"===La.cloudProvider?Va="https://www.box.com/":"dropBoxConnect"===
La.cloudProvider?(Pa=mb,Va="https://www.dropbox.com/"):"oneDriveConnect"===La.cloudProvider?(Pa=nb,Va="https://onedrive.live.com/"):La.cloudProvider?(Pa=ob,Va="https://drive.google.com/file/d/"+kb):(Pa=qa["default"].overwriteFromGeoJSON.url,Va=La.url);Ta.innerHTML=cb+' \x3ca href\x3d"'+(Va+'" target\x3d"_blank"\x3e '+(null!==eb&&void 0!==eb?eb:La.fileName)+"\x3c/a\x3e, "+Wa+pb+"\n          "+Pa)});P.isVectorTileService&&P.getRelatedItems("Service2Style","forward").then(function(La){0<La.length&&(ca.domNode.querySelector(".js-otherStyles-label").innerHTML=
"Other Styles:",La.forEach(function(Wa,Pa){var Va="item.html?id\x3d"+Wa.id;ra["default"].create("ul",{"class":"leader-0 trailer-0 padding-left-1 inline-block other-styles-"+Pa},ca.domNode.querySelector(".js-otherStyles"),"last");ra["default"].create("a",{href:Va,innerHTML:Wa.title,target:"_blank"},ca.domNode.querySelector(".other-styles-"+Pa));ra["default"].create("span",{innerHTML:", "+Wa.displayName},ca.domNode.querySelector(".other-styles-"+Pa),"last")}))});if(null===ja||void 0===ja?0:ja.length)Ua.innerHTML=
wa["default"].substitute(this.i18n.itemProperties.creatingDataIn+' \x3ca href\x3d"item.html?id\x3d${relItem.id}"\x3e${relItem.title}\x3c/a\x3e, ${relItem.displayName}',{relItem:null===(la=ja.slice(0,1))||void 0===la?void 0:la.shift(),i18n:this.i18n}),y["default"].forEachNode(document.querySelectorAll(".js-details"),function(La){La.classList.add("has-resultCreatingIn")});if(null===Ia||void 0===Ia?0:Ia.length){var Ya=Ia.slice(0,5);var db=Ya.reduce(function(La,Wa,Pa,Va){return ca.renderResultItems(La,
Wa,Pa,Va)},"");db+=this.toSearchString(Ia,5);Sa.innerHTML=db;y["default"].forEachNode(document.querySelectorAll(".js-details"),function(La){return La.classList.add("has-resultVisualizations")})}if(null===Qa||void 0===Qa?0:Qa.length)Ya=Qa.slice(0,5),db=Ya.reduce(function(La,Wa,Pa,Va){return ca.renderResultItems(La,Wa,Pa,Va)},""),db+=this.toSearchString(Qa,5),$a.innerHTML=db,y["default"].forEachNode(document.querySelectorAll(".js-details"),function(La){return La.classList.add("has-resultDataViews")})};
Ba.prototype.renderResultItems=function(P,ca,ja,la){return P+wa["default"].substitute('\x3cli\x3e\x3ca href\x3d"item.html?id\x3d${relItem.id}"\x3e${relItem.title}\x3c/a\x3e, ${displayName}\x3c/li\x3e',{relItem:ca,displayName:ca.displayName,i18n:this.i18n})};Ba.prototype.toSearchString=function(P,ca){var ja=P.length-ca,la=P.map(function(pa){return"id:"+pa.id}).join(" OR ");return P.length>ca?wa["default"].substitute('\x3cli\x3e\x3ca target\x3d"_blank" href\x3d"search.html?t\x3dcontent\x26q\x3d(${query})"\x3e${i18n.FilterDlg.and} ${count} ${i18n.itemProperties.more}\x3c/a\x3e\x3c/li\x3e',
{query:encodeURIComponent(la),i18n:this.i18n,count:ja||0}):""};Ba.prototype.showItemCompleteness=function(P,ca){var ja=this,la="snippet thumbnail description title tags licenseInfo".split(" "),pa=this.domNode.querySelector(".js-scoreCompletenessClosed"),Aa=this.domNode.querySelector(".js-scoreCompletenessOpen"),va=this.domNode.querySelector(".js-itemCompleteness-list"),Ja=this.domNode.querySelector(".js-itemCompleteness-top"),Ka=P.setScoreCompleteness(P.scoreCompleteness),Ia=!1;if(P.canUpdate){Ia=
la.map(function(Sa){return ja.getAttributeCompleteness(Sa,P)});var Qa=Ia.reduce(function(Sa,$a,Xa,Za){return ja.toItemCompletenessList(Sa,$a,Xa,Za)},""),Ta='\x3cspan class\x3d"padding-right-half inline-block"\x3e'+z["default"].inline.lightbulb[24]+'${i18n.itemCompleteness.topImprovement}\x3c/span\x3e\x3cbutton data-attribute\x3d"${attribute}" class\x3d"btn-link font-size--2 js-itemCompleteness-attr"\x3e${msg}\x3c/a\x3e',Ua=Ia.filter(function(Sa){return!Sa.isComplete&&Sa.msg});Ia=!Ua||!Ua.length;Ka=
!Ia&&90<Ka?90:Ka;ra["default"].empty(va);va.innerHTML=Qa;document.querySelector(".js-item-scoreCompleteness-bar").style.width=Ka+"%";Ia?(ra["default"].empty(Ja),Qa=document.querySelector(".js-itemCompleteness-wellDone"),Qa.innerHTML=this.page._formatWellDone(Ka),y["default"].showHide(Qa,ca)):(Ja.innerHTML=wa["default"].substitute(Ta,ta["default"].mixin(Ua.shift(),{i18n:this.i18n})),y["default"].showNode(Ja),y["default"].hideNodes(document.querySelectorAll(".js-itemCompleteness-wellDone")));100===
Ka&&(y["default"].showNode(pa),y["default"].hideNode(Aa),pa.classList.remove("hide"),Aa.classList.add("hide"));ca||this.own(Q["default"](".js-hide-itemCompleteness").on("click",function(){y["default"].showNode(pa);y["default"].hideNode(Aa)}),Q["default"](".js-show-itemCompleteness").on("click",function(){y["default"].hideNode(pa);y["default"].showNode(Aa)}),Z["default"](va,".js-itemCompleteness-attr:click",function(Sa){var $a;Sa=Sa.target.dataset.attribute;Sa=document.querySelector("[data-edit-id\x3d'"+
Sa+"'].js-inline-edit")||document.querySelector("[data-edit-id\x3d'"+Sa+"'].js-action-editThumbnail");null===($a=null===Sa||void 0===Sa?void 0:Sa.click)||void 0===$a?void 0:$a.call(Sa)}),Z["default"](Ja,".js-itemCompleteness-attr:click",function(Sa){Sa=document.querySelector("[data-edit-id\x3d'"+Sa.target.dataset.attribute+"'].js-inline-edit");(null===Sa||void 0===Sa?0:Sa.click)&&Sa.click()}),this.item.watch(function(Sa){(-1<la.indexOf(Sa)||"thumbnailUrl"===Sa)&&ja.showItemCompleteness(ja.item,!0)}))}else y["default"].hideNodes(document.querySelectorAll(".js-scoreCompletenessClosed, .js-scoreCompletenessOpen"))};
Ba.prototype.toItemCompletenessList=function(P,ca,ja,la){return P+wa["default"].substitute(ca.isComplete?'\x3cli class\x3d"icon-ui-check-mark icon-ui-gray leader-0 trailer-0 flex"\x3e\x3cspan class\x3d"tooltip tooltip-multiline tooltip-bottom-left" aria-label\x3d"${tip}"\x3e\x3cbutton data-attribute\x3d"${attribute}" class\x3d"btn-link font-size--3 text-left break-word js-itemCompleteness-attr"\x3e${msg}\x3c/button\x3e\x3c/span\x3e\x3c/li\x3e':'\x3cli class\x3d"icon-ui-radio-unchecked icon-ui-gray leader-0 trailer-0 flex"\x3e\x3cspan class\x3d"tooltip tooltip-multiline tooltip-bottom-left" aria-label\x3d"${tip}"\x3e\x3cbutton data-attribute\x3d"${attribute}" class\x3d"btn-link font-size--3 text-left break-word js-itemCompleteness-attr"\x3e${msg}\x3c/button\x3e\x3c/span\x3e\x3c/li\x3e',
ca)};Ba.prototype.getAttributeCompleteness=function(P,ca){var ja=this.i18n.itemCompleteness;var la=!ca[P];switch(P){case "title":var pa=!la&&(1<ca[P].replace(/^[\s_]+|[\s_]+$/g,"").split(/[\s_]+/).length||14<ca[P].length);la=la||pa?ja.addTitle:ja.addLongerTitle;ja={msg:la,tip:ja.addTitleTip,attribute:P,isComplete:pa};break;case "tags":pa=la||"string"!==typeof ca[P]?ca[P]:ca[P].split(",");var Aa=pa.length;pa=2<Aa;la=la||pa?ja.addTags:ja.addLongerTags;ja={msg:wa["default"].substitute(la,{num:Aa,total:"3"}),
tip:ja.addTagsTip,attribute:P,isComplete:pa};break;case "snippet":pa=!la&&9<ca[P].split(" ").length;la=la||pa?ja.addSummary:ja.addLongerSummary;ja={msg:la,tip:ja.addSummaryTip,attribute:P,isComplete:pa};break;case "thumbnail":pa=ka["default"].isDefined(ca.thumbnail);ja={msg:ja.addCustomThumbnail,tip:ja.addCustomThumbnailTip,attribute:P,isComplete:pa};break;case "description":pa=!la&&99<C["default"].stripHTML(ca[P].replace(/<br\s*\/?>/gi," ")).replace(/^\s+|\s+$/g,"").split(/\s+/).length;la=la||pa?
ja.addDescription:ja.addLongerDescription;ja={msg:la,tip:ja.addDescriptionTip,attribute:P,isComplete:pa};break;case "licenseInfo":pa=!la;la=la||pa?ja.addTermsOfUse:ja.addLongerTermsOfUse;ja={msg:la,tip:ja.addTermsOfUse,attribute:P,isComplete:pa};break;default:ja={msg:"",tip:"",attribute:P,isComplete:!1}}return ja};Ba.prototype.showThumbnailActions=function(P){var ca=this.i18n.itemProperties,ja=document.getElementById("thumbnailAspectRatioTip"),la=document.getElementById("thumbnailAspectRatioTipButton");
if(!P.thumbnail||P.isRetired)la&&y["default"].hideNode(la);else if(null!==P.thumbnailUrl){var pa=new Image;pa.src=P.thumbnailUrl;var Aa=K["default"].getAbsoluteUrl("images/transparent.gif");pa.src!==Aa?pa.onload=function(){var va=.1>Math.abs(1.5-pa.width/pa.height);!va&&ja&&(ja.innerHTML=wa["default"].substitute(ca.thumbnailAspectRatioTip,{aspectRatio:"3:2"}));la&&y["default"].showHide(la,!va&&P.canUpdate)}:la&&(null===la||void 0===la?void 0:la.classList.add("hide"))}};Ba.prototype._showCollaboratedContentNode=
function(P){var ca=["Hosted Service","arcgis.com","Registered App"],ja=this.portalUser,la=!ja||!(null===ja||void 0===ja?0:ja.username);ja=!(null===ja||void 0===ja?0:ja.orgId);(null===P||void 0===P?0:P.origin)&&-1===ca.indexOf(P.origin)&&!la&&!ja&&(P=document.querySelector(".js-collaboratedNode"),ca=ra["default"].create("span",{className:"label esri-premium-content",title:this.i18n.common.collaboratedcontenttitle,innerHTML:this.i18n.common.collaboratedcontent}),ra["default"].place(ca,P,"first"),P.classList.remove("hide"))};
Ba.prototype.showCategories=function(P){var ca,ja=this.portalUser,la=this.item,pa=la.portal;la=la.categories;var Aa=null===pa||void 0===pa?void 0:pa.hasCategorySchema,va=!(null===(ca=P.categories)||void 0===ca||!ca.length);this.categoryEdit=new c["default"]({prop:"categories",inputType:"categories",inputLabel:this.i18n.contentCategories.edit,viewTitle:this.i18n.contentCategories.categories,formTitle:this.i18n.contentCategories.addCategory,formClass:"trailer-1",portal:pa,value:la},this.domNode.querySelector(".js-category-section"));
Aa&&(null===ja||void 0===ja?0:ja.isOrgUser)&&P.canUpdate?this.categoryEdit.initCategoryPicker():va||this.categoryEdit.hide()};Ba.prototype.setLayerAttributes=function(P,ca){var ja=P.supportsAppend,la=P.hasMetadata;P.attributes=[];P.id=P.id||0;P.layerMetadataUrl="";P.attributes.push(ca.isHostedService?"is-hosted":"is-not-hosted");ca.portal.isPortal||(P.attributes.push(ca.isLocationTrackingService?"is-location-tracking":""),ca.isLocationTrackingService&&-1<[1,2].indexOf(P.id)&&P.attributes.push("no-location-tracking-export"));
ca.canUpdate&&"Table"!==P.type&&r["default"].getDateFields(P).length?P.attributes.push("has-dateTime"):ca.canUpdate&&"Table"!==P.type&&!r["default"].getDateFields(P).length&&P.attributes.push("has-no-dateTime");ca.isAdmin&&ja&&P.attributes.push("can-appendData");!ca.isLocationTrackingService&&ca.canUpdate&&ca.isHostedService&&(ca.isAdmin||ca.isOwner)&&P.attributes.push("can-renameLayer");la&&P.url&&(P.attributes.push("has-layerMetadata"),ja=P.url.split("?"),la=ta["default"].mixin(1<ja.length?D.queryToObject(ja[1]):
{},{format:"default",f:"html"}),P.layerMetadataUrl=ja[0]+"/metadata?"+D.objectToQuery(la));P.mapViewerUrl=ca.mapViewerUrl+"\x26layerId\x3d"+P.id;P.mapViewerUrlWithGeocode=ca.mapViewerWithReviewUrl+"\x26layerId\x3d$layer.id}";P.newMapViewerUrl=ca.newMapViewerUrl&&ca.newMapViewerUrl+"\x26layerId\x3d"+P.id||"";P.sceneViewerUrl=ca.sceneViewerUrl+"\x26layerId\x3d"+P.id};Ba.prototype._setToolAttr=function(P,ca){P.attributes=[]};Ba.prototype.showComments=function(P){var ca=this,ja;this.portalUser&&new f["default"]({cssClasses:"member-thumb--medium",
member:this.portalUser},this.domNode.querySelector(".js-portal-user-top-level-avatar"));ra["default"].empty("comments");if(P.numComments){P.comments.forEach(function(pa){var Aa;ca.renderComment(pa,fa["default"],"comments");null===(Aa=pa.replies)||void 0===Aa?void 0:Aa.forEach(function(va){return ca.renderComment(va,ha["default"],"comments")})});document.getElementById("comments").classList.remove("hide");var la=document.querySelector(".js-loadMore-comments");-1<(null===(ja=P.commentsInfo)||void 0===
ja?void 0:ja.nextStart)?la.classList.remove("hide"):la.classList.add("hide")}};Ba.prototype.renderComment=function(P,ca,ja){var la=this.item,pa=this.portalUser,Aa=this.i18n,va=P.ownerProfile,Ja=(null===pa||void 0===pa?void 0:pa.username)===P.owner,Ka=P.owner===la.owner;la=[].concat(P.numReplies||!la.isAdmin&&!Ja?"":"can-delete-comment").concat(Ka?"is-item-owner":"is-not-item-owner");pa={comment:P,i18n:Aa,portalUser:pa,commentOwnerProfile:va,classNames:la.join(" ")};ca=wa["default"].substitute(ca,
pa,function(Ia){return Ia||""},this.page);ja=ra["default"].place(ca,ja,"next");new f["default"]({cssClasses:"member-thumb--medium",member:P.ownerProfile},document.querySelector('[data-comment-id\x3d"'+P.id+'"] .js-comment-avatar'));this.portalUser&&new f["default"]({cssClasses:"member-thumb--medium",member:this.portalUser},ja.querySelector(".js-portal-user-avatar"));return ja};Ba.prototype.showFolders=function(P){var ca;if(P.isAdmin){var ja=null!==(ca=P.itemOwner)&&void 0!==ca?ca:{},la=P.folderId||
ja.username;(ja.folders||[]).some(function(pa){return pa.id===la?(document.querySelector(".js-folder-title").innerHTML=""+z["default"].inline.folder["16"]+pa.title,!0):!1})}};Ba.prototype.showScreenshots=function(P){var ca=this,ja=document.querySelector(".js-screenshotGroup"),la=P.screenshots||[],pa=P.itemUrl+"/info/",Aa=this.portalUser,va=(null===Aa||void 0===Aa?0:Aa.token)?"?token\x3d"+Aa.token:"";la.length&&("Deep Learning Package"===P.type?(document.querySelector(".js-screenshots-title").innerHTML=
this.i18n.itemProperties.modelCharacteristics,la.forEach(function(Ja){ra["default"].place(wa["default"].substitute(Ma["default"],{url:pa+Ja+va,i18n:ca.i18n,icons:ca.icons}),ja)}),this.own(Q["default"](".js-model-characteristic",this.domNode).on("click",function(Ja){Ja=Ja.target.querySelector(".js-model-characteristic-img");(new d["default"]({url:Ja.src,width:Ja.naturalWidth,height:Ja.naturalHeight,title:ca.i18n.itemProperties.modelCharacteristics})).open()}))):la.forEach(function(Ja){ra["default"].place(wa["default"].substitute('\x3cdiv class\x3d"block trailer-1"\x3e\x3cimg src\x3d"${url}"\x3e\x3c/div\x3e',
{url:pa+Ja+va}),ja)}))};Ba.prototype.showUrbanModelInfo=function(P){if("Urban Model"===P.type){P=P.properties||{};var ca=P.master,ja=P.publicView;P=[ca,ja].filter(function(la){return la});P.length&&(P="id:("+P.join(" OR ")+")",this.page.portal.queryItems({q:P,num:2}).then(function(la){la=la.results||[];var pa=la.find(function(va){return va.id===ca});la=la.find(function(va){return va.id===ja});if(pa){var Aa=document.querySelector(".js-urban-database");pa='\x3ca href\x3d"item.html?id\x3d'+pa.id+'" target\x3d"_blank"\x3e'+
pa.title+"\x3c/a\x3e";Aa.innerHTML=wa["default"].substitute(qa["default"].itemProperties.urbanDatabase,{link:pa});Aa.classList.remove("hide")}la&&(Aa=document.querySelector(".js-urban-view"),pa='\x3ca href\x3d"item.html?id\x3d'+la.id+'" target\x3d"_blank"\x3e'+la.title+"\x3c/a\x3e",Aa.innerHTML=wa["default"].substitute(qa["default"].itemProperties.urbanDatabaseView,{link:pa}),Aa.classList.remove("hide"))}))}};Ba.prototype.showImageProperties=function(P){var ca,ja,la=P.serviceInfo;if("Image Service"===
P.type&&la&&(null===la||void 0===la||!la.error)){("esriImageServiceSourceTypeMosaicDataset"===la.serviceSourceType||(null===(ca=la.fields)||void 0===ca?0:ca.length))&&document.querySelector(".js-image-service-source-collection").classList.remove("hide");P=qa["default"].itemProperties.pixelTypes.U1;P=q.__assign(q.__assign({},qa["default"].itemProperties.pixelTypes),{U2:P,U4:P,U8:P,C128:qa["default"].itemProperties.pixelTypes.C64});ca=(null===(ja=la.serviceDataType)||void 0===ja?void 0:ja.replace("esriImageServiceDataType",
""))||"Generic";ja=qa["default"].itemProperties.imageServiceTypes[ca]||qa["default"].itemProperties.imageServiceTypes.Generic;P=P[la.pixelType]||qa["default"].itemProperties.unknown;ca=la.bandCount;var pa=la.spatialReference,Aa=qa["default"].itemProperties.unknown;(null===pa||void 0===pa?0:pa.wkid)?(Aa=W["default"].units[W["default"][pa.wkid]],pa=-1<[4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140].indexOf(pa.wkid)?"grad":"degrees",Aa=Aa||pa):(null===pa||void 0===pa?0:pa.wkt)&&
(pa=/UNIT\[([^\]]+)\]\]$/i.exec(pa.wkt))&&pa[1]&&(Aa=pa[1].split(",")[0].replace(/['"]+/g,""));document.querySelector(".js-image-properties-source-type").textContent=wa["default"].substitute(qa["default"].itemProperties.sourceType,{sourceType:ja});P&&(document.querySelector(".js-image-properties-pixel-type").textContent=wa["default"].substitute(qa["default"].itemProperties.pixelType,{pixelType:P}));ca&&(document.querySelector(".js-image-properties-bands").textContent=wa["default"].substitute(qa["default"].itemProperties.bands,
{bands:ca}));la.pixelSizeX&&la.pixelSizeY&&(la=la.pixelSizeX+" / "+la.pixelSizeY+" "+Aa,document.querySelector(".js-image-properties-cell-size").textContent=wa["default"].substitute(qa["default"].itemProperties.cellSize,{cellSize:la}));document.querySelector(".js-image-service-details").classList.remove("hide")}};Ba.prototype.showProjectContent=function(P,ca){if(null===P||void 0===P?0:P.projectContent){var ja=document.querySelector(".js-projectContent"),la=P.itemData,pa=la.workerWebMapId,Aa=la.dispatchers,
va=la.assignments,Ja=la.workers,Ka=la.tracks,Ia=function(Qa){(null===Qa||void 0===Qa?0:Qa.id)&&(null===Qa||void 0===Qa?0:Qa.title)&&ra["default"].place(wa["default"].substitute('\x3ctr\x3e\x3ctd\x3e\x3ca target\x3d "_blank" href\x3d"item.html?id\x3d${id}"\x3e${title}\x3c/a\x3e\x3c/td\x3e\x3c/tr\x3e',{id:Qa.id,title:Qa.title}),ja)};Ia({id:la.dispatcherWebMapId,title:this.i18n.itemProperties.dispatcherMap});Ia({id:pa,title:this.i18n.itemProperties.mobileWorkerMap});Ia({id:va.serviceItemId,title:this.i18n.itemProperties.assignments});
Ia({id:Aa.serviceItemId,title:this.i18n.itemProperties.dispatchers});Ia({id:Ja.serviceItemId,title:this.i18n.itemProperties.workers});Ia({id:Ka.serviceItemId,title:this.i18n.itemProperties.workerTracks})}};Ba.prototype.showWorkflowContent=function(P){var ca=null===P||void 0===P?void 0:P.workflowContent;"Workflow"===(null===P||void 0===P?void 0:P.type)&&ca&&(P=document.querySelector(".js-workflowContent"),ra["default"].place(wa["default"].substitute(na["default"],{id:(ca.workflowLocations||{}).itemId,
title:this.i18n.itemProperties.workflowJobLocations}),P))};Ba.prototype.showSolutionContent=function(P){var ca=this,ja=document.querySelector(".has-solutionContent");if("Solution"===P.type&&ja)try{var la=P.itemData.templates,pa=-1<P.typeKeywords.indexOf("Deployed");(pa?this.updateTemplates(la):(new ya["default"]).resolve({templates:la,removeTemplates:[]})).then(function(Aa){ca.createHierarchyDisplay(Aa.templates,pa,Aa.removeTemplates);ca.initSolutionRowHandler()})}catch(Aa){ja.classList.remove("has-solutionContent")}};
Ba.prototype.initSolutionRowHandler=function(){var P=Q["default"](".js-solution-row",this.domNode);if(0<P.length){var ca=function(ja){if(ja instanceof MouseEvent||13===ja.keyCode||32===ja.keyCode)32===ja.keyCode&&(ja.preventDefault(),ja.target.parentNode.classList.contains("accordion-title")&&ja.target.click()),ja=ja.srcElement,ja.classList.contains("accordion-title")&&(ja.parentNode.classList.contains("is-active")?y["default"].deactivateNode(ja.parentNode):y["default"].activateNode(ja.parentNode))};
P.on("click",ca);P.on("keydown",ca)}else document.querySelector(".has-solutionContent").classList.remove("has-solutionContent")};Ba.prototype.updateTemplates=function(P){function ca(va){return va.startsWith("{{")?va.substring(2,va.indexOf(".")):va}var ja=new ya["default"],la=[];P.forEach(function(va){return la.push("id:"+ca(va.itemId))});for(var pa=[];0<la.length;){var Aa=la.splice(0,100).join(" OR ");pa.push(K["default"].request({url:this.item.portal.url+"search",content:{f:"json",num:100,q:Aa}}));
pa.push(K["default"].request({url:this.item.portal.url+"community/groups",content:{f:"json",num:100,q:Aa}}))}za["default"](pa).then(function(va){var Ja=[];va.forEach(function(Ia){Ja=Ja.concat(Ia.results||[])});var Ka=[];P.forEach(function(Ia){var Qa=Ja.filter(function(Ta){return Ta.id===Ia.itemId});0<Qa.length?Ia.item=Qa[0]:Ka.push(Ia.itemId)});ja.resolve({templates:P,removeTemplates:Ka})});return ja};Ba.prototype.getTopLevelItemIds=function(P){var ca=P.map(function(ja){return ja.itemId});P.forEach(function(ja){(ja.dependencies||
[]).forEach(function(la){la=ca.indexOf(la);0<=la&&ca.splice(la,1)})});return ca};Ba.prototype.getItemHierarchy=function(P){function ca(va,Ja){var Ka=va.findIndex(function(Ia){return Ja===Ia.itemId});return 0<=Ka?va[Ka]:null}function ja(va,Ja,Ka){void 0===Ka&&(Ka=[]);var Ia=ca(P,va);if(Ia){var Qa={id:va,dependencies:[]};0>Ka.indexOf(va)&&(Ka.push(va),Ia.dependencies.forEach(function(Ta){var Ua=pa.indexOf(Ta);0<=Ua&&pa.splice(Ua,1);ja(Ta,Qa.dependencies,Ka)}));Ja.push(Qa)}}var la=[],pa=this.getTopLevelItemIds(P),
Aa=P.filter(function(va){return 0>pa.indexOf(va.itemId)}).sort(function(va,Ja){return Ja.dependencies.length-va.dependencies.length});pa=pa.concat(Aa.map(function(va){return va.itemId}));for(Aa=pa.shift();"undefined"!==typeof Aa;)ja(Aa,la),Aa=pa.shift();return la};Ba.prototype.createHierarchyDisplay=function(P,ca,ja){var la=this,pa=document.querySelector(".js-solutionContent"),Aa=function(va){if((null===va||void 0===va?0:va.title)&&(null===va||void 0===va?0:va.source)&&(null===va||void 0===va?0:va.type)){var Ja=
ra["default"].toDom(wa["default"].substitute(S["default"],{title:va.title,source:va.source,child:va.child,type:va.type,icons:z["default"]}));if(""===va.child){var Ka=Ja.querySelector(".accordion-title");Ka.classList.add("accordion-title-parent-only");["filters--accordion--title","filters--accordion--title__override"].forEach(function(Ia){return Ka.classList.remove(Ia)});va=Ka.querySelector(".icon-inline");Ka.removeChild(va);va=Ja.querySelector(".accordion-content");va.parentNode.removeChild(va)}ra["default"].place(Ja,
pa)}};this.getItemHierarchy(P).forEach(function(va){if(0>ja.indexOf(va.id)){var Ja=P.filter(function(Ua){return Ua.itemId===va.id})[0],Ka=Ja.item;Ka.iconUrl=G["default"]._getItemIconUrl(Ka);"Group"!==Ja.type&&t["default"].getItemInfo(Ka);var Ia=Ka.title||Ka.name||Ja.type,Qa="Group"===Ja.type?"group":"item",Ta=Array.isArray(va.dependencies)&&0<va.dependencies.length;Aa({title:ca?wa["default"].substitute("\x3ca href\x3d'${webpage}.html?id\x3d${id}' target\x3d'_blank'\x3e${label}\x3c/a\x3e",{id:va.id,
webpage:Qa,label:Ia}):Ia,source:"group"===Qa?"js/arcgisonline/css/images/userGroup.png":Ka.svgIconUrl16,child:Ta?la.createChildHierarchyDisplay({solutionItems:P,hierarchy:va.dependencies,createLinks:ca,groupImage:"js/arcgisonline/css/images/userGroup.png",linkTemplate:"\x3ca href\x3d'${webpage}.html?id\x3d${id}' target\x3d'_blank'\x3e${label}\x3c/a\x3e",removeTemplates:ja}):"",type:Ja.type})}})};Ba.prototype.createChildHierarchyDisplay=function(P){var ca=this,ja=P.solutionItems,la=P.createLinks,pa=
P.groupImage,Aa=P.linkTemplate,va=P.removeTemplates,Ja=[];P.hierarchy.forEach(function(Ka){if(0>va.indexOf(Ka.id)){var Ia=ja.filter(function($a){return $a.itemId===Ka.id})[0],Qa=Ia.item;Qa.iconUrl=G["default"]._getItemIconUrl(Qa);"Group"!==Ia.type&&t["default"].getItemInfo(Qa);var Ta=Qa.title||Qa.name||Ia.type,Ua="Group"===Ia.type?"group":"item",Sa=Array.isArray(Ka.dependencies)&&0<Ka.dependencies.length;Ja.push(wa["default"].substitute(ia["default"],{source:"group"===Ua?pa:Qa.svgIconUrl16,type:Ia.type,
titleOrLink:la?wa["default"].substitute(Aa,{webpage:Ua,id:Ka.id,label:Ta}):Ta,childList:Sa?ca.createChildHierarchyDisplay({solutionItems:ja,hierarchy:Ka.dependencies,createLinks:la,groupImage:pa,linkTemplate:Aa,removeTemplates:va}):""}))}});return Ja.join("")};Ba.prototype.showFormContent=function(P){var ca,ja,la="Form"===P.type||"QuickCapture Project"===P.type;P=(null===(ca=P.relatedService)||void 0===ca?void 0:ca.length)&&(null===(ja=P.relatedService)||void 0===ja?void 0:ja[0]);la&&P&&(ca=Q["default"](".js-formContent").shift(),
ra["default"].place(wa["default"].substitute('\x3cspan\x3e\x3ca target\x3d "_blank" href\x3d"item.html?id\x3d${id}"\x3e${title}\x3c/a\x3e\x3c/span\x3e',{id:P.id,title:P.title}),ca))};Ba.prototype.updateComments=function(){var P=this,ca=new ya["default"];this.page.fetchComments(this.item).then(function(){oa["default"].set("addComment","value","");y["default"].forEachNode(document.querySelectorAll(".js-numComments"),function(ja){return ja.innerHTML="("+P.page._formatCount(P.item.numComments)+")"});
P.showComments(P.item);ca.resolve(P.item)});return ca};Ba.prototype.updateBadges=function(){this.item.badges=V["default"].getBadges(this.item,!0,this.portalUser);this.domNode.querySelector(".js-item-badges").innerHTML=this.item.badges};Ba.prototype.updateRatings=function(){l.render(l.h(H.Ratings,{user:this.portalUser,item:this.item}),document.querySelector(".js-update-ratings"))};Ba.prototype.checkForCachingJob=function(P){var ca=this,ja="Vector Tile Service"===P.type,la=P.cachingJobUrl||P.properties&&
P.properties.cacheJobUrl,pa=function(Aa){var va=Aa&&(Aa.status||Aa.jobStatus),Ja=(va=!(!va||!x["default"].includes(["Completed","esriJobSucceeded","Failed","esriJobFailed"],va)))?a["default"].getEndTime(Aa):void 0;Ja=Ja?Date.now()-Ja:void 0;ca.page._item.set("lastCachingJobStatus",Aa);va&&Ja&&1728E5>Ja||(ca.page._item.set("cachingJobUrl",void 0),ca.page._item.set("serviceChanged",!0),ca.page.dropCacheJobInfo())};"Scene Service"===P.type&&la&&(P.isOwner||P.isAdmin)?(P=new ya["default"],a["default"].checkSceneCachingJobStatus(this.page._item,
this.CACHE_CHECK_INTERVAL,P),P.then(pa,pa)):ja&&this.page._item.adminUrl&&this.item.watch("readyToRetrieveServiceLayers",function(){a["default"].checkVectorTileServiceJobStatus(ca.page._item,ca.CACHE_CHECK_INTERVAL).then(pa,pa)})};Ba.prototype.getShortenedUrl=function(){var P=this,ca=new ya["default"],ja=this.page.portal,la=K["default"].parseUrl(window.location.href).host;ja=window.location.href.replace(la,"multitenant"===ja.portalMode?ja.portalHostname||la:la);this._fetchingShortUrl?setTimeout(function(){P.getShortenedUrl().then(function(pa){ca.resolve(pa)})},
250):(this._fetchingShortUrl=!0,Ha["default"](this.item.shortUrl||K["default"].shortenUrl(ja),function(pa){P.item.set("shortUrl",pa);P._fetchingShortUrl=!1;ca.resolve(pa)}));return ca};Ba.prototype.fetchLastSnapshot=function(){var P=new ya["default"];K["default"].request({url:this.item.itemUrl+"/resources/cdwServiceInfo.json"}).then(function(ca){P.resolve((null===ca||void 0===ca?0:ca.lastSnapshot)?ca.lastSnapshot:void 0)},function(){P.resolve(void 0)});return P};Ba.prototype.initHandlers=function(){var P=
this;this.domNode.querySelector(".js-layers").addEventListener("click",this.handleLayerClick.bind(this));this.domNode.querySelector(".js-tables").addEventListener("click",this.handleLayerClick.bind(this));this.own(this.item.watch("isFavorite",function(){P.set("isFavorite",P.item)}),this.item.watch("folderId",function(ca){var ja=document.querySelector(".js-folders [data-folder-id\x3d'"+P.item.folderId+"']");y["default"].forEachNode(document.querySelectorAll(".js-folder-title"),function(la){return la.innerHTML=
ja.innerHTML})}),this.item.watch("thumbnailUrl",function(){var ca,ja,la,pa,Aa,va=(null===(ca=P.item.thumbnailUrl)||void 0===ca?void 0:ca.split("?"))||[],Ja=va[0]||P.item.thumbnailUrl;ca=(ca=va[1])?D.queryToObject(ca):{};if((null===(la=null===(ja=P.portalUser)||void 0===ja?void 0:ja.credential)||void 0===la?0:la.token)||(null===(pa=P.portalUser)||void 0===pa?0:pa.token))ca.token=(null===(Aa=P.portalUser.credential)||void 0===Aa?void 0:Aa.token)||P.portalUser.token;ca.ts=(new Date).getTime();Ja=Ja+
"?"+D.objectToQuery(ca);y["default"].forEachNode(document.querySelectorAll(".thumbnail-img"),function(Ka){return Ka.src=Ja});P.showThumbnailActions(P.item)}),this.item.watch("description",function(){P._descriptionSection.updateValue(P.item.description)}),this.item.watch("snippet",function(){P._snippetSection.updateValue(P.item.snippet)}),this.item.watch("licenseInfo",function(){P._licenseInfoSection.updateValue(P.item.licenseInfo)}),this.item.watch("accessInformation",function(){P._accessInfo.updateValue(P.item.accessInformation)}),
this.item.watch("tags",function(){P._tagsSection.updateValue(P.item.tags||[])}),this.item.watch("contentStatus",function(){O["default"].getVerifiedInfo(P.item).then(function(ca){P.item.set("verified",ca);P.showOwner(P.item);P.updateBadges()})}),this.item.watch("sharing",function(){var ca=P.item,ja="public"===ca.sharing.access.toString(),la=ca.privileges,pa=ca.types;pa=x["default"].concatUnique(pa||[],ja?["is-public"]:["is-not-public"]);pa=x["default"].filterOut(pa,ja?["is-not-public"]:["is-public"]);
ca.set("types",x["default"][ja?"concatUnique":"filterOut"](pa,["is-public"]));P.showShareStatus(ca);ca.isHostedService&&za["default"]({canPublishWFSService:p["default"].canPublishWFSServiceFromFeatureService(ca),canPublishOGCFeatureServer:p["default"].canPublishOGCFeatureServerFromFeatureService(ca)}).then(function(Aa){Aa.canPublishWFSService?(pa=x["default"].concatUnique(pa,["is-publish"]),la=x["default"][Aa.canPublishWFSService?"concatUnique":"filterOut"](la||[],["can-publish-wfs"])):(pa=p["default"].canPublishTileServiceFromFeatureService(ca)?
pa:x["default"].filterOut(pa,["is-publish"]),la=x["default"].filterOut(la||[],["can-publish-wfs"]));la=Aa.canPublishOGCFeatureServer?x["default"][Aa.canPublishOGCFeatureServer?"concatUnique":"filterOut"](la||[],["can-publish-ogcfeatures"]):x["default"].filterOut(la||[],["can-publish-ogcfeatures"]);ca.set("types",pa);ca.set("privileges",la)});ca.set("contentStatus",V["default"].getContentStatus(ca));P.configureViewUI()}),this.item.watch("status",function(){var ca=P.item,ja=ca.status;ca=ca.statusErrorCode;
var la="completed"===ja||"failed"===ja?"deactivateNode":"activateNode",pa="completed"===ja?"remove":"add";a["default"].isVectorTileFromFeatures(P.item)&&(P.domNode.querySelector(".js-service-status .loader-text").innerHTML=P.i18n.itemProperties.buildingCache);y["default"][la](document.querySelector(".js-service-status"));y["default"].forEachNode(document.querySelectorAll(".js-status-disable"),function(Aa){return Aa.classList[pa]("btn-disabled")});"failed"===ja&&(P.page._showErrors=!0,P.page._showError(P.item.statusError),
P.page.hideLoader(),400===ca||403===ca)&&(ja=document.querySelector(".js-subnav-link.js-status-disable"),null===ja||void 0===ja?void 0:ja.classList.remove("btn-disabled"))}),this.item.watch("displayName",function(){P.domNode.querySelector(".js-typeOwner-info span span").innerHTML=P.item.displayName;P.item.iconUrl=G["default"]._getItemIconUrl(P.item);P.domNode.querySelector(".js-typeOwner-info span img").src=t["default"].getSvgIconUrl(P.item,"16")}),this.item.watch("isLoaded",function(){return q.__awaiter(P,
void 0,void 0,function(){var ca,ja,la,pa,Aa,va,Ja,Ka,Ia,Qa,Ta,Ua,Sa,$a,Xa,Za,bb=this,ab,Ya,db,La;return q.__generator(this,function(Wa){switch(Wa.label){case 0:return ca=this.portalUser||{},ja=!!this.item.origin,la=this.item.isAdmin||this.item.isOwner||ca.isOrgAdmin&&this.item.isOwnedByMyOrg,this.item.layers&&this.reverseLayers(this.item.layers),(pa=la&&!this.sublayer)?[4,this.getLayerStatus(this.item)]:[3,2];case 1:pa=Wa.sent(),Wa.label=2;case 2:pa;this.showLayers(this.item);this.showImageProperties(this.item);
this.page._showDataLastUpdated(this.item);p["default"].registerItemActions(this,document.querySelector(".js-serviceLayers"),m["default"]);p["default"].registerItemActions(this,document.querySelector(".js-serviceTables"),m["default"]);L["default"].dropdown();this.page.hideLoader();!this.item.numViews&&this.item.isHostedService&&"Map Service"===this.item.type&&this.item.serviceInfo&&this.item.adminServiceInfo?(J["default"].mapViewer(this.item),[".js-action-openDefault",".js-open-mapViewer",".js-action-newWebMapViewer.add-to-new-viewer"].forEach(function(Pa){y["default"].forEachNode(bb.domNode.querySelectorAll(Pa),
function(Va){return Va.href=bb.item.mapViewerUrl})})):"Notebook"===this.item.type&&(J["default"].notebookViewer(this.item),y["default"].forEachNode(this.domNode.querySelectorAll(".js-open-notebook, .js-action-openDefault"),function(Pa){return Pa.href=bb.item.notebookViewerUrl}));this.item.canUpdate&&x["default"].includes(this.item.types,"is-storymap")&&!ja&&(document.body.classList.add("is-editable-storymap"),J["default"].configureStoryMap(this.item),y["default"].forEachNode(this.domNode.querySelectorAll(".js-configure-storymap"),
function(Pa){return Pa.href=bb.item.configureStoryMapUrl}));if(Aa=this.get("defaultOpenButton"))if(va=Aa.innerHTML,Aa.classList.remove("btn-clear"),Ja=x["default"].includes(this.item.types,"is-pdf"),Ka=va?-1<va.indexOf(this.i18n.itemLinks.download):(x["default"].includes(this.item.types,"is-download")||x["default"].includes(this.item.types,"is-file")||Ja)&&-1===this.item.type.indexOf("Package"),Ia=x["default"].includes(this.item.types,"is-desktop"),va=(Qa=x["default"].includes(this.item.types,"is-desktopPro")||
x["default"].includes(this.item.types,"is-pro"))?this.item.defaultOpenText:va?va:Ia?this.i18n.itemLinks.openDesktop:Ka?this.i18n.itemLinks.download:this.i18n.common.open,Ka||Ia||Qa||(null===(ab=this.item.openIn)||void 0===ab?0:ab.length))y["default"].forEachNode(document.querySelectorAll(".js-thumbnail"),function(Pa){return Pa.alt=va}),Ta=Ka&&!Ja?z["default"].inline["download-to"][16]:z["default"].inline.launch[16],x["default"].includes(this.item.types,"is-storymap")&&(x["default"].includes(this.item.typeKeywords,
"storymapcollection"),Ua=x["default"].includes(this.item.typeKeywords,"smstatusdraft"),Sa=x["default"].includes(this.item.openIn,"configureStoryMap"),($a=!Sa||!Ua&&this.item.storyMapViewerUrl)?y["default"].forEachNode(this.domNode.querySelectorAll(".js-action-openDefault"),function(Pa){return Pa.href=bb.item.storyMapViewerUrl}):Sa&&(y["default"].forEachNode(this.domNode.querySelectorAll(".js-action-openDefault"),function(Pa){return Pa.href=bb.item.configureStoryMapUrl}),y["default"].removeClasses(this.domNode.querySelector(".js-configure-storymap"),
["btn-clear"])),va=this.item.defaultOpenText,y["default"].forEachNode(this.domNode.querySelectorAll(".js-action-share"),function(Pa){return Pa.classList.add("btn-clear")})),-1<this.item.type.indexOf("GeoBIM")&&this.item.portal.canCreateGeoBIM&&(document.querySelector(".js-action-openDefault").href=this.item.geoBIMUrl),y["default"].forEachNode(this.domNode.querySelectorAll(".js-thumbnail-overlay-text"),function(Pa){return Pa.innerHTML=Ta+va||""});this.page.portal.isPortal&&y["default"].hideNodes(null===
(Ya=this.domNode)||void 0===Ya?void 0:Ya.querySelectorAll(".js-hide-portal"));this.item.canOpenInNewMapViewer||this.portalUser&&this.portalUser.defaultMapViewer!==Ca.MapViewerType.Modern||y["default"].hideNode(document.querySelector(".js-map-open-more-dropdown"));"OGCFeatureServer"===this.item.type&&y["default"].hideNode(document.querySelector(".js-map-open-more-dropdown"));this.item.get("canPublishWFSService")&&!b["default"].ogcFeaturesEnabled&&(Xa=this.domNode.querySelector("button[data-type\x3d'ogcfeatures']"))&&
(Xa.style.display="none");Ga.alignToSupportedExportFormats(this.item,this.page.portal,this.domNode);-1<this.item.typeKeywords.indexOf("usesSnapshot")&&this.fetchLastSnapshot().then(function(Pa){Pa&&(bb.domNode.querySelector(".js-last-snapshot-value").textContent=C["default"].completeDate(Pa),y["default"].showHide(bb.domNode.querySelector(".js-last-snapshot"),!!Pa))});this.item.readyToRetrieveServiceLayers&&this.page.refreshServiceInfo();Za=null!==(La=null===(db=D.queryToObject(window.location.search.slice(1)))||
void 0===db?void 0:db.view)&&void 0!==La?La:"";"service"===Za&&(u.shouldOpenViewModal(this.item,this.portalUser)?u.handleViewModalClick(this.item,this.portalUser,this.domNode.querySelector(".js-view-url"),!0):p["default"].removeQueryParams(["view"]));return[2]}})})}),this.item.watch("url",function(){J["default"].appViewer(P.item);document.querySelector("copy-to-clipboard-url").value=P.item.url;document.querySelector(".if-app .js-open-url").href=P.item.url;document.querySelector(".if-mobile .js-open-url").href=
P.item.appViewerUrl;document.querySelector(".if-link .js-open-url").href=P.item.appViewerUrl;y["default"].forEachNode(document.querySelectorAll(".js-view-url"),function(ca){P.item.viewUrl="public"!==P.item.access?p["default"].needsToken(P.item,P.item.url):P.item.url;ca.href=P.item.viewUrl})}),aa["default"].subscribe("items/itemDetailRefresh",function(ca){y["default"].forEachNode(document.querySelectorAll(".js-folder-title"),function(ja){return ja.innerHTML=z["default"].inline.folder["16"]+ca.title})}),
aa["default"].subscribe("inlineEdit/layerRename/done",function(ca){P.sublayer&&(document.querySelector('.js-sublayer-name[data-id\x3d"'+P.sublayer.id+'"]').innerHTML=ca)}),Z["default"](this.page,"service-info-change",function(){var ca;!P.item.isFeatureCollection&&(x["default"].includes(P.item.types,"is-feature")||x["default"].includes(P.item.types,"is-table"))&&0<(null===(ca=P.item.layers)||void 0===ca?void 0:ca.length)&&P.item.layers.forEach(function(ja){return P.setLayerAttributes(ja,P.item)});
P.item.readyToRetrieveServiceLayers&&(P.showLayers(P.item),aa["default"].publish("thumbnail/update"))}),aa["default"].subscribe("inlineEdit/submit",function(ca){var ja=ca.prop;delete ca.prop;"layerRename"===ja?r["default"].renameServiceLayers(ca,P.item).then(function(){P.item.set("maxAgeCheck",!0);P.page.refreshServiceInfo();aa["default"].publish("inlineEdit/"+ja+"/done",ca[ja]);P.page.hideErrors();return P.item}):-1===ja.indexOf("sublayer")&&(P.page.updateItem(ca,!0).then(function(){return K["default"].request({url:P.item.itemUrl}).then(function(la){P.item.scoreCompleteness=
ka["default"].isDefined(la.scoreCompleteness)?P.item.setScoreCompleteness(la.scoreCompleteness):null;P.item.set(ja,ka["default"].isDefined(la[ja])?la[ja]:"");aa["default"].publish("inlineEdit/"+ja+"/done",ca[ja]);P.page.hideErrors();return P.item})}),function(la){(null===la||void 0===la?0:la.messageCode)&&"GWM_0021"===la.messageCode&&v["default"].showAlert("error",la.message)})}),aa["default"].subscribe("inlineEdit/categories/submit",function(ca){var ja={};ja[P.item.id]={categories:ca};ja={url:P.item.portal.url+
"content/updateItems",content:{items:JSON.stringify([ja])}};K["default"].request(ja,{usePost:!0}).then(function(){aa["default"].publish("inlineEdit/categories/done");P.item.set("categories",ca)},function(la){return 0})}),Z["default"](Q["default"](".js-comments").shift(),".js-action-addComment:click",function(ca){var ja;Ea["default"].stop(ca);var la=P.item,pa=oa["default"].get(ca.target,"data-type"),Aa=oa["default"].get(ca.target,"data-id");la="comment"===pa?{}:(la.comments||[]).filter(function(Ia){return Ia.id===
Aa});var va=la.replies||[];ca=Q["default"](ca.target).siblings("textarea").shift().value.trim();var Ja=P.item.commentsInfo,Ka=null!==(ja=P.item.comments)&&void 0!==ja?ja:[];ca&&P.commentIsValid(ca)&&(y["default"].forEachNode(document.querySelectorAll(".js-disable-addComment"),function(Ia){return Ia.disabled=!0}),P.item.numComments++,P.item.commentsInfo=ta["default"].mixin(Ja,{nextStart:0,overrideNum:"comment"!==pa?Ka.length:Ka.length+1,comments:[]}),la.commentsInfo=ta["default"].mixin(la.commentsInfo||
{},{nextStart:0,overrideNum:va.length+1,comments:[]}),P.item.addComment({comment:escape(ca.trim()),parentId:"reply"===pa?Aa:null}).then(function(){return P.updateComments()}).then(function(){y["default"].forEachNode(document.querySelectorAll(".js-disable-addComment"),function(Ia){return Ia.disabled=!1})}),function(Ia){var Qa=["SB_0001","SB_0002","SB_0003","SB_0004"],Ta=["SB_0005","SB_0006","SB_0007"];if(null===Ia||void 0===Ia?0:Ia.messageCode)x["default"].includes(Qa,Ia.messageCode)?(P._subscriptionStatusDlg=
new B["default"],P._subscriptionStatusDlg.show(P.page.portal.subscriptionInfo)):x["default"].includes(Ta,Ia.messageCode)&&(P._subscriptionStatusDlg=new B["default"],P._subscriptionStatusDlg.showOther(Ia.messageCode));P.item.numComments--;y["default"].forEachNode(document.querySelectorAll(".js-disable-addComment"),function(Ua){return Ua.disabled=!0})})}),Z["default"](document.getElementById("comments"),".js-action-deleteComment:click",function(ca){Ea["default"].stop(ca);if(!P._isDeletingComment){var ja=
new A["default"]({buttonOkLabel:P.i18n.common.yesLabel,buttonCancelLabel:P.i18n.common.noLabel,style:{width:"400px",height:"auto"}}),la=oa["default"].get(ca.target,"data-type"),pa=oa["default"].get(ca.target,"data-id"),Aa=P.item.commentsInfo,va=P.item.comments||[];ja.show({title:P.i18n.common.deleteCommentTitle,message:P.i18n.common.deleteCommentMsg}).then(function(Ja){"onOk"===Ja&&(P._isDeletingComment=!0,P.item.numComments--,ta["default"].mixin(Aa||{},{nextStart:0,overrideNum:"comment"!==la?va.length:
va.length-1,comments:[]}),P.item.deleteComment({url:P.item.itemUrl+"/comments/"+pa}).then(function(){return P.updateComments()}).then(function(){ja.hide();P._isDeletingComment=!1},function(){ja.hide();P._isDeletingComment=!1}))})}}),Z["default"](document.getElementById("comments"),".js-action-reply:click",function(ca){Ea["default"].stop(ca);ca=oa["default"].get(ca.target,"data-id");var ja=document.querySelector(".js-reply-"+ca+" textarea");y["default"].showNodes(document.querySelectorAll(".js-reply-"+
ca));ja&&ja.focus()}),Z["default"](document.getElementById("comments"),".js-action-cancelReply:click",function(ca){Ea["default"].stop(ca);Q["default"](ca.target).closest("[class*\x3djs-reply]").addClass("hide")}),Z["default"](document.getElementById("comments"),".js-comment-profile:click",function(ca){Ea["default"].stop(ca);var ja=oa["default"].get(ca.selectorTarget,"data-owner");"deletedUser"!==ja&&m["default"].profilePopup({evt:ca,item:P.item,profile:ja,page:P.page})}),Q["default"](".js-loadMore-comments",
this.domNode).on("click",function(ca){Ea["default"].stop(ca);P.updateComments()}),Q["default"](".js-sort-comments",this.domNode).on("change",function(ca){Ea["default"].stop(ca);ta["default"].mixin(P.item.commentsInfo,{nextStart:0,comments:[],sortField:ca.target.value||"created"});P.updateComments()}),Z["default"].once(ea["default"].byId("shorten-url"),"mouseover, click",function(ca){Ea["default"].stop(ca);P.getShortenedUrl().then(function(ja){Q["default"]("#copy-to-clipboard-shortUrl").attr("value",
ja)})}),Q["default"](".js-shorten-url",this.domNode).on("click",function(ca){Ea["default"].stop(ca)}));this._thumbnailErrorConnect=Q["default"](".js-thumbnail",this.domNode).on("error",function(){Q["default"](".js-thumbnail",P.domNode).attr("src",K["default"].relativeToExplicitUrl("js/arcgisonline/css/images/default_thumb.png"));P._thumbnailErrorConnect.remove();P._thumbnailErrorConnect=null});"StoryMap"===this.item.type&&document.querySelector(".js-action-openDefault").removeAttribute("data-action");
p["default"].registerItemActions(this,this.domNode,m["default"],this.page,this.actionGuard.bind(this));this.item.portal.isPortal&&this.item.portal.isReadOnly&&(this.domNode.querySelector(".js-if-not-readonly").classList.remove("js-dropdown-toggle"),this.own(Q["default"](".js-if-not-readonly",this.domNode).on("click",function(ca){P.checkReadonly(P.item.portal);ca.preventDefault()})))};Ba.prototype.handleLayerClick=function(P){var ca=P.target;if(null===ca||void 0===ca?0:ca.classList.contains("js-sublayer-link")){P.preventDefault();
var ja=parseInt(ca.getAttribute("data-id"),10);(P=x["default"].find(this.item.layers||[],function(la){return la.id===ja}))&&this.toggleSubLayer(P,!0)}};Ba.prototype.actionGuard=function(P){return-1===["publishTiles","share","thumbnail"].indexOf(P)?!1:this.checkReadonly(this.item.portal)};Ba.prototype.commentIsValid=function(P){return!this.item.portal.isPortal&&-1<(null===P||void 0===P?void 0:P.indexOf("http://"))?(v["default"].showAlert("error",this.i18n.common.httpNotSupported),!1):!0};Ba.prototype.reverseLayers=
function(P){for(var ca=0;ca<P.length;ca++){var ja=P[ca];ja.layers&&(this.reverseLayers(ja.layers),ja.layers.reverse())}};Ba.prototype.cancelInlineEdit=function(){aa["default"].publish("inlineEdit/cancel")};return Ba=q.__decorate([T["default"](ba["default"],ma["default"],da["default"],g["default"])],Ba)}()})},"arcgisonline/pages/dijit/InlineEdit":function(){define("require exports tslib esri/lang esri/libs/sanitizer/Sanitizer arcgis-components/wrappers/Tags dojo/on dojo/query dojo/has dojo/topic dojo/string dojo/i18n!../../nls/arcgisonline dijit/_TemplatedMixin dijit/_WidgetBase ../pageUtil ../utils/formatters ../utils/alerts ../utils/arrays ../utils/dom ../../sharing/util ../utils/icons ../../sharing/dijit/Editor dojox/uuid/generateRandomUuid ./CategoryPicker dojo/text!./InlineEdit/templates/InlineEdit.html dojo/text!./InlineEdit/templates/inlineEditTextArea.html dojo/text!./InlineEdit/templates/inlineEditFieldValueType.html dojo/text!./InlineEdit/templates/inlineEditRichText.html dojo/text!./InlineEdit/templates/inlineEditCustom.html dojo/text!./InlineEdit/templates/inlineEditLayerRename.html dojo/text!./InlineEdit/templates/inlineEditLayerRenameSubnav.html dojo/text!./InlineEdit/templates/inlineEditNotebookTags.html arcgisonline/tsutils/declareDecorator dijit/_editor/plugins/FontChoice dijit/_editor/plugins/TextColor ./InlineEdit/ViewSource ../../sharing/dijit/LinkDialog".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D,K,G,I,R){b=q.__importDefault(b);l=q.__importDefault(l);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);y=q.__importDefault(y);C=q.__importDefault(C);z=q.__importDefault(z);
F=q.__importDefault(F);O=q.__importDefault(O);V=q.__importDefault(V);N=q.__importDefault(N);J=q.__importDefault(J);D=q.__importDefault(D);K=q.__importDefault(K);G=q.__importDefault(G);I=q.__importDefault(I);R=q.__importDefault(R);return function(){function A(B,H){this.templateString=O["default"];this.i18n=f["default"];this.icons=y["default"];this.inputType="textbox";this.inputClass="subnav-edit__input";this.defaultText=this.inputLabel="";this.invalidText=this.emptyText=void 0;this.required=!1;this.pattern=
void 0;this.editorHeight="240px";this.rows=4;this.titleClass="subnav-title";this.titleId="pagetitle";this.viewTitle=this.placeholder=this.buttonsClass=this.formClass=this.formTitle="";this.knownTags=[];this.isGroup=!1;this.editButtonClasses="btn-link-white if-can-update";this.editButtonUpdatePermissionClasses="if-can-update";this.cancelButtonClasses="btn btn-transparent btn-link-white";this.saveButtonClasses="btn btn-white margin-left-half";this.showCharactersLeft=this.showLoader=!1;this.sanitizer=
new l["default"];this.dontSanitize=!1;this._oldValue=this.prop="";this._supportsFormValidation=!1;this.templateString={textArea:V["default"],fieldValueType:N["default"],richText:J["default"],tags:D["default"],categories:D["default"],layerRename:K["default"],layerRenameSubnav:G["default"],notebookTags:I["default"]}[B.isNotebook?"notebookTags":B.inputType]||O["default"];this.baseUrl=B.baseUrl;this.openInNewTab=B.openInNewTab;this.inputLabel=B.inputLabel||B.formTitle||f["default"].common.edit}A.prototype.postMixInProperties=
function(){this.inherited(arguments);this.inputId=this.inputId||z["default"]();this._oldValue=this.value=this._sanitizeValue(this.value);this.knownTags&&(this.knownTags=this._sanitizeStringArray(this.knownTags))};A.prototype.postCreate=function(){this.inherited(arguments);this.showLoader&&v["default"].showNode(this._saveLoader);this.required&&(this._input.required=!0);this.pattern&&(this._input.pattern=this.pattern);var B=document.createElement("input");this._supportsFormValidation=!c["default"]("safari")&&
"required"in B&&"pattern"in B;!this._supportsFormValidation||"textArea"!==this.inputType&&"textbox"!==this.inputType||this._input.setCustomValidity(this._valOrFunction(this.defaultText||"",window,[this._input]));switch(this.inputType){case "textArea":case "textbox":this.maxLength&&(this._input.maxLength=this.maxLength);break;case "richText":this._formatRichText();break;case "tags":this._inputEl.id=this.inputId,this._form.addEventListener("keydown",function(H){"Enter"===H.key&&"INPUT"===H.target.nodeName&&
H.preventDefault()})}this._hasCharactersLeft()&&(v["default"].showNode(this._charactersLeft),this._setCharactersLeft(),this.own(r["default"](this._input,"keyup",this._setCharactersLeft.bind(this))));this._updateView();this._initHandlers()};A.prototype.initTagsEditor=function(){var B=Array.isArray(this.value)?this.value:this.value.split(",");this.domNode.querySelector(".js-inline-edit").setAttribute("data-edit-id","tags");this._input=new p.TagsWrapper(this.domNode.querySelector("#"+this.inputId),{activeTags:B.filter(function(H){return H}),
knownTags:this.knownTags.map(function(H){return H.tag}),maxWidth:"100%",minWidth:"100%"})};A.prototype.initCategoryPicker=function(){var B=this;this.portal&&this.portal.getCategories().then(function(H){B._formatCategories(B.value);B._input=new F["default"]({categories:B.value,schema:H,alwaysOpen:!0},B._inputEl);B._input.startup()},function(H){})};A.prototype.hide=function(){v["default"].hideNode(this.domNode)};A.prototype.hideEditLink=function(){a["default"](".js-inline-edit",this.domNode).addClass("visibility-hidden")};
A.prototype.showEditLink=function(){a["default"](".js-inline-edit",this.domNode).removeClass("visibility-hidden")};A.prototype.updateText=function(B){B=this._sanitizeString(B);a["default"](".js-view",this.domNode).innerHTML(B);this.value=this._input.value=B};A.prototype.updateValue=function(B){B=this._sanitizeValue(B);this._setInputValue(B);this.value=B;this._updateView()};A.prototype._sanitizeValue=function(B){return B instanceof Array?this._sanitizeStringArray(B):this._sanitizeString(B)};A.prototype._sanitizeStringArray=
function(B){var H=this;return this.dontSanitize?B:(B||[]).map(function(T){return H.sanitizer.sanitize(T)})};A.prototype._sanitizeString=function(B){return this.dontSanitize?B:this.sanitizer.sanitize(B)};A.prototype._setCharactersLeft=function(){this._hasCharactersLeft()&&(this._charactersLeft.textContent=h["default"].substitute(this.i18n.myOrganization.generalTab.summaryCharsLeft,{chars:this.maxLength-this._input.value.length}))};A.prototype._setInputValue=function(B){this._input&&("richText"===this.inputType?
this._input.set("value",B||""):"categories"===this.inputType?this._input.setCategories(B,!0):"tags"===this.inputType?(B=Array.isArray(B)?B:B.split(","),this._input.setTags(B.filter(function(H){return H}))):this._input.value=b["default"].isDefined(B)?B:"")};A.prototype._initHandlers=function(){var B=this;this.own(r["default"](this._cancelButton,"click",function(H){H.stopPropagation();H.preventDefault();B._cancelEdit()}),a["default"](".js-inline-edit",this.domNode).on("click",function(H){var T;H.stopPropagation();
d["default"].publish("inlineEdit/"+B.prop+"/start");B._oldValue=B.value;v["default"].hideNode(B._textView);v["default"].showNode(B._form);"richText"===B.inputType&&((null===(T=B._input)||void 0===T?0:T.destroy)&&B._input.destroy(!0),H=m["default"].editorDefaults(B.inputId),H.height=B.editorHeight,B._input=new C["default"](H,B._inputEl),B._input.startup(),B._input.set("value",B.value||""));"fieldValueType"===B.inputType&&B._setupFieldValueType(B.value);"categories"!==B.inputType&&B._input.focus()}),
r["default"](this._form,"submit",function(H){H.stopPropagation();H.preventDefault();H="richText"===B.inputType&&B._input.get("value")||"textArea"===B.inputType&&B._input.value;B.containsHttp(H)?w["default"].showAlert("error",B.i18n.common.httpNotSupported):B._submitForm()}),d["default"].subscribe("inlineEdit/"+this.prop+"/done",function(H){B.containsHttp(B.value)&&w["default"].showAlert("error",B.i18n.common.httpNotSupported);B._updateView();B.showLoader&&B._saveLoader&&(B._saveButton.disabled=!1,
B._cancelButton.disabled=!1,B._saveLoader.classList.remove("inline-edit-save-loader--active"));B._hideEdit()}),d["default"].subscribe("inlineEdit/cancel",function(){B._cancelEdit()}),d["default"].subscribe("inlineEdit/"+this.prop+"/oldValue",function(H){B.value=B._oldValue=H}));"textbox"!==this.inputType&&"textArea"!==this.inputType&&"layerRename"!==this.inputType&&"layerRenameSubnav"!==this.inputType||this.own(r["default"](this._input,"change",this._changeOrInput.bind(this)),r["default"](this._input,
"input",this._changeOrInput.bind(this)),r["default"](this._input,"invalid",this._invalid.bind(this)))};A.prototype.containsHttp=function(B){var H;return!x["default"].isPortal()&&("richText"===this.inputType||"textArea"===this.inputType)&&-1<(null===(H=null===B||void 0===B?void 0:B.indexOf)||void 0===H?void 0:H.call(B,"http://"))};A.prototype._cancelEdit=function(){var B;this._setInputValue(this._oldValue);this._setCharactersLeft();(null===(B=this._input)||void 0===B?0:B.validity)&&this._setCustomValidity("");
"categories"===this.inputType&&this._input.hideError();this._hideEdit();d["default"].publish("inlineEdit/"+this.prop+"/cancel")};A.prototype._hasCharactersLeft=function(){return"textArea"===this.inputType&&this.maxLength&&this.showCharactersLeft&&b["default"].isDefined(this._charactersLeft)};A.prototype._updateView=function(){var B=this.domNode.querySelectorAll(".js-view"),H=this.inputType;if(0<B.length&&this.value||"tags"===H){switch(H){case "categories":B=this._formatCategories(this.value);break;
case "fieldValueType":B=this._getFieldValueType(this.value);break;case "tags":B=this._formatTags(this.value);break;default:B=this.formatter?this.formatter(this.value):this.value}"tags"!==H&&"categories"!==H&&(B=this._sanitizeString(B));a["default"](".js-view",this.domNode).innerHTML(B);"richText"===this.inputType&&this._formatRichText()}};A.prototype._submitForm=function(){var B={},H=u["default"].from(this._form.elements)||[],T;if(("textbox"===this.inputType||"textArea"===this.inputType||"layerRename"===
this.inputType||"layerRenameSubnav"===this.inputType)&&!this._supportsFormValidation&&(H=H.some(function(M){return(T=M.getAttribute("data-customValidity"))?(d["default"].publish("page/showError",{message:T}),!0):!1})))return;this.showLoader&&this._saveLoader&&(this._saveButton.disabled=!0,this._cancelButton.disabled=!0,this._saveLoader.classList.add("inline-edit-save-loader--active"));"categories"===this.inputType?(this._input.hideError(),this.value=this._input.getCategories(!0),d["default"].publish("inlineEdit/categories/submit",
this.value)):(B[this.prop]="tags"===this.inputType?this._input.getTags().join(","):this._input.value,B.clearEmptyFields=!0,B.prop=this.prop,-1<["layerRename","layerRenameSubnav","layerDescription","layerCopyright"].indexOf(this.prop)&&void 0!==this.layerId&&(B.layerId=this.layerId),this.value=B[this.prop],d["default"].publish("inlineEdit/submit",B));this._oldValue=this.value};A.prototype._changeOrInput=function(){var B,H,T=null!==(H=null===(B=this._input.value)||void 0===B?void 0:B.trim())&&void 0!==
H?H:"";B=this._input.pattern;H=this._input.required;var M="TEXTAREA"!==this._input.nodeName;!T&&H?this.emptyText&&this._setCustomValidity(this._valOrFunction(this.emptyText,window,[this._input])):this._supportsFormValidation&&M||!B?this._setCustomValidity(""):(new RegExp(B)).test(T)?this._setCustomValidity(""):this.invalidText&&this._setCustomValidity(this._valOrFunction(this.invalidText,window,[this._input]))};A.prototype._invalid=function(){var B,H,T,M,L,X,ba=null!==(H=null===(B=this._input.value)||
void 0===B?void 0:B.trim())&&void 0!==H?H:"";ba&&""!==ba?(null===(T=this._input.validity)||void 0===T?0:T.patternMismatch)||(null===(M=this._input.validity)||void 0===M?0:M.badInput)||(null===(L=this._input.validity)||void 0===L?0:L.typeMismatch)||(null===(X=this._input.validity)||void 0===X?0:X.customError)?this.invalidText&&this._setCustomValidity(this._valOrFunction(this.invalidText,window,[this._input])):this._setCustomValidity(""):this.emptyText&&this._setCustomValidity(this._valOrFunction(this.emptyText,
window,[this._input]))};A.prototype._valOrFunction=function(B,H,T){return"function"===typeof B?B.apply(H,T):B};A.prototype._setCustomValidity=function(B){this._supportsFormValidation?this._input.setCustomValidity(B):(this._input.setAttribute("data-customvalidity",B),""===B&&d["default"].publish("hidePageError"))};A.prototype._hideEdit=function(){v["default"].showNode(this._textView);v["default"].hideNode(this._form)};A.prototype._formatCategories=function(B){var H=new RegExp(/^\/.+\//);B=B.map(function(T){return T.replace(H,
"")}).map(t["default"].formatCategoryChip).reduce(function(T,M){return T+h["default"].substitute("\x3cspan class\x3d'label filter-label'\x3e${category}\x3c/span\x3e",{category:M})},"");return 0<B.length?B:this.i18n.contentCategories.noCategoriesItem};A.prototype._formatTags=function(B){var H=this;B=B&&"string"===typeof B?B.split(","):B||[];var T="settings-tab"===this._currentView,M=this.isGroup?"groups":"content";return 0>=B.filter(function(L){return L}).length?this.i18n.contentCategories.noTags:
B.map(function(L){var X=H.dontSanitize?L:H.sanitizer.sanitize(L);X=x["default"].htmlEncode(X);return T?L:'\x3ca href\x3d"'+(H.baseUrl||"")+"search.html?t\x3d"+M+"\x26q\x3dtags:%22"+X+'%22" target\x3d"'+(H.openInNewTab?"_blank":"_self")+'"\x3e'+X+"\x3c/a\x3e"}).join(", ")};A.prototype._formatRichText=function(){a["default"](".js-view table").addClass("table")};A.prototype._setupFieldValueType=function(B){for(var H=this.fieldValueTypeList.fieldValueType,T=0;T<H.length;T++)this._input.options[T]=new Option(this._getFieldValueType(H[T].title),
H[T].title),B===H[T].title&&(this._input.selectedIndex=T)};A.prototype._getFieldValueType=function(B){if("none"===B)return this.i18n.attributeFieldDetails.none;B=B||this.i18n.attributesView.commonUndefined;return this.i18n.attributeFieldDetails.fieldValueTypesList[B]||B};return A=q.__decorate([R["default"](n["default"],g["default"])],A)}()})},"arcgisonline/sharing/dijit/Editor":function(){define("require exports tslib ../../tsutils/declareDecorator dijit/Editor dijit/_editor/_Plugin dijit/form/ToggleButton".split(" "),
function(e,U,q,b,l,p,r){function a(c){return new p["default"]({buttonClass:r["default"],command:c.name})}b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);e=function(){function c(d,h){this.declaredClass="arcgisonline.sharing.dijit.Editor"}return c=q.__decorate([b["default"](l["default"])],c)}();p["default"].registry=q.__assign(q.__assign({},p["default"].registry),{insertOrderedList:a,insertUnorderedList:a,justifyCenter:a,justifyFull:a,justifyLeft:a,justifyRight:a});
return e})},"dijit/_editor/plugins/FontChoice":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-construct dojo/i18n dojo/_base/lang dojo/string dojo/store/Memory ../../registry ../../_Widget ../../_TemplatedMixin ../../_WidgetsInTemplateMixin ../../form/FilteringSelect ../_Plugin ../range dojo/i18n!../nls/FontChoice".split(" "),function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m){e=q("dijit._editor.plugins._FontDropDown",[d,h,f],{label:"",plainText:!1,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${selectId}'\x3e${label}\x3c/label\x3e\x3cinput data-dojo-type\x3d'../../form/FilteringSelect' required\x3d'false' data-dojo-props\x3d'labelType:\"html\", labelAttr:\"label\", searchAttr:\"name\"' class\x3d'${comboClass}' tabIndex\x3d'-1' id\x3d'${selectId}' data-dojo-attach-point\x3d'select' value\x3d''/\x3e\x3c/span\x3e",
contextRequire:e,postMixInProperties:function(){this.inherited(arguments);this.strings=l.getLocalization("dijit._editor","FontChoice");this.label=this.strings[this.command];this.id=c.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.selectId=this.id+"_select";this.inherited(arguments)},postCreate:function(){this.select.set("store",new a({idProperty:"value",data:U.map(this.values,function(x){var y=this.strings[x]||x;return{label:this.getLabel(x,y),name:y,value:x}},this)}));this.select.set("value",
"",!1);this.disabled=this.select.get("disabled")},_setValueAttr:function(x,y){y=!1!==y;this.select.set("value",0>U.indexOf(this.values,x)?"":x,y);y||(this.select._lastValueReported=null)},_getValueAttr:function(){return this.select.get("value")},focus:function(){this.select.focus()},_setDisabledAttr:function(x){this._set("disabled",x);this.select.set("disabled",x)}});var t=q("dijit._editor.plugins._FontNameDropDown",e,{generic:!1,command:"fontName",comboClass:"dijitFontNameCombo",postMixInProperties:function(){this.values||
(this.values=this.generic?["serif","sans-serif","monospace","cursive","fantasy"]:["Arial","Times New Roman","Comic Sans MS","Courier New"]);this.inherited(arguments)},getLabel:function(x,y){return this.plainText?y:"\x3cdiv style\x3d'font-family: "+x+"'\x3e"+y+"\x3c/div\x3e"},_normalizeFontName:function(x){var y=this.values;if(!x||!y)return x;var C=x.split(",");if(1<C.length)for(var z=0,F=C.length;z<F;z++){var O=r.trim(C[z]);if(-1<U.indexOf(y,O))return O}return x},_setValueAttr:function(x,y){y=!1!==
y;x=this._normalizeFontName(x);this.generic&&(x={Arial:"sans-serif",Helvetica:"sans-serif",Myriad:"sans-serif",Times:"serif","Times New Roman":"serif","Comic Sans MS":"cursive","Apple Chancery":"cursive",Courier:"monospace","Courier New":"monospace",Papyrus:"fantasy","Estrangelo Edessa":"cursive",Gabriola:"fantasy"}[x]||x);this.inherited(arguments,[x,y])}}),w=q("dijit._editor.plugins._FontSizeDropDown",e,{command:"fontSize",comboClass:"dijitFontSizeCombo",values:[1,2,3,4,5,6,7],getLabel:function(x,
y){return this.plainText?y:"\x3cfont size\x3d"+x+"'\x3e"+y+"\x3c/font\x3e"},_setValueAttr:function(x,y){y=!1!==y;x.indexOf&&-1!=x.indexOf("px")&&(x={10:1,13:2,16:3,18:4,24:5,32:6,48:7}[parseInt(x,10)]||x);this.inherited(arguments,[x,y])}}),u=q("dijit._editor.plugins._FormatBlockDropDown",e,{command:"formatBlock",comboClass:"dijitFormatBlockCombo",values:"noFormat p h1 h2 h3 pre".split(" "),postCreate:function(){this.inherited(arguments);this.set("value","noFormat",!1)},getLabel:function(x,y){return this.plainText||
"noFormat"==x?y:"\x3c"+x+"\x3e"+y+"\x3c/"+x+"\x3e"},_execCommand:function(x,y,C){if("noFormat"===C){var z;if((y=m.getSelection(x.window))&&0<y.rangeCount&&(C=y.getRangeAt(0),C)){y=C.startContainer;for(z=C.endContainer;y&&y!==x.editNode&&y!==x.document.body&&1!==y.nodeType;)y=y.parentNode;for(;z&&z!==x.editNode&&z!==x.document.body&&1!==z.nodeType;)z=z.parentNode;var F=p.hitch(this,function(J,D){if(J.childNodes&&J.childNodes.length){var K;for(K=0;K<J.childNodes.length;K++){var G=J.childNodes[K];if(1==
G.nodeType&&x.selection.inSelection(G)){var I=G.tagName?G.tagName.toLowerCase():"";-1!==U.indexOf(this.values,I)&&D.push(G);F(G,D)}}}});C=p.hitch(this,function(J){if(J&&J.length){for(x.beginEditing();J.length;)this._removeFormat(x,J.pop());x.endEditing()}});var O=[];if(y==z){for(z=y;z&&z!==x.editNode&&z!==x.document.body;){if(1==z.nodeType){var V=z.tagName?z.tagName.toLowerCase():"";if(-1!==U.indexOf(this.values,V)){var N=z;break}}z=z.parentNode}F(y,O);N&&(O=[N].concat(O))}else for(z=y;x.selection.inSelection(z);)1==
z.nodeType&&(V=z.tagName?z.tagName.toLowerCase():"",-1!==U.indexOf(this.values,V)&&O.push(z),F(z,O)),z=z.nextSibling;C(O);x.onDisplayChanged()}}else x.execCommand(y,C)},_removeFormat:function(x,y){if(x.customUndo){for(;y.firstChild;)b.place(y.firstChild,y,"before");y.parentNode.removeChild(y)}else{x.selection.selectElementChildren(y);var C=x.selection.getSelectedHtml();x.selection.selectElement(y);x.execCommand("inserthtml",C||"")}}}),v=q("dijit._editor.plugins.FontChoice",n,{useDefaultCommand:!1,
_initButton:function(){var x={fontName:t,fontSize:w,formatBlock:u}[this.command],y=this.params;this.params.custom&&(y.values=this.params.custom);var C=this.editor;this.button=new x(p.delegate({dir:C.dir,lang:C.lang},y));this.own(this.button.select.on("change",p.hitch(this,function(z){this.editor.focused&&this.editor.focus();"fontName"==this.command&&-1!=z.indexOf(" ")&&(z="'"+z+"'");this.button._execCommand?this.button._execCommand(this.editor,this.command,z):this.editor.execCommand(this.command,
z)})))},updateState:function(){var x=this.editor,y=this.command;if(x&&x.isLoaded&&y.length&&this.button){var C=this.get("disabled");this.button.set("disabled",C);if(!C){try{var z=x.queryCommandValue(y)||""}catch(O){z=""}(C=p.isString(z)&&(z.match(/'([^']*)'/)||z.match(/"([^"]*)"/)))&&(z=C[1]);"fontSize"!==y||z||(z=3);if("formatBlock"===y)if(z&&"p"!=z)0>U.indexOf(this.button.values,z)&&(z="noFormat");else{z=null;if((y=m.getSelection(this.editor.window))&&0<y.rangeCount&&(y=y.getRangeAt(0)))var F=y.endContainer;
for(;F&&F!==x.editNode&&F!==x.document;){if((y=F.tagName?F.tagName.toLowerCase():"")&&-1<U.indexOf(this.button.values,y)){z=y;break}F=F.parentNode}z||(z="noFormat")}z!==this.button.get("value")&&this.button.set("value",z,!1)}}}});U.forEach(["fontName","fontSize","formatBlock"],function(x){n.registry[x]=function(y){return new v({command:x,plainText:y.plainText})}});v._FontDropDown=e;v._FontNameDropDown=t;v._FontSizeDropDown=w;v._FormatBlockDropDown=u;return v})},"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),
function(e,U,q,b,l,p){var r=q("dijit._editor.plugins.TextColor",l,{buttonClass:p,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var a=this;this.button.loadDropDown=function(c){function d(h){a.button.dropDown=new h({dir:a.editor.dir,ownerDocument:a.editor.ownerDocument,value:a.value,onChange:function(f){a.editor.execCommand(a.command,f)},onExecute:function(){a.editor.execCommand(a.command,this.get("value"))}});c()}"string"==
typeof a.colorPicker?e([a.colorPicker],d):d(a.colorPicker)}},updateState:function(){var a=this.editor,c=this.command;if(a&&a.isLoaded&&c.length){if(this.button){var d=this.get("disabled");this.button.set("disabled",d);if(d)return;try{var h=a.queryCommandValue(c)||""}catch(f){h=""}}""==h&&(h="#000000");"transparent"==h&&(h="#ffffff");"string"==typeof h?-1<h.indexOf("rgb")&&(h=U.fromRgb(h).toHex()):(h=((h&255)<<16|h&65280|(h&16711680)>>>16).toString(16),h="#000000".slice(0,7-h.length)+h);this.value=
h;(a=this.button.dropDown)&&a.get&&h!==a.get("value")&&a.set("value",h,!1)}}});l.registry.foreColor=function(a){return new r(a)};l.registry.hiliteColor=function(a){return new r(a)};return r})},"arcgisonline/pages/dijit/InlineEdit/ViewSource":function(){define("require exports tslib ../../../tsutils/declareDecorator dijit/_editor/_Plugin dijit/_editor/plugins/ViewSource esri/libs/sanitizer/Sanitizer".split(" "),function(e,U,q,b,l,p,r){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);
r=q.__importDefault(r);var a=function(){function c(d){this.declaredClass="arcgisonline.pages.dijit.InlineEdit.ViewSource";this.sanitizer=new r["default"]}c.prototype._filter=function(d){d&&(d=this.sanitizer.sanitize(d),this.stripScripts&&(d=this._stripScripts(d)),this.stripComments&&(d=this._stripComments(d)),this.stripIFrames&&(d=this._stripIFrames(d)),this.stripEventHandlers&&(d=this._stripEventHandlers(d)));return d};return c=q.__decorate([b["default"](p["default"])],c)}();l["default"].registry.viewSourceSanitize=
l["default"].registry.viewsourcesanitize=function(c){return new a({readOnly:"readOnly"in c?c.readOnly:!1,stripComments:"stripComments"in c?c.stripComments:!0,stripScripts:"stripScripts"in c?c.stripScripts:!0,stripIFrames:"stripIFrames"in c?c.stripIFrames:!0,stripEventHandlers:"stripEventHandlers"in c?c.stripEventHandlers:!0})};return a})},"dijit/_editor/plugins/ViewSource":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/window ../../focus ../_Plugin ../../form/ToggleButton ../.. ../../registry dojo/i18n!../nls/commands".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u){var v=q("dijit._editor.plugins.ViewSource",m,{stripScripts:!0,stripComments:!0,stripIFrames:!0,stripEventHandlers:!0,readOnly:!1,_fsPlugin:null,toggle:function(){f("webkit")&&(this._vsFocused=!0);this.button.set("checked",!this.button.get("checked"))},_initButton:function(){var x=a.getLocalization("dijit._editor","commands"),y=this.editor;this.button=new t({label:x.viewSource,ownerDocument:y.ownerDocument,dir:y.dir,lang:y.lang,showLabel:!1,iconClass:this.iconClassPrefix+
" "+this.iconClassPrefix+"ViewSource",tabIndex:"-1",onChange:d.hitch(this,"_showSource")});this.button.set("readOnly",!1)},setEditor:function(x){this.editor=x;this._initButton();this.removeValueFilterHandles();this._setValueFilterHandle=U.before(this.editor,"setValue",d.hitch(this,function(y){return[this._filter(y)]}));this._getValueFilterHandle=U.after(this.editor,"getValue",d.hitch(this,function(y){return this._filter(y)}));this.editor.addKeyHandler(c.F12,!0,!0,d.hitch(this,function(y){this.button.focus();
this.toggle();y.stopPropagation();y.preventDefault();setTimeout(d.hitch(this,function(){this.editor.focused&&this.editor.focus()}),100)}))},_showSource:function(x){var y=this.editor,C=y._plugins;this._sourceShown=x;var z=this;try{this.sourceArea||this._createSourceView();if(x)y._sourceQueryCommandEnabled=y.queryCommandEnabled,y.queryCommandEnabled=function(O){return"viewsource"===O.toLowerCase()},this.editor.onDisplayChanged(),e.forEach(C,function(O){!O||O instanceof v||!O.isInstanceOf(m)||O.set("disabled",
!0)}),this._fsPlugin&&(this._fsPlugin._getAltViewNode=function(){return z.sourceArea}),this.sourceArea.value=y.get("value"),this.sourceArea.style.height=y.iframe.style.height,this.sourceArea.style.width=y.iframe.style.width,y.iframe.parentNode.style.position="relative",r.set(y.iframe,{position:"absolute",top:0,visibility:"hidden"}),r.set(this.sourceArea,{display:"block"}),this._resizeHandle=h(window,"resize",d.hitch(this,function(){var O=g.getBox(y.ownerDocument);"_prevW"in this&&"_prevH"in this&&
O.w===this._prevW&&O.h===this._prevH||(this._prevW=O.w,this._prevH=O.h,this._resizer&&(clearTimeout(this._resizer),delete this._resizer),this._resizer=setTimeout(d.hitch(this,function(){delete this._resizer;this._resize()}),10))})),setTimeout(d.hitch(this,this._resize),100),this.editor.onNormalizedDisplayChanged(),this.editor.__oldGetValue=this.editor.getValue,this.editor.getValue=d.hitch(this,function(){var O=this.sourceArea.value;return O=this._filter(O)}),this._setListener=U.after(this.editor,
"setValue",d.hitch(this,function(O){this.sourceArea.value=O||""}),!0);else{if(!y._sourceQueryCommandEnabled)return;this._setListener.remove();delete this._setListener;this._resizeHandle.remove();delete this._resizeHandle;this.editor.__oldGetValue&&(this.editor.getValue=this.editor.__oldGetValue,delete this.editor.__oldGetValue);y.queryCommandEnabled=y._sourceQueryCommandEnabled;if(!this._readOnly){var F=this.sourceArea.value;y.beginEditing();y.set("value",F);y.endEditing()}e.forEach(C,function(O){O&&
O.isInstanceOf(m)&&O.set("disabled",!1)});r.set(this.sourceArea,"display","none");r.set(y.iframe,{position:"relative",visibility:"visible"});delete y._sourceQueryCommandEnabled;this.editor.onDisplayChanged()}setTimeout(d.hitch(this,function(){var O=y.domNode.parentNode;O&&(O=u.getEnclosingWidget(O))&&O.resize&&O.resize();y.resize()}),300)}catch(O){}},updateState:function(){this.button.set("disabled",this.get("disabled"))},_resize:function(){var x=this.editor,y=x.getHeaderHeight(),C=x.getFooterHeight(),
z=p.position(x.domNode),F=p.getPadBorderExtents(x.iframe.parentNode),O=p.getMarginExtents(x.iframe.parentNode),V=p.getPadBorderExtents(x.domNode),N=z.w-V.w;z=z.h-(y+V.h+C);this._fsPlugin&&this._fsPlugin.isFullscreen&&(x=g.getBox(x.ownerDocument),N=x.w-V.w,z=x.h-(y+V.h+C));p.setMarginBox(this.sourceArea,{w:Math.round(N-(F.w+O.w)),h:Math.round(z-(F.h+O.h))})},_createSourceView:function(){var x=this.editor,y=x._plugins;this.sourceArea=l.create("textarea");this.readOnly&&(b.set(this.sourceArea,"readOnly",
!0),this._readOnly=!0);r.set(this.sourceArea,{padding:"0px",margin:"0px",borderWidth:"0px",borderStyle:"none"});b.set(this.sourceArea,"aria-label",this.editor.id);l.place(this.sourceArea,x.iframe,"before");f("ie")&&x.iframe.parentNode.lastChild!==x.iframe&&r.set(x.iframe.parentNode.lastChild,{width:"0px",height:"0px",padding:"0px",margin:"0px",borderWidth:"0px",borderStyle:"none"});x._viewsource_oldFocus=x.focus;var C=this;x.focus=function(){if(C._sourceShown)C.setSourceAreaCaret();else try{this._vsFocused?
(delete this._vsFocused,n.focus(x.editNode)):x._viewsource_oldFocus()}catch(O){}};var z,F;for(z=0;z<y.length;z++)if((F=y[z])&&("dijit._editor.plugins.FullScreen"===F.declaredClass||F.declaredClass===w._scopeName+"._editor.plugins.FullScreen")){this._fsPlugin=F;break}this._fsPlugin&&(this._fsPlugin._viewsource_getAltViewNode=this._fsPlugin._getAltViewNode,this._fsPlugin._getAltViewNode=function(){return C._sourceShown?C.sourceArea:this._viewsource_getAltViewNode()});this.own(h(this.sourceArea,"keydown",
d.hitch(this,function(O){this._sourceShown&&O.keyCode==c.F12&&O.ctrlKey&&O.shiftKey&&(this.button.focus(),this.button.set("checked",!1),setTimeout(d.hitch(this,function(){x.focus()}),100),O.stopPropagation(),O.preventDefault())})))},_stripScripts:function(x){x&&(x=x.replace(/<\s*script[^>]*>((.|\s)*?)<\\?\/\s*script\s*>/ig,""),x=x.replace(/<\s*script\b([^<>]|\s)*>?/ig,""),x=x.replace(/<[^>]*=(\s|)*[("|')]javascript:[^$1][(\s|.)]*[$1][^>]*>/ig,""));return x},_stripComments:function(x){x&&(x=x.replace(/\x3c!--(.|\s){1,}?--\x3e/g,
""));return x},_stripIFrames:function(x){x&&(x=x.replace(/<\s*iframe[^>]*>((.|\s)*?)<\\?\/\s*iframe\s*>/ig,""));return x},_stripEventHandlers:function(x){if(x){var y=x.match(/<[a-z]+?\b(.*?on.*?(['"]).*?\2.*?)+>/gim);if(y)for(var C=0,z=y.length;C<z;C++){var F=y[C],O=F.replace(/\s+on[a-z]*\s*=\s*(['"])(.*?)\1/igm,"");x=x.replace(F,O)}}return x},_filter:function(x){x&&(this.stripScripts&&(x=this._stripScripts(x)),this.stripComments&&(x=this._stripComments(x)),this.stripIFrames&&(x=this._stripIFrames(x)),
this.stripEventHandlers&&(x=this._stripEventHandlers(x)));return x},removeValueFilterHandles:function(){this._setValueFilterHandle&&(this._setValueFilterHandle.remove(),delete this._setValueFilterHandle);this._getValueFilterHandle&&(this._getValueFilterHandle.remove(),delete this._getValueFilterHandle)},setSourceAreaCaret:function(){var x=this.sourceArea;n.focus(x);this._sourceShown&&!this.readOnly&&(x.setSelectionRange?x.setSelectionRange(0,0):this.sourceArea.createTextRange&&(x=x.createTextRange(),
x.collapse(!0),x.moveStart("character",-99999),x.moveStart("character",0),x.moveEnd("character",0),x.select()))},destroy:function(){this._resizer&&(clearTimeout(this._resizer),delete this._resizer);this._resizeHandle&&(this._resizeHandle.remove(),delete this._resizeHandle);this._setListener&&(this._setListener.remove(),delete this._setListener);this.removeValueFilterHandles();this.inherited(arguments)}});m.registry.viewSource=m.registry.viewsource=function(x){return new v({readOnly:"readOnly"in x?
x.readOnly:!1,stripComments:"stripComments"in x?x.stripComments:!0,stripScripts:"stripScripts"in x?x.stripScripts:!0,stripIFrames:"stripIFrames"in x?x.stripIFrames:!0,stripEventHandlers:"stripEventHandlers"in x?x.stripEventHandlers:!0})};return v})},"arcgisonline/sharing/dijit/LinkDialog":function(){define("require exports tslib dijit/_editor/_Plugin dijit/_editor/plugins/LinkDialog dojo/on ../util ../../pages/utils/validation ../../tsutils/declareDecorator dojo/i18n!../../nls/arcgisonline".split(" "),
function(e,U,q,b,l,p,r,a,c,d){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);var h=function(){function g(n,m){this.linkDialogTemplate="\x3cdiv class\x3d'link-container'\x3e\x3cdiv class\x3d'link-container__content text-left'\x3e\x3cdiv class\x3d'leader-half'\x3e\x3clabel class\x3d'avenir-demi trailer-0' id\x3d'${id}_textInputLabel' for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3cinput data-dojo-type\x3d'dijit/form/ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/div\x3e\x3cdiv class\x3d'leader-half'\x3e\x3clabel class\x3d'avenir-demi trailer-0' id\x3d'${id}_urlInputLabel' for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3cinput data-dojo-type\x3d'dijit/form/ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'\x3e\x3cdiv class\x3d'input-error-message' id\x3d'${id}_urlInputError'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'hide'\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit/form/Select'\x3e\x3coption selected\x3d'selected' value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3c/select\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'link-container__button-row leader-half text-right'\x3e\x3cbutton data-dojo-type\x3d'dijit/form/Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton class\x3d'padding-left-half cancel' data-dojo-type\x3d'dijit/form/Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e"}
g.prototype._loadDropDown=function(){var n=this;this.inherited(arguments);var m=0,t=setInterval(function(){n._urlInput?(clearInterval(t),n._urlInput.isValid=function(){return!0}):15<m&&clearInterval(t);m++},1E3)};g.prototype._onOpenDialog=function(){this.inherited(arguments);var n=d["default"].linkDialog;this._urlInputError=document.getElementById(this._uniqueId+"_urlInputError");this.dropDown.contentsNode.parentNode.classList.add("link-container");var m=this.dropDown.containerNode;m.classList.add("text-left");
m.title=n.linkTitle;m.firstChild.textContent="";var t=m.children[0];t.className+="link-container__title font-size-1";t.style.cssText="";t.textContent=n.linkTitle;if(t=document.getElementById(this._uniqueId+"_textInputLabel"))t.innerHTML=n.text;if(t=document.getElementById(this._uniqueId+"_urlInputLabel"))t.innerHTML=n.url;this._setButton.set("label",n.update);n=m.querySelector("#"+this._uniqueId+"_textInput");var w=m.querySelector("#"+this._uniqueId+"_urlInput"),u=n.value;setTimeout(function(){u&&
w.focus()},150)};g.prototype._isValid=function(){var n=this._urlInput.get("value");if(!r["default"].isPortal()&&n.length&&-1<n.indexOf("http:"))return a["default"].setInvalidState(null,this._urlInputError,d["default"].common.httpNotSupported),!1;a["default"].clearState([this._urlInputError]);return!0};g.prototype._checkAndFixInput=function(){var n=this,m=this._urlInput.get("value");this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var t=
m,w=!1,u=!1;1<(null===t||void 0===t?void 0:t.length)&&(t=t.trim(),0!==t.indexOf("mailto:")&&(0<t.indexOf("/")?-1===t.indexOf("://")&&"/"!==t.charAt(0)&&t.indexOf("./")&&0!==t.indexOf("../")&&n._hostRxp.test(t)&&(w=!0):n._userAtRxp.test(t)&&(u=!0)));w&&-1===t.indexOf("{expression/")&&-1===t.indexOf("{relationships/")&&n._urlInput.set("value","http://"+t);u&&n._urlInput.set("value","mailto:"+t);n._setButton.set("disabled",!n._isValid())},250)};return g=q.__decorate([c["default"](l["default"])],g)}(),
f=function(){function g(n,m){this.linkDialogTemplate="\x3cdiv class\x3d'link-container'\x3e\x3cdiv class\x3d'link-container__content text-left'\x3e\x3cdiv class\x3d'leader-half'\x3e\x3clabel class\x3d'avenir-demi trailer-0' id\x3d'${id}_urlInputLabel' for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3cinput data-dojo-type\x3d'dijit/form/ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'\x3e\x3cdiv class\x3d'input-error-message' id\x3d'${id}_urlInputError'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'leader-half'\x3e\x3clabel class\x3d'avenir-demi trailer-0' id\x3d'${id}_textInputLabel' for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3cinput data-dojo-type\x3d'dijit/form/ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'link-container__button-row leader-half text-right'\x3e\x3cbutton data-dojo-type\x3d'dijit/form/Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton class\x3d'padding-left-half cancel' data-dojo-type\x3d'dijit/form/Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e";
this.htmlTemplate='\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e';this.tag="img"}g.prototype._getCurrentValues=function(n){if((null===n||void 0===n?void 0:n.tagName.toLowerCase())===this.tag){var m=n.getAttribute("_djrealurl")||n.getAttribute("src");var t=n.getAttribute("alt");this.editor.selection.selectElement(n,!0)}else t=this.editor.selection.getSelectedText();return{urlInput:m||"",textInput:t||""}};g.prototype._onOpenDialog=function(){this.inherited(arguments);
var n=d["default"].linkDialog;this._urlInputError=document.getElementById(this._uniqueId+"_urlInputError");this.dropDown.contentsNode.parentNode.classList.add("link-container");var m=this.dropDown.containerNode;m.classList.add("text-left");m.title=n.imageTitle;m.firstChild.textContent="";m=m.children[0];m.className+="link-container__title font-size-1";m.style.cssText="";m.textContent=n.imageTitle;if(m=document.getElementById(this._uniqueId+"_textInputLabel"))m.innerHTML=n.description;if(m=document.getElementById(this._uniqueId+
"_urlInputLabel"))m.innerHTML=n.url;this._setButton.set("label",n.update)};g.prototype._isValid=function(){var n=this._urlInput.get("value");if(!r["default"].isPortal()&&n.length&&-1<n.indexOf("http:"))return a["default"].setInvalidState(null,this._urlInputError,d["default"].common.httpNotSupported),!1;a["default"].clearState([this._urlInputError]);return!0};g.prototype._connectTagEvents=function(){var n=this;this.inherited(arguments);this.editor.onLoadDeferred.then(function(){n.own(p["default"](n.editor.editNode,
"mousedown",n._selectTag.bind(n)))})};g.prototype._selectTag=function(n){if(null===n||void 0===n?0:n.target)n=n.target,(n.tagName?n.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(n)};g.prototype._checkValues=function(n){if(null===n||void 0===n?0:n.urlInput)n.urlInput=n.urlInput.replace(/"/g,"\x26quot;");if(null===n||void 0===n?0:n.textInput)n.textInput=n.textInput.replace(/"/g,"\x26quot;");return n};g.prototype._onDblClick=function(n){if(n&&n.target&&(n=n.target,(n.tagName?
n.tagName.toLowerCase():"")===this.tag&&n.src)){var m=this.editor;this.editor.selection.selectElement(n);m.onDisplayChanged();m._updateTimer&&(m._updateTimer.remove(),delete m._updateTimer);m.onNormalizedDisplayChanged();var t=this.button;setTimeout(function(){t.set("disabled",!1);t.loadAndOpenDropDown().then(function(){t.dropDown.focus&&t.dropDown.focus()})},10)}};return g=q.__decorate([c["default"](l["default"])],g)}();b["default"].registry.createEsriLink=function(g){return new h({command:"createLink"})};
b["default"].registry.insertEsriImage=function(g){return new f({command:"insertImage"})};h.ImgLinkDialog=f;return h})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),function(e,U,q,b,l,p,r,a,c,d,h,f,g){var n=q("dijit._editor.plugins.LinkDialog",h,{allowUnsafeHtml:!1,linkFilter:[[/</g,"\x26lt;"]],buttonClass:f,
useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=p.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(t){e("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),p.hitch(this,function(w,u,v){var x=this;this.tag="insertImage"==this.command?"img":"a";w=p.delegate(w.getLocalization("dijit","common",this.lang),w.getLocalization("dijit._editor",
"LinkDialog",this.lang));var y=this.dropDown=this.button.dropDown=new u({title:w[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:p.hitch(this,"setValue"),onOpen:function(){x._onOpenDialog();u.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(p.hitch(x,"_onCloseDialog"),0)}});w.urlRegExp=this.urlRegExp;w.id=v.getUniqueId(this.editor.id);this._uniqueId=w.id;this._setContent(y.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
d.substitute(this.linkDialogTemplate,w));y.startup();this._urlInput=v.byId(this._uniqueId+"_urlInput");this._textInput=v.byId(this._uniqueId+"_textInput");this._setButton=v.byId(this._uniqueId+"_setButton");this.own(v.byId(this._uniqueId+"_cancelButton").on("click",p.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",p.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",p.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=p.hitch(this,function(){var C=this._urlInput.get("value");return this._urlRegExp.test(C)||this._emailRegExp.test(C)});this.own(r(y.domNode,"keydown",p.hitch(this,p.hitch(this,function(C){!C||C.keyCode!=l.ENTER||C.shiftKey||C.metaKey||C.ctrlKey||C.altKey||this._setButton.get("disabled")||(y.onExecute(),y.execute(y.get("value")))}))));t()}))},_checkAndFixInput:function(){var t=this,w=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var u=w,v=!1,x=!1;u&&1<u.length&&(u=p.trim(u),0!==u.indexOf("mailto:")&&(0<u.indexOf("/")?-1===u.indexOf("://")&&"/"!==u.charAt(0)&&u.indexOf("./")&&0!==u.indexOf("../")&&t._hostRxp.test(u)&&(v=!0):t._userAtRxp.test(u)&&(x=!0)));v&&t._urlInput.set("value","http://"+u);x&&t._urlInput.set("value","mailto:"+u);t._setButton.set("disabled",!t._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(p.hitch(this,
function(){this.own(r(this.editor.editNode,"mouseup",p.hitch(this,"_onMouseUp")));this.own(r(this.editor.editNode,"dblclick",p.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(t){this.dropDown.set({parserScope:"dojo",content:t})},_checkValues:function(t){t&&t.urlInput&&(t.urlInput=t.urlInput.replace(/"/g,"\x26quot;"));!this.allowUnsafeHtml&&t&&t.textInput&&("function"===typeof this.linkFilter?t.textInput=this.linkFilter(t.textInput):
U.forEach(this.linkFilter,function(w){t.textInput=t.textInput.replace(w[0],w[1])}));return t},_createlinkEnabledImpl:function(){return!0},setValue:function(t){this._onCloseDialog();if(9>a("ie")){var w=g.getSelection(this.editor.window).getRangeAt(0).endContainer;3===w.nodeType&&(w=w.parentNode);w&&w.nodeName&&w.nodeName.toLowerCase()!==this.tag&&(w=this.editor.selection.getSelectedElement(this.tag));w&&w.nodeName&&w.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(w),
this.editor.execCommand("unlink"))}t=this._checkValues(t);this.editor.execCommand("inserthtml",d.substitute(this.htmlTemplate,t));c("a",this.editor.document).forEach(function(u){u.innerHTML||b.has(u,"name")||u.parentNode.removeChild(u)},this)},_onCloseDialog:function(){this.editor.focused&&this.editor.focus()},_getCurrentValues:function(t){if(t&&t.tagName.toLowerCase()===this.tag){var w=t.getAttribute("_djrealurl")||t.getAttribute("href");var u=t.getAttribute("target")||"_self";var v=t.textContent||
t.innerText;this.editor.selection.selectElement(t,!0)}else v=this.editor.selection.getSelectedText();return{urlInput:w||"",textInput:v||"",targetSelect:u||""}},_onOpenDialog:function(){if(a("ie")){var t=g.getSelection(this.editor.window);if(t.rangeCount){var w=t.getRangeAt(0);var u=w.endContainer;3===u.nodeType&&(u=u.parentNode);u&&u.nodeName&&u.nodeName.toLowerCase()!==this.tag&&(u=this.editor.selection.getSelectedElement(this.tag));if(!u||u.nodeName&&u.nodeName.toLowerCase()!==this.tag)(t=this.editor.selection.getAncestorElement(this.tag))&&
t.nodeName&&t.nodeName.toLowerCase()==this.tag?(u=t,this.editor.selection.selectElement(u)):w.startContainer===w.endContainer&&(t=w.startContainer.firstChild)&&t.nodeName&&t.nodeName.toLowerCase()==this.tag&&(u=t,this.editor.selection.selectElement(u))}}else u=this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(u))},_onDblClick:function(t){if(t&&t.target&&(t=t.target,(t.tagName?t.tagName.toLowerCase():
"")===this.tag&&b.get(t,"href"))){var w=this.editor;this.editor.selection.selectElement(t);w.onDisplayChanged();w._updateTimer&&(w._updateTimer.remove(),delete w._updateTimer);w.onNormalizedDisplayChanged();var u=this.button;setTimeout(function(){u.set("disabled",!1);u.loadAndOpenDropDown().then(function(){u.dropDown.focus&&u.dropDown.focus()})},10)}},_onMouseUp:function(){if(a("ff")){var t=this.editor.selection.getAncestorElement(this.tag);if(t){var w=g.getSelection(this.editor.window).getRangeAt(0);
if(w.collapsed&&t.childNodes.length){var u=w.cloneRange();u.selectNodeContents(t.childNodes[t.childNodes.length-1]);u.setStart(t.childNodes[0],0);1!==w.compareBoundaryPoints(u.START_TO_START,u)?w.setStartBefore(t):-1!==w.compareBoundaryPoints(u.END_TO_START,u)&&w.setStartAfter(t)}}}}}),m=q("dijit._editor.plugins.ImgLinkDialog",[n],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(t){if(t&&t.tagName.toLowerCase()===this.tag){var w=t.getAttribute("_djrealurl")||t.getAttribute("src");var u=t.getAttribute("alt");this.editor.selection.selectElement(t,!0)}else u=this.editor.selection.getSelectedText();return{urlInput:w||"",textInput:u||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);
this.editor.onLoadDeferred.then(p.hitch(this,function(){this.own(r(this.editor.editNode,"mousedown",p.hitch(this,"_selectTag")))}))},_selectTag:function(t){t&&t.target&&(t=t.target,(t.tagName?t.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(t))},_checkValues:function(t){t&&t.urlInput&&(t.urlInput=t.urlInput.replace(/"/g,"\x26quot;"));t&&t.textInput&&(t.textInput=t.textInput.replace(/"/g,"\x26quot;"));return t},_onDblClick:function(t){if(t&&t.target&&(t=t.target,(t.tagName?
t.tagName.toLowerCase():"")===this.tag&&b.get(t,"src"))){var w=this.editor;this.editor.selection.selectElement(t);w.onDisplayChanged();w._updateTimer&&(w._updateTimer.remove(),delete w._updateTimer);w.onNormalizedDisplayChanged();var u=this.button;setTimeout(function(){u.set("disabled",!1);u.loadAndOpenDropDown().then(function(){u.dropDown.focus&&u.dropDown.focus()})},10)}}});h.registry.createLink=function(t){var w={command:"createLink",allowUnsafeHtml:"allowUnsafeHtml"in t?t.allowUnsafeHtml:!1};
"linkFilter"in t&&(w.linkFilter=t.linkFilter);return new n(w)};h.registry.insertImage=function(){return new m({command:"insertImage"})};n.ImgLinkDialog=m;return n})},"arcgisonline/pages/dijit/ImageViewer":function(){define("require exports tslib dojo/i18n!../../nls/arcgisonline dojo/string ./Overlay dijit/_TemplatedMixin dijit/_WidgetBase ../../tsutils/declareDecorator dojo/text!./ImageViewer/ImageViewer.html".split(" "),function(e,U,q,b,l,p,r,a,c,d){b=q.__importDefault(b);l=q.__importDefault(l);
p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);return function(){function h(f,g){this.alt="";this.i18n=b["default"];this.showActionBar=!1}h.prototype.postMixInProperties=function(){this.inherited(arguments);this.overlayContents=l["default"].substitute(d["default"],{i18n:b["default"],url:this.url,alt:this.alt});this.maxWidth=this.width};h.prototype.postCreate=function(){this.inherited(arguments);var f=this.domNode.querySelector(".js-image-viewer");
f.style.width=this.width+"px";f.style.height=this.height+"px"};return h=q.__decorate([c["default"](a["default"],r["default"],p["default"])],h)}()})},"arcgisonline/pages/dijit/ItemShareSummary":function(){define("require exports tslib ../../tsutils/declareDecorator dojo/on dojo/dom-construct dojo/string dijit/_TemplatedMixin dijit/_WidgetBase ../utils/icons ../utils/dom ../utils/item dojo/text!./ItemShareSummary/ItemShareSummary.html dojo/text!./ItemShareSummary/ItemShareSummaryOverflow.html dojo/i18n!../../nls/arcgisonline ../item/_Actions ../organization/widgets/GroupIcon".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);return function(){function u(v,x){this.templateString=g["default"];this.i18n=m["default"];this.icons=d["default"];this.showShareGroups=
this.canShare=this.right=!1;this.responsive=!0;this.totalGroups=0;this.responsiveClass=this.directionClass=""}u.prototype.postMixInProperties=function(){this.inherited(arguments);var v={"private":d["default"].user["16"],shared:d["default"].user["16"],org:d["default"].organization["16"],"public":d["default"].globe["16"]},x={"private":m["default"].itemSharing.owner,shared:m["default"].itemSharing.owner,org:m["default"].itemSharing.org,"public":m["default"].itemSharing["public"]};this.levelIcon=this.item.access&&
v[this.item.access]||"";this.levelTooltip=m["default"].itemSharing.shareLevel+" "+x[this.item.access];this.right&&(this.directionClass="share-summary--right");this.responsive&&(this.responsiveClass="share-summary--responsive")};u.prototype.postCreate=function(){var v=this,x;this.inherited(arguments);var y=!this.showShareGroups&&"shared"===this.item.access,C=this.showShareGroups&&0<(null===(x=this.item.groupData)||void 0===x?void 0:x.length),z=this.domNode.querySelector(".js-share-button"),F=m["default"].itemSharing.updateSharing;
x=m["default"].itemSharing.ariaLabels.privateGroups;"shared"!==this.item.access&&(x=m["default"].itemSharing.ariaLabels[""+this.item.access+(C?"Groups":"")]);this.allowShare&&(this.item.canShare||f["default"].canShareItem(this.item,this.portalUser))?(this.own(l["default"](z,"click",this.handleClick.bind(this))),z.classList.add("share-summary__button--editable")):(F=p["default"].create("span"),p["default"].place(F,z,"before"),F.innerHTML=z.innerHTML,z.parentNode.removeChild(z),z=F,h["default"].addClasses(z,
"share-summary__button flex flex-center flex-0 tooltip tooltip--data tooltip-multiline tooltip--multiline-short".split(" ")),z.querySelector(".js-icon").tabIndex=0,F="");var O=""+F+(F?", ":"")+m["default"].itemSharing.shareLevel+" "+x;z.setAttribute("aria-label",m["default"].itemSharing.shareLevel+" "+x+" "+F);z.setAttribute("data-tooltip",O);C&&(this.totalGroups=this.item.sharedGroups||0,this.item.groupData.slice(0,3).forEach(function(V){V.id=V.id||V.groupId;V.title=V.title||V.groupTitle;V.thumbnail=
V.thumbnail||V.groupThumbnail;new w["default"]({group:V,portal:v.item.portal,size:"24",letterSize:"16",tooltipClass:"",cssClasses:"flex-0 share-summary__group"},p["default"].create("div",{},z))}),3<this.totalGroups&&p["default"].place(r["default"].substitute(n["default"],{num:this.totalGroups-3}),z,"last"));y&&this.domNode.classList.add("share-summary--show-unknown-group");C&&this.domNode.classList.add("share-summary--show-unknown-group-responsive");y||C||(this.domNode.querySelector(".js-sharing-plus-icon").classList.add("hide"),
this.domNode.classList.add("share-summary--no-groups"))};u.prototype.handleClick=function(v){var x=this;v.preventDefault();v.stopPropagation();var y=this.item,C=this.telemetry,z=y.portal,F=this.portalUser;this.item.isOwner?t["default"].share({evt:v,item:y,user:F,portal:z,telemetry:C}):this.item.getOwnerProfile(!0,!0).then(function(O){x.item.itemOwner=O;t["default"].share({evt:v,item:y,user:F,portal:z,telemetry:C})})};return u=q.__decorate([b["default"](c["default"],a["default"])],u)}()})},"arcgisonline/pages/dijit/OrgPopup/OrgPopup":function(){define("require exports tslib esri/Evented dojo/text!./OrgPopup.html dojo/i18n!../../../nls/arcgisonline dojo/on dojo/keys dijit/_TemplatedMixin dijit/_WidgetBase dijit/popup dijit/TooltipDialog arcgisonline/pages/utils/dom arcgisonline/pages/utils/focus arcgisonline/pages/utils/icons arcgisonline/tsutils/declareDecorator".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);return function(){function w(u,v){this.templateString=l["default"];this.i18n=p["default"];this.icons=m["default"]}w.prototype.postCreate=function(){this.inherited(arguments);
this.dialog=new f["default"]({"class":"profile-popup",title:"",content:this.domNode,_onKey:this.handleDialogKeydown.bind(this)});this.render();this.addEventListeners()};w.prototype.open=function(){var u=this;h["default"].open({popup:this.dialog,orient:["below","above"],around:this.opener,onCancel:function(){u.opener.focus();u.close()}});this.dialog.domNode.parentElement.classList.add("profile-popup__container");var v=n["default"].getFocusableElements(this.dialog.domNode);this.firstFocusItem=v[0];
this.lastFocusItem=v[v.length-1];this.firstFocusItem.focus();setTimeout(function(){g["default"].showHide(u.descToggle,u.descEl.scrollHeight>u.descEl.clientHeight)},100)};w.prototype.close=function(){h["default"].close(this.dialog);this.dialog.destroy();this.destroy();this.emit("close")};w.prototype.render=function(){g["default"].showHide(this.descContainer,!!this.item.verified.description);this.item.verified.description&&(this.descEl.innerHTML=this.item.verified.description)};w.prototype.addEventListeners=
function(){var u=this;this.own(r["default"](this.closeIcon,"click",function(){h["default"].close(u.dialog)}),r["default"](this.domNode,"click",function(v){v.stopPropagation()}),r["default"](document.body,"click",function(){u.close()}),r["default"](this.descToggle,"click",function(){return u.handleDescToggle()}))};w.prototype.handleDialogKeydown=function(u){var v=this;if(u.keyCode===a["default"].TAB)if(u.stopPropagation(),this.lastFocusItem!==u.target||u.shiftKey)u.shiftKey&&this.firstFocusItem===
u.target&&(u.preventDefault(),this.opener.focus(),this.close());else{u.preventDefault();var x=n["default"].getFocusableElements(document.body);x.forEach(function(y,C){y===v.opener&&x[C+1].focus()});this.close()}};w.prototype.handleDescToggle=function(){this.descContainer.classList.toggle("profile-popup__bio-container--expanded")};return w=q.__decorate([t["default"](d["default"],c["default"],b["default"])],w)}()})},"arcgisonline/pages/item/widgets/_sublayer":function(){define("require exports tslib ../../serviceUtil ../../pageUtil ../../dijit/ConfirmDlg ../../dijit/InlineEdit ../../dijit/MemberThumb ../../dijit/ToggleSwitch ../_Actions ../_export ../_servicesDirectoryViewModal ../../utils/alerts ../../utils/arrays ../../utils/dom ../../utils/formatters ../../utils/icons ../../utils/mapViewer ../../utils/metadata ../../utils/setItemUrls ../../utils/layer ../../../sharing/dijit/AppendData ../../../sharing/dijit/CopyToClipboard ../../../sharing/dijit/dialog/LayerTimeSettings ../../../tsutils/declareDecorator calcite-web/js/calcite-web dijit/_WidgetBase dijit/_TemplatedMixin dojo/Deferred dojo/topic dojo/on esri/lang esri/libs/sanitizer/Sanitizer dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/_sublayer.html dojo/text!./templates/sublayer/_disableAttachments.html".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D,K,G,I,R,A,B,H){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);x=q.__importDefault(x);C=q.__importDefault(C);z=q.__importDefault(z);F=q.__importDefault(F);O=q.__importDefault(O);V=q.__importDefault(V);N=q.__importDefault(N);
J=q.__importDefault(J);D=q.__importDefault(D);K=q.__importDefault(K);G=q.__importDefault(G);I=q.__importDefault(I);R=q.__importDefault(R);A=q.__importDefault(A);B=q.__importDefault(B);H=q.__importDefault(H);return function(){function T(M,L){this.icons=w["default"];this.i18n=A["default"];this.templateString=B["default"];this.completeDate=t["default"].completeDate;this.fullDate=t["default"].fullDate;this.sanitizer=new R["default"]}T.prototype.postMixInProperties=function(){var M;this.inherited(arguments);
var L=y.getLayerGeometryInfo(this.sublayer,this.item),X=L.geometryType;this.icon=L.geometryIcon;this.layerType=X;this.lastUpdate=(L=null===(M=this.sublayer.editingInfo)||void 0===M?void 0:M.lastEditDate)?this.page._formatDateTime(L):""};T.prototype.postCreate=function(){var M=this;this.inherited(arguments);this.item.isLoaded?(this.sublayer=this.findSublayer(this.item,this.sublayer),this.addMetadata().then(function(){return M.initUI()})):this.own(this.item.watch("isLoaded",function(){M.sublayer=M.findSublayer(M.item,
M.sublayer);M.addMetadata().then(function(){return M.initUI()})}))};T.prototype.findSublayer=function(M,L){var X;return 0<(null===(X=M.layers)||void 0===X?void 0:X.length)&&(X=n["default"].find(M.layers,function(ba){return ba.id===L.id}))?X:L};T.prototype.addMetadata=function(){var M=this,L=this.sublayer,X=new D["default"];L.hasMetadata?(L=this.metadataUrl(this.sublayer),v.retrieveArcGISXml(L.url,{token:L.token}).then(function(ba){M.parseMetadata(ba);X.resolve()},function(ba){X.resolve()})):(this.parseMetadata(),
X.resolve());return X};T.prototype.parseMetadata=function(M){var L=this.sublayer,X={};M?(this.originalXML=(new DOMParser).parseFromString(M,"text/xml"),X=v.parseEsriXML(this.originalXML)):this.originalXML=null;M=L.description&&v.decodeHTMLEntities(L.description);this.descriptionText=X["abstract"]||M||"";this.summaryText=X.summary||"";this.copyrightText=X.credits||L.copyrightText||""};T.prototype.userCanEditMetadata=function(M){var L=M.portal,X=M.canUpdate;M=M.isHostedService;var ba=this.originalXML&&
!v.isValidArcGISMetadata(this.originalXML);return M&&X&&L.metadataEditable&&!L.isPortal&&!ba};T.prototype.initUI=function(){var M,L=this.item,X=this.sublayer,ba=L.isLocationTrackingService,ma=L.canUpdate,ta=L.isHostedService,Ea=L.isAdmin,wa=L.isOwner;this.canEditMetadata=this.userCanEditMetadata(L);this.canEditInfo=!ba&&ma&&ta&&(Ea||wa);m["default"].addClasses(this.domNode.querySelector(".js-sublayer-content"),(this.sublayer.attributes||[]).filter(function(Q){return Q}));this.initEditors();this.setUrls();
new z["default"]({text:null===(M=X.url)||void 0===M?void 0:M.split("?")[0],tooltipModifier:"tooltip-left",id:"service-url"},this.domNode.querySelector(".js-sublayer-copy"));this.enableAttachments=new c["default"]({label:L.isDataView?A["default"].sublayer.showAttachments:A["default"].sublayer.enableAttachments,labelPosition:"left",isChecked:X.hasAttachments},this.domNode.querySelector(".js-toggle-attachments"));this.showSections();this.addEventListeners();V["default"].init();h.alignToSupportedExportFormats(this.item,
this.page.portal,this.domNode)};T.prototype.initEditors=function(){var M=this.descriptionText,L=this.copyrightText,X=this.canEditMetadata||this.canEditInfo;this.summaryEditor=new r["default"]({inputId:"sublayer-summary-edit",inputType:"textArea",inputLabel:this.i18n.itemProperties.editSummary,editButtonUpdatePermissionClasses:this.canEditMetadata?"":"hide",prop:"sublayerSummary",value:this.summaryText},document.querySelector(".js-sublayer-summary-section"));this.descriptionEditor=new r["default"]({inputId:"sublayer-description-edit",
inputType:"richText",inputLabel:this.i18n.itemProperties.editDescription,editButtonUpdatePermissionClasses:X?"":"hide",prop:"sublayerDescription",value:M},document.querySelector(".js-sublayer-description-section"));this.creditsEditor=new r["default"]({inputType:"textArea",rows:6,inputLabel:this.i18n.itemProperties.editCredits,prop:"sublayerCredits",value:L,editButtonUpdatePermissionClasses:X?"":"hide",pattern:"^[^\x3c\x3e]*$",invalidText:this.i18n.itemProperties.error.badCharacterCredits,formatter:this.page._linkify},
this.domNode.querySelector(".js-sublayer-credits"))};T.prototype.configureViewUI=function(){var M=this,L;this.viewLink&&(null===(L=this.viewLinkClickHandler)||void 0===L?void 0:L.remove(),this.viewLinkClickHandler=void 0,this.viewLink.dataset.url=this.viewLink.href,this.viewLink.href=""+x["default"].removeToken(this.viewLink.href),this.viewLinkClickHandler=G["default"](this.viewLink,"click",function(X){var ba=M.viewLink;f.shouldOpenViewModal(M.item,M.portalUser)&&(X.preventDefault(),X.stopPropagation(),
f.handleViewModalClick(M.item,M.portalUser,ba))}),this.own(this.viewLinkClickHandler))};T.prototype.setUrls=function(){var M,L=-1<(null===(M=this.item.typeKeywords)||void 0===M?void 0:M.indexOf("Service Proxy"))?(-1<this.item.url.indexOf("?")?"\x26":"?")+"f\x3dpjson":"";M=this.sublayer.mapViewerUrl.replace("useExisting\x3d1\x26","");this.viewLink.href=this.sublayer.url+L;this.portalUser&&this.portalUser.defaultMapViewer!==u.MapViewerType.Modern?(this.viewerLink.href=this.sublayer.mapViewerUrl,this.newViewerLink.href=
M,this.newViewerWithEditLink.href=M+"\x26isAdmin\x3dtrue",this.newMapViewerLink.href=this.sublayer.newMapViewerUrl,this.newViewerLink.dataset.href=M,this.newViewerWithEditLink.dataset.href=M+"\x26isAdmin\x3dtrue"):(this.viewerLink.textContent=A["default"].itemLinks.openMapViewerBeta,this.viewerLink.href=this.sublayer.newMapViewerUrl,this.viewerLink.dataset.href=this.sublayer.newMapViewerUrl,this.newMapViewerLink.textContent=A["default"].itemLinks.openMapViewer,this.newMapViewerLink.href=this.sublayer.mapViewerUrl,
this.newMapViewerLink.dataset.href=this.sublayer.mapViewerUrl,this.newViewerWithEditLink.href=M+"\x26isAdmin\x3dtrue",this.newViewerWithEditLink.textContent=A["default"].itemLinks.openMapViewerWithControl,this.newViewerWithEditLink.dataset.href=M+"\x26isAdmin\x3dtrue",m["default"].hideNode(this.newViewerLink));this.configureViewUI()};T.prototype.showSections=function(){this.showOwner();this.showLastUpdated();this.showSummary();this.showDescription();this.showCredits();this.showTimeSettings();this.showAttachments();
this.showAppend();this.showContent();this.showMetadata();this.showGeocodeReview();this.showSubtypes()};T.prototype.addEventListeners=function(){var M=this;this.own(K["default"].subscribe("inlineEdit/submit",function(L){I["default"].isDefined(L.sublayerDescription)&&M.updateDescription(L.sublayerDescription);I["default"].isDefined(L.sublayerCredits)&&M.updateCredits(L.sublayerCredits);I["default"].isDefined(L.sublayerSummary)&&M.updateSummary(L.sublayerSummary)}),K["default"].subscribe("metadata/layerEditor/updated",
this.metadataUpdated.bind(this)),this.enableAttachments.on("change",this.toggleAttachments.bind(this)));this.timeSettingsEdit.addEventListener("click",this.editTime.bind(this));this.append.addEventListener("click",this.appendData.bind(this));this["export"].addEventListener("click",this.exportData.bind(this));this.metadataEdit.addEventListener("click",this.editMetadata.bind(this));this.sublayerOwnerPopup.addEventListener("click",this.openOwnerPopup.bind(this));this.viewLayer.addEventListener("click",
this.publishViewLayer.bind(this));this.newViewerLink.addEventListener("click",this.openNewMap.bind(this));this.newViewerWithEditLink.addEventListener("click",this.openNewMap.bind(this))};T.prototype.showContent=function(){m["default"].hideNode(this.domNode.querySelector(".js-sublayer-loader"));m["default"].showNode(this.domNode.querySelector(".js-sublayer-content"));m["default"].showHide(this.domNode.querySelector(".js-kml-export"),!this.page.portal.isPortal)};T.prototype.showLastUpdated=function(){m["default"].showHide(this.lastUpdated,
!!this.lastUpdate)};T.prototype.showOwner=function(){new a["default"]({cssClasses:"margin-right-quarter inline-block flex-0 member-thumb--extra-small",member:this.item.itemOwner},this.domNode.querySelector(".js-sublayer-owner-thumb"))};T.prototype.showGeocodeReview=function(){var M=-1<this.item.typeKeywords.indexOf("Involved Lookup"),L=this.item.isAdmin;m["default"].addRemoveClass(this.geocodeReview,"hide",!M||!L);this.geocodeReview.href=this.item.mapViewerWithReviewUrl+"\x26layerId\x3d"+this.sublayer.id};
T.prototype.showSubtypes=function(){var M=y.isSubtypeGroupLayer(this.sublayer,this.item);m["default"].addRemoveClass(this.subtypes,"hide",!M);M&&(this.subtypesList.innerHTML=this.sublayer.subtypes.reduce(function(L,X){return L+' \x3cli class\x3d"padding-trailer-half"\x3e'+X.name+"\x3c/li\x3e"},""))};T.prototype.showSummary=function(){var M=this.summaryText;this.summary.innerHTML=this.sanitizer.sanitize(M);M=!!M;m["default"].addRemoveClass(this.summary,"hide",!M);m["default"].addRemoveClass(this.summaryAdd,
"hide",M||!this.canEditMetadata);m["default"].addRemoveClass(this.summaryUnavailable,"hide",M||this.canEditMetadata)};T.prototype.updateSummary=function(M){var L=this,X=this.domNode.querySelector(".js-sublayer-summary-loader");X.classList.add("is-active");this.updateXML("summary",M).then(function(){L.summaryText=M;X.classList.remove("is-active");K["default"].publish("inlineEdit/sublayerSummary/done");g["default"].showAlert("success",A["default"].sublayer.summaryUpdated);L.showSummary()},this.errorHandler)};
T.prototype.showDescription=function(){this.description.innerHTML=this.sanitizer.sanitize(this.descriptionText);var M=this.canEditInfo,L=!!this.descriptionText;m["default"].addRemoveClass(this.description,"hide",!L);m["default"].addRemoveClass(this.descriptionAdd,"hide",L||!M);m["default"].addRemoveClass(this.descriptionUnavailable,"hide",L||M)};T.prototype.updateDescription=function(M){var L=this,X=this.domNode.querySelector(".js-sublayer-description-loader");X.classList.add("is-active");this.updateService({description:v.encodeHTMLEntities(M)}).then(function(){return L.updateXML("abstract",
M)},this.errorHandler).then(function(){L.sublayer.description=M;L.descriptionText=M;K["default"].publish("inlineEdit/sublayerDescription/done");g["default"].showAlert("success",A["default"].sublayer.descriptionUpdated);L.showDescription();X.classList.remove("is-active")},this.errorHandler)};T.prototype.showCredits=function(){this.credits.innerHTML=this.sanitizer.sanitize(this.copyrightText);var M=this.canEditInfo,L=!!this.copyrightText;m["default"].addRemoveClass(this.credits,"hide",!L);m["default"].addRemoveClass(this.creditsAdd,
"hide",L||!M);m["default"].addRemoveClass(this.creditsUnavailable,"hide",L||M)};T.prototype.updateCredits=function(M){var L=this,X=this.domNode.querySelector(".js-sublayer-credits-loader");X.classList.add("is-active");this.updateService({copyrightText:M}).then(function(){return L.updateXML("credits",M)}).then(function(){X.classList.remove("is-active");L.copyrightText=M;L.sublayer.copyrightText=M;g["default"].showAlert("success",A["default"].sublayer.creditsUpdated);K["default"].publish("inlineEdit/sublayerCredits/done");
L.showCredits()},this.errorHandler)};T.prototype.showAppend=function(){m["default"].addRemoveClass(this.append,"hide",!this.item.canAppendData)};T.prototype.showAttachments=function(){var M=this,L,X=null===(L=this.item.typeKeywords)||void 0===L?void 0:L.includes("Spatiotemporal"),ba=l["default"].canEditViewAttachments(this.item)&&this.sublayer.viewSourceHasAttachments&&!X;l["default"].canEnableAttachments(this.item).then(function(ma){m["default"].addRemoveClass(M.attachments,"hide",!(ma||ba))})};
T.prototype.showTimeSettings=function(){var M,L=this.item,X=this.sublayer,ba=!(null===(M=X.timeInfo)||void 0===M||!M.startTimeField);M=(X.fields||[]).some(function(ma){return"esriFieldTypeDate"===ma.type});m["default"].addRemoveClass(this.timeSettings,"hide",!(L.canUpdate&&"Table"!==X.type&&M));m["default"].addRemoveClass(this.timeSettingsEnabled,"hide",!ba);m["default"].addRemoveClass(this.timeSettingsDisabled,"hide",ba)};T.prototype.showMetadata=function(){var M=this.sublayer.layerMetadataUrl;m["default"].forEachNode(this.domNode.querySelectorAll(".js-metadata-link"),
function(L){return L.href=M})};T.prototype.updateService=function(M){return b["default"].updateServiceDefinition({layerId:this.sublayer.id,item:this.item,definition:M}).then(function(){return!0},this.errorHandler.bind(this))};T.prototype.toggleAttachments=function(M){var L=this;this.item.isDataView||M?(this.enableAttachments.showLoader(),l["default"].enableAttachments(this.item,this.sublayer,M).then(function(){g["default"].showAlert("success",A["default"].sublayer[L.item.isDataView?"attachmentVisibilityUpdated":
"attachmentsEnabled"]);L.page.sublayer.hasAttachments=!0;L.enableAttachments.hideLoader()},function(X){L.errorHandler(X);L.enableAttachments.hideLoader()})):(new p["default"]({title:A["default"].sublayer.disableAttachments,template:H["default"],primaryButtonLabel:A["default"].common.yes,secondaryButtonLabel:A["default"].common.no})).open().then(function(X){X?(L.enableAttachments.showLoader(),l["default"].enableAttachments(L.item,L.sublayer,!1).then(function(){g["default"].showAlert("success",A["default"].sublayer.attachmentsDisabled);
L.page.sublayer.hasAttachments=!1;L.enableAttachments.hideLoader()},function(ba){L.errorHandler(ba);L.enableAttachments.hideLoader()})):(M=!0,L.enableAttachments.setChecked(M,!0))})};T.prototype.editTime=function(){var M=this;(new F["default"]({item:this.item,layer:this.sublayer,user:this.portalUser})).showModal().then(function(L){null!==L&&void 0!==L&&L.id||(M.sublayer.timeInfo=L.timeInfo,g["default"].showAlert("success",A["default"].sublayer.timeSettingsUpdated),M.showTimeSettings())})};T.prototype.appendData=
function(){(new C["default"]({item:this.item,layer:this.sublayer,layers:[this.sublayer]})).show()};T.prototype.exportData=function(M){d["default"].exportData({layer:this.sublayer,item:this.item,layerId:this.sublayer.id,evt:M})};T.prototype.editMetadata=function(M){d["default"].openLayerMetadata({layer:this.sublayer,layerId:""+this.sublayer.id,item:this.item,evt:M})};T.prototype.openNewMap=function(M){M.preventDefault();M.stopPropagation();d["default"].newMapViewer({item:this.item,evt:M})};T.prototype.openOwnerPopup=
function(M){d["default"].profilePopup({item:this.item,page:this.page,evt:M})};T.prototype.publishViewLayer=function(M){d["default"].publishTiles({layer:this.sublayer,item:this.item,page:this.page,evt:M})};T.prototype.metadataUpdated=function(M){var L=this;this.sublayer.hasMetadata=!M.deleted;this.addMetadata().then(function(){var X=L.sublayer;L.canEditMetadata=L.userCanEditMetadata(L.item);L.descriptionEditor.updateValue(X.description);L.summaryEditor.updateValue(X.summary);L.creditsEditor.updateValue(X.copyrightText);
L.showSections()})};T.prototype.metadataUrl=function(M){M=M.url.split("?token\x3d");return{url:M[0]+"/metadata",token:M[1]}};T.prototype.updateXML=function(M,L){var X=this,ba=new D["default"];if(!this.canEditMetadata)return ba.resolve(L),ba;var ma=this.metadataUrl(this.sublayer),ta=ma.url;ma=ma.token;this.originalXML?v.updateLayerXMLProperty({url:ta+"/update/",token:ma,prop:M,value:L,xml:this.originalXML}).then(function(Ea){Ea&&(X.originalXML=Ea);ba.resolve(L)},function(Ea){X.errorHandler(Ea);ba.resolve(L)}):
v.createLayerXML({url:ta+"/update/",layer:this.sublayer,portal:this.item.portal,token:ma,prop:M,value:L}).then(function(Ea){Ea&&(X.originalXML=Ea,X.sublayer.hasMetadata=!0);ba.resolve(L)},function(Ea){X.errorHandler(Ea);ba.resolve(L)});return ba};T.prototype.errorHandler=function(M){g["default"].showAlert("error",M.message||A["default"].sublayer.errorUpdatingLayer)};return T=q.__decorate([O["default"](N["default"],J["default"])],T)}()})},"arcgisonline/pages/dijit/ConfirmDlg":function(){define("require exports tslib dojo/string dojo/Deferred ./Overlay dojo/i18n!../../nls/arcgisonline ../utils/icons ../../tsutils/declareDecorator".split(" "),
function(e,U,q,b,l,p,r,a,c){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);return function(){function d(h,f){this.title="";this.i18n=r["default"];this.icons=a["default"];this.constrain=!0;this.overlayContents="";this.maxWidth=600;this.secondaryBtnText=this.primaryBtnText="";this.closeOnScrimClick=!1;this.secondaryButtonLabel=this.primaryButtonLabel=this.template=""}d.prototype.postMixInProperties=function(){this.inherited(arguments);
this.primaryBtnText=this.primaryButtonLabel||r["default"].common.ok;this.secondaryBtnText=this.secondaryButtonLabel||r["default"].common.cancel;this.overlayContents=b["default"].substitute(this.template,{i18n:r["default"],icons:a["default"]})};d.prototype.open=function(){this.inherited(arguments);return this.dfd=new l["default"]};d.prototype.close=function(h){this.inherited(arguments);this.dfd.resolve(h)};d.prototype.handleCancel=function(){this.close(!1)};d.prototype.handlePrimary=function(){this.close(!0)};
return d=q.__decorate([c["default"](p["default"])],d)}()})},"arcgisonline/pages/dijit/ToggleSwitch":function(){define("require exports tslib dojo/text!./ToggleSwitch/templates/ToggleSwitch.html dojo/i18n!../../nls/arcgisonline dojo/Evented dijit/_TemplatedMixin dijit/_WidgetBase dojox/uuid/generateRandomUuid ../utils/dom ../../tsutils/declareDecorator".split(" "),function(e,U,q,b,l,p,r,a,c,d,h){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);
c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);return function(){function f(g,n){this.templateString=b["default"];this.i18n=l["default"];this.label="";this.labelPosition="right";this.labelClasses="";this.direction="left";this.isChecked=!1;this.tooltipLabel=this.tooltipClass="";this.disabled=!1;this.hasTooltip=""}f.prototype.postMixInProperties=function(){this.inherited(arguments);"left"===this.labelPosition&&(this.direction="right");this.uid=c["default"]();this.tooltip&&(this.hasTooltip=
"toggle-switch--tooltip",this.tooltipClass=this.tooltipClass||"tooltip tooltip-multiline")};f.prototype.postCreate=function(){var g=this;this.inherited(arguments);this.isChecked&&(this._checkbox.checked=this.isChecked);this.disabled&&this.disable();this.label||d["default"].hideNode(this._label);this.tooltip&&this._label.setAttribute("aria-label",this.tooltip);this._checkbox.addEventListener("change",function(n){g.emit("change",g._checkbox.checked)});this._checkbox.addEventListener("keyup",function(n){13===
n.keyCode&&(n.stopPropagation(),g._checkbox.checked=!g._checkbox.checked,g.emit("change",g._checkbox.checked))});this.trackId&&(this.toggleTrack.id=this.trackId)};f.prototype.hide=function(){d["default"].hideNode(this.domNode)};f.prototype.show=function(){d["default"].showNode(this.domNode)};f.prototype.checked=function(){return this._checkbox.checked};f.prototype.setChecked=function(g,n){this._checkbox.checked=g;n||this.emit("change",this._checkbox.checked)};f.prototype.enable=function(){this._checkbox.removeAttribute("disabled");
this.domNode.classList.remove("toggle-switch--disabled");this.disabled=!1};f.prototype.disable=function(){this._checkbox.setAttribute("disabled","true");this.domNode.classList.add("toggle-switch--disabled");this.disabled=!0};f.prototype.focus=function(){this._checkbox.focus()};f.prototype.check=function(){this.setChecked(!0,!0)};f.prototype.uncheck=function(){this.setChecked(!1,!0)};f.prototype.showSwitch=function(){d["default"].showNode(this.toggleTrack);d["default"].showNode(this._checkbox)};f.prototype.hideSwitch=
function(){d["default"].hideNode(this.toggleTrack);d["default"].hideNode(this._checkbox)};f.prototype.showLoader=function(){this.loader.active=!0;d["default"].showNode(this.loaderContainer);this.hideSwitch()};f.prototype.hideLoader=function(){this.loader.active=!1;d["default"].hideNode(this.loaderContainer);this.showSwitch()};return f=q.__decorate([h["default"](a["default"],r["default"],p["default"])],f)}()})},"arcgisonline/pages/item/_export":function(){define(["require","exports","tslib","../utils/dom"],
function(e,U,q,b){function l(r){b["default"].forEachNode(r.querySelectorAll("nav.js-action-exportData \x3e button.dropdown-link"),function(a){a.classList.remove("if-no-multipatch");a.classList.remove("if-no-location-tracking");a.classList.add("hide")})}function p(r,a){var c;null===(c=a.querySelector('button.dropdown-link[data-type\x3d"'+r+'"]'))||void 0===c?void 0:c.classList.remove("hide")}Object.defineProperty(U,"__esModule",{value:!0});U.alignToSupportedExportFormats=void 0;b=q.__importDefault(b);
U.alignToSupportedExportFormats=function(r,a,c){var d,h;!a.isPortal&&(null===(h=null===(d=r.serviceInfo)||void 0===d?void 0:d.supportedExportFormats)||void 0===h?0:h.length)&&(l(c),a=r.serviceInfo.supportedExportFormats.split(","),r.isLocationTrackingService||r.isLocationTrackingView||a.push("kml"),a.forEach(function(f){switch(f){case "csv":p("CSV",c);break;case "shapefile":p("Shapefile",c);break;case "kml":p("KML",c);break;case "filegdb":p("File Geodatabase",c);break;case "featureCollection":p("Feature Collection",
c);break;case "geojson":p("GeoJson",c);break;case "excel":p("Excel",c);break;case "geoPackage":p("GeoPackage",c)}}))}})},"arcgisonline/pages/item/_servicesDirectoryViewModal":function(){define("require exports tslib ../pageUtil ../utils/queryHandler ../utils/setItemUrls ./components/ServicesDirectoryModal preact dojo/i18n!../../nls/arcgisonline".split(" "),function(e,U,q,b,l,p,r,a,c){Object.defineProperty(U,"__esModule",{value:!0});U.handleViewModalClick=U.shouldOpenViewModal=void 0;b=q.__importDefault(b);
l=q.__importStar(l);p=q.__importDefault(p);r=q.__importDefault(r);c=q.__importDefault(c);U.shouldOpenViewModal=function(d,h){var f="WFS"===d.type;f=!f||"public"!==d.sharing.access&&f;var g=!h&&"public"===d.sharing.access;return d.isHostedService&&f&&!g&&!d.portal.isPortal};U.handleViewModalClick=function(d,h,f,g){void 0===g&&(g=!1);var n=document.body.querySelector("#services-directory-container");n||(n=document.createElement("div"),n.id="services-directory-container",document.body.appendChild(n));
var m={title:"ArcGIS REST Services Directory",close:c["default"].common.close},t=f.dataset.url.split("?"),w=1<t.length?l.queryToObject(f.dataset.url.split("?")[1]):{},u=1<t.length?w.token||"":"";!u&&d.canUpdate?(w.token=(null===h||void 0===h?void 0:h.credential.token)||"",h=t[0]+"?"+l.objectToQuery(w)):h=p["default"].swivelToken(f.dataset.url,u,(null===h||void 0===h?void 0:h.credential.token)||"");b["default"].updateQueryParams({view:"service"});a.render(a.h(r["default"],{item:d,itemUrl:h,strings:m,
onClose:function(){b["default"].removeQueryParams(["view"]);a.render(null,n);g||f.focus()}}),n)};U["default"]={shouldOpenViewModal:U.shouldOpenViewModal,handleViewModalClick:U.handleViewModalClick}})},"arcgisonline/pages/item/components/ServicesDirectoryModal":function(){define("require exports tslib ../../utils/queryHandler preact preact/hooks".split(" "),function(e,U,q,b,l,p){Object.defineProperty(U,"__esModule",{value:!0});b=q.__importStar(b);var r=function(a,c){var d=-1<["Map Service","Image Service"].indexOf(a.type),
h=a.sourceData&&-1<["Service Definition","Tile Package"].indexOf(a.sourceData.type),f=!a.portal.isPortal&&0===c.indexOf("https://tiles")&&-1<c.indexOf(".arcgis.com");return d&&(h||f)?(d=c.split("?"),h=1<d.length?b.queryToObject(d[1]):{},h.f="pjson",d[0]+"?"+b.objectToQuery(h)):c};U["default"]=function(a){var c=a.item,d=a.itemUrl,h=void 0===d?c.viewUrl:d;d=a.strings;var f=a.onClose,g=p.useState(!0);a=g[0];var n=g[1],m=p.useState(!0);g=m[0];var t=m[1];c=p.useState(r(c,h))[0];var w=p.useRef(null);h=
p.useRef(null);m=p.useRef(null);p.useEffect(function(){w.current&&w.current.setFocus("close-button")},[w.current]);var u=function(){n(!1);f()};return l.h("calcite-modal",{ref:w,active:a,backgroundColor:"white",role:"dialog","aria-label":d.title,"aria-modal":"true",fullscreen:!0,disableEscape:!0,"disable-outside-close":!0,intlClose:d.close,oncalciteModalClose:u,"data-test":"modal"},l.h("h3",{slot:"header","class":"font-size-2 trailer-0","data-test":"title"},d.title),l.h("div",{slot:"content",ref:h,
"class":"full-height flex-column"},l.h("div",{"class":"flex-column services-directory-modal__content flex-1"},l.h("calcite-loader",{active:g,scale:"l",type:"indeterminate",label:"",text:"","data-test":"loader"}),l.h("iframe",{ref:m,"class":"flex-1 services-directory-modal__iframe",src:c,onLoad:function(){t(!1)},"data-test":"iframe",style:g?"visibility: hidden;":"visibility: visible;"}))),l.h("calcite-button",{slot:"primary",width:"full",color:"blue",appearance:"solid",onClick:u,"data-test":"close"},
d.close))}})},"arcgisonline/pages/utils/layer":function(){define(["require","exports","tslib","./icons","dojo/i18n!../../nls/arcgisonline"],function(e,U,q,b,l){function p(a,c){var d,h,f;if(!a)return!1;var g=null===(d=a.subtypes)||void 0===d?void 0:d.length;d=null===(f=null===(h=null===c||void 0===c?void 0:c.itemData)||void 0===h?void 0:h.layers)||void 0===f?void 0:f.find(function(n){return n.id===a.id});return g&&"SubtypeGroupLayer"===(null===d||void 0===d?void 0:d.layerType)}Object.defineProperty(U,
"__esModule",{value:!0});U.getLayerGeometryInfo=U.isSubtypeGroupLayer=void 0;b=q.__importDefault(b);l=q.__importDefault(l);var r={esriGeometryPoint:b["default"].inline.point["16"],esriGeometryPolygon:b["default"].inline.polygon["16"],esriGeometryPolyline:b["default"].inline.line["16"],esriGeometryMultipoint:b["default"].inline["layer-points"]["16"],esriGeometryMultiPatch:b["default"].inline.cube["16"]};U.isSubtypeGroupLayer=p;U.getLayerGeometryInfo=function(a,c){var d=a.geometryType,h=d&&l["default"].sublayer.geometryTypes[d]||
l["default"].sublayer.layer;return"Table"===a.type?{geometryType:l["default"].sublayer.table,geometryIcon:b["default"].inline.table["16"]}:p(a,c)?{geometryType:h,geometryIcon:b["default"].inline.layers["16"]}:{geometryIcon:d&&r[d]||b["default"].inline.layer["16"],geometryType:h}}})},"arcgisonline/sharing/dijit/CopyToClipboard":function(){define("require exports tslib ../../pages/utils/icons ../../tsutils/declareDecorator dijit/_TemplatedMixin dijit/_WidgetBase dojo/text!./templates/CopyToClipboard.html dojo/i18n!../../nls/arcgisonline".split(" "),
function(e,U,q,b,l,p,r,a,c){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);return function(){function d(h,f){this.templateString=a["default"];this.icons=b["default"];this.i18n=c["default"];this.tooltipModifier="";this.icon="copy-to-clipboard"}d.prototype.postMixInProperties=function(){this.inherited(arguments);this.copySupported=document.queryCommandSupported("copy")};d.prototype.postCreate=function(){this.copySupported||
(this.domNode.querySelector(".js-copy-group").classList.remove("input-group"),this.domNode.querySelector(".js-copy-tooltip").classList.add("hide"))};d.prototype.copy=function(h){h=this.domNode.querySelector("#copy-to-clipboard-"+this.id);var f=this.domNode.querySelector(".js-copy-tooltip"),g=this.domNode.querySelector(".js-copy-alert");try{h.select(),document.execCommand("copy"),h.blur(),f.setAttribute("aria-label",c["default"].common.copiedLbl),g.innerHTML=c["default"].common.copiedLbl}catch(n){}};
d.prototype.reset=function(){this.domNode.querySelector(".js-copy-tooltip").setAttribute("aria-label",c["default"].tocPanel.copy);this.domNode.querySelector(".js-copy-alert").innerHTML=""};d.prototype.updateText=function(h){this.copyInput.value=h};return d=q.__decorate([l["default"](r["default"],p["default"])],d)}()})},"arcgisonline/pages/utils/productGlyphs":function(){define(["require","exports"],function(e,U){var q={dashboard:{path:"M25.819 28H23.18a.181.181 0 0 1-.181-.181V13.18a.181.181 0 0 1 .181-.181h2.638a.181.181 0 0 1 .181.181V27.82a.181.181 0 0 1-.181.181zM21 27.816v-9.631a.184.184 0 0 0-.184-.185h-2.631a.184.184 0 0 0-.185.184v9.631a.184.184 0 0 0 .184.185h2.631a.184.184 0 0 0 .185-.184zm9.82.184a.18.18 0 0 0 .18-.18v-7.64a.18.18 0 0 0-.18-.18h-2.64a.18.18 0 0 0-.18.18v7.64a.18.18 0 0 0 .18.18zM7 9.267v10.475c.706.033 3.538-1.718 4.274-4.7.679-2.751 3.485-2.864 4.443-2.94 1.766-.14 3.588-.607 4.566-2.798A.216.216 0 0 0 20.085 9H7.267A.267.267 0 0 0 7 9.267zm18.997-1.053A4.411 4.411 0 0 0 21.63 4H2.684A.684.684 0 0 0 2 4.684V21.81A3.19 3.19 0 0 0 5.19 25h9.565a.245.245 0 0 0 .245-.245v-2.362a.393.393 0 0 0-.393-.393H6.38A1.385 1.385 0 0 1 5 20.619V7.349A.348.348 0 0 1 5.348 7h16.324A1.346 1.346 0 0 1 23 8.363v1.28a.357.357 0 0 0 .357.357h2.599a.046.046 0 0 0 .046-.046z",
fill:"#ee9e01"},experienceBuilder:{path:"M30.85 12.82l-2.85 5v7.44A1.78 1.78 0 0 1 26.22 27H25V7.75a.76.76 0 0 0-.75-.75H12V1.31a.28.28 0 0 1 .42-.25L17.51 4h8.71A1.78 1.78 0 0 1 28 5.78v4.42l2.54 1.47a.83.83 0 0 1 .31 1.15zM12 18h8v-6h-8zm7.62 5H7.75a.76.76 0 0 1-.75-.75V4H5.78A1.78 1.78 0 0 0 4 5.78V13l-2.89 5a.85.85 0 0 0 .31 1.15L4 20.59v4.61A1.78 1.78 0 0 0 5.78 27h8.62l5.18 3a.28.28 0 0 0 .42-.24v-6.39a.38.38 0 0 0-.38-.37z",fill:"#09b8ca"},geoBIM:{path:"M17.802 21.398l6.2 2.557-5.14 2.133a.772.772 0 0 1-1.06-.717zM9.311 7.868a.604.604 0 0 1-.003-1.122L16 4.169l8.12 3.148-8.119 3.184zm-3.5 1.541l8.387 3.413v12.554a.772.772 0 0 1-1.06.717l-6.297-2.736a1.639 1.639 0 0 1-1.03-1.521zM3.844 6.03a1.316 1.316 0 0 0-.827 1.22v17.395a1.316 1.316 0 0 0 .827 1.221L16 30.888l12.983-5.317v-2.423l-7.156-3.023 7.156-2.963v-1.95l-5.101-2.2-3.867 1.516L24 16.123l-6.199 2.505v-5.711l.073-.122 11.108-4.487v-1.95l-12.47-5.047a1.384 1.384 0 0 0-1.027 0z",
fill:"#11ad1d"},notebooks:{path:"M2.941 25A.906.906 0 0 1 2 24.135v-.271A.906.906 0 0 1 2.941 23h3.118a.906.906 0 0 1 .941.864v.271a.906.906 0 0 1-.941.865zm3.118-8A.906.906 0 0 0 7 16.135v-.271A.906.906 0 0 0 6.059 15H2.941a.906.906 0 0 0-.941.864v.271a.906.906 0 0 0 .941.865zm0-8A.906.906 0 0 0 7 8.135v-.271A.906.906 0 0 0 6.059 7H2.941A.906.906 0 0 0 2 7.864v.271A.906.906 0 0 0 2.941 9zm9.44 16h-3.726a.773.773 0 0 1-.773-.774V6.171A.172.172 0 0 1 11.172 6H15.5a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 0-.5-.5H5.342A1.345 1.345 0 0 0 4 4.343V5h2.059A2.904 2.904 0 0 1 9 7.858v.277A2.907 2.907 0 0 1 6.059 11H4v2h2.059A2.907 2.907 0 0 1 9 15.864v.271A2.907 2.907 0 0 1 6.059 19H4v2h2.059A2.907 2.907 0 0 1 9 23.864v.271A2.907 2.907 0 0 1 6.059 27H4v1.405a.595.595 0 0 0 .595.595H15.5a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5zM20 3.5v2a.5.5 0 0 0 .5.5h4a.5.5 0 0 1 .5.5v18a.5.5 0 0 1-.5.5h-4a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-25a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.499.5z",
fill:"#6e6e6e"},online:{path:"M25.479 23.504a.231.231 0 0 1 .204 0l3.933 1.939a.12.12 0 0 1 0 .216l-8.273 4.078a.822.822 0 0 1-.727 0l-8.274-4.078a.12.12 0 0 1 0-.216l3.933-1.94a.231.231 0 0 1 .205 0l4.206 2.075a.663.663 0 0 0 .587 0zM12.342 18.6a.12.12 0 0 0 0 .215l8.344 4.112a.663.663 0 0 0 .586 0l8.344-4.112a.12.12 0 0 0 0-.215l-8.534-4.208a.231.231 0 0 0-.205 0zm-2.438-6.434C7.397 6.051 15.42 2.655 18.687 7.96a.185.185 0 0 0 .236.07c3.545-1.654 6.604.885 5.75 4.528a.278.278 0 0 0 .146.312l6.048 2.982a.093.093 0 0 0 .132-.1 7.18 7.18 0 0 0-2.683-4.454.185.185 0 0 1-.068-.13A7.287 7.287 0 0 0 20.1 4.43a.185.185 0 0 1-.143-.047C14.775-.32 6.919 2.959 6.302 10.003a.185.185 0 0 1-.102.15c-9.865 4.91-4.46 18.472 5.924 12.182-9.26 1.228-8.848-9.392-2.22-10.169z",
fill:"#5763f8"},sites:{path:"M2.656 29A.656.656 0 0 1 2 28.344V6.185A3.189 3.189 0 0 1 5.185 3H29.72a.281.281 0 0 1 .281.281v22.53A3.194 3.194 0 0 1 26.81 29zm2.838-3h21.211a.295.295 0 0 0 .296-.295V13.494a.493.493 0 0 0-.493-.494H5v12.506a.494.494 0 0 0 .494.494zM23 9.91a.09.09 0 0 0 .09.09h3.82a.09.09 0 0 0 .09-.09V6.026A.026.026 0 0 0 26.974 6h-3.948a.026.026 0 0 0-.026.026zM6.633 6A1.597 1.597 0 0 0 5 7.595V10h14.523A.477.477 0 0 0 20 9.523V6.477A.477.477 0 0 0 19.523 6zM16 22v-5h7v5zm-7-2v-3h3v3z",
fill:"#7842ed"},storyMaps:{path:"M25.5 0C23.015 0 21 .953 21 3.433v8.517a1.467 1.467 0 0 0 .43 1.038l3.837 3.827a.33.33 0 0 0 .466 0l3.836-3.827A1.467 1.467 0 0 0 30 11.95V3.433C30 .953 27.985 0 25.5 0zm0 8.1a2.6 2.6 0 1 1 2.6-2.599A2.599 2.599 0 0 1 25.5 8.1zm-7.856.453c.294-.153.312-.457.312-.788v-2.31a.104.104 0 0 0-.129-.1 6.128 6.128 0 0 0-2.248 1.19.14.14 0 0 1-.167.008c-3.437-2.283-8.543-1.52-12.131-.988-.432.064-1.762.34-2.164.424A.146.146 0 0 0 1 6.133V26.69a.147.147 0 0 0 .05.11.134.134 0 0 0 .116.035A36.394 36.394 0 0 1 9.5 25.781c3.283.054 4.403.96 4.967 1.513l.915.897a.164.164 0 0 0 .23 0l.916-.897a5.98 5.98 0 0 1 3.972-1.47 25.341 25.341 0 0 1 5.715.516c.718.109 1.46.22 2.186.312l1.251.16a.308.308 0 0 0 .348-.305v-7.375a.161.161 0 0 0-.303-.077l-.107.2a7.218 7.218 0 0 1-6.902 3.766 10.455 10.455 0 0 0-5.688.796V9.454a.89.89 0 0 1 .332-.693 2.058 2.058 0 0 1 .312-.208zM14 23.817c-3.071-1.38-5.998-.808-9.447-.293l-.253.036a.263.263 0 0 1-.3-.259V8.525a.098.098 0 0 1 .084-.097l.804-.115c2.518-.372 6.303-1.048 8.708.515a.89.89 0 0 1 .404.746z",
fill:"#4fbaa9"},webAppBuilder:{path:"M15.044 19.974a.188.188 0 0 1-.192-.001l-3.762-2.35a.188.188 0 0 1-.09-.16v-4.098a.188.188 0 0 1 .096-.163l3.761-2.178a.188.188 0 0 1 .182-.001l3.863 2.179a.188.188 0 0 1 .098.165v4.095a.187.187 0 0 1-.092.161zm15.13-1.04a.052.052 0 0 0 .099.022 8.048 8.048 0 0 0 .67-3.147 7.155 7.155 0 0 0-3.507-6.213L17.59 3.768a4.054 4.054 0 0 0-1.968-.627 3.95 3.95 0 0 0-1.894.485c-.607.334-1.132.67-1.278.754a2.951 2.951 0 0 0-1.39 2.506v1.078a.2.2 0 0 0 .307.167l1.365-.87a4.988 4.988 0 0 1 2.319-.792 4.62 4.62 0 0 1 2.219.792s8.442 5.017 9.392 5.576a7.045 7.045 0 0 1 3.513 6.084zM9.546 23.55l.947-.547a.2.2 0 0 0 0-.345l-1.369-.79a4.326 4.326 0 0 1-2.13-3.842V7.286a7.16 7.16 0 0 1 3.63-6.083l.081-.05a.025.025 0 0 0-.012-.045l-.25-.005a8.333 8.333 0 0 0-3.887.994A7.102 7.102 0 0 0 3.069 8.31v10.786a3.96 3.96 0 0 0 1.89 3.362c.894.545 1.605.974 1.81 1.092a2.787 2.787 0 0 0 2.777 0zm4.383 6.37l9.997-5.773a3.959 3.959 0 0 0 1.967-3.32c.021-.929.034-1.604.034-1.806a2.786 2.786 0 0 0-1.39-2.406l-1.123-.57a.2.2 0 0 0-.289.177v1.604a4.45 4.45 0 0 1-2.218 3.842l-3.708 2.14a3.366 3.366 0 0 1-.256.135L11.6 27.128a6.427 6.427 0 0 1-3.343.938 7.137 7.137 0 0 1-3.513-1.038c-.09-.052-.38-.226-.797-.479a.094.094 0 0 0-.134.12 7.182 7.182 0 0 0 2.942 3.25 7.241 7.241 0 0 0 3.587 1.028 7.243 7.243 0 0 0 3.587-1.028z",
fill:"#09b8ca"},urban:{path:"M32 14l-4 .003a1 1 0 0 0-1 1V21a1 1 0 0 1-1 1h-2V5.451l-7.598-3.335A1 1 0 0 0 15 3.03V25a1 1 0 0 1-1 1h-2V11.24h-.02L7.5 9l-4.48 2.24H3V20H0v4h5a1 1 0 0 0 1-1V12.717L7.5 12l1.5.717V28a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2V6.094l3 1.317V24a2 2 0 0 0 2 2h5.02A1.977 1.977 0 0 0 30 24.024V17h2z",fill:"#3DB8FF"},instant:{path:"M11.206 4.805v-1.38a2.231 2.231 0 0 1 2.23-2.231h13.168a2.231 2.231 0 0 1 2.231 2.23v11.15a2.231 2.231 0 0 1-2.23 2.231h-1.398V5.555a.75.75 0 0 0-.75-.75zM30.94 27.204l-5.447-4.41a.211.211 0 0 0-.344.164v2.225H8.197a1.344 1.344 0 0 1-1.344-1.344V11.665a.75.75 0 0 1 .75-.75h9.872a.75.75 0 0 1 .75.75l-.003 7.534a2.422 2.422 0 0 1-.798 1.796l-.945.855h4.3a1.075 1.075 0 0 0 1.074-1.075v-10.54a2.231 2.231 0 0 0-2.23-2.23H5.354a2.148 2.148 0 0 0-2.13 2.23v16.507a2.231 2.231 0 0 0 2.23 2.231l19.695-.003v2.725a.211.211 0 0 0 .344.164l5.447-4.41a.158.158 0 0 0 0-.245z",
fill:"#83a238"}},b=[];Object.keys(q).forEach(function(l){b[l]='\x3csvg viewBox\x3d"0 0 32 32" width\x3d"32" height\x3d"32" fill\x3d"'+q[l].fill+'"\x3e\x3cpath d\x3d"'+q[l].path+'"/\x3e\x3c/svg\x3e'});return b})},"arcgisonline/pages/components/Ratings":function(){define("require exports tslib preact dojo/i18n!../../nls/arcgisonline preact/hooks ../../sharing/util".split(" "),function(e,U,q,b,l,p,r){Object.defineProperty(U,"__esModule",{value:!0});U.Ratings=void 0;l=q.__importDefault(l);r=q.__importDefault(r);
U.Ratings=function(a){var c=a.user,d=a.item,h=p.useState(d.avgRating);a=h[0];var f=h[1],g=p.useState(d.numRatings);h=g[0];var n=g[1],m=p.useState(0);g=m[0];var t=m[1];m=d.isOwner?"tooltip":"";var w=l["default"].common.ratingMsg.replace("${value}","${num}");return b.h("div",{"class":"inline-block padding-trailer-quarter "+m,"aria-label":d.isOwner?l["default"].ratings.cantRate:!1},b.h("calcite-rating",{scale:"s","intl-ratings":l["default"].GroupWidget.sortFields.avgRating,"intl-stars":w,value:g,average:a,
count:h,readOnly:!c||d.isOwner,oncalciteRatingChange:function(u){u=u.detail;t(u.value);d.addRating(u.value).then(function(){r["default"].request({url:d.itemUrl}).then(function(v){f(v.avgRating);n(v.numRatings)})})}}))}})},"arcgisonline/sharing/dijit/RasterFunctionEditor":function(){define("dojo/dom-class dojo/string dojo/on dojo/topic dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/_WidgetBase dijit/_WidgetsInTemplateMixin dijit/_TemplatedMixin dijit/Dialog esri/domUtils ../../pages/dijit/Overlay dojo/text!./templates/RasterFunctionEditor.html dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m){return l("arcgisonline.sharing.dijit.RasterFunctionEditor",[a,d,g],{baseClass:"esriRFxEditorContainer",user:null,constructor:function(t,w){this.user=t&&t.user;this.parent=t&&t.parent;this.item=t&&t.item;this.entryPoint=t&&t.entryPoint;this.domNode=w;this.overlayContents=U.substitute(n,{i18n:m});this.destroyOnClose=this.showActionBar=!1},postCreate:function(){this.inherited(arguments);this._iframe=this.domNode.querySelector("iframe");this._passiveOverlay=this.domNode.querySelector(".passive-overlay");
this._closeBtn=this.domNode.querySelector(".close-btn");e.add(this.domNode,"overlay--top")},startup:function(){this.inherited(arguments);var t=this.user,w=this.item?this.item.id:null,u=esriGeowConfig.rasterFunctionEditor+"?locale\x3d"+dojo.locale+"\x26entryPoint\x3d"+this.entryPoint+"\x26isViewerMode\x3d"+(t?!t.canCreateItems:!0)+"\x26portalUrl\x3d"+esriGeowConfig.restBaseUrl;t&&(u=u+"\x26username\x3d"+t.username+"\x26userId\x3d"+t.accountId+"\x26token\x3d"+t.token);w&&(u=u+"\x26itemId\x3d"+w);this._iframe.src=
u;this._showLoadingDialog();this._attachListeners()},destroy:function(){this._detachAnalysisToolListeners()},activate:function(){e.remove(this.domNode,"passive");this._iframe.contentWindow.postMessage(JSON.stringify({action:"activate"}),"*")},deactivate:function(){e.add(this.domNode,"passive");this._iframe.contentWindow.postMessage(JSON.stringify({action:"deactivate"}),"*")},onLoad:function(){this._closeLoadingDialog();this.showOnStart&&this.open()},run:function(t){"analysisStack"!==arcgisonline.map.leftPanel.getLeftContentPanelStack()&&
(arcgisonline.map.dijit.toc.analysis.configureAnalysis(),b.publish("Analysis/ShowAnalysis"));this.applyRFxTool?this.applyRFxTool.set("rasterFunction",t):t&&this.parent&&(this.parent.analysisTool.openApplyRFxTool(t,!0),this.applyRFxTool=leftPanel.toolPanel.get("currentTool"),this._detachAnalysisToolListeners(),this._attachAnalysisToolListeners());this.deactivate()},open:function(){this._iframe.contentWindow.postMessage(JSON.stringify({action:"reset",itemId:this.item?this.item.id:null}),"*");this.inherited(arguments);
this._sendMapInfo();this.activate()},close:function(t){this.inherited(arguments);this.item=void 0;this._iframe.contentWindow.postMessage(JSON.stringify({action:"close"}),"*");this._detachAnalysisToolListeners();t&&this.applyRFxTool&&this.applyRFxTool._onClose(!0);setTimeout(p.hitch(this,this._attachAnalysisToolListeners),0)},_sendMapInfo:function(){var t=[],w=[];r.forEach(arcgisonline.map.main.mapLayers,function(v){var x=v.layer,y=x&&x.url;x&&(y&&-1<y.toLowerCase().indexOf("/imageserver")?t.push({id:x.id,
name:x.name||v.title,url:y,renderingRule:x.renderingRule&&x.renderingRule.toJson(),mosaicRule:x.mosaicRule&&x.mosaicRule.toJson()}):"esri.layers.FeatureLayer"===x.declaredClass&&w.push({id:x.id,name:x.name,url:y}))});var u=arcgisonline.map.main.map&&arcgisonline.map.main.map.extent;this._iframe.contentWindow.postMessage(JSON.stringify({action:"info",layers:{imageService:t,feature:w},extent:u&&u.toJson()}),"*")},_closeLoadingDialog:function(){this._loadingDialog&&this._loadingDialog.hide()},_showLoadingDialog:function(){this._loadingDialog||
(this._loadingDialog=new h({title:m.common.loading,content:"\x3cdiv\x3e\x3cdiv\x3e"+m.common.loadingRFxEditor+"\x3c/div\x3e\x3cdiv class\x3d'throb-loading'\x3e\x3c/div\x3e\x3c/div\x3e"}));this._loadingDialog.show()},_detachAnalysisToolListeners:function(){this.applyRFxTool&&this._analysisHandles&&r.forEach(this._analysisHandles,function(t){t&&t.remove&&t.remove()},this)},_attachAnalysisToolListeners:function(){this.applyRFxTool&&(this._analysisHandles=[],this._analysisHandles.push(this.applyRFxTool.on("close",
p.hitch(this,this.close,!1))),this._analysisHandles.push(this.applyRFxTool.on("start",p.hitch(this,this.close,!1))))},_setParentAttr:function(t){t!==this.parent&&(this.parent=t,this.applyRFxTool=null)},_setItemAttr:function(t){this.item=t},_attachListeners:function(){window.addEventListener("message",p.hitch(this,function(t){if(t.source&&t.source===this._iframe.contentWindow){t=t.data;try{t=JSON.parse(t);"close"===t.action&&this.close(!0);if("loaded"===t.action)this.onLoad();"run"===t.action&&this.run(t.rft)}catch(w){}}}),
!1);this.own(q(this._passiveOverlay,"click",p.hitch(this,this.activate)),q(this._closeBtn,"click",p.hitch(this,this.close)),b.subscribe("onLayerUpdate",this._sendMapInfo.bind(this)),b.subscribe("_onRendererUpdate",this._sendMapInfo.bind(this)),b.subscribe("onMosaicRuleApply",this._sendMapInfo.bind(this)),b.subscribe("onMosaicRuleReset",this._sendMapInfo.bind(this)))}})})},"arcgisonline/pages/components/LayerCard":function(){define("require exports tslib preact preact/hooks dojo/i18n!../../nls/arcgisonline ../../map/utils/getServiceInfo dojo/string dojo/text!../dijit/Card/badges/deprecated.html ../../sharing/util".split(" "),
function(e,U,q,b,l,p,r,a,c,d){Object.defineProperty(U,"__esModule",{value:!0});p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);var h={ArcGISFeatureLayer:{name:"Feature Layer",icon:"feature-layer"},Table:{name:"Table",icon:"table"},ArcGISTiledMapServiceLayer:{name:"Tile Layer",icon:"layer-basemap"},ArcGISTiledImageServiceLayer:{name:"Tiled Imagery Layer",icon:"image-layer"},ArcGISStreamLayer:{name:"Feature Layer",icon:"feature-layer"},
VectorTileLayer:{name:"Vector Tile Layer",icon:"tile-layer"},CSV:{icon:"feature-layer"},GroupLayer:{name:"Group Layer"},Basemap:{name:"Basemap"},WebTiledLayer:{name:"Tile Layer",icon:"tile-layer"},ArcGISImageServiceLayer:{name:"Imagery Layer",icon:"image-layer"},ArcGISMapServiceLayer:{name:"Map Image Layer",icon:"layer-map"},MapImageLayer:{name:"Map Image Layer",icon:"layer-map"},OGCFeatureLayer:{name:"OGC Feature Layer",icon:"feature-layer"},SubtypeGroupLayer:{name:"Subtype Group Layer",icon:"layer-map"},
SketchLayer:{name:"Sketch Layer",icon:"feature-layer"},RouteLayer:{name:"Route Layer",icon:"road-sign"},GeoRSS:{icon:"feature-layer"},WFS:{icon:"feature-layer"},KML:{icon:"feature-layer"},WMS:{icon:"layer-map"},WMTS:{name:"WMTS",icon:"tile-layer"},Layer:{name:"Layer",icon:"layer"},unknown:{icon:"layer"}},f="GeoRSS WFS KML WMS WMTS unknown".split(" "),g="https://services.arcgisonline.com/arcgis/rest/services/Canvas/World_Dark_Gray_Base/MapServer https://services.arcgisonline.com/arcgis/rest/services/Canvas/World_Dark_Gray_Reference/MapServer https://services.arcgisonline.com/arcgis/rest/services/Canvas/World_Light_Gray_Base/MapServer https://services.arcgisonline.com/arcgis/rest/services/Canvas/World_Light_Gray_Reference/MapServer https://services.arcgisonline.com/arcgis/rest/services/Reference/World_Boundaries_and_Places/MapServer https://services.arcgisonline.com/arcgis/rest/services/NatGeo_World_Map/MapServer https://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer https://services.arcgisonline.com/arcgis/rest/services/World_Topo_Map/MapServer https://services.arcgisonline.com/arcgis/rest/services/Reference/World_Transportation/MapServer".split(" "),
n=function(m){function t(){var A,B,H=null===(A=z.templateUrl)||void 0===A?void 0:A.replace("http://","https://").toLowerCase(),T=null===(B=z.url)||void 0===B?void 0:B.replace("http://","https://").toLowerCase();return g.some(function(M){return[H,T].includes(M.toLowerCase())})}function w(){var A,B;return q.__awaiter(this,void 0,void 0,function(){var H,T,M;return q.__generator(this,function(L){switch(L.label){case 0:return L.trys.push([0,4,5,6]),H=Object.keys(h).filter(function(X){return!f.includes(X)}),
!R||z.isBaseMapLayer||z.featureCollection||!H.includes(N)?[3,3]:(M=T="*"===(null===(A=z.url)||void 0===A?void 0:A[0])?null===(B=z.url)||void 0===B?void 0:B.slice(1):z.url)?[4,r["default"](T)]:[3,2];case 1:M=L.sent(),L.label=2;case 2:M,L.label=3;case 3:return[3,6];case 4:return L.sent(),K("layerUnavailable"),[3,6];case 5:return V(!1),[7];case 6:return[2]}})})}function u(A){var B,H,T,M,L,X,ba,ma;return b.h("a",{href:null!==(B=A.itemUrl)&&void 0!==B?B:A.url,target:"_blank","class":"side-nav-link layer-card "+
(F&&"layer-card__nested")},b.h("div",{"class":"flex flex-center padding-leader-quarter padding-trailer-quarter no-pointer"},b.h("div",{"class":"flex-0 margin-right-1 margin-left-half"},O?b.h("calcite-loader",{active:!0,inline:!0,label:"layer-loading",type:"indeterminate",scale:"s"}):b.h("calcite-icon",{icon:null!==(T=null===(H=h[N])||void 0===H?void 0:H.icon)&&void 0!==T?T:"layer",scale:"s"})),b.h("div",{"class":"flex-1"},b.h("h5",{"class":"font-size--1 avenir-medium trailer-0 "+((null!==(M=A.itemUrl)&&
void 0!==M?M:A.url)?"text-blue":"text-off-black")},null!==(L=A.name)&&void 0!==L?L:A.title),b.h("p",{"class":"font-size--3 trailer-0 text-darker-gray pointer-none"},null!==(ma=null!==(ba=null===(X=h[N])||void 0===X?void 0:X.name)&&void 0!==ba?ba:A.layerType)&&void 0!==ma?ma:A.type)),b.h("div",{"class":"flex-0 layer-card__badges"},A.contentStatus&&b.h("div",{dangerouslySetInnerHTML:{__html:z.badges}}))),D&&b.h("div",{"class":"flex flex-align-center layer-card__warning"},b.h("calcite-icon",{"class":"margin-right-1 layer-card--text-red",
icon:"exclamation-mark-triangle",scale:"s"}),p["default"].sublayer.error[D],"rasterDeprecated"===D&&b.h("a",{href:"https://www.esri.com/arcgis-blog/products/arcgis-online/announcements/reminder-raster-basemaps-services-moving-to-mature-support/",target:"_blank",rel:"noopener noreferrer","class":"margin-left-half"},p["default"].sublayer.error.seeDetails)))}var v,x,y,C,z=m.layer;m=m.nested;var F=void 0===m?!1:m;m=l.useState(!0);var O=m[0],V=m[1];m=l.useState();var N=m[0],J=m[1];m=l.useState();var D=
m[0],K=m[1];m=l.useState(!0);var G=m[0],I=m[1],R=Object.keys(z).includes("contentStatus");l.useEffect(function(){var A,B,H,T;if(z.itemId&&!z.itemUrl)z.itemUrl="item.html?id\x3d"+z.itemId;else if(!z.itemId&&"VectorTileLayer"===z.layerType){var M=d["default"].parseUrl(z.styleUrl);if(M=null===(A=null===M||void 0===M?void 0:M.segments)||void 0===A?void 0:A[(null===(B=null===M||void 0===M?void 0:M.segments)||void 0===B?void 0:B.indexOf("items"))+1])z.itemUrl="item.html?id\x3d"+M}A=null!==(T=null!==(H=
z.layerType)&&void 0!==H?H:z.type)&&void 0!==T?T:"Layer";z.featureCollectionType?"notes"!==z.featureCollectionType.toLowerCase()||z.id.includes("mapNotes")?"route"===z.featureCollectionType.toLowerCase()&&(A="RouteLayer"):A="SketchLayer":z.wmtsInfo&&(A="WMTS");J(null!==A&&void 0!==A?A:"unknown")},[z]);l.useEffect(function(){t()&&(z.contentStatus="deprecated",z.badges=a["default"].substitute(c["default"],{i18n:p["default"],hideText:"",tooltipClass:"tooltip tooltip-bottom-left tooltip-multiline",tooltipLabel:p["default"].badges.deprecatedTooltip}),
K("rasterDeprecated"));w()},[N]);return b.h(b.Fragment,null,"GroupLayer"===z.layerType||"Basemap"===z.layerType?b.h("calcite-accordion",{"class":"layer-card__accordion","icon-position":"start",appearance:"transparent"},b.h("calcite-accordion-item",{"class":""+(F&&"layer-card__accordion--nested"),"item-title":null!==(v=z.name)&&void 0!==v?v:z.title,"item-subtitle":null!==(C=null!==(y=null===(x=h[N])||void 0===x?void 0:x.name)&&void 0!==y?y:z.layerType)&&void 0!==C?C:z.type,key:z.id,active:G,oncalciteAccordionItemSelect:function(A){A.stopPropagation();
I(!G)}},z.layers.map(function(A){A.isBaseMapLayer=z.isBaseMapLayer;return b.h(n,{key:A.id,layer:A,nested:!0})}))):u(z))};U["default"]=n})},"arcgisonline/pages/item/widgets/_visualize":function(){define("require exports tslib ../../../esriGeowConfig ../../utils/dom ../../utils/mapViewer ../../utils/layer ../../utils/queryHandler ../../../tsutils/declareDecorator dijit/_WidgetBase dijit/_TemplatedMixin dojo/string dojo/on dojo/has dojo/Deferred esri/Evented esri/lang arcgisonline/sharing/dijit/dialog/ConfirmDialog dojo/i18n!../../../nls/arcgisonline dojo/text!./templates/_visualize.html".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importStar(p);a=q.__importStar(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);return function(){function y(){this.templateString=x["default"];this.i18n=v["default"];this.widgetsInTemplate=
!0;this.sublayer=null}y.prototype.startup=function(){var C=this,z,F=new m["default"];this.inherited(arguments);this.isStreamLayer="Stream Service"===this.item.type;this.targetOrigin=window.location.protocol+"//"+window.location.hostname;this.viewerBaseUrl=this.targetOrigin+"/home";this.isMobile=480>window.innerWidth;this.computeMapViewer().then(function(V){C.mapViewerSetting=V;C.setViewerUrl()});document.documentElement.classList.add("no-footer");if(null===(z=this.item)||void 0===z?0:z.isLoaded)this.initUI().then(F.resolve);
else var O=this.item.watch("isLoaded",function(){O.unwatch();C.initUI().then(F.resolve)});return F};y.prototype.setViewerUrl=function(){var C=b["default"].isDebug?"/webviewer/dist/mobilemap.html":"/apps/mapviewer/mobilemap.html",z=this.isStreamLayer?"":"\x26layerId\x3d";this.isMobile?this.iframeSrc=C+"?embedded\x3d1\x26isViz\x3dtrue\x26layers\x3d"+this.item.id:this.useMapViewer?(z=this.page.sublayer?"\x26layerId\x3d"+this.page.sublayer.id:"",this.iframeSrc="../apps/mapviewer/visualization.html?layers\x3d"+
this.item.id+z):this.iframeSrc="./webmap/viewer.html?embedded\x3d1\x26isViz\x3dtrue\x26type\x3ditemDetail\x26layers\x3d"+this.item.id+z};y.prototype.canDestroy=function(){var C=new m["default"];this.promptUnsavedChanges().then(function(){return C.resolve(!0)});return C};y.prototype.destroy=function(){this.viewer.src="about:blank";this.inherited(arguments);clearInterval(this.mapLoadTimer);clearInterval(this.unsavedChangesTimer);document.documentElement.classList.remove("no-footer")};y.prototype.computeMapViewer=
function(){var C,z=new m["default"];this.item.portal.portalUser?null===(C=this.item.portal.portalUser)||void 0===C?void 0:C.getProperties().then(function(F){z.resolve(p["default"].determineMapViewerSetting(F))},function(){z.resolve(p["default"].determineMapViewerSetting())}):z.resolve(p["default"].determineMapViewerSetting());return z};y.prototype.initUI=function(){var C=new m["default"];this.showLayers();this.initHandlers();this.page.sublayer&&(this.layerSelect.value=""+this.page.sublayer.id,this.set("selectedLayer",
this.page.sublayer.id));this.set("visibleLayer",this.get("selectedLayer"));r.isSubtypeGroupLayer(this.sublayer,this.item)&&l["default"].hideNode(this.saveBtn);this.useMapViewer&&l["default"].hideNode(document.querySelector(".js-viz-controls"));C.resolve(!1);return C};y.prototype.showLayers=function(){var C;if(this.isMobile)document.querySelector(".js-viz-controls").remove();else{this.page.sublayer&&(this.layerSelect.classList.add("hide"),this.layerSelectLabel.classList.add("hide"));var z=(null===
(C=this.item)||void 0===C?void 0:C.featureLayers)||[],F=this.layerSelect;z.forEach(function(O,V){var N,J=document.createElement("option");J.value=""+(null!==(N=O.id)&&void 0!==N?N:V);J.innerHTML=O.name;F.appendChild(J)});F.selectedIndex=0;l["default"].showHide(this.domNode.querySelector(".js-featureLayers"),1<(null===z||void 0===z?void 0:z.length))}};y.prototype.saveChanges=function(C){var z=this.item.id;C=w["default"].isDefined(C)?C:this.get("selectedLayer");l["default"].forEachNode(this.domNode.querySelectorAll(".js-subnav-link"),
function(F){return F.classList.remove("btn-disabled")});this.mapSavedDfd=new m["default"];this.postMapMessage({type:"saveLayer",itemId:z,layerId:C});return this.mapSavedDfd};y.prototype.saveAsNewLayer=function(){var C=this.item.id,z=this.get("selectedLayer");this.layerSavedDfd=new m["default"];this.postMapMessage({type:"saveAsNewLayerItem",itemId:C,layerId:z});return this.layerSavedDfd};y.prototype.promptUnsavedChanges=function(C){var z=this,F,O=new m["default"],V=this.item.canUpdate,N=null!==(F=
this.layerSelect.options)&&void 0!==F?F:[];C=w["default"].isDefined(C)?C:this.layerSelect.selectedIndex;var J=(N=N[C])?Number(N.value):-1;N=N?N.innerHTML:this.item.title;C=f["default"].substitute(this.i18n.itemProperties.layerUnsavedChanges,{layerName:N});if(V&&this.hasUnsavedChanges){var D=new u["default"]({closable:!1,buttonOkLabel:this.i18n.common.yesLabel,buttonCancelLabel:this.i18n.common.noLabel,busyMessage:f["default"].substitute(this.i18n.viewer.mapUtil.savingProps,{title:N}),style:{width:"400px",
height:"auto"}});D.show({message:C,title:this.i18n.openPresentationDlg.title}).then(function(K){"onOk"===K?D.hide().then(function(){return z.saveChanges(J).then(function(){return O.resolve(!0)})}):O.resolve(!0)})}else O.resolve(!0);return O};y.prototype._setVisibleLayerAttr=function(C){var z,F,O=n["default"]("mozilla")?"hideLoader":"showLoader";this.page[O]();O="";var V=((null===(z=this.item)||void 0===z?void 0:z.featureLayers)||[]).find(function(N){return N.id===C});this.item.isAdmin&&-1===(null===
(F=null===V||void 0===V?void 0:V.capabilities)||void 0===F?void 0:F.toLowerCase().indexOf("query"))&&(O="\x26isAdmin\x3dtrue");this.useMapViewer=-1<this.item.typeKeywords.indexOf("ArcGIS API for JavaScript")||this.mapViewerSetting===p.MapViewerType.Modern;l["default"].showHideAll([this.saveBtn,this.saveAsBtn],!this.useMapViewer);this.setViewerUrl();this.viewer.src=this.useMapViewer?this.iframeSrc+O:this.iframeSrc+(this.isStreamLayer||this.isMobile?"":C||"0")+O;this.blockSaveForSGL()};y.prototype._getSelectedLayerAttr=
function(){return parseInt(this.layerSelect.value,10)};y.prototype.initHandlers=function(){var C=this;this.own(g["default"](window,"message",function(z){z.origin!==C.targetOrigin||C.isMobile||C.processMapMessage(z.data)}));g["default"](this.viewer,"load",function(){C.page.hideLoader();clearInterval(C.mapLoadTimer);C.mapLoadTimer=window.setInterval(function(){C.postMapMessage({type:"isLoaded"});C.page.sublayer&&C.postMapMessage({type:"setSingleLayerMode"});C.own(g["default"](C.viewer.contentWindow||
C.viewer,"click",function(){l["default"].forEachNode(document.querySelectorAll(".js-logged-in-navigation"),function(z){return z.classList.remove("is-active")})}))},500)});g["default"](this.layerSelect,"focus",function(z){C.previousSelectedIdx=C.layerSelect.selectedIndex});g["default"](this.layerSelect,"change",function(z){C.promptUnsavedChanges(C.previousSelectedIdx).then(function(){C.set("visibleLayer",C.layerSelect.value)})});g["default"](this.saveBtn,"click",function(z){null===z||void 0===z?void 0:
z.preventDefault();C.saveChanges()});g["default"](this.saveAsBtn,"click",function(z){null===z||void 0===z?void 0:z.preventDefault();C.saveAsBtn.classList.add("btn-disabled");C.saveAsNewLayer().then(function(F){window.location.href="item.html?id\x3d"+F.newItemId},function(){C.saveAsBtn.classList.remove("btn-disabled")})})};y.prototype.blockSaveForSGL=function(){var C=this,z=this.page._item,F=z.layers.find(function(O){return""+O.id===C.layerSelect.value});z=r.isSubtypeGroupLayer(F,z);l["default"].showHide(this.saveBtn,
!z)};y.prototype.checkForChanges=function(){this.postMapMessage({type:"hasLayerUnsavedChanges",itemId:this.item.id,layerId:this.get("selectedLayer")})};y.prototype.postMapMessage=function(C){(this.viewer.contentWindow||this.viewer).postMessage(JSON.stringify(C),this.targetOrigin)};y.prototype.processMapMessage=function(C){var z=this;C=JSON.parse(C);var F=null===C||void 0===C?void 0:C.type,O=this.item.canUpdate;if("loaded"===F&&C.value)clearInterval(this.mapLoadTimer),this.page.hideLoader(),O&&(clearInterval(this.unsavedChangesTimer),
this.unsavedChangesTimer=window.setInterval(function(){return z.checkForChanges()},500));else if("layerUnsavedChanges"===F)this.saveBtn.classList[C.value?"remove":"add"]("btn-disabled"),this.hasUnsavedChanges=C.value;else if("layerSaved"===F){this.hasUnsavedChanges=!1;this.item.serviceInfo=null;this.item.set("status","completed");var V=this.item.watch("isLoaded",function(){V.remove();var N=z.item.thumbnailUrl;N=N.substring(N.indexOf("?")+1,N.length);N=a.queryToObject(N);N.ts=(new Date).getTime();
z.item.set("thumbnailUrl",z.item.thumbnailUrl+"?"+a.objectToQuery(N));setTimeout(function(){var J;l["default"].forEachNode(document.querySelectorAll(".js-subnav-link"),function(D){return D.classList.remove("btn-disabled")});null===(J=z.mapSavedDfd)||void 0===J?void 0:J.resolve(!0)},500)})}else"newLayerItemCreated"===F?(this.layerSavedDfd&&this.layerSavedDfd.resolve(C),this.useMapViewer&&(window.location.href="item.html?id\x3d"+C.value.id)):"saveAsNewLayerItemCancelled"===F&&this.layerSavedDfd&&this.layerSavedDfd.reject(C)};
return y=q.__decorate([c["default"](d["default"],h["default"],t["default"])],y)}()})},"arcgisonline/pages/item/widgets/_imageManagement":function(){define("require exports tslib ../../../esriGeowConfig ../../utils/dom ../../../tsutils/declareDecorator dijit/_WidgetBase dijit/_TemplatedMixin dojo/Deferred dojo/on dojo/query dojo/topic dojo/_base/kernel esri/Evented dojo/text!./templates/_imageManagement.html".split(" "),function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m){b=q.__importDefault(b);l=q.__importDefault(l);
p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);return function(){function t(){this.templateString=m["default"]}t.prototype.startup=function(){var w=this,u=new c["default"];this.inherited(arguments);this._targetOrigin=window.location.protocol+"//"+window.location.hostname;this._iframeSrc=b["default"].imageManagementUrl.replace("#",
"?lang\x3d"+g["default"].locale+"#")+"/"+this.item.id;this.divImageManagement.src=this._iframeSrc;document.documentElement.classList.add("no-footer");if(this.item&&this.item.isLoaded)this._initUI().then(function(x){u.resolve(x)});else var v=this.item.watch("isLoaded",function(){v.unwatch();w._initUI().then(function(x){u.resolve(x)})});return u};t.prototype.canDestroy=function(){var w=new c["default"];w.resolve(!0);return w};t.prototype.destroy=function(){this.divImageManagement.src="about:blank";
this.inherited(arguments);document.documentElement.classList.remove("no-footer")};t.prototype._initUI=function(){var w=new c["default"];this._initHandlers();w.resolve(!0);return w};t.prototype._initHandlers=function(){var w=this;this.own(d["default"](window,"message",function(u){if(u.origin===w._targetOrigin&&"imagery"===u.data.msgType){var v=u.data.status;-1<["completed","failed","processing"].indexOf(v)&&(w.item.properties=w.item.properties||{},w.item.properties.jobUrl=w.item.jobUrl=u.data.jobUrl,
w.item.properties.jobId=w.item.jobId=u.data.jobId,w.item.properties.status=v,w.item.set("status",v),u="completed"===v||"failed"===v?"removeClass":"addClass",l["default"]["completed"===v||"failed"===v?"deactivateNode":"activateNode"](h["default"](".js-service-status").shift()),h["default"](".js-status-disable")[u]("btn-disabled"),f["default"].publish("imagery/update",{completed:"completed"===v||"failed"===v}))}}),d["default"](this.divImageManagement,"load",function(){w.page.hideLoader()}))};return t=
q.__decorate([p["default"](r["default"],a["default"],n["default"])],t)}()})},"arcgisonline/pages/item/widgets/_data":function(){define("require exports tslib esri/Evented esri/lang esri/request dojo/_base/event dojo/_base/json dojo/_base/lang dojo/aspect dojo/string dojo/query dojo/on dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dgrid/OnDemandGrid dojo/promise/all dojo/Deferred dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/MenuItem esri/layers/FeatureLayer esri/tasks/query esri/tasks/QueryTask esri/tasks/StatisticDefinition esri/dijit/CalculateField esri/dijit/FeatureTable esri/dijit/FeatureTable/dataUtils esri/dijit/FeatureTable/dialogUtils esri/dijit/Histogram arcgisonline/map/itemData arcgisonline/map/edit arcgisonline/sharing/util ../_Actions ../../utils/data ../../utils/dom ../../utils/icons ../../utils/arrays ../../utils/strings ./AttributesView/_attributesView ../../dijit/ArcadeCalculatorDlg ../../dijit/CalculateWithOptionsDlg ../../pageUtil arcgisonline/sharing/dijit/dialog/TableAddFieldDlg arcgisonline/sharing/dijit/dialog/DeleteWarningDlg arcgisonline/sharing/dijit/dialog/WaitingDlg dojo/i18n!esri/nls/jsapi dojo/text!./templates/_data.html ../../../tsutils/declareDecorator arcgisonline/esriGeowConfig esri/support/expressionUtils xstyle/css!./css/data.css".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D,K,G,I,R,A,B,H,T,M,L,X,ba,ma,ta,Ea,wa,Q,Z,aa,ea,oa,ra,za,ya,Ha){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);
y=q.__importDefault(y);C=q.__importDefault(C);z=q.__importDefault(z);F=q.__importDefault(F);O=q.__importDefault(O);V=q.__importDefault(V);N=q.__importDefault(N);J=q.__importDefault(J);D=q.__importDefault(D);K=q.__importDefault(K);G=q.__importDefault(G);I=q.__importDefault(I);R=q.__importDefault(R);A=q.__importDefault(A);B=q.__importDefault(B);H=q.__importDefault(H);T=q.__importDefault(T);M=q.__importDefault(M);L=q.__importDefault(L);X=q.__importDefault(X);ba=q.__importDefault(ba);ma=q.__importDefault(ma);
ta=q.__importDefault(ta);Ea=q.__importDefault(Ea);wa=q.__importDefault(wa);Q=q.__importDefault(Q);Z=q.__importDefault(Z);aa=q.__importDefault(aa);ea=q.__importDefault(ea);oa=q.__importDefault(oa);ra=q.__importDefault(ra);za=q.__importDefault(za);ya=q.__importDefault(ya);Ha=q.__importDefault(Ha);return function(){function ua(Y,da){this.templateString=ra["default"];this.layer=null;this.layerInfos=[];this.userCanEdit=!1;this.portalUser=this.page=this.item=this.i18n=this.sublayer=this.table=null;this.icons=
X["default"];this.css={noFooter:"no-footer",hide:"hide",loader:"loader-bars",column5:"column-5",tabletColumn12:"tablet-column-12",menuItem:"esri-feature-table-menu-item",sortAscendingIcon:"icon-ui-sort-ascending",sortDescendingIcon:"icon-ui-sort-descending",propertiesIcon:"esri-icon-properties",iconCalculator:"esri-icon-statistics",iconTrash:"esri-icon-trash",histogram:"field-view-histogram-node",uniqueValueGrid:"field-view-unique-value-grid-node",attributeRulesGrid:"field-view-attribute-grid-node",
calcFieldDialog:"calculateFieldDialog",calcCloseButton:"cancel",calcClearIcon:"icon-ui-erase",calcValidateIcon:"icon-ui-check-mark"};this._connects=[];this._userIsAdmin=this._userIsOwner=!1;this._subtypeLayerIndex=-1;this._fieldViewEvents=[];this._calcField=this._calcDialog=this._histogram=this._fieldRulesTable=this._fieldValuesTable=this._activeFieldInfo=null;this._uneditableFieldTypes="esriFieldTypeBlob esriFieldTypeGlobalID esriFieldTypeGeometry esriFieldTypeGUID esriFieldTypeOID esriFieldTypeRaster".split(" ")}
ua.prototype.startup=function(){var Y=this,da,ka;this.inherited(arguments);var W=new x["default"];t["default"].add(document.documentElement,this.css.noFooter);if(null===(da=this.item)||void 0===da?0:da.isLoaded)return this._initUI().then(W.resolve),W;var fa=null===(ka=this.item)||void 0===ka?void 0:ka.watch("isLoaded",function(){fa.unwatch();Y._initUI().then(W.resolve)});return W};ua.prototype.destroy=function(){this.inherited(arguments);this.page.toggleErrors(!0);t["default"].remove(document.documentElement,
this.css.noFooter);this._connects.forEach(function(Y){Y.remove()})};ua.prototype._initUI=function(){var Y=new x["default"];this.page.toggleErrors(!1);ya["default"].hideFieldsViewInDataTab&&f["default"](".js-data-attributes").addClass("hide");this._initHandlers();this._showLayers();this.sublayer?(this.set("visibleLayer",this.sublayer.id),this.layerSelect.value=this.sublayer.id,this.domNode.querySelector(".js-featureLayers").classList.add("visually-hidden")):this.set("visibleLayer",this.layerSelect.value);
Y.resolve(!1);return Y};ua.prototype._showLayers=function(){var Y=this.item,da=Y.itemData;Y=[].concat(Y.featureLayers||[]).concat(Y.tables||[]);var ka=this.layerSelect,W=da&&da.layers&&da.layers.length,fa=!Y.length&&W;Y=(da=fa?da.layers:Y)&&1<da.length?"removeClass":"addClass";da.forEach(function(ha,sa){var Fa=fa?ha.layerDefinition.name:ha.name;w["default"].place(w["default"].toDom('\x3coption value\x3d"'+(l["default"].isDefined(ha.id)?ha.id:sa)+'"\x3e'+Fa+"\x3c/option\x3e"),ka)});m["default"].set(ka,
"selected",0);f["default"](".js-featureLayers")[Y]("hide")};ua.prototype._initHandlers=function(){var Y=this;this.own(g["default"](this.layerSelect,"change",function(){Y._dataView?Y.set("visibleLayer",m["default"].get(Y.layerSelect,"value")):Y.set("visibleAttributes",m["default"].get(Y.layerSelect,"value"));t["default"].add(Y.fieldViewContainer,Y.css.hide);t["default"].add(Y.fieldViewTop,Y.css.hide);Y._cleanUpFieldView();Y._fieldViewEvents&&(Y._fieldViewEvents.forEach(function(da){da.remove()}),Y._fieldViewEvents=
[])}),f["default"](".js-data-aspect",this.domNode).on("change",function(da){Y.set("data"===da.target.value?"visibleLayer":"visibleAttributes",m["default"].get(Y.layerSelect,"value"))}))};ua.prototype._showError=function(Y){};ua.prototype._hideError=function(){};ua.prototype._setVisibleLayerAttr=function(Y){var da=this;this._dataView=!0;document.querySelector(".js-attributesView").checked=!1;document.querySelector(".js-dataView").checked=!0;f["default"](".js-feature-table").removeClass("hide");f["default"](".js-attributes-view").addClass("hide");
f["default"](".js-hide-on-error").removeClass("hide");f["default"](".js-data-error").removeClass("is-active");this._hideError();this.page.showLoader();this._connects.forEach(function(W){W.remove()});this.getRelatedTSForFS(this.item).then(function(W){da.item.relTileLayers=W});var ka=parseInt(Y,10);this._createLayer(this.item,ka).then(function(W){var fa,ha=da.item;da.layer=W.layer;da.layerInfos=W.layerInfos;da.userCanEdit=W.userCanEdit;W=da.layer.isEditable?da.layer.isEditable():!1;da.userCanEdit&&
!W&&(da.layer.userIsAdmin=!0);da._setUpTable();da.page._showDataLastUpdated({type:ha.type,typeKeywords:[].concat(ha.typeKeywords),layers:(null===(fa=ha.layers)||void 0===fa?void 0:fa.length)>ka?[ha.layers[ka]]:[]});da.page.hideLoader()},function(){f["default"](".js-hide-on-error").addClass("hide");da.page.hideLoader();f["default"](".js-data-error").addClass("is-active")})};ua.prototype._setVisibleAttributesAttr=function(Y){var da=this;this._dataView=!1;document.querySelector(".js-attributesView").checked=
!0;document.querySelector(".js-dataView").checked=!1;f["default"](".js-hide-on-error").removeClass("hide");f["default"]("js-data-error").removeClass("is-active");this._hideError();this.page.showLoader();f["default"](".js-feature-table").addClass("hide");f["default"](".js-attributes-view").removeClass("hide");Y=parseInt(Y,10);this._createLayer(this.item,Y).then(function(ka){da.layer=ka.layer;da.layerInfos=ka.layerInfos;da.layer.fields.forEach(function(W){W.canDeleteField=da._canDeleteField(W);W.canFieldEditableProp=
da._canFieldEditableProp(W)});da.attributesView&&(da.attributesView.destroy(!0),da.attributesView=null);ka=new ta["default"](null,da.domNode.querySelector(".js-attributes-view"));ka.startup(da.item,da.layer,da.layerInfos,da._canAddField());da.attributesView=ka;da._setUpAttributeViewEvents();da.page.hideLoader()},function(ka){f["default"](".js-hide-on-error").addClass("hide");da.page.hideLoader();f["default"](".js-data-error").addClass("is-active")})};ua.prototype._setUpAttributeViewEvents=function(){var Y=
this;this.attributesView.own(f["default"](".js-add-field-btn",this.domNode).on("click",function(da){r["default"].stop(da);Y._showAddFieldDialog()}),y["default"].subscribe("attributeFieldDetails/deleteField",this._showDeleteFieldDialog.bind(this)),y["default"].subscribe("attributesView/deleteSingleField",this._showDeleteFieldDialog.bind(this)),y["default"].subscribe("attributesView/deleteMultipleFields",this._showDeleteMultipleFieldDialog.bind(this)))};ua.prototype._createLayer=function(Y,da){var ka,
W=new x["default"],fa=null===Y||void 0===Y?void 0:Y.url.replace(/\/+$/,""),ha=da||0;fa=(null===fa||void 0===fa?0:fa.match(/Server\/(\d+)/))?fa:fa+"/"+ha;var sa=c["default"].clone(Y.itemData)||null,Fa=this.portalUser,Ma=[],Oa;this._userIsOwner=Fa&&Y?Fa.username===Y.owner:!1;this._userIsAdmin=!(null===(ka=null===Fa||void 0===Fa?void 0:Fa.userRole)||void 0===ka||!ka.isAdmin());var Ra=this._canEditData()||this._userIsOwner||this._userIsAdmin;if(null===sa||void 0===sa?0:sa.layers){Ma=sa.layers||[];Ma.length&&
(Ma.some(function(S){if(l["default"].isDefined(S.id)&&S.id===ha||S.layerDefinition&&l["default"].isDefined(S.layerDefinition.id)&&S.layerDefinition.id===ha)return Oa=S,!0}),Oa||(Oa=Ma[ha]||null));var Da=(Da=Oa?Oa.layerDefinition:null)?Da.definitionExpression:null}sa=(ka=this._getSTGLSublayerInfo(sa,ha))&&(null===ka||void 0===ka?void 0:ka.groupLayer);L["default"].showHide(this.domNode.querySelector(".js-subtype-group-layers"),sa);sa&&this._createSTGLpicker(ka,ha);if(Y.isFeatureCollection){var E=new O["default"](Oa,
{userIsAdmin:Ra,visible:!0});if(E.loaded)W.resolve({layer:E,layerInfos:Ma,userCanEdit:Ra});else g["default"].once(E,"load",function(S){W.resolve({layer:E,layerInfos:Ma,userCanEdit:Ra})})}else if(E=ka&&ka.subtypeLayer?this._createFeatureLayerFromSTGLSublayer(Y,ka,Ra):new O["default"](fa.replace(/.*?:\/\//g,"//"),{userIsAdmin:Ra,mode:O["default"].MODE_ONDEMAND,outFields:["*"],visible:!0,definitionExpression:Da}),g["default"].once(E,"error",W.reject),g["default"](E,"add-attachment-complete",this._updateLayerDataUpdatedDate.bind(this)),
g["default"](E,"delete-attachments-complete",this._updateLayerDataUpdatedDate.bind(this)),E.loaded)W.resolve({layer:E,layerInfos:Ma,userCanEdit:Ra});else g["default"].once(E,"load",function(S){W.resolve({layer:E,layerInfos:Ma,userCanEdit:Ra})});return W};ua.prototype._isViewServiceLayer=function(Y){return(null===Y||void 0===Y?void 0:Y.typeKeywords)&&-1<Y.typeKeywords.indexOf("View Service")};ua.prototype._isHostedServiceLayer=function(Y){return(null===Y||void 0===Y?void 0:Y.typeKeywords)&&-1<Y.typeKeywords.indexOf("Hosted Service")};
ua.prototype._isSpatioTemporalService=function(Y){return(null===Y||void 0===Y?void 0:Y.typeKeywords)&&-1<Y.typeKeywords.indexOf("Spatiotemporal")};ua.prototype.getRelatedTSForFS=function(Y){var da=new x["default"],ka=Y.itemUrl;this._isViewServiceLayer(Y)?ka+="/relatedItems?relationshipType\x3dService2Service\x26direction\x3dforward":Y.isHostedService||this._isHostedServiceLayer(Y)?ka+="/relatedItems?relationshipType\x3dService2Data\x26direction\x3dreverse":da.resolve(null);H["default"].getJson(ka,
function(W){var fa=null;if(null===W||void 0===W?0:W.total)fa=[],null===W||void 0===W?void 0:W.relatedItems.forEach(function(ha){"Map Service"===ha.type&&fa.push(ha)});da.resolve(fa)},function(W){da.resolve(null)});return da};ua.prototype._setUpTable=function(){var Y=this.layer,da=this.css;this.table&&(this.table.destroy(),this.table=null);var ka=this._getPopupInfo(Y),W=(null===ka||void 0===ka?void 0:ka.fieldInfos)||null;ka=W?this._getOrderedOutFields(Y,W):["*"];W=W?this._getHiddenFields(Y,W,ka):null;
var fa=this.userCanEdit&&!this.item.isMultipatchFeatureService&&!this.item.isFeatureCollection;this.wrapper.querySelector("#grid")||w["default"].create("div",{id:"grid"},this.wrapper);var ha=new K["default"]({featureLayer:Y,editable:fa,showAttachments:!0,showFieldDetails:!0,showRelatedRecords:!0,showDataTypes:!1,showColumnHeaderTooltips:Y.supportsFieldDescription?!1:!0,showColumnHeaderTooltipsWithDescription:!!Y.supportsFieldDescription,showDefaultSortMenuItem:!1,showFilterMenuItems:!1,showStatistics:!1,
dateOptions:{timeEnabled:!0,dateEnabled:!0,datePattern:"M/d/y",timePattern:"h:mm a"},outFields:ka,hiddenFields:W,_layerInfos:this.layerInfos},"grid");ha.own(g["default"](ha,"load",function(){ha.css=q.__assign(q.__assign({},ha.css),{sortAscendingIcon:da.sortAscendingIcon,sortDescendingIcon:da.sortDescendingIcon,propertiesIcon:da.propertiesIcon});setTimeout(ha.resize,200)}));ha.resize();ha.startup();this.table=ha;this._setUpTableEvents()};ua.prototype._createSTGLpicker=function(Y,da){var ka=this,W,
fa,ha=this.domNode.querySelector(".js-subtype-group-layers-select"),sa=this.domNode.querySelector(".js-subtype-group-layers-label");this.subtypeGroupLayerPicker||(this.domNode.querySelector(".js-subtype-group-layers").classList.remove("hide"),ha.addEventListener("change",function(Fa){Fa=parseInt(Fa.target.value,10);ka._subtypeLayerIndex=Fa;ka._setVisibleLayerAttr(ka.layerSelect.value)}),this.subtypeGroupLayerPicker=ha,this._subtypeLayerIndex=-1);sa.innerHTML=Y.subtypeLabel+":";ha.innerHTML=null===
(fa=null===(W=Y.groupLayer)||void 0===W?void 0:W.layers)||void 0===fa?void 0:fa.reduce(function(Fa,Ma,Oa){return"\n        "+Fa+' \x3coption value\x3d"'+Oa+'" '+(Oa===ka._subtypeLayerIndex?"selected":"")+"\x3e\n          "+Ma.title+"\n        \x3c/option\x3e\n      "},'\x3coption value\x3d"-1" '+(-1===this._subtypeLayerIndex?"selected":"")+"\x3e"+this.i18n.gallery.filters.all+"\x3c/option\x3e")};ua.prototype._createFeatureLayerFromSTGLSublayer=function(Y,da,ka){var W;if(da&&da.subtypeLayer){var fa=
da.subtypeLayer;da=da.groupLayer;return new O["default"](Y.url+"/"+da.id,{definitionExpression:null===(W=da.layerDefinition)||void 0===W?void 0:W.definitionExpression,subtypeSublayerInfo:fa,outFields:["*"],userIsAdmin:ka})}};ua.prototype._findById=function(Y,da){return null===Y||void 0===Y?void 0:Y.find(function(ka){return(null===ka||void 0===ka?void 0:ka.id)===da})};ua.prototype._isSubtypeGroupLayer=function(Y,da){var ka=this._findById(null===Y||void 0===Y?void 0:Y.layers,da);return"SubtypeGroupLayer"===
(null===ka||void 0===ka?void 0:ka.layerType)?ka:!1};ua.prototype._getSTGLSublayerInfo=function(Y,da){var ka,W=this._isSubtypeGroupLayer(Y,da);if(!W)return!1;var fa=this._findById(this.item.layers,da),ha=null===fa||void 0===fa?void 0:fa.subtypeField,sa="Subtype";ha&&(fa=null===(ka=fa.fields)||void 0===ka?void 0:ka.find(function(Fa){return(null===Fa||void 0===Fa?void 0:Fa.name)===ha}),sa=(null===fa||void 0===fa?void 0:fa.alias)||(null===fa||void 0===fa?void 0:fa.name)||"Subtype");return{groupLayer:W,
subtypeLayer:W.layers[this._subtypeLayerIndex],subtypeLabel:sa}};ua.prototype._setUpTableEvents=function(){var Y=this,da=this.item,ka=this.table,W=this.css;ka.own(g["default"](ka,"show-detailed-field-view",this._showFieldView.bind(this)),g["default"](ka,"error",function(fa){Y._showError({message:fa.message})}),g["default"](ka,"edits-complete",this._updateLayerDataUpdatedDate.bind(this)),d["default"].after(ka._grid,"_generateOptionsMenuItems",function(fa){(null===da||void 0===da?0:da.canAppendData)&&
fa.unshift({label:Y.i18n.itemProperties.appendData,callback:Y._showAppendDataDialog.bind(Y)});Y._canAddField()&&fa.unshift({label:oa["default"].calculateFields.addFieldTitle,callback:Y._showAddFieldDialog.bind(Y)});return fa}),d["default"].before(ka._grid,"_showColumnMenu",function(fa){var ha,sa,Fa=fa.menu,Ma=fa.fieldInfo;if(Y._canCalculateField(Ma))if(null===(sa=null===(ha=Y.item)||void 0===ha?void 0:ha.serviceInfo)||void 0===sa?0:sa.supportsAppend){var Oa=Y._canArcadeCalculateField(Ma);Fa.addChild(new F["default"]({label:oa["default"].calculateFields.calculate,
iconClass:W.iconCalculator,baseClass:W.menuItem,onClick:function(){return Y._showCalculateWithOptionsDialog({fieldInfo:Ma,showArcadeOption:Oa})}}))}else Fa.addChild(new F["default"]({label:oa["default"].calculateFields.calculate,iconClass:W.iconCalculator,baseClass:W.menuItem,onClick:function(){return Y._showCalculateFieldDialog(Ma)}}));Y._canDeleteField(Ma)&&Fa.addChild(new F["default"]({label:oa["default"].calculateFields.deleteLabel,iconClass:W.iconTrash,baseClass:W.menuItem,onClick:function(){return Y._showDeleteFieldDialog(Ma)}}))}),
y["default"].subscribe("append/done",function(fa){fa&&"success"===fa.type&&(Y._updateLayerDataUpdatedDate(),ka.refresh())}),y["default"].subscribe("arcadeCalculatorDlg/done",function(fa){"success"===(null===fa||void 0===fa?void 0:fa.type)&&(Y._updateLayerDataUpdatedDate(),Y._fieldViewActive&&Y._updateFieldView({fieldInfo:Y._activeFieldInfo}),ka.refresh())}))};ua.prototype._updateLayerDataUpdatedDate=function(){var Y=this.item,da=this.layer,ka=(new Date).getTime();this.item.set("maxAgeCheck",!0);if(da){da.editingInfo=
da.editingInfo||{};da.editingInfo.lastEditDate=ka;if(Y.layers){var W=Y.layers[da.layerId];W.editingInfo=W.editingInfo||{};W.editingInfo.lastEditDate=ka}this.page._showDataLastUpdated({type:Y.type,typeKeywords:[].concat(Y.typeKeywords),layers:[da]})}};ua.prototype._reloadTable=function(){var Y=this;this._hideError();this.table&&(this.table.destroy(),this.table=null);w["default"].create("div",{id:"grid"},this.wrapper);this._updateItemData().then(function(){Y._dataView?Y._setUpTable():Y.set("visibleAttributes",
m["default"].get(Y.layerSelect,"value"))})};ua.prototype._getOrderedOutFields=function(Y,da){var ka,W,fa=da.map(function(ha){return ha.fieldName});if(null===(ka=Y.fields)||void 0===ka?0:ka.length)null===(W=Y.fields)||void 0===W?void 0:W.forEach(function(ha){-1===fa.indexOf(ha.name)&&fa.push(ha.name)});return fa};ua.prototype._getHiddenFields=function(Y,da,ka){var W,fa,ha=Y.objectIdField,sa=da.filter(function(Ma){return!Ma.visible}).map(function(Ma){return Ma.fieldName}),Fa=da.map(function(Ma){return Ma.fieldName});
0<(null===(W=Y.fields)||void 0===W?void 0:W.length)&&(null===(fa=Y.fields)||void 0===fa?void 0:fa.forEach(function(Ma){-1===Fa.indexOf(Ma.name)&&-1<ka.indexOf(Ma.name)&&sa.push(Ma.name)}),Y=Y.fields.every(function(Ma){return-1<sa.indexOf(Ma.name)}),ha&&Y&&sa.splice(sa.indexOf(ha),1));return sa};ua.prototype._showFieldView=function(Y){var da=this,ka,W=this.table,fa=this.css;this._activeFieldInfo=Y.fieldInfo;this._columnPickerButton=Y.pickerButton;this._fieldViewActive=!0;t["default"].add(n["default"].byId("grid"),
[fa.column5,fa.tabletColumn12]);t["default"].remove(this.fieldViewContainer,fa.hide);t["default"].remove(this.fieldViewTop,fa.hide);this._updateFieldView(Y);null===(ka=null===W||void 0===W?void 0:W._gridBorderContainerNode)||void 0===ka?void 0:ka.resize();this.own(g["default"].once(this.fieldViewTopCloseBtn,"click",this._hideFieldView.bind(this)),g["default"](W,"column-focus-change",function(ha){da._activeFieldInfo=ha.fieldInfo;da._updateFieldView(ha)}));this._fieldViewEvents=[g["default"](this.calculateFieldButton,
"click",function(){var ha,sa;(null===(sa=null===(ha=da.item)||void 0===ha?void 0:ha.serviceInfo)||void 0===sa?0:sa.supportsAppend)?da._showCalculateWithOptionsDialog({fieldInfo:da._activeFieldInfo,showArcadeOption:da._canArcadeCalculateField(da._activeFieldInfo)}):da._showCalculateFieldDialog(da._activeFieldInfo)}),g["default"](this.deleteFieldButton,"click",function(){da._showDeleteFieldDialog(da._activeFieldInfo)}),g["default"](W,"edits-complete",function(){da._updateFieldView({fieldInfo:da._activeFieldInfo})}),
f["default"](".index-form",this.domNode).on("change",function(ha){r["default"].stop(ha);ha=f["default"](".unique-index-checkbox",da.domNode).shift().checked;da._currentFieldHasIndex&&!ha?f["default"](".index-form-submit",da.domNode).removeAttr("disabled"):!da._currentFieldHasIndex&&ha?f["default"](".index-form-submit",da.domNode).removeAttr("disabled"):f["default"](".index-form-submit",da.domNode).attr("disabled","true")}),f["default"](".cancel-index-form",this.contentWrapper).on("click",function(ha){r["default"].stop(ha);
ha=ha.target.form;f["default"](".index-form").addClass("hide");f["default"](".edit-index").removeClass("hide");ha.reset()}),f["default"](".index-form-submit",this.contentWrapper).on("click",function(ha){r["default"].stop(ha);f["default"](".index-form").addClass("hide");var sa=da.domNode.querySelector(".unique-index-checkbox").checked;ha=sa?da.i18n.itemProperties.createUniqueIndex:da.i18n.itemProperties.deleteUniqueIndex;f["default"](".change-index-text",da.domNode).attr("innerHTML",ha);da._generateIndexJsonParameters(sa).then(function(Fa){da._buildOrDeleteIndex(sa,
Fa).then(function(){da._addOrRemoveIndex(sa,Fa);setTimeout(function(){y["default"].publish("alert/show",{type:"success",text:da.i18n.itemProperties.createindexSuccess});da._showAttributeRulesGrid(da._activeFieldInfo)},1E3)},function(Ma){setTimeout(function(){y["default"].publish("alert/show",{type:"error",text:da.i18n.itemProperties.error.indexFailure});da._showAttributeRulesGrid(da._activeFieldInfo)},1E3)})})})]};ua.prototype._addOrRemoveIndex=function(Y,da){if(Y)this.layer.indexes.push(da.indexes[0]);
else for(var ka=0;ka<this.layer.indexes.length;ka++)if(this.layer.indexes[ka].name.toLowerCase()===da.indexes[0].name.toLowerCase()&&this.layer.indexes[ka].isUnique){this.layer.indexes.splice(ka,1);break}};ua.prototype._buildOrDeleteIndex=function(Y,da){var ka=this,W=new x["default"],fa=this.item.adminUrl+"/"+this.layerSelect.value;if(!Y&&this.item.portal.isPortal){fa+="/deleteFromDefinition";var ha={deleteFromDefinition:JSON.stringify(da),async:!1};H["default"].request({url:fa,content:ha},{usePost:!0}).then(function(){W.resolve()},
function(sa){W.reject(sa)})}else Y?(fa+="/addToDefinition",ha={addToDefinition:JSON.stringify(da),async:!0}):(fa+="/deleteFromDefinition",ha={deleteFromDefinition:JSON.stringify(da),async:!0}),H["default"].request({url:fa,content:ha},{usePost:!0}).then(this._checkStatus.bind(this),function(sa){W.reject(sa)}).then(function(sa){ka.page._item.set("serviceChanged",!0);W.resolve(sa)});return W};ua.prototype._checkStatus=function(Y,da,ka){var W=this,fa=null===Y||void 0===Y?void 0:Y.statusURL,ha=ka||new x["default"],
sa=da||500;H["default"].request({url:fa}).then(function(Fa){Fa=Fa||{status:"completed"};Fa.status&&"completed"===Fa.status.toLowerCase()?ha.resolve(!0):Fa.status&&"failed"===Fa.status.toLowerCase()||400<Fa.code||""===Fa.status?ha.reject(Fa):(sa=(sa||500)+250,setTimeout(function(){W._checkStatus(Y,sa,ha)},da))},function(Fa){setTimeout(function(){y["default"].publish("alert/show",{type:"error",text:W.i18n.itemProperties.error.indexFailure});W._showAttributeRulesGrid(W._activeFieldInfo);ha.reject(Fa)},
1E3)});return ha};ua.prototype._generateIndexJsonParameters=function(Y){var da=new x["default"],ka=this._activeFieldInfo,W=this._currentLayerForIndex.indexes,fa={indexes:[]},ha={name:void 0,fields:void 0,isUnique:void 0};if(Y)ha.name=ka.name+"_Index",ha.fields=ka.name,ha.isUnique=!0;else for(Y=0;Y<W.length;Y++)if(W[Y].fields===ka.name){ha.name=W[Y].name;break}fa.indexes[0]=ha;da.resolve(fa);return da};ua.prototype._updateFieldView=function(Y){var da=this,ka=Y.fieldInfo;Y=this.css;var W=this.i18n.itemProperties,
fa=this.i18n.addItemFrm,ha=this.fieldViewTopTitle,sa=this.fieldViewTopTitleTablet,Fa=this.fieldViewFieldType,Ma=this.fieldViewFieldName;this._cleanUpFieldView();this._toggleFieldViewButtons();ha.innerHTML=ka.alias||ka.name;sa.innerHTML=ka.alias||ka.name;Fa.innerHTML=fa.fieldTypes[ka.type]||ka.type;Ma.innerHTML=ka.name;w["default"].create("div",{className:Y.loader},this.fieldViewSummaryContainer);this._getFieldStatistics(ka).then(function(Oa){da._cleanUpSummaryNode();var Ra=Oa.statistics,Da=Oa.histogram;
Oa=Oa.uniqueValueInfos;"esriFieldTypeDate"===ka.type?Da&&(null===Ra||void 0===Ra?0:Ra.count)?da._generateHistogram(ka,Da,Ra):(null===Oa||void 0===Oa?0:Oa.length)?da._generateUniqueValuesGrid(ka,Oa):da.fieldViewSummaryContainer.innerHTML=oa["default"].widgets.FeatureTable.noData:Ra&&Da?Ra.count?da._generateHistogram(ka,Da,Ra):da.fieldViewSummaryContainer.innerHTML=oa["default"].widgets.FeatureTable.noData:(null===Oa||void 0===Oa?0:Oa.length)?da._generateUniqueValuesGrid(ka,Oa):da.fieldViewSummaryContainer.innerHTML=
W.error.noFieldInfo}).otherwise(function(){da._cleanUpSummaryNode();da.fieldViewSummaryContainer.innerHTML=W.error.noFieldInfo});this._showAttributeRulesGrid(ka)};ua.prototype._hideFieldView=function(){var Y=this.table,da=this._columnPickerButton,ka=this.css;this._cleanUpFieldView();t["default"].add(this.fieldViewContainer,ka.hide);t["default"].add(this.fieldViewTop,ka.hide);t["default"].add(this.calculateFieldButton,ka.hide);t["default"].add(this.deleteFieldButton,ka.hide);f["default"](".index-form").addClass("hide");
f["default"](".edit-index").addClass("hide");t["default"].remove(n["default"].byId("grid"),[ka.column5,ka.tabletColumn12]);Y._removeButtonNode(da);Y._growGrid({grid:Y._grid});this._fieldViewEvents.forEach(function(W){W.remove()});this._fieldViewEvents=[];this._activeFieldInfo=null;this._fieldViewActive=!1;this._columnPickerButton=null};ua.prototype._cleanUpSummaryNode=function(){for(var Y=this.fieldViewSummaryContainer;Y.firstChild;)Y.removeChild(Y.firstChild);Y.innerHTML=""};ua.prototype._cleanUpFieldView=
function(){this._cleanUpSummaryNode();this._fieldRulesTable&&this._fieldRulesTable.destroy();this._fieldValuesTable&&this._fieldValuesTable.destroy();this._histogram&&this._histogram.destroy()};ua.prototype._getUniqueValuesData=function(Y){var da;if("esriFieldTypeDate"===Y.type||"esriFieldTypeString"===Y.type&&!this.item.isHostedService&&!this._isHostedServiceLayer(this.item)||-1!==G["default"].numericFieldTypes.indexOf(Y.type))return this.layer.statisticsPlugin.getUniqueValues({field:Y.name,resultRecordCount:10}).then(function(sa){sa=
sa.uniqueValueInfos||[];sa.sort(function(Fa,Ma){return parseFloat(Ma.count)-parseFloat(Fa.count)});return sa=sa.slice(0,10)}).otherwise(function(){return[]});var ka=new x["default"],W=new N["default"](this.layer.url),fa=new J["default"];fa.onStatisticField="*";fa.outStatisticFieldName="countOFExpr";fa.statisticType="count";var ha=new V["default"];ha.returnGeometry=!1;ha.outStatistics=[fa];(null===(da=this.layer.advancedQueryCapabilities)||void 0===da?0:da.supportsOrderByOnlyOnLayerFields)?(ha.outFields=
["*"],ha.groupByFieldsForStatistics=[Y.name]):(ha.orderByFields=["count(*) desc"],ha.groupByFieldsForStatistics=["CASE WHEN "+Y.name+" is null THEN '\x3cNULL RESULT\x3e' ELSE "+Y.name+" END"]);ha.start=0;W.execute(ha).then(function(sa){sa=sa.features;null!==sa&&void 0!==sa&&sa.length?ka.resolve(sa.map(function(Fa){return{value:Fa.attributes.EXPR_1,count:Fa.attributes.countOFExpr}})):ka.resolve([])}).otherwise(function(sa){ka.reject(sa)});return ka};ua.prototype._getFieldStatisticsData=function(Y){return this.layer.statisticsPlugin.getFieldStatistics({field:Y.name})};
ua.prototype._getHistogramData=function(Y,da,ka){var W;Y={field:Y.name,numBins:100<(null===(W=this.table)||void 0===W?void 0:W.featureCount)?30:10,minValue:void 0,maxValue:void 0};isNaN(da)||isNaN(ka)||(Y.minValue=da,Y.maxValue=ka);return this.layer.statisticsPlugin.getHistogram(Y)};ua.prototype._getFieldStatistics=function(Y){var da=this,ka=new x["default"];this.layer.addPlugin("esri/plugins/FeatureLayerStatistics").then(function(){var W="esriFieldTypeString esriFieldTypeOID esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeDate esriFieldTypeGUID esriFieldTypeRaster esriFieldTypeBlob esriFieldTypeGeometry esriFieldTypeXML".split(" ");
Y.name===da.layer.objectIdField||-1!==W.indexOf(Y.type)||Y.typeId||Y.domain&&Y.domain.codedValues?"esriFieldTypeDate"===Y.type&&(da.item.isHostedService||da._isHostedServiceLayer(da.item))?da._getFieldStatisticsData(Y).then(function(fa){if(fa){var ha=da.layer.statisticsPlugin.getSuggestedDataRange({statistics:fa,isDate:!0});ha.defaultStatistics&&(fa.min=ha.min,fa.max=ha.max);da._getHistogramData(Y,ha.min,ha.max).then(function(sa){ka.resolve({histogram:sa,statistics:fa})}).otherwise(function(){ka.resolve({})})}else ka.resolve({})}).otherwise(function(){ka.resolve({})}):
da._getUniqueValuesData(Y).then(function(fa){ka.resolve({uniqueValueInfos:fa})}).otherwise(function(){ka.resolve({})}):v["default"]([da._getFieldStatisticsData(Y),da._getHistogramData(Y)]).then(function(fa){ka.resolve({statistics:fa[0]||null,histogram:fa[1]||null})}).otherwise(function(){ka.resolve({})})});return ka};ua.prototype._generateHistogram=function(Y,da,ka){this._histogram&&(this._histogram.destroy(),this._histogram=null);var W=w["default"].create("div",{className:this.css.histogram},this.fieldViewSummaryContainer);
this._histogram=new R["default"]({data:da,statistics:ka,isDate:"esriFieldTypeDate"===Y.type},W);this._histogram.startup()};ua.prototype._generateUniqueValuesGrid=function(Y,da){var ka=this,W=this.i18n.itemProperties;this._fieldValuesTable&&(this._fieldValuesTable.destroy(),this._fieldValuesTable=null);var fa=da.map(function(sa){var Fa;if("esriFieldTypeDate"===Y.type&&""!==sa.value&&null!==sa.value)sa.value=G["default"].formatDateForLocale({dateOptions:ka.table.dateOptions,timestamp:sa.value,fieldInfo:Y});
else if(Y.typeId){var Ma=-1!==G["default"].numericFieldTypes.indexOf(Y.type),Oa=ka.table.layerInfo.types,Ra=null;if(null===(Fa=null===Oa||void 0===Oa?void 0:Oa[0])||void 0===Fa?0:Fa.id)Ra="string"===typeof Oa[0].id&&Ma?G["default"].findFirst(Oa,"id",sa.value.toString()):G["default"].findFirst(Oa,"id",sa.value);sa.value=(null===Ra||void 0===Ra?0:Ra.name)?Ra.name:(null===Ra||void 0===Ra?0:Ra.id)?Ra.id:null}else Y.domain&&Y.domain.codedValues&&(Fa=G["default"].findFirst(Y.domain.codedValues,"code",sa.value),
sa.value=Fa?Fa.name:null);if(""===sa.value||null===sa.value||"\x3cNULL RESULT\x3e"===sa.value)sa.value=W.nullFieldValue;return sa},this),ha=w["default"].create("div",{className:this.css.uniqueValueGrid},this.fieldViewSummaryContainer);this._fieldValuesTable=new u["default"]({columns:[{field:"value",label:9<da.length?W.top10Values:W.topValues},{field:"count",label:W.fieldCount}]},ha);this._fieldValuesTable.renderArray(fa)};ua.prototype._showAttributeRulesGrid=function(Y){var da=this,ka=this.i18n.itemProperties,
W=this.i18n.common,fa=[[this.i18n.attributeFieldDetails.nullable+":",Y.nullable?W.yesLabel:W.noLabel],[ka.editable,Y.editable?W.yesLabel:W.noLabel],[ka.length,(null===Y||void 0===Y?void 0:Y.length)||ka.none]];Y.domain&&"range"===Y.domain.type&&fa.push([ka.minMaxValue,Y.domain.minValue+" - "+Y.domain.maxValue]);if("Feature Service"===this.item.type){this._currentLayerForIndex=this.layer;this._currentFieldHasIndex=!1;for(ka=0;ka<this._currentLayerForIndex.indexes.length;ka++)if(this._currentLayerForIndex.indexes[ka].fields===
Y.name&&this._currentLayerForIndex.indexes[ka].isUnique){this._currentFieldHasIndex=!0;break}ka=this._currentFieldHasIndex?W.yesLabel:W.noLabel;this._canEditUniqueIndex(Y)?fa.push([this.i18n.itemProperties.uniqueLabel,"\x3clabel class\x3d'change-index-text'\x3e"+ka+"\x3c/label\x3e\x3cbutton class\x3d'btn-link btn-link-darker-gray icon-ui-edit font-size--3 edit-index right'\x3e"+W.edit+"\x3c/button\x3e"]):fa.push([this.i18n.itemProperties.uniqueLabel,ka]);this._clearTableAndCreateNewOne(fa);Y=f["default"](".edit-index",
this.domNode).on("click",function(ha){r["default"].stop(ha);f["default"](".index-form").removeClass("hide");f["default"](".edit-index").addClass("hide");f["default"](".index-form-submit",da.domNode).attr("disabled","true");da._currentFieldHasIndex?da.domNode.querySelector(".unique-index-checkbox").checked=!0:da.domNode.querySelector(".unique-index-checkbox").checked=!1});this._fieldViewEvents.push(Y)}else this._clearTableAndCreateNewOne(fa)};ua.prototype._clearTableAndCreateNewOne=function(Y){for(var da=
this.domNode.querySelector(".settingsTable");0<da.rows.length;)da.deleteRow(0);Y.reduce(function(ka,W){var fa=da.insertRow(da.rows.length),ha=fa.insertCell(0);fa=fa.insertCell(1);ha.innerHTML=W[0];fa.innerHTML=W[1]},"")};ua.prototype._toggleFieldViewButtons=function(){var Y=this._activeFieldInfo,da=this.css,ka=this.calculateFieldButton,W=this.deleteFieldButton;this._canCalculateField(Y)?t["default"].remove(ka,da.hide):t["default"].add(ka,da.hide);this._canDeleteField(Y)?t["default"].remove(W,da.hide):
t["default"].add(W,da.hide)};ua.prototype._showAppendDataDialog=function(Y){var da=this.layer;da=l["default"].isDefined(da.id)?da.id:l["default"].isDefined(da.layerId)?da.layerId:null;T["default"].appendData({evt:Y,item:this.item,layerId:da,page:this.page})};ua.prototype._showAddFieldDialog=function(){var Y=this.layer,da=Y.id||Y.layerId||0,ka=new Z["default"]({css:{},layer:Y}),W=this._hasPopupInfo(Y)?this._getPopupInfo(Y):null;ka.show({mapLayer:{layer:Y,itemCard:this.item,itemId:this.item.id,popupInfo:W,
url:this.item.url+"/"+da},subLayerId:da,layer:Y,table:this})};ua.prototype._showCalculateWithOptionsDialog=function(Y){var da=new wa["default"];da.startup(Y);da.showModal("true");this.calculateWithOptionsDlg=da;this._setUpCalculateWithOptionsDlgEvents();g["default"].once(da,"hide",function(ka){da.destroyRecursive()})};ua.prototype._setUpCalculateWithOptionsDlgEvents=function(){this.calculateWithOptionsDlg.own(y["default"].subscribe("calculateWithOptionsDlg/arcade",this._showArcadeCalculatorDialog.bind(this)),
y["default"].subscribe("calculateWithOptionsDlg/sql",this._showCalculateFieldDialog.bind(this)))};ua.prototype._showArcadeCalculatorDialog=function(Y){var da=new Ea["default"]({item:this.item,layer:this.layer,fieldInfo:Y,whereClause:this.layer.getDefinitionExpression()});da.showModal("true");g["default"].once(da,"hide",function(ka){da.destroyRecursive()})};ua.prototype._showCalculateFieldDialog=function(Y){var da=this,ka=this.layer,W=this.table,fa=this.css;Y=Y||this._activeFieldInfo;var ha=this._calcField,
sa=this._calcDialog;ha&&sa?(ha.reset(),ha.set({layer:ka,field:Y.name}),sa.show()):(ha=new D["default"]({layer:ka,field:Y.name,css:{closeButton:fa.calcCloseButton,clearIcon:fa.calcClearIcon,validateIcon:fa.calcValidateIcon},showHeader:!1},w["default"].create("div")),ha.startup(),sa=I["default"].generateDialog({title:oa["default"].calculateFields.calculateField,content:ha,css:{dialog:fa.calcFieldDialog}}),ha.on("calculate-success",function(Fa){da._updateLayerDataUpdatedDate();da._fieldViewActive&&da._updateFieldView({fieldInfo:da._activeFieldInfo});
W.refresh()}),ha.on("close",function(){sa.hide()}),this._calcDialog=sa,this._calcField=ha);sa.show()};ua.prototype._showDeleteMultipleFieldDialog=function(Y){var da=this,ka=Q["default"].createSpecifiedDialog(aa["default"]),W=this.i18n.deleteWarningDlg.deleteWarningDlgTitle;if(Y){var fa=h["default"].substitute(this.i18n.deleteWarningDlg.confirmDeleteMultipleFields,[Y.length]);ka.showMsgTitleButton(fa,W,W,function(){da._deleteField(null,Y)})}};ua.prototype._showDeleteFieldDialog=function(Y){var da=
this,ka=Y||this._activeFieldInfo;Y=Q["default"].createSpecifiedDialog(aa["default"]);var W=oa["default"].calculateFields.deleteField;if(ka){var fa=h["default"].substitute(oa["default"].calculateFields.deleteFieldConfirm,{field:ka.alias||ka.name});Y.showMsgTitleButton(fa,W,W,function(){da._deleteField(ka)})}};ua.prototype._deleteField=function(Y,da){var ka=this,W=this.layer,fa=this.item,ha={f:"json",token:void 0,deleteFromDefinition:void 0},sa=W.url.replace("/rest/services","/rest/admin/services")+
"/deleteFromDefinition",Fa=H["default"].getToken(),Ma=[],Oa;Fa&&(ha.token=Fa);da?da.forEach(function(Da){Ma.push({name:Da.name})}):Ma.push({name:Y.name});ha.deleteFromDefinition=a["default"].toJson({fields:Ma});var Ra=ea["default"].prototype.statics.getInstance();Ra.show({title:this.i18n.common.save,message:h["default"].substitute(this.i18n.viewer.mapUtil.savingProps,{title:fa.title}),reference:"updateFeatureService"});p["default"]({url:sa,content:ha},{usePost:!0}).then(function(Da){p["default"]({url:W.url,
content:{f:"json"},callbackParamName:"callback"}).then(function(E){var S;ka.item.set("maxAgeCheck",!0);W.fields=E.fields;ka._fieldViewActive&&ka._hideFieldView();var ia=ka._hasPopupInfo(W);ia&&(Oa=ka._getPopupInfo(W),da?da.forEach(function(na){Oa.fieldInfos=Oa.fieldInfos.filter(function(qa){return qa.fieldName!==na.name})}):Oa.fieldInfos=Oa.fieldInfos.filter(function(na){return na.fieldName!==Y.name}));-1!==["Feature Layer","Table"].indexOf(W.type)?(E={layer:W,url:ka.item.url,serviceInfo:E,itemCard:fa,
itemId:fa.id,popupInfo:Oa,popupChanged:ia,featureTemplatesChanged:!0},B["default"].updateTypesAndTemplatesOnLayer(E.layer),E.featureTemplatesChanged=!0,(null===(S=E.serviceInfo.templates)||void 0===S?0:S.length)?E.serviceInfo.templates.forEach(function(na){da?da.forEach(function(qa){delete na.prototype.attributes[qa.name]}):delete na.prototype.attributes[Y.name]}):E.serviceInfo.types.forEach(function(na){na.templates.forEach(function(qa){da?da.forEach(function(xa){delete qa.prototype.attributes[xa.name]}):
delete qa.prototype.attributes[Y.name]})}),A["default"].updateFeatureServiceAfterAddRemoveField(E,ka._reloadTable.bind(ka))):(ka._reloadTable(),Ra.hide("updateFeatureService"))},function(E){ka._showError({message:E.toString()})})},function(Da){ka._showError({message:Da.toString()})})};ua.prototype._canEditData=function(){var Y,da=this.item,ka=this.portalUser;ka=(null===(Y=da.serviceInfo)||void 0===Y?void 0:Y.capabilities)&&-1!==da.serviceInfo.capabilities.indexOf("Editing")&&-1!==da.serviceInfo.capabilities.indexOf("Update")&&
(!ka||!(null===ka||void 0===ka?0:ka.isOrgUser)||(null===ka||void 0===ka?void 0:ka.userRole)&&(da.isHostedService?ka.userRole.canEditFeaturesFullControl()||ka.userRole.canEditFeatures():ka.userRole.canEditFeatures()));return da.isHostedService?da.canUpdate||ka:ka};ua.prototype._canAddField=function(){var Y,da,ka=this.layer,W=this.item,fa=this._userIsOwner||this._userIsAdmin&&W.isOwnedByMyOrg;ka="Feature Layer"===ka.type||"Table"===ka.type;var ha=W.isFeatureCollection,sa=0<(null===(Y=W.relTileLayers)||
void 0===Y?void 0:Y.length);Y=W.isMultipatchFeatureService;var Fa=!1!==(null===(da=W.serviceInfo)||void 0===da?void 0:da.sourceSchemaChangesAllowed);return fa&&ka&&!ha&&!this._isViewServiceLayer(W)&&!this.item.isLocationTrackingService&&!sa&&this._isHostedServiceLayer(W)&&!Y&&Fa};ua.prototype._canCalculateField=function(Y){var da=this.layer,ka=this.item,W=this._userIsOwner||this._userIsAdmin&&ka.isOwnedByMyOrg,fa="Feature Layer"===da.type||"Table"===da.type,ha=ka.isFeatureCollection,sa=ka.relTileLayers&&
0<ka.relTileLayers.length;Y=Y.editable&&-1===this._uneditableFieldTypes.indexOf(Y.type);var Fa=this._isSpatioTemporalService(ka);return W&&da.supportsCalculate&&fa&&!ha&&Y&&!sa&&this._isHostedServiceLayer(ka)&&!Fa};ua.prototype._canArcadeCalculateField=function(Y){var da,ka,W;this._serviceInfo=(null===(da=this.item)||void 0===da?void 0:da.serviceInfo)||{};this._adminServiceInfo=(null===(ka=this.item)||void 0===ka?void 0:ka.adminServiceInfo)||{};this._capabilities=(null===(W=this.item)||void 0===W?
0:W.isPortal)&&!this.item.isSDS?ma["default"].stringToArray(this._serviceInfo.capabilities,",",!0):ma["default"].stringToArray(this._adminServiceInfo.capabilities||"",",",!0);this._changeTrackingEnabled=ba["default"].includes(this._capabilities,"ChangeTracking");da=ba["default"].includes(this._capabilities,"Uploads");da=!this.page.portal.isPortal||da;this._syncEnabled=this._serviceInfo.syncEnabled||!1;return this._canCalculateField(Y)&&!this._syncEnabled&&!this._changeTrackingEnabled&&da};ua.prototype._canEditUniqueIndex=
function(Y){Y=Y.editable&&-1===this._uneditableFieldTypes.indexOf(Y.type);return this._isHostedServiceLayer(this.item)&&!this.page.portal.isPortal&&!this._isViewServiceLayer(this.item)&&!this.item.isLocationTrackingService&&Y&&(this._userIsOwner||this._userIsAdmin)};ua.prototype._canDeleteField=function(Y){var da=this.page.portal.isPortal&&this._isSpatioTemporalService(this.item);return this._canDeleteOrEditableField(Y)&&!this._isViewServiceLayer(this.item)&&!da};ua.prototype._canFieldEditableProp=
function(Y){return this._canDeleteOrEditableField(Y)?Y.nullable?!0:Y.defaultValue?!0:!1:!1};ua.prototype._canDeleteOrEditableField=function(Y){var da,ka,W,fa=this.layer,ha=this.item,sa=this._userIsOwner||this._userIsAdmin&&ha.isOwnedByMyOrg,Fa=0<(null===(da=ha.relTileLayers)||void 0===da?void 0:da.length);da=!0;-1!==this._uneditableFieldTypes.indexOf(Y.type)?da=!1:fa.objectIdField===Y.name||fa.displayField===Y.name?da=!1:!fa.renderer||fa.renderer.attributeField!==Y.name&&fa.renderer.normalizationField!==
Y.name?!fa.timeInfo||fa.timeInfo.startTimeField!==Y.name&&fa.timeInfo.endTimeField!==Y.name&&fa.timeInfo.trackIdField!==Y.name?!fa.editFieldsInfo||fa.editFieldsInfo.creationDateField!==Y.name&&fa.editFieldsInfo.creatorField!==Y.name&&fa.editFieldsInfo.editDateField!==Y.name&&fa.editFieldsInfo.editorField!==Y.name?fa.getDefinitionExpression()&&-1!==fa.getDefinitionExpression().search(Y.name)?da=!1:Fa?da=!1:0<(null===(ka=fa.labelingInfo)||void 0===ka?void 0:ka.length)&&(da=!this._isUsedByLabel({fieldInfo:Y,
labelingInfo:fa.labelingInfo})):da=!1:da=!1:da=!1;if("Feature Layer"!==fa.type&&"Table"!==fa.type||this.item.isLocationTrackingService||ha.isFeatureCollection||!this._isHostedServiceLayer(ha))da=!1;!1===(null===(W=ha.serviceInfo)||void 0===W?void 0:W.sourceSchemaChangesAllowed)&&(da=!1);return sa&&da};ua.prototype._isUsedByLabel=function(Y){var da=Y.fieldInfo,ka=!1;Y.labelingInfo.forEach(function(W){var fa,ha;if(W){var sa=Ha["default"].extractFieldNames(null===(fa=W.labelExpressionInfo)||void 0===
fa?void 0:fa.expression);fa=Ha["default"].extractFieldNames(null===(ha=W.labelExpressionInfo)||void 0===ha?void 0:ha.value);W=Ha["default"].extractFieldNames(W.labelExpression);if(-1<sa.indexOf(da.name)||-1<fa.indexOf(da.name)||-1<W.indexOf(da.name))ka=!0}});return ka};ua.prototype.refreshTable=function(){this._reloadTable()};ua.prototype.getPopupInfo=function(Y){return this._getPopupInfo(Y.layer)};ua.prototype._hasPopupInfo=function(Y){var da=Y.id||Y.layerId||0,ka=!1;this.layerInfos.forEach(function(W){W.id===
da&&W.popupInfo&&(ka=!0)});return ka};ua.prototype._getPopupInfo=function(Y){var da=Y.id||Y.layerId||0,ka=null;this.layerInfos.filter(function(W){W.id===da&&(ka=W.popupInfo)});return ka||M["default"].getPopupInfo(Y)};ua.prototype.getDefaultPopupInfo=function(Y){return M["default"]._getDefaultPopupInfo(Y)};ua.prototype._updateItemData=function(){var Y=this,da=new x["default"];this._hasPopupInfo(this.layer)?H["default"].request({url:this.item.itemDataUrl}).then(function(ka){Y.item.itemData=ka;Y.layerInfos=
ka.layers;da.resolve()}):da.resolve();return da};return ua=q.__decorate([za["default"](C["default"],z["default"],b["default"])],ua)}()})},"esri/dijit/CalculateField":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/_base/kernel dojo/_base/fx dojo/has dojo/json dojo/string dojo/dom-style dojo/dom-attr dojo/dom-construct dojo/query dojo/dom-class dojo/_base/event dojo/Evented dojo/fx/easing dojo/store/Memory dojo/mouse dojo/on dojo/topic dojo/_base/window dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_OnDijitClickMixin dijit/_FocusMixin dijit/registry dijit/form/Button dijit/form/CheckBox dijit/form/Form dijit/form/Select dijit/form/MultiSelect dijit/form/TextBox dijit/form/SimpleTextarea dijit/form/ValidationTextBox dijit/layout/ContentPane dijit/form/ComboBox dijit/Dialog dijit/Tooltip dgrid/OnDemandList dgrid/Selection dgrid/Keyboard dgrid/extensions/DijitRegistry dgrid/util/mouse put-selector/put ../kernel ../lang ../request ./SingleFilter ./ExpressionEditor dojo/i18n!../nls/jsapi dojo/text!./templates/CalculateField.html".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D,K,G,I,R,A,B,H,T,M,L,X,ba,ma,ta,Ea,wa,Q,Z,aa,ea,oa,ra,za,ya,Ha,ua){var Y=e([ta,wa,Ea,Q]),da={base:"esriCalcField",titleLabel:"esriCalcTitleLabel",selectField:"esriCalcSelField",expressionBox:"esriExprBox",actionBtnContainer:"esriActionButtonCtr",validateIcon:"esriCalcFieldValidateIcon",validateDisabledIcon:"esriCalcFieldValidateDisabledIcon",actionButton:"esriActionButton",clearIcon:"esriCalcFieldClearIcon",clearDisabledIcon:"esriCalcFieldClearDisabledIcon",
fieldFunctionContainer:"esriCalcFieldFuncCtr",fieldContainer:"esriCalcFieldCtr",functionContainer:"esriCalcFuncCtr",fieldLabelDiv:"esriFieldsLabelDiv",functionLabelDiv:"esriFunctionLabelDiv",fieldListContainer:"esriCalcFieldsList",functionListContainer:"esriCalcFunctionList",fieldTypeContainer:"esriFieldsSelectionCtr",loadingIcon:"esriLoadingLarge",formWarning:"esriFormWarning",formSuccess:"esriFormSuccess",addButton:"",closeButton:"",actionDividerLine:"esriActionDividerLine",titleDividerLine:"esriTitleDivideLine",
actionCtr:"esriCalcFieldActionCtr"},ka=e([O,V,N,J,D,w],{declaredClass:"esri.dijit.CalculateField",templateString:ua,widgetsInTemplate:!0,showSelectField:!1,showHeader:!0,closeOnAdd:!0,addButtonClass:"",closeButtonClass:"",_showMsgTimerInterval:3E3,showHelp:!1,expressionBoxRows:4,expressionBoxCols:2,baseClass:da.base,constructor:function(W){W.containerNode&&(this.container=W.containerNode);this._css=U.mixin(da,W.css);this.expressionMode=oa.isDefined(W.expressionMode)?W.expressionMode:ka.MODE_SQL;this.fieldId=
W.fieldId;this.arcadeProfile=W.arcadeProfile;this.arcadeProfileType=W.arcadeProfileType},destroy:function(){this.inherited(arguments)},postMixInProperties:function(){this.inherited(arguments);this.i18n={};U.mixin(this.i18n,Ha.common);U.mixin(this.i18n,Ha.calculateFields);this.calculateLabel||(this.calculateLabel=this.i18n.calculate)},postCreate:function(){this.inherited(arguments);if(this.expressionMode===ka.MODE_ARCADE)this._loadArcadeUIEvents(),this._buildArcadeEditorUI();else{var W=["ar","he"],
fa;for(fa=0;fa<W.length;fa+=1){var ha=W[fa];p.locale&&-1!==p.locale.indexOf(ha)&&(-1!==p.locale.indexOf("-")?-1!==p.locale.indexOf(ha+"-")&&(this._isRightToLeft=!0):this._isRightToLeft=!0)}this._buildUI();this._loadEvents();this.onlineHelpMap={};h.set(this._helpNode,"display",this.showHelp?"block":"none");this.helpUrl&&f.set(this._helpurlNode,"href",this.helpUrl);this.validate()}},_loadArcadeUIEvents:function(){U.mixin(this.i18n,Ha.expressionEditor);this.own(this.watch("layer",U.hitch(this,this._buildArcadeEditorUI)))},
_deleteArcadeEditorUI:function(){this.expressionEditor&&this._destroyArcadeUI()},_buildArcadeEditorUI:function(){this._deleteArcadeEditorUI();var W=this.expressionMode===ka.MODE_ARCADE;h.set(this._expressionForm,"display",W?"none":"block");h.set(this._headerPane.domNode,"display",W?"none":"block");h.set(this._arcadeExpressionEditorDlg,"display",W?"block":"none");this.expressionEditorCommitHandler=C.subscribe("expression-commit",U.hitch(this,function(fa){this.set("expression",fa.expression);this.emit("expression-add",
fa);this._close()}));this.expressionEditorCancelHandler=C.subscribe("expression-cancel",U.hitch(this,function(){this._close()}));oa.isDefined(this.fieldId)||(this.fieldId="$feature");this.expressionEditor=new ya({arcadeEditor:this.arcadeEditor,map:this.map,mapLayer:{layer:this.layer,popupInfo:this.layer.infoTemplate?this.layer.infoTemplate.toJson():null},layer:this.layer,expression:this.get("expression"),captureTitle:!1,fieldId:this.fieldId,arcadeProfile:this.arcadeProfile,arcadeProfileType:this.arcadeProfileType,
showViewScale:!1},g.create("div",null,this._arcadeExpressionEditorDlg));this.expressionEditor.startup();this.own(this.watch("arcadeProfile",U.hitch(this,function(){this.expressionEditor.set("arcadeProfile",this.get("arcadeProfile"))})))},_destroyArcadeUI:function(){this.expressionEditorCommitHandler&&this.expressionEditorCommitHandler.remove();this.expressionEditorCommitHandler=null;this.expressionEditorCancelHandler&&this.expressionEditorCancelHandler.remove();this.expressionEditorCancelHandler=
null;this.expressionEditor&&this.expressionEditor.destroy();this.expressionEditor=null;this.expression&&(this.expression=null)},_buildUI:function(){var W=[];h.set(this._header,"display",this.showHeader?"block":"none");h.set(this._selCalcFieldDiv,"display",this.showSelectField?"block":"none");if(this.field){var fa=q.filter(this.layer.fields,function(ha){return ha.name===this.field},this);this._calcField=fa=fa[0];f.set(this._calcFieldLabel,"innerHTML",d.substitute(this.i18n.exprLabel,{fieldName:fa?
fa.name:this.field}))}if(!this.helperMethods||this.helperMethods&&0===this.helperMethods.length)fa=this._labelFormatter.bind(this),fa=[{type:"NumType",label:fa({functionName:"ABS(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.absFunc,functionParams:[{name:"number",label:this.i18n.commonNumberParamDesc}]}),name:"ABS()"},{type:"NumType",label:fa({functionName:"CAST(\x3ci\x3eexpression\x3c/i\x3e AS FLOAT|INT)",functionDesc:this.i18n.castFunc,functionParams:[{name:"expression",label:this.i18n.castParam1Desc},
{name:"FLOAT",label:this.i18n.castParam2Desc},{name:"INT",label:this.i18n.castParam3Desc}]}),name:"CAST()"},{type:"NumType",label:fa({functionName:"CEILING(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.ceilingFunc,functionParams:[{name:"number",label:this.i18n.ceilingParamDesc}]}),name:"CEILING()"},{type:"NumType",label:fa({functionName:"COS(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.cosFunc,functionParams:[{name:"number",label:this.i18n.trignomParamDesc}]}),name:"COS()"},{type:"NumType",
label:fa({functionName:"FLOOR(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.floorFunc,functionParams:[{name:"number",label:this.i18n.floorParamDesc}]}),name:"FLOOR()"},{type:"NumType",label:fa({functionName:"LOG(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.logFunc,functionParams:[{name:"number",label:this.i18n.commonNumberParamDesc}]}),name:"LOG()"},{type:"NumType",label:fa({functionName:"LOG10(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.log10Func,functionParams:[{name:"number",
label:this.i18n.commonNumberParamDesc}]}),name:"LOG10()"},{type:"NumType",label:fa({functionName:"MOD(\x3ci\x3enumber\x3c/i\x3e, \x3ci\x3en\x3c/i\x3e)",functionDesc:this.i18n.modFunc,functionParams:[{name:"number",label:this.i18n.modParam1Desc},{name:"n",label:this.i18n.modParam2Desc}]}),name:"MOD(,)"},{type:"NumType",label:fa({functionName:"NULLIF(\x3ci\x3enumber\x3c/i\x3e,\x3ci\x3evalue\x3c/i\x3e)",functionDesc:this.i18n.nullifFunc,functionParams:[{name:"number",label:this.i18n.commonNumberParamDesc},
{name:"value",label:this.i18n.commonNumberParamDesc}]}),name:"NULLIF(,)"},{type:"NumType",label:fa({functionName:"POWER(\x3ci\x3enumber\x3c/i\x3e, \x3ci\x3ey\x3c/i\x3e)",functionDesc:this.i18n.powerFunc,functionParams:[{name:"number",label:this.i18n.powerParam1Desc},{name:"y",label:this.i18n.powerParam2Desc}]}),name:"POWER(,)"},{type:"NumType",label:fa({functionName:"ROUND(\x3ci\x3enumber\x3c/i\x3e, \x3ci\x3elength\x3c/i\x3e)",functionDesc:this.i18n.roundFunc,functionParams:[{name:"number",label:this.i18n.roundParam1Desc},
{name:"length",label:this.i18n.roundParam2Desc}]}),name:"ROUND(,)"},{type:"NumType",label:fa({functionName:"SIN(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.sinFunc,functionParams:[{name:"number",label:this.i18n.trignomParamDesc}]}),name:"SIN()"},{type:"NumType",label:fa({functionName:"TAN(\x3ci\x3enumber\x3c/i\x3e)",functionDesc:this.i18n.tanFunc,functionParams:[{name:"number",label:this.i18n.trignomParamDesc}]}),name:"TAN()"},{type:"NumType",label:fa({functionName:"TRUNCATE(\x3ci\x3enumber\x3c/i\x3e, \x3ci\x3edecimal_place\x3c/i\x3e)",
functionDesc:this.i18n.truncateFunc,functionParams:[{name:"number",label:this.i18n.truncateParam1Desc},{name:"decimal_place",label:this.i18n.truncateParam2Desc}]}),name:"TRUNCATE(,)"},{type:"StrType",label:fa({functionName:"CHAR_LENGTH(\x3ci\x3estring\x3c/i\x3e)",functionDesc:this.i18n.char_lengthFunc,functionParams:[{name:"string",label:this.i18n.char_lengthParamDesc}]}),name:"CHAR_LENGTH()"},{type:"StrType",label:fa({functionName:"CONCAT(\x3ci\x3estring1\x3c/i\x3e, \x3ci\x3estring2\x3c/i\x3e)",
functionDesc:this.i18n.concatFunc,functionParams:[{name:"string1",label:this.i18n.concatParam1Desc},{name:"string2",label:this.i18n.concatParam2Desc}]}),name:"CONCAT(,)"},{type:"StrType",label:fa({functionName:"POSITION(\x3ci\x3esubstring\x3c/i\x3e, \x3ci\x3estring\x3c/i\x3e)",functionDesc:this.i18n.positionFunc,functionParams:[{name:"substring",label:this.i18n.positionParam1Desc},{name:"string",label:this.i18n.positionParam2Desc}]}),name:"POSITION(,)"},{type:"StrType",label:fa({functionName:"LOWER(\x3ci\x3estring\x3c/i\x3e)",
functionDesc:this.i18n.lowerFunc,functionParams:[{name:"string",label:this.i18n.lowerParamDesc}]}),name:"LOWER()"},{type:"StrType",label:fa({functionName:"SUBSTRING(\x3ci\x3estring\x3c/i\x3e, \x3ci\x3estart\x3c/i\x3e, \x3ci\x3elength\x3c/i\x3e)",functionDesc:this.i18n.substringFunc,functionParams:[{name:"string",label:this.i18n.substrParam1Desc},{name:"start",label:this.i18n.substrParam2Desc},{name:"length",label:this.i18n.substrParam3Desc}]}),name:"SUBSTRING(,,)"},{type:"StrType",label:fa({functionName:"TRIM(BOTH|LEADING|TRAILING \u2018 \u2018 FROM string)",
functionDesc:this.i18n.trimFunc,functionParams:[{name:"BOTH",label:this.i18n.trimBothDesc},{name:"LEADING",label:this.i18n.trimLeadingDesc},{name:"TRAILING",label:this.i18n.trimTrailingDesc},{name:"string",label:this.i18n.trimParamDesc}]}),name:"TRIM()"},{type:"StrType",label:fa({functionName:"UPPER(\x3ci\x3estring\x3c/i\x3e)",functionDesc:this.i18n.upperFunc,functionParams:[{name:"string",label:this.i18n.upperParamDesc}]}),name:"UPPER()"},{type:"DateType",label:fa({functionName:"CURRENT_DATE()",
functionDesc:this.i18n.current_dateFunc}),name:"CURRENT_DATE()"},{type:"DateType",label:d.substitute(this.i18n.current_timeFunc,{functionName:"CURRENT_TIME()"}),name:"CURRENT_TIME()"},{type:"DateType",label:d.substitute(this.i18n.current_timestampFunc,{functionName:"CURRENT_TIMESTAMP()"}),name:"CURRENT_TIMESTAMP()"},{type:"DateType",label:fa({functionName:"EXTRACT(unit FROM date)",functionDesc:this.i18n.extractFunc,functionParams:[{name:"unit",label:this.i18n.extractUnitDesc},{name:"date",label:this.i18n.extractDataDesc}]}),
name:"EXTRACT()"}],q.forEach(fa,function(ha){ha.label="\x3cb\x3e"+ha.label.substring(0,ha.label.indexOf(":")+1)+"\x3c/b\x3e\x3cbr/\x3e "+ha.label.substring(ha.label.indexOf(":")+1)},this),this.set("helperMethods",fa);(!this.operators||this.operators&&0===this.operators.length)&&this.set("operators","+-/*()".split(""));this._operatorBtns=[];q.forEach(this.operators,function(ha){this._operatorBtns.push(new G({value:ha,label:ha,style:{width:"4em"},onClick:U.hitch(this,this._updateExpression,{value:ha,
type:"operator"})},g.create("div",null,this._operatorCtr)))},this);this.layer&&this.layer.fields&&0<this.layer.fields.length&&(W=this._createIds(this.layer.fields),fa=q.map(this.layer.fields,function(ha){return{label:ha.name,value:ha.name}}),this._selCalcField.addOption(fa),this._selCalcField.set("value",this.field));this.fieldsStore=new v({data:W});this.attributeList=new Y({renderRow:U.hitch(this,this._renderAttributesRow),selectionMode:"single",store:this.fieldsStore},this._attributeListCtr);W=
this._createIds(this.get("helperMethods"));this.operatorStore=new v({data:W});this.helpersList=new Y({renderRow:U.hitch(this,this._renderOperatorRow),selectionMode:"single",store:this.operatorStore},this._helpersListCtr)},_loadEvents:function(){this.own(this.watch("fields",U.hitch(this,this._handleFieldsChange)),this.watch("field",U.hitch(this,this._handleFieldChange)));this.showSelectField&&this.own(this._selCalcField.on("change",U.hitch(this,this._handleSelcCalFieldChange)));this.own(this._expressionForm.watch("value",
U.hitch(this,this._handleHelperTypeChange)),this._expressionForm.on("focus",U.hitch(this,this._setfocus)),this._exprBox.watch("value",U.hitch(this,this._handleExpChange)),this.attributeList.on("dgrid-select",U.hitch(this,function(W){this._updateExpression({value:W.rows[0].data,type:"field"})})),this.helpersList.on("dgrid-select",U.hitch(this,function(W){this._updateExpression({value:W.rows[0].data,type:"helper"})})),this.attributeList.on(Z.enterRow,U.hitch(this,function(W){W=this.attributeList.row(W);
var fa=W.data.alias||W.data.name;var ha="";ha=this._getTypeLabel(W.data.type);this._showTooltip(W.element,"\x3cb\x3e"+fa+"\x3c/b\x3e: "+ha)})),this.attributeList.on(Z.leaveRow,U.hitch(this,function(W){W=this.attributeList.row(W);this._hideTooltip(W.element)})),this.helpersList.on(Z.enterRow,U.hitch(this,function(W){W=this.helpersList.row(W);this._showTooltip(W.element,W.data.label)})),this.helpersList.on(Z.leaveRow,U.hitch(this,function(W){W=this.helpersList.row(W);this._hideTooltip(W.element)})),
this.attributeList.on("dgrid-refresh-complete",U.hitch(this,this._setfocus)),this.helpersList.on("dgrid-refresh-complete",U.hitch(this,this._setfocus)),this._exprBox.on("blur",U.hitch(this,function(){this._exprBox.textbox.setSelectionRange&&"number"==typeof this._exprBox.textbox.selectionStart?this._exprBox.set("cursorPosition",[this._exprBox.textbox.selectionStart,this._exprBox.textbox.selectionEnd]):this._exprBox.set("cursorPosition",this._getCursorRange(this._exprBox.textbox))})),this._exprBox.on("focus",
U.hitch(this,function(){var W=this._exprBox.get("cursorPosition");W&&(this._exprBox.textbox.setSelectionRange&&"number"==typeof this._exprBox.textbox.selectionStart?this._exprBox.textbox.setSelectionRange(W[1],W[1]):this._setCaretPosition(this._exprBox.textbox,W[1],W[1]))})),y(this._calcFieldLabel,x.enter,U.hitch(this,function(W){W="";W=this._getTypeLabel(this._calcField.type);this._showTooltip(this._calcFieldLabel,"\x3cb\x3e"+this._calcField.alias+"\x3c/b\x3e: "+W)})),y(this._calcFieldLabel,x.leave,
U.hitch(this,function(W){this._hideTooltip(this._calcFieldLabel)})))},startup:function(){this.inherited(arguments);this.expressionMode===ka.MODE_SQL&&(this.attributeList.startup(),this.helpersList.startup(),this.set("helperType",this.helperType))},reset:function(){ea.show(this.domNode);this.expressionMode===ka.MODE_SQL?(this._expressionForm.reset(),this._handleCloseMsg(),this.set("helperType",this.helperType)):this._buildArcadeEditorUI()},_close:function(){this.emit("close",{});ea.hide(this.domNode);
this._deleteArcadeEditorUI()},_createIds:function(W){var fa=[];W&&0<W.length&&(fa=q.map(W,function(ha,sa){return U.mixin(ha,{id:sa})}));return fa},_renderAttributesRow:function(W){var fa=g.create("div",{"class":"esriCalExpRowOuter"}),ha=g.create("div",{"class":"esriCalcExpLabelRow"},fa);g.create("div",{"class":"esriCalcFieldTextTrimWithEllipses",innerHTML:W.name},ha);return fa},_renderOperatorRow:function(W){var fa=g.create("div",{"class":"esriCalExpRowOuter"}),ha=g.create("div",{"class":"esriCalcExpLabelRow"},
fa);g.create("div",{"class":"esriCalcFieldTextTrimWithEllipses",innerHTML:W.name},ha);return fa},_handleFieldsChange:function(W,fa,ha){W=[];this.layer&&this.layer.fields&&0<this.layer.fields.length&&(0<this._selCalcField.getOptions().length&&this._selCalcField.removeOption(this._selCalcField.getOptions()),W=this._createIds(this.layer.fields),fa=q.map(this.layer.fields,function(sa){return{label:sa.name,value:sa.name}}),this._selCalcField.addOption(fa),this._selCalcField.set("value",this.field));this.fieldsStore=
new v({data:W});this.attributeList.set("store",this.fieldsStore)},_handleFieldChange:function(W,fa,ha){f.set(this._calcFieldLabel,"innerHTML",d.substitute(this.i18n.exprLabel,{fieldName:ha}));this.set("helperType",this.helperType);this._setfocus()},_setHelperTypeAttr:function(W){if(W)this.helperType=W;else if(this.field){var fa=q.filter(this.layer.fields,function(ha){return ha.name===this.field},this);(this._calcField=fa=fa[0])&&"esriFieldTypeDate"===fa.type?W="date":fa&&"esriFieldTypeString"===fa.type?
W="string":fa&&-1!==q.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],fa.type)&&(W="numeric")}else W="string";"string"===W?this._strRadioBtn.set("checked",!0):"numeric"===W?this._numRadioBtn.set("checked",!0):"date"===W&&this._dateRadioBtn.set("checked",!0)},_handleHelperTypeChange:function(W,fa,ha){this.helpersList.set("query",{type:ha.functionType});"DateType"===ha.functionType?this.attributeList.set("query",{type:"esriFieldTypeDate"}):"StrType"===
ha.functionType?this.attributeList.set("query",{type:"esriFieldTypeString"}):"NumType"===ha.functionType&&this.attributeList.set("query",function(sa){return-1!==q.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],sa.type)});this.helpersList.refresh();this.attributeList.refresh()},_handleSelcCalFieldChange:function(W){this.set("field",W)},_handleRemoveBtnClick:function(){this._exprBox.set("value","");this._setfocus()},_handleAddButtonClick:function(W){t.stop(W);
var fa={f:"json"},ha;this._exprBox.get("value")?(this._handleCloseMsg(),fa.calcExpression=l.toJson(this.get("expression")),fa.sqlFormat="standard",this.layer.supportsASyncCalculate&&(fa.async=!0),this.layer.getDefinitionExpression&&this.layer.getDefinitionExpression()?fa.where=this.layer.getDefinitionExpression():oa.isDefined(this.layer.definitionExpression)&&""!==this.layer.definitionExpression&&(fa.where=this.layer.definitionExpression),ea.id.getCredential(this.layer.url+"/calculate").then(U.hitch(this,
function(sa){fa.token=sa.token;ha=ra({url:this.layer.url+"/calculate",content:fa},{usePost:!0});this.emit("calculate-start",{calcPromise:ha.promise});this._addBtn.set("disabled",!0);this._showLoading();ha.then(U.hitch(this,function(Fa){this._checkStatus(Fa).then(U.hitch(this,function(Ma){this._addBtn.set("disabled",!1);this._hideLoading();var Oa={};U.mixin(Oa,{calcExpression:l.fromJson(fa.calcExpression)[0].sqlExpression,where:fa.where,sqlFormat:fa.sqlFormat},Ma);this.emit("calculate-success",Oa);
this.layer.refresh();m.toggle(this._errorMessagePane,this._css.formSuccess,!0);this._showMessages(d.substitute(this.i18n.successMsg,{count:Ma.updatedFeatureCount||Ma.recordCount}),!0);this.closeOnAdd&&this._close()}))}),U.hitch(this,this._handleErrorResponse))}),U.hitch(this,this._handleErrorResponse))):this._addBtn.set("disabled",!0)},_checkStatus:function(W,fa,ha){var sa=W&&W.statusUrl,Fa=ha||new F,Ma=fa||500;ha={f:"json"};this.layer.supportsASyncCalculate?ra({url:sa,content:ha},{usePost:!0}).then(U.hitch(this,
function(Oa){Oa=Oa||{status:"completed"};var Ra=Oa.status;Ra&&"completed"===Ra.toLowerCase()?Fa.resolve(Oa):Ra&&"failed"===Ra.toLowerCase()||400<Oa.code||""===Ra?this._handleErrorResponse(Oa):(Ma+=250,setTimeout(U.hitch(this,function(){this._checkStatus(W,Ma,Fa)}),fa))}),U.hitch(this,function(Oa){this._handleErrorResponse(Oa)})):Fa.resolve(W);return Fa},_handleErrorResponse:function(W){this._addBtn.set("disabled",!1);this._hideLoading();this.emit("calculate-error",W);m.toggle(this._errorMessagePane,
this._css.formSuccess,!1);this._showMessages(d.substitute(this.i18n.exprFailedMsg,{expr:this._exprBox.get("value")})+"\x3cbr/\x3e"+(W.details||W.description).toString())},_handleCloseButtonClick:function(W){t.stop(W);this._close()},_showTooltip:function(W,fa){var ha=g.create("label",{innerHTML:fa,className:"esriSmallFont",dir:"ltr"});this._isRightToLeft?ma.show(ha.outerHTML,W,["after"],!0):ma.show(ha.outerHTML,W,["after"])},_hideTooltip:function(W,fa){ma.hide(W)},_setfocus:function(){this._exprBox.focus()},
_showMessages:function(W,fa){f.set(this._bodyNode,"innerHTML",W);r.fadeIn({node:this._errorMessagePane,easing:u.quadIn,onEnd:U.hitch(this,function(){h.set(this._errorMessagePane,{display:""})})}).play();fa&&window.setTimeout(U.hitch(this,this._handleCloseMsg),this._showMsgTimerInterval)},_handleCloseMsg:function(W){W&&W.preventDefault();"none"!==h.get(this._errorMessagePane,"display")&&r.fadeOut({node:this._errorMessagePane,easing:u.quadOut,onEnd:U.hitch(this,function(){h.set(this._errorMessagePane,
{display:"none"})})}).play()},validate:function(){var W=!0;this.layer?this.field?this.layer.supportsCalculate?this.layer.userIsAdmin||this.layer.getEditCapabilities().canUpdate||(d.substitute(this.i18n.lyrUpdateCapMsg,{layername:this.layer.name}),W=!1):(d.substitute(this.i18n.lyrSupportCalMsg,{layername:this.layer.name}),W=!1):W=!1:W=!1;this._addBtn.set("disabled",!W);return W},_validateExpObj:function(W){var fa=!0;W||(fa=!1);fa?this._handleCloseMsg():this._showMessages(void 0);return fa},_updateExpression:function(W){var fa=
this._exprBox.get("cursorPosition"),ha=this._exprBox.get("value"),sa="",Fa=0,Ma;if(this._validateExpObj(W)){this._exprStack||(this._exprStack=[]);0<this._exprStack.length&&(Ma=this._exprStack[this._exprStack.length-1]);fa&&ha||(fa=[0,0]);if("operator"===W.type){var Oa=" "+W.value+" ";Fa=Oa.length}else"helper"===W.type?(Oa=W.value.name,Fa=-1!==W.value.name.indexOf(",")?W.value.name.indexOf(","):W.value.name.length-1):"field"===W.type&&(sa=oa.isDefined(Ma)&&"helper"===Ma.type&&-1!==Ma.value.name.indexOf("MOD")&&
-1!==q.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle"],W.value.type),Ma=oa.isDefined(Ma)&&"helper"===Ma.type&&-1!==Ma.value.name.indexOf("MOD")&&"esriFieldTypeDouble"===W.value.type,Oa=this._calcField&&"esriFieldTypeDouble"===this._calcField.type&&!sa&&-1!==q.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle"],W.value.type)?"CAST("+W.value.name+" AS FLOAT)":this._calcField&&-1!==q.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger",
"esriFieldTypeSingle"],this._calcField.type)&&Ma?"CAST("+W.value.name+" AS INT)":W.value.name,Fa=Oa.length+1);sa=ha.substring(0,fa[0])+Oa+ha.substring(fa[1]);this._exprBox.set("value",sa);this._exprBox.focus();this._exprBox.textbox.setSelectionRange&&"number"==typeof this._exprBox.textbox.selectionStart?(this._exprBox.textbox.setSelectionRange(fa[0]+Fa,fa[0]+Fa),this._exprBox.set("cursorPosition",[fa[0]+Fa,fa[0]+Fa])):(this._setCaretPosition(this._exprBox.textbox,fa[0]+Fa,fa[0]+Fa),this._exprBox.set("cursorPosition",
this._getCursorRange(this._exprBox.textbox)));this._setfocus();this._exprStack.push(W)}},_setCaretPosition:function(W,fa,ha){W.setSelectionRange&&"number"==typeof W.selectionStart?W.setSelectionRange(fa,ha):"undefined"!=typeof W.createTextRange&&(W=W.createTextRange(),W.collapse(!0),W.moveEnd("character",ha),W.moveStart("character",fa),W.select())},_getCaretPosition:function(W){var fa=0;if(z.doc.selection)W.focus(),fa=z.doc.selection.createRange(),fa.moveStart("character",-W.value.length),fa=fa.text.length;
else if(W.selectionStart||"number"==typeof W.selectionStart)fa=W.selectionStart;return fa},_getCursorRange:function(W){if(W.setSelectionRange&&"number"==typeof W.selectionStart){var fa=W.selectionStart;var ha=W.selectionEnd}else"undefined"!=typeof W.createTextRange&&(fa=this._getCaretPosition(W),ha=this._getCaretPosition(W));return[fa,ha]},_handleExpChange:function(W,fa,ha){this._addBtn.set("disabled",!ha);this._validateBtn.set("disabled",!ha);this._removeBtn.set("disabled",!ha)},_handleValidationBtnClick:function(){var W=
{sql:this.field+" \x3d "+this._exprBox.get("value"),sqlType:"where",f:"json"};W=ra({url:this.layer.url+"/validateSQL",content:W},{usePost:!0});this._addBtn.set("disabled",!0);this._validateBtn.set("disabled",!0);this._showLoading();W.then(U.hitch(this,function(fa){this._hideLoading();this._validateBtn.set("disabled",!1);this._addBtn.set("disabled",!fa.isValidSQL);if(fa.isValidSQL)m.toggle(this._errorMessagePane,this._css.formSuccess,!0),this._handleCloseMsg(),this._showMessages(Ha.calculateFields.validExpression);
else{if(fa.validationErrors&&0<fa.validationErrors.length){var ha="";q.forEach(fa.validationErrors,function(sa){if(sa.params&&Ha.calculateFields.errorCodes[sa.errorCode]){var Fa={},Ma;for(Ma in sa.params)sa.params.hasOwnProperty(Ma)&&(Fa[Ma]=sa.params[Ma]);ha+=d.substitute(Ha.calculateFields.errorCodes[sa.errorCode],Fa)+"\x3cbr/\x3e"}else ha+=(Ha.calculateFields.errorCodes[sa.errorCode]||sa.description)+"\x3cbr/\x3e"},this);this._showMessages(ha,!1)}else this._showMessages(Ha.calculateFields.invalidExpression);
m.toggle(this._errorMessagePane,this._css.formSuccess,!1)}}),U.hitch(this,function(fa){this._hideLoading();this._validateBtn.set("disabled",!1);this._addBtn.set("disabled",!1)}))},_showLoading:function(){h.set(this._underlay,"display","block")},_hideLoading:function(){h.set(this._underlay,"display","none")},_getTypeLabel:function(W){if(-1!==q.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle"],W))var fa=this.i18n.integerLabel;else"esriFieldTypeDouble"===W?fa=this.i18n.doubleLabel:
"esriFieldTypeDate"===W?fa=this.i18n.dateLabel:"esriFieldTypeString"===W&&(fa=this.i18n.stringLabel);return fa},_labelFormatter:function(W){var fa=d.substitute(W.functionDesc,{functionName:W.functionName})+"\x3cbr/\x3e",ha=this._isRightToLeft;q.forEach(W.functionParams,function(sa){fa=ha?fa+(sa.label+" - \x3ci\x3e"+sa.name+"\x3c/i\x3e\x3cbr/\x3e"):fa+("\x3ci\x3e"+sa.name+"\x3c/i\x3e - "+sa.label+"\x3cbr/\x3e")});return fa},_setLayerAttr:function(W){this._set("layer",W);this._set("fields",W.fields)},
_setFieldsAttr:function(W){this._set("fields",W)},_setFieldAttr:function(W){this._set("field",W)},_setHelperMethodsAttr:function(W){this._set("helperMethods",W)},_setOperatorsAttr:function(W){this._set("operators",W)},_setShowSelectFieldAttr:function(W){this._set("showSelectField",W)},_setShowHeaderAttr:function(W){this._set("showHeader",W)},_setCloseOnAddAttr:function(W){this._set("closeOnAdd",W)},_getExpressionAttr:function(){var W=this._exprBox.get("value");if(W){W.split(" ");var fa=[];var ha=
{field:this.field};ha.sqlExpression=W;fa.push(ha);return this.expressionMode===ka.MODE_SQL?fa:this._exprBox&&this._exprBox.get("value")}this._addBtn.set("disabled",!0)},_setExpressionAttr:function(W){this._set("expression",W);this._exprBox&&this._exprBox.set("value",W)},_setAddButtonClassAttr:function(W){this._set("addButtonClass",W)},_setCloseButtonClassAttr:function(W){this._set("closeButtonClass",W)},_setExpressionBoxRowsAttr:function(W){this.expressionBoxRows=W||4},_setExpressionBoxColsAttr:function(W){this.expressionBoxCols=
W||2},_setArcadeEditorAttr:function(W){this.arcadeEditor=W},_setFieldIdAttr:function(W){this.fieldId=W},_setArcadeProfileAttr:function(W){this._set("arcadeProfile",W)},_setArcadeProfileTypeAttr:function(W){this._set("arcadeProfileType",W)}});U.mixin(ka,{MODE_SQL:0,MODE_ARCADE:1});U.setObject("dijit.CalculateField",ka,ea);return ka})},"esri/dijit/ExpressionEditor":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/html dojo/Evented dojo/string dojo/dom dojo/has dojo/topic dojo/query dojo/aspect dojo/_base/json dojo/Deferred dojo/dom-class dojo/dom-style dijit/registry dijit/TooltipDialog dijit/Tooltip dojo/store/Memory ../layers/ArcGISImageServiceLayer ../layers/ArcGISImageServiceVectorLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/ArcGISTiledMapServiceLayer ../support/expressionUtils ../lang ../symbols/jsonUtils ../geometry/Point ../geometry/Polyline ../geometry/Polygon ../SpatialReference ../tasks/QueryTask ../tasks/query dojo/i18n!../nls/jsapi dijit/_Widget dijit/_Templated dojo/text!./templates/ExpressionEditor.html".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D,K,G,I,R,A,B,H,T,M){e=e([H,T],{declaredClass:"esri.dijit.ExpressionEditor",basePath:require.toUrl("."),baseClass:"esriAGOExpressionEditor",widgetsInTemplate:!0,templateString:M,i18n:null,constructor:function(L,X){L&&(q.mixin(this,L),this.defaultExpressionScript=this.defaultExpressionScript||"")},destroy:function(){clearInterval(this.editorFrameListener);window.removeEventListener("message",this.receiveMessageHitch);this.inherited(arguments)},
postMixInProperties:function(){this.inherited(arguments);this.i18n=q.clone(B.common);q.mixin(this.i18n,B.rendererCommon)},postCreate:function(){},_onClose:function(L){L.preventDefault();l.publish("expression-cancel")},startup:function(){this.inherited(arguments);this._init()},_init:function(){var L=0;this.editorFrameLoaded=!1;this.editorUrl=this.arcadeEditor+"?locale\x3d"+U.locale;this._expressionEditor.onload=q.hitch(this,function(){w.set(this._expressionEditorLoading,"display","none");w.set(this._expressionEditor,
"visibility","visible")});this._expressionEditor.src=this.editorUrl;this.receiveMessageHitch=q.hitch(this,"receiveMessage");window.addEventListener("message",this.receiveMessageHitch,!1);this.editorFrameListener=setInterval(q.hitch(this,function(){this.editorFrameLoaded?(clearInterval(this.editorFrameListener),this.editorFrameListener=null):this.sendPostMessage({type:"isLoaded"});L++;60<L&&l.publish("expression-cancel")}),500)},sendPostMessage:function(L){this._expressionEditor&&this._expressionEditor.contentWindow&&
this._expressionEditor.contentWindow.postMessage(n.toJson(L),this.editorUrl)},receiveMessage:function(L){if(-1!==this.editorUrl.indexOf(L.origin)){var X="string"===typeof L.data?n.fromJson(L.data):L.data;switch(X.type){case "loaded":if(this.editorFrameLoaded=X.value){var ba=this.layer instanceof z,ma=this.mapLayer.layer instanceof F,ta="esri.layers.ArcGISTiledMapServiceLayer"===this.mapLayer.layer.declaredClass;if(this.layer instanceof C||ba){if(!this.mapLayer._queryResponse){ba=new R(this.layer.url);
ma=new A;ma.where="1\x3d1";ma.num=1;ma.outFields=["*"];ma.outSpatialReference=this.map.spatialReference;ba.execute(ma,U.hitch(this,function(wa){this.mapLayer._queryResponse=wa;this.receiveMessage(L)}),U.hitch(this,function(){this.mapLayer._queryResponse={};this.receiveMessage(L)}));break}}else if((ma||ta)&&this.layer.url&&(this.mapLayer._queryResponse=this.mapLayer._queryResponse||[],!this.mapLayer._queryResponse[this.layer.url])){ba=new R(this.layer.url);ma=new A;ma.where="1\x3d1";ma.num=1;ma.outFields=
["*"];ma.outSpatialReference=this.map.spatialReference;ba.execute(ma,U.hitch(this,function(wa){this.mapLayer._queryResponse[this.layer.url]=wa;this.receiveMessage(L)}),U.hitch(this,function(){this.mapLayer._queryResponse[this.layer.url]={};this.receiveMessage(L)}));break}ba={type:"initializeDialog",title:this.expressionTitle?this.expressionTitle:this.i18n.custom,captureTitle:N.isDefined(this.captureTitle)?this.captureTitle:!0,predictOutputType:!0,script:this.expression?this.expression:this.defaultExpressionScript,
profile:this.arcadeProfile?this.arcadeProfile:this.makeCurrentProfile(),existing:this.makeExistingList(),spatialReference:this.map.spatialReference.toJson(),includeGeometryWarning:!1};this.arcadeProfileType?(ba.profileName=this.arcadeProfileType,"geoanalyticstrack"===this.arcadeProfileType&&ba.profile[0].value&&(ba.trackData={layer:ba.profile[0].value.layer,track:[{attributes:ba.profile[0].value.attributes&&ba.profile[0].value.attributes,geometry:ba.profile[0].value.geometry&&ba.profile[0].value.geometry}],
trackstarttime:(new Date).getTime(),trackindex:1,trackduration:10,trackcurrenttime:(new Date).getTime()})):this.arcadeProfileType&&"geoanalyticstrack"===this.arcadeProfileType||(ba.bannedFunctions="TrackCurrentTime TrackDuration TrackFieldWindow TrackGeometryWindow TrackIndex TrackStartTime TrackWindow".split(" "));this.sendPostMessage(ba)}case "initFinished":break;case "scriptSaveAndClose":if(!X.script||X.script===this.defaultExpressionScript){l.publish("expression-cancel");break}var Ea=function(wa){l.publish("expression-commit",
[{expression:wa.script,returnType:"Number"===wa.predictOutputType?"esriFieldTypeDouble":"String"===wa.predictOutputType?"esriFieldTypeString":"esriFieldTypeUnknown",title:wa.title}])};V.hasGeometryOperations(X.script)?V.enableGeometryOperations().then(function(){Ea(X)}):Ea(X);break;case "scriptClose":l.publish("expression-cancel")}}},makeCurrentProfile:function(){var L=this.layer.fields,X=[{type:"Feature",value:{attributes:null,geometry:null,layer:{fields:b.map(L,function(ma){return ma}),objectIdField:this.layer.objectIdField,
typeIdField:this.layer.typeIdField,types:this.layer.types?b.map(this.layer.types,function(ma){return ma.toJson?ma.toJson():ma}):null,templates:this.layer.templates}},id:N.isDefined(this.fieldId)?this.fieldId:"$feature"}];this.showViewScale&&X.push({type:"Dictionary",value:{attributes:{scale:this.map.getScale()},layer:{fields:[{name:"scale",alias:this.i18n.currentMapScale,type:"Number"}]}},id:"$view"});if(this.mapLayer._queryResponse&&this.mapLayer._queryResponse.features&&this.mapLayer._queryResponse.features.length)X[0].value.attributes=
q.clone(this.mapLayer._queryResponse.features[0].attributes),X[0].value.geometry=this.mapLayer._queryResponse.features[0].geometry;else if(this.mapLayer._queryResponse&&this.mapLayer._queryResponse[this.layer.url]&&this.mapLayer._queryResponse[this.layer.url].features&&this.mapLayer._queryResponse[this.layer.url].features.length)X[0].value.attributes=q.clone(this.mapLayer._queryResponse[this.layer.url].features[0].attributes),X[0].value.geometry=this.mapLayer._queryResponse[this.layer.url].features[0].geometry;
else if(this.layer.graphics&&this.layer.graphics.length)X[0].value.attributes=q.clone(this.layer.graphics[0].attributes),X[0].value.geometry=this.layer.graphics[0].geometry.toJson();else{var ba={};b.forEach(L,function(ma){-1<b.indexOf("esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGlobalID".split(" "),ma.type)?!1===ma.nullable?ma.defaultValue?ba[ma.name]=ma.defaultValue:-1<b.indexOf(["esriFieldTypeString"],
ma.type)?ba[ma.name]="":ba[ma.name]=0:ba[ma.name]=null:ba[ma.name]=null});X[0].value.attributes=ba;L=this.map.extent;"esriGeometryPolygon"==this.layer.geometryType||this.layer.getCustomRasterFields?(X[0].value.geometry=new G(new I(this.map.spatialReference.toJson())),X[0].value.geometry.addRing([[L.xmin,L.ymin],[L.xmax,L.ymin],[L.xmax,L.ymax],[L.xmin,L.ymax],[L.xmin,L.ymin]])):"esriGeometryPoint"==this.layer.geometryType||"esriGeometryMultipoint"==this.layer.geometryType?X[0].value.geometry=new D(L.getCenter().toJson()):
"esriGeometryPolyline"==this.layer.geometryType&&(X[0].value.geometry=new K(new I(this.map.spatialReference.toJson())),X[0].value.geometry.addPath([[L.xmin,L.ymin],[L.xmax,L.ymax]]))}return X},makeExistingList:function(){var L=U.hitch(this,function(ma,ta,Ea){if(ma&&(ma.shortTitle!==this.expressionTitle||ma.valueExpression!==this.expression)){ma={shortTitle:ma.shortTitle||this.i18n.untitled,script:ma.valueExpression,returnType:ma.returnType};switch(Ea){case "color":ma.title=a.substitute(this.i18n.expressionOriginColor,
{title:ma.shortTitle});break;case "size":ma.title=a.substitute(this.i18n.expressionOriginSize,{title:ma.shortTitle});break;case "type":ma.title=a.substitute(this.i18n.expressionOriginColor,{title:ma.shortTitle});break;case "transparency":ma.title=a.substitute(this.i18n.expressionOriginTransparency,{title:ma.shortTitle});break;case "rotation":ma.title=a.substitute(this.i18n.expressionOriginRotation,{title:ma.shortTitle});break;default:ma.title=ma.shortTitle}ta.push(ma)}}),X=[],ba=this.getRendererCustomExpression(this.layer.renderer,
"color");L(ba,X,"color");ba=this.getRendererCustomExpression(this.layer.renderer,"size");L(ba,X,"size");ba=this.getRendererCustomExpression(this.layer.renderer,"type");L(ba,X,"type");ba=this.getRendererCustomExpression(this.layer.renderer,"transparency");L(ba,X,"transparency");ba=this.getRendererCustomExpression(this.layer.renderer,"rotation");L(ba,X,"rotation");if(this.layer.labelingInfo||this.layer.drawingInfo&&this.layer.drawingInfo.labelingInfo)L=this.layer.drawingInfo?this.layer.drawingInfo.labelingInfo[0]:
this.layer.labelingInfo[0],L.labelExpressionInfo&&L.labelExpressionInfo.expression&&L.name&&(L.name!==this.expressionTitle||L.labelExpressionInfo.expression!==this.expression)&&X.push({shortTitle:L.name||this.i18n.untitled,title:a.substitute(this.i18n.expressionOriginLabels,{title:L.name||this.i18n.untitled}),script:L.labelExpressionInfo.expression});L=this.latestPopupInfo||this.mapLayer.popupInfo;if(!L&&this.mapLayer.itemLayers)for(ba=0;ba<this.mapLayer.itemLayers.length;ba++)if(this.mapLayer.itemLayers[ba].id===
this.layer.id){L=this.mapLayer.itemLayers[ba].popupInfo;break}L&&L.expressionInfos&&b.forEach(L.expressionInfos,function(ma){!ma||ma.title===this.expressionTitle&&ma.expression===this.expression||X.push({shortTitle:ma.title||this.i18n.untitled,title:a.substitute(this.i18n.expressionOriginPopup,{title:ma.title||this.i18n.untitled}),script:ma.expression})},this);return X},getRendererCustomExpression:function(L,X){if(!L)return null;if(L.valueExpression&&("esri.renderer.UniqueValueRenderer"==L.declaredClass||
"esri.renderer.ClassBreaksRenderer"==L.declaredClass&&!this.getVisualVariableByType("colorInfo",null,L.visualVariables)&&!this.getVisualVariableByType("sizeInfo",null,L.visualVariables))&&"type"===X){var ba="esriFieldTypeDouble";"esri.renderer.UniqueValueRenderer"==L.declaredClass&&L.infos&&L.infos[0]&&"string"===typeof L.infos[0].value&&(ba="esriFieldTypeString");return{valueExpression:L.valueExpression,returnType:ba,shortTitle:L.valueExpressionTitle||L.legendOptions&&L.legendOptions.title}}return L.visualVariables&&
((ba=this.getVisualVariableByType("colorInfo",null,L.visualVariables))&&ba.valueExpression&&"color"===X||(ba=this.getVisualVariableByType("sizeInfo",null,L.visualVariables))&&ba.valueExpression&&"size"===X||(ba=this.getVisualVariableByType("opacityInfo",null,L.visualVariables))&&ba.valueExpression&&"transparency"===X||(ba=this.getVisualVariableByType("rotationInfo",null,L.visualVariables))&&ba.valueExpression&&"rotation"===X)?{valueExpression:ba.valueExpression,returnType:"esriFieldTypeDouble",shortTitle:ba.valueExpressionTitle||
ba.legendOptions&&ba.legendOptions.title}:L.observationRenderer?this.getRendererCustomExpression(L.observationRenderer):L.latestObservationRenderer?this.getRendererCustomExpression(L.latestObservationRenderer):null},getVisualVariableByType:function(L,X,ba){return ba&&(ba=b.filter(ba,function(ma){return N.isDefined(X)?ma.type===L&&ma.target===X:ma.type===L&&!ma.target}),ba.length)?q.clone(ba[0]):null}});q.setObject("esri.dijit.ExpressionEditor",e);return e})},"esri/layers/ArcGISImageServiceVectorLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/json dojo/sniff ../kernel ../lang ./GraphicsLayer ./ImageServiceLayerMixin ./pixelFilters/VectorFieldPixelFilter ../renderers/VectorFieldRenderer ../geometry/Point ../geometry/Extent ../graphic dojox/gfx".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m){e=e([a,c],{declaredClass:"esri.layers.ArcGISImageServiceVectorLayer",constructor:function(t,w){this.symbolTileSize=w&&w.symbolTileSize?w.symbolTileSize:50;this._maxMag=this._minMag=null;var u=U.clone(this._params);delete u.imageServiceParameters;delete u.pixelFilter;delete u.rendererStyle;delete u.symbolTileSize;this._initialize(t,w);this.renderer||this.setVectorRendererStyle(w&&w.rendererStyle?w.rendererStyle:h.STYLE_SINGLE_ARROW);this.geometryType="esriGeometryPoint";
this.symbolTileSizeUnits="Pixels";U.mixin(this._params,u)},getField:function(t){return this._getField(t,!0)},setVectorRendererStyle:function(t){this.rendererStyle=t;this._updateVectorFieldRenderer();this.useDefaultRenderer=!0},setRenderer:function(t){t&&(this.vectorFieldPixelFilter=this.vectorFieldPixelFilter||new d,this.vectorFieldPixelFilter.setUnits(t.inputUnit,t.outputUnit));this.useDefaultRenderer=!1;this.inherited(arguments)},getFlowRepresentation:function(){return this.renderer&&this.renderer.flowRepresentation||
this._vectorFlowRepresentation},onResume:function(){this.inherited(arguments);this._toggleTime()},onSuspend:function(){this.inherited(arguments);this._toggleTime()},_fixSymbolTileSize:function(){this.renderer&&(this.renderer.symbolTileSize?this.symbolTileSize=this.renderer.symbolTileSize:this.renderer.symbolTileSize=this.symbolTileSize)},_refresh:function(t){if(10>l("ie"))this.onError(Error("Unable to refresh. This layer is not supported in the current browser."));else if(this._map){this._fixSymbolTileSize();
this.setImageFormat("LERC",!0);t=this.fullExtent&&this.fullExtent.xmin;var w=this.fullExtent&&this.fullExtent.ymax,u=U.clone(this._map.extent),v=1/this.symbolTileSize*this._map.width;v=v?Math.ceil(v):50;var x=1/this.symbolTileSize*this._map.height;x=x?Math.ceil(x):Math.ceil((u.ymax-u.ymin)/(u.xmax-u.xmin)*v);var y=(u.xmax-u.xmin)/v,C=(u.ymax-u.ymin)/x;u.xmin=t+Math.floor((u.xmin-t)/y)*y;u.xmax=t+Math.ceil((u.xmax-t)/y)*y;u.ymin=w+Math.floor((u.ymin-w)/C)*C;u.ymax=w+Math.ceil((u.ymax-w)/C)*C;this._requestData(u,
v,x)}},_drawPixelData:function(){this.clear();if(this.pixelData){var t=this.pixelData.pixelBlock,w=this.pixelData.extent,u=this.pixelData.locations,v=r.isDefined(t.mask)&&0<t.mask.length;if(t&&w&&u){if(this.useDefaultRenderer&&this.renderer&&(!r.isDefined(this._minMag)||!r.isDefined(this._maxMag))){var x=this._getServiceMinMaxStats();x?(this._minMag=x.min,this._maxMag=x.max):(this._minMag=t.statistics[0].minValue,this._maxMag=t.statistics[0].maxValue);x={type:"sizeInfo",minSize:m.px2pt(.2*this.symbolTileSize),
maxSize:m.px2pt(.8*this.symbolTileSize),minDataValue:this._minMag,maxDataValue:this._maxMag};var y=[];y.push(x);y.push({type:"colorInfo"});this.renderer.setVisualVariables(y)}var C=y=x=0,z=w.spatialReference?w.spatialReference._getInfo():null;for(x=0;x<t.height;x++)for(y=0;y<t.width;y++,C++){var F=u[C];if((!v||t.mask[C])&&F&&2===F.length){F=new f(F[0],F[1],w.spatialReference);z&&(F.x=g.prototype._normalizeX(F.x,z).x);var O={Magnitude:t.pixels[0][C],Direction:t.pixels[1][C],Location:b.toJson(F.toJson())};
F=new n(F,null,O);this.add(F)}}}}},_getServiceMinMaxStats:function(){if(!r.isDefined(this.minValues)||!r.isDefined(this.maxValues)||2>this.minValues.length||2>this.maxValues.length)return null;var t=this.minValues[0],w=this.maxValues[0],u=this.minValues[1],v=this.maxValues[1];if(this.pixelFilter&&t&&w&&u&&v){var x=[];x.push([t,w]);x.push([u,v]);u=this._createPixelData(x);this.pixelFilter(u);u&&u.pixelBlock&&u.pixelBlock.pixels&&0<u.pixelBlock.pixels.length&&(t=u.pixelBlock.pixels[0][0],w=u.pixelBlock.pixels[0][1])}return t&&
w?{min:t,max:w}:null},_updateVectorFieldRenderer:function(){var t={type:"sizeInfo",minSize:m.px2pt(.2*this.symbolTileSize),maxSize:m.px2pt(.8*this.symbolTileSize),minDataValue:this._minMag,maxDataValue:this._maxMag},w=[];w.push(t);t=new h({style:this.rendererStyle,visualVariables:w,flowRepresentation:this._vectorFlowRepresentation});this.setRenderer(t)},_getField:function(t,w){if(r.isDefined(t))return w&&(t=t.toLowerCase()),"magnitude"!==t&&"direction"!==t?null:{name:t,alias:t,domain:null,editable:!1,
length:50,type:"esriFieldTypeDouble"}},_requestDataErrorHandler:function(t){"CancelError"!==t.name&&(this.clear(),this.onError(t))},_setFlowRepresentation:function(t){this.renderer&&this.renderer.flowRepresentation?this._vectorFlowRepresentation=this.renderer.flowRepresentation:t&&this.renderer&&r.isDefined(t.FlowDirection)&&t.FlowDirection&&(this._vectorFlowRepresentation="oceanographic"===t.FlowDirection.toLowerCase()?this.renderer.FLOW_TO:this.renderer.FLOW_FROM);this.renderer&&(this.renderer.flowRepresentation=
this._vectorFlowRepresentation)}});U.setObject("layers.ArcGISImageServiceVectorLayer",e,p);return e})},"esri/dijit/FeatureTable":function(){define("../kernel ../lang ./FeatureTable/Grid ./FeatureTable/storeUtils ./FeatureTable/dataUtils dojo/dom-class dojo/dom-construct dojo/dom-style dojo/aspect dojo/debounce dojo/has dojo/on dojo/string dojo/promise/all dojo/Deferred dojo/Evented dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/fx dojo/text!../dijit/FeatureTable/templates/FeatureTable.html dojo/i18n!../nls/jsapi dijit/_WidgetBase dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/a11yclick dijit/Menu dijit/MenuItem dgrid/util/misc dijit/layout/BorderContainer dijit/layout/TabContainer dijit/layout/ContentPane dojo/query!css2 dojo/domReady!".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D,K,G,I,R){t=w([z,F,O,V,t],{declaredClass:"esri.dijit.FeatureTable.Grid",baseClass:"esri-feature-table",templateString:y,featureLayer:null,map:null,fieldInfos:null,gridOptions:null,dateOptions:null,editable:!1,editOn:null,hiddenFields:null,outFields:null,menuFunctions:null,columnMenuFunctions:null,batchCount:50,syncSelection:!1,zoomToSelection:!1,showDataTypes:!1,showGridHeader:!0,showGridMenu:!0,showFeatureCount:!0,showColumnHeaderTooltips:!1,
showColumnHeaderTooltipsWithDescription:!1,showAttachments:!1,showStatistics:!0,showRelatedRecords:!1,showCyclicalRelationships:!1,filterIds:null,showFieldDetails:!1,showColumnHiderButton:!1,showDefaultSortMenuItem:!0,showExpressionFields:!1,loaded:!1,grid:null,layerInfo:null,dataStore:null,columns:null,featureCount:0,idProperty:"id",gridMenu:null,gridMenuAnchor:null,selectedRows:null,selectedRowIds:null,css:{button:"esri-feature-table-button",hidden:"esri-feature-table-hidden",select:"esri-feature-table-select",
borderContainer:"esri-feature-table-border-container",contentPane:"esri-feature-table-content-pane",grid:"esri-feature-table-grid",title:"esri-feature-table-title",loadingIndicator:"esri-feature-table-loading-indicator",cellLoadingIndicator:"esri-feature-table-cell-loading-indicator",menu:"esri-feature-table-menu",menuItem:"esri-feature-table-menu-item",menuOptions:"esri-feature-table-menu-options",columnHeader:"esri-feature-table-column-header",columnHeaderTitle:"esri-feature-table-column-header-title",
columnHeaderType:"esri-feature-table-column-header-type",columnHeaderClear:"esri-feature-table-column-header-clear",columnMenu:"esri-feature-table-column-menu",sortAscendingIcon:"esri-icon-ascending icon-ui-ascending",sortDescendingIcon:"esri-icon-descending icon-ui-descending",filterIcon:"esri-icon-filter icon-ui-filter",propertiesIcon:"esri-icon-properties icon-ui-properties",statisticsIcon:"esri-icon-statistics icon-ui-statistics",settingsIcon:"esri-icon-settings icon-ui-settings",columnHeaderTooltip:"esri-feature-table-column-header-tooltip",
lockedIcon:"esri-icon-locked icon-ui-locked",lockedIconContainer:"esri-locked-icon-container",downIcon:"esri-icon-down icon-ui-down",menuIcon:"esri-icon-menu icon-ui-menu",closeIcon:"esri-icon-close icon-ui-close",optionsMenu:"esri-feature-table-options-menu-container",relatedRecordsCell:"esri-feature-table-related-records-cell",relatedRecordsTitle:"esri-feature-table-related-records-title",relatedRecordsLink:"esri-related-records-link",attachmentsCell:"esri-feature-table-attachments-cell",attachmentsTitle:"esri-feature-table-attachments-title",
attachmentsLink:"esri-attachments-link",expressionsCell:"esri-feature-table-expressions-cell",expressionsTitle:"esri-feature-table-expressions-title",expressionsLink:"esri-expressions-link",dialog:"esri-feature-table-dialog",closeButton:"esri-dialog-close-button dijitButton",statisticsTableContainer:"esri-feature-table-statistics",statisticsHeader:"esri-statistics-header",statisticsBreak:"esri-break",statisticsHorizontalBreak:"esri-horizontal-break",statisticsAttrTable:"esri-attribute-table",statisticsAttrName:"esri-attribute-name",
statisticsAttrValue:"esri-attribute-value",leftMargin:"esri-feature-table-left-margin",dateValue:"esri-date-value"},_i18nStrings:C.widgets.FeatureTable,_layerInfos:null,_fieldInfos:null,_cachedIds:null,_defaultBatchCount:50,_defaultFeatureCount:2E3,_defaultDateOptions:{timeEnabled:!0,dateEnabled:!0,timePattern:null,datePattern:null},_defaultGridOptions:{allowSelectAll:!1,cellNavigation:!0,selectionMode:"extended",pagination:!1,allowTextSelection:!1,pageSizeOptions:[10,25,50],columnHider:!0,columnResizer:!0,
pagingDelay:300,keepScrollPosition:!0,queryRowsOverlap:0,sort:{field:"id",descending:!1}},_defaultSort:null,_defaultEditOn:"dblclick, keypress",_orderByFields:null,_showRelatedRecords:!1,_showAttachments:!1,_rollbackInfos:null,_statisticsDialog:null,_attachmentsDialog:null,_columnRules:null,_relatedGridInfos:null,_popupDateFormats:{shortDate:{datePattern:"M/d/y"},shortDateLE:{datePattern:"d/M/y"},longMonthDayYear:{datePattern:"MMMM d, y"},dayShortMonthYear:{datePattern:"d MMM y"},longDate:{datePattern:"EEEE, MMMM d, y",
selector:"date"},shortDateShortTime:{datePattern:"M/d/y",timePattern:"h:mm a",timeEnabled:!0},shortDateLEShortTime:{datePattern:"d/M/y",timePattern:"h:mm a",timeEnabled:!0},shortDateShortTime24:{datePattern:"M/d/y",timePattern:"H:mm",timeEnabled:!0},shortDateLEShortTime24:{datePattern:"d/M/y",timePattern:"H:mm",timeEnabled:!0},shortDateLongTime:{datePattern:"M/d/y",timePattern:"h:mm:ss a",timeEnabled:!0},shortDateLELongTime:{datePattern:"d/M/y",timePattern:"h:mm:ss a",timeEnabled:!0},shortDateLongTime24:{datePattern:"M/d/y",
timePattern:"H:mm:ss",timeEnabled:!0},shortDateLELongTime24:{datePattern:"d/M/y",timePattern:"H:mm:ss",timeEnabled:!0},longMonthYear:{datePattern:"MMMM y"},shortMonthYear:{datePattern:"MMM y"},year:{datePattern:"y"}},constructor:function(A,B){B&&(this._rowSelectHandler=d(this._rowSelectHandler,0),this._rowDeselectHandler=d(this._rowDeselectHandler,0),this._refreshHandler=d(this._refreshHandler,0))},postMixInProperties:function(){this.inherited(arguments);this.set({columns:[],layerInfo:{},selectedRows:[],
selectedRowIds:[],hiddenFields:this.hiddenFields||[],outFields:this.outFields||["*"],fieldInfos:this.fieldInfos||[],menuFunctions:this.menuFunctions||[],columnMenuFunctions:this.columnMenuFunctions||[],gridOptions:u.mixin({},this._defaultGridOptions,this.gridOptions),dateOptions:u.mixin({},this._defaultDateOptions,this.dateOptions),_fieldInfos:[],_cachedIds:[],_columnRules:{},_relatedGridInfos:[]});h("touch")&&!this.editOn?this.set("editOn",N):this.editOn||this.set("editOn",this._defaultEditOn);this.filterIds&&
0===this.filterIds.length&&(this.filterIds=null);this._noDataMessage=this.gridOptions.noDataMessage||this._i18nStrings.noData},startup:function(){this.inherited(arguments);var A=this.featureLayer;A&&A.loadError?this._showLoadError():this.domNode&&A.loaded?this._setUpDataForMainGrid():this.own(f(A,"load",u.hitch(this,function(){this._setUpDataForMainGrid()})),f(A,"error",u.hitch(this,function(){A.loaded||this._showLoadError()})))},destroy:function(){this.inherited(arguments);this._statisticsDialog&&
this._statisticsDialog.destroy();this._attachmentsDialog&&this._attachmentsDialog.destroy();this._grid&&this._grid._destroyColumns()},refresh:function(A){var B=A||this._grid,H=this._relatedGridInfos,T=H.length,M;B===this._grid&&0<T&&v.forEach(H,function(L,X){(M=H[T-1-X])&&M.grid&&this._removeGrid(M.grid)},this);return this._refreshStore({grid:B}).then(function(){B.refresh()})},resize:function(A){this._gridBorderContainerNode&&this._gridBorderContainerNode.resize();(A=A&&A.resize?A:this._grid)&&A.resize()},
clearSelection:function(A){(A=A||this._grid)&&A.clearSelection()},getRowDataById:function(A,B){var H=B||this._grid;if(H)return H.getRowDataById(A)},filterSelectedRecords:function(A,B){var H=B||this._grid,T=H?H.selectedRowIds:[];H&&T&&T.length&&this.filterRecordsByIds(H.selectedRowIds)},filterRecordsByIds:function(A,B){var H=B||this._grid;H&&(this.filterIds=A,H.filterIds=A,A&&0!==A.length||(this.selectedRows=[],this.selectedRowIds=[],H.selectedFeatureCount=0,H.selectedRowIds=[],H.selectedRows=[]),
this._refreshStore({grid:H}),this.emit("filter",{ids:A||[]}))},clearFilter:function(A){(A=A||this._grid)&&this.filterRecordsByIds(null,A)},getFeatureDataById:function(A){return A instanceof Array?l.queryLayerForFeature({layer:this.featureLayer,id:A}):l.queryLayerForFeatures({layer:this.featureLayer,ids:A})},selectRows:function(A,B,H){(H=H||this._grid)&&H.selectRows(A,B)},sort:function(A,B,H){H=H||this._grid;if(H&&A){var T=l.getOrderByString(A,B);var M=l.getColumnFromFieldName({fieldName:A,grid:H});
this._sortField(H,{field:A,descending:B,column:M,orderByFields:[T]})}},centerOnSelection:function(A){return(A||this._grid).centerOnSelection()},_setUpMainGrid:function(A,B){var H=new q({map:this.map,layer:A,layerInfo:B,idProperty:B.idProperty,customFieldInfos:this._getCustomFieldInfos(A)||this.fieldInfos,expressionInfos:this._getExpressionInfos(A),defaultSort:this._defaultSort,outFields:this.outFields,hiddenFields:this.hiddenFields,filterIds:this.filterIds,gridOptions:this.gridOptions,dateOptions:this.dateOptions,
batchCount:this.batchCount,editable:this.editable,editOn:this.editOn,css:this.css,showAttachments:this._showAttachments,showRelatedRecords:this._showRelatedRecords,showCyclicalRelationships:this.showCyclicalRelationships,showStatistics:this.showStatistics,showFieldDetails:this.showFieldDetails,showGridHeader:this.showGridHeader,showGridMenu:this.showGridMenu,showFeatureCount:this.showFeatureCount,showDataTypes:this.showDataTypes,showColumnHeaderTooltips:this.showColumnHeaderTooltips,showColumnHeaderTooltipsWithDescription:this.showColumnHeaderTooltipsWithDescription,
showColumnHider:this.showColumnHiderButton,syncSelection:this.syncSelection,menuFunctions:this.menuFunctions,showDefaultSortMenuItem:this.showDefaultSortMenuItem,columnMenuFunctions:this.columnMenuFunctions,showFilterMenuItems:this.showFilterMenuItems,showExpressionFields:this.showExpressionFields},this._gridNode);H.startup();this.set({_grid:H,grid:H.dGrid,gridMenu:H.optionsMenu,gridMenuAnchor:H.optionsMenuAnchor});this._wireUpGridEvents(H);H.showLoadingIndicator();H.updateNoDataMessage("");H.setHeaderTitle(this._i18nStrings.loadingData);
H.resize();this._setUpColumns({grid:H,layer:A});l.queryLayerForCount({layer:A,layerInfo:B}).then(u.hitch(this,function(T){H.set("featureCount",T);H.updateHeaderText();this._generateStore({grid:H,layer:A,layerInfo:B,count:T,filterIds:this.filterIds}).then(u.hitch(this,function(M){T||H.updateNoDataMessage(this._noDataMessage);this.set("dataStore",M);H.updateStore(M);H.hideLoadingIndicator();setTimeout(u.hitch(this,function(){this.resize()},200))})).otherwise(u.hitch(this,function(){this._showLoadError();
H.updateNoDataMessage(this._noDataMessage)}))})).otherwise(u.hitch(this,function(){this._showLoadError();H.updateNoDataMessage(this._noDataMessage)}))},_setUpDataForMainGrid:function(){var A=this.featureLayer,B=this.gridOptions,H=this.outFields;this._generateLayerInfo(A).then(u.hitch(this,function(T){var M=T.idProperty;T.hasRelatedRecords&&(this._showRelatedRecords=!!this.showRelatedRecords);T.hasAttachments&&(this._showAttachments=!!this.showAttachments);var L=B.sort&&B.sort.field?l.findFirst(A.fields,
"name",B.sort.field):null;L=L&&L.name?L.name:M;var X=!(!B.sort||!B.sort.descending),ba=l.getOrderByString(L,X);H=v.filter(H,function(ma){return!!l.findFirst(A.fields,"name",ma)},this);0===H.length&&H.push("*");this.layerInfo=T;this.idProperty=M;this._orderByFields=[ba];this._defaultSort={attribute:L,descending:X};this._setUpMainGrid(A,T)}))},_getCustomFieldInfos:function(A){return(A=this._getPopupInfo(A))&&A.fieldInfos?this._updatePopupInfosDateFormat(A.fieldInfos):null},_getExpressionInfos:function(A){return(A=
this._getPopupInfo(A))&&A.expressionInfos?A.expressionInfos:null},_getPopupInfo:function(A){A=A.id||A.layerId||0;return(A=this._layerInfos?this._layerInfos[A]:null)?A.popupInfo:null},_generateLayerInfo:function(A){var B=new m,H=A.id||A.layerId||0,T=A.objectIdField;if(!T){var M=JSON.parse(A._json);M.uniqueIdField&&M.uniqueIdField.name&&(T=M.uniqueIdField.name)}T={idProperty:T,layerId:H,userIds:{}};A.credential&&(T.userIds[H]=A.credential.userId);T.userId&&(T.userIds[H]=T.userId);T.isFeatureCollection=
A._collection&&!0===A._collection||null===A.url&&null===A._url;T.typeIdField=A.typeIdField;T.types=A.types;T.subtypeField=A.subtypeField;T.subtypes=A.subtypes;T.editable=A.isEditable?A.isEditable():!!A.userIsAdmin||!1;T.editCapabilities=A.getEditCapabilities?A.getEditCapabilities():{};T.hasRelatedRecords=A.relationships&&0<A.relationships.length;T.supportsAdvancedQueryRelated=!(!A.advancedQueryCapabilities||!A.advancedQueryCapabilities.supportsAdvancedQueryRelated);T.hasAttachments=A.hasAttachments;
T.queryAttachmentsSupported=!0;T=u.clone(T);B.resolve(T);return B},_setUpColumns:function(A){var B=A.grid;A=A.layer;var H=A.fields,T;var M=(T=A.getOutFields?A.getOutFields():["*"])&&T[0]&&"*"===T[0]?H:v.filter(H,function(X){return-1!==v.indexOf(T,X.name)});B===this._grid&&"*"!==this.outFields[0]&&(M=v.filter(M,u.hitch(this,function(X){return-1!==v.indexOf(this.outFields,X.name)})));U.isDefined(A.objectIdField)&&!l.findFirst(M,"name",A.objectIdField)&&(H=l.findFirst(H,"name",A.objectIdField))&&M.unshift(H);
if(this.showExpressionFields){var L=this._getPopupInfo(A);L&&L.expressionInfos&&(A=this._getCustomFieldInfos(A),v.forEach(A,function(X){var ba=l.getExpressionInfo(L.expressionInfos,X.fieldName);ba&&M.push({name:X.fieldName,alias:ba.title,editable:!1,nullable:!1,type:ba.returnType})}))}A=B._setUpColumns(M);B===this._grid&&this.set({columns:A.columns,_fieldInfos:A.fieldInfos})},_showLoadError:function(A){var B=A&&A.grid?A.grid:this._grid;A=A&&A.error?A.error:this._i18nStrings.dataError;B&&(B.hideLoadingIndicator(),
B.setHeaderTitle(A));this.emit("error",{message:A})},_wireUpGridEvents:function(A){A&&(A.on("load",u.hitch(this,function(B){A===this._grid&&this.set("loaded",B.loaded);this.emit("load",B.loaded)})),A.on("error",u.hitch(this,function(B){this._showLoadError();this.emit("error",B)})),A.on("row-select",u.hitch(this,this._rowSelectHandler,A)),A.on("row-deselect",u.hitch(this,this._rowDeselectHandler,A)),A.on("refresh",u.hitch(this,this._refreshHandler,A)),A.on("sort",u.hitch(this,this._sortField,A)),A.on("filter",
u.hitch(this,function(B){this.emit("filter",B)})),A.on("column-resize",u.hitch(this,function(B){this.emit("column-resize",B)})),A.on("column-state-change",u.hitch(this,function(B){this.emit("column-state-change",B)})),A.on("editor-show",u.hitch(this,function(B){this.emit("editor-show",B)})),A.on("editor-hide",u.hitch(this,function(B){this.emit("editor-hide",B)})),A.on("data-change",u.hitch(this,function(B){this.emit("data-change",B)})),A.on("edits-complete",u.hitch(this,function(B){this.emit("edits-complete",
B)})),A.on("layer-click",u.hitch(this,function(B){this.emit("layer-click",B)})),A.on("layer-selection-complete",u.hitch(this,function(B){A===this._grid&&this.syncSelection&&this._syncSelectionFromLayer({grid:A,features:B.features});this.emit("layer-selection-complete",B)})),A.on("layer-selection-clear",u.hitch(this,function(B){A===this._grid&&this.syncSelection&&this.clearSelection();this.emit("layer-selection-clear",B)})),A.on("layer-update-end",u.hitch(this,function(B){this.emit("layer-update-end",
B)})),A.on("layer-refresh-tick",u.hitch(this,function(B){this.refresh()})),A.on("show-selected-records",u.hitch(this,function(B){this.emit("show-selected-records",{grid:A,ids:B.ids});this.filterRecordsByIds(B.ids,A)})),A.on("clear-selection",u.hitch(this,function(){this.emit("clear-selection")})),A.on("clear-filter",u.hitch(this,this.clearFilter,A)),A.on("show-statistics",u.hitch(this,function(B){this._statisticsDialog=B.dialog;this.emit("show-statistics",{dialog:B.dialog,statistics:B.statistics})})),
A.on("show-attachments",u.hitch(this,function(B){this._attachmentsDialog=B.dialog;this.emit("show-attachments",{featureId:B.featureId,dialog:B.dialog,attachments:B.attachments})})),A.on("show-related-records",u.hitch(this,this._showRelatedRecordsCallback,A)),A.on("show-detailed-field-view",u.hitch(this,this._showDetailedFieldViewCallback,A)),A.on("add-attachment-complete",u.hitch(this,function(B){this.emit("add-attachment-complete",B)})),A.on("delete-attachment-complete",u.hitch(this,function(B){this.emit("delete-attachment-complete",
B)})))},_wireUpRelatedGridEvents:function(A){A.grid.own(f(A.parentGrid,"row-select",this._updateRelatedGridsHandler.bind(this,A)))},_updateRelatedGridsHandler:function(A,B){if(B.rows&&B.rows.length&&B.rows[0].data){var H=A.grid,T=A.parentGrid,M=A.relationship,L=this._relatedGridInfos,X=B.rows[0],ba=L[L.length-1];if(ba=ba?ba.grid:null){var ma=H===ba,ta=parseInt(X.id,10);ba=l.findFirst(H.layer.relationships,"id",M.id);var Ea=l.findFirst(L,"grid",H),wa=v.indexOf(L,Ea),Q=T._getRelatedRecordsCount({featureId:ta,
relationshipId:M.id});0<Q?(ma||v.forEach(L,function(Z,aa){Z.grid&&aa>=wa&&(Z.grid.emptyStore(),Z.grid.set("featureCount",0),Z.grid.updateHeaderText())}),L=M.keyField,"undefined"===typeof X.data[L]&&(L=T.layer.getField(L).name),l.getRelationshipWhereClause({layer:H.layer,originRelationship:M,destinationRelationship:ba,keyValue:X.data[L]}).then(u.hitch(this,function(Z){H.set({where:Z,featureCount:Q});H.updateHeaderText();this._refreshStore({grid:H}).then(function(aa){ma||setTimeout(function(){if(H.store){var ea=
H.store.data;if(ea=ea?ea[Object.keys(ea)[0]]:null)ea=ea.attributes[H.idProperty],H.selectRows(ea,!1)}},600)})}))):ma?(H.emptyStore(),H.set("featureCount",0),H.updateHeaderText(),H.refresh()):(H.set("featureCount",0),H.updateHeaderText(),v.forEach(L,function(Z,aa){var ea=Z.grid;aa<wa||(ea.emptyStore(),ea.set("featureCount",0),ea.updateHeaderText(),ea.refresh())}))}}},_generateStore:function(A){var B=A.grid,H=A.layer,T=A.layerInfo,M=A.where||null,L=A.orderByFields||null,X=A.count||null,ba=A.filterIds||
null;(A.store||B.store)&&B.emptyStore();return T.isFeatureCollection?this._generateStoreForFeatureCollection({grid:B,layer:H,layerInfo:T}):H.advancedQueryCapabilities&&!H.advancedQueryCapabilities.supportsPagination?this._generateStoreForNonPaginatedLayer({grid:B,layer:H,layerInfo:T,where:M,orderByFields:L,count:X,filterIds:ba}):this._generateCacheStore({grid:B,where:M,orderByFields:L,count:X,ids:ba})},_generateCacheStore:function(A){var B=new m,H=A.grid;var T=A.orderByFields?A.orderByFields:H===
this._grid?this._orderByFields&&this._orderByFields.length?this._orderByFields:[l.getOrderByString(this._defaultSort.attribute,this._defaultSort.descending)]:null;A=b.generateCacheStore({grid:H,layer:H.layer,ids:A.ids,where:A.where,orderByFields:T,count:A.count,getAttachments:this.showAttachments&&H.layerInfo.hasAttachments,getRelatedRecords:this.showRelatedRecords&&H.layerInfo.hasRelatedRecords});c.before(A,"query",function(M,L){H.showLoadingIndicator()});c.after(A,"query",function(M){M.then(function(L){L.attachmentInfos?
H._updateAttachmentInfos(L.attachmentInfos):H.layerInfo.queryAttachmentsSupported=!1;L.relatedRecordInfos&&(H.layerInfo.supportsAdvancedQueryRelated?H._updateRelatedRecordCounts(L.relatedRecordInfos):H._updateRelatedRecordInfos(L.relatedRecordInfos));H.hideLoadingIndicator()}).otherwise(function(){H.hideLoadingIndicator()});return M});B.resolve(A);return B},_generateMemoryStore:function(A){var B=A.grid,H=A.features;A=new m;H=b.generateMemoryStore({features:H,idProperty:this.idProperty});H.query=u.hitch(this,
b.generateSort,B.dGrid,H);A.resolve(H);return A},_generateStoreForFeatureCollection:function(A){return this._generateMemoryStore({grid:A.grid,features:A.layer.graphics})},_generateStoreForNonPaginatedLayer:function(A){var B=A.grid,H=A.layer,T=A.layerInfo,M=A.where||null,L=A.orderByFields||null;return(A=A.filterIds||null)&&A.length?this._generateCacheStore({grid:B,ids:A,where:M,orderByFields:L}):l.queryLayerForIds({layer:H,idProperty:T.idProperty,where:M}).then(u.hitch(this,function(X){T._cachedIds=
X;B.layerInfo.cachedIds=X;return this._generateCacheStore({grid:B,ids:X,where:M,orderByFields:L})})).otherwise(u.hitch(this,function(){this._showLoadError()}))},_refreshStore:function(A){var B=A.grid,H=B.filterIds,T=A.where||B.where||null,M=A.orderByFields,L=B.layer,X=B.layerInfo;B.showLoadingIndicator();B.updateNoDataMessage("");B.setHeaderTitle(this._i18nStrings.loadingData);return l.queryLayerForCount({layer:L,layerInfo:X,where:T}).then(u.hitch(this,function(ba){B.set("featureCount",ba);B.updateHeaderText();
return this._generateStore({grid:B,layer:L,layerInfo:X,orderByFields:M,where:T,count:ba,filterIds:H}).then(u.hitch(this,function(ma){B===this._grid&&this.set("dataStore",ma);ba||B.updateNoDataMessage(this._noDataMessage);B.updateStore(ma);B.hideLoadingIndicator();return ma}))})).otherwise(u.hitch(this,function(){this._showLoadError();B.updateNoDataMessage(this._noDataMessage);return null}))},_setEditableAttr:function(A){this._grid&&this._grid.set("editable",!!A);v.forEach(this._relatedGridInfos,function(B){B.grid.set("editable",
!!A)})},_sortField:function(A,B){var H=B.column,T=parseInt(B.id,10),M=B.field,L=B.descending,X=B.orderByFields;A===this._grid&&(this._orderByFields=X);A.emptyStore();H?A.updateSort([{attribute:M,columnId:T,fieldType:H.type,descending:L}]):A.updateSort([{attribute:M,descending:L}]);this._refreshStore({grid:A,orderByFields:X}).then(u.hitch(this,function(){this.emit("sort",{field:M,descending:L})}))},_rowSelectHandler:function(A,B){this.syncSelection&&this._syncSelectionFromGrid({grid:A,ids:A.selectedRowIds});
A===this._grid&&(this.set({selectedRows:A.selectedRows,selectedRowIds:A.selectedRowIds}),this.emit("row-select",B))},_rowDeselectHandler:function(A,B){var H=A.selectedRows;this.syncSelection&&(0<H.length?this._syncSelectionFromGrid({grid:A,ids:A.selectedRowIds}):A.layer.clearSelection(!0));A===this._grid&&(this.set({selectedRows:H,selectedRowIds:A.selectedRowIds}),this.emit("row-deselect",B))},_refreshHandler:function(A,B){A===this._grid&&this.emit("refresh",B)},_syncSelectionFromLayer:function(A){var B=
A.features||[],H=(A.grid||this._grid).idProperty;0===B.length?this.clearSelection():(A=v.map(B,function(T){return T.attributes[H]}),l.compareIntArrays(A,this.selectedRowIds)||(this.map&&this.zoomToSelection&&0<B.length&&(B=l.calculateExtentFromFeatures(B),this.map.setExtent(B)),this.selectRows(A,!0)))},_syncSelectionFromGrid:function(A){var B=A.grid||this._grid,H=B.layer,T=A.ids;A=H.getSelectedFeatures();var M=B.idProperty,L;A=v.map(A,function(X){return X.attributes[M]});l.compareIntArrays(T,A)||
l.queryLayerForFeatures({grid:B,layer:H,ids:T}).then(u.hitch(this,function(X){X&&X.features&&(X=X.features,X.length&&(this.map&&this.zoomToSelection&&(L=l.calculateExtentFromFeatures(X),this.map.setExtent(L)),l.selectFeaturesById({grid:B,ids:T})))}))},_showRelatedRecordsCallback:function(A,B){var H=B.columnId,T=B.relationship,M=B.keyFieldValue,L=B.row,X=B.count,ba=[];if(A===this._grid){var ma=this._centerPaneNode;var ta=this._leadingPaneNode}else ba=this._relatedGridInfos.length-1,ba=this._relatedGridInfos[ba],
ma=ba.layout.centerContentPane,ta=ba.layout.leadingContentPane,this._removeButtonNode(ba.closeButton),ba.closeButton=null;this._addSmallRelatedRecordsColumn({grid:A,relationship:T});A.showFieldDetails=!1;A.showFeatureCount=!1;A.updateSelectionMode("single");A.updateHeaderText();A.hideOptionsMenu();ba=[this._shrinkGrid({grid:A,centerPane:ma,leadingPane:ta,columnId:H}),this._setUpDataForRelatedGrid({parentGrid:A,relationship:T})];n(ba).then(u.hitch(this,function(Ea){var wa=Ea[1].layer;Ea=ma;var Q;this._addHiddenColumnRules({grid:A,
columnId:H});A.refresh();A.selectRows(L[A.idProperty],!0,!0);this._showPane(Ea);var Z=this._generateSubLayout(Ea.domNode);this.resize();this._generateLayerInfo(wa).then(u.hitch(this,function(aa){this.emit("show-related-records",{grid:A,relationship:T,row:L});Q=l.findFirst(wa.relationships,"id",T.id);l.getRelationshipWhereClause({layer:wa,originRelationship:T,destinationRelationship:Q,keyValue:M}).then(u.hitch(this,function(ea){this._setUpRelatedGrid({parentGrid:A,layer:wa,layerInfo:aa,relationship:T,
where:ea,layout:Z,count:X})}))}))}))},_setUpDataForRelatedGrid:function(A){var B=A.relationship.relatedTableId;return this._setUpRelatedLayer({baseLayer:A.parentGrid.layer,layerId:B}).then(function(H){return{layer:H,layerId:B}})},_generateSubLayout:function(A){var B=this.css,H=B.contentPane+" "+B.hidden;var T=new G({className:B.borderContainer+" "+B.leftMargin,gutters:!1,design:"headline"});B=new R({className:B.contentPane,region:"leading"});H=new R({className:H,region:"center"});var M=r.create("div",
null,B.domNode);T.addChild(B);T.addChild(H);T.placeAt(A);T.startup();return{borderContainer:T,leadingContentPane:B,centerContentPane:H,containerNode:M}},_setUpRelatedGrid:function(A){var B=this,H=A.layer,T=A.layerInfo,M=T.idProperty,L=A.parentGrid,X=A.relationship,ba=A.layout,ma=A.where||null,ta=A.count||null;A=v.map(this._relatedGridInfos,function(Q){return Q.grid.layer.layerId});A.unshift(this._grid.layer.layerId);var Ea=[{label:this._i18nStrings.close,callback:function(){B._removeGrid(this)}}],
wa=new q({map:this.map,layer:H,layerInfo:T,idProperty:M,customFieldInfos:this._getCustomFieldInfos(H),expressionInfos:this._getExpressionInfos(H),defaultSort:{attribute:M,descending:!1},outFields:["*"],where:ma,gridOptions:this.gridOptions,dateOptions:this.dateOptions,batchCount:this.batchCount,editable:this.editable,editOn:this.editOn,css:this.css,showAttachments:!(!this.showAttachments||!T.hasAttachments),showRelatedRecords:!0,showCyclicalRelationships:this.showCyclicalRelationships,showStatistics:this.showStatistics,
showFieldDetails:!1,showGridHeader:this.showGridHeader,showGridMenu:this.showGridMenu,showFeatureCount:this.showFeatureCount,showDataTypes:this.showDataTypes,showColumnHeaderTooltips:this.showColumnHeaderTooltips,showColumnHeaderTooltipsWithDescription:this.showColumnHeaderTooltipsWithDescription,showColumnHider:this.showColumnHiderButton,menuFunctions:Ea,showFilterMenuItems:!1,showDefaultSortMenuItem:this.showDefaultSortMenuItem,syncSelection:!1,showExpressionFields:this.showExpressionFields,visibleLayerIds:A},
ba.containerNode);wa.startup();this._wireUpGridEvents(wa);this._wireUpRelatedGridEvents({grid:wa,parentGrid:L,relationship:X});wa.showLoadingIndicator();wa.updateNoDataMessage("");wa.setHeaderTitle(this._i18nStrings.loadingData);wa.resize();M=this._generateColumnSwitcherButton(L);A=this._generateGridCloseButton(wa);this._relatedGridInfos.push({grid:wa,parentGrid:L,layout:ba,relationship:X,pickerButton:M,closeButton:A});this._setUpColumns({grid:wa,layer:H});if(l.isValueEmpty(ta))return l.queryLayerForCount({layer:H,
layerInfo:T}).then(u.hitch(this,function(Q){wa.set("featureCount",Q);wa.updateHeaderText();this._generateStore({grid:wa,layer:H,layout:ba,layerInfo:T,where:ma,count:Q,filterIds:null}).then(u.hitch(this,function(Z){Q||wa.updateNoDataMessage(this._noDataMessage);wa.updateStore(Z);wa.hideLoadingIndicator()}))})).otherwise(u.hitch(this,function(){this._showLoadError();wa.updateNoDataMessage(this._noDataMessage)}));wa.set("featureCount",ta);wa.updateHeaderText();this._generateStore({grid:wa,layer:H,layout:ba,
layerInfo:T,where:ma,count:ta,filterIds:null}).then(u.hitch(this,function(Q){ta||wa.updateNoDataMessage(this._noDataMessage);wa.updateStore(Q);wa.hideLoadingIndicator()})).otherwise(u.hitch(this,function(){this._showLoadError();wa.updateNoDataMessage(this._noDataMessage)}))},_setUpRelatedLayer:function(A){var B=new m,H=l.initFeatureLayer(A.baseLayer,A.layerId);H.loaded?B.resolve(H):f(H,"load",function(){B.resolve(H)});return B},_showPane:function(A){A&&A.domNode&&p.remove(A.domNode,this.css.hidden)},
_hidePane:function(A){A&&A.domNode&&p.add(A.domNode,this.css.hidden)},_shrinkGrid:function(A){var B=new m,H=A.grid,T=A.leadingPane,M=A.finalWidth||220;A=x.animateProperty({node:T.id,properties:{width:{start:function(){return T.domNode.getBoundingClientRect().width},end:function(){return M}}}}).play();f(A,"End",function(){B.resolve(H)});return B},_growGrid:function(A){A=A.grid;this._removeSmallRelatedRecordsColumn(A);this._removeHiddenColumnRules(A);A.showColumnHider&&A.showColumnHiderButton();if(A===
this._grid){var B=this._centerPaneNode;var H=this._leadingPaneNode;A.showFieldDetails=this.showFieldDetails;this.emit("hide-related-records")}else{var T=this._relatedGridInfos.length-1;T=this._relatedGridInfos[T];B=T.layout.centerContentPane;H=T.layout.leadingContentPane;T.closeButton=this._generateGridCloseButton(A)}this._hidePane(B);H.domNode&&a.set(H.domNode,"width","100%");A.updateSelectionMode(this.gridOptions.selectionMode);A.showFeatureCount=this.showFeatureCount;A.updateHeaderText();this.showGridMenu&&
A.showOptionsMenu();A.resize();this.resize()},_removeGrid:function(A){if(A!==this._grid){var B=l.findFirst(this._relatedGridInfos,"grid",A),H=B.parentGrid,T=B.layout.borderContainer,M=B.layout.leadingContentPane;this._hidePane(B.layout.centerContentPane);M.domNode&&a.set(M.domNode,"width","100%");this._removeButtonNode(B.pickerButton);this._relatedGridInfos.pop();A.destroy();T.destroy();this._growGrid({grid:H})}},_addHiddenColumnRules:function(A){var B=A.grid,H=A.columnId;A=B.getColumns();A=Object.keys(A);
var T=[],M;T=v.map(A,function(L,X){M=X===H?"display: table-cell;":"display: none;";return B.styleColumn(L,M)});this._columnRules[B.id]=T},_removeHiddenColumnRules:function(A){v.forEach(this._columnRules[A.id],function(B){B.remove()});this._columnRules[A.id]=[]},_addSmallRelatedRecordsColumn:function(A){var B=A.grid,H=A.relationship.id,T=B.idProperty;B.columns.push({unhidable:!0,label:"esriRelatedRecordsSmall",field:"esriRelatedRecordsSmall",get:function(M){M=B._getRelatedRecordsCount({featureId:M[T],
relationshipId:H});return g.substitute(B._i18nStrings.parenValue,{value:M})}})},_removeSmallRelatedRecordsColumn:function(A){var B=A.columns;"esriRelatedRecordsSmall"===(B&&B[B.length-1]?B[B.length-1].field:null)&&(B.pop(),A.refresh())},_generateGridCloseButton:function(A){var B=this.css;B=r.create("div",{className:B.menuItem+" "+B.button+" "+B.closeIcon,tabIndex:0});r.place(B,A._menuNode,"before");f(B,N,u.hitch(this,function(){this._removeGrid(A)}));return B},_generateColumnSwitcherButton:function(A){var B=
A._gridHeaderNode.domNode,H=this._generateColumnSwitcherMenu(A);A=this.css;var T=this._i18nStrings;var M=r.create("div",{title:T.columnSelectionMenu,"aria-label":T.columnSelectionMenu,className:A.menuItem+" "+A.button+" "+A.menuIcon,tabIndex:0},B);f(M,[N,"keydown"],u.hitch(this,function(L){var X=M.getBoundingClientRect(),ba=X.top+X.height;X=this.isLeftToRight()?X.right-X.width:X.right;H._openMyself({target:L.target,delegatedTarget:M,iframe:null,coords:{x:X,y:ba}})}));return M},_generateColumnSwitcherMenu:function(A){var B=
A.fieldInfos,H=this.css,T;var M=new J({className:H.optionsMenu});v.forEach(A.columns,function(L){var X=parseInt(L.id,10),ba=l.findFirst(B,"name",L.field);"esriRelatedRecords"===L.type||"esriRelatedRecordsSmall"===L.field||"esriAttachments"===L.type||"esriFieldTypeGUID"===ba.type||"esriFieldTypeGlobalID"===ba.type||-1!==v.indexOf(A._unsupportedFieldTypes,ba.type)||L.hidden||(T=new D({label:L.label||L.field,baseClass:H.menuItem,tabIndex:1}),f(T,N,u.hitch(this,function(){this._removeHiddenColumnRules(A);
this._addHiddenColumnRules({grid:A,columnId:X});this.emit("column-focus-change",{fieldInfo:ba,column:L})})),M.addChild(T))},this);M.startup();return M},_removeButtonNode:function(A){A&&A&&A.parentNode&&A.parentNode.removeChild(A)},_showDetailedFieldViewCallback:function(A,B){var H=B.columnId,T=B.fieldInfo,M=this._centerPaneNode,L=this._leadingPaneNode,X=L.domNode.getBoundingClientRect().width/6,ba;A.showFeatureCount=!1;A.showFieldDetails=!1;A.updateHeaderText();A.hideOptionsMenu();this._shrinkGrid({grid:A,
centerPane:M,leadingPane:L,columnId:H,finalWidth:X}).then(u.hitch(this,function(){ba=this._generateColumnSwitcherButton(A);this._addHiddenColumnRules({grid:A,columnId:H});A.updateSelectionMode("single");A.refresh();this.resize();this.emit("show-detailed-field-view",{columnId:H,grid:A,fieldInfo:T,pickerButton:ba})}))},_updatePopupInfosDateFormat:function(A){v.forEach(A,function(B){B.format&&B.format.dateFormat&&(B.format.dateFormat=this._popupDateFormats[B.format.dateFormat])},this);return A}});u.setObject("dijit.FeatureTable",
t,e);return t})},"esri/dijit/FeatureTable/Grid":function(){define("../../kernel ../../arcadeProfiles/popupProfile ./dataUtils ./dialogUtils dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/has dojo/keys dojo/on dojo/string dojo/dom-class dojo/dom-construct dojo/Deferred dojox/html/entities dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_WidgetBase dijit/a11yclick dijit/focus dijit/Menu dijit/MenuItem dijit/Tooltip dijit/form/Button dijit/form/DateTextBox dijit/form/DropDownButton dijit/form/NumberTextBox dijit/form/Select dijit/form/SimpleTextarea dijit/form/TimeTextBox dijit/form/ValidationTextBox dijit/layout/BorderContainer dijit/layout/ContentPane dgrid/OnDemandGrid dgrid/Selection dgrid/selector dgrid/Keyboard dgrid/editor dgrid/extensions/Pagination dgrid/extensions/DijitRegistry dgrid/extensions/ColumnHider dgrid/extensions/ColumnResizer dojo/i18n!../../nls/jsapi dojo/text!./templates/Grid.html".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D,K,G,I,R,A,B,H,T,M,L,X,ba,ma,ta,Ea,wa){c=l([v,w,u],{declaredClass:"esri.dijit.FeatureTable.Grid",baseClass:"esri-feature-table-grid",templateString:wa,map:null,layer:null,layerInfo:null,idProperty:"id",sort:null,defaultSort:null,filterIds:null,where:null,batchCount:50,editable:!1,editOn:"dblclick, keypress",css:null,showAttachments:!1,showRelatedRecords:!1,showCyclicalRelationships:!1,showStatistics:!1,showFieldDetails:!1,showGridHeader:!0,
showGridMenu:!0,showFilterMenuItems:!0,showDefaultSortMenuItem:!0,showFeatureCount:!0,showDataTypes:!1,showColumnHeaderTooltips:!1,showColumnHeaderTooltipsWithDescription:!1,showColumnHider:!1,syncSelection:!1,menuFunctions:null,columnMenuFunctions:null,gridOptions:null,dateOptions:null,visibleLayerIds:null,showExpressionFields:!1,loaded:!1,store:null,columns:null,fieldInfos:null,customFieldInfos:null,expressionInfos:null,expressionCache:{},noDataMessage:"",featureCount:0,selectedFeatureCount:0,selectedRows:null,
selectedRowIds:null,optionsMenu:null,optionsMenuAnchor:null,columnMenu:null,rollbackInfos:null,attachmentInfos:null,relatedRecordInfos:null,relatedRecordCounts:null,_i18nStrings:Ea.widgets.FeatureTable,_numericFieldTypes:["esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeSmallInteger","number"],_unsupportedFieldTypes:["esriFieldTypeRaster","esriFieldTypeBlob","esriFieldTypeGeometry","esriFieldTypeXML"],_activeEditors:[],_relationshipColumnLimit:5,_nullConstant:"ft_null",
_watchers:null,_tableTitle:null,_previousSelectedRowIds:null,_loading:0,_lastClickedCell:null,postMixInProperties:function(){this.inherited(arguments);this.set({sort:{},columns:[],fieldInfos:[],selectedRows:[],selectedRowIds:[],rollbackInfos:{},attachmentInfos:{},relatedRecordInfos:{},relatedRecordCounts:{},_watchers:[],_previousSelectedRowIds:[]})},startup:function(){this.inherited(arguments);this.showExpressionFields&&this.expressionInfos&&(this.expressionCache=q.compileExpressions(this.expressionInfos));
this.dGrid=this._generateBaseGrid();this._cleanUpGrid();this.dGrid.startup();this.dGrid.resize();this.updateHeaderText();this._generateOptionsMenu();this.showGridHeader||this.hideHeader();this.showGridMenu||this.hideOptionsMenu();this._addGridListeners()},destroy:function(){this.inherited(arguments);this.optionsMenu&&this.optionsMenu.destroy();this.columnMenu&&this.columnMenu.destroyRecursive();r.forEach(this._watchers,function(Q){Q.remove()})},resize:function(){this._gridBorderContainerNode&&this._gridBorderContainerNode.resize();
this._gridHeaderNode&&this._gridHeaderNode.resize();this._gridContentPaneNode&&this._gridContentPaneNode.resize();this.dGrid&&this.dGrid.resize()},setHeaderTitle:function(Q){q.sanitizer&&(Q=q.sanitizer.sanitize(Q));this._gridTitleNode&&(this._gridTitleNode.innerHTML=Q)},showHeader:function(){g.remove(this._gridHeaderNode.domNode,this.css.hidden);this.resize()},hideHeader:function(){g.add(this._gridHeaderNode.domNode,this.css.hidden);this.resize()},showLoadingIndicator:function(){this._gridLoadingIndicatorNode&&
0===this._loading&&g.remove(this._gridLoadingIndicatorNode,this.css.hidden);this._loading++},hideLoadingIndicator:function(){this._loading--;this._gridLoadingIndicatorNode&&!this._loading&&g.add(this._gridLoadingIndicatorNode,this.css.hidden)},showOptionsMenu:function(){this._menuNode&&g.remove(this._menuNode,this.css.hidden)},hideOptionsMenu:function(){this._menuNode&&g.add(this._menuNode,this.css.hidden)},updateNoDataMessage:function(Q){this.dGrid.set("noDataMessage",Q)},showColumnHiderMenu:function(){this.gridOptions.columnHider&&
this.dGrid._toggleColumnHiderMenu()},refresh:function(){this.dGrid&&this.dGrid.refresh();0===this.featureCount&&this.hideLoadingIndicator();this._updateSelection().then(p.hitch(this,this.updateHeaderText))},getRowById:function(Q){return this.dGrid.row(Q)||{}},getRowDataById:function(Q){return(Q=this.getRowById(Q))&&Q.data?Q.data:{}},emptyStore:function(){this.updateNoDataMessage("");this.updateStore(null)},updateStore:function(Q){this.set("store",Q);this.dGrid.set("store",Q)},updateSort:function(Q){this.set("sort",
Q[0]);this.dGrid.set("sort",Q)},updateSelectionMode:function(Q){this.dGrid.set("selectionMode",Q)},getColumns:function(){return this.dGrid.columns},styleColumn:function(Q,Z){return this.dGrid.styleColumn(Q,Z)},clearSelection:function(){this.dGrid.clearSelection();this._updateSelection().then(p.hitch(this,this.updateHeaderText));this.emit("clear-selection")},centerOnSelection:function(){var Q=this.map,Z=this.selectedRowIds;if(Q&&Z&&0!==Z.length)return q.queryLayerForFeatures({layer:this.layer,ids:Z}).then(p.hitch(function(aa){(aa=
aa.features)&&0<aa.length&&Q.setExtent(q.calculateExtentFromFeatures(aa))}))},selectRows:function(Q,Z,aa){var ea=this.dGrid,oa=[];this._closeCellEditors();this.clearSelection();if(Q instanceof Array){r.forEach(Q,function(za){ea._select(za);oa.push(this.getRowById(za))},this);var ra=Q[0]}else ea._select(Q),ra=Q,oa=[this.getRowById(Q)];this._updateSelection().then(p.hitch(this,function(){this.updateHeaderText();aa||this.emit("row-select",{rows:oa,grid:this.dGrid});Z&&this._scrollToRow(ra)}))},_generateBaseGrid:function(){var Q=
this.gridOptions||{},Z=[ba,B,H,L,T,M];Q.pagination&&Z.push(X);Q.columnHider&&Z.push(ma);Q.columnResizer&&Z.push(ta);return new (l(Z))({columns:this.columns,sort:[this.defaultSort],noDataMessage:this.noDataMessage,selectionMode:Q.selectionMode,allowSelectAll:Q.allowSelectAll,allowTextSelection:Q.allowTextSelection,cellNavigation:Q.cellNavigation,keepScrollPosition:Q.keepScrollPosition,pageSizeOptions:Q.pageSizeOptions,queryRowsOverlap:Q.queryRowsOverlap,minRowsPerPage:this.batchCount,maxRowsPerPage:this.batchCount,
pagingDelay:this.pagingDelay,query:p.hitch(this,this._getQueryForGrid)},this._gridNode)},_getQueryForGrid:function(Q){return!this.filterIds||-1!==r.indexOf(this.filterIds,Q[this.idProperty])},_cleanUpGrid:function(){var Q=this.dGrid,Z=a.before(Q,"removeRow",p.hitch(this,function(ea){r.forEach(this.columns.length,function(oa,ra){var za=Q.cell(ea,ra).element;(za=za.contents||za)&&za.widget&&za.widget.destroyRecursive()})})),aa=a.after(Q,"renderHeader",function(){Q._sortListener.remove()});this._watchers.push(Z,
aa)},_setUpColumns:function(Q){Q=this._generateFieldInfos(Q);var Z=this._generateColumns(Q);this.set({columns:Z,fieldInfos:Q});this.dGrid.set("columns",Z);return{fieldInfos:Q,columns:Z}},_generateFieldInfos:function(Q){if(Q&&0!==Q.length&&this.layerInfo){Q=this._orderFieldsForDisplay(Q);var Z=this.layer,aa=this.layerInfo,ea=[],oa=this.customFieldInfos;r.forEach(Q,function(ra){var za=ra.name,ya=ra.length||null,Ha=q.findFirst(Z.fields,"name",za)||{},ua=q.findFirst(oa,"name",za)||q.findFirst(oa,"fieldName",
za);if(q.isExpressionField(za)){Ha=q.getExpressionInfo(this.expressionInfos,za);var Y=U.isAsync(this.expressionCache[Ha.name]);ea.push({name:Ha.name,expression:!0,hasFeatureSetOperations:Y,length:ya,hidden:!ua.visible,alias:ra.alias,type:ra.type,editable:ra.editable,nullable:ra.nullable,domain:!1,typeId:!1,subtypeField:!1,subtypeDomain:!1,format:ua.format||null,dateOptions:null,description:ra.description})}else{var da=this.idProperty,ka=this.outFields,W=this.hiddenFields;Y=ua&&(ua.label||ua.alias)||
Ha.alias;var fa=Z.getDomain&&Z.getDomain(za)?Z.getDomain(za):!1;var ha=!(!aa.typeIdField||za!==aa.typeIdField);var sa=!(!aa.subtypeField||za!==aa.subtypeField);var Fa=aa.types&&r.some(aa.types,function(Oa){if(Oa.domains&&Oa.domains[za]&&Oa.domains[za].name)return!0});ka=!this._getFieldVisibility({field:ra,hiddenFields:W,customFieldInfo:ua,outFields:ka});W=aa.editable&&aa.editCapabilities.canUpdate;var Ma=ua&&("undefined"!==typeof ua.editable&&!1!==Ha.editable||"undefined"!==typeof ua.isEditable&&
!1!==Ha.isEditable);da=W&&za!==da&&Ha&&"undefined"!==Ha.editable?Ma?!!ua.editable||!!ua.isEditable:!!Ha.editable:!1;W=ua&&ua.format?ua.format:null;ea.push({name:za,alias:Y,length:ya,type:ra.type,hidden:ka,editable:da,nullable:!!Ha.nullable,domain:fa,typeId:ha,subtypeField:sa,subtypeDomain:Fa,format:W,dateOptions:ua&&(ua.dateOptions||ua.format&&ua.format.dateFormat)||null,stringOptions:ua&&ua.stringOptions?ua.stringOptions:null,description:ra.description})}},this);r.every(ea,function(ra){return ra.hidden})&&
(q.findFirst(ea,"name",this.idProperty).hidden=!1);this.showRelatedRecords&&(Q=this._generateRelatedRecordFieldInfos({relationships:Z.relationships}),ea=ea.concat(Q));this.showAttachments&&ea.push({alias:this._i18nStrings.photosAndFiles,name:"esriAttachments",type:"esriAttachments",editable:aa.editable});return ea}},_destroyColumns:function(){this.dGrid&&this.dGrid._destroyColumns()},_getFieldVisibility:function(Q){var Z=Q.field,aa=Q.outFields,ea=Q.customFieldInfo;Q=-1!==r.indexOf(Q.hiddenFields,
Z.name);ea=!(!ea||!1!==ea.visible);aa="*"!==aa[0]&&-1===r.indexOf(aa,Z.name);Z="esriFieldTypeOID"===Z.type||"esriFieldTypeGlobalID"===Z.type;return!(Q||Z&&(ea||aa)||ea||aa)},_applyEdits:function(Q){var Z=Q.row,aa=Q.rollbackInfo;this.showLoadingIndicator();aa&&this._updateRollbackInfos(aa);this.emit("data-change",{row:Z,rollbackInfo:aa});return q.applyEditsFromRow({layer:this.layer,idProperty:this.idProperty,row:Z}).then(p.hitch(this,function(ea){var oa=ea.updates||[];oa&&oa.length&&r.forEach(oa,function(ra){ra.success||
(ra.error?this.emit("error",{message:ra.error}):this.emit("error",{message:this._i18nStrings.errorUpdateFailed}),aa?(Z=this.getRowDataById(aa.rowId),Z[aa.fieldName]=aa.oldValue,this.dGrid.updateDirty(aa.rowId,aa.fieldName,aa.oldValue),this.refresh()):this.emit("error",{message:this._i18nStrings.errorRollback}))},this);this.hideLoadingIndicator();this.emit("edits-complete",ea)})).otherwise(p.hitch(this,function(){aa&&(Z=this.getRowDataById(aa.rowId),Z[aa.fieldName]=aa.oldValue,this.dGrid.updateDirty(aa.rowId,
aa.fieldName,aa.oldValue),this.refresh());this.hideLoadingIndicator();this.emit("error",{message:this._i18nStrings.errorUpdateFailed})}))},_updateRollbackInfos:function(Q){if(Q){var Z=Q.rowId;this.rollbackInfos[Z]||(this.rollbackInfos[Z]=[]);this.rollbackInfos[Z].push(Q)}},_updateSelection:function(){var Q=this.dGrid.selection,Z=new m,aa=[],ea=[],oa;for(oa in Q)if(Q.hasOwnProperty(oa)){var ra=parseInt(oa,10);ea.push(ra);ra=this.dGrid.row(ra);(ra=ra.data)&&aa.push(ra)}Q={selectedRows:aa,selectedRowIds:ea,
selectedFeatureCount:ea.length};this.set(Q);Z.resolve(Q);return Z},_scrollToRow:function(Q){var Z=this.store,aa=this.dGrid,ea=aa.row(Q),oa=this.sort;if(ea&&Z)if(ea.element)ea.element.scrollIntoView();else if(Q=Z.data[Q]||ea.data)Z=oa&&oa.attribute===this.idProperty&&oa.descending?Z.data.length-r.indexOf(Z.data,Q):r.indexOf(Z.data,Q),aa.scrollTo({x:0,y:aa.rowHeight*Z-aa.rowHeight}),ea.element?ea.element.scrollIntoView():setTimeout(function(){ea.element&&ea.element.scrollIntoView()},200)},_generateColumns:function(Q){Q=
p.clone(Q)||[];var Z=[];r.forEach(Q,function(aa){aa.expression?Z.push(this._generateExpressionColumn(aa)):"esriAttachments"===aa.type?Z.push(this._generateAttachmentsColumn(aa)):"esriRelatedRecords"===aa.type?Z.push(this._generateRelatedRecordsColumn(aa)):"esriFieldTypeDate"===aa.type?this.dateOptions.timeEnabled||aa.dateOptions&&aa.dateOptions.timeEnabled?Z.push(this._generateDateTimeColumn(aa)):Z.push(this._generateDateColumn(aa)):!aa.subtypeDomain||aa.typeId||aa.subtypeField?aa.domain?Z.push(this._generateDomainColumn(aa)):
aa.typeId?Z.push(this._generateTypeColumn(aa,"types","id")):aa.subtypeField?Z.push(this._generateTypeColumn(aa,"subtypes","code")):-1<r.indexOf(this._numericFieldTypes,aa.type)?Z.push(this._generateNumberColumn(aa)):-1===r.indexOf(this._unsupportedFieldTypes,aa.type)&&Z.push(this._generateStringColumn(aa)):Z.push(this._generateSubtypeDomainColumn(aa))},this);return Z},_orderFieldsForDisplay:function(Q){var Z=this.outFields,aa=this.idProperty,ea=[];if(Z&&"*"===Z[0])ea=p.clone(Q);else{if(!q.isValueEmpty(aa)&&
-1===r.indexOf(Z,aa)){var oa=q.findFirst(Q,"name",aa);oa&&ea.push(oa)}r.forEach(Z,function(ra){var za=q.findFirst(Q,"name",ra);za&&ra!==aa&&-1===r.indexOf(ea,za)&&ea.push(za)},this);r.forEach(Q,function(ra){-1===r.indexOf(ea,ra)&&ea.push(p.clone(ra))})}return ea},_generateDateColumn:function(Q){var Z=Q.dateOptions||this.dateOptions;return{label:Q.alias,field:Q.name,type:Q.type,hidden:Q.hidden,className:this.css.dateValue,get:p.hitch(this,function(aa){return q.isValueEmpty(aa[Q.name])?null:q.formatDateForLocale({dateOptions:Z,
timestamp:new Date(aa[Q.name]),fieldInfo:Q})}),renderCell:p.hitch(this,function(aa,ea,oa){ea=n.create("div",{innerHTML:q.isValueEmpty(ea)?"":ea},oa);this._setUpDateCell({row:aa,cellNode:oa,fieldInfo:Q,container:ea})}),renderHeaderCell:p.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:Q})})}},_generateDateTimeColumn:function(Q){return{label:Q.alias,field:Q.name,type:Q.type,hidden:Q.hidden,className:this.css.dateValue,get:p.hitch(this,function(Z){return q.isValueEmpty(Z[Q.name])?
null:q.formatDateForLocale({dateOptions:Q.dateOptions||this.dateOptions,timestamp:new Date(Z[Q.name]),fieldInfo:Q})}),renderCell:p.hitch(this,function(Z,aa,ea){aa=n.create("div",{innerHTML:q.isValueEmpty(aa)?"":aa},ea);this._setUpDateTimeCell({row:Z,cellNode:ea,fieldInfo:Q,container:aa})}),renderHeaderCell:p.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:Q})})}},_generateDomainColumn:function(Q){return{label:Q.alias,field:Q.name,type:Q.type,hidden:Q.hidden,get:function(Z){return q.getDomainValueFromRow({fieldInfo:Q,
row:Z})},renderHeaderCell:p.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:Q})}),renderCell:p.hitch(this,function(Z,aa,ea){var oa=n.create("div");if(Q.domain.codedValues)aa=this._formatStringCellContent({fieldInfo:Q,value:aa}),aa=String(aa),aa=t.encode(aa),this._setUpCodedValueDomainCell({row:Z,cellNode:ea,fieldInfo:Q,container:oa});else if("range"===Q.domain.type)aa=this._formatNumberCellContent({fieldInfo:Q,value:aa}),this._setUpRangeDomainCell({row:Z,cellNode:ea,fieldInfo:Q,
container:oa});else{this.emit("error",{message:this._i18nStrings.errorDomainType});return}oa.innerHTML=aa;n.place(oa,ea)})}},_generateTypeColumn:function(Q,Z,aa){return{label:Q.alias,field:Q.name,type:Q.type,hidden:Q.hidden,get:p.hitch(this,function(ea){var oa=q.getTypeValueFromRow({layerInfo:this.layerInfo,fieldInfo:Q,row:ea,typesProperty:Z,typeIdProperty:aa});return q.isValueEmpty(oa)?ea[Q.name]:oa}),renderCell:p.hitch(this,function(ea,oa,ra){oa=this._formatStringCellContent({fieldInfo:Q,value:oa});
oa=n.create("div",{innerHTML:oa},ra);this._setUpTypeCell({row:ea,cellNode:ra,fieldInfo:Q,container:oa,typesProperty:Z,typeIdProperty:aa})}),renderHeaderCell:p.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:Q})})}},_generateSubtypeDomainColumn:function(Q){return{label:Q.alias,field:Q.name,type:Q.type,hidden:Q.hidden,editOn:this.editOn,editor:"text",get:p.hitch(this,function(Z){return q.getSubtypeDomainValue({layerInfo:this.layerInfo,fieldInfo:Q,row:Z})}),renderHeaderCell:p.hitch(this,
function(){return this._getColumnHeaderCellContent({fieldInfo:Q})}),renderCell:p.hitch(this,function(Z,aa,ea){aa=this._formatStringCellContent({fieldInfo:Q,value:aa});aa=n.create("div",{innerHTML:aa},ea);this._setUpSubtypeDomainCell({row:Z,cellNode:ea,fieldInfo:Q,container:aa})})}},_generateNumberColumn:function(Q){return{label:Q.alias,field:Q.name,type:Q.type,hidden:Q.hidden,renderHeaderCell:p.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:Q})}),renderCell:p.hitch(this,
function(Z,aa,ea){aa=this._formatNumberCellContent({fieldInfo:Q,value:aa});aa=n.create("div",{innerHTML:aa},ea);this._setUpNumberCell({row:Z,cellNode:ea,fieldInfo:Q,container:aa})})}},_generateStringColumn:function(Q){return{label:Q.alias,field:Q.name,type:Q.type,hidden:Q.hidden,renderHeaderCell:p.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:Q})}),renderCell:p.hitch(this,function(Z,aa,ea){aa=this._formatStringCellContent({fieldInfo:Q,value:aa});aa=n.create("div",{innerHTML:aa},
ea);this._setUpStringCell({row:Z,cellNode:ea,fieldInfo:Q,container:aa})})}},_generateAttachmentsColumn:function(Q){var Z=this.layerInfo||{};return{label:Q.alias,field:Q.name,type:"esriAttachments",sortable:!1,get:p.hitch(this,function(aa){aa=this.attachmentInfos[aa[this.idProperty]];var ea=Z.queryAttachmentsSupported?0:null;return aa&&aa.attachments?aa.attachments.length:ea}),renderCell:p.hitch(this,function(aa,ea,oa){this._generateAttachmentsCell({row:aa,fieldInfo:Q,cellValue:ea,cellNode:oa})}),
renderHeaderCell:p.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:Q,cssClass:this.css.attachmentsTitle})})}},_generateRelatedRecordsColumn:function(Q){return{label:Q.alias,field:Q.name,type:"esriRelatedRecords",hidden:Q.hidden,sortable:!1,get:p.hitch(this,function(Z){return this._getRelatedRecordsCount({featureId:Z[this.idProperty],relationshipId:Q.relationship.id})}),renderCell:p.hitch(this,function(Z,aa,ea){this._generateRelatedRecordsCell({row:Z,fieldInfo:Q,cellValue:aa,
cellNode:ea})}),renderHeaderCell:p.hitch(this,function(){return this._getColumnHeaderCellContent({fieldInfo:Q,cssClass:this.css.relatedRecordsTitle})})}},_generateExpressionColumn:function(Q){return{label:Q.alias,field:Q.name,type:"esriExpressions",sortable:!1,get:p.hitch(this,function(Z){return Q.hasFeatureSetOperations?null:this._getExpressionValueForField(Q.name,Z)}),renderCell:p.hitch(this,function(Z,aa,ea){this._generateExpressionCell({row:Z,fieldInfo:Q,cellValue:aa,cellNode:ea})}),renderHeaderCell:p.hitch(this,
function(){return this._getColumnHeaderCellContent({fieldInfo:Q,cssClass:this.css.expressionsTitle})})}},_closeCellEditors:function(){r.forEach(this._activeEditors,function(Q){Q.widget.onBlur()});this.set("_activeEditors",[])},_getColumnHeaderCellContent:function(Q){var Z=Q.fieldInfo,aa=Q.cssClass||null;Q=this.css;var ea=n.create("div",{className:Q.columnHeader});var oa=aa?Q.columnHeaderTitle+" "+aa:Q.columnHeaderTitle;!Z.editable&&this.editable&&this.layerInfo.editable&&n.create("span",{className:Q.lockedIconContainer+
" "+Q.lockedIcon},ea);aa=t.encode(Z.alias||Z.name);n.create("div",{innerHTML:aa,className:oa},ea);n.create("div",{className:Q.columnHeaderClear},ea);if(this.showColumnHeaderTooltips||this.showColumnHeaderTooltipsWithDescription)this.showColumnHeaderTooltipsWithDescription&&this.layer.supportsFieldDescription&&Z.description&&Z.description.value&&(aa+=" - "+t.encode(Z.description.value)),this.own(new F({connectId:[ea],label:"\x3cdiv class\x3d"+Q.columnHeaderTooltip+"\x3e"+aa+"\x3c/div\x3e"}));aa="esriExpressions"===
Z.type||"esriRelatedRecords"===Z.type||"esriAttachments"===Z.type;this.showDataTypes&&!aa&&(n.create("div",{innerHTML:Z.type.replace("esriFieldType",""),className:Q.columnHeaderType},ea),n.create("div",{className:Q.columnHeaderClear},ea));return ea},_setUpNumberCell:function(Q){var Z=Q.row,aa=Q.cellNode,ea=Q.fieldInfo,oa=Q.container,ra=this.idProperty,za=q.isIntegerFieldType(ea.type)?0:"0,20",ya,Ha;this.editOn===x&&h(aa,"pointerdown",p.hitch(this,function(ua){ua.preventDefault()}));h(aa,this.editOn,
p.hitch(this,function(){var ua=q.isFeatureEditable({layer:this.layer,layerInfo:this.layerInfo,attributes:Z});this.editable&&ea.editable&&!1!==ua&&!q.findFirst(this._activeEditors,"cellNode",aa)&&(this._lastClickedCell!==aa&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==aa?this._lastClickedCell=aa:(oa.innerHTML="",ya=new J({value:Z[ea.name],required:!ea.nullable,constraints:{places:za}}),ya.placeAt(oa),ya.focus(),ya.textbox.select(),this.emit("editor-show",{cell:aa,editor:ya,grid:this}),
ya.on("blur",p.hitch(this,function(){oa.innerHTML=this._formatNumberCellContent({fieldInfo:ea,value:Z[ea.name]});aa.focus();this.emit("editor-hide",{cell:aa,editor:ya,grid:this});this._activeEditors.pop()})),ya.on("keydown",function(Y){Y.keyCode===d.ENTER&&ya.isValid()&&ya.focusNode.blur()}),ya.on("change",p.hitch(this,function(Y){Ha={fieldName:ea.name,oldValue:Z[ea.name],rowId:Z[ra],row:Z};if(""===Y||isNaN(Y))Y=null;ya.isValid()?(Z[ea.name]=Y,oa.innerHTML=this._formatNumberCellContent({fieldInfo:ea,
value:Y}),this._applyEdits({row:Z,rollbackInfo:Ha})):oa.innerHTML=this._formatNumberCellContent({fieldInfo:ea,value:Z[ea.name]});ya.destroy()})),this._activeEditors.push({cellNode:aa,id:Z[ra],widget:ya})))}))},_setUpDateCell:function(Q){var Z=Q.row,aa=Q.cellNode,ea=Q.fieldInfo,oa=Q.container,ra=this.idProperty,za,ya;this.editOn===x&&h(aa,"pointerdown",p.hitch(this,function(Ha){Ha.preventDefault()}));h(aa,this.editOn,p.hitch(this,function(){var Ha=q.isFeatureEditable({layer:this.layer,layerInfo:this.layerInfo,
attributes:Z});if(this.editable&&ea.editable&&!1!==Ha)if(this._lastClickedCell!==aa&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==aa)this._lastClickedCell=aa;else{oa.innerHTML="";ya=ea.dateOptions&&ea.dateOptions.datePattern?ea.dateOptions.datePattern:this.dateOptions.datePattern;za=q.isValueEmpty(Z[ea.name])?null:new Date(Z[ea.name]);var ua=new V({value:za,constraints:{datePattern:ya}});ua.placeAt(oa);ua.focus();ua.textbox.select();this.emit("editor-show",{cell:aa,editor:ua,
grid:this});ua.on("blur",p.hitch(this,function(){oa.innerHTML=q.isValueEmpty(Z[ea.name])?null:q.formatDateForLocale({dateOptions:this.dateOptions,timestamp:Z[ea.name],fieldInfo:ea});aa.focus();this.emit("editor-hide",{cell:aa,editor:ua,grid:this});this._activeEditors.pop()}));ua.on("keydown",function(Y){Y.keyCode===d.ENTER&&ua.isValid()&&ua.focusNode.blur()});ua.on("change",p.hitch(this,function(Y){if(ua.isValid()){var da={fieldName:ea.name,oldValue:Z[ea.name],rowId:Z[ra],row:Z};Z[ea.name]=q.isValueEmpty(Y)?
null:Y.getTime();oa.innerHTML=q.isValueEmpty(Z[ea.name])?null:q.formatDateForLocale({dateOptions:this.dateOptions,timestamp:Z[ea.name],fieldInfo:ea});this._applyEdits({row:Z,rollbackInfo:da})}else oa.innerHTML=q.isValueEmpty(Z[ea.name])?null:q.formatDateForLocale({dateOptions:this.dateOptions,timestamp:Z[ea.name],fieldInfo:ea})}));this._activeEditors.push({cellNode:aa,id:Z[ra],widget:ua})}}))},_setUpDateTimeCell:function(Q){var Z=Q.row,aa=Q.cellNode,ea=Q.fieldInfo,oa=Q.container,ra=this.idProperty,
za,ya,Ha;h(aa,this.editOn,p.hitch(this,function(){var ua=q.isFeatureEditable({layer:this.layer,layerInfo:this.layerInfo,attributes:Z});if(this.editable&&ea.editable&&!1!==ua)if(this._lastClickedCell!==aa&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==aa)this._lastClickedCell=aa;else{this._closeCellEditors();oa.innerHTML="";ya=ea.dateOptions&&ea.dateOptions.datePattern?ea.dateOptions.datePattern:this.dateOptions.datePattern;Ha=ea.dateOptions&&ea.dateOptions.timePattern?ea.dateOptions.timePattern:
this.dateOptions.timePattern;za=q.isValueEmpty(Z[ea.name])?null:new Date(Z[ea.name]);var Y=new V({value:za,constraints:{datePattern:ya}}),da=new G({value:za,constraints:{timePattern:Ha}});Y.placeAt(oa);da.placeAt(oa);Y.focus();Y.textbox.select();this.emit("editor-show",{cell:aa,editor:[Y,da],grid:this});Y.on("change",p.hitch(this,function(W){Y.isValid()&&(null===W||""===W?da.setValue(null):(W=da.getValue(),null===W&&(W=new Date(0,0),da.setValue(W))))}));da.on("change",p.hitch(this,function(W){da.isValid()&&
(null===W||""===W?Y.setValue(null):(W=Y.getValue(),null===W&&(W=new Date(0,0),Y.setValue(W))))}));var ka=y.watch("activeStack",p.hitch(this,function(W,fa,ha){W=-1!==r.indexOf(fa,Y.id)||-1!==r.indexOf(fa,da.id);ha=-1===r.indexOf(ha,Y.id)&&-1===r.indexOf(ha,da.id);if(W&&ha){ka.remove();this.emit("editor-hide",{cell:aa,editor:[Y,da],grid:this});W=Y.getValue();fa=da.getValue();ha=Z[ea.name];if(da.isValid()&&Y.isValid()){W&&fa?(W=q.getCombinedDateTime(W,fa).getTime(),oa.innerHTML=q.formatDateForLocale({dateOptions:this.dateOptions,
timestamp:new Date(W),fieldInfo:ea})):(W=null,oa.innerHTML="");if(Z[ea.name]===W)return;Z[ea.name]=W;this._applyEdits({row:Z,rollbackInfo:{fieldName:ea.name,oldValue:ha,rowId:Z[ra],row:Z}})}else oa.innerHTML=null===ha?"":q.formatDateForLocale({dateOptions:this.dateOptions,timestamp:Z[ea.name],fieldInfo:ea});Y.destroy();da.destroy()}}))}}))},_setUpCodedValueDomainCell:function(Q){var Z=Q.row,aa=Q.cellNode,ea=Q.fieldInfo;this.editOn===x&&h(aa,"pointerdown",p.hitch(this,function(oa){oa.preventDefault()}));
h(aa,this.editOn,p.hitch(this,function(){var oa=q.isFeatureEditable({layer:this.layer,layerInfo:this.layerInfo,attributes:Z});if(this.editable&&ea.editable&&!1!==oa&&!q.findFirst(this._activeEditors,"cellNode",aa))if(this._lastClickedCell!==aa&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==aa)this._lastClickedCell=aa;else{var ra=ea.name;oa=ea.domain.codedValues;var za=Q.container,ya=Z[this.idProperty],Ha=[];za.innerHTML="";r.forEach(oa,function(Y){Ha.push({label:t.encode(String(Y.name)),
value:String(Y.code),selected:Z[ra]===Y.code})});q.isValueEmpty(Z[ra])?Ha.push({label:this._i18nStrings.empty,value:this._nullConstant,selected:!0,disabled:!ea.nullable}):ea.nullable&&Ha.push({label:this._i18nStrings.empty,value:this._nullConstant});var ua=new D({options:Ha,"class":this.css.select,style:{width:"100%"}});ua.placeAt(za);ua.focus();this.emit("editor-show",{cell:aa,editor:ua,grid:this});ua.on("blur",p.hitch(this,function(){var Y=q.getDomainValueFromRow({fieldInfo:ea,row:Z});Y=this._formatStringCellContent({fieldInfo:ea,
value:Y});Y=String(Y);za.innerHTML=t.encode(Y);this.emit("editor-hide",{cell:aa,editor:ua,grid:this});this._activeEditors.pop()}));ua.on("keydown",function(Y){Y.keyCode===d.ENTER&&ua.focusNode.blur()});ua.on("change",p.hitch(this,function(Y){var da={fieldName:ra,oldValue:Z[ra],rowId:ya,row:Z};Y===this._nullConstant?Y=null:q.isNumericFieldType(ea.type)&&(Y=Number(Y));Z[ra]=Y;ua.onBlur();this._applyEdits({row:Z,rollbackInfo:da});ua.destroy();ua=null}));this._activeEditors.push({cellNode:aa,id:ya,widget:ua})}}))},
_setUpRangeDomainCell:function(Q){var Z=Q.row,aa=Q.cellNode,ea=Q.fieldInfo,oa=Q.container,ra=ea.domain.minValue,za=ea.domain.maxValue,ya=this.idProperty,Ha=q.isIntegerFieldType(ea.type)?0:"0,20",ua;this.editOn===x&&h(aa,"pointerdown",p.hitch(this,function(Y){Y.preventDefault()}));h(aa,this.editOn,p.hitch(this,function(){var Y=q.isFeatureEditable({layer:this.layer,layerInfo:this.layerInfo,attributes:Z});if(this.editable&&ea.editable&&!1!==Y&&!q.findFirst(this._activeEditors,"cellNode",aa))if(this._lastClickedCell!==
aa&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==aa)this._lastClickedCell=aa;else{oa.innerHTML="";var da=new J({value:Z[ea.name],required:!ea.nullable,constraints:{min:ra,max:za,places:Ha}});da.placeAt(oa);da.focus();da.textbox.select();this.emit("editor-show",{cell:aa,editor:da,grid:this});da.on("blur",p.hitch(this,function(){oa.innerHTML=this._formatNumberCellContent({fieldInfo:ea,value:Z[ea.name]});this.emit("editor-hide",{cell:aa,editor:da,grid:this});this._activeEditors.pop()}));
da.on("keydown",function(ka){ka.keyCode===d.ENTER&&da.isValid()&&da.focusNode.blur()});da.on("change",p.hitch(this,function(ka){ua={fieldName:ea.name,oldValue:Z[ea.name],rowId:Z[ya],row:Z};da.isValid()&&(Z[ea.name]=ka,this._applyEdits({row:Z,rollbackInfo:ua}));da.onBlur();da.destroy();da=null}));this._activeEditors.push({cellNode:aa,id:Z[ya],widget:da})}}))},_setUpTypeCell:function(Q){var Z=Q.row,aa=Q.cellNode,ea=Q.fieldInfo,oa=Q.container,ra=Q.typesProperty,za=Q.typeIdProperty,ya=this.idProperty,
Ha=this.layerInfo,ua=Ha[ra],Y;this.editOn===x&&h(aa,"pointerdown",p.hitch(this,function(da){da.preventDefault()}));h(aa,this.editOn,p.hitch(this,function(){var da=q.isFeatureEditable({layer:this.layer,layerInfo:this.layerInfo,attributes:Z});if(this.editable&&ea.editable&&!1!==da&&!q.findFirst(this._activeEditors,"cellNode",aa))if(this._lastClickedCell!==aa&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==aa)this._lastClickedCell=aa;else{oa.innerHTML="";da=q.isValueEmpty(q.getTypeValueFromRow({layerInfo:this.layerInfo,
fieldInfo:ea,row:Z,typesProperty:ra,typeIdProperty:za}));var ka=ea.name,W=Z[ka],fa=[];r.forEach(ua,function(sa){fa.push({label:sa.name,value:String(sa[za]),selected:W===sa[za]})});q.isValueEmpty(W)?fa.push({label:this._i18nStrings.empty,value:this._nullConstant,selected:!0,disabled:!0}):da&&fa.push({label:String(W),value:String(W),selected:!0,disabled:!0});var ha=new D({options:fa,"class":this.css.select,style:{width:"100%"}});ha.placeAt(oa);ha.focus();this.emit("editor-show",{cell:aa,editor:ha,grid:this});
ha.on("blur",p.hitch(this,function(){var sa=q.getTypeValueFromRow({layerInfo:Ha,fieldInfo:ea,row:Z,typesProperty:ra,typeIdProperty:za});oa.innerHTML=this._formatStringCellContent({fieldInfo:ea,value:sa||W});this.emit("editor-hide",{cell:aa,editor:ha,grid:this.grid});this._activeEditors.pop()}));ha.on("keydown",function(sa){sa.keyCode===d.ENTER&&ha.focusNode.blur()});ha.on("change",p.hitch(this,function(sa){Y={fieldName:ka,oldValue:W,rowId:Z[ya],row:Z};sa===this._nullConstant?sa=null:q.isNumericFieldType(ea.type)&&
(sa=Number(sa));Z[ka]=sa;ha.onBlur();this._applyEdits({row:Z,rollbackInfo:Y});ha.destroy();ha=null}));this._activeEditors.push({cellNode:aa,id:Z[ya],widget:ha})}}))},_setUpSubtypeDomainCell:function(Q){var Z=Q.cellNode;this.editOn===x&&h(Z,"pointerdown",p.hitch(this,function(aa){aa.preventDefault()}));h(Z,this.editOn,p.hitch(this,function(){var aa=this.layerInfo,ea=Q.fieldInfo,oa=Q.row,ra=q.isFeatureEditable({layer:this.layer,layerInfo:aa,attributes:oa});if(this.editable&&ea.editable&&!1!==ra&&!q.findFirst(this._activeEditors,
"cellNode",Z))if(this._lastClickedCell!==Z&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==Z)this._lastClickedCell=Z;else{var za=oa[this.idProperty],ya=ea.name;aa=q.findFirst(aa.types,"id",oa[aa.typeIdField]);var Ha=Q.container,ua={},Y;Ha.innerHTML="";aa&&aa.domains&&(Y=aa.domains[ya]);if(Y&&"inherited"===Y.type||!Y&&ea.domain)Y=ea.domain;if(Y&&Y.codedValues){var da=Y.codedValues,ka=q.findFirst(da,"code",oa[ya]),W=!1,fa=[];r.forEach(da,function(Fa){fa.push({label:Fa.name,value:String(Fa.code),
selected:oa[ya]===Fa.code});Fa.code===ka&&(W=!0)});q.isValueEmpty(oa[ya])&&ea.nullable?fa.push({label:this._i18nStrings.empty,value:this._nullConstant,selected:!0}):q.isValueEmpty(oa[ya])&&!ea.nullable?fa.push({label:this._i18nStrings.empty,value:this._nullConstant,selected:!0,disabled:!0}):ea.nullable&&fa.push({label:this._i18nStrings.empty,value:this._nullConstant});W||ka||null===oa[ya]||fa.push({label:oa[ya].toString(),value:"N/A",selected:!0,disabled:!0});var ha=new D({options:fa,"class":this.css.select,
style:{width:"100%"}});ha.placeAt(Ha);ha.focus();this.emit("editor-show",{cell:Z,editor:ha,grid:this});ha.on("blur",p.hitch(this,function(){var Fa=q.findFirst(da,"code",oa[ya]);Ha.innerHTML=Fa?this._formatStringCellContent({fieldInfo:ea,value:Fa.name}):this._formatStringCellContent({fieldInfo:ea,value:oa[ya]});this.emit("editor-hide",{cell:Z,editor:ha,grid:this});this._activeEditors.pop()}));ha.on("keydown",function(Fa){Fa.keyCode===d.ENTER&&ha.focusNode.blur()});ha.on("change",p.hitch(this,function(Fa){ua=
{fieldName:ya,oldValue:oa[ya],rowId:za,row:oa};Fa===this._nullConstant?Fa=null:q.isNumericFieldType(ea.type)&&(Fa=Number(Fa));oa[ya]=Fa;ha.onBlur();this._applyEdits({row:oa,rollbackInfo:ua});ha.destroy();ha=null}));this._activeEditors.push({cellNode:Z,id:za,widget:ha})}else{var sa=new J({value:oa[ya],required:!ea.nullable});Y&&"range"===Y.type&&(sa.constraints={min:Y.minValue,max:Y.maxValue,places:q.isIntegerFieldType(ea.type)?0:"0,20"});sa.placeAt(Ha);sa.focus();sa.textbox.select();this.emit("editor-show",
{cell:Z,editor:sa,grid:this});sa.on("blur",p.hitch(this,function(){Ha.innerHTML=oa[ya];this.emit("editor-hide",{cell:Z,editor:sa,grid:this});this._activeEditors.pop()}));sa.on("keydown",function(Fa){Fa.keyCode===d.ENTER&&sa.isValid()&&sa.focusNode.blur()});sa.on("change",p.hitch(this,function(Fa){ua={fieldName:ya,oldValue:oa[ya],rowId:za,row:oa};if(""===Fa||isNaN(Fa))Fa=null;sa.isValid()&&(oa[ya]=Fa,this._applyEdits({row:oa,rollbackInfo:ua}));sa.onBlur();sa.destroy();sa=null}));this._activeEditors.push({cellNode:Z,
id:za,widget:sa})}}}))},_setUpStringCell:function(Q){var Z=Q.row,aa=Q.cellNode,ea=Q.fieldInfo,oa=Q.container,ra=this.idProperty;this.editOn===x&&h(aa,"pointerdown",p.hitch(this,function(za){za.preventDefault()}));h(aa,this.editOn,p.hitch(this,function(){var za=q.isFeatureEditable({layer:this.layer,layerInfo:this.layerInfo,attributes:Z});if(this.editable&&ea.editable&&!1!==za&&!q.findFirst(this._activeEditors,"cellNode",aa))if(this._lastClickedCell!==aa&&this._closeCellEditors(),this.editOn===x&&this._lastClickedCell!==
aa)this._lastClickedCell=aa;else{oa.innerHTML="";za=ea.stringOptions;var ya=za&&za.input&&"textarea"===za.input?new K({value:Z[ea.name],required:!ea.nullable,maxLength:ea.length?ea.length:null,trim:!0}):new I({value:Z[ea.name],required:!ea.nullable,maxLength:ea.length?ea.length:null});ya.placeAt(oa);ya.focus();ya.textbox.select();this.emit("editor-show",{cell:aa,editor:ya,grid:this});ya.on("blur",p.hitch(this,function(){oa.innerHTML=this._formatStringCellContent({fieldInfo:ea,value:Z[ea.name]});aa.focus();
this.emit("editor-hide",{cell:aa,editor:ya,grid:this});this._activeEditors.pop()}));ya.on("keydown",function(Ha){Ha.keyCode===d.ENTER&&ya instanceof I&&ya.isValid()&&ya.focusNode.blur()});ya.on("change",p.hitch(this,function(Ha){var ua={fieldName:ea.name,oldValue:Z[ea.name],rowId:Z[ra],row:Z};""===Ha&&(Ha=null);ya instanceof I&&ya.isValid()?(Z[ea.name]=Ha,this._applyEdits({row:Z,rollbackInfo:ua})):ya instanceof K&&(!q.isValueEmpty(Ha)||q.isValueEmpty(Ha)&&ea.nullable)&&(Z[ea.name]=Ha,this._applyEdits({row:Z,
rollbackInfo:ua}));oa.innerHTML=this._formatStringCellContent({fieldInfo:ea,value:Z[ea.name]});ya.destroy();ya=null}));this._activeEditors.push({cellNode:aa,id:Z[ra],widget:ya})}}))},_formatStringCellContent:function(Q){var Z=Q.value;Q=Q.fieldInfo?Q.fieldInfo.format:null;return q.isValueEmpty(Z)?"":Q?Q.embeddedHTML||!1===Q.link?Z:Q.template?f.substitute(Q.template,{value:Z}):Z:q.generateLinkFromString(Z)},_formatNumberCellContent:function(Q){var Z=Q.fieldInfo?Q.fieldInfo.format:null;Q=Q.value;if(q.isValueEmpty(Q))return"";
Q=q.formatNumberForLocale(Q,Z);Z&&Z.template&&(Q=f.substitute(Z.template,{value:Q}));this.isLeftToRight()||(Q='\x3cspan dir\x3d"ltr"\x3e'+Q+"\x3c/span\x3e");return Q},_generateAttachmentsCell:function(Q){if(this.layerInfo){var Z=Q.row,aa=Q.cellValue,ea=Q.cellNode,oa=Q.fieldInfo;Q=this.layerInfo;var ra=this.css,za=this._i18nStrings;var ya=q.isValueEmpty(aa)?"":f.substitute(za.parenValue,{value:aa});var Ha=n.create("div",{innerHTML:ya,className:ra.attachmentsCell},ea);n.create("span",{innerHTML:0<aa||
!Q.queryAttachmentsSupported?" "+za.show:this.editable&&Q.editable?" "+za.add:"",className:ra.attachmentsLink},Ha);h(Ha,x,p.hitch(this,function(){this._showAttachmentsHandler({row:Z,fieldInfo:oa,cellValue:aa,cellNode:ea,textContainer:Ha})}))}},_generateRelatedRecordsCell:function(Q){var Z=Q.row,aa=Q.cellValue,ea=Q.cellNode,oa=Q.fieldInfo;Q=this.css;var ra=this._i18nStrings;var za=q.isValueEmpty(aa)?"":f.substitute(ra.parenValue,{value:aa})+" ";za=n.create("div",{innerHTML:za,className:Q.relatedRecordsCell},
ea);n.create("span",{innerHTML:0<aa?ra.show:"",className:Q.relatedRecordsLink},za);h(ea,x,p.hitch(this,function(ya){0<aa&&(ya=this.dGrid.cell(ya).column,this._showRelatedRecordsHandler({row:Z,fieldInfo:oa,column:ya,count:aa}))}))},_generateExpressionCell:function(Q){var Z=Q.row,aa=Q.cellValue,ea=Q.fieldInfo,oa=n.create("div",{className:this.css.expressionsCell},Q.cellNode);if(ea.hasFeatureSetOperations)var ra=n.create("span",{innerHTML:this._i18nStrings.show,className:this.css.expressionsLink},oa),
za=h(oa,x,p.hitch(this,function(){var ya=n.create("div",{className:this.css.cellLoadingIndicator});n.place(ya,ra,"replace");(ya=this._getExpressionValueForField(ea.name,Z))&&ya.then?ya.then(p.hitch(this,function(Ha){oa.innerHTML=this._formatExpressionCellContent(ea,Ha)})).otherwise(p.hitch(this,function(Ha){oa.innerHTML=this._i18nStrings.dataError})):oa.innerHTML="";za.remove()}));else oa.innerHTML=this._formatExpressionCellContent(ea,aa)},updateHeaderText:function(Q){var Z=Q?Q.count:null,aa=Q?Q.selectedCount:
null,ea=Q?Q.title:null;Q=Q?Q.showFilterCount:!0;ea=q.isValueEmpty(ea)?this._tableTitle||this.layer.name||this._i18nStrings.untitled:ea;Z=q.isValueEmpty(Z)?this.featureCount:Z;aa=q.isValueEmpty(aa)?this.selectedFeatureCount:aa;this.filterIds&&0<this.filterIds.length&&Q&&(Z=this.filterIds.length);this.showFeatureCount?this.setHeaderTitle(f.substitute(this._i18nStrings.gridHeader,{gridTitle:ea,featureCount:Z,featureSelectedCount:aa})):this.setHeaderTitle(ea)},_generateOptionsMenu:function(){var Q=this.css,
Z=this._i18nStrings;Q=n.create("div",{className:Q.menuItem+" "+Q.button+" "+Q.menuIcon,title:Z.options,"aria-label":Z.options,tabIndex:0},this._gridMenuNode);h(Q,[x,"keydown"],p.hitch(this,function(aa){"Tab"!==aa.key&&this._showOptionsMenu(aa)}));this.optionsMenuAnchor=Q},_showOptionsMenu:function(Q){var Z=this.optionsMenuAnchor,aa=this.css;this.optionsMenu&&(this.optionsMenu.destroy(),this.optionsMenu=null);var ea=Z.getBoundingClientRect();var oa=ea.top+ea.height;var ra=this.isLeftToRight()?ea.left+
ea.width:ea.right-ea.width;var za=new C({className:aa.optionsMenu});ea=this._generateOptionsMenuItems();r.forEach(ea,function(ya){ya=new z({label:ya.label,baseClass:aa.menuItem,onClick:p.hitch(this,ya.callback)});za.addChild(ya)},this);za._openMyself({target:Q.target,delegatedTarget:Z,iframe:null,coords:{x:ra,y:oa}});this.optionsMenu=za},_generateOptionsMenuItems:function(){var Q=[];this.showDefaultSortMenuItem&&Q.push({label:this._i18nStrings.defaultSort,callback:this._sortFieldDefaultCallback});
this.showFilterMenuItems?Q.push({label:this._i18nStrings.showSelected,callback:this._showSelectedRecordsCallback},{label:this._i18nStrings.clearSelection,callback:this._clearFilterCallback}):Q.push({label:this._i18nStrings.clearSelection,callback:this.clearSelection});this.gridOptions.columnHider&&Q.push({label:this._i18nStrings.toggleColumns,callback:this.showColumnToggleMenu});this.map&&this.syncSelection&&Q.push({label:this._i18nStrings.centerOnSelection,callback:this.centerOnSelection});this.menuFunctions&&
0<this.menuFunctions.length&&r.forEach(this.menuFunctions,function(Z){Q.push({label:Z.label,callback:Z.callback})},this);return Q},_sortFieldDefaultCallback:function(){var Q=this.defaultSort.attribute,Z=this.defaultSort.descending;this.set("sort",{field:Q,descending:Z});this.emit("sort",{field:Q,descending:Z,orderByFields:[q.getOrderByString(Q,Z)]})},_showSelectedRecordsCallback:function(){0!==this.selectedRowIds.length&&this.emit("show-selected-records",{ids:this.selectedRowIds})},_clearFilterCallback:function(){this.emit("clear-selection");
this.emit("clear-filter")},showColumnToggleMenu:function(){this.dGrid._toggleColumnHiderMenu()},_generateColumnMenu:function(Q){var Z=this.dGrid.cell(Q),aa=Z?Z.column:null;if(aa){var ea=this.columnMenu,oa=this.css,ra=this.columnMenuFunctions;aa=aa.id;var za=this.dGrid.columns[aa],ya=q.findFirst(this.fieldInfos,"name",za.field);ea&&this.set("columnMenu",null);if(!1!==za.sortable){var Ha=new C({className:oa.columnMenu});this._generateSortMenuItems({menu:Ha,columnId:aa});this._generateStatisticsMenuItem({menu:Ha,
fieldInfo:ya,columnId:aa});this._generateFieldDetailsMenuItem({menu:Ha,fieldInfo:ya,column:za});ra&&0<ra.length&&r.forEach(ra,function(ua){Ha.addChild(new z({label:ua.label,iconClass:ua.iconClass||"",baseClass:ua.baseClass||"",onClick:p.hitch(this,ua.callback,ya)}))});Ha.startup();this._showColumnMenu({menu:Ha,cell:Z,evt:Q,fieldInfo:ya,previousMenu:ea});this.set("columnMenu",Ha)}}},_showColumnMenu:function(Q){var Z=Q.menu,aa=Q.cell,ea=Q.evt,oa=Q.previousMenu;var ra=aa.element.getBoundingClientRect();
Q=ra.top+ra.height;ra=this.isLeftToRight()?ra.right-ra.width:ra.right;Z._openMyself({target:ea.target,delegatedTarget:aa,iframe:null,coords:{x:ra,y:Q}});h(Z,"close",function(){oa&&(oa.destroyRecursive(),oa=null)})},_generateSortMenuItems:function(Q){var Z=Q.menu;Q=Q.columnId;var aa=this.css;Z.addChild(new z({label:this._i18nStrings.sortAsc,iconClass:aa.sortAscendingIcon,baseClass:aa.menuItem,onClick:p.hitch(this,this._sortFieldAscendingHandler,Q)}));Z.addChild(new z({label:this._i18nStrings.sortDesc,
iconClass:aa.sortDescendingIcon,baseClass:aa.menuItem,onClick:p.hitch(this,this._sortFieldDescendingHandler,Q)}))},_sortFieldAscendingHandler:function(Q){var Z=this.dGrid.columns[Q];this.emit("sort",{column:Z,id:Q,field:Z.field,descending:!1,orderByFields:[q.getOrderByString(Z.field,!1)]})},_sortFieldDescendingHandler:function(Q){var Z=this.dGrid.columns[Q];this.emit("sort",{column:Z,id:Q,field:Z.field,descending:!0,orderByFields:[q.getOrderByString(Z.field,!0)]})},_generateStatisticsMenuItem:function(Q){var Z=
Q.menu,aa=Q.fieldInfo,ea=this.css,oa=this.layer,ra=!!this.layerInfo.isFeatureCollection;oa=oa.advancedQueryCapabilities.supportsStatistics||oa.supportsStatistics;!this.showStatistics||!oa||!aa||aa.domain&&aa.domain.codedValues||aa.subtypeDomain||aa.typeId||aa.subtypeField||ra||q.isNumericFieldType(aa.type)&&Z.addChild(new z({label:this._i18nStrings.statistics,iconClass:ea.statisticsIcon,baseClass:ea.menuItem,onClick:p.hitch(this,this._showStatisticsHandler,Q)}))},_generateFieldDetailsMenuItem:function(Q){if(this.showFieldDetails){var Z=
Q.menu,aa=Q.fieldInfo,ea=parseInt(Q.column.id,10);Q=this.css;"esriFieldTypeOID"!==aa.type&&"esriFieldTypeGlobalID"!==aa.type&&-1===r.indexOf(this._unsupportedFieldTypes,aa.type)&&Z.addChild(new z({label:this._i18nStrings.showDetailedView,iconClass:Q.propertiesIcon,baseClass:Q.menuItem,onClick:p.hitch(this,function(){this.emit("show-detailed-field-view",{columnId:ea,fieldInfo:aa})})}))}},_fetchAttachments:function(Q){return q.queryLayerForAttachments({layer:this.layer,ids:Q||null})},_showAttachmentsHandler:function(Q){var Z=
Q.row,aa=Q.fieldInfo,ea=Q.cellValue,oa=Q.cellNode,ra=this.layerInfo,za=Z[this.idProperty];if(0!==ea||ra.editCapabilities.canCreate){Q=b.generateAttachmentsDialog({layer:this.layer,featureId:za,attachments:this.attachmentInfos[za]?this.attachmentInfos[za].attachments:[],editable:this.editable&&ra.editable,css:this.css});var ya=Q.featureAttachments;var Ha=ya.attachments;this.own(ya.on("add-complete",p.hitch(this,function(ua){this.attachmentInfos[za]||(this.attachmentInfos[za]={attachments:[]});this.attachmentInfos[za].attachments=
ua.attachments;ra.queryAttachmentsSupported&&(ea+=1);oa.innerHTML="";this._generateAttachmentsCell({row:Z,fieldInfo:aa,cellValue:ea,cellNode:oa});this.emit("add-attachment-complete",ua)})),ya.on("delete-complete",p.hitch(this,function(ua){this.attachmentInfos[za]||(this.attachmentInfos[za]={attachments:[]});this.attachmentInfos[za].attachments=ua.attachments;ra.queryAttachmentsSupported&&--ea;oa.innerHTML="";this._generateAttachmentsCell({row:Z,fieldInfo:aa,cellValue:ea,cellNode:oa});this.emit("delete-attachment-complete",
ua)})));this.emit("show-attachments",{featureId:za,attachments:Ha,dialog:Q.dialog})}},_updateAttachmentInfos:function(Q){return p.mixin(this.attachmentInfos,Q)},_fetchRelatedRecords:function(Q){return q.queryLayerForRelatedRecords({layer:this.layer,ids:Q.ids||null,relationship:Q.relationship,outFields:Q.outFields||["*"]})},_showRelatedRecordsHandler:function(Q){var Z=Q.row,aa=this.idProperty,ea=Z[aa],oa=Q.fieldInfo.relationship;Q=Q.count;var ra=this.columns,za=this.layer,ya=za.getField(oa.keyField),
Ha=(ya=ya?ya.name:null)?Z[ya]:null,ua;var Y=r.filter(ra,function(da){return!da.hidden});aa=[q.findFirst(Y,"field",za.displayField),q.findFirst(Y,"field",ya),q.findFirst(Y,"type","esriFieldTypeString"),q.findFirstNumberColumn(ra,aa),q.findFirst(Y,"type","esriFieldTypeDate")];r.some(aa,function(da){if(this._validateRelatedColumnDisplay(da))return ua=r.indexOf(ra,da),!0},this);q.isValueEmpty(ua)&&(ua=0);this.emit("show-related-records",{row:Z,featureId:ea,keyField:ya,keyFieldValue:Ha,columnId:ua,relationship:oa,
count:Q})},_setUpRelatedRecordInfos:function(Q){var Z=Q.records,aa=this.relatedRecordInfos;r.forEach(Q.relationships,function(ea,oa){aa[ea.id]=Z[oa]});return aa},_updateRelatedRecordInfos:function(Q){this.relatedRecordInfos=q.mergeDictionaries(this.relatedRecordInfos,Q)},_updateRelatedRecordCounts:function(Q){var Z=this.relatedRecordCounts,aa={};r.forEach(this.layer.relationships,function(ea){var oa=Q[ea.id];if(oa){oa=oa.relatedRecordGroups;var ra=ea.id;aa[ra]={};r.forEach(oa,function(za){aa[ra][za.objectId]=
{count:za.count}})}});this.relatedRecordCounts=q.mergeDictionaries(Z,aa)},_getRelatedRecordsById:function(Q){var Z=Q.featureId;Q=Q.relationshipId;return this.relatedRecordInfos[Q]?this.relatedRecordInfos[Q][Z]:[]},_getRelatedRecordsCount:function(Q){var Z=Q.featureId;Q=Q.relationshipId;return this.layerInfo.supportsAdvancedQueryRelated?(Z=this.relatedRecordCounts[Q]?this.relatedRecordCounts[Q][Z]:{})?Z.count:0:(Z=this._getRelatedRecordsById({featureId:Z,relationshipId:Q}))&&Z.features?Z.features.length:
0},_generateRelatedRecordFieldInfos:function(Q){var Z=[],aa=this.visibleLayerIds,ea=!1,oa,ra;r.some(Q.relationships,function(za,ya){ya===this._relationshipColumnLimit&&(ea=!0);ra=q.isCyclicalRelationship(za);(oa=aa?aa[aa.length-1]===za.relatedTableId:!1)&&ra&&!this.showCyclicalRelationships||Z.push({alias:za.name,name:za.name,type:"esriRelatedRecords",hidden:ea,relatedIndex:ya,relationship:za})},this);return Z},_validateRelatedColumnDisplay:function(Q){return!(!Q||Q.hidden||-1===r.indexOf(this.columns,
Q)||"esriFieldTypeOID"===Q.type||"esriFieldTypeGlobalID"===Q.type)},_getExpressionValueForField:function(Q,Z){var aa=Z[this.idProperty],ea=this.expressionCache[Q];aa=this.layerInfo.isFeatureCollection?q.findFirst(this.layer.graphics,"attributes",Z):this.store.data[aa];return q.getExpressionValue(aa,ea)},_formatExpressionCellContent:function(Q,Z){if(q.isValueEmpty(Z))return"";"number"==Q.type?Z=this._formatNumberCellContent({fieldInfo:Q,value:Z}):(Z=String(Z),Z=t.encode(Z),Z=this._formatStringCellContent({fieldInfo:Q,
value:Z}),Z=Z.replace(/(\n)/ig,"\x3cspan class\x3d'charNewLine'\x3e$1\x3c/span\x3e"));return Z},_showStatisticsHandler:function(Q){var Z=Q.columnId,aa=Q.fieldInfo,ea;Q=this.where||this.layer.getDefinitionExpression?this.layer.getDefinitionExpression():"1\x3d1";q.getFieldStatistics({grid:this.dGrid,layer:this.layer,fieldInfo:aa,idProperty:this.idProperty,filterIds:this.filterIds,where:Q,columnId:Z}).then(p.hitch(this,function(oa){ea=b.generateStatisticsDialog({data:oa,fieldInfo:aa,css:this.css});this.emit("show-statistics",
ea)}))},_addGridListeners:function(){this._setUpRowSelectListener();this._setUpRowDeselectListener();this._setUpDataChangeListener();this._setUpRefreshListener();this._setUpColumnClickListener();this._setUpColumnStateChangeListener();this._setUpColumnResizeListener();this._setUpErrorListener();this._setUpSortListener();this._setUpFilterListener();this._setUpEditorShowListener();this._setUpEditorHideListener();this.own(this._setUpStoreLoadListener(),this._setUpLayerClickListener(),this._setUpLayerSelectionCompleteListener(),
this._setUpLayerSelectionClearListener(),this._setUpLayerUpdateEndListener(),this._setUpLayerRefreshTickListener(),this._setUpLayerFeaturesUpdatesListener())},_setUpStoreLoadListener:function(){var Q=this.watch("store",p.hitch(this,function(Z,aa,ea){null===aa&&ea&&(this.set("loaded",!0),this.emit("load",{loaded:!0}),Q.remove())}));return Q},_setUpRowSelectListener:function(){return this.dGrid.on("dgrid-select",p.hitch(this,function(Q){this._updateSelection().then(p.hitch(this,function(){this.updateHeaderText();
this.emit("row-select",Q)}))}))},_setUpRowDeselectListener:function(){return this.dGrid.on("dgrid-deselect",p.hitch(this,function(Q){this._previousSelectedRowIds=this.selectedRowIds;this._updateSelection().then(p.hitch(this,function(){this.updateHeaderText();this.emit("row-deselect",Q)}))}))},_setUpDataChangeListener:function(){return this.dGrid.on("dgrid-datachange",p.hitch(this,function(Q){var Z=Q.cell.column.field,aa=q.findFirst(this.fieldInfos,"name",Z),ea=Q.cell.row.data,oa=ea[this.idProperty],
ra=Q.value;Q=Q.oldValue;var za=q.isIntegerFieldType(aa.type);aa=q.isFloatFieldType(aa.type);var ya={oldValue:Q,fieldName:Z,rowId:oa,row:ea};""===ra&&(ra=null);za&&null!==ra&&(ra=parseInt(ra,10));aa&&null!==ra&&(ra=parseFloat(ra));ra&&ra.getTime&&ra.getTime()?ea[Z]=ra.getTime():ea[Z]=ra;this.showLoadingIndicator();this._updateSelection().then(p.hitch(this,function(){this.updateHeaderText();this._applyEdits({row:ea,rollbackInfo:ya})}));this.emit("data-change",{row:ea,rollbackInfo:ya})}))},_setUpRefreshListener:function(){return this.dGrid.on("dgrid-refresh-complete",
p.hitch(this,function(Q){this._lastClickedCell=null;this.dGrid.columns[0]&&this.emit("refresh",Q)}))},_setUpColumnClickListener:function(){return this.dGrid.on(".dgrid-header .dgrid-cell:click",p.hitch(this,this._generateColumnMenu))},_setUpColumnStateChangeListener:function(){return this.dGrid.on("dgrid-columnstatechange",p.hitch(this,function(Q){this.emit("column-state-change",Q)}))},_setUpColumnResizeListener:function(){return this.dGrid.on("dgrid-columnresize",p.hitch(this,function(Q){this.emit("column-resize",
Q)}))},_setUpErrorListener:function(){return this.dGrid.on("dgrid-error",p.hitch(this,function(Q){this.emit("error",Q)}))},_setUpSortListener:function(){return this.dGrid.on("dgrid-sort",p.hitch(this,function(Q){this.emit("sort",Q)}))},_setUpFilterListener:function(){return this.dGrid.on("dgrid-filter",p.hitch(this,function(Q){this.emit("filter",Q)}))},_setUpEditorShowListener:function(){return this.dGrid.on("dgrid-editor-show",p.hitch(this,function(Q){this.emit("editor-show",Q)}))},_setUpEditorHideListener:function(){return this.dGrid.on("dgrid-editor-hide",
p.hitch(this,function(Q){this.emit("editor-hide",Q)}))},_setUpLayerClickListener:function(){return h(this.layer,"click",p.hitch(this,function(Q){this.emit("layer-click",Q)}))},_setUpLayerSelectionCompleteListener:function(){return h(this.layer,"selection-complete",p.hitch(this,function(Q){this.emit("layer-selection-complete",Q)}))},_setUpLayerSelectionClearListener:function(){return h(this.layer,"selection-clear",p.hitch(this,function(Q){this.emit("layer-selection-clear",Q)}))},_setUpLayerUpdateEndListener:function(){return h(this.layer,
"update-end",p.hitch(this,function(Q){this.emit("layer-update-end",Q)}))},_setUpLayerRefreshTickListener:function(){return h(this.layer,"refresh-tick",p.hitch(this,function(Q){this.layer.isFeatureUpdatesCheckActive()||this.emit("layer-refresh-tick",Q)}))},_setUpLayerFeaturesUpdatesListener:function(){return h(this.layer,"feature-updates-result",p.hitch(this,function(Q){(Q.hasUpdates||this.layer.hasDefinitionExpressionWithCurrentTimestamp())&&this.emit("layer-refresh-tick",Q)}))}});p.setObject("dijit.Grid",
c,e);return c})},"esri/dijit/FeatureTable/dataUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/Deferred dojo/number dojo/string dojo/date/locale dojo/promise/all ../../libs/sanitizer/Sanitizer ../../config ../../graphic ../../numberUtils ../../request ../../ArcadeExpression ../../arcadeProfiles/popupProfile ../../layers/FeatureLayer ../../geometry/Extent ../../tasks/query ../../tasks/StatisticDefinition ../../tasks/QueryTask ../../tasks/RelationshipQuery dojo/i18n dojo/i18n!../../nls/jsapi".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C){return{i18nStrings:C.widgets.FeatureTable,numericFieldTypes:["esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeSmallInteger"],statisticDefinitions:[{type:"count",name:"countField"},{type:"sum",name:"sumField"},{type:"min",name:"minField"},{type:"max",name:"maxField"},{type:"avg",name:"avgField"},{type:"stddev",name:"stddevField"}],_reExprField:/^\s*expression\//i,sanitizer:new a({whiteList:{dd:[],dl:[],dt:[],h1:[],
h2:[],h3:[],h4:[],h5:[],h6:[],sub:[],sup:[],animate:[],animatetransform:[],circle:[],clippath:[],defs:[],ellipse:[],g:[],image:[],line:[],lineargradient:[],marker:[],mask:[],path:[],pattern:[],polygon:[],polyline:[],radialgradient:[],rect:[],stop:[],svg:[],"switch":[],symbol:[],text:[],textpath:[],tspan:[],use:[]}},!0),getOrderByString:function(z,F){return z+(F?" DESC":" ASC")},getWhereString:function(z,F){return z+"\x3d'"+F+"'"},getRelationshipWhereClause:function(z){var F=z.layer,O=z.originRelationship,
V=z.destinationRelationship,N=O.relationshipTableId||O.relatedTableId;O=O.keyFieldInRelationshipTable||O.keyField;var J=V.keyFieldInRelationshipTable||V.keyField,D=F.layerId==N?J:O;z=this.getWhereString(D,z.keyValue);O=F._url.path;O=O.substring(0,O.lastIndexOf("/")+1);return f({url:O+N+"/query",content:{f:"json",outFields:["*"],returnGeometry:!1,where:z},handleAs:"json",callbackParamName:"callback"}).then(U.hitch(this,function(K){if(K&&K.features&&K.features.length){var G=K.features,I=[],R="",A;e.forEach(G,
function(B,H){if(B.attributes&&B.attributes[J])A=B.attributes[J];else{var T=F.getField(D)?F.getField(D).name:null;if(this.isValueEmpty(T)){T=J.toUpperCase();var M=J.toLowerCase();A=B.attributes[T]||B.attributes[M]||null}else A=B.attributes[T]}-1===e.indexOf(I,A)&&(0<I.length&&H<G.length&&(R=R.concat(" OR ")),I.push(A),R=R.concat(this.getWhereString(V.keyField,A)))},this);return R}return null}))},isValueEmpty:function(z){return null===z||" "===z||""===z||"undefined"===typeof z},findFirst:function(z,
F,O){return e.filter(z,function(V){return V.hasOwnProperty(F)&&V[F]===O})[0]||null},compareIntArrays:function(z,F){z.sort();F.sort();var O=e.every(F,function(N){return-1!==e.indexOf(z,N)},this),V=e.every(z,function(N){return-1!==e.indexOf(F,N)},this);return O&&V},findFirstNumberColumn:function(z,F){var O;e.some(z,function(V,N){if(-1!==e.indexOf(this.numericFieldTypes,V.type)&&V.field!==F&&!V.hidden)return O=V,!0},this);return O},getRoundingPrecision:function(z){return 1E3<=z?0:10<=z?2:0<=z?4:6},generateLinkFromString:function(z){var F=
/^\s*(http?:\/\/([^\s]+))\s*$/i,O=/^\s*(https?:\/\/([^\s]+))\s*$/i;if("string"===typeof z){var V;F.test(z)?V=z.indexOf("http:"):O.test(z)&&(V=z.indexOf("https:"));-1<V&&-1===z.indexOf("href\x3d")?(F=z.indexOf(" ",V),-1===F&&(F=z.length),O=z.substring(V,F),z=z.substring(0,V)+"\x3ca href\x3d'"+O+"' target\x3d'_blank'\x3e"+O+"\x3c/a\x3e"+z.substring(F,z.length)):z=this.sanitizer.sanitize(z)}return this.isValueEmpty(z)?"":z},isNumericFieldType:function(z){return-1!==e.indexOf(this.numericFieldTypes,z)},
isIntegerFieldType:function(z){return"esriFieldTypeInteger"===z||"esriFieldTypeSmallInteger"===z},isFloatFieldType:function(z){return"esriFieldTypeDouble"===z||"esriFieldTypeSingle"===z},getDomainValueFromRow:function(z){var F=z.fieldInfo.name,O=z.fieldInfo.domain,V=z.row;if("range"===O.type)return V[F];z=e.filter(O.codedValues,function(N){return N.hasOwnProperty("code")&&N.code==V[F]});return z[0]&&!this.isValueEmpty(z[0].name)?z[0].name:V[F]},getTypeValueFromRow:function(z){var F=z.layerInfo[z.typesProperty],
O=z.typeIdProperty,V=z.fieldInfo,N=z.row;z=F&&F[0];if(z){var J=N[V.name];V=this.isNumericFieldType(V.type);V=(z="string"===typeof z[O])&&V?J.toString():J;J=(J=this.findFirst(F,O,V))?J.name:null}return J},getSubtypeDomainValue:function(z){var F=z.layerInfo,O=z.fieldInfo.name,V=z.row,N;z=(F=this.findFirst(F.types,"id",V[F.typeIdField]))?F.domains:null;if(!F||!z)return V[O];z[O]&&z[O].codedValues&&(N=e.filter(z[O].codedValues,function(J){return J.hasOwnProperty("code")&&J.code==V[O]}));return N&&N[0]&&
!this.isValueEmpty(N[0].name)?N[0].name:V[O]},mergeDictionaries:function(z,F){if(null===z||null===F)return z;for(var O in F){z[O]||(z[O]={});for(var V in F[O])z[O][V]=F[O][V]}return z},isCyclicalRelationship:function(z){return"esriRelCardinalityOneToOne"===z.cardinality||"esriRelCardinalityOneToMany"===z.cardinality&&"esriRelRoleDestination"===z.role},getColumnFromFieldName:function(z){return this.findFirst(z.grid.columns,"field",z.fieldName)},formatNumberForLocale:function(z,F){if(F){var O=y.getLocalization("dojo.cldr",
"number");if(F.digitSeparator||!O||this.isValueEmpty(z))return isNaN(z)||null===z?null:b.format(z,F);z=isNaN(z)||null===z?null:b.format(z,F);return z.replace(new RegExp("\\"+O.group,"g"),"")}return isNaN(z)||null===z?null:h.format(z,F)},getCombinedDateTime:function(z,F){return new Date(z.getFullYear(),z.getMonth(),z.getDate(),F.getHours(),F.getMinutes(),F.getSeconds())},formatDateForLocale:function(z){var F=z.dateOptions||{},O=z.timestamp,V=z.fieldInfo,N=!1,J=!1;z={};F=(N=V&&V.dateOptions?V.dateOptions:
!1)||F;N=N&&this.isValueEmpty(F.dateEnabled)?!0:!!F.dateEnabled;J=!!F.timeEnabled;this.isValueEmpty(F.datePattern)||(z.datePattern=F.datePattern);this.isValueEmpty(F.timeEnabled)||this.isValueEmpty(F.timePattern)||(z.timePattern=F.timePattern);z.selector=N&&J?"date and time":N&&!J?"date":!N&&J?"time":"date";return p.format(new Date(O),z)},calculateExtentFromFeatures:function(z){var F=z[0].geometry,O;if(null===F&&1===z.length)return null;for(F=z.length-1;0<=F;F--)null===z[F].geometry&&z.splice(F,1);
F=z[0].geometry;var V=F.getExtent();var N=z.length;null===V&&(V=new t(F.x,F.y,F.x,F.y,F.spatialReference));for(O=1;O<N;O++){F=z[O].geometry;var J=F.getExtent();null===J&&(J=new t(F.x,F.y,F.x,F.y,F.spatialReference));V=V.union(J)}return V},initFeatureLayer:function(z,F){var O=z._url.path;O=O.substring(0,O.lastIndexOf("/")+1);return new m(O+F,{mode:m.MODE_ONDEMAND,outFields:["*"],visible:!0})},applyEdits:function(z){var F=[],O=new q;if(!z||0>=z.length)return O.reject(),O;e.forEach(z,function(V){V.layer&&
F.push(V.layer.applyEdits(V.adds,V.updates,V.deletes,function(N,J,D){O.resolve({adds:N,updates:J,deletes:D})},function(N){O.reject(N)}))});0<F.length?r(F):O.reject();return O},applyEditsFromRow:function(z){var F=z.layer,O=new d;O.setAttributes(z.row);return this.applyEdits([{layer:F,updates:[O]}],null)},queryLayer:function(z){var F=z.layer;z=z.ids||null;var O=new w;O.where="1\x3d1";O.returnGeometry=!1;O.objectIds=z;return F.queryFeatures(O)},queryLayerForFeature:function(z){return this.queryLayerForFeatures({layer:z.layer,
ids:[z.id]})},queryLayerForFeatures:function(z){var F=z.layer,O=F.advancedQueryCapabilities;O=O&&O.supportsQueryWithCacheHint;z=z.ids;var V=new w;V.objectIds=z;V.outFields=["*"];O&&(V.cacheHint=!0);return F.queryFeatures(V,function(N){return N.features})},queryLayerForCount:function(z){var F=z.layer,O=F.advancedQueryCapabilities;O=O&&O.supportsQueryWithCacheHint;if(F.queryCount){var V=new w,N=z.layerInfo;z=z.where||"1\x3d1";V.returnGeometry=!1;V.returnCountOnly=!0;V.where=z;O&&(V.cacheHint=!0);return F.queryCount(V).then(function(J){return J}).otherwise(function(){return N.isFeatureCollection?
F.graphics.length:2E3}).always(function(J){return J})}return this.queryLayerCustom({layer:F,returnCountOnly:!0,cacheHint:O}).then(function(J){return J&&J.features?J.features.length:0}).otherwise(function(){return F.maxRecordCount||2E3}).always(function(J){return J})},queryLayerCustom:function(z){var F=new w,O=z.returnCountOnly||!1,V=z.where||"1\x3d1",N=z.returnGeometry||!1,J=z.outFields||["*"],D=z.cacheHint||!1;z=new v(z.layer.url);F.returnGeometry=N;F.outFields=J;F.where=V;F.returnCountOnly=O;D&&
(F.cacheHint=!0);return z.execute(F)},queryLayerForIds:function(z){var F=z.layer,O=F.advancedQueryCapabilities;O=O&&O.supportsQueryWithCacheHint;var V=z.idProperty;z=z.where||"1\x3d1";var N=new w;N.returnGeometry=!1;N.outFields=[V];N.where=z;N.returnIdsOnly=!0;O&&(N.cacheHint=!0);return F.queryIds(N)},queryLayerForAttachments:function(z){return f({url:z.layer._url.path+"/queryAttachments",content:{f:"json",objectIds:z.ids},handleAs:"json",callbackParamName:"callback"})},queryLayerForAttachmentById:function(z){return z.layer.queryAttachmentInfos(z.id||
0)},addAttachmentToLayer:function(z){return z.layer.addAttachment(z.featureId,z.formData)},deleteAttachmentFromLayer:function(z){return z.layer.deleteAttachments(z.featureId,[z.attachmentId])},queryLayerForRelatedRecords:function(z){var F=z.layer,O=z.ids,V=z.outFields||["*"],N=z.relationship;z=z.returnCountOnly||!1;var J=new x;J.outFields=V;J.returnGeometry=!1;J.relationshipId=N.id;J.returnCountOnly=z;J.objectIds=O;return F.queryRelatedFeatures(J)},queryLayerForRelatedRecordCount:function(z){return f({url:z.layer._url.path+
"/queryRelatedRecords",content:{f:"json",objectIds:z.objectIds.toString(),outFields:z.outFields,returnGeometry:!1,relationshipId:z.relationship.id,returnCountOnly:!0},handleAs:"json",callbackParamName:"callback"})},getFieldStatistics:function(z){var F=new q,O=z.layer,V=O.advancedQueryCapabilities;V=V&&V.supportsQueryWithCacheHint;var N=z.idProperty,J=z.where||"1\x3d1",D=z.filterIds,K=z.grid.columns[z.columnId].field;z=O.url;var G=[];var I=e.map(this.statisticDefinitions,function(A){var B=new u;B.onStatisticField=
K;B.displayFieldName=K;B.outStatisticFieldName=A.name;B.statisticType=A.type;return B});var R=new w;R.outFields=[K];R.outStatistics=[];R.where=J;R.outStatistics=I;V&&(R.cacheHint=!0);D&&0<D.length&&(G=D);R.where&&0<G.length&&(R.where="("+R.where+") AND ("+N+" IN ("+G.toString()+"))");O.source&&!this.isValueEmpty(O.source.mapLayerId)&&z.endsWith("/dynamicLayer")&&(z=z.slice(0,-13),z=z+"/"+O.source.mapLayerId);(new v(z)).execute(R).then(function(A){F.resolve(A)}).otherwise(function(){F.reject()});return F},
selectFeaturesById:function(z){var F=z.grid,O=F.layer;F=F.layerInfo;var V=z.map,N=z.ids;z=z.id;var J=new w;J.returnGeometry=!!V;J.objectIds=N||[z];F.isFeatureCollection||(J.where="1\x3d1");return O.selectFeatures(J,m.SELECTION_NEW)},isFeatureEditable:function(z){var F=z.layerInfo;return!!z.layer.getEditCapabilities({userId:F.userIds[F.layerId]||null,feature:{attributes:z.attributes}}).canUpdate},isExpressionField:function(z){return this._reExprField.test(z)},getExpressionInfo:function(z,F){if(this.isExpressionField(F)){var O;
F=F.replace(this._reExprField,"");F=F.toLowerCase();e.some(z,function(V){V.name.toLowerCase()===F&&(O=V);return!!O});return O}},compileExpressions:function(z){var F={};e.forEach(z,function(O){var V=O.returnType&&O.returnType.toLowerCase();F[O.name]=new g({expression:O.expression,returnType:"number"===V?"number":"string",profile:n})});return F},getExpressionValue:function(z,F){var O=z.getLayer(),V=O&&O.getMap();return F?z.evaluateExpression(F,n.getEvalOptions({expression:F,feature:z,layer:O,map:V,
spatialReference:V&&V.spatialReference})):null}}})},"esri/numberUtils":function(){define(["dojo/has","dojo/number","dojo/i18n!dojo/cldr/nls/number","./kernel"],function(e,U,q,b){var l=function(r,a){return r-a},p={_reNumber:/^-?(\d+)(\.(\d+))?$/i,getDigits:function(r){var a=String(r),c=a.match(p._reNumber);r={integer:0,fractional:0};c&&c[1]?(r.integer=c[1].split("").length,r.fractional=c[3]?c[3].split("").length:0):-1<a.toLowerCase().indexOf("e")&&(c=a.split("e"),a=c[0],c=c[1],a&&c&&(a=Number(a),c=
Number(c),(r=0<c)||(c=Math.abs(c)),a=p.getDigits(a),r?(a.integer+=c,a.fractional=c>a.fractional?0:a.fractional-c):(a.fractional+=c,a.integer=c>a.integer?1:a.integer-c),r=a));return r},getFixedNumbers:function(r,a){var c=Number(r.toFixed(a));if(c<r)var d=c+1/Math.pow(10,a);else d=c,c-=1/Math.pow(10,a);c=Number(c.toFixed(a));d=Number(d.toFixed(a));return[c,d]},getPctChange:function(r,a,c,d){var h={prev:null,next:null};if(null!=c){var f=r-c;h.prev=Math.floor(Math.abs(100*(a-c-f)/f))}null!=d&&(f=d-r,
h.next=Math.floor(Math.abs(100*(d-a-f)/f)));return h},round:function(r,a){var c=r.slice(0),d,h,f=a&&null!=a.tolerance?a.tolerance:2,g=a&&a.indexes,n=a&&null!=a.strictBounds?a.strictBounds:!1;if(g)g.sort(l);else for(g=[],d=0;d<c.length;d++)g.push(d);for(d=0;d<g.length;d++){var m=g[d];var t=c[m];var w=0===m?null:c[m-1];var u=m===c.length-1?null:c[m+1];var v=p.getDigits(t);if(v=v.fractional){var x=0;for(h=!1;x<=v&&!h;){var y=p.getFixedNumbers(t,x);y=n&&0===d?y[1]:y[0];h=p.hasMinimalChange(t,y,w,u,f);
x++}h&&(c[m]=y)}}return c},hasMinimalChange:function(r,a,c,d,h){r=p.getPctChange(r,a,c,d);a=null==r.prev||r.prev<=h;c=null==r.next||r.next<=h;return a&&c||r.prev+r.next<=2*h},_reAllZeros:new RegExp("\\"+q.decimal+"0+$","g"),_reSomeZeros:RegExp("(\\d)0*$","g"),format:function(r,a){a=a||{places:20,round:-1};var c=U.format(r,a);c&&(c=c.replace(p._reSomeZeros,"$1").replace(p._reAllZeros,""));return c}};return b.numberUtils=p})},"esri/dijit/FeatureTable/dialogUtils":function(){define("../../lang ../FeatureAttachments ./dataUtils dojo/_base/array dojo/_base/lang dojo/Deferred dojo/dom-construct dojo/dom-style dojo/io-query dojo/number dojo/on dojo/string dijit/Dialog dijit/form/Button dijit/layout/BorderContainer dijit/layout/TabContainer dijit/layout/ContentPane dojo/i18n!../../nls/jsapi".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u){return{i18nStrings:u.widgets.FeatureTable,generateDialog:function(v){v=new g({title:v.title,content:v.content,baseClass:v.css.dialog});r.create("div",{className:"break"},v.containerNode);return v},hideDialog:function(v){v&&v.hide()},destroyDialog:function(v){v&&v.destroy()},generateAttachmentsDialog:function(v){var x=this.i18nStrings,y=v.layer,C=v.featureId,z=v.attachments||null,F=v.editable;v=v.css;var O=r.create("div");var V=this.generateDialog({title:x.photosAndFiles,
content:O,css:v});var N=new U({layer:y,featureId:C,attachments:z,editable:F},O);h(V,"hide",function(J){N.destroy()});x=new n({label:x.close,"class":v.closeButton});h(x,"click",function(){V.hide()});x.placeAt(N._uploadButton.domNode,"after");N.startup();V.show();return{dialog:V,featureAttachments:N}},generateStatisticsDialog:function(v){var x=this.i18nStrings,y=v.css,C=v.fieldInfo;C=C.alias||C.name;v=v.data.features[0].attributes;var z={pattern:"#,###,###,##0.########"},F={},O;for(V in v)v.hasOwnProperty(V)&&
(F[V.toLowerCase()]=v[V]);var V=[{title:x.numberOfValues,value:e.isDefined(F.countfield)?d.format(F.countfield,z):""},{title:x.sumOfValues,value:e.isDefined(F.sumfield)?d.format(F.sumfield,z):""},{title:x.minimum,value:e.isDefined(F.minfield)?d.format(F.minfield,z):""},{title:x.maximum,value:e.isDefined(F.maxfield)?d.format(F.maxfield,z):""},{title:x.average,value:e.isDefined(F.avgfield)?d.format(d.round(F.avgfield,q.getRoundingPrecision(F.avgfield)),z):""},{title:x.standardDeviation,value:e.isDefined(F.stddevfield)?
d.format(d.round(F.stddevfield,q.getRoundingPrecision(F.stddevfield)),z):""}];z=r.create("div",{className:y.statisticsTableContainer});r.create("div",{className:y.statisticsHeader,innerHTML:f.substitute(x.fieldLabel,{fieldName:C})},z);r.create("div",{className:y.statisticsHorizontalBreak},z);C=r.create("table",{className:y.statisticsAttrTable,style:{cellpadding:0,cellspacing:0}},z);var N=r.create("tbody",{},C);b.forEach(V,function(K){O=r.create("tr",{valign:"top"},N);r.create("td",{className:y.statisticsAttrName,
innerHTML:K.title},O);r.create("td",{className:y.statisticsAttrValue,innerHTML:K.value},O)});r.create("div",{className:y.statisticsBreak},z);var J=new n({label:x.close,baseClass:y.closeButton});h(J,"click",function(){var K=D;K.hide().then(function(){K.destroyRecursive();J=null})});J.placeAt(z);var D=this.generateDialog({title:x.statistics,content:z,css:y});D.show();return{dialog:D,statistics:v}}}})},"esri/dijit/FeatureAttachments":function(){define("../kernel ../lang dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/dom-class dojo/dom-construct dojo/has dojo/io-query dojo/on dojo/string dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_WidgetBase dojo/i18n!../nls/jsapi dojo/text!./FeatureAttachments/templates/FeatureAttachments.html dijit/form/Button dijit/layout/BorderContainer dijit/layout/TabContainer dijit/layout/ContentPane".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y){b=b([m,g,n],{declaredClass:"esri.dijit.FeatureAttachments",baseClass:"esri-feature-attachments",templateString:w,layer:null,featureId:null,attachments:null,editable:!1,_editable:!1,_i18nStrings:t.widgets.FeatureAttachments,_css:{contentContainer:"esri-feature-attachments-container",menuContainer:"esri-feature-attachments-menu-container",tabContainer:"esri-feature-attachments-tab-container",formButton:"esri-feature-attachments-button dijitButton",
uploadButton:"esri-feature-attachments-upload-button",deleteButton:"icon-ui-close-circled",feedbackNode:"esri-feature-attachments-feedback",dragDrop:"esri-drag-drop",loadingIndicator:"esri-feature-attachments-loading-indicator",viewPane:"esri-feature-attachments-view-pane",viewPaneContent:"esri-feature-attachments-view-pane-content",addPane:"esri-feature-attachments-add-pane",addPaneContent:"esri-feature-attachments-add-pane-content",attachmentNode:"esri-attachment-node",attachmentNodeTextContainer:"esri-attachment-node-text-container",
attachmentNodeTextName:"esri-attachment-node-text-name",attachmentNodeTextSize:"esri-attachment-node-text-size",attachmentNodeDelete:"esri-attachment-node-delete",attachmentNodeIcon:"esri-attachment-node-icon",iconArchive:"esri-attachment-node-icon-archive",iconAudioVideo:"esri-attachment-node-icon-audiovideo",iconDocument:"esri-attachment-node-icon-document",iconImage:"esri-attachment-node-icon-image",iconOther:"esri-attachment-node-icon-other",hidden:"esri-feature-attachments-hidden"},_filetypeInfos:{categories:["archive",
"audioVideo","document","image","other"],groups:["zip 7z gz gtar tar tgz".split(" "),"wmf wps avi mpg mpe mpeg mov wmv aif mid rmi mp2 mp3 mp4 mpa mpv2 qt ra ram wav wma".split(" "),"doc docx dot xls xlsx xlt pdf ppt pptx txt".split(" "),"bmp ecw emf eps ps gif img jp2 jpc j2k jpf jpg jpeg jpe png psd raw sid tif tiff".split(" "),"vrml gml json xml mdb gdb geodatabase".split(" ")],styles:null},constructor:function(){this._updateViewContent=l.hitch(this,this._updateViewContent)},postMixInProperties:function(){this.inherited(arguments);
var C=this._css;this._filetypeInfos.styles={archive:C.iconArchive,audioVideo:C.iconAudioVideo,document:C.iconDocument,image:C.iconImage,other:C.iconOther};this.attachments&&Array.isArray(this.attachments)||this.set("attachments",[])},startup:function(){this.inherited(arguments);var C=this.layer;C&&C.loaded?this._setUpWidget():this.own(h.once(C,"load",l.hitch(this,this._setUpWidget)),h(C,"error",l.hitch(this,this._showError)))},destroy:function(){this.inherited(arguments)},resize:function(){this._tabContainer.resize()},
refresh:function(){this._updateFeedback();this._getAttachments().then(this._updateViewContent)},showAddPane:function(){this._tabContainer.selectChild(this._addPane)},showViewPane:function(){this._tabContainer.selectChild(this._viewPane)},_setUpWidget:function(){this._wireUpEvents();this._checkEditability();this.attachments&&0!==this.attachments.length?this._updateViewContent():this._getAttachments().then(this._updateViewContent)},_wireUpEvents:function(){this.own(h(this._uploadButton,"click",l.hitch(this,
this._addAttachment)),h(this._fileInput,"change",l.hitch(this,this._updateUploadButtonState)),this.watch("featureId",l.hitch(this,this._updateFeatureId)),this._tabContainer.watch("selectedChildWidget",l.hitch(this,this._updateUploadButtonDisplay)))},_checkEditability:function(){this.editable&&this.layer.isEditable&&(this.set("_editable",this.layer.isEditable()),this._addPane.set("disabled",!1))},_getAttachments:function(){this._showLoadingIndicator();return this._queryLayerForAttachments().then(l.hitch(this,
function(C){this.set("attachments",C);return C})).otherwise(l.hitch(this,function(C){this.set("attachements",[]);return[]}))},_updateFeatureId:function(){this.refresh()},_updateFeedback:function(C){this._feedbackNode.textContent=C||""},_showError:function(C){msg=C&&U.isDefined(C.code)&&400===C.code?this._i18nStrings.fileNotSupported:this._i18nStrings.uploadFail;this.emit("error",{message:msg});this._updateFeedback(msg);this._hideLoadingIndicator()},_addAttachment:function(){if(this._fileInput.files&&
this._fileInput.files[0]){this._showLoadingIndicator();this._updateFeedback(this._i18nStrings.uploading);this._uploadButton.setDisabled(!0);var C=this._fileInput.files[0],z=new FormData;z.append("attachment",C,C.name);this._addAttachmentToLayer(z).then(l.hitch(this,this._addAttachmentCallback)).otherwise(l.hitch(this,this._showError))}},_addAttachmentCallback:function(C){this._fileInput.value="";C.success?(!0===this._viewPane.disabled&&this._viewPane.set("disabled",!1),this._getAttachments().then(l.hitch(this,
function(){this._updateViewContent();this.emit("add-complete",{attachments:this.attachments,featureId:C.objectId,attachmentId:C.attachmentId})})),this._updateFeedback(this._i18nStrings.uploadSuccess),this._hideLoadingIndicator()):(this._updateFeedback(this._i18nStrings.uploadFail),this._hideLoadingIndicator(),this._showError(C.error))},_deleteAttachment:function(C,z){this._showLoadingIndicator();this._updateFeedback(this._i18nStrings.deleting);this._deleteAttachmentFromLayer(C).then(l.hitch(this,
this._deleteAttachmentCallback)).otherwise(l.hitch(this,this._showError,null))},_deleteAttachmentCallback:function(C){C[0]&&C[0].success?(this._getAttachments().then(l.hitch(this,function(){this._updateViewContent();this.emit("delete-complete",{attachments:this.attachments,featureId:C[0].objectId,attachmentId:C[0].attachmentId})})),this._updateFeedback(this._i18nStrings.deleteSuccess),this._hideLoadingIndicator()):(this._hideLoadingIndicator(),this._updateFeedback(this._i18nStrings.deleteFail),this._showError(C[0].error))},
_updateViewContent:function(){if(this.layer&&!isNaN(this.featureId)&&this.attachments){this.editable&&0===this.attachments.length&&this.showAddPane();var C=this._generateViewContent();this._viewPane.setContent(C);this._hideLoadingIndicator()}},_generateViewContent:function(){var C=this.attachments;var z=this.layer._url.path+"/"+this.featureId+"/attachments/";var F=this._getQueryString();var O=a.create("div",{className:this._css.viewPaneContent});q.forEach(C,function(V){this._generateViewNode({attachment:V,
baseUrl:z,queryUrl:F,contentNode:O})},this);return O},_generateViewNode:function(C){var z=C.attachment,F=z.id,O=z.name,V=z.size;z=C.contentNode;var N=this._css;var J=C.baseUrl+F+C.queryUrl;C=a.create("div",{className:N.attachmentNode});a.create("div",{className:N.attachmentNodeIcon+" "+this._getIconClass(O)},C);var D=a.create("div",{className:N.attachmentNodeTextContainer},C);var K=a.create("span",{className:N.attachmentNodeTextName},D);a.create("a",{href:J,title:O,innerHTML:O,target:"_blank"},K);
a.create("span",{className:N.attachmentNodeTextSize,innerHTML:this._parseFileSize(V)},D);this._editable&&(O=a.create("div",{className:N.attachmentNodeDelete},C),a.create("span",{className:N.deleteButton},O),this.own(h(O,"click",this._deleteAttachment.bind(this,F))));a.place(C,z)},_showLoadingIndicator:function(){r.remove(this._loadingIndicator,this._css.hidden)},_hideLoadingIndicator:function(){r.add(this._loadingIndicator,this._css.hidden)},_showUploadButton:function(){r.remove(this._uploadButton.domNode,
this._css.hidden)},_hideUploadButton:function(){r.add(this._uploadButton.domNode,this._css.hidden)},_updateUploadButtonState:function(){this._updateFeedback();this._uploadButton.setDisabled(0===this._fileInput.value.length)},_updateUploadButtonDisplay:function(C,z,F){this._updateFeedback();F===this._addPane?this._showUploadButton():this._hideUploadButton()},_queryLayerForAttachments:function(){return this.layer.queryAttachmentInfos(this.featureId||0)},_addAttachmentToLayer:function(C){return this.layer.addAttachment(this.featureId,
C)},_deleteAttachmentFromLayer:function(C){return this.layer.deleteAttachments(this.featureId,[C])},_getIconClass:function(C){var z=C.substr(C.lastIndexOf(".")+1);C=this._filetypeInfos;var F=C.categories,O=-1;q.some(C.groups,function(V,N){if(-1!==V.indexOf(z.toLowerCase()))return O=N,!0});return C.styles[F[O]?F[O]:F[4]]},_parseFileSize:function(C){var z=this._i18nStrings,F=[z.kB,z.MB,z.GB,z.TB],O=-1;if(1E3>Math.abs(C))return f.substitute(z.B,{fileSize:C});do C/=1E3,++O;while(1E3<=Math.abs(C)&&O<F.length-
1);return f.substitute(F[O],{fileSize:C.toFixed(1)})},_getQueryString:function(){var C=d.objectToQuery({gdbVersion:this.layer.gdbVersion,token:this.layer._getToken()});return C?"?"+C:""}});l.setObject("dijit.FeatureAttachments",b,e);return b})},"dijit/layout/TabContainer":function(){define(["dojo/_base/lang","dojo/_base/declare","./_TabContainerBase","./TabController","./ScrollingTabController"],function(e,U,q,b,l){return U("dijit.layout.TabContainer",q,{useMenu:!0,useSlider:!0,controllerWidget:"",
_makeController:function(p){var r=this.baseClass+"-tabs"+(this.doLayout?"":" dijitTabNoLayout");return new ("string"==typeof this.controllerWidget?e.getObject(this.controllerWidget):this.controllerWidget)({id:this.id+"_tablist",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,tabPosition:this.tabPosition,doLayout:this.doLayout,containerId:this.id,"class":r,nested:this.nested,useMenu:this.useMenu,useSlider:this.useSlider,tabStripClass:this.tabStrip?this.baseClass+(this.tabStrip?
"":"No")+"Strip":null},p)},postMixInProperties:function(){this.inherited(arguments);this.controllerWidget||(this.controllerWidget="top"!=this.tabPosition&&"bottom"!=this.tabPosition||this.nested?b:l)}})})},"dijit/layout/_TabContainerBase":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style ./StackContainer ./utils ../_TemplatedMixin dojo/text!./templates/TabContainer.html".split(" "),function(e,U,q,b,l,p,r,a){return e("dijit.layout._TabContainerBase",[l,r],{tabPosition:"top",
baseClass:"dijitTabContainer",tabStrip:!1,nested:!1,templateString:a,postMixInProperties:function(){this.baseClass+=this.tabPosition.charAt(0).toUpperCase()+this.tabPosition.substr(1).replace(/-.*/,"");this.srcNodeRef&&b.set(this.srcNodeRef,"visibility","hidden");this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.tablist=this._makeController(this.tablistNode);this.doLayout||U.add(this.domNode,"dijitTabContainerNoLayout");this.nested?(U.add(this.domNode,"dijitTabContainerNested"),
U.add(this.tablist.containerNode,"dijitTabContainerTabListNested"),U.add(this.tablistSpacer,"dijitTabContainerSpacerNested"),U.add(this.containerNode,"dijitTabPaneWrapperNested")):U.add(this.domNode,"tabStrip-"+(this.tabStrip?"enabled":"disabled"))},_setupChild:function(c){U.add(c.domNode,"dijitTabPane");this.inherited(arguments)},removeChild:function(c){U.remove(c.domNode,"dijitTabPane");this.inherited(arguments)},startup:function(){this._started||(this.tablist.startup(),this.inherited(arguments))},
layout:function(){if(this._contentBox&&"undefined"!=typeof this._contentBox.l){var c=this.selectedChildWidget;if(this.doLayout){var d=this.tabPosition.replace(/-h/,"");this.tablist.region=d;d=[this.tablist,{domNode:this.tablistSpacer,region:d},{domNode:this.containerNode,region:"center"}];p.layoutChildren(this.domNode,this._contentBox,d);this._containerContentBox=p.marginBox2contentBox(this.containerNode,d[2]);c&&c.resize&&c.resize(this._containerContentBox)}else{if(this.tablist.resize){d=this.tablist.domNode.style;
d.width="0";var h=q.getContentBox(this.domNode).w;d.width="";this.tablist.resize({w:h})}c&&c.resize&&c.resize()}}},destroy:function(c){this.tablist&&this.tablist.destroy(c);this.inherited(arguments)}})})},"dijit/layout/TabController":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/has dojo/i18n dojo/_base/lang ./StackController ../registry ../Menu ../MenuItem dojo/text!./templates/_TabButton.html dojo/i18n!../nls/common".split(" "),function(e,U,q,b,l,p,r,a,c,d,h,f){f=
e("dijit.layout._TabButton"+(l("dojo-bidi")?"_NoBidi":""),a.StackButton,{baseClass:"dijitTab",cssStateNodes:{closeNode:"dijitTabCloseButton"},templateString:f,_setNameAttr:"focusNode",scrollOnFocus:!1,buildRendering:function(){this.inherited(arguments);U.setSelectable(this.containerNode,!1)},startup:function(){this.inherited(arguments);var g=this.domNode;this.defer(function(){g.className=g.className},1)},_setCloseButtonAttr:function(g){this._set("closeButton",g);b.toggle(this.domNode,"dijitClosable",
g);this.closeNode.style.display=g?"":"none";g&&(g=p.getLocalization("dijit","common"),this.closeNode&&q.set(this.closeNode,"title",g.itemClose))},_setDisabledAttr:function(g){this.inherited(arguments);if(this.closeNode)if(g)q.remove(this.closeNode,"title");else{var n=p.getLocalization("dijit","common");q.set(this.closeNode,"title",n.itemClose)}},_setLabelAttr:function(g){this.inherited(arguments);this.showLabel||this.params.title||(this.iconNode.alt=r.trim(this.containerNode.innerText||this.containerNode.textContent||
""))}});l("dojo-bidi")&&(f=e("dijit.layout._TabButton",f,{_setLabelAttr:function(g){this.inherited(arguments);this.applyTextDir(this.iconNode,this.iconNode.alt)}}));e=e("dijit.layout.TabController",a,{baseClass:"dijitTabController",templateString:"\x3cdiv role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown:onkeydown'\x3e\x3c/div\x3e",tabPosition:"top",buttonWidget:f,buttonWidgetCloseClass:"dijitTabCloseButton",postCreate:function(){this.inherited(arguments);var g=new d({id:this.id+"_Menu",ownerDocument:this.ownerDocument,
dir:this.dir,lang:this.lang,textDir:this.textDir,targetNodeIds:[this.domNode],selector:function(t){return b.contains(t,"dijitClosable")&&!b.contains(t,"dijitTabDisabled")}});this.own(g);var n=p.getLocalization("dijit","common"),m=this;g.addChild(new h({label:n.itemClose,ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,onClick:function(t){t=c.byNode(this.getParent().currentTarget);m.onCloseButtonClick(t.page)}}))}});e.TabButton=f;return e})},"dijit/Menu":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ./popup ./DropDownMenu dojo/ready".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t){h("dijit-legacy-requires")&&t(0,function(){e(["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"])});return q("dijit.Menu",m,{constructor:function(){this._bindings=[]},targetNodeIds:[],selector:"",contextMenuForWindow:!1,leftClickToOpen:!1,refocus:!0,postCreate:function(){this.contextMenuForWindow?this.bindDomNode(this.ownerDocumentBody):U.forEach(this.targetNodeIds,this.bindDomNode,this);this.inherited(arguments)},_iframeContentWindow:function(w){return g.get(this._iframeContentDocument(w))||
this._iframeContentDocument(w).__parent__||w.name&&document.frames[w.name]||null},_iframeContentDocument:function(w){return w.contentDocument||w.contentWindow&&w.contentWindow.document||w.name&&document.frames[w.name]&&document.frames[w.name].document||null},bindDomNode:function(w){w=b.byId(w,this.ownerDocument);if("iframe"==w.tagName.toLowerCase()){var u=w;var v=this._iframeContentWindow(u);v=f.body(v.document)}else v=w==f.body(this.ownerDocument)?this.ownerDocument.documentElement:w;var x={node:w,
iframe:u};l.set(w,"_dijitMenu"+this.id,this._bindings.push(x));var y=c.hitch(this,function(C){var z=this.selector,F=z?function(V){return d.selector(z,V)}:function(V){return V},O=this;return[d(C,F(this.leftClickToOpen?"click":"contextmenu"),function(V){V.stopPropagation();V.preventDefault();(new Date).getTime()<O._lastKeyDown+500||O._scheduleOpen(this,u,{x:V.pageX,y:V.pageY},V.target)}),d(C,F("keydown"),function(V){if(93==V.keyCode||V.shiftKey&&V.keyCode==a.F10||O.leftClickToOpen&&V.keyCode==a.SPACE)V.stopPropagation(),
V.preventDefault(),O._scheduleOpen(this,u,null,V.target),O._lastKeyDown=(new Date).getTime()})]});x.connects=v?y(v):[];u&&(x.onloadHandler=c.hitch(this,function(){var C=this._iframeContentWindow(u);C=f.body(C.document);x.connects=y(C)}),u.addEventListener?u.addEventListener("load",x.onloadHandler,!1):u.attachEvent("onload",x.onloadHandler))},unBindDomNode:function(w){try{var u=b.byId(w,this.ownerDocument)}catch(C){return}w="_dijitMenu"+this.id;if(u&&l.has(u,w)){for(var v=l.get(u,w)-1,x=this._bindings[v],
y;y=x.connects.pop();)y.remove();(y=x.iframe)&&(y.removeEventListener?y.removeEventListener("load",x.onloadHandler,!1):y.detachEvent("onload",x.onloadHandler));l.remove(u,w);delete this._bindings[v]}},_scheduleOpen:function(w,u,v,x){this._openTimer||(this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:x,delegatedTarget:w,iframe:u,coords:v})},1))},_openMyself:function(w){function u(){V.refocus&&N&&N.focus();n.close(V)}var v=w.target,x=w.iframe,y=w.coords,C=!y;this.currentTarget=
w.delegatedTarget;if(y){if(x){w=p.position(x,!0);v=this._iframeContentWindow(x);v=p.docScroll(v.document);var z=r.getComputedStyle(x),F=r.toPixelValue,O=(h("ie")&&h("quirks")?0:F(x,z.paddingLeft))+(h("ie")&&h("quirks")?F(x,z.borderLeftWidth):0);x=(h("ie")&&h("quirks")?0:F(x,z.paddingTop))+(h("ie")&&h("quirks")?F(x,z.borderTopWidth):0);y.x+=w.x+O-v.x;y.y+=w.y+x-v.y}}else y=p.position(v,!0),y.x+=10,y.y+=10;var V=this;x=this._focusManager.get("prevNode");w=this._focusManager.get("curNode");var N=!w||
b.isDescendant(w,this.domNode)?x:w;n.open({popup:this,x:y.x,y:y.y,onExecute:u,onCancel:u,orient:this.isLeftToRight()?"L":"R"});this.focus();C||this.defer(function(){this._cleanUp(!0)});this._onBlur=function(){this.inherited("_onBlur",arguments);n.close(this)}},destroy:function(){U.forEach(this._bindings,function(w){w&&this.unBindDomNode(w.node)},this);this.inherited(arguments)}})})},"dijit/layout/ScrollingTabController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/_base/lang dojo/on dojo/query dojo/sniff ../registry dojo/text!./templates/ScrollingTabController.html dojo/text!./templates/_ScrollingTabControllerButton.html ./TabController ./utils ../_WidgetsInTemplateMixin ../Menu ../MenuItem ../form/Button ../_HasDropDown dojo/NodeList-dom ../a11yclick".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x){f=U("dijit.layout.ScrollingTabController",[n,t],{baseClass:"dijitTabController dijitScrollingTabController",templateString:f,useMenu:!0,useSlider:!0,tabStripClass:"",_minScroll:5,_setClassAttr:{node:"containerNode",type:"class"},buildRendering:function(){this.inherited(arguments);var y=this.domNode;this.scrollNode=this.tablistWrapper;this._initButtons();this.tabStripClass||(this.tabStripClass="dijitTabContainer"+this.tabPosition.charAt(0).toUpperCase()+
this.tabPosition.substr(1).replace(/-.*/,"")+"None",q.add(y,"tabStrip-disabled"));q.add(this.tablistWrapper,this.tabStripClass)},onStartup:function(){this.inherited(arguments);l.set(this.domNode,"visibility","");this._postStartup=!0;this.own(a(this.containerNode,"attrmodified-label, attrmodified-iconclass",r.hitch(this,function(y){this._dim&&this.resize(this._dim)})))},onAddChild:function(y,C){this.inherited(arguments);l.set(this.containerNode,"width",l.get(this.containerNode,"width")+200+"px")},
onRemoveChild:function(y,C){var z=this.pane2button(y.id);this._selectedTab===z.domNode&&(this._selectedTab=null);this.inherited(arguments)},_initButtons:function(){this._btnWidth=0;this._buttons=c("\x3e .tabStripButton",this.domNode).filter(function(y){if(this.useMenu&&y==this._menuBtn.domNode||this.useSlider&&(y==this._rightBtn.domNode||y==this._leftBtn.domNode))return this._btnWidth+=b.getMarginSize(y).w,!0;l.set(y,"display","none");return!1},this)},_getTabsWidth:function(){var y=this.getChildren();
if(y.length){var C=y[this.isLeftToRight()?0:y.length-1].domNode;y=y[this.isLeftToRight()?y.length-1:0].domNode;return y.offsetLeft+y.offsetWidth-C.offsetLeft}return 0},_enableBtn:function(y){var C=this._getTabsWidth();y=y||l.get(this.scrollNode,"width");return 0<C&&y<C},resize:function(y){this._dim=y;this.scrollNode.style.height="auto";var C=this._contentBox=m.marginBox2contentBox(this.domNode,{h:0,w:y.w});C.h=this.scrollNode.offsetHeight;b.setContentSize(this.domNode,C);C=this._enableBtn(this._contentBox.w);
this._buttons.style("display",C?"":"none");this._leftBtn.region="left";this._rightBtn.region="right";this._menuBtn.region=this.isLeftToRight()?"right":"left";m.layoutChildren(this.domNode,this._contentBox,[this._menuBtn,this._leftBtn,this._rightBtn,{domNode:this.scrollNode,region:"center"}]);this._selectedTab&&(this._anim&&"playing"==this._anim.status()&&this._anim.stop(),this.scrollNode.scrollLeft=this._convertToScrollLeft(this._getScrollForSelectedTab()));this._setButtonClass(this._getScroll());
this._postResize=!0;return{h:this._contentBox.h,w:y.w}},_getScroll:function(){return this.isLeftToRight()||8>d("ie")||d("trident")&&d("quirks")||d("webkit")?this.scrollNode.scrollLeft:l.get(this.containerNode,"width")-l.get(this.scrollNode,"width")+(d("trident")||d("edge")?-1:1)*this.scrollNode.scrollLeft},_convertToScrollLeft:function(y){if(this.isLeftToRight()||8>d("ie")||d("trident")&&d("quirks")||d("webkit"))return y;var C=l.get(this.containerNode,"width")-l.get(this.scrollNode,"width");return(d("trident")||
d("edge")?-1:1)*(y-C)},onSelectChild:function(y,C){var z=this.pane2button(y.id);if(z){var F=z.domNode;if(F!=this._selectedTab&&(this._selectedTab=F,this._postResize)){var O=this._getScroll();O>F.offsetLeft||O+l.get(this.scrollNode,"width")<F.offsetLeft+l.get(F,"width")?(F=this.createSmoothScroll(),C&&(F.onEnd=function(){z.focus()}),F.play()):C&&z.focus()}this.inherited(arguments)}},_getScrollBounds:function(){var y=this.getChildren(),C=l.get(this.scrollNode,"width"),z=l.get(this.containerNode,"width")-
C,F=this._getTabsWidth();if(y.length&&F>C)return{min:this.isLeftToRight()?0:y[y.length-1].domNode.offsetLeft,max:this.isLeftToRight()?y[y.length-1].domNode.offsetLeft+y[y.length-1].domNode.offsetWidth-C:z};y=this.isLeftToRight()?0:z;return{min:y,max:y}},_getScrollForSelectedTab:function(){var y=this._selectedTab,C=l.get(this.scrollNode,"width"),z=this._getScrollBounds();y=y.offsetLeft+l.get(y,"width")/2-C/2;return y=Math.min(Math.max(y,z.min),z.max)},createSmoothScroll:function(y){if(0<arguments.length){var C=
this._getScrollBounds();y=Math.min(Math.max(y,C.min),C.max)}else y=this._getScrollForSelectedTab();this._anim&&"playing"==this._anim.status()&&this._anim.stop();var z=this,F=this.scrollNode,O=new p.Animation({beforeBegin:function(){this.curve&&delete this.curve;var V=F.scrollLeft,N=z._convertToScrollLeft(y);O.curve=new p._Line(V,N)},onAnimate:function(V){F.scrollLeft=V}});this._anim=O;this._setButtonClass(y);return O},_getBtnNode:function(y){for(y=y.target;y&&!q.contains(y,"tabStripButton");)y=y.parentNode;
return y},doSlideRight:function(y){this.doSlide(1,this._getBtnNode(y))},doSlideLeft:function(y){this.doSlide(-1,this._getBtnNode(y))},doSlide:function(y,C){if(!C||!q.contains(C,"dijitTabDisabled")){var z=.75*l.get(this.scrollNode,"width")*y;z=this._getScroll()+z;this._setButtonClass(z);this.createSmoothScroll(z).play()}},_setButtonClass:function(y){var C=this._getScrollBounds();this._leftBtn.set("disabled",y<=C.min);this._rightBtn.set("disabled",y>=C.max)}});g=U("dijit.layout._ScrollingTabControllerButtonMixin",
null,{baseClass:"dijitTab tabStripButton",templateString:g,tabIndex:"",isFocusable:function(){return!1}});U("dijit.layout._ScrollingTabControllerButton",[v,g]);U("dijit.layout._ScrollingTabControllerMenuButton",[v,x,g],{containerId:"",tabIndex:"-1",isLoaded:function(){return!1},loadDropDown:function(y){this.dropDown=new w({id:this.containerId+"_menu",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir});var C=h.byId(this.containerId);e.forEach(C.getChildren(),function(z){var F=
new u({id:z.id+"_stcMi",label:z.title,iconClass:z.iconClass,disabled:z.disabled,ownerDocument:this.ownerDocument,dir:z.dir,lang:z.lang,textDir:z.textDir||C.textDir,onClick:function(){C.selectChild(z)}});this.dropDown.addChild(F)},this);y()},closeDropDown:function(y){this.inherited(arguments);this.dropDown&&(this._popupStateNode.removeAttribute("aria-owns"),this.dropDown.destroyRecursive(),delete this.dropDown)}});return f})},"dgrid/extensions/ColumnHider":function(){define("dojo/_base/declare dojo/has dojo/on ../util/misc put-selector/put dojo/i18n!./nls/columnHider xstyle/css!../css/extensions/ColumnHider.css".split(" "),
function(e,U,q,b,l,p){var r,a,c=U("ie"),d=c&&U("quirks"),h=8>c||d?"htmlFor":"for";return e("dgrid.extensions.ColumnHider",null,{hiderMenuNode:null,hiderToggleNode:null,i18nColumnHider:p,_hiderMenuOpened:!1,_columnHiderRules:null,_columnHiderCheckboxes:null,_renderHiderMenuEntries:function(){var f=this.subRows,g=!0,n,m;delete this._columnHiderFirstCheckbox;var t=0;for(n=f.length;t<n;t++){var w=0;for(m=f[t].length;w<m;w++)this._renderHiderMenuEntry(f[t][w]),g&&(g=!1,this._columnHiderFirstCheckbox=this._columnHiderCheckboxes[f[t][w].id])}},
_renderHiderMenuEntry:function(f){var g=f.id,n=b.escapeCssIdentifier(g,"-");f.hidden&&(f.hidden=!1,this._hideColumn(g),f.hidden=!0);if(!f.unhidable){var m=l("div.dgrid-hider-menu-row");var t=this.domNode.id+"-hider-menu-check-"+n;g=this._columnHiderCheckboxes[g]=l(m,"input.dgrid-hider-menu-check.hider-menu-check-"+n+"[type\x3dcheckbox]");g.id=t;l(m,"label.dgrid-hider-menu-label.hider-menu-label-"+n+"["+h+"\x3d"+t+"]",f.label||f.field||"");l(this.hiderMenuNode,m);f.hidden||(g.checked=!0)}},renderHeader:function(){function f(w){w.stopPropagation()}
var g=this,n=this.hiderMenuNode,m=this.hiderToggleNode,t;this.inherited(arguments);if(n){for(t in this._columnHiderRules)this._columnHiderRules[t].remove();n.innerHTML=""}else m=this.hiderToggleNode=l(this.domNode,"button.ui-icon.dgrid-hider-toggle[type\x3dbutton][aria-label\x3d"+this.i18nColumnHider.popupTriggerLabel+"]"),this._listeners.push(q(m,"click",function(w){g._toggleColumnHiderMenu(w)})),n=this.hiderMenuNode=l("div.dgrid-hider-menu[role\x3ddialog][aria-label\x3d"+this.i18nColumnHider.popupLabel+
"]"),n.id=this.id+"-hider-menu",this._listeners.push(q(n,"keyup",function(w){27===(w.charCode||w.keyCode)&&(g._toggleColumnHiderMenu(w),m.focus())})),n.style.display="none",l(this.domNode,n),this._listeners.push(q(n,".dgrid-hider-menu-check:"+(9>c||d?"click":"change"),function(w){g._updateColumnHiddenState(w.target.id.substr(g.id.length+18),!w.target.checked)})),this._listeners.push(q(n,"mousedown",f),q(m,"mousedown",f)),a||(a=q.pausable(document,"mousedown",function(w){r&&r._toggleColumnHiderMenu(w)}),
a.pause());this._columnHiderCheckboxes={};this._columnHiderRules={};this._renderHiderMenuEntries()},destroy:function(){this.inherited(arguments);for(var f in this._columnHiderRules)this._columnHiderRules[f].remove()},left:function(f,g){return this.right(f,-g)},right:function(f,g){f.element||(f=this.cell(f));for(var n=this.inherited(arguments),m=f;n.column.hidden;){n=this.inherited(arguments,[n,0<g?1:-1]);if(m.element===n.element)return f;m=n}return n},isColumnHidden:function(f){return!!this._columnHiderRules[f]},
_toggleColumnHiderMenu:function(){var f=this._hiderMenuOpened,g=this.hiderMenuNode,n=this.domNode,m;g.style.display=f?"none":"";f?g.style.height="":(g.offsetHeight>n.offsetHeight-12&&(g.style.height=n.offsetHeight-12+"px"),(m=this._columnHiderFirstCheckbox)&&m.focus());a[f?"pause":"resume"]();r=f?null:this;this._hiderMenuOpened=!f},_hideColumn:function(f){var g=this,n="#"+b.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-";if(!(this._columnHiderRules[f]||(this._columnHiderRules[f]=b.addCssRule(n+
b.escapeCssIdentifier(f,"-"),"display: none;"),8!==U("ie")&&10!==U("ie")||U("quirks")))){var m=b.addCssRule(".dgrid-row-table","display: inline-table;");window.setTimeout(function(){m.remove();g.resize()},0)}},_showColumn:function(f){this._columnHiderRules[f]&&(this._columnHiderRules[f].remove(),delete this._columnHiderRules[f])},_updateColumnHiddenState:function(f,g){this[g?"_hideColumn":"_showColumn"](f);this.columns[f].hidden=g;q.emit(this.domNode,"dgrid-columnstatechange",{grid:this,column:this.columns[f],
hidden:g,bubbles:!0});this.resize()},toggleColumnHiddenState:function(f,g){"undefined"===typeof g&&(g=!this._columnHiderRules[f]);this._updateColumnHiddenState(f,g);this._columnHiderCheckboxes[f].checked=!g}})})},"esri/dijit/FeatureTable/storeUtils":function(){define("./dataUtils dojo/_base/array dojo/_base/lang dojo/store/Cache dojo/store/Memory dojo/store/Observable dojo/store/util/QueryResults ../FeatureLayerQueryStore".split(" "),function(e,U,q,b,l,p,r,a){return{generateMemoryStore:function(c){var d=
c.idProperty;c=U.map(c.features,function(h){return h.attributes});return new p(new l({data:c,idProperty:d}))},generateCacheStore:function(c){var d=c.grid,h=c.layer,f=c.ids||null,g=f&&f.length?f.length:d.featureCount,n=c.orderByFields,m=c.where||null,t=c.batchCount||25,w=c.getAttachments||!1;c=c.getRelatedRecords||!1;d=new l({idProperty:d.idProperty});h=new a({layer:h,objectIds:f,totalCount:g,batchCount:t,where:m||"1\x3d1",orderByFields:n,getAttachments:w,getRelatedRecords:c});return new b(h,d)},generateSort:function(c,
d,h,f){var g=function(){return function(m,t){var w=n[0],u=parseInt(w.columnId,10),v=w.attribute;if("esriAttachments"!==v&&"esriRelatedRecords"!==w.fieldType||"undefined"===typeof u){var x=m[v]&&m[v].toLowerCase?m[v].toLowerCase():m[v];u=t[v]&&t[v].toLowerCase?t[v].toLowerCase():t[v]}else x=c.columns[u].get(m),u=c.columns[u].get(t);x=e.isValueEmpty(x)?null:x.valueOf();u=e.isValueEmpty(u)?null:u.valueOf();return null===x&&null!==u?w.descending?-1:1:null!==x&&null===u?w.descending?1:-1:x===u?0:(x>u?
1:-1)*(w.descending?-1:1)}},n=f&&f.sort;n&&"function"!==typeof n&&(f.sort=g());return new r(d.queryEngine(h,f)(d.data))}}})},"dojo/store/Cache":function(){define(["../_base/lang","../when"],function(e,U){var q=function(b,l,p){p=p||{};return e.delegate(b,{query:function(r,a){var c=b.query(r,a);c.forEach(function(d){p.isLoaded&&!p.isLoaded(d)||l.put(d)});return c},queryEngine:b.queryEngine||l.queryEngine,get:function(r,a){return U(l.get(r),function(c){return c||U(b.get(r,a),function(d){d&&l.put(d,{id:r});
return d})})},add:function(r,a){return U(b.add(r,a),function(c){l.add(c&&"object"==typeof c?c:r,a);return c})},put:function(r,a){l.remove(a&&a.id||this.getIdentity(r));return U(b.put(r,a),function(c){l.put(c&&"object"==typeof c?c:r,a);return c})},remove:function(r,a){return U(b.remove(r,a),function(c){return l.remove(r,a)})},evict:function(r){return l.remove(r)}})};e.setObject("dojo.store.Cache",q);return q})},"esri/dijit/FeatureLayerQueryStore":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/promise/all dojo/Deferred ../request ../tasks/query ../tasks/RelationshipQuery ../dijit/FeatureLayerQueryResult dojo/i18n!../nls/jsapi".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h){b=e(null,{layer:null,data:null,objectIds:null,idProperty:"id",totalCount:0,batchCount:25,where:null,orderByFields:null,getAttachments:!1,getRelatedRecords:!1,constructor:function(f){e.safeMixin(this,f);this.data=[];this.idProperty=this.layer.objectIdField;this.idProperty||(f=JSON.parse(this.layer._json),f.uniqueIdField&&f.uniqueIdField.name&&(this.idProperty=f.uniqueIdField.name))},get:function(f){return this.data[f]},getIdentity:function(f){return f[this.idProperty]},
query:function(f,g){var n=new p,m=new a,t=g.start||0,w=g.count||this.batchCount,u=this.layer.relationships,v=this.layer.advancedQueryCapabilities,x=g.objectIds||this.objectIds,y={fields:[],features:[],attachmentInfos:{},relatedRecordInfos:{},count:0,total:this.totalCount,exceededTransferLimit:!1};x&&x.length?m.objectIds=x.length>=t+this.batchCount?x.slice(t,t+w):x.slice(t):(m.start=t,m.num=w,m.where=this.where);var C=v&&v.supportsOrderBy&&this.orderByFields&&this.orderByFields.length;C&&(m.orderByFields=
this.orderByFields);v&&v.supportsQueryWithCacheHint&&(m.cacheHint=!0);m.returnGeometry=!1;m.outFields=["*"];this.layer.queryFeatures(m).then(U.hitch(this,function(z){if(z.features&&z.features.length){var F=z.objectIdFieldName;F||(q.some(z.fields,function(D,K){if("esriFieldTypeOID"===D.type)return F=D.name,!1}),!F&&z.uniqueIdField&&(F=z.uniqueIdField.name),F||(F=this.idProperty));var O=[],V=[],N={};this.objectIds&&!C&&(q.forEach(z.features,function(D,K){N[D.attributes[F]]=D}),z.features=q.map(m.objectIds,
function(D){return N[D]}));var J=q.map(z.features,function(D){var K=D.attributes,G=K[F];O.push(G);this.data[G]=D;return K},this);y.exceededTransferLimit=!!z.exceededTransferLimit;y.count=z.features.length;y.features=J;y.fields=z.fields;this.getAttachments&&this.getRelatedRecords?(V.push(this._queryAttachments(O)),q.forEach(u,function(D){V.push(this._queryRelatedRecords(O,D))},this),l(V).then(U.hitch(this,function(D){y.attachmentInfos=this._createAttachmentInfoLookup(D.shift());y.relatedRecordInfos=
this._createRelatedRecordInfoLookup(D);n.resolve(y)})).otherwise(function(){n.resolve(y)})):this.getRelatedRecords?(q.forEach(u,function(D){V.push(this._queryRelatedRecords(O,D))},this),l(V).then(U.hitch(this,function(D){y.relatedRecordInfos=this._createRelatedRecordInfoLookup(D);n.resolve(y)})).otherwise(function(){n.resolve(y)})):this.getAttachments?this._queryAttachments(O).then(U.hitch(this,function(D){y.attachmentInfos=this._createAttachmentInfoLookup(D);n.resolve(y)})).otherwise(function(){n.resolve(y)}):
n.resolve(y)}else n.resolve(y)})).otherwise(function(z){n.reject(y)});return new d(n)},_queryRelatedRecords:function(f,g){var n=this.layer,m=n.advancedQueryCapabilities;if(m&&m.supportsAdvancedQueryRelated)return this._queryRelatedRecordCount(f,g);m=new c;m.outFields=["*"];m.returnGeometry=!1;m.relationshipId=g.id;m.objectIds=f;return n.queryRelatedFeatures(m)},_queryRelatedRecordCount:function(f,g){return r({url:this.layer._url.path+"/queryRelatedRecords",content:{f:"json",objectIds:f.toString(),
outFields:["*"],returnGeometry:!1,relationshipId:g.id,returnCountOnly:!0},handleAs:"json",callbackParamName:"callback"})},_createRelatedRecordInfoLookup:function(f){var g=this.layer.relationships,n={};q.forEach(f,function(m,t){n[g[t].id]=m});return n},_queryAttachments:function(f){return r({url:this.layer._url.path+"/queryAttachments",content:{f:"json",objectIds:f.toString()},handleAs:"json",callbackParamName:"callback"})},_createAttachmentInfoLookup:function(f){var g={};q.forEach(f.attachmentGroups,
function(n){g[n.parentObjectId]={attachments:n.attachmentInfos}});return g}});U.setObject("dijit.FeatureLayerQueryStore",b,h);return b})},"esri/dijit/FeatureLayerQueryResult":function(){define(["../lang","dojo/_base/lang","dojo/_base/kernel","dojo/_base/Deferred"],function(e,U,q,b){var l=function(p){function r(a){p[a]||(p[a]=function(){var c=arguments;return b.when(p,function(d){Array.prototype.unshift.call(c,d.features||d);return new l(q[a].apply(q,c))})})}if(!p)return p;p.then&&(p=U.delegate(p));
p.total||(p.total=b.when(p,function(a){return e.isDefined(a.total)?a.total:a.length||0}));r("forEach");r("filter");r("map");r("some");r("every");return p};U.setObject("dijit.FeatureLayerQueryResult",l);return l})},"esri/dijit/Histogram":function(){define("require ../kernel dijit/_TemplatedMixin dijit/_WidgetBase dijit/Tooltip dojo/has dojo/on dojo/string dojo/number dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-geometry dojo/date/locale dojox/gfx dojo/i18n!../nls/jsapi dojo/text!./Histogram/templates/Histogram.html".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y){q=h([b,q],{declaredClass:"esri.dijit.Histogram",baseClass:"esri-histogram",templateString:y,data:null,statistics:null,isDate:!1,css:{container:"esri-histogram-container",topLabel:"esri-histogram-top-label",svgContainer:"esri-histogram-svg-container",bottomLabel:"esri-histogram-bottom-label",surface:"esri-histogram-surface",group:"esri-histogram-group",bar:"esri-histogram-bar"},_surface:null,_countTooltips:null,_barsGroup:null,_defaultImagePadding:30,
_defaultBarPadding:40,_i18n:x.widgets.histogram,constructor:function(C,z){this._countTooltips=[]},startup:function(){this.inherited(arguments);this._syncContainerSizes();this._surface=this._generateSurface();this._barsGroup=this._generateBarsGroup();this.statistics&&(this._generateLines(),this._generateCountTooltips());this._updateLabels()},_syncContainerSizes:function(){this._nodeDimensions=w.getMarginBox(this.domNode);this._topLabelHeight=w.getMarginBox(this._topLabelNode).h;this._bottomLabelHeight=
w.getMarginBox(this._bottomLabelNode).h;this._svgContainer.setAttribute("style","height: "+(this._nodeDimensions.h-(this._topLabelHeight+this._bottomLabelHeight)-1)+"px;");this._svgContainerDimensions=w.getMarginBox(this._svgContainer)},_updateLabels:function(){var C=this.data.maxValue,z=this.data.minValue;this._topLabelNode.innerHTML=this.isDate?this._getFormattedDate(C):this._getLocaleFormattedNumber(C);this._bottomLabelNode.innerHTML=this.isDate?this._getFormattedDate(z):this._getLocaleFormattedNumber(z)},
_generateSurface:function(){var C=v.createSurface(this._svgContainer,"100%","100%");C.rawNode.setAttribute("class",this.css.surface);return C},_generateBarsGroup:function(){var C=this.data,z=this._defaultBarPadding,F;var O=this._surface.createGroup();O.rawNode.setAttribute("class",this.css.group);var V=d.map(C.bins,function(J){return"object"===typeof J?J.count:J});V.reverse();var N=(this._svgContainerDimensions.h-1)/V.length;d.forEach(V,function(J,D){F=Math.round(0<J?(this._svgContainerDimensions.w-
z)*(J/Math.max.apply(Math,V)):0);var K=O.createRect({width:F,height:N}).setFill("#aaa").setTransform(v.matrix.translate(1,N*D-1)).setStroke({color:"#FFF",width:2});K.rawNode.setAttribute("class",this.css.bar);K.rawNode.setAttribute("shape-rendering","crispEdges")},this);return O},_generateLines:function(){var C=this.statistics,z=this._svgContainerDimensions.h;var F=this.isDate?this._getFormattedDate(C.avg):this._getLocaleFormattedNumber(this._roundValueForLabel(C.avg));F=a.substitute(this._i18n.statsAvg,
{avg:F});var O=this._getLocaleFormattedNumber(this._roundValueForLabel(C.stddev));O=a.substitute(this._i18n.statsSD,{sd:O});var V={color:"#667",style:"Dot"};this._generateLine({label:F,lineStroke:{color:"#667"},imageURL:"esri/dijit/Histogram/images/xAvg.png",yAxisAlignment:z*(C.max-C.avg)/(C.max-C.min),imagePadding:this._defaultImagePadding});this._generateLine({label:O,lineStroke:V,imageURL:"esri/dijit/Histogram/images/sd.png",yAxisAlignment:z*(C.max-C.avg-C.stddev)/(C.max-C.min),imagePadding:this._defaultImagePadding+
10});this._generateLine({label:O,lineStroke:V,imageURL:"esri/dijit/Histogram/images/sd.png",yAxisAlignment:z*(C.max-C.avg+C.stddev)/(C.max-C.min),imagePadding:this._defaultImagePadding+10})},_generateLine:function(C){var z=this._surface,F=this._svgContainerDimensions.h,O=C.yAxisAlignment,V=C.imageURL,N=C.lineStroke,J=C.label;C=C.imagePadding;N=z.createLine({x1:0,x2:this._svgContainerDimensions.w-C,y1:O,y2:O}).setStroke(N);N.rawNode.setAttribute("shape-rendering","crispEdges");z=z.createImage({x:this._svgContainerDimensions.w-
C,y:O-6,width:12,height:14,src:e.toUrl(V)});new l({connectId:[z.rawNode],label:J});F=O>F||0>O?"none":"block";m.set(N.rawNode,"display",F);m.set(z.rawNode,"display",F)},_generateCountTooltips:function(){var C=d.map(this.data.bins,function(z){return"object"===typeof z?z.count:z});C.reverse();d.forEach(C,function(z,F){var O=a.substitute(this._i18n.count,{count:z});this._countTooltips.push(new l({connectId:[this._barsGroup.children[F].rawNode],label:O}))},this)},_getLocaleFormattedNumber:function(C){return isNaN(C)?
null:c.format(C)},_getFormattedDate:function(C){return u.format(new Date(C))},_roundValueForLabel:function(C){return c.round(C,this._getRoundingPrecision(C))},_getRoundingPrecision:function(C){return 1E3<=C?0:10<=C?2:0<=C?4:6}});f.setObject("dijit.Histogram",q,U);return q})},"arcgisonline/map/itemData":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/sharing/dijit/dialog/GeneralDlg,arcgisonline/map/main,arcgisonline/map/popup,arcgisonline/map/mapUtil,arcgisonline/map/featColl,arcgisonline/map/labels"],
function(e,U,q){e.provide("arcgisonline.map.itemData");e.require("arcgisonline.sharing.dijit.dialog.GeneralDlg");e.require("arcgisonline.map.main");e.require("arcgisonline.map.popup");e.require("arcgisonline.map.mapUtil");e.require("arcgisonline.map.featColl");e.require("arcgisonline.map.labels");arcgisonline.map.itemData={itemDataContents:{},deletedFSItemSubLayers:{},checkItemDataContent:function(b,l){var p=function(){l&&l()};if(b.itemId&&b.featureCollection)l&&l();else if(b.itemId&&"esri.layers.FeatureLayer"===
b.layer.declaredClass){var r=function(a){var c=!1;if(a.origItemLayers){a.__createDefaultPopup&&(arcgisonline.map.popup.removePopup(a),a.popupChanged=!1,delete a.popupInfo,delete a.__createDefaultPopup);for(var d=parseInt(a.layer.url.substring(a.layer.url.lastIndexOf("/")+1)),h=!1,f=0;f<a.origItemLayers.length;f++){var g=a.origItemLayers[f];if(g.id===d){h=!0;!g.popupInfo||g.disablePopup||a.popupInfo||a.disablePopup?g.popupInfo||a.popupInfo||(a.disablePopup=!0):(a.popupInfo=g.popupInfo,arcgisonline.map.popup.addPopupLayer(a,
null),a.popupChanged=!1,arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.popupChanged=!0));g.showLabels&&(a.showLabels=!0);d=a.rendererChanged||a.featureReductionChanged||a.scaleChanged||a.defExpChanged||a.spatialFilterChanged||a.maximumTrackPointsChanged;g.layerDefinition&&g.layerDefinition.drawingInfo&&(g.layerDefinition.drawingInfo.renderer||g.layerDefinition.drawingInfo.labelingInfo||g.layerDefinition.featureReduction)?(a.layerDefinition&&arcgisonline.isEmpty(a.layerDefinition)&&(d=
a.rendererChanged=!0),d||(a.layerDefinition=a.layerDefinition||{},a.layerDefinition.drawingInfo=e.clone(g.layerDefinition.drawingInfo),g.layerDefinition.drawingInfo&&g.layerDefinition.drawingInfo.renderer&&(f=esri.renderer.fromJson(e.clone(g.layerDefinition.drawingInfo.renderer),{geometryType:a.layer.geometryType}),"esri.renderer.ClassBreaksRenderer"===f.declaredClass&&f.setMaxInclusive(!0),arcgisonline.map.mapUtil.setRenderer(a.layer,f),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.rendererChanged=
!0),arcgisonline.map.mapUtil.checkHostedFSAccess(a,e.hitch(this,function(t){if(!t.layer.templates.length&&("esri.renderer.SimpleRenderer"==t.layer.renderer.declaredClass||"esri.renderer.ClassBreaksRenderer"==t.layer.renderer.declaredClass||"esri.renderer.HeatmapRenderer"==t.layer.renderer.declaredClass)||!t.layer.types.length&&"esri.renderer.UniqueValueRenderer"==t.layer.renderer.declaredClass)arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(t.layer),arcgisonline.map.edit.createTypesAndTemplatesOnLayer(t.layer),
t.featureTemplatesChanged=!0},a))),g.layerDefinition.drawingInfo&&g.layerDefinition.drawingInfo.labelingInfo&&(f=e.map(g.layerDefinition.drawingInfo.labelingInfo,function(t){return new esri.layers.LabelClass(t)}),arcgisonline.map.mapUtil.setLabelingInfo(a.layer,f,g.showLabels),g.showLabels&&arcgisonline.map.labels.addLabelsForLayer(a.layer),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.rendererChanged=!0)),g.layerDefinition.featureReduction&&(a.layerDefinition.featureReduction=e.clone(g.layerDefinition.featureReduction),
f=e.clone(g.layerDefinition.featureReduction),f.clusterRadius=q.gfx.pt2px(f.clusterRadius||f.clusterSize),f.popupInfo&&f.disablePopup&&(delete f.popupInfo,delete f.disablePopup),f.popupInfo?(f.infoTemplate=new esri.dijit.PopupTemplate(f.popupInfo),delete f.popupInfo):f.disablePopup=!0,a.layer.setFeatureReduction(f),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.featureReductionChanged=!0)))):!d&&g.showLabels&&a.layer.labelingInfo&&(a.showLabels=!0,arcgisonline.map.labels.addLabelsForLayer(a.layer));
g.showLabels&&a.showLabels&&!arcgisonline.map.main.isItemFromSamePortal(a.itemCard)&&(a.rendererChanged=!0);!d&&g.layerDefinition&&g.layerDefinition.definitionExpression&&(a.layer.setDefinitionExpression(g.layerDefinition.definitionExpression),a.layerDefinition=a.layerDefinition||{},a.layerDefinition.definitionExpression=g.layerDefinition.definitionExpression,g.definitionEditor&&(a.definitionEditor=g.definitionEditor),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.defExpChanged=!0));!d&&
g.layerDefinition&&(esri.isDefined(g.layerDefinition.minScale)||esri.isDefined(g.layerDefinition.maxScale))&&(a.layer.setScaleRange(esri.isDefined(g.layerDefinition.minScale)?g.layerDefinition.minScale:a.layer.minScale,esri.isDefined(g.layerDefinition.maxScale)?g.layerDefinition.maxScale:a.layer.maxScale),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.scaleChanged=!0));a.legendChanged||(!1===g.showLegend?(a.showLegend=!1,arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.legendChanged=
!0)):delete a.showLegend);!a.refreshIntervalChanged&&esri.isDefined(g.refreshInterval)&&(a.layer.setRefreshInterval(g.refreshInterval),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.refreshIntervalChanged=!0));if(esri.isDefined(g.timeAnimation)){var n=!1;arcgisonline.map.save_open.openedWebMap&&(d=arcgisonline.map.save_open.openedWebMap,d=d.operationalLayers.concat(d.baseMap.baseMapLayers),e.forEach(d,function(t){t.id===a.id&&esri.isDefined(t.timeAnimation)&&(n=!0)}));n||(a.layer.setUseMapTime(g.timeAnimation),
arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.timeChanged=!0))}if(g.layerDefinition&&(g.layerDefinition.drawingInfo&&esri.isDefined(g.layerDefinition.drawingInfo.transparency)||esri.isDefined(g.layerDefinition.defaultVisibility)))if(arcgisonline.map.main.isWebMapLayer(a)){var m=!1;arcgisonline.map.save_open.openedWebMap&&(d=arcgisonline.map.save_open.openedWebMap,d=d.operationalLayers.concat(d.baseMap.baseMapLayers),e.forEach(d,function(t){t.id===a.id&&esri.isDefined(t.opacity)&&(m=!0)}));
!m&&g.layerDefinition.drawingInfo&&esri.isDefined(g.layerDefinition.drawingInfo.transparency)&&a.layer.setOpacity(1-g.layerDefinition.drawingInfo.transparency/100)}else g.layerDefinition.drawingInfo&&esri.isDefined(g.layerDefinition.drawingInfo.transparency)&&a.layer.setOpacity(1-g.layerDefinition.drawingInfo.transparency/100),esri.isDefined(g.layerDefinition.defaultVisibility)&&(g.layerDefinition.defaultVisibility?(a.layer.show(),a.visibility=!0):(a.layer.hide(),a.visibility=!1));!a.rendererChanged&&
!a.scaleChanged&&g.layerDefinition&&(g.layerDefinition.drawingInfo&&(g.layerDefinition.drawingInfo.renderer||g.layerDefinition.drawingInfo.labelingInfo)&&!g.layerDefinition.featureReduction||esri.isDefined(g.layerDefinition.minScale)||esri.isDefined(g.layerDefinition.maxScale))&&arcgisonline.map.mapUtil.checkHostedFSAccess(a,e.hitch(this,function(t,w){t.layerDefinition.drawingInfo&&(t.layerDefinition.drawingInfo.renderer||t.layerDefinition.drawingInfo.labelingInfo)&&(w.rendererChanged=!0);if(esri.isDefined(t.layerDefinition.minScale)||
esri.isDefined(t.layerDefinition.maxScale))w.scaleChanged=!0},g));break}}h||(c=!0)}l&&l(c)};arcgisonline.map.itemData.getItemLayerInfos(b,e.hitch(this,r,b),e.hitch(this,p))}else b.itemId&&"esri.layers.StreamLayer"===b.layer.declaredClass?(r=function(a){var c=arcgisonline.map.itemData.itemDataContents[a.itemId],d=arcgisonline.map.main.isItemFromSamePortal(a.itemCard);!c.empty&&a.__createDefaultPopup&&(arcgisonline.map.popup.removePopup(a),a.popupChanged=!1,delete a.popupInfo,delete a.__createDefaultPopup);
!c.popupInfo||a.popupInfo||a.disablePopup?c.popupInfo||a.popupInfo||(a.disablePopup=!0):(a.popupInfo=c.popupInfo,arcgisonline.map.popup.addPopupLayer(a,null),a.popupChanged=!1,d||(a.popupChanged=!0));var h=a.rendererChanged||a.scaleChanged||a.defExpChanged||a.spatialFilterChanged||a.maximumTrackPointsChanged||a.opacityChanged||a.featureReductionChanged;if(c.layerDefinition&&c.layerDefinition.drawingInfo&&c.layerDefinition.drawingInfo.renderer&&(a.layerDefinition&&arcgisonline.isEmpty(a.layerDefinition)&&
(h=a.rendererChanged=!0),!h)){a.layerDefinition=a.layerDefinition||{};a.layerDefinition.drawingInfo=e.clone(c.layerDefinition.drawingInfo);var f=esri.renderer.fromJson(e.clone(c.layerDefinition.drawingInfo.renderer),{geometryType:a.layer.geometryType});"esri.renderer.ClassBreaksRenderer"===f.declaredClass&&f.setMaxInclusive(!0);arcgisonline.map.mapUtil.setRenderer(a.layer,f);d||(a.rendererChanged=!0);c.layerDefinition.drawingInfo&&c.layerDefinition.drawingInfo.labelingInfo&&(f=e.map(c.layerDefinition.drawingInfo.labelingInfo,
function(g){return new esri.layers.LabelClass(g)}),arcgisonline.map.mapUtil.setLabelingInfo(a.layer,f,c.showLabels),(a.showLabels=c.showLabels)&&arcgisonline.map.labels.addLabelsForLayer(a.layer),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.rendererChanged=!0));c.layerDefinition.featureReduction&&(a.layerDefinition.featureReduction=e.clone(c.layerDefinition.featureReduction),f=e.clone(c.layerDefinition.featureReduction),f.clusterRadius=q.gfx.pt2px(f.clusterRadius||f.clusterSize),f.popupInfo&&
f.disablePopup&&(delete f.popupInfo,delete f.disablePopup),f.popupInfo?(f.infoTemplate=new esri.dijit.PopupTemplate(f.popupInfo),delete f.popupInfo):f.disablePopup=!0,a.layer.setFeatureReduction(f),d||(a.featureReductionChanged=!0))}!h&&c.layerDefinition&&(esri.isDefined(c.layerDefinition.minScale)||esri.isDefined(c.layerDefinition.maxScale))&&(a.layer.setScaleRange(esri.isDefined(c.layerDefinition.minScale)?c.layerDefinition.minScale:a.layer.minScale,esri.isDefined(c.layerDefinition.maxScale)?c.layerDefinition.maxScale:
a.layer.maxScale),d||(a.scaleChanged=!0));!h&&c.layerDefinition&&c.layerDefinition.definitionExpression&&(a.layer.setDefinitionExpression(c.layerDefinition.definitionExpression),a.layerDefinition=a.layerDefinition||{},a.layerDefinition.definitionExpression=c.layerDefinition.definitionExpression,c.definitionEditor&&(a.definitionEditor=c.definitionEditor),d||(a.scaleChanged=!0));h&&!a.spatialFilterChanged&&c.layerDefinition&&c.layerDefinition.definitionGeometry?a.spatialFilterChanged=!0:!h&&c.layerDefinition&&
c.layerDefinition.definitionGeometry&&(a.layer.setFilter({geometry:new esri.geometry.Extent(c.layerDefinition.definitionGeometry)}),d||(a.spatialFilterChanged=!0));!h&&c.layerDefinition&&esri.isDefined(c.layerDefinition.maximumTrackPoints)&&(a.layer.setMaximumTrackPoints(c.layerDefinition.maximumTrackPoints),d||(a.maximumTrackPointsChanged=!0));a.legendChanged||(!1===c.showLegend?(a.showLegend=!1,d||(a.legendChanged=!0)):delete a.showLegend);!esri.isDefined(c.opacity)&&!esri.isDefined(c.visibility)||
arcgisonline.map.main.isWebMapLayer(a)||(esri.isDefined(c.opacity)&&(a.layer.setOpacity(c.opacity),a.defaultOpacity=c.opacity),esri.isDefined(c.visibility)&&(c.visibility?(a.layer.show(),a.visibility=!0,a.defaultVisibility=!0):(a.layer.hide(),a.visibility=!1,a.defaultVisibility=!1)));l&&l()},arcgisonline.map.itemData.getItemLayerInfos(b,e.hitch(this,r,b),e.hitch(this,p))):b.itemId?(r=function(a){a.itemLayers||(a.itemLayers=e.clone(a.origItemLayers));var c=arcgisonline.map.itemData.itemDataContents[a.itemId];
if(c){var d=!1;if(arcgisonline.map.save_open.openedWebMap){var h=arcgisonline.map.save_open.openedWebMap;h=h.operationalLayers.concat(h.baseMap.baseMapLayers);e.forEach(h,function(n){n.id===a.id&&esri.isDefined(n.minScale)&&esri.isDefined(n.maxScale)&&(d=!0)})}d||((esri.isDefined(c.minScale)||esri.isDefined(c.maxScale))&&a.layer.setScaleRange(esri.isDefined(c.minScale)?c.minScale:a.layer.minScale,esri.isDefined(c.maxScale)?c.maxScale:a.layer.maxScale),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||
(a.scaleChanged=!0));!a.refreshIntervalChanged&&esri.isDefined(c.refreshInterval)&&(a.layer.setRefreshInterval(c.refreshInterval),delete a.refreshInterval,arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.refreshIntervalChanged=!0));!a.timeChanged&&esri.isDefined(c.timeAnimation)&&(a.layer.setUseMapTime(!1),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.timeChanged=!0));!esri.isDefined(c.opacity)&&!esri.isDefined(c.visibility)||arcgisonline.map.main.isWebMapLayer(a)||(esri.isDefined(c.opacity)&&
1===a.layer.opacity&&a.layer.setOpacity(c.opacity),esri.isDefined(c.visibility)&&(c.visibility?(a.layer.show(),a.visibility=!0,a.defaultVisibility=!0):(a.layer.hide(),a.visibility=!1,a.defaultVisibility=!1)));if("esri.layers.RasterXLayer"===a.layer.declaredClass||"esri.layers.ArcGISImageServiceLayer"===a.layer.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===a.layer.declaredClass){!a.defaultBandIds&&c.bandIds&&(a.layer.setBandIds(c.bandIds),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||
(a.renderingRuleChanged=!0));!a.renderingRule&&c.renderingRule&&(h=new esri.layers.RasterFunction(c.renderingRule),a.layer.setRenderingRule(h,!0),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.renderingRuleChanged=!0));if(!a.layerDefinition&&c.layerDefinition&&c.layerDefinition.drawingInfo&&c.layerDefinition.drawingInfo.renderer){h=c.layerDefinition.drawingInfo.renderer;var f=esri.renderer.fromJson(e.clone(h));a.layer.setRenderer(f,!0);arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||
(a.rendererChanged=!0);!a.symbolTileSize&&c.symbolTileSize&&(a.layer.symbolTileSize=c.symbolTileSize);f=a.layer.vectorFieldPixelFilter||new esri.layers.pixelFilters.VectorFieldPixelFilter;if(h.outputUnit||h.inputUnit)f.setUnits(h.inputUnit,h.outputUnit),a.layer.vectorFieldPixelFilter=f}!a.mosaicRule&&c.mosaicRule&&(h=new esri.layers.MosaicRule(c.mosaicRule),a.layer.setMosaicRule(h,!0),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.mosaicRuleChanged=!0));!a.mosaicRule&&c.multidimensionalDefinition&&
"esri.layers.RasterXLayer"===a.layer.declaredClass&&(h=new esri.layers.MosaicRule,h.multidimensionalDefinition=c.multidimensionalDefinition.map(function(n){return new esri.layers.DimensionalDefinition(n)}),a.layer.setMosaicRule(h,!0),a.layer.setMultiDimensionalDefinition(h),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.mosaicRuleChanged=!0));!a.format&&c.format&&(a.layer.setImageFormat(c.format,!0),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.imageQualityChanged=!0));!a.compressionQuality&&
c.compressionQuality&&(a.layer.setCompressionQuality(c.compressionQuality,!0),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.imageQualityChanged=!0));!a.interpolation&&c.interpolation&&a.layer.setInterpolation(c.interpolation,!0);a.popupInfo||a.disablePopup||!c.popupInfo?c.popupInfo||a.popupInfo||(a.disablePopup=!0):(a.popupInfo=c.popupInfo,arcgisonline.map.popup.addPopupLayer(a,null),a.popupChanged=!1,arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.popupChanged=!0));(!a.layerDefinition||
a.layerDefinition&&arcgisonline.isEmpty(a.layerDefinition.definitionExpression))&&c.layerDefinition&&esri.isDefined(c.layerDefinition.definitionExpression)&&(a.layer.setDefinitionExpression(c.layerDefinition.definitionExpression),a.layerDefinition=c.layerDefinition||{},a.layerDefinition.definitionExpression=c.layerDefinition.definitionExpression,c.definitionEditor&&(a.definitionEditor=c.definitionEditor),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.defExpChanged=!0));a.legendChanged||
(!1===c.showLegend?(a.showLegend=!1,arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.legendChanged=!0)):delete a.showLegend)}}if(a.itemLayers&&0<a.itemLayers.length){var g=[];e.forEach(a.itemLayers,function(n){n.layerDefinition&&n.layerDefinition.definitionExpression&&(a.layer.setLayerDefinitions?g[n.id]=n.layerDefinition.definitionExpression:delete n.layerDefinition.definitionExpression)},this);g.length&&(a.layer.setLayerDefinitions(g),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||
(a.defExpChanged=!0));arcgisonline.map.main.hasDynamicLayers(a)&&a.origItemLayers&&!a.layersChanged&&arcgisonline.map.dynLayer.updateDynamicLayers(a)}!a.visibleLayersChanged&&c.visibleLayers&&(a.layer.setVisibleLayers?(a.visibleLayers=c.visibleLayers.toString(),h=a.layer.layerInfos,arcgisonline.map.main.hasDynamicLayers(a)&&(h=a.itemLayers),c=arcgisonline.map.main.filterSubLayers(h,c.visibleLayers.toString()),a.layer.setVisibleLayers(c),arcgisonline.map.main.isItemFromSamePortal(a.itemCard)||(a.visibleLayersChanged=
!0)):delete c.visibleLayers);a.popupChanged||arcgisonline.map.main.isMapFullyLoaded&&(arcgisonline.map.main.hasDynamicLayers(a)?arcgisonline.map.main.getLayersInfo(a,e.hitch(this,function(){e.forEach(a.layer.dynamicLayerInfos,function(n,m){arcgisonline.map.popup.addPopupLayer(a,n.id)},this)})):arcgisonline.map.main.getLayersInfo(a,e.hitch(this,function(){e.forEach(a.layer.layerInfos,function(n){arcgisonline.map.popup.addPopupLayer(a,n.id)},this)})));l&&l()},arcgisonline.map.itemData.getItemLayerInfos(b,
e.hitch(this,r,b),e.hitch(this,p))):l&&l()},getItemLayerInfos:function(b,l,p){var r=function(){var a=arcgisonline.map.itemData.itemDataContents[b.itemId];a.error||a.message&&!esri.isDefined(a.layers)?p&&p():(a.layers&&(b.origItemLayers=a.layers,b.thematicGroup=a.thematicGroup),esri.isDefined(a.refreshInterval)&&!esri.isDefined(b.refreshInterval)&&(b.refreshInterval=a.refreshInterval),a.visibleLayers&&!esri.isDefined(b.visibleLayers)&&(b.visibleLayers=a.visibleLayers.toString()),l())};arcgisonline.map.itemData.itemDataContents[b.itemId]?
arcgisonline.map.itemData.itemDataContents[b.itemId].loading?b.intervalHandler||(b.intervalHandler=setInterval(e.hitch(this,function(){!0!==arcgisonline.map.itemData.itemDataContents[b.itemId].loading&&(clearInterval(b.intervalHandler),delete b.intervalHandler,r())}),500)):r():(arcgisonline.map.itemData.itemDataContents[b.itemId]={loading:!0},arcgisonline.sharing.util.request({url:(b.itemCard&&b.itemCard.restBaseUrl||esriGeowConfig.restBaseUrl)+"content/items/"+b.itemId+"/data"},{disableIdentityLookup:!0}).then(e.hitch(this,
function(a){null===a&&b.url&&-1<b.url.toLowerCase().indexOf("/streamserver")&&(a={empty:!0});a=a||{};arcgisonline.map.itemData.itemDataContents[b.itemId]=a;r()}),e.hitch(this,function(a){arcgisonline.map.itemData.itemDataContents[b.itemId]=a;p&&p()})))},uploadItemLayerInfos:function(b,l,p,r){var a=new e.Deferred;if(arcgisonline.sharing.util.isLoggedIn()){var c=function(w,u,v){n?(u=(new Date).getTime()-g.getTime(),setTimeout(function(){t.hide("uploadItemLayerInfos")},6E3>u?6E3-u:0)):t.hide("uploadItemLayerInfos");
b.itemLayers&&b.itemLayers.length?b.origItemLayers=e.clone(b.itemLayers):b.layer&&b.layer.url&&!(b.layer instanceof esri.layers.StreamLayer)&&(b.defExpChanged||b.spatialFilterChanged||b.rendererChanged&&!p||b.renderingRuleChanged||b.featureReductionChanged)&&arcgisonline.map.thumbnail.recreateItemThumbnail(b);arcgisonline.map.itemData.itemDataContents[b.itemId]=w;b.popupInfo&&b.popupChanged&&!m&&delete b.popupChanged;delete b.legendChanged;delete b.scaleChanged;delete b.defExpChanged;delete b.spatialFilterChanged;
delete b.maximumTrackPointsChanged;delete b.renderingRuleChanged;delete b.mosaicRuleChanged;delete b.imageQualityChanged;delete b.refreshIntervalChanged;delete b.visibleLayersChanged;delete b.dataChanged;delete b.editableChanged;delete b.timeChanged;delete b.visibilityChanged;delete b.opacityChanged;delete b.layersChanged;b.featureReductionChanged&&delete b.rendererChanged;delete b.featureReductionChanged;arcgisonline.map.mapUtil.checkHostedFSAccess(b,e.hitch(this,function(x){delete x.rendererChanged}),
e.hitch(this,function(x){p||delete x.rendererChanged}));l&&l();!a.isResolved()&&a.callback()},d=function(w,u){t.hide("uploadItemLayerInfos");r?r(w):arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingPropsFailed,{title:b.itemCard.title})})},h,f=function(){if(!b.layer||"esri.layers.FeatureLayer"!==b.layer.declaredClass||b.origItemLayers||arcgisonline.map.itemData.deletedFSItemSubLayers[b.itemId]){var w=
function(D,K,G){var I={};if(K){if(K.layers){var R=[];e.forEach(K.layers,function(B,H){B[H]&&delete B[H];R.push(B)});K.layers=R}delete K.empty;I.text=e.json.stringify(K)}G&&(I.thumbnailURL=G);if(D.itemCard&&"Feature Service"===D.itemCard.type&&(arcgisonline.sharing.util.isHostedService(D.url)||-1<e.indexOf(D.itemCard.typeKeywords,"providerSDS"))&&(G=D.itemCard.typeKeywords,-1<e.indexOf(G,"webmap_2.1"))){var A=e.indexOf(G,"webmap_2.1");G.splice(A,1);I.typeKeywords=G.toString()}arcgisonline.sharing.util.getUser();
G=esriGeowConfig.restBaseUrl+"content/users/"+D.itemCard.owner;G+=D.itemCard.ownerFolder?"/"+D.itemCard.ownerFolder:"";G+="/items/"+D.itemCard.id+"/update";arcgisonline.sharing.util.postJson(I,G,e.hitch(this,c,K),e.hitch(this,d))},u=arcgisonline.map.itemData.itemDataContents[b.itemId]||{};if(arcgisonline.map.featColl.isFeatureCollection(b)){var v=arcgisonline.map.featColl.buildFeatureCollectionJson(b);p&&(b.layers?e.forEach(v.layers,function(D,K){D.layerDefinition&&D.layerDefinition.drawingInfo&&
(D.layerDefinition.drawingInfo=u.featureCollection?u.featureCollection.layers[K].layerDefinition.drawingInfo:u.layers[K].layerDefinition.drawingInfo)}):v.layers[0].layerDefinition&&u.layers[0].layerDefinition&&(v.layers[0].layerDefinition.drawingInfo=u.layers[0].layerDefinition.drawingInfo));if(b.layers)if(v.opacity=b.layers[0].opacity||0===b.layers[0].opacity?b.layers[0].opacity:1,v.visibility=0==b.visibility?!1:!0,esri.isDefined(b.visibleLayers))if(""===b.visibleLayers)v.visibleLayers=[];else{var x=
b.visibleLayers.split(",");x.length<b.layers.length&&(v.visibleLayers=e.map(x,function(D){return parseInt(D)}))}else delete v.visibleLayers;else v.visibility=b.layer.visible,v.opacity=b.layer.opacity||0===b.layer.opacity?b.layer.opacity:1;delete u.layers;v=e.mixin(u,v);(b.rendererChanged&&!p||b.featureReductionChanged||b.scaleChanged||b.renderingRuleChanged)&&!arcgisonline.map.thumbnail.hasCustomThumbnail(b)&&arcgisonline.map.thumbnail.buildThumbnailURLFromLayerOnMap(b,b.itemCard.extent?b.itemCard.extent.toString():
"").then(function(D){w(b,null,D)});w(b,v)}else if(b.layer&&"esri.layers.FeatureLayer"===b.layer.declaredClass){var y=parseInt(b.layer.url.substring(b.layer.url.lastIndexOf("/")+1)),C=null;if(b.origItemLayers)for(x=0;x<b.origItemLayers.length;x++){if(b.origItemLayers[x].id===y){C=b.origItemLayers[x];break}}else b.origItemLayers=[],arcgisonline.map.main.mapLayers.length?e.forEach(arcgisonline.map.main.mapLayers,function(D){if(D.itemId===b.itemId&&D.popupInfo){for(var K=parseInt(D.layer.url.substring(D.layer.url.lastIndexOf("/")+
1)),G={id:K,popupInfo:D.popupInfo},I=!1,R=0;R<b.origItemLayers.length;R++)b.origItemLayers[R].id===K&&(I=!0,D.id===b.id&&b.origItemLayers.splice(R,1,G));I||b.origItemLayers.push(G);D.id===b.id&&(C=G)}},this):e.forEach(arcgisonline.map.itemData.deletedFSItemSubLayers[b.itemId],function(D){D.id===y&&(C=D)}),arcgisonline.map.itemData.deletedFSItemSubLayers[b.itemId]&&(e.forEach(arcgisonline.map.itemData.deletedFSItemSubLayers[b.itemId],function(D){b.origItemLayers.push(D)}),b.origItemLayers=b.origItemLayers.sort(function(D,
K){if(h){var G=e.indexOf(h,D.id),I=e.indexOf(h,K.id);return G<I?-1:1}return D.id<K.id?-1:1}));C||(C={id:y},b.origItemLayers.push(C));b.popupInfo&&b.popupChanged&&!m?C.popupInfo=b.popupInfo:b.disablePopup&&delete C.popupInfo;b.legendChanged&&(!1===b.showLegend?C.showLegend=!1:delete C.showLegend);b.rendererChanged&&(b.layer.labelingInfo&&arcgisonline.map.labels.hasLayer(b.layer)?C.showLabels=!0:(x=!1,b.serviceInfo&&b.serviceInfo.drawingInfo&&(x=!!b.serviceInfo.drawingInfo.labelingInfo),x?C.showLabels=
!1:(delete C.showLabels,C.layerDefinition&&C.layerDefinition.drawingInfo&&delete C.layerDefinition.drawingInfo.labelingInfo)));b.refreshIntervalChanged&&esri.isDefined(b.layer.refreshInterval)&&(b.layer.refreshInterval?C.refreshInterval=b.layer.refreshInterval:delete C.refreshInterval);b.visibleLayersChanged&&esri.isDefined(b.visibleLayers)&&(C.visibleLayers=b.visibleLayers);b.timeChanged&&!b.layer.useMapTime?C.timeAnimation=!1:delete C.timeAnimation;b.defExpChanged&&(b.layerDefinition&&esri.isDefined(b.layerDefinition.definitionExpression)&&
(b.layerDefinition.definitionExpression.length?(C.layerDefinition=C.layerDefinition||{},C.layerDefinition.definitionExpression=b.layerDefinition.definitionExpression,b.definitionEditor&&(C.definitionEditor=b.definitionEditor)):(delete C.layerDefinition.definitionExpression,delete C.definitionEditor)),b.layerDefinition&&""==b.layerDefinition.definitionExpression&&delete b.layerDefinition.definitionExpression);b.opacityChanged&&(x=b.layer.opacity||0===b.layer.opacity?b.layer.opacity:1,1>x?(C.layerDefinition=
C.layerDefinition||{},C.layerDefinition.drawingInfo=C.layerDefinition.drawingInfo||{},C.layerDefinition.drawingInfo.transparency=100-100*x):C.layerDefinition&&C.layerDefinition.drawingInfo&&esri.isDefined(C.layerDefinition.drawingInfo.transparency)&&(delete C.layerDefinition.drawingInfo.transparency,arcgisonline.isEmpty(C.layerDefinition.drawingInfo)&&(delete C.layerDefinition.drawingInfo,arcgisonline.isEmpty(C.layerDefinition)&&delete C.layerDefinition)));C.layerDefinition=C.layerDefinition||{};
(C.layerDefinition.defaultVisibility=b.layer.visible)&&b.layerVisibleForVizTab&&isEmbedded&&isEmbedded.isItemDetail&&(C.layerDefinition.defaultVisibility=!1);!b.scaleChanged&&C.layerDefinition&&(delete C.layerDefinition.minScale,delete C.layerDefinition.maxScale);var z=function(D,K){var G={};G.layers=D.origItemLayers;D.thematicGroup&&(G.thematicGroup=D.thematicGroup);D.analysisInfo&&(G.analysisInfo=D.analysisInfo);delete u.layers;delete u.thematicGroup;delete u.analysisInfo;G=e.mixin(u,G);!(D.rendererChanged||
D.featureReductionChanged||D.scaleChanged||D.defExpChanged)||D.layer instanceof esri.layers.StreamLayer||arcgisonline.map.thumbnail.hasCustomThumbnail(D)||arcgisonline.map.thumbnail.recreateItemThumbnail(D);w(D,G)};arcgisonline.map.mapUtil.checkHostedFSAccess(b,e.hitch(this,function(D,K){(K.featureReductionChanged||K.rendererChanged)&&K.layer.getFeatureReduction&&K.layer.getFeatureReduction()?(D.layerDefinition=D.layerDefinition||{},D.layerDefinition.drawingInfo=D.layerDefinition.drawingInfo||{},
D.layerDefinition.drawingInfo.renderer=K.layer.renderer.toJson(),K.layer.labelingInfo&&K.showLabels?(D.layerDefinition.drawingInfo.labelingInfo=e.map(K.layer.labelingInfo,function(G){return G.toJson()}),D.showLabels=!0):(delete D.layerDefinition.drawingInfo.labelingInfo,D.showLabels=!1),D.layerDefinition.featureReduction=K.layer.getFeatureReduction(),D.layerDefinition.featureReduction.clusterRadius=q.gfx.px2pt(D.layerDefinition.featureReduction.clusterRadius),D.layerDefinition.featureReduction.infoTemplate&&
(D.layerDefinition.featureReduction.popupInfo=D.layerDefinition.featureReduction.infoTemplate.toJson(),delete D.layerDefinition.featureReduction.infoTemplate)):D.layerDefinition&&(delete D.layerDefinition.drawingInfo,delete D.layerDefinition.featureReduction,delete D.layerDefinition.minScale,delete D.layerDefinition.maxScale,K.layer.labelingInfo&&(arcgisonline.map.labels.hasLayer(K.layer)?D.showLabels=!0:D.showLabels=!1));arcgisonline.isEmpty(D.layerDefinition)&&delete D.layerDefinition;z(K,D)},C),
e.hitch(this,function(D,K){if(K.rendererChanged&&!p||K.featureReductionChanged)if(D.layerDefinition=D.layerDefinition||{},D.layerDefinition.drawingInfo||(D.layerDefinition.drawingInfo={}),D.layerDefinition.drawingInfo.renderer=K.layer.renderer.toJson(),K.layer.labelingInfo&&K.showLabels)D.layerDefinition.drawingInfo.labelingInfo=e.map(K.layer.labelingInfo,function(R){return R.toJson()}),D.showLabels=!0;else{delete D.layerDefinition.drawingInfo.labelingInfo;var G=!1;K.serviceInfo&&K.serviceInfo.drawingInfo&&
(G=!!K.serviceInfo.drawingInfo.labelingInfo);G?D.showLabels=!1:(delete D.showLabels,D.layerDefinition&&D.layerDefinition.drawingInfo&&delete D.layerDefinition.drawingInfo.labelingInfo)}K.featureReductionChanged&&(K.layer.getFeatureReduction()?(D.layerDefinition=D.layerDefinition||{},D.layerDefinition.featureReduction=K.layer.getFeatureReduction(),D.layerDefinition.featureReduction.clusterRadius=q.gfx.px2pt(D.layerDefinition.featureReduction.clusterRadius),D.layerDefinition.featureReduction.infoTemplate&&
(D.layerDefinition.featureReduction.popupInfo=D.layerDefinition.featureReduction.infoTemplate.toJson(),delete D.layerDefinition.featureReduction.infoTemplate)):delete D.layerDefinition.featureReduction);if(K.scaleChanged){G=K.layer.minScale?K.layer.minScale:0;var I=K.layer.maxScale?K.layer.maxScale:0;1===I&&(I=0);D.layerDefinition=D.layerDefinition||{};D.layerDefinition.minScale=G;D.layerDefinition.maxScale=I;0===G&&0===I&&(G=K.serviceInfo,G&&esri.isDefined(G.minScale)&&esri.isDefined(G.maxScale)&&
(0!==G.minScale||0!==G.maxScale)||!D.layerDefinition||(delete D.layerDefinition.minScale,delete D.layerDefinition.maxScale,arcgisonline.isEmpty(D.layerDefinition)&&delete D.layerDefinition))}z(K,D)},C))}else{if(b.layer&&"esri.layers.StreamLayer"===b.layer.declaredClass){v={};b.popupInfo&&(v.popupInfo=b.popupInfo);!1===b.showLegend&&(v.showLegend=!1);v.visibility=b.layer.visible;v.opacity=b.layer.opacity||0===b.layer.opacity?b.layer.opacity:1;if(b.rendererChanged||b.featureReductionChanged||b.scaleChanged||
b.defExpChanged||b.spatialFilterChanged||b.maximumTrackPointsChanged){v.layerDefinition=arcgisonline.map.itemData.itemDataContents[b.itemId].layerDefinition||{};b.layerDefinition&&esri.isDefined(b.layerDefinition.definitionExpression)&&b.layerDefinition.definitionExpression.length&&(v.layerDefinition.definitionExpression=b.layerDefinition.definitionExpression,b.definitionEditor&&(v.definitionEditor=b.definitionEditor));b.layerDefinition&&b.layerDefinition.definitionGeometry&&(v.layerDefinition.definitionGeometry=
b.layerDefinition.definitionGeometry);v.layerDefinition.drawingInfo=v.layerDefinition.drawingInfo||{};v.layerDefinition.drawingInfo.renderer=b.layer.renderer.toJson();b.layer.labelingInfo&&b.showLabels?(v.layerDefinition.drawingInfo.labelingInfo=e.map(b.layer.labelingInfo,function(D){return D.toJson()}),v.showLabels=!0):(delete v.layerDefinition.drawingInfo.labelingInfo,v.showLabels=!1);b.layer.getFeatureReduction&&b.layer.getFeatureReduction()?(v.layerDefinition.featureReduction=b.layer.getFeatureReduction(),
v.layerDefinition.featureReduction.clusterRadius=q.gfx.px2pt(v.layerDefinition.featureReduction.clusterRadius),v.layerDefinition.featureReduction.infoTemplate&&(v.layerDefinition.featureReduction.popupInfo=v.layerDefinition.featureReduction.infoTemplate.toJson(),delete v.layerDefinition.featureReduction.infoTemplate)):delete v.layerDefinition.featureReduction;b.layerDefinition&&esri.isDefined(b.layerDefinition.maximumTrackPoints)&&(v.layerDefinition.maximumTrackPoints=b.layerDefinition.maximumTrackPoints);
x=b.layer.minScale?b.layer.minScale:0;var F=b.layer.maxScale&&1!==b.layer.maxScale?b.layer.maxScale:0;0===x&&0===F&&b.serviceInfo&&!b.serviceInfo.minScale&&!b.serviceInfo.maxScale||b.serviceInfo&&b.serviceInfo.minScale===x&&b.serviceInfo.maxScale===F?(delete v.layerDefinition.minScale,delete v.layerDefinition.maxScale):(v.layerDefinition.minScale=x,v.layerDefinition.maxScale=1===F?0:F)}else v.layerDefinition=u.layerDefinition,v.definitionEditor=u.definitionEditor;delete u.popupInfo;delete u.showLegend;
delete u.layerDefinition;delete u.definitionEditor;v=e.mixin(u,v)}else if(b.layer&&"esri.layers.WFSLayer"===b.layer.declaredClass){v=arcgisonline.map.wfs.buildConfig(b,!0);if(b.layer.minScale||b.layer.maxScale)v.minScale=b.layer.minScale,v.maxScale=b.layer.maxScale;!1===b.showLegend&&(v.showLegend=!1);b.popupInfo&&(v.popupInfo=b.popupInfo);b.opacityChanged&&(x=b.layer.opacity||0===b.layer.opacity?b.layer.opacity:1,1>x&&(v.opacity=x));(b.rendererChanged&&!p||b.featureReductionChanged||b.scaleChanged)&&
!arcgisonline.map.thumbnail.hasCustomThumbnail(b)&&arcgisonline.map.thumbnail.buildThumbnailURLFromLayerOnMap(b,b.itemCard.extent?b.itemCard.extent.toString():"").then(function(D){D&&w(b,null,D)})}else{v={};if(u)v=u;else{t.hide("uploadItemLayerInfos");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingPropsFailed,{title:b.itemCard.title})});return}if(b.itemLayers&&
b.itemLayers.length){for(x=b.itemLayers.length-1;0<=x;x--)F=b.itemLayers[x],F.layerDefinition&&""==F.layerDefinition.definitionExpression&&(delete F.layerDefinition.definitionExpression,arcgisonline.isEmpty(F.layerDefinition)&&delete F.layerDefinition);if(b.itemLayers){var O=[];e.forEach(b.layer.layerInfos,function(D){O.push({id:D.id})});e.json.stringify(O)===e.json.stringify(b.itemLayers)&&(delete b.itemLayers,delete v.layers)}b.itemLayers&&(b.itemLayers.length?v.layers=e.map(e.clone(b.itemLayers),
function(D){delete D._layerInfo;return D}):(delete b.itemLayers,delete v.layers))}else!v.layers||"esri.layers.ArcGISDynamicMapServiceLayer"!==b.layer.declaredClass&&"esri.layers.ArcGISTiledMapServiceLayer"!==b.layer.declaredClass||delete v.layers;b.scaleChanged&&(0!==b.layer.minScale||0!==b.layer.maxScale?(v.minScale=b.layer.minScale?b.layer.minScale:0,v.maxScale=b.layer.maxScale&&1!==b.layer.maxScale?b.layer.maxScale:0):(delete v.minScale,delete v.maxScale));b.refreshIntervalChanged&&(b.layer.refreshInterval?
v.refreshInterval=b.layer.refreshInterval:delete v.refreshInterval);if(b.visibleLayersChanged&&esri.isDefined(b.visibleLayers)){F=x="";var V=b.layer.layerInfos;arcgisonline.map.main.hasDynamicLayers(b)&&(V=b.itemLayers);for(var N=0;N<V.length;N++)1!=V[N].defaultVisibility&&esri.isDefined(V[N].defaultVisibility)||(F+=x+(V[N].id||V[N].name),x=",");F==b.visibleLayers?delete v.visibleLayers:""===b.visibleLayers?v.visibleLayers=[]:b.layer instanceof esri.layers.WMSLayer?v.visibleLayers=b.visibleLayers.split(","):
(x=b.visibleLayers.split(","),v.visibleLayers=e.map(x,function(D){return parseInt(D)}))}b.timeChanged&&(0==b.layer.useMapTime?v.timeAnimation=!1:delete v.timeAnimation);b.layer instanceof esri.layers.WMSLayer&&b.popupChanged&&(v.layers=[],e.forEach(b.layer.layerInfos,function(D){var K={name:D.name,title:D.title};D.legendURL&&(K.legendURL=D.legendURL);D.queryable&&(K.queryable=!0,D.showPopup&&(K.showPopup=!0));v.layers.push(K)}));b.layer instanceof esri.layers.WMSLayer&&(b.layer.customParameters?v.customParameters=
b.layer.customParameters:delete v.customParameters,b.layer.customLayerParameters?v.customLayerParameters=b.layer.customLayerParameters:delete v.customLayerParameters);b.layer instanceof esri.layers.WebTiledLayer&&b.layer._wmtsInfo&&(v.wmtsInfo=v.wmtsInfo||{},b.layer._wmtsInfo.customParameters?v.wmtsInfo.customParameters=b.layer._wmtsInfo.customParameters:delete v.wmtsInfo.customParameters,b.layer._wmtsInfo.customLayerParameters?v.wmtsInfo.customLayerParameters=b.layer._wmtsInfo.customLayerParameters:
delete v.wmtsInfo.customLayerParameters);v.visibility=b.layer.visible;v.opacity=b.layer.opacity||0===b.layer.opacity?b.layer.opacity:1;if("esri.layers.RasterXLayer"===b.layer.declaredClass||"esri.layers.ArcGISImageServiceLayer"===b.layer.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===b.layer.declaredClass)b.renderingRuleChanged&&(b.layer.bandIds?v.bandIds=b.layer.bandIds:delete v.bandIds,b.layer.renderingRule?v.renderingRule=b.layer.renderingRule.toJson():delete v.renderingRule),v.layerType||
("esri.layers.RasterXLayer"===b.layer.declaredClass?v.layerType="ArcGISTiledImageServiceLayer":"esri.layers.ArcGISImageServiceLayer"===b.layer.declaredClass?v.layerType="ArcGISImageServiceLayer":"esri.layers.ArcGISImageServiceVectorLayer"===b.layer.declaredClass&&(v.layerType="ArcGISImageServiceVectorLayer")),b.mosaicRuleChanged&&(b.layer.mosaicRule?"esri.layers.RasterXLayer"===b.layer.declaredClass&&b.layer.mosaicRule.multidimensionalDefinition?(v.multidimensionalDefinition=b.layer.mosaicRule.multidimensionalDefinition.map(function(D){return D.toJson?
D.toJson():D}),delete v.mosaicRule):v.mosaicRule=b.layer.mosaicRule.toJson():delete v.mosaicRule),b.rendererChanged&&(b.layer.renderer?(v.layerDefinition=v.layerDefinition||{},v.layerDefinition.drawingInfo=v.layerDefinition.drawingInfo||{},v.layerDefinition.drawingInfo.renderer=b.layer.renderer.toJson()):v.layerDefinition&&v.layerDefinition.drawingInfo&&v.layerDefinition.drawingInfo.renderer&&delete v.layerDefinition.drawingInfo.renderer,"esri.layers.ArcGISImageServiceVectorLayer"===b.layer.declaredClass&&
b.layer.symbolTileSize&&(v.symbolTileSize=b.layer.symbolTileSize)),b.imageQualityChanged&&(b.layer.format?v.format=b.layer.format:delete v.format,b.layer.compressionQuality?v.compressionQuality=b.layer.compressionQuality:delete v.compressionQuality),b.popupInfo&&b.popupChanged?v.popupInfo=b.popupInfo:b.disablePopup&&delete v.popupInfo,b.defExpChanged&&(b.layerDefinition&&esri.isDefined(b.layerDefinition.definitionExpression)?(v.layerDefinition=v.layerDefinition||{},v.layerDefinition.definitionExpression=
b.layerDefinition.definitionExpression,esri.isDefined(b.definitionEditor)&&(v.definitionEditor=b.definitionEditor)):(v.layerDefinition&&v.layerDefinition.definitionExpression&&delete v.layerDefinition.definitionExpression,delete b.layerDefinition.definitionExpression,delete b.definitionEditor)),b.legendChanged&&(!1===b.showLegend?v.showLegend=!1:delete v.showLegend)}w(b,v)}}else{arcgisonline.map.itemData.deletedFSItemSubLayers[b.itemId]=[];var J=b.url.substring(0,b.url.lastIndexOf("/"));esri.request({url:J+
"?f\x3djson"}).then(function(D){var K=[];D.layers&&(e.forEach(D.layers,function(I){K[I.id]={}}),h=e.map(D.layers,function(I){return I.id}));e.forEach(arcgisonline.map.main.mapLayers,function(I){I.itemId===b.itemId&&(I=parseInt(I.layer.url.substring(I.layer.url.lastIndexOf("/")+1)),delete K[I])});if(arcgisonline.isEmpty(K))f();else{D=[];for(subId in K){var G=new e.Deferred;D.push(G);esri.request({url:J+"/"+subId+"?f\x3djson"}).then(e.hitch(this,function(I,R){arcgisonline.map.itemData.deletedFSItemSubLayers[b.itemId].push({id:R.id,
popupInfo:arcgisonline.map.popup.getDefaultPopupInfo(R)});I.callback()},G),e.hitch(this,function(I,R){I.callback()},G))}(new e.DeferredList(D)).addCallback(function(I){f()})}},function(D){f()})}},g=new Date,n="",m=arcgisonline.map.popup.hasFeatureSetMapExpression(b);b.popupInfo&&b.popupChanged&&m&&(n='\x3c/br\x3e\x3c/br\x3e\x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\x3cdiv class\x3d"alertIconMsg"\x3e\x3c/div\x3e\x3c/td\x3e\x3ctd valign\x3d"top"\x3e'+esri.i18nBundle.viewer.error.cantSaveItem_PopupArcadeMap+
"\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e");var t=arcgisonline.sharing.dijit.dialog.WaitingDlg.prototype.statics.getInstance();t.show({title:esri.i18nBundle.common.save,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingProps,{title:b.itemCard.title})+n,reference:"uploadItemLayerInfos"});arcgisonline.map.itemData.getItemLayerInfos(b,e.hitch(this,f),e.hitch(this,f));return a}arcgisonline.map.main.requireAuthentication()},editFS:function(b,l){var p=new e.Deferred;if(arcgisonline.sharing.util.isLoggedIn()){var r=
[];r.push(arcgisonline.map.itemData._editFSItem(b,l));r.push(arcgisonline.map.itemData._editFSService(b,l));r=new e.DeferredList(r);r.addCallback(function(a){p.callback()});r.addErrback(function(a){p.errback()});return p}arcgisonline.map.main.requireAuthentication()},_editFSItem:function(b,l){var p=new e.Deferred,r=function(a,c,d){if(a.layers&&0!==a.layers.length){var h=parseInt(c.url.substring(c.url.lastIndexOf("/")+1)),f=!1;e.forEach(a.layers,function(g){if(g.id===h){var n=!1;l.addField&&g.popupInfo?
n=!0:l.deleteField&&g.popupInfo&&(n=!0);n?(arcgisonline.map.itemData.itemDataContents[c.itemCard.id]=a,g={text:e.json.stringify(a)},n=esriGeowConfig.restBaseUrl+"content/users/"+c.itemCard.owner,n+=c.itemCard.ownerFolder?"/"+c.itemCard.ownerFolder:"",n+="/items/"+c.itemCard.id+"/update",arcgisonline.sharing.util.postJson(g,n).then(function(m){d.callback()},function(m){d.errback()})):d.callback();f=!0}});f||d.callback()}else d.callback()};arcgisonline.map.itemData.itemDataContents[b.itemCard.id]?r(arcgisonline.map.itemData.itemDataContents[b.itemCard.id],
b,p):arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"content/items/"+b.itemCard.id+"/data"}).then(function(a){a=a||{};a.layers&&0==a.layers.length&&delete a.layers;arcgisonline.map.itemData.itemDataContents[b.itemCard.id]=a;r(a,b,p)},function(a){arcgisonline.map.itemData.itemDataContents[b.itemCard.itemId]=a;p.errback()});return p},_editFSService:function(b,l){var p=new e.Deferred,r=function(a,c,d){c.serviceInfo=a;var h={};h.typeIdField=a.typeIdField;h.types=a.types;h.templates=
a.templates;var f={f:"json",updateDefinition:e.json.stringify(h)},g=c.url.replace("/rest/services","/rest/admin/services")+"/updateDefinition";arcgisonline.map.itemData.getServerToken(c).then(e.hitch(this,function(n){f.token=n;arcgisonline.sharing.util.postJson(f,g).then(function(m){arcgisonline.map.main.ignoreCache(c);d.callback()},function(m){d.errback()})}),function(){d.errback()})};b.serviceInfo?r(b.serviceInfo,b,p):arcgisonline.sharing.util.request({url:b.url}).then(function(a,c){b.serviceInfo=
a;r(a,b,p)},function(a){p.errback()});return p},updateFeatureService:function(b,l,p){b.layer.renderer.toJson();var r=[];b.layer.types&&e.forEach(b.layer.types,function(m){r.push(m.toJson())});var a=null;b.layer.labelingInfo&&b.showLabels&&(a=e.map(b.layer.labelingInfo,function(m){return m.toJson()}));var c={};if(b.rendererChanged||b.featureTemplatesChanged||b.opacityChanged)c.drawingInfo={renderer:b.layer.renderer.toJson()},a&&(c.drawingInfo.labelingInfo=a),c.typeIdField=b.layer.typeIdField,c.types=
r,c.templates=b.layer.templates,c.drawingInfo.transparency=100-100*b.layer.opacity;b.scaleChanged&&(a=b.layer.maxScale?b.layer.maxScale:0,c.minScale=b.layer.minScale?b.layer.minScale:0,c.maxScale=1===a?0:a);if(!(b.itemCard&&b.itemCard.typeKeywords&&-1<e.indexOf(b.itemCard.typeKeywords,"View Service"))&&b.popupInfo&&!0===b.serviceInfo.sourceSchemaChangesAllowed){var d=[];e.forEach(b.popupInfo.fieldInfos,function(m){e.forEach(b.layer.fields,function(t){m.fieldName===t.name&&m.label!==t.alias&&d.push({name:m.fieldName,
alias:m.label})})});d.length&&(c.fields=d)}var h={f:"json",updateDefinition:e.json.stringify(c)},f=b.layer.url.replace("/rest/services","/rest/admin/services")+"/updateDefinition",g=!1;a="";b.popupInfo&&b.popupChanged&&(g=arcgisonline.map.popup.hasFeatureSetMapExpression(b))&&(a='\x3c/br\x3e\x3c/br\x3e\x3ctable\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd valign\x3d"top"\x3e\x3cdiv class\x3d"alertIconMsg"\x3e\x3c/div\x3e\x3c/td\x3e\x3ctd valign\x3d"top"\x3e'+esri.i18nBundle.viewer.error.cantSaveItem_PopupArcadeMap+
"\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e");var n=arcgisonline.sharing.dijit.dialog.WaitingDlg.prototype.statics.getInstance();n.show({title:esri.i18nBundle.common.save,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingProps,{title:b.itemCard.title})+a,reference:"updateFeatureService"});arcgisonline.map.itemData.getServerToken(b).then(e.hitch(this,function(m){h.token=m;esri.request({url:f,content:h,callbackParamName:"callback",load:e.hitch(this,function(t){setTimeout(e.hitch(this,
function(){n.hide("updateFeatureService")}),1);if(t.success){if(b.rendererChanged||b.featureTemplatesChanged||b.opacityChanged)b.serviceInfo.drawingInfo=c.drawingInfo,b.serviceInfo.typeIdField=c.typeIdField||b.serviceInfo.typeIdField,b.serviceInfo.types=c.types||b.serviceInfo.types,b.serviceInfo.templates=c.templates||b.serviceInfo.templates;arcgisonline.map.main.ignoreCache(b);delete b.featureTemplatesChanged;delete b.opacityChanged;b.layerDefinition&&(delete b.layerDefinition.drawingInfo,delete b.layerDefinition.minScale,
delete b.layerDefinition.maxScale,arcgisonline.isEmpty(b.layerDefinition)&&delete b.layerDefinition,b.layerDefinition&&b.layerDefinition.featureReduction||delete b.rendererChanged);delete b.scaleChanged;arcgisonline.map.main.mapLayers.length&&arcgisonline.map.thumbnail.recreateItemThumbnail(b);arcgisonline.map.itemData.getItemLayerInfos(b,e.hitch(this,function(){var w=null;if(b.origItemLayers)for(var u=parseInt(b.layer.url.substring(b.layer.url.lastIndexOf("/")+1)),v=0;v<b.origItemLayers.length;v++)if(b.origItemLayers[v].id===
u){w=b.origItemLayers[v];break}u=!1;b.itemCard&&"Feature Service"===b.itemCard.type&&(arcgisonline.sharing.util.isHostedService(b.url)||-1<e.indexOf(b.itemCard.typeKeywords,"providerSDS"))&&-1<e.indexOf(b.itemCard.typeKeywords,"webmap_2.1")&&(u=!0);u||w&&w.layerDefinition||b.popupChanged&&!g||b.legendChanged||b.featureReductionChanged||b.layer.labelingInfo&&b.showLabels&&(!w||!w.showLabels)||(!b.layer.labelingInfo||!b.showLabels)&&w&&w.showLabels?arcgisonline.map.itemData.uploadItemLayerInfos(b,e.hitch(this,
function(){l&&l()}),null,p):l&&l()}),e.hitch(this,function(){l&&l()}))}}),error:function(t){n.hide("updateFeatureService");p?p():arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:t.message?"("+t.message+")":""})})}},{usePost:!0,addToken:!0})}),function(m){n.hide("updateFeatureService");p?p():arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,
message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:m&&m.message?"("+m.message+")":""})})})},updateFeatureServiceAfterAddRemoveField:function(b,l,p){var r={};r.types=b.serviceInfo.types;r.templates=b.serviceInfo.templates;if(b.popupInfo){var a=[];e.forEach(b.popupInfo.fieldInfos,function(f){e.forEach(b.layer.fields,function(g){f.fieldName===g.name&&f.label!==g.alias&&a.push({name:f.fieldName,alias:f.label})})});a.length&&(r.fields=a)}var c={f:"json",updateDefinition:e.json.stringify(r)},
d=b.layer.url.replace("/rest/services","/rest/admin/services")+"/updateDefinition",h=arcgisonline.sharing.dijit.dialog.WaitingDlg.prototype.statics.getInstance();h.show({title:esri.i18nBundle.common.save,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingProps,{title:b.itemCard.title}),reference:"updateFeatureService"});arcgisonline.map.itemData.getServerToken(b).then(e.hitch(this,function(f){c.token=f;esri.request({url:d,content:c,callbackParamName:"callback",load:e.hitch(this,function(g){setTimeout(e.hitch(this,
function(){h.hide("updateFeatureService")}),1);g.success&&(arcgisonline.map.main.ignoreCache(b),arcgisonline.map.itemData.getItemLayerInfos(b,e.hitch(this,function(){if(b.origItemLayers)for(var n=parseInt(b.layer.url.substring(b.layer.url.lastIndexOf("/")+1)),m=0;m<b.origItemLayers.length&&b.origItemLayers[m].id!==n;m++);n=!1;b.itemCard&&"Feature Service"===b.itemCard.type&&(arcgisonline.sharing.util.isHostedService(b.url)||-1<e.indexOf(b.itemCard.typeKeywords,"providerSDS"))&&-1<e.indexOf(b.itemCard.typeKeywords,
"webmap_2.1")&&(n=!0);n||b.popupChanged?arcgisonline.map.itemData.uploadItemLayerInfos(b,e.hitch(this,function(){l&&l()}),null,p):l&&l()}),e.hitch(this,function(){l&&l()})))}),error:function(g){h.hide("updateFeatureService");p?p():arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:g.message?"("+g.message+")":""})})}},{usePost:!0,addToken:!0})}),
function(f){h.hide("updateFeatureService");p?p():arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:f.message?"("+f.message+")":""})})})},updateServiceDefinitionWithFilter:function(b,l){var p={};b.serviceInfo.isView?p.viewDefinitionQuery=l:p.definitionQuery=l;var r={f:"json",updateDefinition:e.json.stringify(p)},a=b.layer.url.replace("/rest/services",
"/rest/admin/services")+"/updateDefinition",c=arcgisonline.sharing.dijit.dialog.WaitingDlg.prototype.statics.getInstance();c.show({title:esri.i18nBundle.common.save,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingProps,{title:b.itemCard.title}),reference:"updateFeatureService"});arcgisonline.map.itemData.getServerToken(b).then(e.hitch(this,function(d){r.token=d;esri.request({url:a,content:r,callbackParamName:"callback",load:e.hitch(this,function(h){setTimeout(e.hitch(this,function(){c.hide("updateFeatureService")}),
1);h.success&&(arcgisonline.map.main.ignoreCache(b),b.serviceInfo.isView?b.serviceInfo.viewDefinitionQuery=l:b.serviceInfo.definitionQuery=l,b.layer.defaultDefinitionExpression=l,b.layer.clearSelection(),b.layer.refresh(),b.layer.statisticsPlugin&&b.layer.statisticsPlugin.clearFeaturesCache(),arcgisonline.map.thumbnail.recreateItemThumbnail(b))}),error:function(h){c.hide("updateFeatureService");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,
message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:h.message?"("+h.message+")":""})})}},{usePost:!0,addToken:!0})}),function(d){c.hide("updateFeatureService");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:d.message?"("+d.message+")":""})})})},updateServiceFields:function(b,l,p){var r=[],a=
[];e.forEach(l,function(n){r.push({name:n.name,visible:!1===n.visible?!1:!0});!1!==n.visible&&a.push(n)});var c={fields:r};if(p){var d=b.url.substring(b.url.lastIndexOf("/")+1);-1<d.indexOf("?")&&(d=d.substring(0,d.indexOf("?")));d=parseInt(d);c.layers=[{adminLayerInfo:{viewLayerDefinition:{sourceServiceName:b.serviceInfo.name,sourceLayerId:d,sourceLayerFields:"*"}}}]}var h={f:"json",updateDefinition:e.json.stringify(c)},f=b.layer.url.replace("/rest/services","/rest/admin/services")+"/updateDefinition",
g=arcgisonline.sharing.dijit.dialog.WaitingDlg.prototype.statics.getInstance();g.show({title:esri.i18nBundle.common.save,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingProps,{title:b.itemCard.title}),reference:"updateFeatureService"});arcgisonline.map.itemData.getServerToken(b).then(e.hitch(this,function(n){h.token=n;esri.request({url:f,content:h,callbackParamName:"callback",load:e.hitch(this,function(m){setTimeout(e.hitch(this,function(){g.hide("updateFeatureService")}),1);if(m.success){arcgisonline.map.main.ignoreCache(b);
m=b.layer.fields=[];for(i=0;i<a.length;i++)m.push(new esri.layers.Field(a[i]));b.serviceInfo.fields=a;b.serviceInfo.adminFields=l;b.layer.clearSelection();b.layer.refresh();b.layer.statisticsPlugin&&b.layer.statisticsPlugin.clearFeaturesCache();arcgisonline.map.itemData.updatePopupAfterFieldDefinitionChange(b);p&&(delete b.serviceInfo.adminFields,arcgisonline.map.main.openFieldsDlg(b))}}),error:function(m){g.hide("updateFeatureService");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,
message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:m.message?"("+m.message+")":""})})}},{usePost:!0,addToken:!0})}),function(n){g.hide("updateFeatureService");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:n.message?"("+n.message+")":""})})})},updateServiceAreaOfInterest:function(b,l,p,r){var a=
new e.Deferred;l?(l="polygon"===l.type?{geometryType:"esriGeometryPolygon",geometry:l.toJson()}:{geometryType:"esriGeometryEnvelope",geometry:l.toJson()},l={viewLayerDefinition:{filter:{operator:"esriSpatialRelIntersects",value:l}}}):l={viewLayerDefinition:{filter:null}};var c={f:"json",updateDefinition:e.json.stringify(l)},d=b.layer.url.replace("/rest/services","/rest/admin/services")+"/updateDefinition",h=arcgisonline.sharing.dijit.dialog.WaitingDlg.prototype.statics.getInstance();h.show({title:esri.i18nBundle.common.save,
message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingProps,{title:b.itemCard.title}),reference:"updateFeatureService"});arcgisonline.map.itemData.getServerToken(b).then(e.hitch(this,function(f){c.token=f;esri.request({url:d,content:c,callbackParamName:"callback",load:e.hitch(this,function(g){if(g.success)if(arcgisonline.map.main.ignoreCache(b),p&&r){var n=d.indexOf("/updateDefinition"),m=d.substring(0,n).lastIndexOf("/"),t=parseInt(d.substring(m+1,n));if(arcgisonline.sharing.util.isPortal()){var w=
function(v,x,y,C){var z=r.layers[v];z.id!==C?(n=x.indexOf("/updateDefinition"),x=x.substring(0,m+1)+z.id+x.substring(n),esri.request({url:x,content:y,callbackParamName:"callback",load:e.hitch(this,function(F){v<r.layers.length-1?w(v+1,x,y,C):(setTimeout(e.hitch(this,function(){h.hide("updateFeatureService")}),1),a.resolve())}),error:e.hitch(this,function(F){v<r.layers.length-1?w(v+1,x,y,C):(setTimeout(e.hitch(this,function(){h.hide("updateFeatureService")}),1),a.resolve())})},{usePost:!0})):v<r.layers.length-
1?w(v+1,x,y,C):(setTimeout(e.hitch(this,function(){h.hide("updateFeatureService")}),1),a.resolve())};w(0,d,c,t)}else{var u=[];e.forEach(r.layers,function(v){v.id!==t&&(n=d.indexOf("/updateDefinition"),d=d.substring(0,m+1)+v.id+d.substring(n),u.push(esri.request({url:d,content:c,callbackParamName:"callback"},{usePost:!0})))});u.length?(new e.DeferredList(u)).addCallback(function(v){setTimeout(e.hitch(this,function(){h.hide("updateFeatureService")}),1);a.resolve()}):(setTimeout(e.hitch(this,function(){h.hide("updateFeatureService")}),
1),a.resolve())}}else setTimeout(e.hitch(this,function(){h.hide("updateFeatureService")}),1),a.resolve();else setTimeout(e.hitch(this,function(){h.hide("updateFeatureService")}),1),a.reject()}),error:function(g){h.hide("updateFeatureService");a.reject();arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:g.message?"("+g.message+")":
""})})}},{usePost:!0,addToken:!0})}),function(f){h.hide("updateFeatureService");a.reject();arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:f.message?"("+f.message+")":""})})});return a},updatePopupAfterFieldDefinitionChange:function(b){if(b.popupInfo&&b.popupInfo.fieldInfos){var l=b.popupInfo.fieldInfos,p=[],r=arcgisonline.map.popup.getDefaultPopupInfo(b.serviceInfo,
b.layer.isEditable(),b.layer);e.forEach(r.fieldInfos,function(a){var c;e.forEach(l,function(d){d.fieldName===a.fieldName&&(c=d)});c?p.push(c):p.push(a)});e.forEach(l,function(a){(a.fieldName.startsWith("relationships/")||a.fieldName.startsWith("expression/")||a.fieldName.startsWith("Raster."))&&p.push(a)});e.json.stringify(b.popupInfo.fieldInfos)!==e.json.stringify(p)&&(b.popupInfo.fieldInfos=p,arcgisonline.map.mapUtil.setInfoTemplate(b.layer,b.popupInfo),b.popupChanged=!0,b.origItemLayers&&(r=function(){for(var a=
arcgisonline.map.itemData.itemDataContents[b.itemId]||{},c=parseInt(b.layer.url.substring(b.layer.url.lastIndexOf("/")+1)),d=null,h=0;h<b.origItemLayers.length;h++)if(b.origItemLayers[h].id===c){d=b.origItemLayers[h];break}d&&(d.popupInfo=b.popupInfo,c={layers:b.origItemLayers},delete a.layers,c=e.mixin(a,c),a={text:e.json.stringify(c)},arcgisonline.sharing.util.getUser(),c=esriGeowConfig.restBaseUrl+"content/users/"+b.itemCard.owner,c+=b.itemCard.ownerFolder?"/"+b.itemCard.ownerFolder:"",c+="/items/"+
b.itemCard.id+"/update",arcgisonline.sharing.util.postJson(a,c,e.hitch(this,function(){delete b.popupChanged})))},arcgisonline.map.itemData.getItemLayerInfos(b,e.hitch(this,r),e.hitch(this,r))))}},getRelatedTSForFS:function(b){var l=new e.Deferred;if(!b.itemId)return l.errback(),l;if(b.relatedTileLayerItems)return l.callback(b.relatedTileLayerItems.length?b.relatedTileLayerItems:null),l;if(!b.itemCard)if(arcgisonline.map.save_open.itemCards[b.itemId])b.itemCard=arcgisonline.map.save_open.itemCards[b.itemId];
else return arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+"content/items/"+b.itemId,e.hitch(this,function(r,a){arcgisonline.map.save_open.itemCards[a.id]=a;r.itemCard=a;l=arcgisonline.map.itemData.getRelatedTSForFS(r)},b),function(){l.errback()}),l;var p;-1<e.indexOf(b.itemCard.typeKeywords,"View Service")?p=esriGeowConfig.restBaseUrl+"content/items/"+b.itemId+"/relatedItems?relationshipType\x3dService2Service\x26direction\x3dforward":-1<e.indexOf(b.itemCard.typeKeywords,"Hosted Service")&&
(p=esriGeowConfig.restBaseUrl+"content/items/"+b.itemId+"/relatedItems?relationshipType\x3dService2Data\x26direction\x3dreverse");arcgisonline.sharing.util.getJson(p,e.hitch(this,function(r){if(r&&r.total){var a=null;e.forEach(r.relatedItems,function(c){"Map Service"===c.type&&(a=a||[],a.push(c))});b.relatedTileLayerItems=a||[];l.callback(a)}else b.relatedTileLayerItems=[],l.callback(null)}),e.hitch(this,function(){l.errback()}));return l},renameTiledSublayer:function(b,l,p){var r={f:"json",layerDefinition:e.toJson({name:p})},
a=b.layer.url.replace("/rest/services","/rest/admin/services")+"/"+l+"/edit",c=arcgisonline.sharing.dijit.dialog.WaitingDlg.prototype.statics.getInstance();c.show({title:esri.i18nBundle.common.save,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.savingProps,{title:b.itemCard.title}),reference:"renameTiledSublayer"});arcgisonline.map.itemData.getServerToken(b).then(e.hitch(this,function(d){r.token=d;esri.request({url:a,content:r,callbackParamName:"callback",load:e.hitch(this,function(h){setTimeout(e.hitch(this,
function(){c.hide("renameTiledSublayer")}),1);h.success&&(b.layer.layerInfos[l].name=p,e.publish("onLayerUpdate",["reopen"]),leftPanel&&leftPanel.deleteLegendStack())}),error:function(h){c.hide("renameTiledSublayer");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:h.message?"("+h.message+")":""})})}},{usePost:!0,addToken:!0})}),
function(d){c.hide("renameTiledSublayer");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.mapUtil.errror.couldNotSaveEdits,{msg:d.message?"("+d.message+")":""})})})},getServerToken:function(b,l){var p=l||b.url,r=p.toLowerCase().indexOf("/featureserver");-1<r&&(p=p.substring(0,r+14));var a=new e.Deferred;if(p)if(b&&b.serverToken)a.resolve(b.serverToken);else if(arcgisonline.map.main.serverTokens=
arcgisonline.map.main.serverTokens||[],arcgisonline.map.main.serverTokens[p]){var c=function(d){var h=arcgisonline.map.main.serverTokens[p];"failed"===h?d.reject():"inProgress"===h?setTimeout(e.hitch(this,function(){c(d)}),1E3):(b&&(b.serverToken=h.token),d.resolve(h.token))};c(a)}else arcgisonline.map.main.serverTokens[p]="inProgress",esri.request({url:esriGeowConfig.restBaseUrl.replace("http:","https:")+"generateToken",content:{f:"json",serverUrl:p,token:arcgisonline.sharing.util.getToken()}},{usePost:!0}).then(e.hitch(this,
function(d){arcgisonline.map.main.serverTokens[p]=d;b&&(b.serverToken=d.token);a.resolve(d.token)}),e.hitch(this,function(){arcgisonline.map.main.serverTokens[p]="failed";a.reject()}));else a.reject();return a},createDefaultOrigItemLayers:function(b){var l=new e.Deferred;if(b.layer&&b.layer.url&&"esri.layers.FeatureLayer"===b.layer.declaredClass&&!b.origItemLayers&&b.itemId){var p=b.layer.url.substring(0,b.layer.url.lastIndexOf("/"))+"/layers";esri.request({url:p,content:{f:"json"},callbackParamName:"callback",
load:function(r){b.origItemLayers=[];e.forEach(r.layers,function(a){b.origItemLayers.push({id:a.id,popupInfo:arcgisonline.map.popup.getDefaultPopupInfo(a)})});l.resolve()},error:function(){l.resolve()}})}else l.resolve();return l}}})},"arcgisonline/map/main":function(){define(["dojo","dijit","dojox"],function(e,U,q){function b(a,c,d){if(a.removeEventListener)return a.removeEventListener(c,d,!1);if(a.detachEvent)return a.detachEvent("on"+c,d)}function l(a,c){for(var d=c.parentNode;null!=d;){if(d==
a)return!0;d=d.parentNode}return!1}e.provide("arcgisonline.map.main");String.prototype.startsWith=function(a){return 0==this.indexOf(a)};String.prototype.endsWith=function(a){return this.substring(this.length-a.length)===a};String.prototype.count=function(a){return this.split(a).length-1};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")});arcgisonline.isEmpty=function(a){return a?e.json.stringify(a)===e.json.stringify({}):!1};var p=function(a){a.preventDefault();
var c=e.hasClass(this,"is-active");e.query(".dropdown").removeClass("is-active");if(!c){e.addClass(this,"is-active");e.stopEvent(a);a={btn:a.target||a.srcElement,dropdown:this};arcgisonline.map.main.dropdownHandlers&&e.forEach(arcgisonline.map.main.dropdownHandlers,function(h){e.disconnect(h);h=null});arcgisonline.map.main.dropdownHandlers=[];arcgisonline.map.main.dropdownHandlers.push(e.connect(document.body,"click",e.hitch(a,r)));c="click";e.has("esri-touch")&&!e.has("ff")&&(c="touchstart",arcgisonline.map.main.map&&
arcgisonline.map.main.dropdownHandlers.push(e.connect(arcgisonline.map.main.map.container,c,e.hitch(a,r))));var d=e.query(".esriSimpleSliderIncrementButton");d&&d.length&&arcgisonline.map.main.dropdownHandlers.push(e.connect(d[0],c,e.hitch(a,r)));(d=e.query(".esriSimpleSliderDecrementButton"))&&d.length&&arcgisonline.map.main.dropdownHandlers.push(e.connect(d[0],c,e.hitch(a,r)))}},r=function(a){var c=e.query(".dropdown-menu",this.dropdown)[0];l(c,a.target||a.srcElement)||(e.removeClass(this.dropdown,
"is-active"),b(document.body,"click",r),(a=e.query(".esriSimpleSliderIncrementButton"))&&a.length&&b(a[0],"click",r),(a=e.query(".esriSimpleSliderDecrementButton"))&&a.length&&b(a[0],"click",r),arcgisonline.map.main.dropdownHandlers&&e.forEach(arcgisonline.map.main.dropdownHandlers,function(d){e.disconnect(d);d=null}),arcgisonline.map.main.dropdownHandlers=[])};arcgisonline.map.main={defaultBaseLayer:null,defaultBaseLayerMapLods:null,scaleBarUnits:"metric",mapLods:null,baseTilingSchemeScales:"",selfCallResult:null,
map:null,overviewMap:null,scalebar:null,measureTool:null,measureActivated:!1,bookmarksTool:null,homeButton:null,locateButton:null,defaultExtent:null,initialExtent:null,lastExtent:null,defaultService:null,currentBaseService:"",isUserBaseService:!1,allLegendInfos:[],basemapTitle:"",queryLimitExceededLayers:[],mapLayers:[],mapTables:[],geometryService:null,mapInitialized:!1,startup:!0,isMapFullyLoaded:!1,mapHasChanged:!1,mapFullyLoadedTimer:null,noDataDisplayTimer:null,analysisProps:{},esriIdCredential:null,
init:function(a){arcgisonline.map.embedded.doEmbeddedCheck(a).then(function(c){if(c){if(!esri.isTouchEnabled&&(e.has("edge")||4<e.has("trident")))var d=e.connect(document,"touchstart",function(){esri.isTouchEnabled||(esri.isTouchEnabled=!0,e.disconnect(d),e.disconnect(h),e.disconnect(f),"contentStack"===arcgisonline.map.leftPanel.getLeftContentPanelStack()&&e.publish("onLayerUpdate",[""]))}),h=document.addEventListener("MSPointerDown",function(n){"touch"!==n.pointerType||esri.isTouchEnabled||(esri.isTouchEnabled=
!0,e.disconnect(d),e.disconnect(h),e.disconnect(f),"contentStack"===arcgisonline.map.leftPanel.getLeftContentPanelStack()&&e.publish("onLayerUpdate",[""]))}),f=document.addEventListener("pointerdown",function(n){"touch"!==n.pointerType||esri.isTouchEnabled||(esri.isTouchEnabled=!0,e.disconnect(d),e.disconnect(h),e.disconnect(f),"contentStack"===arcgisonline.map.leftPanel.getLeftContentPanelStack()&&e.publish("onLayerUpdate",[""]))});esri.arcgis.utils.arcgisUrl=esriGeowConfig.restBaseUrl+"content/items";
arcgisonline.sharing.geow.Account.loadMapSettings(e.hitch(this,arcgisonline.map.main.initMapProperties));e.query("#home-navigation-dropdown-link").onclick(e.hitch(e.byId("home-navigation-dropdown"),p));e.query("#webmap-recentMaps").onclick(e.hitch(e.byId("recentMaps-navigation"),p));e.query("#logged-in-navigation-link").onclick(e.hitch(e.byId("logged-in-navigation"),p));9>e.isIE&&e.style(e.byId("locationDiv"),"right","8px");e.byId("headerBanner")&&(c=e.coords(e.byId("headerBanner")),0<c.h&&e.style(e.query(".header-map-home")[0],
"marginTop",c.h+"px"));arcgisonline.map.table.hideAttributeTable();e.connect(U.byId("leftContentPanel"),"resize",arcgisonline.map.leftPanel,"checkLeftPanelButtonLabels");arcgisonline.map.main.dojoPatch();9>e.isIE&&e.style(e.byId("locationDiv"),"right","8px");if(navigator.userAgent.match(/iPad;.*CPU.*OS 7_\d/i)&&window.innerHeight!=document.documentElement.clientHeight){var g=function(){e.style(document.getElementById("page-border"),"height",window.innerHeight+"px");U.byId("page-border").resize();
0===document.body.scrollTop&&0===document.body.scrollLeft||window.scrollTo(0,0)};setTimeout(function(){g()},1);window.addEventListener("orientationchange",g,!1)}e.subscribe("onUTCOffsetChange",e.hitch(arcgisonline.map.main,"onUTCOffsetChange"))}})},initMapProperties:function(a){arcgisonline.map.main.selfCallResult=a;esriGeowConfig.userInfo=a.user;esriGeowConfig.userInfo&&(esriGeowConfig.userInfo.credential=arcgisonline.map.main.esriIdCredential,esriGeowConfig.userInfo.token=arcgisonline.map.main.esriIdCredential.token);
arcgisonline.map.vectorTile.checkFallBackVectorTileLayers().then(function(c){c=c.baseMap;var d=c.baseMapLayers[0];(esriGeowConfig.allSSL||"https:"==location.protocol)&&d.url&&(arcgisonline.sharing.util.isHostedService(d.url)||arcgisonline.sharing.util.supportsHttps(d.url))&&(d.url=d.url.replace("http:","https:"),d.resourceInfo&&d.resourceInfo.tileServers&&d.resourceInfo.tileServers.length&&e.forEach(d.resourceInfo.tileServers,function(m,t){if(arcgisonline.sharing.util.isHostedService(m)||arcgisonline.sharing.util.supportsHttps(m))d.resourceInfo.tileServers[t]=
m.replace("http:","https:")}));arcgisonline.map.main.basemapTitle=c.title;arcgisonline.map.main.defaultBaseLayer={layer:null,layers:d.layers,id:d.id||"defaultBasemap",type:"base",title:d.title||arcgisonline.map.main.getSpecialTitle(d)||c.title,itemId:d.itemId,url:d.url?d.url:null,templateUrl:d.templateUrl?d.templateUrl:null,styleUrl:d.styleUrl,identify:!1,serviceInfo:d.resourceInfo,copyright:d.copyright,fullExtent:d.fullExtent instanceof esri.geometry.Extent?d.fullExtent:d.fullExtent?esri.geometry.Extent(d.fullExtent):
null,subDomains:d.subDomains,tileInfo:d.tileInfo?esri.layers.TileInfo(d.tileInfo):null,tileServers:d.tileServers,wmtsInfo:d.wmtsInfo,refreshInterval:d.refreshInterval};arcgisonline.map.main.defaultBaseLayer.url||(arcgisonline.map.main.defaultBaseLayer._layerType=c.baseMapLayers[0].type||c.baseMapLayers[0].layerType);if(d.resourceInfo&&d.resourceInfo.tileInfo)arcgisonline.map.main.defaultBaseLayerMapLods=d.resourceInfo.tileInfo.lods;else if("WMS"==d.type||"WMS"==d.layerType)arcgisonline.map.main.defaultBaseLayer=
e.mixin(arcgisonline.map.main.defaultBaseLayer,{_layerType:"WMS",extent:esri.geometry.Extent(d.extent),layers:d.layers,mapUrl:d.mapUrl,maxHeight:d.maxHeight,maxWidth:d.maxWidth,opacity:d.opacity,spatialReferences:d.spatialReferences,version:d.version,visibility:d.visibility,visibleLayers:d.visibleLayers.toString()});else if("OpenStreetMap"==d.type||"OpenStreetMap"==d.layerType)c=new esri.layers.OpenStreetMapLayer,arcgisonline.map.main.defaultBaseLayerMapLods=c.tileInfo.lods;else if(d.type&&-1<d.type.indexOf("BingMaps")||
d.layerType&&-1<d.layerType.indexOf("BingMaps")){if(!esriGeowConfig.self.bingKey){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.error.basemapTitleNotAvailable2,{title:c.title})});return}arcgisonline.map.main.defaultBaseLayer.bingKey=esriGeowConfig.self.bingKey;c=new esri.virtualearth.VETiledLayer({bingMapsKey:esriGeowConfig.self.bingKey,mapStyle:esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL});
arcgisonline.map.main.defaultBaseLayerMapLods=c.tileInfo.lods}e.connect(document,"onkeypress",e.hitch(arcgisonline.map.main,"onKeyPress"));c=arcgisonline.map.main.buildNewMapViewerUrl();e.byId("webmap-openNewViewer").href=c;e.connect(e.byId("webmap-openNewViewer"),"onclick",e.hitch(arcgisonline.map.main,"openNewMapViewer"));e.connect(e.byId("webmap-newMap"),"onclick",e.hitch(arcgisonline.map.main,"openNewMap"));e.connect(e.byId("webmap-modifyMap"),"onclick",e.hitch(arcgisonline.map.role,"updateUserActionAfterModify"));
e.connect(e.byId("webmap-details"),"onclick",e.hitch(arcgisonline.map.leftPanel,"openLeftDetailsPanel"));e.connect(e.byId("webmap-basemap"),"onclick",e.hitch(arcgisonline.map.main,"showBasemapGallery"));arcgisonline.map.main.isReadOnlyMode()||e.connect(e.byId("webmap-edit"),"onclick",e.hitch(arcgisonline.map.leftPanel,"openLeftEditPanel"));esriGeowConfig.showAnalysisHistory&&!arcgisonline.map.main.isReadOnlyMode()?(e.connect(U.byId("webmap-analysis-analysis"),"onClick",e.hitch(this,function(m){arcgisonline.map.dijit.toc.analysis.configureAnalysis(m,
{isMenu:!0})})),e.connect(U.byId("webmap-analysis-history"),"onClick",e.hitch(this,function(m){arcgisonline.map.dijit.toc.analysis.configureAnalysisHistory(m,{isMenu:!0})}))):(U.byId("webmap-analysis").destroy(),c=e.create("div",{id:"webmap-analysis"}),e.place(c,e.byId("webmap-spacer2"),"after"),new U.form.ToggleButton({iconClass:"menuIconPerformAnalysis",style:"margin-top:2px;"},c),arcgisonline.map.main.isReadOnlyMode()||e.connect(e.byId("webmap-analysis"),"onclick",e.hitch(this,function(m){"analysisStack"==
arcgisonline.map.leftPanel.getLeftContentPanelStack()||"toolStack"==arcgisonline.map.leftPanel.getLeftContentPanelStack()?arcgisonline.map.leftPanel.openLeftTOCPanel():arcgisonline.map.dijit.toc.analysis.configureAnalysis(m,{isMenu:!0})})));arcgisonline.map.main.isReadOnlyMode()||(e.connect(e.byId("webmap-share"),"onclick",e.hitch(arcgisonline.map.main,"linkToMap",!1)),e.connect(e.byId("webmap-directions"),"onclick",e.hitch(arcgisonline.map.leftPanel,"openLeftDirectionsPanel")));e.connect(e.byId("webmap-measure"),
"onclick",e.hitch(arcgisonline.map.main,"showMeasureTool"));e.connect(e.byId("webmap-bookmarks"),"onclick",e.hitch(arcgisonline.map.main,"showBookmarksTool"));if(esriGeowConfig.self.helperServices.printTask.templates&&1<esriGeowConfig.self.helperServices.printTask.templates.length){var h=U.byId("webmap-print-templates-menu");e.forEach(esriGeowConfig.self.helperServices.printTask.templates,function(m){m=new U.MenuItem({label:m.label,onClick:e.hitch(arcgisonline.map.print,"printMap",m)});h.addChild(m)})}else h=
U.byId("webmap-print-templates-menu"),c=new U.MenuItem({label:esri.i18nBundle.viewer.map,onClick:e.hitch(arcgisonline.map.print,"printMap",esriGeowConfig.self.helperServices.printTask.templates&&esriGeowConfig.self.helperServices.printTask.templates[0]||null,!1)}),h.addChild(c),c=new U.MenuItem({label:esri.i18nBundle.viewer.mapWithLegend,onClick:e.hitch(arcgisonline.map.print,"printMap",esriGeowConfig.self.helperServices.printTask.templates&&esriGeowConfig.self.helperServices.printTask.templates[0]||
null,!0)}),h.addChild(c);e.style(U.byId("webmap-print-templates").domNode,"display","");e.style(U.byId("webmap-print").domNode,"display","none");arcgisonline.map.main.checkReadOnly();arcgisonline.map.embedded.adjustUIForEmbedded();e.subscribe("onLayerVisibilityChange",e.hitch(arcgisonline.map.main,"onLayerVisibilityChange"));e.subscribe("onDefExprChanged",e.hitch(arcgisonline.map.main,"markMapAsChanged","onFilterApply"));e.subscribe("onServiceDefExprChanged",e.hitch(arcgisonline.map.itemData,"updateServiceDefinitionWithFilter"));
e.subscribe("onServiceFieldsChanged",e.hitch(arcgisonline.map.itemData,"updateServiceFields"));arcgisonline.map.role.setupUserActions();arcgisonline.map.main.updateHeaderLinks();esriGeowConfig.self.helperServices&&esriGeowConfig.self.helperServices.geometry&&esriGeowConfig.self.helperServices.geometry.url?esri.config.defaults.geometryService=new esri.tasks.GeometryService(esriGeowConfig.self.helperServices.geometry.url):console.err("No Geometry Service defined.",esriGeowConfig.self);esri.config.defaults.kmlService=
esriGeowConfig.kmlService;esri.config.defaults.geoRSSService=esriGeowConfig.geoRSSService;esri.config.defaults.io.proxyUrl=esriGeowConfig.proxyServer;esri.isDefined(esriGeowConfig.isMultiTenant)&&!1===esriGeowConfig.isMultiTenant?(esri.config.defaults.io.corsEnabledServers.push(arcgisonline.sharing.util.getHttpUrl(location.host).replace(/:80$/,"")),esri.config.defaults.io.corsEnabledServers.push(arcgisonline.sharing.util.getSecureUrl(location.host).replace(/:443$/,""))):(esri.config.defaults.io.corsEnabledServers.push(arcgisonline.sharing.util.getHttpUrl(location.host)),
esri.config.defaults.io.corsEnabledServers.push(arcgisonline.sharing.util.getSecureUrl(location.host)));esriGeowConfig.self.authorizedCrossOriginDomains&&esriGeowConfig.self.authorizedCrossOriginDomains.length&&e.forEach(esriGeowConfig.self.authorizedCrossOriginDomains,function(m){esri.config.defaults.io.corsEnabledServers.push({host:m,withCredentials:!0})});c=arcgisonline.sharing.util.getUser();arcgisonline.map.main.scaleBarUnits="metric";if(esriGeowConfig.self.user&&esriGeowConfig.self.user.units)arcgisonline.map.main.scaleBarUnits=
esriGeowConfig.self.user.units;else if(esriGeowConfig.self.units)arcgisonline.map.main.scaleBarUnits=esriGeowConfig.self.units;else if(c&&c.region&&"US"===c.region||c&&!c.region&&"US"===esriGeowConfig.self.region||c&&!c.region&&!esriGeowConfig.self.region||!c&&"US"===esriGeowConfig.self.ipCntryCode||!c&&!esriGeowConfig.self.ipCntryCode&&"en-us"===e.locale)arcgisonline.map.main.scaleBarUnits="english";c&&c.accountId||(arcgisonline.map.main.appAccess=!0);e.config.deferredOnError=function(m,t){};e.mixin(esri.symbol.defaultSimpleMarkerSymbol,
{style:"circle",color:[0,0,0,1],outline:null,size:4,angle:0,xoffset:0,yoffset:0});var f=esri.dijit.Popup.prototype._zoomToFeature;esri.dijit.Popup.prototype._zoomToFeature=function(){var m=this.getSelectedFeature(),t=m.getLayer();if(t&&t.__isFootprintLayer&&m.attributes.xmin&&m.attributes.ymin&&m.attributes.xmax&&m.attributes.ymax)m=new esri.geometry.Extent(m.attributes.xmin,m.attributes.ymin,m.attributes.xmax,m.attributes.ymax,t.fullExtent.spatialReference),arcgisonline.map.main.map.setExtent(m,
!0);else return f.apply(this,arguments)};c=arcgisonline.sharing.util.getUser();arcgisonline.map.main.loggedIn();arcgisonline.map.leftPanel.initSettings();c=arcgisonline.sharing.util.urlToObject(document.URL);c.query=c.query||{};c.query.folder&&(arcgisonline.map.save_open.folderId=c.query.folder,arcgisonline.map.save_open.folderTitle="dummy");c.query.useExisting||arcgisonline.map.storage.deleteMapCookie();if(c.query.useExisting)arcgisonline.map.storage.openWebMapFromCookie();else if(c.query.webmap)arcgisonline.map.save_open.openWebMapItemCard(c.query.webmap);
else if(c.query.basemapUrl){var g=arcgisonline.map.main.decodeUrl(c.query.basemapUrl),n=arcgisonline.map.main.getTitleFromUrl(g);arcgisonline.map.main.basemapTitle=n;-1<c.query.basemapUrl.indexOf("/VectorTileServer")?(-1===g.indexOf("root.json")&&(g+=(g.endsWith("/")?"":"/")+"resources/styles/root.json"),arcgisonline.map.vectorTile.addVectorTileAsBaseLayer({id:"VectorTile_"+Math.floor(10001*Math.random()),type:"VectorTileLayer",layerType:"VectorTileLayer",title:n,styleUrl:g},null,e.hitch(this,function(){arcgisonline.map.layer.loadMoreLayers()}))):
arcgisonline.map.layer.addUserBaseLayer({url:g})}else arcgisonline.map.layer.addDefaultBaseLayers();window.onresize=9>e.isIE?function(){U.byId("page-border").resize();arcgisonline.map.main.checkTitleDiv();arcgisonline.map.main.checkMinWidthOfPage()}:function(){arcgisonline.map.main.checkTitleDiv();arcgisonline.map.main.checkMinWidthOfPage()}})},updateHeaderLinks:function(){var a=esriGeowConfig.baseUrl,c=esriGeowConfig.self,d=arcgisonline.sharing.util.getUser();arcgisonline.sharing.util.isPortal()&&
"7443"===location.port&&(a=arcgisonline.sharing.util.getSecureUrl(a));arcgisonline.sharing.util.isPortal()||(d&&(e.attr(e.byId("accountSwitcher-link"),"innerHTML",esri.i18nBundle.siteHeader.switchAccounts+"\x26nbsp;\x26nbsp;"),e.query("#accountSwitcher-link").removeClass("hide"),e.connect(e.byId("accountSwitcher-link"),"onclick",e.hitch(this,function(m){m.preventDefault();window.open("https://"+window.location.host+"/home/pages/Account/manage_accounts.html#client_id\x3darcgisonline")}))),esriGeowConfig.self&&
esriGeowConfig.self.subscriptionInfo&&("Trial"===esriGeowConfig.self.subscriptionInfo.type||"Trial Press"===esriGeowConfig.self.subscriptionInfo.type)&&(e.attr(e.byId("trial-download-link"),"innerHTML",esri.i18nBundle.siteHeader.trialDownload+"\x26nbsp;\x26nbsp;"),e.query("#trial-download-link").removeClass("hide"),e.connect(e.byId("trial-download-link"),"onclick",e.hitch(this,function(m){m.preventDefault();m=(esriGeowConfig.self&&esriGeowConfig.self.user&&esriGeowConfig.self.user.culture||esriGeowConfig.self&&
esriGeowConfig.self.culture||dojoConfig.locale||"en").toLowerCase();m=esriGeowConfig.learnArcGIS+"/"+(m in{"pt-br":1,"pt-pt":1,"zh-cn":1}?m:m.split("-")[0].toLowerCase())+"/trial";window.open(m)}))));e.attr(e.byId("home-navigation-dropdown-link"),"innerHTML",'\x3cdiv id\x3d"site_logo"\x3eArc\x3cspan\x3eGIS\x3c/span\x3e\x3c/div\x3e');e.addClass(e.byId("home-navigation-dropdown-link"),"site_logo");var h=esriGeowConfig.self&&esriGeowConfig.self.portalProperties&&esriGeowConfig.self.portalProperties.topNav||
{},f=esriGeowConfig.self&&d&&d.accountId&&d.accountId===esriGeowConfig.self.id,g=c.helpBase+(c.isPortal&&"ArcGISEnterpriseOnKubernetes"!==c.portalDeploymentType?esriGeowConfig.helpMap["120001577"]||"":"");e.query(".homeHelp").attr("href",g);e.query(".homeHelp",this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();window.open(g,"_blank")}));e.query(".homeScene",this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();window.location="../webscene/viewer.html"}));
var n=h.scene;(!n||"all"===n||"members"===n&&f||"sceneCreators"===n&&f&&esriGeowConfig.userRole&&esriGeowConfig.userRole.canCreateItem())&&e.query(".homeScene",this.domNode).removeClass("hide");d?(e.query("#profileLink",this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();arcgisonline.map.main.goToPage(a+"user.html")})),e.query(".loggedInSignout",this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();arcgisonline.map.main.logOut()})),e.query(".homeHome",
this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();arcgisonline.map.main.goToPage(a+"index.html")})),e.query(".homeHome",this.domNode).removeClass("hide"),arcgisonline.map.role.isAllowed("header_myContent")&&(e.query(".homeMyContent",this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();arcgisonline.map.main.goToPage(a+"content.html")})),e.query(".homeMyContent",this.domNode).removeClass("hide")),e.query(".homeGroups",this.domNode).connect("onclick",
e.hitch(this,function(m){m.preventDefault();arcgisonline.map.main.goToPage(a+"groups.html")})),n=h.groups,(!n||"all"===n||"members"===n&&f)&&e.query(".homeGroups",this.domNode).removeClass("hide"),n=h.notebook||"members",arcgisonline.pages.utils.notebook.notebookServerConfigured()&&("members"===n&&f||"notebookCreators"===n&&f&&esriGeowConfig.userRole&&esriGeowConfig.userRole.canCreateNotebooks())&&e.query(".homeNotebook",this.domNode).removeClass("hide"),arcgisonline.sharing.util.isPortal()?e.query(".loggedInHelp",
this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();arcgisonline.map.main.openHelp()})):e.query(".loggedInHelp",this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();window.open(c.helpBase,"_blank")})),e.style(e.query(".homeHelp",this.domNode)[0],"display","none"),d.accountId?(e.attr(e.byId("home-navigation-dropdown-link"),"innerHTML",esri.i18nBundle.siteHeader.simpleHome),e.query("#home-navigation-dropdown-link").removeClass("site_logo top-nav-title").addClass("top-nav-link"),
e.query(".homeGallery",this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();arcgisonline.map.main.goToPage(a+"gallery.html")})),h=h.gallery,"noOne"!==h&&(!h||"all"===h||"members"===h&&f)&&e.query(".homeGallery",this.domNode).removeClass("hide"),e.query(".homeMyOrg",this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();arcgisonline.map.main.goToPage(a+"organization.html")})),arcgisonline.sharing.util.isPortal()&&esriGeowConfig.restrictOrganizationPageToAdmin&&
(!esriGeowConfig.userRole||esriGeowConfig.userRole&&!esriGeowConfig.userRole.isAdmin())?e.query(".homeMyOrg",this.domNode).addClass("hide"):e.query(".homeMyOrg",this.domNode).removeClass("hide")):(e.query("#home-navigation-dropdown-link").removeClass("top-nav-link").addClass("top-nav-title site_logo"),e.query(".homeOverview",this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();arcgisonline.map.main.goToPage(a+"../features/features.html")})),e.query(".homeOverview").removeClass("hide"),
e.query(".homePricing",this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();arcgisonline.map.main.goToPage(a+"../features/plans/pricing.html")})),e.query(".homePricing").removeClass("hide")),f=e.byId("my-settings"),f.classList.remove("hide"),f.innerHTML='\x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e'+esri.i18nBundle.siteHeader.mySettings,e.connect(f,"onclick",e.hitch(this,function(m){m.preventDefault();window.open(esriGeowConfig.baseUrl+
"user.html#settings","_blank")})),!arcgisonline.sharing.util.isPortal()&&d&&"both"===d.userType&&(e.query("#training-link").removeClass("hide"),e.attr(e.byId("training-link"),"innerHTML",'\x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e'+esri.i18nBundle.siteHeader.training),e.connect(e.byId("training-link"),"onclick",e.hitch(this,function(m){m.preventDefault();m={administrator:"//www.esri.com/training/main/arcgis-online-administrators",publisher:"//www.esri.com/training/main/arcgis-online-publishers",
user:"//www.esri.com/training/main/arcgis-online-users","public":"//www.esri.com/training/main/arcgis-online-training",custom:"//www.esri.com/training/main/arcgis-online-training"};var t=esriGeowConfig.userRole,w;t?t.isAdmin()||t.isBasedOnAdmin()?w=m.administrator:t.isPublisher()||t.isBasedOnPublisher()?w=m.publisher:t.isUser()||t.isBasedOnUser()?w=m.user:t.isCustom()&&(w=m.custom):w=m["public"];window.open(w)})),e.query("#esri-community-link").removeClass("hide"),e.attr(e.byId("esri-community-link"),
"innerHTML",'\x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e'+esri.i18nBundle.siteHeader.esriCommunity),e.connect(e.byId("esri-community-link"),"onclick",e.hitch(this,function(m){m.preventDefault();window.open(esriGeowConfig.esriCommunityLink,"_blank")})),e.query("#my-esri-link").removeClass("hide"),e.attr(e.byId("my-esri-link"),"innerHTML",'\x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e'+esri.i18nBundle.siteHeader.myEsri),
e.connect(e.byId("my-esri-link"),"onclick",e.hitch(this,function(m){m.preventDefault();window.open(esriGeowConfig.myEsriLink,"_blank")})),e.query("#arcgis-blog-link").removeClass("hide"),e.attr(e.byId("arcgis-blog-link"),"innerHTML",'\x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e'+esri.i18nBundle.siteHeader.arcgisBlog),e.connect(e.byId("arcgis-blog-link"),"onclick",e.hitch(this,function(m){m.preventDefault();window.open("https://www.esri.com/arcgis-blog/arcgis-online/",
"_blank")})))):(e.query(".signin",this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();arcgisonline.map.main.signIn()})),esriGeowConfig.self.urlKey||arcgisonline.sharing.util.isPortal()?(e.attr(e.byId("home-navigation-dropdown-link"),"innerHTML",esri.i18nBundle.siteHeader.simpleHome),e.query(".homeHome",this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();arcgisonline.map.main.goToPage(a+"index.html")})),e.query(".homeHome",this.domNode).removeClass("hide"),
e.query(".homeGallery",this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();arcgisonline.map.main.goToPage(a+"gallery.html")})),(h=h&&h.gallery)&&"all"!==h||e.query(".homeGallery",this.domNode).removeClass("hide")):(e.query(".homeOverview",this.domNode).connect("onclick",e.hitch(this,function(m){m.preventDefault();arcgisonline.map.main.goToPage(a+"../features/features.html")})),e.query(".homeOverview",this.domNode).removeClass("hide"),e.query(".homePricing",this.domNode).connect("onclick",
e.hitch(this,function(m){m.preventDefault();arcgisonline.map.main.goToPage(a+"../features/plans/pricing.html")})),e.query(".homePricing",this.domNode).removeClass("hide")));(!esriGeowConfig.self.isPortal||esriGeowConfig.self.livingAtlasGroupQuery&&esriGeowConfig.self.livingAtlasGroupQuery.length)&&e.style(e.byId("webmap-add-esri-maplayers"),"display","block");d&&d.accountId&&!esriGeowConfig.self.isPortal&&arcgisonline.map.vectorTile.checkSupport().then(e.hitch(this,function(m){var t=m?"Map Service;Image Service;Feature Service;WMS;WFS;WMTS;KML;Vector Tile Service".split(";"):
"Map Service;Image Service;Feature Service;WMS;WFS;WMTS;KML".split(";");esri.request({url:esriGeowConfig.restBaseUrl+"community/users/"+d.username+"/provisionedListings",content:{f:"json",start:1,num:100},callbackParamName:"callback",load:function(w){if(w&&w.provisionedListings){for(var u=!1,v=0;v<w.provisionedListings.length;v++){var x=w.provisionedListings[v];if(-1<e.indexOf(t,x.type)&&-1===e.indexOf(x.typeKeywords,"Elevation 3D Layer")&&-1===e.indexOf(x.tags,"mature support")){e.style(e.byId("webmap-add-provisionedListings"),
"display","block");u=!0;break}}if(!u)for(v=0;v<w.provisionedListings.length&&!u;v++)x=w.provisionedListings[v],u||-1!==x.type.indexOf("Application")||"Web Map"===x.type||esri.request({url:esriGeowConfig.restBaseUrl+"content/items/"+this.mapLayer.oldItemCard.id+"/relatedItems?relationshipType\x3dService2Style\x26direction\x3dreverse\x26f\x3djson",callbackParamName:"callback",load:e.hitch(this,function(y,C){if(y&&y.relatedItems&&y.relatedItems.length)for(var z=0;z<y.relatedItems.length;z++){var F=y.relatedItems[z];
-1<e.indexOf(t,F.type)&&-1===e.indexOf(F.typeKeywords,"Elevation 3D Layer")&&-1===e.indexOf(F.tags,"mature support")&&(e.style(e.byId("webmap-add-provisionedListings"),"display","block"),u=!0)}}),error:e.hitch(this,function(y){})})}},error:function(w){}})}));arcgisonline.map.main.updateRecentWebMaps()},initMap:function(a){arcgisonline.map.main.mapInitialized=!0;e.connect(arcgisonline.map.main.map,"onDblClick",e.hitch(arcgisonline.map.main,"onDblClick"));e.connect(arcgisonline.map.main.map,"onExtentChange",
e.hitch(arcgisonline.map.main,"onExtentChange"));e.connect(arcgisonline.map.main.map,"onPanStart",e.hitch(arcgisonline.map.main,"onPanStart"));e.connect(arcgisonline.map.main.map,"onPanEnd",e.hitch(arcgisonline.map.main,"onPanEnd"));e.connect(arcgisonline.map.main.map,"onZoomEnd",e.hitch(arcgisonline.map.main,"onZoomEnd"));e.subscribe("_onRendererUpdate",e.hitch(arcgisonline.map.main,"onRendererUpdate"));arcgisonline.map.main.setHandCursor();arcgisonline.map.main.initialExtent=a;arcgisonline.map.main.setMapExtent(a);
if(arcgisonline.map.main.defaultService.layer.loaded)arcgisonline.map.main.onDefaultServiceLoad(arcgisonline.map.main.defaultService.layer);else e.connect(arcgisonline.map.main.defaultService.layer,"onLoad",e.hitch(arcgisonline.map.main,"onDefaultServiceLoad"));arcgisonline.map.main.map.disableClickRecenter()},createOverviewMap:function(){if(!isEmbedded||!isEmbedded.isItemDetail){var a=arcgisonline.map.main.map.getLayer(arcgisonline.map.main.currentBaseService);if(!a||!arcgisonline.map.main.mapInitialized)setTimeout(e.hitch(arcgisonline.map.main,
"createOverviewMap"),1E3);else if(!arcgisonline.map.main.overviewMap){var c=!1;e.forEach(arcgisonline.map.main.mapLayers,function(h){"base"===h.type&&h.layer&&"esri.layers.VectorTileLayer"===h.layer.declaredClass&&(c=!0)});if(c){var d=esriGeowConfig.extentService;if(4326===a.spatialReference.wkid)d=esriGeowConfig.gcsBasemapService;else if(!arcgisonline.map.main.map.spatialReference.isWebMercator())return;if(esriGeowConfig.allSSL||"https:"==location.protocol)d=d.replace("http:","https:");a=new esri.layers.ArcGISTiledMapServiceLayer(d,
{});e.connect(a,"onLoad",function(){arcgisonline.map.main.overviewMap=new esri.dijit.OverviewMap({id:"overviewMap",baseLayer:a,map:arcgisonline.map.main.map,opacity:.45,width:200,height:200});arcgisonline.map.main.overviewMap.startup()})}else arcgisonline.map.main.overviewMap||"esri.layers.WMSLayer"===a.declaredClass||(arcgisonline.map.main.overviewMap=new esri.dijit.OverviewMap({id:"overviewMap",map:arcgisonline.map.main.map,opacity:.45,width:200,height:200}),arcgisonline.map.main.overviewMap.startup())}}},
destroyOverviewMap:function(){arcgisonline.map.main.overviewMap&&(arcgisonline.map.main.overviewMap.destroy(),arcgisonline.map.main.overviewMap=null)},recreateOverviewMap:function(){arcgisonline.map.main.destroyOverviewMap();arcgisonline.map.main.createOverviewMap()},createHomeButton:function(){arcgisonline.map.main.destroyHomeButton();var a=e.byId("map_zoom_slider"),c=e.create("div",{id:"homeButtonDiv"});e.place(c,a,1);arcgisonline.map.main.homeButton=new esri.dijit.HomeButton({map:arcgisonline.map.main.map,
theme:"homeButton",extent:arcgisonline.map.main.map.extent},"homeButtonDiv");arcgisonline.map.main.homeButton.startup()},destroyHomeButton:function(){arcgisonline.map.main.homeButton&&(arcgisonline.map.main.homeButton.destroy(),arcgisonline.map.main.homeButton=null,e.byId("homeButtonDiv")&&document.body.removeChild(e.byId("homeButtonDiv")))},recreateHomeButton:function(){arcgisonline.map.main.destroyHomeButton();arcgisonline.map.main.createHomeButton()},createLocateButton:function(){if(!isEmbedded||
!isEmbedded.isItemDetail){arcgisonline.map.main.destroyLocateButton();var a=e.byId("map_zoom_slider"),c=e.create("div",{id:"locateButtonDiv"});e.place(c,a,"after");arcgisonline.map.main.locateButton=new esri.dijit.LocateButton({map:arcgisonline.map.main.map,theme:"locateButton"},"locateButtonDiv");arcgisonline.map.main.locateButton.startup();arcgisonline.map.main.locateButton.on("locate",function(d){d.error?arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,
message:esri.i18nBundle.viewer.error.unableToLocate}):setTimeout(function(){arcgisonline.map.main.locateButton.clear()},5E3)})}},destroyLocateButton:function(){arcgisonline.map.main.locateButton&&(arcgisonline.map.main.locateButton.destroy(),arcgisonline.map.main.locateButton=null,e.byId("locateButtonDiv")&&document.body.removeChild(e.byId("locateButtonDiv")))},recreateLocateButton:function(){arcgisonline.map.main.destroyLocateButton();arcgisonline.map.main.createLocateButton()},onMapLoad:function(){arcgisonline.map.main.map&&
(e.publish("onMapLoad"),e.connect(U.byId("map"),"resize",e.hitch(arcgisonline.map.main,"resizeMap")),setTimeout("arcgisonline.map.main.map.reposition()",1E3),arcgisonline.map.main.createOverviewMap(),arcgisonline.map.main.resizeNoDataDiv(),arcgisonline.map.fileImport.setupDragDrop(),esriGeowConfig.usageTrackingEnabled&&!arcgisonline.sharing.util.isPortal()&&(arcgisonline.map.main.onLayerAddCorsCheckHandler&&e.disconnect(arcgisonline.map.main.onLayerAddCorsCheckHandler),arcgisonline.map.main.onLayerAddCorsCheckHandler=
e.connect(arcgisonline.map.main.map,"onLayerAdd",e.hitch(arcgisonline.map.main,"corsCheck"))),arcgisonline.map.main.setupMapAlert(),arcgisonline.map.main.setupHandlerForCache(),esri.id.setProtocolErrorHandler(function(a){arcgisonline.map.main.reloadViewerSecureIdMgr(a);return!1}),arcgisonline.map.main.map.infoWindow.resize(300,250),arcgisonline.map.geocode.createWidget())},onDefaultServiceLoad:function(a){a=1E3;arcgisonline.map.save_open.openedWebMap&&(a=3E3);arcgisonline.map.main.mapFullyLoadedTimer=
setTimeout("arcgisonline.map.main.mapFullyLoaded()",a)},mapFullyLoaded:function(){var a=!0;for(h=0;h<arcgisonline.map.main.mapLayers.length;h++){var c=arcgisonline.map.main.mapLayers[h];c&&c.layer&&"esri.layers.KMLLayer"==c.layer.declaredClass?c.layer.loaded||(a=!1):c&&!c.layers&&null==arcgisonline.map.main.map.getLayer(c.id)?a=!1:c&&c.layers&&"mapNotes"==!c.type&&null==arcgisonline.map.main.map.getLayer(c.id+"_0")&&(a=!1)}if(a){clearTimeout(arcgisonline.map.main.mapFullyLoadedTimer);arcgisonline.map.main.cleanUpFailedServices();
arcgisonline.map.main.onLayerAddHandler=e.connect(arcgisonline.map.main.map,"onLayerAdd",e.hitch(arcgisonline.map.main,"onLayerAddedOrRemoved"));setTimeout(function(){arcgisonline.map.main.onLayerRemoveHandler=e.connect(arcgisonline.map.main.map,"onLayerRemove",e.hitch(arcgisonline.map.main,"onLayerAddedOrRemoved"));arcgisonline.map.main.onLayerReorderHandler=e.connect(arcgisonline.map.main.map,"onLayerReorder",e.hitch(arcgisonline.map.main,"onLayerReordered"))},5E3);e.connect(arcgisonline.map.main.map,
"onBeforeUnload",function(){e.disconnect(arcgisonline.map.main.onLayerAddHandler);e.disconnect(arcgisonline.map.main.onLayerRemoveHandler);e.disconnect(arcgisonline.map.main.onLayerReorderHandler)});e.publish("onLayerUpdate",[""]);arcgisonline.map.main.scalebar||(arcgisonline.map.main.scalebar=new esri.dijit.Scalebar({map:arcgisonline.map.main.map,scalebarUnit:arcgisonline.map.main.scaleBarUnits}));var d=arcgisonline.sharing.util.getUser();d&&arcgisonline.map.save_open.webMapInfo&&arcgisonline.map.save_open.webMapInfo.owner!==
d.username&&"admin"!==arcgisonline.map.save_open.webMapInfo.itemControl&&"update"!==arcgisonline.map.save_open.webMapInfo.itemControl?U.byId("webmap-save-save").set("disabled",!0):U.byId("webmap-save-save").set("disabled",!1);arcgisonline.map.main.createHomeButton();arcgisonline.map.main.createLocateButton();arcgisonline.map.time.checkTimeSliderProperties(!0);arcgisonline.map.main.isMapFullyLoaded=!0;arcgisonline.map.role.updateUserActionWithWebmap();arcgisonline.map.popup.addPopupLayers();a=(a=arcgisonline.sharing.util.urlToObject(document.URL).query)?
a.timeExtent:null;!a&&arcgisonline.map.save_open.openedWebMap&&(a=arcgisonline.map.save_open.openedWebMap.timeExtent);a?(a=a.split(","),2==a.length&&(c=new esri.TimeExtent,c.startTime=new Date(parseInt(a[0])),c.endTime=new Date(parseInt(a[1])),arcgisonline.map.main.map.setTimeExtent(c))):arcgisonline.map.time.checkOnTimeButton();arcgisonline.map.multiDimensions.checkOnMdSliderButton();arcgisonline.map.popup.setupPopupHandler();arcgisonline.map.main.initBookmarks();arcgisonline.map.main.updateHeaderPresentationLink();
for(var h=0;h<arcgisonline.map.main.mapLayers.length;h++)"base"==arcgisonline.map.main.mapLayers[h].type&&(arcgisonline.map.main.mapLayers[h].successfulDraw=!0);arcgisonline.map.leftPanel.mapLoadedSettings();var f=arcgisonline.sharing.util.urlToObject(document.URL);f.query=f.query||{};f.query.mapNotes&&arcgisonline.map.mapNotes.addMapNotesLayer();arcgisonline.map.main.checkLayerOrder();arcgisonline.map.main.refreshMapTables();arcgisonline.map.main.checkMinWidthOfPage();arcgisonline.map.main.checkTitleDiv();
arcgisonline.map.main.createUrlMarker();f.query.showPublish&&arcgisonline.map.main.linkToMap(!0);f.query.defExt&&arcgisonline.map.main.displayDefaultExtent();if(f.query.panel&&"gallery"===f.query.panel&&(f.query.layers||f.query.url)&&!f.query.webmap&&!f.query.review){arcgisonline.map.role.isAnonymous()&&arcgisonline.map.role.updateUserActionAfterModify();var g=f.query.layers&&f.query.layers.split(",")[0],n=f.query.url,m=null,t=setInterval(function(){for(var u=1;u<arcgisonline.map.main.mapLayers.length;u++){var v=
arcgisonline.map.main.mapLayers[u];if((g&&v.itemId===g||n&&v.layer.url===n)&&v.layer instanceof esri.layers.FeatureLayer)if(f.query.id&&v.layer.url&&-1<v.layer.url.indexOf("/"+f.query.id)){m=v;break}else if(!f.query.id){m=v;break}}m&&(u=arcgisonline.map.itemData.itemDataContents[m.itemId],v=m.origItemLayers,u&&u.layers&&!v||(clearInterval(t),arcgisonline.map.leftPanel.openLeftRendererPanel(m.id,-1,!0,!0,"true"===f.query.suggestField?!0:!1,f.query.showField,f.query.style)))},200)}if((d=arcgisonline.sharing.util.getUser())&&
f.query.review&&(f.query.layers||f.query.services)){g=(f.query.layers||f.query.services).split(",")[0];var w=0;t=setInterval(function(){e.forEach(arcgisonline.map.main.mapLayers,function(u){u.itemId===g&&"base"!=u.type&&u.itemCard&&u.url&&(u.itemCard.owner===d.username||"update"===u.itemCard.itemControl||"admin"===u.itemCard.itemControl)&&-1<e.indexOf(u.itemCard.typeKeywords,"Involved Lookup")&&(clearInterval(t),arcgisonline.map.leftPanel.openLeftGeocodePanel(null,{parameterList:u}))});20<w&&clearInterval(t);
w++},1E3)}e.publish("onMapFullyLoaded");f.query.find&&arcgisonline.map.geocode.doSearch(decodeURIComponent(f.query.find));arcgisonline.map.main.checkUnsupported4xFeatures();arcgisonline.map.main.checkAccessToViewer();n=arcgisonline.map.main.buildNewMapViewerUrl();e.byId("webmap-openNewViewer").href=n}else arcgisonline.map.main.mapFullyLoadedTimer=setTimeout("arcgisonline.map.main.mapFullyLoaded()",1E3)},buildNewMapViewerUrl:function(){var a=esriGeowConfig.newMapViewerUrl,c=arcgisonline.sharing.util.urlToObject(document.URL),
d="url urls webmap layers layerId basemapUrl basemapReferenceUrl center extent level find marker".split(" "),h=["Feature Service","Map Service","Image Service","KML","Vector Tile Service"];c.query=c.query||{};var f="?";for(key in c.query)if("layers"===key){var g=c.query[key].split(","),n=!1;e.forEach(g,function(m){var t=arcgisonline.map.save_open.itemCards[m];t&&-1<e.indexOf(h,t.type)&&(n?a+=","+m:(a+=f+"layers\x3d"+m,f="\x26",n=!0))})}else-1<e.indexOf(d,key)&&(a+=f+key+"\x3d"+c.query[key],f="\x26");
return a},openNewMapViewer:function(a){a&&a.preventDefault();a=arcgisonline.map.main.buildNewMapViewerUrl();1==arcgisonline.map.main.mapHasChanged?arcgisonline.sharing.dijit.dialog.OpenNewViewerDlg.prototype.statics.getInstance().show(a):arcgisonline.map.main.goToPage(a)},checkUnsupported4xFeatures:function(){-1<window.navigator.userAgent.indexOf("Trident/")||isEmbedded||!esriGeowConfig.newMapViewerEnabled||arcgisonline.map.utils.getUnsupported4xFeatures(arcgisonline.map.save_open.originalWebMap||
arcgisonline.map.save_open.openedWebMap,arcgisonline.map.save_open.webMapItemCard).then(function(a){if(a.anyUnsupportedFeatures){var c="";a.unsupportedWebmapFeatures&&a.unsupportedWebmapFeatures.length?c=esri.i18nBundle.viewer.error.openInNewMapViewerMsg1+" "+esri.i18nBundle.viewer.error.openInNewMapViewerMsg2:(e.forEach(a.layers,function(h){c+="\x3cli\x3e"+h.title+"\x3c/li\x3e"}),c=esri.i18nBundle.viewer.error.openInNewMapViewerMsg1ForLayers+"\x3c/br\x3e\x3cul\x3e"+c+"\x3c/ul\x3e"+esri.i18nBundle.viewer.error.openInNewMapViewerMsg2);
a="\x26nbsp;\x3ca class\x3d'esriHelpIcon esriFloatTrailing'title\x3d'"+esri.i18nBundle.common.help+"' href\x3d'"+(esriGeowConfig.helpBase+esriGeowConfig.helpMap["120002712"])+"' target\x3d'_blank' /\x3e";var d=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance();d.show({title:esri.i18nBundle.viewer.error.openInNewMapViewerTitle+a,message:c,choiceOneTitle:esri.i18nBundle.viewer.error.openInNewMapViewerYes,choiceOneHandler:e.hitch(this,function(){var h=esriGeowConfig.newMapViewerUrl+
document.location.href.substring(document.location.href.indexOf("?"));window.open(h,"_blank")}),choiceTwoTitle:esri.i18nBundle.viewer.main.notRightNow,choiceTwoHandler:function(){}});e.style(d._dialog.domNode,"width","600px")}})},checkUnsupported4xItem:function(a,c){if(!(-1<window.navigator.userAgent.indexOf("Trident/"))&&esriGeowConfig.newMapViewerEnabled&&-1<a.typeKeywords.indexOf("ArcGIS API for JavaScript"))if(isEmbedded){var d="update"===a.itemControl||"admin"===a.itemControl,h=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
d=d?esri.i18nBundle.viewer.error.openInNewMapViewerLayerOwner:esri.i18nBundle.viewer.error.openInNewMapViewerLayerNotOwner;h.setButtonLabel(esri.i18nBundle.viewer.error.openInNewMapViewerYes);h.show({title:esri.i18nBundle.viewer.error.openInNewMapViewerTitle,message:d});e.aspect.after(h,"onOkClick",e.hitch(this,function(){var g=arcgisonline.sharing.util.urlToObject(document.URL);window.open(esriGeowConfig.newMapViewerUrl+"?layers\x3d"+g.query.layers+"\x26layerId\x3d"+g.query.layerId,"_blank")}))}else{d=
esri.i18nBundle.viewer.error.openInNewMapViewerLayerMsg1.replace("${title}",a.title)+"\x3cbr/\x3e\x3cbr/\x3e"+esri.i18nBundle.viewer.error.openInNewMapViewerLayerMsg2;var f="\x26nbsp;\x3ca class\x3d'esriHelpIcon esriFloatTrailing'title\x3d'"+esri.i18nBundle.common.help+"' href\x3d'"+(esriGeowConfig.helpBase+esriGeowConfig.helpMap["120002712"])+"' target\x3d'_blank' /\x3e";h=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance();h.show({title:esri.i18nBundle.viewer.error.openInNewMapViewerTitle+
f,message:d,choiceOneTitle:esri.i18nBundle.viewer.error.openInNewMapViewerYes,choiceOneHandler:e.hitch(this,function(){var g=arcgisonline.sharing.util.urlToObject(document.URL),n=esriGeowConfig.newMapViewerUrl;n="itemBrowser"===c?n+("?layers\x3d"+a.id):"layers"===c?n+("?layers\x3d"+g.query.layers):n+("?webmap\x3d"+g.query.webmap);window.open(n,"_blank")}),choiceTwoTitle:esri.i18nBundle.viewer.main.notRightNow,choiceTwoHandler:function(){}});e.style(h._dialog.domNode,"width","600px")}},checkLayerOrder:function(){if(arcgisonline.map.save_open.basemapWebMap){var a=
arcgisonline.map.save_open.basemapWebMap;a.operationalLayers=[]}else arcgisonline.map.save_open.openedWebMap?a=arcgisonline.map.save_open.openedWebMap:(a=esriGeowConfig.self.defaultBasemap,a.operationalLayers=[]);var c=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,"LabelLayer");-1<c&&arcgisonline.map.main.map.reorderLayer("LabelLayer",arcgisonline.map.main.map.graphicsLayerIds.length);var d=[];e.forEach(a.baseMapLayers||a.baseMap.baseMapLayers,function(x){d.push(x.id)});e.forEach(a.operationalLayers,
function(x){d.push(x.id)});var h=[];e.forEach(arcgisonline.map.main.mapLayers,function(x){h.push(x.id)});for(var f=!1,g=1;g<arcgisonline.map.main.mapLayers.length-1;){var n=arcgisonline.map.main.mapLayers[g],m=arcgisonline.map.main.mapLayers[g+1],t=e.indexOf(d,n.id),w=e.indexOf(d,m.id);if(-1!==t&&-1!==w)if("user"!=n.type&&"mapNotes"!=n.type||"user"!=m.type&&"mapNotes"!=m.type||!(n.layers||n.layer instanceof esri.layers.FeatureLayer||n.layer instanceof esri.layers.GeoRSSLayer)||!(m.layers||m.layer instanceof
esri.layers.FeatureLayer||m.layer instanceof esri.layers.GeoRSSLayer))if("user"===n.type&&"base"===m.type||"labels"===n.type&&"labels"!==m.type)u=1,arcgisonline.map.main.mapLayers[g+1]=n,arcgisonline.map.main.mapLayers[g]=m,c=e.indexOf(arcgisonline.map.main.map.layerIds,n.id),f=e.indexOf(arcgisonline.map.main.map.layerIds,m.id),-1<c&&-1<f&&c<f&&arcgisonline.map.main.map.reorderLayer(n.id,c+u),h=[],e.forEach(arcgisonline.map.main.mapLayers,function(x){h.push(x.id)}),g=0,f=!0;else if("base"===n.type&&
"base"===m.type||"labels"===n.type&&"labels"===m.type){var v=[];e.forEach(a.baseMapLayers||a.baseMap.baseMapLayers,function(x){("base"===n.type&&!x.isReference||"labels"===n.type&&x.isReference)&&v.push(x.id)});t=e.indexOf(v,n.id);w=e.indexOf(v,m.id);t>w&&(u=1,arcgisonline.map.main.mapLayers[g+1]=n,arcgisonline.map.main.mapLayers[g]=m,c=e.indexOf(arcgisonline.map.main.map.layerIds,n.id),f=e.indexOf(arcgisonline.map.main.map.layerIds,m.id),-1<c&&-1<f&&c<f&&arcgisonline.map.main.map.reorderLayer(n.id,
c+u),h=[],e.forEach(arcgisonline.map.main.mapLayers,function(x){h.push(x.id)}),g=0,f=!0)}else"user"==n.type&&"user"==m.type&&-1<e.indexOf(arcgisonline.map.main.map.layerIds,n.id)&&-1<e.indexOf(arcgisonline.map.main.map.layerIds,m.id)?(t=e.indexOf(d,n.id),w=e.indexOf(d,m.id),t>w?(arcgisonline.map.main.mapLayers[g+1]=n,arcgisonline.map.main.mapLayers[g]=m,c=e.indexOf(arcgisonline.map.main.map.layerIds,n.id),f=e.indexOf(arcgisonline.map.main.map.layerIds,m.id),-1<c&&-1<f&&c<f&&arcgisonline.map.main.map.reorderLayer(n.id,
c+1),h=[],e.forEach(arcgisonline.map.main.mapLayers,function(x){h.push(x.id)}),g=0,f=!0):(t=e.indexOf(arcgisonline.map.main.map.layerIds,n.id),w=e.indexOf(arcgisonline.map.main.map.layerIds,m.id),t>w&&arcgisonline.map.main.map.reorderLayer(m.id,t+1))):"user"==n.type&&"user"==m.type&&-1<e.indexOf(arcgisonline.map.main.map.layerIds,n.id)&&(m.layers||m.layer instanceof esri.layers.FeatureLayer||m.layer instanceof esri.layers.GeoRSSLayer)||("user"==n.type&&"user"==m.type&&(n.layers||n.layer instanceof
esri.layers.FeatureLayer||n.layer instanceof esri.layers.GeoRSSLayer)&&-1<e.indexOf(arcgisonline.map.main.map.layerIds,m.id)?(u=1,arcgisonline.map.main.mapLayers[g+1]=n,arcgisonline.map.main.mapLayers[g]=m,n.layers?(c=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,n.layers[n.layers.length-1].id),-1<c&&e.forEach(n.layers,function(x,y){arcgisonline.map.main.map.reorderLayer(x.id,c+u)},this)):n.layer instanceof esri.layers.GeoRSSLayer?(f=n.layer.getFeatureLayers(),f.length&&(c=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,
f[f.length-1].id),-1<c&&e.forEach(f,function(x,y){arcgisonline.map.main.map.reorderLayer(x.id,c+u)},this))):(c=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,n.id),f=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,m.id),-1<c&&-1<f&&c<f&&arcgisonline.map.main.map.reorderLayer(n.id,c+u)),h=[],e.forEach(arcgisonline.map.main.mapLayers,function(x){h.push(x.id)}),g=0,f=!0):"labels"==m.type&&(w=e.indexOf(arcgisonline.map.main.map.layerIds,m.id),-1<w&&w<arcgisonline.map.main.map.layerIds.length-
1&&arcgisonline.map.main.map.reorderLayer(m.id,arcgisonline.map.main.map.layerIds.length-1)));else if(t=e.indexOf(d,n.id),w=e.indexOf(d,m.id),t>w){var u=1;m.layers?u=m.layers.length:m.layer instanceof esri.layers.GeoRSSLayer&&(u=m.layer.getFeatureLayers().length);arcgisonline.map.main.mapLayers[g+1]=n;arcgisonline.map.main.mapLayers[g]=m;n.layers?(c=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,n.layers[n.layers.length-1].id),-1<c&&e.forEach(n.layers,function(x,y){arcgisonline.map.main.map.reorderLayer(x.id,
c+u)},this)):n.layer instanceof esri.layers.GeoRSSLayer?(f=n.layer.getFeatureLayers(),c=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,f[f.length-1].id),-1<c&&e.forEach(f,function(x,y){arcgisonline.map.main.map.reorderLayer(x.id,c+u)},this)):(c=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,n.id),f=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,m.id),-1<c&&-1<f&&c<f&&arcgisonline.map.main.map.reorderLayer(n.id,c+u));h=[];e.forEach(arcgisonline.map.main.mapLayers,function(x){h.push(x.id)});
g=0;f=!0}g++}for(g=a=0;g<arcgisonline.map.main.mapLayers.length;g++)if(m=arcgisonline.map.main.mapLayers[g],("user"==m.type||"mapNotes"==m.type)&&(m.layers||m.layer instanceof esri.layers.FeatureLayer||m.layer instanceof esri.layers.GraphicsLayer||m.layer instanceof esri.layers.GeoRSSLayer))if(m.layers||m.layer instanceof esri.layers.GeoRSSLayer)for(m=m.layers?m.layers:m.layer.getFeatureLayers(),t=0;t<m.length;t++)w=m[t].id,-1<e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,w)&&arcgisonline.map.main.map.reorderLayer(w,
a++);else w=m.id,-1<e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,w)&&arcgisonline.map.main.map.reorderLayer(w,a++);for(g=a=0;g<arcgisonline.map.main.mapLayers.length;g++)m=arcgisonline.map.main.mapLayers[g],m.layer&&-1<e.indexOf(arcgisonline.map.main.map.layerIds,m.layer.id)&&arcgisonline.map.main.map.reorderLayer(m.layer.id,a++);f&&leftPanel&&leftPanel.reloadVisibleTOC();arcgisonline.map.labels.orderLayers()},onDblClick:function(a){if(!arcgisonline.map.edit.editActivated&&!arcgisonline.map.main.measureActivated&&
!arcgisonline.map.edit.analysisDrawActivated){var c=.5;null!=arcgisonline.map.main.mapLods&&(c=arcgisonline.map.main.map.getLevel()+1);arcgisonline.map.main.map.centerAndZoom(new esri.geometry.Point(a.mapPoint.x,a.mapPoint.y,arcgisonline.map.main.map.extent.spatialReference),c)}},onExtentChange:function(a,c,d,h){if(arcgisonline.map.main.startup){if(arcgisonline.map.main.map.getLayer(arcgisonline.map.main.currentBaseService)){null!=arcgisonline.map.main.defaultService.layer&&1==arcgisonline.map.main.defaultService.defaultVisibility&&
arcgisonline.map.main.map.getLayer(arcgisonline.map.main.currentBaseService).show();for(c=0;c<arcgisonline.map.main.mapLayers.length;c++)(d=arcgisonline.map.main.mapLayers[c])&&("user"==d.type||"labels"==d.type)&&d.defaultVisibility&&arcgisonline.map.main.showLayerOnceLoaded(d.id,0);arcgisonline.map.main.startup=!1}}else!arcgisonline.map.main.isUserBaseService&&h&&(arcgisonline.map.main.hideNoDataDisplay(),arcgisonline.map.main.displayNoData(h.level)),arcgisonline.map.main.lastExtent&&(c=arcgisonline.map.main.lastExtent.getWidth()*
arcgisonline.map.main.lastExtent.getHeight(),d=a.getWidth()*a.getHeight(),1.3<Math.max(c,d)/Math.min(c,d)&&arcgisonline.map.main.markMapAsChangedIfOwner("onExtentChange")),isEmbedded&&arcgisonline.map.main.markMapAsChangedIfOwner("onExtentChange"),c=Math.round(arcgisonline.map.main.map.getScale()),c=e.number.format(c,{pattern:"#,###,###,##0"}),e.byId("layerMenu.scaleCurrent")&&(e.byId("layerMenu.scaleCurrent").innerHTML=e.string.substitute(esri.i18nBundle.tocPanel.mapScale,{scale:c})),e.byId("subLayerMenu.scaleCurrent")&&
(e.byId("subLayerMenu.scaleCurrent").innerHTML=e.string.substitute(esri.i18nBundle.tocPanel.mapScale,{scale:c}));arcgisonline.map.dijit.toc.scale.checkLayersInMapScale();arcgisonline.map.main.lastExtent=e.clone(a)},showLayerOnceLoaded:function(a,c){for(var d=0;d<arcgisonline.map.main.mapLayers.length;d++){var h=arcgisonline.map.main.mapLayers[d];if(h.id==a){null==h.layer&&50>c?setTimeout(function(){arcgisonline.map.main.showLayerOnceLoaded(a,c+1)},100):null!=h.layer&&1==h.defaultVisibility&&h.layer.show();
break}}},onLayerAddResult:function(a,c){if(c&&c.message&&-1<c.message.indexOf("Too many WebGL contexts.")){var d=arcgisonline.map.main.getItemWithId(arcgisonline.map.main.mapLayers,a.id);arcgisonline.map.layer.removeLayer(d);e.publish("layerAddFailed",[d.itemId?{itemId:d.itemId,id:d.id}:d.id]);var h=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();d=e.string.substitute(esri.i18nBundle.viewer.error.layerNotAddedOutOfWebGL,{layer:d&&d.title||a.url});h.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,
message:d})}},onLayerAddedOrRemoved:function(a){"esri.layers.GraphicsLayer"===a.declaredClass||a.__tempTableLayer||null==arcgisonline.map.main.mapLayers[0]||null==arcgisonline.map.main.mapLayers[0].layer||"base"!=arcgisonline.map.main.mapLayers[0].type||(a.timeInfo&&a.useMapTime&&(arcgisonline.map.time.timeSliderProperties=null),arcgisonline.map.edit.checkOnEditButton(),arcgisonline.map.time.checkOnTimeButton(),arcgisonline.map.dijit.toc.analysis.checkOnAnalysisButton(),arcgisonline.map.multiDimensions.checkOnMdSliderButton(),
null!=arcgisonline.map.save_open.webMapInfo&&(arcgisonline.map.save_open.webMapInfo.deleteExplorerSlides=!0),e.publish("onLayerUpdate",["reopen"]),leftPanel&&leftPanel.checkLegendStack(),arcgisonline.map.main.isMapFullyLoaded&&"editStack"===arcgisonline.map.leftPanel.getLeftContentPanelStack()&&a instanceof esri.layers.FeatureLayer&&a.isEditable()&&setTimeout(function(){U.byId("editPanel").recreateEditor()},0))},onLayerReordered:function(a){"esri.layers.GraphicsLayer"===a.declaredClass||"esri.layers.FeatureLayer"===
a.declaredClass&&a.mode===esri.layers.FeatureLayer.MODE_SELECTION||(null!=arcgisonline.map.save_open.webMapInfo&&(arcgisonline.map.save_open.webMapInfo.deleteExplorerSlides=!0),leftPanel&&leftPanel.checkLegendStack())},resizeMap:function(){if(arcgisonline.map.main.map&&arcgisonline.map.main.map.extent&&arcgisonline.map.main.map.extent.xmin){try{arcgisonline.map.main.map.resize()}catch(a){}arcgisonline.map.main.map.reposition();arcgisonline.map.main.resizeNoDataDiv()}arcgisonline.map.table.featureTable&&
e.isIE&&arcgisonline.map.table.featureTable.resize()},onLayerVisibilityChange:function(){arcgisonline.map.edit.checkOnEditButton();arcgisonline.map.time.checkOnTimeButton();arcgisonline.map.multiDimensions.checkOnMdSliderButton();arcgisonline.map.main.checkMapAlert();arcgisonline.map.main.markMapAsChangedIfOwner("onLayerVisibilityChange");leftPanel&&leftPanel.checkLegendStack()},onPanStart:function(){arcgisonline.map.edit.editActivated||(9>e.isIE?arcgisonline.map.main.map.setMapCursor("url(images/close_hand_cursor.cur),auto"):
arcgisonline.map.main.map.setMapCursor("url(images/close_hand_cursor.png),auto"))},onPanEnd:function(){arcgisonline.map.edit.editActivated||arcgisonline.map.main.setHandCursor()},onZoomEnd:function(){},onRendererUpdate:function(){leftPanel&&(leftPanel.deleteLegendStack(),"contentStack"==arcgisonline.map.leftPanel.getLeftContentPanelStack()?e.publish("onLayerUpdate",["reopen"]):leftPanel.deleteContentStack());arcgisonline.map.main.markMapAsChanged("onRendererUpdate")},setHandCursor:function(){null!=
arcgisonline.map.main.map&&arcgisonline.map.main.map.setMapCursor("default")},displayNoData:function(a){arcgisonline.map.main.noDataDisplayTimer=setTimeout("arcgisonline.map.main.displayNoDataDelay("+a+")",2500)},displayNoDataDelay:function(a){clearTimeout(arcgisonline.map.main.noDataDisplayTimer);if(null!=arcgisonline.map.main.mapLods){a=arcgisonline.map.main.mapLods[a].resolution;var c=arcgisonline.map.main.map.getLayer(arcgisonline.map.main.currentBaseService);if(c.tileInfo){c=c.tileInfo.lods;
var d=c[0].resolution;if(a<c[c.length-1].resolution||a>d)e.style(e.byId("noData1"),"display","block"),e.style(e.byId("noData2"),"display","block"),e.style(e.byId("noData3"),"display","block"),e.style(e.byId("noData4"),"display","block")}}},hideNoDataDisplay:function(){e.style(e.byId("noData1"),"display","none");e.style(e.byId("noData2"),"display","none");e.style(e.byId("noData3"),"display","none");e.style(e.byId("noData4"),"display","none")},resizeNoDataDiv:function(){arcgisonline.map.main.hideNoDataDisplay();
e.style(e.byId("noDataDiv"),"width",""+e.style(e.byId("mapDiv"),"width")+"px");e.style(e.byId("noDataDiv"),"height",""+e.style(e.byId("mapDiv"),"height")+"px");e.style(e.byId("noDataDiv"),"left",""+e.style(e.byId("mapDiv"),"left")+"px");e.style(e.byId("noDataDiv"),"top",""+e.style(e.byId("mapDiv"),"top")+"px");var a=arcgisonline.map.main.map.height/4-25;e.style(e.byId("noData1"),"margin",""+a+"px 0 "+a+"px 0");e.style(e.byId("noData2"),"margin",""+a+"px 0 "+a+"px 0");e.style(e.byId("noData3"),"margin",
""+a+"px 0 "+a+"px 0");e.style(e.byId("noData4"),"margin",""+a+"px 0 "+a+"px 0")},setDefaultTitle:function(){arcgisonline.map.main.setTitle(esri.i18nBundle.viewer.defaultMapTitle)},setTitle:function(a){e.byId("webmap-title-text").innerHTML=a;arcgisonline.map.main.checkTitleDiv();e.doc.title=esriGeowConfig.urlKey?a:(esriGeowConfig.portalName?esriGeowConfig.portalName:"ArcGIS")+" - "+a},checkTitleDiv:function(){if(arcgisonline.map.main.isMapFullyLoaded){var a=e.coords(e.byId("webmap-header")).w,c=e.coords(e.byId("home-navigation-dropdown")).w,
d=e.coords(e.byId("header-controls")).w;d=a-c-d-45;0>d&&(e.style(e.byId("header-controls"),"width","300px"),d=a-c-300-30);e.style(e.byId("webmap-title-text"),"visibility","visible");if(arcgisonline.map.save_open.webMapInfo&&(a=arcgisonline.sharing.util.getUser())&&(arcgisonline.map.save_open.webMapInfo.owner===a.username||"admin"===arcgisonline.map.save_open.webMapInfo.itemControl||"update"===arcgisonline.map.save_open.webMapInfo.itemControl)){a=e.coords(e.byId("webmap-title-edit-save")).w;var h=
e.coords(e.byId("webmap-title-edit-cancel")).w;0<a||0<h?e.style("webmap-title-edit-input","width",d-a-h-10+"px"):e.style("webmap-title-edit-input","width",d-10*esri.i18nBundle.common.save.length-10*esri.i18nBundle.common.cancel.length-50+"px");e.style(e.byId("webmap-title-edit"),"visibility","visible");arcgisonline.map.main.titleEditHandler||(arcgisonline.map.main.titleEditHandler=e.query("#webmap-title-edit").onclick(e.hitch(arcgisonline.map.main,"editTitle")),e.query("#webmap-title-edit-save").onclick(e.hitch(arcgisonline.map.main,
"saveTitle")),e.query("#webmap-title-edit-cancel").onclick(e.hitch(arcgisonline.map.main,"cancelTitle")))}e.style(e.byId("webmap-title"),"width",d+"px");e.style(e.byId("webmap-title-tableDiv"),"width",d+"px");e.style(e.byId("webmap-title-table"),"width",d+"px");e.byId("webmap-title-sizing").innerHTML=esri.i18nBundle.common.edit;a=e.coords(e.byId("webmap-title-edit")).w;d=d-a-10;e.byId("webmap-title-sizing").innerHTML=e.byId("webmap-title-text").innerHTML;a=e.coords(e.byId("webmap-title-sizing")).w+
10;e.style(e.byId("webmap-title-text"),"width",(d>a?a:d)+"px");esriGeowConfig.isRightToLeft?e.style(e.byId("webmap-title"),"paddingRight",c+18+"px"):e.style(e.byId("webmap-title"),"paddingLeft",c+18+"px")}},editTitle:function(){e.style(e.byId("webmap-title-text"),"display","none");e.style(e.byId("webmap-title-edit"),"display","none");e.style(e.byId("webmap-title-edit-inputGrp"),"display","");arcgisonline.map.main.checkTitleDiv();e.byId("webmap-title-edit-input").value=arcgisonline.map.save_open.webMapInfo?
arcgisonline.map.save_open.webMapInfo.title:esri.i18nBundle.viewer.defaultMapTitle},saveTitle:function(){var a=e.byId("webmap-title-edit-input").value;if(a&&a.length)if(-1<a.indexOf("\x3c")||-1<a.indexOf("\x3e"))e.byId("webmap-title-edit-input").value=arcgisonline.map.save_open.webMapInfo.title,d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),d.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.saveWebMapDlg.error.specialCharaters});else{250<
a.length&&(a=a.substring(0,250));d={title:a};var c=esriGeowConfig.restBaseUrl+"content/users/"+arcgisonline.map.save_open.webMapInfo.owner;c+=arcgisonline.map.save_open.webMapInfo.ownerFolder?"/"+arcgisonline.map.save_open.webMapInfo.ownerFolder:"";c+="/items/"+arcgisonline.map.save_open.webMapInfo.id+"/update";arcgisonline.sharing.util.postJson(d,c).then(function(h){arcgisonline.map.save_open.webMapInfo.title=a;arcgisonline.map.main.setTitle(a);e.style(e.byId("webmap-title-text"),"display","");e.style(e.byId("webmap-title-edit"),
"display","");e.style(e.byId("webmap-title-edit-inputGrp"),"display","none")},function(h){e.style(e.byId("webmap-title-text"),"display","");e.style(e.byId("webmap-title-edit"),"display","");e.style(e.byId("webmap-title-edit-inputGrp"),"display","none");arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.save_open.mapNotSaved,{title:a})})})}else{e.byId("webmap-title-edit-input").value=
arcgisonline.map.save_open.webMapInfo.title;var d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();d.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.saveWebMapDlg.error.provideTitle})}},cancelTitle:function(){e.style(e.byId("webmap-title-text"),"display","");e.style(e.byId("webmap-title-edit"),"display","");e.style(e.byId("webmap-title-edit-inputGrp"),"display","none")},setMapExtent:function(a){null==a&&(a=arcgisonline.map.main.defaultExtent);
arcgisonline.map.main.initialExtent=new esri.geometry.Extent(a.xmin,a.ymin,a.xmax,a.ymax,a.spatialReference);var c=arcgisonline.map.main.map.spatialReference;null==c&&(c=arcgisonline.map.main.defaultExtent.spatialReference);var d=arcgisonline.sharing.util.urlToObject(document.URL);d.query=d.query||{};if(d.query.extent)if(a=decodeURIComponent(d.query.extent).split(";"),1===a.length&&(a=decodeURIComponent(d.query.extent).split(",")),4==a.length||5==a.length){var h=e.number.parse(a[0]),f=e.number.parse(a[1]),
g=e.number.parse(a[2]),n=e.number.parse(a[3]);if(isNaN(h)||isNaN(h)||isNaN(h)||isNaN(h))h=parseFloat(a[0]),f=parseFloat(a[1]),g=parseFloat(a[2]),n=parseFloat(a[3]);if(isNaN(h)||isNaN(f)||isNaN(g)||isNaN(n))arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent,!1);else{var m=4326;5!=a.length||isNaN(a[4])||(m=parseInt(a[4]));f=new esri.geometry.Extent(h,f,g,n,new esri.SpatialReference({wkid:m}));arcgisonline.map.main.sameSpatialReference(c,new esri.SpatialReference({wkid:m}))?(arcgisonline.map.main.initialExtent=
f,arcgisonline.map.main.map.setExtent(f,!1)):(a=function(v,x){arcgisonline.map.main.initialExtent=v[0];arcgisonline.map.main.map.setExtent(v[0],!1)},h=function(v,x){arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent,!1)},arcgisonline.map.main.projectToMapSpatialReference(f,e.hitch(this,a),e.hitch(this,h)))}}else arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent,!1);else if(d.query.center){if(a=decodeURIComponent(d.query.center).split(";"),1===a.length&&(a=
decodeURIComponent(d.query.center).split(",")),2==a.length||3==a.length){f=e.number.parse(a[0]);g=e.number.parse(a[1]);if(isNaN(f)||isNaN(g))f=parseFloat(a[0]),g=parseFloat(a[1]);if(!isNaN(f)&&!isNaN(g)){m=4326;3!=a.length||isNaN(a[2])||(m=parseInt(a[2]));var t=function(v,x){var y=0,C=0;null!=arcgisonline.map.main.mapLods&&d.query.level?(C=parseInt(d.query.level),y=arcgisonline.map.main.mapLods[C].resolution*arcgisonline.map.main.map.width/2,C=arcgisonline.map.main.mapLods[C].resolution*arcgisonline.map.main.map.height/
2):d.query.resolution?(C=parseFloat(d.query.resolution),y=C*arcgisonline.map.main.map.width/2,C=C*arcgisonline.map.main.map.height/2):(y=arcgisonline.map.main.defaultExtent.getWidth()/2,C=arcgisonline.map.main.defaultExtent.getHeight()/2);y=new esri.geometry.Extent(v-y,x-C,v+y,x+C,c);arcgisonline.map.main.initialExtent=y;arcgisonline.map.main.map.setExtent(y)};arcgisonline.map.main.sameSpatialReference(c,new esri.SpatialReference({wkid:m}))?t(f,g):(a=function(v,x){t(v[0].x,v[0].y)},h=function(v,x){arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent,
!1)},arcgisonline.map.main.projectPointToMapSpatialReference(f,g,new esri.SpatialReference({wkid:m}),e.hitch(this,a),e.hitch(this,h)))}}}else if(arcgisonline.map.save_open.openedWebMap&&arcgisonline.map.save_open.openedWebMap.initialState&&arcgisonline.map.save_open.openedWebMap.initialState.viewpoint&&arcgisonline.map.save_open.openedWebMap.initialState.viewpoint.targetGeometry&&arcgisonline.map.save_open.openedWebMap.initialState.viewpoint.scale){f=new esri.geometry.Extent(arcgisonline.map.save_open.openedWebMap.initialState.viewpoint.targetGeometry);
var w=f.getCenter(),u=arcgisonline.map.save_open.openedWebMap.initialState.viewpoint.scale;f=w.x;g=w.y;t=function(v,x){var y=arcgisonline.map.main.getExtentFromCenter(w,arcgisonline.map.main.map.width,u);arcgisonline.map.main.initialExtent=y;arcgisonline.map.main.map.setExtent(y)};arcgisonline.map.main.sameSpatialReference(c,w.spatialReference)?t(f,g):(a=function(v,x){t(v[0].x,v[0].y)},h=function(v,x){arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent,!1)},arcgisonline.map.main.projectPointToMapSpatialReference(f,
g,new esri.SpatialReference({wkid:m}),e.hitch(this,a),e.hitch(this,h)))}else arcgisonline.map.save_open.openedWebMap&&arcgisonline.map.save_open.openedWebMap.initialState&&arcgisonline.map.save_open.openedWebMap.initialState.viewpoint&&arcgisonline.map.save_open.openedWebMap.initialState.viewpoint.targetGeometry?(f=new esri.geometry.Extent(arcgisonline.map.save_open.openedWebMap.initialState.viewpoint.targetGeometry),arcgisonline.map.main.sameSpatialReference(c,f.spatialReference)?(arcgisonline.map.main.initialExtent=
f,arcgisonline.map.main.map.setExtent(f,!1)):(a=function(v,x){arcgisonline.map.main.initialExtent=v[0];arcgisonline.map.main.map.setExtent(v[0],!1)},h=function(v,x){arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent,!1)},arcgisonline.map.main.projectToMapSpatialReference(f,e.hitch(this,a),e.hitch(this,h)))):(arcgisonline.map.main.map.spatialReference||(m=new esri.SpatialReference(a.spatialReference.toJson()),arcgisonline.map.main.map.spatialReference=m),arcgisonline.map.main.map.setExtent(a,
!1))},createUrlMarker:function(){var a=arcgisonline.sharing.util.urlToObject(document.URL);a.query=a.query||{};if(a.query.marker){var c=decodeURIComponent(a.query.marker).split(";");1===c.length&&(c=decodeURIComponent(a.query.marker).split(","));var d={TITLE:"",DESCRIPTION:"",IMAGE_URL:null,IMAGE_LINK_URL:null},h={VISIBLE:1,TYPEID:0,OBJECTID:0};if(2<=c.length&&6>=c.length&&!isNaN(c[0])&&!isNaN(c[1])){var f=parseFloat(c[0]),g=parseFloat(c[1]),n=4326;3<=c.length&&c[2].length&&!isNaN(c[2])&&(n=parseInt(c[2]));
var m="";4<=c.length&&(m=c[3],d.TITLE=m);var t=null;5<=c.length&&0===c[4].indexOf("http")&&(t=c[4]);m=null;6===c.length&&(m=c[5]);var w=function(v,x){var y=0,C=0;null!=arcgisonline.map.main.mapLods&&a.query.level?(C=parseInt(a.query.level),y=arcgisonline.map.main.mapLods[C].resolution*arcgisonline.map.main.map.width/2,C=arcgisonline.map.main.mapLods[C].resolution*arcgisonline.map.main.map.height/2):a.query.resolution?(C=parseFloat(a.query.resolution),y=C*arcgisonline.map.main.map.width/2,C=C*arcgisonline.map.main.map.height/
2):(y=arcgisonline.map.main.defaultExtent.getWidth()/2,C=arcgisonline.map.main.defaultExtent.getHeight()/2);y=new esri.geometry.Extent(v-y,x-C,v+y,x+C,arcgisonline.map.main.map.spatialReference);arcgisonline.map.main.initialExtent=y;arcgisonline.map.main.map.setExtent(y)};c=new esri.geometry.Point(f,g,new esri.SpatialReference({wkid:n}));t=esri.symbol.fromJson({type:"esriPMS",url:t,contentType:"image/png"});var u=null;m&&(u=esri.symbol.fromJson({color:[0,0,0,255],type:"esriTS",verticalAlignment:"baseline",
horizontalAlignment:"left",angle:0,xoffset:0,yoffset:0,rotated:!1,kerning:!0,font:{size:12,style:"normal",weight:"bold",family:"Arial"},text:m}));arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+"community/groups?q\x3d"+esriGeowConfig.layerTemplatesGroupQuery).then(e.hitch(this,function(v,x,y,C,z,F){arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+"search?num\x3d50\x26q\x3dgroup:"+F.results[0].id+' AND type:"Feature Collection Template"').then(e.hitch(this,function(O,V,N,J,
D,K){if(K.results&&0!==K.results.length){K.results.sort(function(I,R){return I.name==R.name?0:I.name<R.name?-1:1});arcgisonline.map.mapNotes.getMapNotesConfig(K.results[0].id,esri.i18nBundle.mapNotesDlg.mapNotes,!0);var G=e.connect(arcgisonline.map.main.map,"onLayersAddResult",e.hitch(this,function(I,R,A,B,H,T){for(var M=0;M<T.length;M++){var L=arcgisonline.map.main.getParameterList(T[M].layer);if(L.title===esri.i18nBundle.mapNotesDlg.mapNotes){e.disconnect(G);arcgisonline.map.main.projectPointToMapSpatialReference(I.x,
I.y,new esri.SpatialReference({wkid:I.spatialReference.wkid}),e.hitch(this,function(X,ba,ma,ta,Ea){I=new esri.geometry.Point(Ea[0].x,Ea[0].y,Ea[0].spatialReference);X.url?arcgisonline.map.main.getPictureMarkerSize(X.url).then(function(wa){X.width=wa[0];X.height=wa[1];L.layers[3].applyEdits([new esri.Graphic(I,X,ma)]);ba&&(ba.xoffset=X.width/2,ba.yoffset=X.height/2,L.layers[2].applyEdits([new esri.Graphic(new esri.geometry.Point(I.toJson()),ba,ta)]))},function(){var wa=window.location.href.substring(0,
window.location.href.indexOf(window.location.pathname)+window.location.pathname.lastIndexOf("/"))+"/images/EsriBluePinCircle26.png";X=esri.symbol.fromJson({type:"esriPMS",url:wa,imageData:"iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDMjdDMDU2RTdEM0ExMUUzOTkyRUU3OTg1MDdCQzMzRSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDMjdDMDU2RjdEM0ExMUUzOTkyRUU3OTg1MDdCQzMzRSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMyN0MwNTZDN0QzQTExRTM5OTJFRTc5ODUwN0JDMzNFIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMyN0MwNTZEN0QzQTExRTM5OTJFRTc5ODUwN0JDMzNFIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+aJP1/QAAAeNJREFUeNpi/P//PwM+IOdS4gCkEoA4AIj50aQ/AvEGIF7waE/PAXzmMOKzCGjJBGY2rnxeKQ0GNl5hBiAbRf7vr28Mvz6/Zfj87AaIPRFoWQHJFgEtKWDl4u8XVrNmYGRmRZH79uE1RDMTMwMLGzsDCysbw9tbRxl+f/tYCLRsAjbzmPD4toBfwRDDEmTw/99fht8/gL768Z0BpBakB5daFjwWybNyokYJLycLg6okN8PPLwwMN558YPj87TckCH//ZGAXEGVgYmaVJ8ciFOBjIs5Q6KvEwMMB0fLl+2+GjlWXGDYee0iUfiZiFBkp8TPUhqrBLQEBHk5WhpZ4YwZTNVG42L+/vymzKNJWGqdcrIsK9XyE7BN0wMvJSj2Lvvz4g1Pu8/ff1LNo+eGnOOUW77lDPYvO3fvI0Lz6ForPQKmuZuFZhtO3XhNlEdHJe8uZlwwHr76F5qOPKPmIqhZB4uMP2HewIogUwMRAJzBq0cBaxMjISJFFFz88OE/YAGYWBg4+YQao2ovkWOTw/e0jvJaBLGHnEWD4+PACA0gtSA/JFgGr5A/4LMNmCVQP6XGEyzJSLSHYCkJqqAgAqQOcwnL6AsC2AUgPKZYQbRG6ZSA+KZaQZBGyZbDEQqwlIAAQYACcTOWIFuSO8AAAAABJRU5ErkJggg\x3d\x3d",
width:26,height:26,yoffset:13,contentType:"image/png"});L.layers[3].applyEdits([new esri.Graphic(I,X,ma)]);ba&&(ba.xoffset=13,ba.yoffset=13,L.layers[2].applyEdits([new esri.Graphic(new esri.geometry.Point(I.toJson()),ba,ta)]))}):(Ea=window.location.href.substring(0,window.location.href.indexOf(window.location.pathname)+window.location.pathname.lastIndexOf("/"))+"/images/EsriBluePinCircle26.png",X=esri.symbol.fromJson({type:"esriPMS",url:Ea,imageData:"iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDMjdDMDU2RTdEM0ExMUUzOTkyRUU3OTg1MDdCQzMzRSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDMjdDMDU2RjdEM0ExMUUzOTkyRUU3OTg1MDdCQzMzRSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMyN0MwNTZDN0QzQTExRTM5OTJFRTc5ODUwN0JDMzNFIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMyN0MwNTZEN0QzQTExRTM5OTJFRTc5ODUwN0JDMzNFIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+aJP1/QAAAeNJREFUeNpi/P//PwM+IOdS4gCkEoA4AIj50aQ/AvEGIF7waE/PAXzmMOKzCGjJBGY2rnxeKQ0GNl5hBiAbRf7vr28Mvz6/Zfj87AaIPRFoWQHJFgEtKWDl4u8XVrNmYGRmRZH79uE1RDMTMwMLGzsDCysbw9tbRxl+f/tYCLRsAjbzmPD4toBfwRDDEmTw/99fht8/gL768Z0BpBakB5daFjwWybNyokYJLycLg6okN8PPLwwMN558YPj87TckCH//ZGAXEGVgYmaVJ8ciFOBjIs5Q6KvEwMMB0fLl+2+GjlWXGDYee0iUfiZiFBkp8TPUhqrBLQEBHk5WhpZ4YwZTNVG42L+/vymzKNJWGqdcrIsK9XyE7BN0wMvJSj2Lvvz4g1Pu8/ff1LNo+eGnOOUW77lDPYvO3fvI0Lz6ForPQKmuZuFZhtO3XhNlEdHJe8uZlwwHr76F5qOPKPmIqhZB4uMP2HewIogUwMRAJzBq0cBaxMjISJFFFz88OE/YAGYWBg4+YQao2ovkWOTw/e0jvJaBLGHnEWD4+PACA0gtSA/JFgGr5A/4LMNmCVQP6XGEyzJSLSHYCkJqqAgAqQOcwnL6AsC2AUgPKZYQbRG6ZSA+KZaQZBGyZbDEQqwlIAAQYACcTOWIFuSO8AAAAABJRU5ErkJggg\x3d\x3d",
width:26,height:26,yoffset:13,contentType:"image/png"}),L.layers[3].applyEdits([new esri.Graphic(I,X,ma)]),ba&&(ba.xoffset=13,ba.yoffset=13,L.layers[2].applyEdits([new esri.Graphic(new esri.geometry.Point(I.toJson()),ba,ta)])))},R,A,B,H));break}}},O,V,N,J,D))}},v,x,y,C,z))},c,t,u,d,h));arcgisonline.map.main.sameSpatialReference(arcgisonline.map.main.map.spatialReference,new esri.SpatialReference({wkid:n}))?w(f,g):arcgisonline.map.main.projectPointToMapSpatialReference(f,g,new esri.SpatialReference({wkid:n}),
e.hitch(this,function(v,x){w(v[0].x,v[0].y)}),e.hitch(this,function(v,x){arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent,fitExtentCompletely)}))}}},cleanUpFailedServices:function(){for(var a=0;0<arcgisonline.map.main.mapLayers.length;){if(null==arcgisonline.map.main.mapLayers[a]){for(k=a;k<arcgisonline.map.main.mapLayers.length-1;k++)arcgisonline.map.main.mapLayers[k]=arcgisonline.map.main.mapLayers[k+1];--arcgisonline.map.main.mapLayers.length}if(a>=arcgisonline.map.main.mapLayers.length-
1)break;a++}},getNewMapExtent:function(a){var c=arcgisonline.map.main.map.getLayer(arcgisonline.map.main.currentBaseService),d=c?new esri.geometry.Extent(arcgisonline.map.main.map.extent.toJson()):arcgisonline.map.main.defaultExtent,h=a.intersects(d);if(h){var f=h.getWidth()*h.getHeight(),g=d.getWidth()*d.getHeight();f<g/200?h=!1:a.getWidth()*a.getHeight()<g/1E3&&(h=!1)}h&&arcgisonline.map.main.mapInitialized?a=arcgisonline.map.main.map.extent&&isNaN(arcgisonline.map.main.map.extent.xmin)?{extent:a,
zoomMap:!0}:{extent:d,zoomMap:!1}:(c?c=c.fullExtent:(h=arcgisonline.map.main.mapLayers[0],c=h.serviceInfo?arcgisonline.map.layer.parseServiceInfo(h.serviceInfo,h.url).extent:h.fullExtent),(h=a.intersects(c))?(arcgisonline.map.main.map&&arcgisonline.map.main.map.wrapAround180||(a.xmin<c.xmin&&(a=a.update(c.xmin,a.ymin,a.xmax,a.ymax,a.spatialReference)),a.xmax>c.xmax&&(a=a.update(a.xmin,a.ymin,c.xmax,a.ymax,a.spatialReference))),a.ymin<c.ymin&&(a=a.update(a.xmin,c.ymin,a.xmax,a.ymax,a.spatialReference)),
a.ymax>c.ymax&&(a=a.update(a.xmin,a.ymin,a.xmax,c.ymax,a.spatialReference)),a={extent:a,zoomMap:!0}):a={extent:d,zoomMap:!1});a.extent=arcgisonline.map.main.fitNewMapExtent(a.extent);return a},fitNewMapExtent:function(a){var c=[102113,102100,3857],d=a.spatialReference.wkid;if(4326!=d&&!e.indexOf(c,d))return a;var h=a;-1<e.indexOf(c,d)&&(h=arcgisonline.map.main.projectGeometries([a],a.spatialReference,new esri.SpatialReference({wkid:4326}))[0]);return-170>h.xmin&&170<h.xmax&&-80>h.ymin&&80<h.ymax?
(a=arcgisonline.map.main.adjustHeightToAspectRatio(a),arcgisonline.map.main.getExtentForNextTileLevel(a,arcgisonline.map.main.map.width,!0)):a},zoomMap:function(a,c,d,h){c=c?c:0;d=d?d:0;var f=e.connect(arcgisonline.map.main.map,"onExtentChange",e.hitch(this,function(){e.disconnect(f);h()})),g=arcgisonline.map.main.getScaleForExtent(a,arcgisonline.map.main.map.width);0<c&&g>c?(a=arcgisonline.map.main.adjustHeightToAspectRatio(a),c=arcgisonline.map.main.getExtentForScale(a,arcgisonline.map.main.map.width,
c),c.getWidth()<a.getWidth()&&(a=c),a=arcgisonline.map.main.getExtentForNextTileLevel(a,arcgisonline.map.main.map.width,!0)):0<d&&g<d&&(a=arcgisonline.map.main.adjustHeightToAspectRatio(a),c=arcgisonline.map.main.getExtentForScale(a,arcgisonline.map.main.map.width,d),c.getWidth()>a.getWidth()&&(a=c),a=arcgisonline.map.main.getExtentForNextTileLevel(a,arcgisonline.map.main.map.width,!1));c=arcgisonline.sharing.util.urlToObject(document.URL);c.query=c.query||{};if(!arcgisonline.map.main.mapInitialized)c.query.layers&&
(a=arcgisonline.map.main.getExtentForNextTileLevel(a,arcgisonline.map.main.map.width,!1)),arcgisonline.map.main.initMap(a);else if(arcgisonline.map.main.isMapFullyLoaded)arcgisonline.map.main.map.setExtent(a);else if(arcgisonline.map.main.isMapFullyLoaded||!c.query.center&&!c.query.extent)var n=0,m=setInterval(function(){arcgisonline.map.main.isMapFullyLoaded&&(clearInterval(m),arcgisonline.map.main.map.setExtent(a));n++;100<n&&clearInterval(m)},100)},projectToMapAndZoom:function(a,c,d,h){if(!a||
isNaN(a.xmin)||isNaN(a.ymin)||isNaN(a.xmax)||isNaN(a.ymax))arcgisonline.map.main.zoomMap(arcgisonline.map.main.defaultExtent,c,d,h);else{var f=arcgisonline.map.main.map.spatialReference;null==f&&(f=arcgisonline.map.main.defaultExtent.spatialReference);arcgisonline.map.main.sameSpatialReference(f,a.spatialReference)?(a=arcgisonline.map.main.getNewMapExtent(a),a.zoomMap?arcgisonline.map.main.zoomMap(a.extent,c,d,h):(arcgisonline.map.main.mapInitialized||arcgisonline.map.main.initMap(),h())):arcgisonline.map.main.projectToMapSpatialReference(a,
e.hitch(this,function(g,n){var m=arcgisonline.map.main.getNewMapExtent(g[0]);m.zoomMap?arcgisonline.map.main.zoomMap(m.extent,c,d,h):(arcgisonline.map.main.mapInitialized||arcgisonline.map.main.initMap(),h())}),e.hitch(this,function(g,n){arcgisonline.map.main.zoomMap(arcgisonline.map.main.defaultExtent,c,d,h)}))}},adjustHeightToAspectRatio:function(a){var c=a.getWidth()*(arcgisonline.map.main.map.height/arcgisonline.map.main.map.width)/5;e.mixin(a,{ymin:a.getCenter().y-c,ymax:a.getCenter().y+c});
return a},getExtentForScale:function(a,c,d){var h=20015077/180,f=esri.config.defaults,g=esri.WKIDUnitConversion,n=a.spatialReference;if(n){var m=n.wkid;var t=n.wkt}n=null;m?n=g.values[g[m]]:t&&-1!==t.search(/^PROJCS/i)&&(g=/UNIT\[([^\]]+)\]\]$/i.exec(t))&&g[1]&&(n=parseFloat(g[1].split(",")[1]));return a.expand(d*c/(39.37*(n||h)*f.screenDPI)/a.getWidth())},getExtentFromCenter:function(a,c,d){a=new esri.geometry.Extent(a.x-1,a.y-.5,a.x+1,a.y+.5,a.spatialReference);return arcgisonline.map.main.getExtentForScale(a,
c,d)},getScaleForExtent:function(a,c){var d=20015077/180,h=esri.config.defaults,f=esri.WKIDUnitConversion,g=a.spatialReference;if(g){var n=g.wkid;var m=g.wkt}g=null;n?g=f.values[f[n]]:m&&-1!==m.search(/^PROJCS/i)&&(f=/UNIT\[([^\]]+)\]\]$/i.exec(m))&&f[1]&&(g=parseFloat(f[1].split(",")[1]));return a.getWidth()/c*(g||d)*39.37*h.screenDPI},getExtentForNextTileLevel:function(a,c,d){if(null!=arcgisonline.map.main.mapLods){c=a.getWidth()/c;for(var h=arcgisonline.map.main.mapLods,f=h[h.length-1].resolution,
g=0;g<h.length;g++)if(h[g].resolution<c){f=d?h[g].resolution:0==g?h[0].resolution:h[g-1].resolution;break}return a.expand(f/c*.9)}return a},getExtentForCloseTileLevel:function(a,c){if(null!=arcgisonline.map.main.mapLods)for(var d=a.getWidth()/c,h=arcgisonline.map.main.mapLods,f=0;f<h.length-1;f++)if(h[f].resolution>d&&h[f+1].resolution<d){var g=(h[f].resolution-h[f+1].resolution)/10;if(h[f].resolution<d+g)return a.expand(h[f].resolution/d*.9);if(h[f+1].resolution>d-g)return a.expand(h[f+1].resolution/
d*.9);break}return a},getIntersectionPercent:function(a,c){var d=new e.Deferred;if(!c)return d.callback(0),d;if(c.spatialReference._isWrappable())esri.geometry.normalizeCentralMeridian([c],null,e.hitch(this,function(g){if(g[0].rings){var n=(new esri.geometry.Polygon(c.spatialReference)).addRing(g[0].rings[0]).getExtent();g=(new esri.geometry.Polygon(c.spatialReference)).addRing(g[0].rings[1]).getExtent();c=n.getWidth()>g.getWidth()?n:g}else c=g[0];(n=c.intersects(a))?(n=n.getWidth()*n.getHeight(),
g=c.getWidth()*c.getHeight(),d.callback(n/g*100)):d.callback(0)}),function(){d.callback(0)});else{var h=c.intersects(a);if(h){h=h.getWidth()*h.getHeight();var f=c.getWidth()*c.getHeight();d.callback(h/f*100)}else d.callback(0)}return d},zoomToLayerScale:function(a){if(a.layers){var c=-1*Number.MAX_VALUE,d=Number.MAX_VALUE;e.forEach(a.layers,e.hitch(this,function(h){var f=h.minScale||0;h=h.maxScale||0;c=0===c||0===f?0:Math.max(c,f);d=Math.min(d,h)}));arcgisonline.map.main.zoomToScale(c,d)}else a.layer&&
arcgisonline.map.main.zoomToScale(a.layer.minScale,a.layer.maxScale)},zoomToScale:function(a,c,d){var h=arcgisonline.map.main.map.getScale();0<a&&h>a?(a=arcgisonline.map.main.getScaleForNextTileLevel(a,!0),d?(c=arcgisonline.map.main.getExtentFromCenter(arcgisonline.map.main.map.extent.getCenter(),arcgisonline.map.main.map.width,a),(c=c.intersects(d))?arcgisonline.map.main.map.setScale(a):(c=arcgisonline.map.main.getExtentFromCenter(d.getCenter(),arcgisonline.map.main.map.width,a),arcgisonline.map.main.map.setExtent(c))):
arcgisonline.map.main.map.setScale(a)):h<c&&(a=arcgisonline.map.main.getScaleForNextTileLevel(c,!1),d?(c=arcgisonline.map.main.getExtentFromCenter(arcgisonline.map.main.map.extent.getCenter(),arcgisonline.map.main.map.width,a),(c=c.intersects(d))?arcgisonline.map.main.map.setScale(a):(c=arcgisonline.map.main.getExtentFromCenter(d.getCenter(),arcgisonline.map.main.map.width,a),arcgisonline.map.main.map.setExtent(c))):arcgisonline.map.main.map.setScale(a))},zoomMapConsiderScale:function(a,c,d){if(a.layers){var h=
-1*Number.MAX_VALUE;var f=Number.MAX_VALUE;e.forEach(a.layers,e.hitch(this,function(g){var n=g.minScale||0;g=g.maxScale||0;h=0===h||0===n?0:Math.max(h,n);f=Math.min(f,g)}))}else a.layer&&(h=a.layer.minScale||0,f=a.layer.maxScale||0,a.layer.dynamicLayerInfos&&arcgisonline.map.main.hasDynamicLayers(a)?(a=arcgisonline.map.dijit.toc.scale.mergeSubLayerScales(a.layer.dynamicLayerInfos,a.layer.layerInfos,a),a=arcgisonline.map.dijit.toc.scale.mergeScale(a.minScale,a.maxScale,h,f),h=a.minScale,f=a.maxScale):
a.layer.layerInfos&&a.layer.layerInfos.length&&(a.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer||a.layer instanceof esri.layers.ArcGISTiledMapServiceLayer)?(a=arcgisonline.map.dijit.toc.scale.mergeSubLayerScales(a.layer.layerInfos,null,a),a=arcgisonline.map.dijit.toc.scale.mergeScale(a.minScale,a.maxScale,h,f),h=a.minScale,f=a.maxScale):a.layer.folders&&(a=arcgisonline.map.dijit.toc.scale.mergeSubLayerScales(a.layer.folders,null,a),a=arcgisonline.map.dijit.toc.scale.mergeScale(a.minScale,
a.maxScale,h,f),h=a.minScale,f=a.maxScale));a=arcgisonline.map.main.map.getScale();0<h&&a>h?(h=arcgisonline.map.main.getScaleForNextTileLevel(h,!0),d=arcgisonline.map.main.adjustHeightToAspectRatio(c),d=arcgisonline.map.main.getExtentForScale(d,arcgisonline.map.main.map.width,h),arcgisonline.map.main.map.setExtent(d)):a<f?(f=arcgisonline.map.main.getScaleForNextTileLevel(f,!1),d=arcgisonline.map.main.adjustHeightToAspectRatio(c),d=arcgisonline.map.main.getExtentForScale(c,arcgisonline.map.main.map.width,
f),arcgisonline.map.main.map.setExtent(d)):d?arcgisonline.map.main.zoomMap(c,h,f,function(){}):(a=arcgisonline.map.main.getNewMapExtent(c),a.zoomMap&&arcgisonline.map.main.zoomMap(c,h,f,function(){}))},getScaleForNextTileLevel:function(a,c){if(null!=arcgisonline.map.main.mapLods){var d=arcgisonline.map.main.mapLods;if(c){for(var h=0;h<d.length;h++)if(d[h].scale<a)return d[h].scale-1;return d[d.length-1].scale-1}for(h=d.length-1;0<=h;h--)if(d[h].scale>a)return d[h].scale+1;return d[0].scale+1}return a},
checkSuggestedScaleRangeAndZoom:function(a){return arcgisonline.map.main.checkSuggestedScaleRange(a,!0)},checkSuggestedScaleRange:function(a,c){var d=new e.Deferred;if(a.layer)arcgisonline.map.main.checkSuggestedScaleRangePerLayer(a.layer,c).then(function(f){a.scaleChanged=!0;if(c){var g=arcgisonline.map.featColl.isFeatureCollection(a)?arcgisonline.map.featColl.getLayerFullExtent(a.layer):new esri.geometry.Extent(a.layer.fullExtent.toJson());arcgisonline.map.main.sameSpatialReference(arcgisonline.map.main.map.spatialReference,
g.spatialReference)?(f.scaleAtFullExtent&&(g=arcgisonline.map.main.getExtentFromCenter(g.getCenter(),arcgisonline.map.main.map.width,f.scaleAtFullExtent)),arcgisonline.map.main.map.setExtent(g)):arcgisonline.map.main.projectToMapSpatialReference(g,e.hitch(this,function(n,m){n&&0<n.length&&n[0]&&"extent"==n[0].type&&(g=n[0],f.scaleAtFullExtent&&(g=arcgisonline.map.main.getExtentFromCenter(g.getCenter(),arcgisonline.map.main.map.width,f.scaleAtFullExtent)),arcgisonline.map.main.map.setExtent(g))}))}d.resolve(f)},
function(){if(c){var f=arcgisonline.map.featColl.isFeatureCollection(a)?arcgisonline.map.featColl.getLayerFullExtent(a.layer):new esri.geometry.Extent(a.layer.fullExtent.toJson());arcgisonline.map.main.zoomMapConsiderScale(a,f)}d.resolve()});else if(a.layers){var h;e.forEach(a.layers,function(f,g){arcgisonline.map.main.checkSuggestedScaleRangePerLayer(f,c).then(function(n){a.scaleChanged=!0;n.scaleAtFullExtent&&(!esri.isDefined(h)||h<n.scaleAtFullExtent)&&(h=n.scaleAtFullExtent);if(g===a.layers.length-
1){if(n&&n.center){var m=arcgisonline.map.featColl.getFullExtent(a);esri.isDefined(h)&&(m=arcgisonline.map.main.getExtentFromCenter(m.getCenter(),arcgisonline.map.main.map.width,h));arcgisonline.map.main.map.setExtent(m)}else a.layer&&(m=arcgisonline.map.featColl.getLayerFullExtent(a.layer),arcgisonline.map.main.zoomMapConsiderScale(a,m));n.scaleAtFullExtent=h;d.resolve(n)}},function(){if(c&&0===g){var n=arcgisonline.map.featColl.getLayerFullExtent(a.layers[0]);arcgisonline.map.main.zoomMapConsiderScale(a,
n)}g===a.layers.length-1&&d.resolve()})})}return d},checkSuggestedScaleRangePerLayer:function(a,c){var d=new e.Deferred;if(!(a instanceof esri.layers.FeatureLayer)||a instanceof esri.layers.StreamLayer)d.reject();else return 0===a.minScale&&0===a.maxScale&&a.addPlugin("esri/plugins/FeatureLayerStatistics").then(e.hitch(this,function(){a.statisticsPlugin.getSuggestedScaleRange({map:arcgisonline.map.main.map}).then(function(h){a.setScaleRange(h.relaxedMinScale,h.maxScale);d.resolve(h)},function(h){d.reject()})})),
d},addLayerFromFile:function(){arcgisonline.map.main.isReadOnlyMode()||arcgisonline.sharing.dijit.dialog.AddLayerFromFileDlg.prototype.statics.getInstance().show()},addLayerFromUrl:function(){arcgisonline.map.main.isReadOnlyMode()||arcgisonline.sharing.dijit.dialog.AddLayerFromUrlDlg.prototype.statics.getInstance().show()},openLeftDefaultPanel:function(){arcgisonline.map.main.isReadOnlyMode()||(arcgisonline.sharing.util.isLoggedIn()&&esriGeowConfig.userRole&&!esriGeowConfig.userRole.canCreateItem()?
arcgisonline.map.leftPanel.openLeftAddContentPanel(null,{forceSection:"myOrganization"}):arcgisonline.map.leftPanel.openLeftAddContentPanel())},browseLayers:function(){arcgisonline.map.main.isReadOnlyMode()||arcgisonline.map.leftPanel.openLeftAddContentPanel(null,{forceSection:"livingAtlas"})},browseProvisionedListings:function(){arcgisonline.map.main.isReadOnlyMode()||arcgisonline.map.leftPanel.openLeftAddContentPanel(null,{forceSection:"subscription"})},requireAuthentication:function(a){if(1==arcgisonline.sharing.util.isLoggedIn())return!0;
arcgisonline.map.storage.saveMapInCookie(a,!0,null,null,e.hitch(this,function(){var c="";-1==esriGeowConfig.signin.indexOf("http")&&(c=esriGeowConfig.baseUrl,!1!==esriGeowConfig.useSSL&&(c=arcgisonline.sharing.util.getSecureUrl(c)));c+=esriGeowConfig.signin;c+="?error\x3d403\x26returnUrl\x3d"+esriGeowConfig.baseUrl+esriGeowConfig.webmapViewerPath+"?useExisting\x3d1";window.location=c}));return!1},signInWithPopup:function(){arcgisonline.map.main.signInWithOAuth().then(function(a){var c=a.reloadRequired,
d=a.oAuthInfo;c&&arcgisonline.map.main.mapHasChanged&&arcgisonline.map.role.isAllowed("tool_save")&&arcgisonline.map.main.appAccess?(arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.viewer.webMap,message:esri.i18nBundle.viewer.main.unsavedChangesDoSave,choiceOneTitle:esri.i18nBundle.viewer.main.unsavedChangesYesBtn,choiceOneHandler:e.hitch(this,function(){var h=arcgisonline.sharing.util.getUser();null==arcgisonline.map.save_open.webMapInfo||arcgisonline.map.save_open.webMapInfo.owner!==
h.username&&"admin"!==arcgisonline.map.save_open.webMapInfo.itemControl&&"update"!==arcgisonline.map.save_open.webMapInfo.itemControl?arcgisonline.map.storage.canSaveWithBing()&&(h=arcgisonline.sharing.dijit.dialog.SaveWebMapDlg.prototype.statics.getInstance(),e.subscribe("onWebMapSave",null,e.hitch(arcgisonline.map.storage,"onWebMapSave")),h.addWebMapItem(arcgisonline.map.main.mapLayers,arcgisonline.map.main.map.extent,arcgisonline.map.save_open.folderId,arcgisonline.map.save_open.webMapInfo,function(f){arcgisonline.map.main.redirectToCustomURL(f,
!1,d)},function(){arcgisonline.map.main.redirectToCustomURL(null,!1,d)})):arcgisonline.map.storage.saveExistingWebMap(null,function(f){arcgisonline.map.main.redirectToCustomURL(f,!1,d)},function(){arcgisonline.map.main.redirectToCustomURL(null,!1,d)})}),choiceTwoTitle:esri.i18nBundle.viewer.main.unsavedChangesNoBtn,choiceTwoHandler:e.hitch(this,function(){arcgisonline.map.main.redirectToCustomURL(null,!1,d)})}),a=esri.i18nBundle.viewer.main.unsavedChangesYesBtn.length+esri.i18nBundle.viewer.main.unsavedChangesNoBtn.length,
e.style(e.byId("choice-dialog"),"width",Math.min(10*a+150,650)+"px")):c&&arcgisonline.map.main.redirectToCustomURL(null,!1,d)});return!1},signInWithPopupAndSave:function(a){if(arcgisonline.sharing.util.isLoggedIn())return arcgisonline.map.storage.saveWebMapClick(a),!0;arcgisonline.map.main.signInWithOAuth().then(e.hitch(this,function(c,d){var h=d.oAuthInfo;if(arcgisonline.map.main.appAccess)if(arcgisonline.map.role.isAllowed("tool_save"))arcgisonline.map.storage.saveWebMapClick(c,function(n){arcgisonline.map.main.redirectToCustomURL(n,
!0,h)},function(){arcgisonline.map.main.redirectToCustomURL(null,!1,h)});else{var f=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();f.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.viewer.error.cannotSaveMap});var g=e.connect(f,"onHide",function(){e.disconnect(g);arcgisonline.map.main.redirectToCustomURL(null,!1,h)})}else arcgisonline.map.main.redirectToCustomURL(null,!1,h)},a));return!1},signInWithOAuth:function(a){var c=new e.Deferred;window.checkOAuthResponse=
e.hitch(arcgisonline.map.main,"checkOAuthResponse");var d=esriGeowConfig.restBaseUrl.substring(0,esriGeowConfig.restBaseUrl.indexOf("/",8)).replace("http://","https://");esriGeowConfig.self.portalHostname&&(d="https://"+esriGeowConfig.self.portalHostname);a=new esri.arcgis.OAuthInfo({appId:"arcgisonline",portalUrl:d,minTimeUntilExpiration:525949,forceLogin:!0,showSocialLogins:!0,locale:e.locale,flowType:"authorization-code",popup:!0,popupCallbackUrl:"viewer_oauth-callback.html",popupWindowFeatures:"height\x3d480,width\x3d800,resizable,scrollbars",
msg:esri.i18nBundle.viewer.main.oAuthSignInMsg});esri.id.registerOAuthInfos([a]);esri.id.useSignInPage=!1;esri.id.getCredential(d+"/sharing",{oAuthPopupConfirmation:!1}).then(function(h){var f=new esri.arcgis.Portal(d);f.signIn().then(function(g){arcgisonline.sharing.geow.Account.setupAfterSelf(f);esri.id.useSignInPage=!0;arcgisonline.sharing.util.parseUrl(d).host===arcgisonline.sharing.util.parseUrl(esriGeowConfig.restBaseUrl).host||esriGeowConfig.self.urlKey&&esriGeowConfig.self.customBaseUrl&&
arcgisonline.sharing.util.parseUrl(esriGeowConfig.restBaseUrl).host===esriGeowConfig.self.urlKey+"."+esriGeowConfig.self.customBaseUrl||(esriGeowConfig.restBaseUrl=esriGeowConfig.restBaseUrl.replace(arcgisonline.sharing.util.parseUrl(esriGeowConfig.restBaseUrl).host,arcgisonline.sharing.util.parseUrl(d).host));e.topic.publish("onSignIn",[esriGeowConfig.userInfo]);var n=!1;g=arcgisonline.sharing.util.parseUrl(document.location.href).host;var m=esriGeowConfig.self;!m.isPortal&&(g===m.portalHostname||
m.urlKey&&m.customBaseUrl&&g!==m.urlKey+"."+m.customBaseUrl||!m.urlKey&&g!==m.portalHostname)&&(m.urlKey&&m.customBaseUrl?-1===g.indexOf(m.urlKey+"."+m.customBaseUrl)&&(n=!0):m.urlKey||(n=!0));!esriGeowConfig.userInfo.token&&esriGeowConfig.userInfo.credential&&(esriGeowConfig.userInfo.token=esriGeowConfig.userInfo.credential.token);var t=function(u){arcgisonline.map.role.clearUserActions();arcgisonline.map.role.setupUserActions();arcgisonline.map.main.loggedIn();arcgisonline.map.main.updateHeaderLinks();
arcgisonline.map.role.updateUserActionWithWebmap();arcgisonline.map.save_open.webMapInfo||arcgisonline.map.save_open.itemCard||arcgisonline.map.leftPanel.recreateAboutStack();e.forEach(arcgisonline.map.main.mapLayers,function(x){x.layer&&x.serviceInfo&&x.serviceInfo.ownershipBasedAccessControlForFeatures&&!1===x.serviceInfo.ownershipBasedAccessControlForFeatures.allowOthersToQuery&&arcgisonline.map.main.reloadFeatureLayer(x)});var v=arcgisonline.sharing.util.getUser();arcgisonline.map.save_open.webMapInfo&&
arcgisonline.map.save_open.webMapInfo.owner!==v.username?arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+"content/items/"+arcgisonline.map.save_open.webMapInfo.id,e.hitch(this,function(x,y){arcgisonline.map.save_open.webMapItemCard=x;arcgisonline.map.save_open.webMapInfo.itemControl=x.itemControl;arcgisonline.map.role.updateUserActionAfterOAuth();u.callback({reloadRequired:n,oAuthInfo:h})}),e.hitch(this,function(x,y){u.callback({reloadRequired:n,oAuthInfo:h})})):(n||("contentStack"==
arcgisonline.map.leftPanel.getLeftContentPanelStack()?leftPanel.reloadVisibleTOC():leftPanel.deleteContentStack()),u.callback({reloadRequired:n,oAuthInfo:h}))},w=arcgisonline.sharing.util.getUser();w.accountId?arcgisonline.map.main.checkAppAccess().then(e.hitch(this,function(){t(c)}),e.hitch(this,function(){if(n)c.callback({reloadRequired:n,oAuthInfo:h});else{arcgisonline.map.main.loggedIn();arcgisonline.map.main.updateHeaderLinks();var u=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();
u.show({title:esri.i18nBundle.viewer.error.notLicensedTitle,message:e.string.substitute(esri.i18nBundle.viewer.error.notLicensed,{username:w.username})});var v=e.aspect.before(u._dialog,"hide",e.hitch(this,function(){v.remove();c.callback({reloadRequired:n,oAuthInfo:h})}))}})):t(c)}).otherwise(function(g){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.viewer.error.cannotSignInOAuth});esri.id.useSignInPage=
!0;c.errback()})}).otherwise(function(h){"ABORTED"!==h.message&&(arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.viewer.error.cannotSignInOAuth}),c.errback())});return c},checkOAuthResponse:function(a){},redirectToCustomURL:function(a,c,d){d=esriGeowConfig.self;c=document.location.href;a?c=esriGeowConfig.baseUrl+esriGeowConfig.webmapViewerPath+"?webmap\x3d"+a:-1<c.indexOf("useExisting\x3d1")&&
(a=arcgisonline.map.save_open.webMapInfo?arcgisonline.map.save_open.webMapInfo.id:null)&&(c=esriGeowConfig.baseUrl+esriGeowConfig.webmapViewerPath+"?webmap\x3d"+a);a=arcgisonline.sharing.util.parseUrl(c).host;!d.isPortal&&(a===d.portalHostname||d.urlKey&&d.customBaseUrl&&a!==d.urlKey+"."+d.customBaseUrl||!d.urlKey&&a!==d.portalHostname)&&(d.urlKey&&d.customBaseUrl?-1===a.indexOf(d.urlKey+"."+d.customBaseUrl)&&(arcgisonline.map.storage.deleteMapStorageNoFeedback(),c=c.replace(a,d.urlKey+"."+d.customBaseUrl)):
d.urlKey||(arcgisonline.map.storage.deleteMapStorageNoFeedback(),c=c.replace(a,d.portalHostname)));c=d.allSSL?c.replace("http:","https:"):c;a=esriGeowConfig.self.user.culture&&e.locale!==esriGeowConfig.self.user.culture;if(c!==document.location.href||a)arcgisonline.sharing.util.parseUrl(c).host!==arcgisonline.sharing.util.parseUrl(document.location.href).host||a?window.location=c:"undefined"!==typeof history.pushState?window.history.pushState(null,null,c):window.location.href!==c&&(window.location=
c)},getBridgeUrl:function(a,c){if(esriGeowConfig.self.isPortal)return a;var d=esriGeowConfig.bridgeUrl+"?url\x3d"+encodeURIComponent(a);d=d.replace("http:","https:");return c&&c.expires?d+"\x26exp\x3d"+Math.ceil((new Date(c.expires)-new Date)/1E3):d},checkAppAccess:function(){var a=new e.Deferred;isEmbedded?(arcgisonline.map.main.appAccess=!0,a.callback()):esri.isDefined(arcgisonline.map.main.appAccess)?arcgisonline.map.main.appAccess?a.callback():a.errback():esri.id.checkAppAccess(esriGeowConfig.restBaseUrl,
"arcgisWebApps").then(e.hitch(this,function(){arcgisonline.map.main.appAccess=!0;a.callback()}),e.hitch(this,function(){arcgisonline.map.main.appAccess=!1;a.errback()}));return a},checkAccessToViewer:function(){var a=arcgisonline.sharing.util.getUser();if(a&&a.accountId){var c=arcgisonline.sharing.util.urlToObject(document.URL);!c.query||c.query.layers||c.query.webmap?esri.isDefined(arcgisonline.map.main.appAccess)||arcgisonline.map.main.checkAppAccess():arcgisonline.map.main.checkAppAccess().then(e.hitch(this,
function(){}),e.hitch(this,function(){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.viewer.error.notLicensedTitle,message:e.string.substitute(esri.i18nBundle.viewer.error.notLicensed,{username:a.username})})}))}else arcgisonline.map.main.appAccess=!0},linkToMap:function(a){arcgisonline.map.main.onShareStatusChangeHandler||(arcgisonline.map.main.onShareStatusChangeHandler=e.subscribe("onShareStatusChange",e.hitch(this,function(g){arcgisonline.map.save_open.webMapItemCard.access=
g.access})));if(null==arcgisonline.map.save_open.webMapInfo){var c=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();c.show({title:esri.i18nBundle.sharingDlg.sharingDlgTitle,message:esri.i18nBundle.viewer.error.cantShare})}else{var d=!1;arcgisonline.map.main.mapLayers[0].layer instanceof esri.virtualearth.VETiledLayer&&(d=!0);var h=!1;arcgisonline.map.save_open.openedWebMap&&arcgisonline.map.save_open.openedWebMap.presentation&&arcgisonline.map.save_open.openedWebMap.presentation.slides&&
0<arcgisonline.map.save_open.openedWebMap.presentation.slides.length&&(h=!0);var f=!1;e.forEach(arcgisonline.map.main.mapLayers,function(g){g.itemCard&&(-1<e.indexOf(g.itemCard.typeKeywords,"Requires Credits")||-1<e.indexOf(g.itemCard.typeKeywords,"Requires Subscription"))&&(f=!0)});c=arcgisonline.sharing.util.getUser();!c||arcgisonline.map.save_open.webMapInfo.owner!==c.username&&"admin"!==arcgisonline.map.save_open.webMapInfo.itemControl&&"update"!==arcgisonline.map.save_open.webMapInfo.itemControl?
(c=arcgisonline.sharing.dijit.dialog.ShareMapDlg.prototype.statics.getInstance(),c.show(arcgisonline.map.save_open.webMapInfo.id,arcgisonline.map.save_open.webMapInfo.owner,arcgisonline.map.save_open.folderId,arcgisonline.map.save_open.webMapInfo.title,d,h,a,f)):null==arcgisonline.map.save_open.folderTitle?arcgisonline.map.storage.getItemFolder(e.hitch(this,function(g,n){arcgisonline.sharing.dijit.dialog.ShareMapDlg.prototype.statics.getInstance().show(arcgisonline.map.save_open.webMapInfo.id,arcgisonline.map.save_open.webMapInfo.owner,
arcgisonline.map.save_open.folderId,arcgisonline.map.save_open.webMapInfo.title,d,h,a,f)})):(c=arcgisonline.sharing.dijit.dialog.ShareMapDlg.prototype.statics.getInstance(),c.show(arcgisonline.map.save_open.webMapInfo.id,arcgisonline.map.save_open.webMapInfo.owner,arcgisonline.map.save_open.folderId,arcgisonline.map.save_open.webMapInfo.title,d,h,a,f))}},projectToMapSpatialReference:function(a,c,d){var h=arcgisonline.map.main.map.spatialReference;null==h&&(h=arcgisonline.map.main.defaultExtent.spatialReference);
arcgisonline.map.main.projectExtent(a,h,c,d)},projectWrapAroundExtent:function(a,c,d,h){var f=a.spatialReference.wkid,g=c.wkid;(f||g)&&f!==g||arcgisonline.map.main.doProject(a,c,d,h);var n=f&&4326==f,m=g&&4326==g,t=[102113,102100,3857];f=f&&arcgisonline.map.main.contains(t,f);g=g&&arcgisonline.map.main.contains(t,g);n||f||!m&&!g?arcgisonline.map.main.doProject(a,c,d,h):arcgisonline.map.main.doProjectWrapAround(a,c,d,h)},doProjectWrapAround:function(a,c,d,h){arcgisonline.map.main.geometryService||
(arcgisonline.map.main.geometryService=new esri.tasks.GeometryService(esriGeowConfig.self.helperServices.geometry.url));var f=new esri.geometry.Polygon(a.spatialReference.toJson());f.addRing([[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]);arcgisonline.map.main.geometryService.project([f],c,function(g,n){var m=g[0];if(m.rings&&2!==m.rings.length)d([m.getExtent()],n);else if(m.rings&&2==m.rings.length){var t=new esri.geometry.Polygon(m.toJson());m.removeRing(1);t.removeRing(0);
m=m.getExtent();t=t.getExtent();m.getWidth()>t.getWidth()?(m.xmin<t.xmin?m.xmin-=t.getWidth():m.xmax+=t.getWidth(),d([m],n)):(t.xmin<m.xmin?t.xmin-=m.getWidth():t.xmax+=m.getWidth(),d([t],n))}else h&&h()},h)},projectExtent:function(a,c,d,h){arcgisonline.map.main.doProject(a,c,d,h)},projectPointToMapSpatialReference:function(a,c,d,h,f){var g=arcgisonline.map.main.map.spatialReference;null==g&&(g=arcgisonline.map.main.defaultExtent.spatialReference);a=new esri.geometry.Point(a,c,d);arcgisonline.map.main.doProject(a,
g,h,f)},doProject:function(a,c,d,h){var f=[102113,102100,3857];if(a.spatialReference.wkid===c.wkid)d([a],null);else if(null!=a.spatialReference.wkid&&4326==a.spatialReference.wkid&&null!=c.wkid&&arcgisonline.map.main.contains(f,c.wkid)){a.ymin=Math.max(a.ymin,-89.99);a.ymax=Math.min(a.ymax,89.99);a=esri.geometry.geographicToWebMercator(a);if((f=a.spatialReference._getInfo())&&a.xmin>a.xmax){var g=f.valid[1]-a.xmin,n=a.xmax-f.valid[0];g>n?a.xmax=f.valid[1]+n:a.xmin=f.valid[0]-g}a.spatialReference.wkid=
c.wkid;d([a],null)}else if(null!=a.spatialReference.wkid&&arcgisonline.map.main.contains(f,a.spatialReference.wkid)&&null!=c.wkid&&4326==c.wkid)a=esri.geometry.webMercatorToGeographic(a),(f=a.spatialReference._getInfo())&&a.xmin>a.xmax&&(g=f.valid[1]-a.xmin,n=a.xmax-f.valid[0],g>n?a.xmax=f.valid[1]+n:a.xmin=f.valid[0]-g),d([a],null);else{arcgisonline.map.main.geometryService||(arcgisonline.map.main.geometryService=new esri.tasks.GeometryService(esriGeowConfig.self.helperServices.geometry.url));if(arcgisonline.map.main.map&&
arcgisonline.map.main.map.wrapAround180&&"extent"===a.type){var m=a;a=esri.geometry.Polygon.fromExtent(a)}arcgisonline.map.main.geometryService.project([a],c,function(t,w){if(!(t&&0<t.length&&t[0]&&"extent"==t[0].type)||isNaN(t[0].xmin)||isNaN(t[0].ymin)||isNaN(t[0].xmax)||isNaN(t[0].ymax))if(t&&0<t.length&&t[0]&&"point"==t[0].type&&!isNaN(t[0].x)&&!isNaN(t[0].y))d(t,w);else if(m&&"polygon"===t[0].type&&0<t[0].rings.length&&t[0].rings[0]){if(1===t[0].rings.length)t[0]=new esri.geometry.Extent(t[0].getExtent());
else{var u=(new esri.geometry.Polygon(t[0].spatialReference.toJson())).addRing(t[0].rings[0]).getExtent(),v=(new esri.geometry.Polygon(t[0].spatialReference.toJson())).addRing(t[0].rings[1]).getExtent();t[0]=v;t[0].xmin=v.xmin-u.getWidth();t[0].ymin=Math.min(v.ymin,u.ymin);t[0].ymax=Math.max(v.ymax,u.ymax)}d(t,w)}else"polygon"===t[0].type&&0<t[0].rings.length&&t[0].rings[0]?d(t,w):h&&h();else d(t,w)},h)}},projectJsonGeometries:function(a,c,d,h,f,g){0===a.length&&f(null);var n=esri.geometry.getGeometryType(c),
m=[];e.forEach(a,function(t){t=new n(t);t.spatialReference=d;m.push(t)},this);c=[102113,102100,3857];d.wkid&&4326==d.wkid&&h.wkid&&arcgisonline.map.main.contains(c,h.wkid)?(e.forEach(m,function(t){t.xmin?(t.xmin=Math.max(t.xmin,-180),t.xmax=Math.min(t.xmax,180),t.ymin=Math.max(t.ymin,-89.99),t.ymax=Math.min(t.ymax,89.99)):t.rings?e.forEach(t.rings,function(w){e.forEach(w,function(u){u[0]=Math.min(Math.max(u[0],-180),180);u[1]=Math.min(Math.max(u[1],-89.99),89.99)},this)},this):t.paths?e.forEach(t.paths,
function(w){e.forEach(w,function(u){u[0]=Math.min(Math.max(u[0],-180),180);u[1]=Math.min(Math.max(u[1],-89.99),89.99)},this)},this):t.x&&(t.x=Math.min(Math.max(t.x,-180),180),t.y=Math.min(Math.max(t.y,-89.99),89.99))},this),a=[],e.forEach(m,function(t){t=esri.geometry.geographicToWebMercator(t);102100!==h.wkid&&(t.spatialReference=h);a.push(t.toJson())},this),f(a)):null!=d.wkid&&arcgisonline.map.main.contains(c,d.wkid)&&null!=h.wkid&&4326==h.wkid?(a=[],e.forEach(m,function(t){a.push(esri.geometry.webMercatorToGeographic(t).toJson())},
this),f(a)):(arcgisonline.map.main.geometryService||(arcgisonline.map.main.geometryService=new esri.tasks.GeometryService(esriGeowConfig.self.helperServices.geometry.url)),arcgisonline.map.main.geometryService.project(m,h,e.hitch(this,function(t,w){t&&t.length===a.length?(a=[],e.forEach(t,function(u){u&&(u.rings&&0<u.rings.length&&0<u.rings[0].length&&0<u.rings[0][0].length&&!isNaN(u.rings[0][0][0])&&!isNaN(u.rings[0][0][1])||u.paths&&0<u.paths.length&&0<u.paths[0].length&&0<u.paths[0][0].length&&
!isNaN(u.paths[0][0][0])&&!isNaN(u.paths[0][0][1])||u.xmin&&!isNaN(u.xmin)&&u.ymin&&!isNaN(u.ymin)||u.x&&!isNaN(u.x)&&u.y&&!isNaN(u.y))?a.push(u.toJson()):a.push(null)},this),f(a)):g&&g(t,w)}),g))},projectGeometries:function(a,c,d,h,f){if(0===a.length)if(h)h(null);else return null;var g=[102113,102100,3857];if(c.wkid&&4326==c.wkid&&d.wkid&&arcgisonline.map.main.contains(g,d.wkid)){e.forEach(a,function(m){m.xmin?(m.xmin=Math.max(m.xmin,-180),m.xmax=Math.min(m.xmax,180),m.ymin=Math.max(m.ymin,-89.99),
m.ymax=Math.min(m.ymax,89.99)):m.rings?e.forEach(m.rings,function(t){e.forEach(t,function(w){w[0]=Math.min(Math.max(w[0],-180),180);w[1]=Math.min(Math.max(w[1],-89.99),89.99)},this)},this):m.paths?e.forEach(m.paths,function(t){e.forEach(t,function(w){w[0]=Math.min(Math.max(w[0],-180),180);w[1]=Math.min(Math.max(w[1],-89.99),89.99)},this)},this):m.x&&(m.x=Math.min(Math.max(m.x,-180),180),m.y=Math.min(Math.max(m.y,-89.99),89.99))},this);var n=[];e.forEach(a,function(m){m=esri.geometry.geographicToWebMercator(m);
102100!==d.wkid&&(m.spatialReference=d);n.push(m)},this);if(h)h(n);else return n}else if(null!=c.wkid&&arcgisonline.map.main.contains(g,c.wkid)&&null!=d.wkid&&4326==d.wkid)if(n=[],e.forEach(a,function(m){n.push(esri.geometry.webMercatorToGeographic(m))},this),h)h(n);else return n;else arcgisonline.map.main.geometryService||(arcgisonline.map.main.geometryService=new esri.tasks.GeometryService(esriGeowConfig.self.helperServices.geometry.url)),arcgisonline.map.main.geometryService.project(a,d,e.hitch(this,
function(m,t,w){if(t&&t.length===m.length){var u=[];e.forEach(t,function(v){v&&(v.rings&&0<v.rings.length&&0<v.rings[0].length&&0<v.rings[0][0].length&&!isNaN(v.rings[0][0][0])&&!isNaN(v.rings[0][0][1])||v.paths&&0<v.paths.length&&0<v.paths[0].length&&0<v.paths[0][0].length&&!isNaN(v.paths[0][0][0])&&!isNaN(v.paths[0][0][1])||v.xmin&&!isNaN(v.xmin)&&v.ymin&&!isNaN(v.ymin)||v.x&&!isNaN(v.x)&&v.y&&!isNaN(v.y))?u.push(v):u.push(null)},this);h&&h(u)}else f&&f&&f(t,w)},a),f)},clipOnHorizon:function(a){arcgisonline.map.main.contains([102113,
102100,3857],a.spatialReference.wkid)&&(a.xmin=Math.max(a.xmin,-20037507),a.xmax=Math.min(a.xmax,20037507),a.ymin=Math.max(a.ymin,-19971868),a.ymax=Math.min(a.ymax,19971868));return a},sameSpatialReference:function(a,c){var d=[102113,102100,3857];return a&&c&&esri.isDefined(a.wkid)&&esri.isDefined(c.wkid)&&arcgisonline.map.main.contains(d,a.wkid)&&arcgisonline.map.main.contains(d,c.wkid)||a&&c&&(esri.isDefined(a.wkid)&&esri.isDefined(c.wkid)&&a.wkid==c.wkid||esri.isDefined(a.latestWkid)&&esri.isDefined(c.wkid)&&
a.latestWkid==c.wkid||esri.isDefined(a.wkid)&&esri.isDefined(c.latestWkid)&&a.wkid==c.latestWkid||esri.isDefined(a.latestWkid)&&esri.isDefined(c.latestWkid)&&a.latestWkid==c.latestWkid)||a&&c&&esri.isDefined(a.wkt)&&esri.isDefined(c.wkt)&&a.wkt===c.wkt?!0:!1},sameTilingScheme:function(a,c){var d=arcgisonline.map.main.map;d=d.width>d.height?d.width:d.height;for(var h=!1,f=!1,g=0;g<a.lods.length;g++){var n=a.lods[g].scale;a.dpi!==c.dpi&&(n=a.lods[g].scale/a.dpi);for(var m=0;m<c.lods.length;m++){var t=
c.lods[m].scale;a.dpi!==c.dpi&&(t=c.lods[m].scale/c.dpi);if(Math.abs(t-n)/t<1/d)if(h){f=!0;break}else h=!0;if(t<n)break}if(f)break}return f||h&&(1===a.lods.length||1===c.lods.length)?!0:!1},sameTilingSchemeUseResolution:function(a,c){for(var d=!1,h=!1,f=0;f<a.lods.length;f++){for(var g=a.lods[f].resolution,n=0;n<c.lods.length;n++){var m=c.lods[n].resolution;if(.01>Math.abs(m-g)/m)if(d){h=!0;break}else d=!0}if(h)break}return h||d&&(1===a.lods.length||1===c.lods.length)?!0:!1},checkMapSpatialReference:function(){var a=
!1,c=!1;if(arcgisonline.map.main.map)var d=arcgisonline.map.main.map.spatialReference;else d=new esri.SpatialReference({wkid:102100}),(a=esriGeowConfig.defaultBasemap.baseMapLayers)&&a.resourceInfo&&a.resourceInfo.spatialReference&&(d=new esri.SpatialReference(a.resourceInfo.spatialReference));a=e.some(arcgisonline.map.wms._WEB_MERCATOR,function(h){return h===d.wkid});c=4326===d.wkid;return{mapIsWebMercator:a,mapIsGCS:c,mapSR:d}},updateTilingScheme:function(a,c){if(a.dpi===c)return a;for(var d=0;d<
a.lods.length;d++)a.lods[d].scale=a.lods[d].scale/a.dpi*c;a.dpi=c;return a},markMapAsChanged:function(a){arcgisonline.map.main.mapHasChanged=!0},markMapAsChangedIfOwner:function(a){a=arcgisonline.sharing.util.getUser();var c=arcgisonline.map.save_open.webMapInfo;a&&c&&(c.owner===a.username||"admin"===c.itemControl||"update"===c.itemControl)&&(arcgisonline.map.main.mapHasChanged=!0)},unmarkMapAsChanged:function(){arcgisonline.map.main.mapHasChanged=!1},signIn:function(a){a&&a.preventDefault();arcgisonline.map.storage.saveMapInCookie(null,
!0,null,null,function(){arcgisonline.map.main.signInWithPopup()})},loggedOut:function(){var a=arcgisonline.sharing.util.getUser();esriGeowConfig.self&&esriGeowConfig.self.isWebTierAuth?a||"7443"===location.port||e.style(e.byId("header_map_signin"),"display","none"):(e.removeClass(e.byId("logged-out-navigation"),"hide"),e.addClass(e.byId("logged-in-navigation"),"hide"),e.connect(e.byId("login-link"),"onclick",e.hitch(arcgisonline.map.main,"signIn")),e.query(".menu-logged-in",this.domNode).style("display",
"none"))},loggedIn:function(){var a=arcgisonline.sharing.util.getUser();esriGeowConfig.self&&esriGeowConfig.self.isWebTierAuth&&(e.style(e.byId("logged-in-signOut"),"display","none"),a&&(a.username=a.username||a.email));if(arcgisonline.sharing.util.isLoggedIn()){if(a){e.addClass(e.byId("logged-out-navigation"),"hide");e.removeClass(e.byId("logged-in-navigation"),"hide");e.attr(e.byId("username"),"innerHTML",arcgisonline.sharing.util.getUserDisplayName(a));e.attr(e.byId("username"),"title",a.fullName);
e.byId("logged-in-myProfile").innerHTML=esri.i18nBundle.siteHeader.myProfile+"\x3cbr/\x3e"+a.username;e.attr("logged-in-myProfile","title",a.fullName);a=this.allSSL||arcgisonline.sharing.util.usePortalSSL()?arcgisonline.sharing.util.getSecureUrl(esriGeowConfig.restBaseUrl):esriGeowConfig.restBaseUrl;var c=esriGeowConfig.userInfo.credential&&esriGeowConfig.userInfo.credential.token||esriGeowConfig.userInfo.token;a=esriGeowConfig.userInfo.thumbnail?a+"community/users/"+esriGeowConfig.userInfo.username+
"/info/"+esriGeowConfig.userInfo.thumbnail+"?token\x3d"+c:arcgisonline.sharing.util.relativeToExplicitUrl("js/arcgisonline/css/images/no-user-thumb.jpg");e.attr("dropdown-image","src",a);e.attr("profileImgSmall","src",a);e.query(".menu-logged-in").style("visibility","visible")}else arcgisonline.map.main.loggedOut();arcgisonline.map.main.checkTitleDiv()}else arcgisonline.map.main.loggedOut()},logOut:function(){if(arcgisonline.sharing.util.isPortal()){var a=esriGeowConfig.baseUrl+"index.html";arcgisonline.sharing.geow.Geow.signout(a)}else a=
esriGeowConfig.baseUrl+"pages/Account/manage_accounts.html#client_id\x3darcgisonline\x26signout\x3dtrue",window.location=a},openHelp:function(){var a=esriGeowConfig.help;arcgisonline.sharing.util.isPortal()&&!arcgisonline.sharing.util.isArcGISEnterpriseOnKubernetes()&&(a+="portal/");window.open(a,"_blank")},openNewMap:function(a){a&&a.preventDefault();a=esriGeowConfig.baseUrl+"webmap/viewer.html";1==arcgisonline.map.main.mapHasChanged?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(a,
null,arcgisonline.map.main.mapLayers,arcgisonline.map.main.mapTables,arcgisonline.map.save_open.webMapInfo?arcgisonline.map.save_open.webMapInfo.title:null):window.location=a},openMap:function(a){a&&a.preventDefault();a=esriGeowConfig.baseUrl+"webmap/viewer.html";1==arcgisonline.map.main.mapHasChanged?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(a,null,arcgisonline.map.main.mapLayers,arcgisonline.map.main.mapTables,arcgisonline.map.save_open.webMapInfo?arcgisonline.map.save_open.webMapInfo.title:
null):window.location=a},goToPage:function(a){arcgisonline.map.edit.editActivated&&arcgisonline.map.edit.stopEdit();arcgisonline.map.storage.saveMapInCookie(null,!0,null,null,e.hitch(this,function(){"undefined"!==typeof history.pushState&&window.history.pushState(null,null,"?useExisting\x3d1");window.location=a}))},updateHeaderPresentationLink:function(){e.style(e.byId("header_map_presentation"),"display","none");if(!arcgisonline.sharing.util.isPortal()){var a=arcgisonline.map.save_open.openedWebMap,
c=arcgisonline.map.save_open.webMapInfo,d=arcgisonline.sharing.util.getUser();if(a&&c&&d){var h=!1;a.presentation&&a.presentation.slides&&0<a.presentation.slides.length&&(h=!0);a=!1;c.owner===d.username&&(a=!0);h?(a?(e.byId("presentationLabel").innerHTML=esri.i18nBundle.siteHeader.editPresentation,c=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/presentation/index.html?webmap\x3d"+c.id+"\x26builder",e.connect(e.byId("webmap-presentation"),"onclick",
e.hitch(this,function(f,g){g&&g.preventDefault();1==arcgisonline.map.main.mapHasChanged?arcgisonline.sharing.dijit.dialog.OpenPresentationDlg.prototype.statics.getInstance().show(f):arcgisonline.map.main.goToPage(f)},c))):(e.byId("presentationLabel").innerHTML=esri.i18nBundle.siteHeader.viewPresentation,c=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/presentation/index.html?webmap\x3d"+c.id,e.byId("webmap-presentation").href="#",e.connect(e.byId("webmap-presentation"),
"onclick",e.hitch(this,function(f,g){g&&g.preventDefault();window.open(f)},c))),e.style(e.byId("header_map_presentation"),"display","")):arcgisonline.map.role.isAllowed("about_savePresentation")&&a&&(e.byId("presentationLabel").innerHTML=esri.i18nBundle.siteHeader.createPresentation,c=window.location.protocol+"//"+window.location.host+arcgisonline.sharing.util.getHomeAppContext()+"/apps/presentation/index.html?webmap\x3d"+c.id+"\x26builder",e.connect(e.byId("webmap-presentation"),"onclick",e.hitch(this,
function(f,g){g&&g.preventDefault();1==arcgisonline.map.main.mapHasChanged?arcgisonline.sharing.dijit.dialog.OpenPresentationDlg.prototype.statics.getInstance().show(f):arcgisonline.map.main.goToPage(f)},c)),e.style(e.byId("header_map_presentation"),"display",""))}arcgisonline.map.main.updateRecentWebMaps()}},checkReadOnly:function(){arcgisonline.map.main.isReadOnlyMode()&&(U.byId("webmap-analysis").dropDown?(e.connect(U.byId("webmap-analysis"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),
e.connect(U.byId("webmap-analysis-analysis"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(U.byId("webmap-analysis-history"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow"))):e.connect(U.byId("webmap-analysis"),"onMouseDown",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(U.byId("webmap-edit"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(U.byId("webmap-save"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),
e.connect(U.byId("webmap-save-save"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(U.byId("webmap-save-saveas"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(U.byId("webmap-share"),"onMouseDown",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(U.byId("webmap-add"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(U.byId("webmap-search-layers"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(U.byId("webmap-add-esri-maplayers"),
"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(U.byId("webmap-add-provisionedListings"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(U.byId("webmap-add-layer-url"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(U.byId("webmap-add-layer-file"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(U.byId("webmap-add-mapnotes"),"onClick",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")),e.connect(U.byId("webmap-directions"),
"onMouseDown",e.hitch(arcgisonline.map.main,"readOnlyDontAllow")))},readOnlyDontAllow:function(a){a.stopImmediatePropagation&&a.stopImmediatePropagation();a.stopPropagation&&a.stopPropagation();arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.common.errors.portalInReadOnlyModeMsg})},isReadOnlyMode:function(){return arcgisonline.sharing.util.isPortal()&&!0===esriGeowConfig.self.isReadOnly},checkMinWidthOfPage:function(){U.byId("webmap-save").set("label",
esri.i18nBundle.viewer.saveBtn);U.byId("webmap-print").set("label",esri.i18nBundle.viewer.printBtn);U.byId("webmap-print-templates").set("label",esri.i18nBundle.viewer.printBtn);U.byId("webmap-measure").set("label",esri.i18nBundle.viewer.measureBtn);U.byId("webmap-bookmarks").set("label",esri.i18nBundle.viewer.bookmarksBtn);U.byId("webmap-directions").set("label",esri.i18nBundle.viewer.directionsBtn);U.byId("webmap-share").set("label",esri.i18nBundle.viewer.shareBtn);U.byId("webmap-basemap").set("label",
esri.i18nBundle.viewer.basemapBtn);U.byId("webmap-add").set("label",esri.i18nBundle.viewer.addBtn);U.byId("webmap-details").set("label",esri.i18nBundle.viewer.detailsBtn);U.byId("webmap-edit").set("label",esri.i18nBundle.viewer.editBtn);U.byId("webmap-analysis").set("label",esri.i18nBundle.viewer.analysisBtn);U.byId("webmap-analysis").set("title",esri.i18nBundle.viewer.analysisBtnHover);esriGeowConfig.showAnalysisHistory&&(U.byId("webmap-analysis-analysis").set("label",esri.i18nBundle.viewer.analysisBtn),
U.byId("webmap-analysis-history").set("label",esri.i18nBundle.viewer.analysisHistory));if(!e.isIE||9<=e.isIE)e.byId("webmap-save_label").style.removeProperty("padding"),e.byId("webmap-add_label").style.removeProperty("padding"),e.byId("webmap-print-templates_label").style.removeProperty("padding");var a=function(){var g=e.coords(e.byId("webmap-toolbar-leftCorner")).w,n=e.coords(e.byId("webmap-toolbar-rightCorner")).w,m=e.coords(e.byId("webmap-toolbar-right")).w,t=e.coords(e.byId("webmap-toolbar-left")).w,
w=e.style(e.byId("webmap-save"),"width"),u=e.style(e.byId("webmap-share"),"width");var v="none"!==e.style(U.byId("webmap-print").domNode,"display")?e.style(e.byId("webmap-print"),"width"):e.style(e.byId("webmap-print-templates"),"width");var x=e.style(e.byId("webmap-directions"),"width"),y=e.style(e.byId("webmap-measure"),"width"),C=e.style(e.byId("webmap-bookmarks"),"width");w=w+u+v+x+y+C+75;u=e.style(e.byId("toolbar"),esriGeowConfig.isRightToLeft?"right":"left");v=0;"auto"!==e.style(e.byId("toolbar"),
esriGeowConfig.isRightToLeft?"left":"right")&&(esriGeowConfig.isRightToLeft?u=parseInt(e.style(e.byId("toolbar"),"left")):v=parseInt(e.style(e.byId("toolbar"),"right")));return Math.max(400,u+g+t+w+m+n+v)+15},c=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||600,d=56;arcgisonline.map.geocode.geocoder&&arcgisonline.map.geocode.geocoder.sources&&1<arcgisonline.map.geocode.geocoder.sources.length&&(d+=26);if(e.query(".searchGroup","locationDiv").length){var h=250,
f=e.query(".searchGroup","locationDiv")[0];e.style(e.query(".searchGroup input","locationDiv")[0],"width",h-d+"px");e.style(f,"width",h+"px");e.style(e.query(".webmapToolbarRight")[0],"width",h+10+"px");f.style.display="none";f.offsetHeight;f.style.display="block"}h=function(g){9>e.isIE&&(g=e.create("div",{innerHTML:"x",style:"visibility: hidden; height: 1px;"}),e.place(g,"webmap-toolbar-center","first"),setTimeout(e.hitch(this,function(n){e.byId("webmap-toolbar-center").removeChild(n)},g),1))};f=
a();c<f&&("none"!==e.style(U.byId("webmap-print").domNode,"display")?(U.byId("webmap-print").set("label",""),h("webmap-print")):(U.byId("webmap-print-templates").set("label",""),e.style(e.byId("webmap-print-templates_label"),"padding",0),h("webmap-print-templates")),f=a(),c<f&&(U.byId("webmap-save").set("label",""),e.style(e.byId("webmap-save_label"),"padding",0),h("webmap-save"),f=a(),c<f&&(U.byId("webmap-measure").set("label",""),h("webmap-measure"),f=a(),c<f&&(U.byId("webmap-bookmarks").set("label",
""),h("webmap-bookmarks"),f=a(),c<f&&(U.byId("webmap-directions").set("label",""),h("webmap-directions"),f=a(),c<f&&(U.byId("webmap-share").set("label",""),h("webmap-share"),f=a(),c<f&&(U.byId("webmap-basemap").set("label",""),h("webmap-basemap"),f=a(),c<f&&(U.byId("webmap-add").set("label",""),e.style(e.byId("webmap-add_label"),"padding",0),h("webmap-add"),f=a(),c<f&&(U.byId("webmap-details").set("label",""),h("webmap-details"),f=a(),c<f&&(U.byId("webmap-edit").set("label",""),h("webmap-edit"),f=
a(),c<f&&(U.byId("webmap-analysis").set("label",""),h("webmap-analysis"),f=a())))))))))));e.query(".searchGroup","locationDiv").length&&(h=250,150<c-f?h=400:100<c-f?h=350:50<c-f&&(h=300),e.style(e.query(".searchGroup input","locationDiv")[0],"width",h-d+"px"),e.style(e.query(".searchGroup","locationDiv")[0],"width",h+"px"),e.style(e.query(".webmapToolbarRight")[0],"width",h+10+"px"),f=a());e.style(e.byId("page-border"),"minWidth")!=f&&e.style(e.byId("page-border"),"minWidth",f+"px");e.style(e.byId("webmap-toolbar-center"),
"visibility","visible");arcgisonline.map.leftPanel.calculateLeftPanelDefaultWidth();e.style(e.byId("main-content"),"width",c+"px");U.byId("page-border").resize();arcgisonline.map.main.checkTitleDiv()},checkUnsupportedRendererType:function(a){var c={type:"simple",symbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,255,255,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}}};9>e.isIE&&(a.layerDefinition&&a.layerDefinition.drawingInfo&&
a.layerDefinition.drawingInfo.renderer&&"heatmap"===a.layerDefinition.drawingInfo.renderer.type?a.layerDefinition.drawingInfo.renderer=c:!(a.layerDefinition&&a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer)&&a.serviceInfo&&a.serviceInfo.drawingInfo&&a.serviceInfo.drawingInfo.renderer&&"heatmap"===a.serviceInfo.drawingInfo.renderer.type&&(a.serviceInfo.drawingInfo.renderer=c))},isNewRendererType_2_1:function(a){if(a.layer&&a.layer.renderer){var c=a.layer.renderer;if("esri.renderer.UniqueValueRenderer"==
c.declaredClass&&a.layer.fields&&c.attributeField){a=a.layer.fields;for(var d=0;d<a.length;d++)if(a[d].name===c.attributeField)if("esriFieldTypeDate"!==a[d].type&&(!c.visualVariables||c.visualVariables&&1===c.visualVariables.length&&"sizeInfo"===c.visualVariables[0].type&&"outline"===c.visualVariables[0].target))break;else return!0}else if("esri.renderer.HeatmapRenderer"==c.declaredClass||c.visualVariables)return"esri.renderer.HeatmapRenderer"!==c.declaredClass&&1===c.visualVariables.length&&"sizeInfo"===
c.visualVariables[0].type&&"outline"===c.visualVariables[0].target?!1:!0}return!1},reloadViewerSecureIdMgr:function(a){arcgisonline.map.main.reloadViewerSecure(a.resourceUrl,esri.i18nBundle.viewer.main.reloadForSSLLogin)},reloadViewerSecureSSL:function(a){arcgisonline.map.main.reloadViewerSecure(a,esri.i18nBundle.viewer.main.reloadForSSL)},reloadViewerSecure:function(a,c){if(arcgisonline.map.main.mapHasChanged){var d=function(){window.location=esriGeowConfig.baseUrl.replace("http://","https://")+
esriGeowConfig.webmapViewerPath+"?useExisting\x3d1"},h=function(){arcgisonline.map.storage.saveMapInCookie(null,!0,null,null,e.hitch(this,d))},f=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance();f.show({title:esri.i18nBundle.viewer.main.reload,message:c,choiceOneTitle:esri.i18nBundle.common.yesLabel,choiceOneHandler:e.hitch(this,h),choiceTwoTitle:esri.i18nBundle.common.noLabel,choiceTwoHandler:function(){}})}else h=arcgisonline.sharing.util.urlToObject(document.URL),h.query=
h.query||{},h.query.webmap||h.query.layers||h.query.services||h.query.featurecollection||h.query.url||h.query.urls||h.query.basemapUrl?window.location=window.location.href.replace("http://","https://"):(h=function(){window.location=document.URL.replace("http://","https://")},f=arcgisonline.sharing.dijit.dialog.ChoiceDlg.prototype.statics.getInstance(),f.show({title:esri.i18nBundle.viewer.main.reload,message:c,choiceOneTitle:esri.i18nBundle.common.yesLabel,choiceOneHandler:e.hitch(this,h),choiceTwoTitle:esri.i18nBundle.common.noLabel,
choiceTwoHandler:function(){}}))},showBasemapGallery:function(){arcgisonline.map.main.hideDropdowns("basemapGallery");U.byId("basemap-gallery").groupQuery=esriGeowConfig.self.useVectorBasemaps?encodeURIComponent(esriGeowConfig.self.vectorBasemapGalleryGroupQuery):encodeURIComponent(esriGeowConfig.basemapGalleryGroupQuery);U.byId("basemap-gallery").open()},showMeasureTool:function(){arcgisonline.map.popup.disablePopupHandler();e.byId("measureToolDiv")||e.place(e.create("div",{id:"measureToolDiv"}),
"measureDiv","last");if("block"==e.style(e.byId("measureDiv"),"display"))arcgisonline.map.main.hideMeasureTool();else{arcgisonline.map.main.hideDropdowns();arcgisonline.map.main.map.infoWindow.hide();var a=e.coords(e.byId("webmap-measure"));esriGeowConfig.isRightToLeft?e.style(e.byId("measureDiv"),"left",a.x+a.w-318+"px"):e.style(e.byId("measureDiv"),"left",a.x-4+"px");e.style(e.byId("measureDiv"),"display","block");e.style(e.byId("measureDiv"),"top",a.y+a.h+3+"px");arcgisonline.map.main.measureTool||
(a=esri.symbol.fromJson({name:"Circle",type:"esriSMS",style:"esriSMSCircle",color:[255,255,255,204],size:6,outline:{color:[102,102,102,255],width:1}}),arcgisonline.map.main.measureTool=new esri.dijit.Measurement({map:arcgisonline.map.main.map,id:"measureTool",pointSymbol:a,defaultAreaUnit:"english"===arcgisonline.map.main.scaleBarUnits?esri.Units.SQUARE_MILES:esri.Units.SQUARE_KILOMETERS,defaultLengthUnit:"english"===arcgisonline.map.main.scaleBarUnits?esri.Units.MILES:esri.Units.KILOMETERS},"measureToolDiv"),
arcgisonline.map.main.measureTool.startup());arcgisonline.map.main.measureTool.setTool("area",!0);arcgisonline.map.main.measureActivated=!0;arcgisonline.map.geocodeReview.geocodeMatchWidget&&arcgisonline.map.geocodeReview.geocodeMatchWidget.pauseMapEvents();arcgisonline.map.main.map.activeDirectionsWidget&&arcgisonline.map.main.map.activeDirectionsWidget.active?(arcgisonline.map.main.activeDirectionsWidgetIsActive=!0,arcgisonline.map.main.map.activeDirectionsWidget.deactivate()):arcgisonline.map.main.activeDirectionsWidgetIsActive=
!1}},hideMeasureTool:function(a){arcgisonline.map.main.measureTool&&(arcgisonline.map.main.measureTool.clearResult(),e.style(e.byId("measureDiv"),"display","none"),arcgisonline.map.main.measureTool.activeTool&&arcgisonline.map.main.measureTool.setTool(arcgisonline.map.main.measureTool.activeTool,!1),arcgisonline.map.main.measureActivated=!1,arcgisonline.map.popup.setupPopupHandler(),arcgisonline.map.geocodeReview.geocodeMatchWidget&&"geocodeStack"===arcgisonline.map.leftPanel.getLeftContentPanelStack()&&
arcgisonline.map.geocodeReview.geocodeMatchWidget.resumeMapEvents(),arcgisonline.map.main.map.activeDirectionsWidget&&"directionsStack"==arcgisonline.map.leftPanel.getLeftContentPanelStack()&&arcgisonline.map.main.activeDirectionsWidgetIsActive&&arcgisonline.map.main.map.activeDirectionsWidget.activate(),"closeIcon"!==a&&"onOtherOpen"!==a||U.byId("webmap-measure").set("checked",!1))},destroyMeasureTool:function(a){arcgisonline.map.main.measureTool&&(arcgisonline.map.main.measureTool.destroy(),arcgisonline.map.main.measureTool=
null)},initBookmarks:function(){if(!arcgisonline.map.main.bookmarksTool){var a=[];arcgisonline.map.save_open.openedWebMap&&arcgisonline.map.save_open.openedWebMap.bookmarks&&(a=arcgisonline.map.save_open.openedWebMap.bookmarks);arcgisonline.map.main.bookmarksTool=new esri.dijit.Bookmarks({map:arcgisonline.map.main.map,bookmarks:a,editable:!0,id:"bookmarksTool"},"bookmarksToolDiv");arcgisonline.map.role.checkBookmarksToolOptions();e.connect(arcgisonline.map.main.bookmarksTool,"onClick",e.hitch(this,
arcgisonline.map.main.hideBookmarksTool,"onBookmarkClick"));e.connect(arcgisonline.map.main.bookmarksTool,"onEdit",function(){arcgisonline.map.main.markMapAsChanged("onBookmarkEdit")});e.connect(arcgisonline.map.main.bookmarksTool,"onRemove",function(){arcgisonline.map.main.markMapAsChanged("onBookmarkRemove")})}},showBookmarksTool:function(){if("block"==e.style(e.byId("bookmarksDiv"),"display"))arcgisonline.map.main.hideBookmarksTool();else{arcgisonline.map.main.hideDropdowns();var a=e.coords(e.byId("webmap-bookmarks"));
esriGeowConfig.isRightToLeft?e.style(e.byId("bookmarksDiv"),"left",a.x+a.w-242+"px"):e.style(e.byId("bookmarksDiv"),"left",a.x-4+"px");e.style(e.byId("bookmarksDiv"),"display","block");e.style(e.byId("bookmarksDiv"),"top",a.y+a.h+3+"px")}},hideBookmarksTool:function(a){e.style(e.byId("bookmarksDiv"),"display","none");"closeIcon"!==a&&"onBookmarkClick"!==a&&"onOtherOpen"!==a||U.byId("webmap-bookmarks").set("checked",!1)},projectBookmarks:function(){if(arcgisonline.map.main.bookmarksTool&&0<arcgisonline.map.main.bookmarksTool.bookmarks.length){var a=
arcgisonline.map.main.map.extent.spatialReference,c=arcgisonline.map.main.bookmarksTool.bookmarks[0].extent.spatialReference;if(!arcgisonline.map.main.sameSpatialReference(a,c)){var d=function(g){var n=[];e.forEach(arcgisonline.map.main.bookmarksTool.bookmarks,function(w,u){if(null!==g[u]){var v=new esri.dijit.BookmarkItem({name:w.name,extent:g[u]});n.push(v)}});for(var m=arcgisonline.map.main.bookmarksTool.bookmarks.length-1;0<=m;m--){var t=arcgisonline.map.main.bookmarksTool.bookmarks[m];t&&arcgisonline.map.main.bookmarksTool.removeBookmark(t.name)}e.forEach(n,
function(w){arcgisonline.map.main.bookmarksTool.addBookmark(w)})},h=function(g,n){},f=[];e.forEach(arcgisonline.map.main.bookmarksTool.bookmarks,function(g){f.push(g.extent)});arcgisonline.map.main.projectGeometries(f,c,a,e.hitch(this,d),e.hitch(this,function(g,n,m,t,w){arcgisonline.map.main.projectGeometries(g,n,m,e.hitch(this,d),e.hitch(this,h))},f,c,a))}}},hideDropdowns:function(a){"basemapGallery"!=a&&U.byId("basemap-gallery").hide();"block"==e.style(e.byId("bookmarksDiv"),"display")&&arcgisonline.map.main.hideBookmarksTool("onOtherOpen");
"block"==e.style(e.byId("measureDiv"),"display")&&arcgisonline.map.main.hideMeasureTool("onOtherOpen")},truncate:function(a){return Math.round(1E4*a)/1E4},getValue:function(a,c){var d=a.indexOf("\x26"+c+"\x3d",0);-1==d&&(d=a.indexOf("?"+c+"\x3d",0));if(-1==d)return-1;var h=a.indexOf("\x26",d+2);-1==h&&(h=a.length);return a.substring(d+c.length+2,h)},showObjectProperties:function(a){var c="",d;for(d in a)c+=d+":"+a[d]+"\n";alert(""+c)},getGCSString:function(){var a=new e.Deferred,c=arcgisonline.map.main.map.extent;
c.spatialReference._isWrappable()?esri.geometry.normalizeCentralMeridian([c],null,e.hitch(this,function(d){if(d[0].rings){var h=(new esri.geometry.Polygon(c.spatialReference)).addRing(d[0].rings[0]).getExtent();d=(new esri.geometry.Polygon(c.spatialReference)).addRing(d[0].rings[1]).getExtent();c=h.getWidth()>d.getWidth()?h:d}else c=d[0];arcgisonline.map.main.extentToGCSString(c,function(f){a.callback(f)})})):arcgisonline.map.main.mapExtentToGCSString(function(d){a.callback(d)});return a},mapExtentToGCSString:function(a){arcgisonline.map.main.extentToGCSString(arcgisonline.map.main.map.extent,
a)},extentToGCSString:function(a,c){arcgisonline.map.main.sameSpatialReference(a.spatialReference,new esri.SpatialReference({wkid:4326}))?c(arcgisonline.map.main.extentToString(a)):arcgisonline.map.main.projectExtent(a,new esri.SpatialReference({wkid:4326}),e.hitch(this,function(d,h){if(-180===d[0].xmin&&180===d[0].xmax){var f=arcgisonline.map.main.checkMapSpatialReference();if(f.mapIsWebMercator||f.mapIsGCS)c(arcgisonline.map.main.extentToString(d[0]));else if(a.spatialReference.wkid&&-1<e.indexOf([5936,
3031],a.spatialReference.wkid))c(arcgisonline.map.main.extentToString(d[0]));else{f=(d[0].ymin+d[0].ymax)/2;var g=[];g.push(new esri.geometry.Point(-180,f,new esri.SpatialReference({wkid:4326})));g.push(new esri.geometry.Point(180,f,new esri.SpatialReference({wkid:4326})));var n=function(m,t){c(arcgisonline.map.main.extentToString(d[0]))};arcgisonline.map.main.projectJsonGeometries(g,"esriGeometryPoint",new esri.SpatialReference({wkid:4326}),a.spatialReference,e.hitch(this,function(m,t){if(.001>Math.abs(m[0].x-
m[1].x)){var w=m[0].x-arcgisonline.map.main.map.extent.xmin,u=arcgisonline.map.main.map.extent.xmax-m[0].x,v=(a.ymin+a.ymax)/2;g=[];g.push(new esri.geometry.Point(a.xmin,v,a.spatialReference));g.push(new esri.geometry.Point(a.xmax,v,a.spatialReference));arcgisonline.map.main.projectJsonGeometries(g,"esriGeometryPoint",a.spatialReference,new esri.SpatialReference({wkid:4326}),e.hitch(this,function(x,y){var C=w>u?new esri.geometry.Extent(x[0].x,d[0].ymin,d[0].xmax,d[0].ymax,new esri.SpatialReference({wkid:4326})):
new esri.geometry.Extent(d[0].xmin,d[0].ymin,x[1].x,d[0].ymax,new esri.SpatialReference({wkid:4326}));c(arcgisonline.map.main.extentToString(C))}),e.hitch(this,n))}else c(arcgisonline.map.main.extentToString(d[0]))}),e.hitch(this,n))}}else c(arcgisonline.map.main.extentToString(d[0]))}),e.hitch(this,function(d,h){c(null)}))},extentToString:function(a){return arcgisonline.map.main.extentToString2(a,1E4)},extentToString2:function(a,c){return null!=a?arcgisonline.map.main.roundValue(a.xmin,c)+","+arcgisonline.map.main.roundValue(a.ymin,
c)+","+arcgisonline.map.main.roundValue(a.xmax,c)+","+arcgisonline.map.main.roundValue(a.ymax,c):""},roundExtent:function(a,c){return new esri.geometry.Extent(arcgisonline.map.main.roundValue(a.xmin,c),arcgisonline.map.main.roundValue(a.ymin,c),arcgisonline.map.main.roundValue(a.xmax,c),arcgisonline.map.main.roundValue(a.ymax,c),new esri.SpatialReference(a.spatialReference.toJson()))},buildExportCall:function(a,c,d,h,f,g,n,m,t){if(!m&&-1<a.indexOf("/MapServer/")){g=a.indexOf("/MapServer/");m=a.indexOf("?");
if(-1<m){var w=a.substring(g+11,m);a=a.substring(0,g+10)+a.substring(m)}else w=a.substring(g+11),a=a.substring(0,g+10);m=w}w=-1<a.indexOf("/MapServer");!w&&t&&(w=t.capabilities?-1<t.capabilities.toLowerCase().indexOf("map"):t.supportedImageFormatTypes);g=a.indexOf("?");if(-1==g)if(w)a+="/export?";else{if("undefined"!==typeof t.currentVersion&&10.1<=t.currentVersion)return a+"/info/thumbnail";a+="/exportImage?"}else if(w)a=a.substring(0,g)+"/export"+a.substring(g,a.length)+"\x26";else{if("undefined"!==
typeof t.currentVersion&&10.1<=t.currentVersion)return a=a.substring(0,g)+"/info/thumbnail"+a.substring(g,a.length);a=a.substring(0,g)+"/exportImage"+a.substring(g,a.length)+"\x26"}a+="size\x3d"+f+"\x26bbox\x3d"+c;null!==d&&0<d.length&&(a+="\x26bboxSR\x3d"+d);null!==h&&0<h.length&&(a+="\x26imageSR\x3d"+h);a=w&&t&&t.supportedImageFormatTypes&&-1<t.supportedImageFormatTypes.indexOf("PNG32")?a+("\x26format\x3dpng32\x26f\x3d"+n):w?a+("\x26format\x3dpng24\x26f\x3d"+n):a+("\x26format\x3djpgpng\x26f\x3d"+
n);w?null!==m&&0<m.length&&(a+="\x26layers\x3dshow:"+m):a+="\x26interpolation\x3dRSP_NearestNeighbor\x26bandIds\x3dnull";return a},getPrintExtra:function(a,c,d,h){a=-1<a.indexOf("/MapServer");!a&&h&&(a=h.capabilities?-1<h.capabilities.toLowerCase().indexOf("map"):h.supportedImageFormatTypes);var f="";a?null!=d&&0<d.length&&(f+="\x26layers\x3dshow:"+d):(f+="\x26pixelType\x3dU8\x26interpolation\x3dRSP_NearestNeighbor",null!=c?f+="\x26bandIds\x3d"+c.toString():h&&h.bandCount&&3<parseInt(h.bandCount)&&
(f+="\x26bandIds\x3d0,1,2"));return f},buildExportLayers:function(a){var c=a.layer.layerInfos;arcgisonline.map.main.hasDynamicLayers(a)&&(c=a.itemLayers);return arcgisonline.map.main.filterSubLayers(c,a.visibleLayers)},buildExportLayersByServiceInfo:function(a,c){return arcgisonline.map.main.filterSubLayers(a.layers,c)},filterSubLayers:function(a,c){if(null==a||null==c||0==c.length)return[];for(var d=","+c+",",h=[],f=",",g=0;g<a.length;g++)if(null!=a[g].subLayerIds){if(-1==d.indexOf(","+a[g].id+",")||
-1<f.indexOf(","+a[g].id+","))f+=a[g].subLayerIds.toString()+","}else-1<d.indexOf(","+a[g].id+",")&&-1==f.indexOf(","+a[g].id+",")&&h.push(a[g].id);return h},addGroupLayers:function(a,c){if(null==a||null==c||0==c.length)return[];var d=function(t,w){for(var u=0;u<t.length;u++)if(t[u].id===w)return{parentLayerId:t[u].parentLayerId,subLayerIds:t[u].subLayerIds};return{parentLayerId:-1,subLayerIds:null}},h=[];""!==c&&(h=c.split(","));h=e.map(h,function(t){return parseInt(t)});for(var f=[],g=0;g<h.length;g++){var n=
h[g];-1==e.indexOf(f,n)&&f.push(n);n=d(a,n);for(var m=n.parentLayerId;-1<m;)-1==e.indexOf(f,m)&&f.push(m),m=d(a,m).parentLayerId;(n=n.subLayerIds)&&n.length&&e.forEach(n,function(t){-1==e.indexOf(h,t)&&h.push(t)})}f=f.sort(function(t,w){return t==w?0:t<w?-1:1});return f.toString()},getParameterList:function(a){for(var c=0;c<arcgisonline.map.main.mapLayers.length;c++){var d=arcgisonline.map.main.mapLayers[c];if(d.layers)for(var h=0;h<d.layers.length;h++){if(a.id==d.layers[h].id)return d}else{if(a.id==
d.id)return d;if(d.layer instanceof esri.layers.GeoRSSLayer){var f=d.layer.getFeatureLayers();for(h=0;h<f.length;h++)if(a.id==f[h].id)return d}}}return null},getParameterListById:function(a){for(var c=0;c<arcgisonline.map.main.mapLayers.length;c++){var d=arcgisonline.map.main.mapLayers[c];if(a==d.id)return d}for(c=0;c<arcgisonline.map.main.mapTables.length;c++)if(d=arcgisonline.map.main.mapTables[c],a==d.id)return d;return null},getParameterListsByUrl:function(a){for(var c=[],d=0;d<arcgisonline.map.main.mapLayers.length;d++){var h=
arcgisonline.map.main.mapLayers[d];a==h.url&&c.push(h)}for(d=0;d<arcgisonline.map.main.mapTables.length;d++)h=arcgisonline.map.main.mapTables[d],a==h.url&&c.push(h);return c.length?c:null},isWebMapLayer:function(a){var c=!1,d=arcgisonline.map.save_open.openedWebMap;d&&(e.forEach(d.operationalLayers,function(h){h.id===a.id&&(c=!0)}),e.forEach(d.baseMap.baseMapLayers,function(h){h.id===a.id&&(c=!0)}));return c},hasMSForFS:function(a){if(!a.url)return!1;var c=a.url,d=c.indexOf("/FeatureServer");if(-1<
d&&a.serviceInfo.capabilities&&-1<a.serviceInfo.capabilities.toLowerCase().indexOf("editing")&&(!a.serviceInfo.advancedQueryCapabilities||!a.serviceInfo.advancedQueryCapabilities.supportsLod))for(c=c.substring(0,d+1),d=0;d<arcgisonline.map.main.mapLayers.length;d++){var h=arcgisonline.map.main.mapLayers[d];if(h.url&&-1<h.url.indexOf(c)&&-1<h.url.indexOf("/MapServer")&&h.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer)return a.showLegend=!1,!0}return!1},getMSForFS:function(a){if(a.url){var c=
a.url,d=c.indexOf("/FeatureServer");if(-1<d&&a.serviceInfo.capabilities&&-1<a.serviceInfo.capabilities.toLowerCase().indexOf("editing")&&(!a.serviceInfo.advancedQueryCapabilities||!a.serviceInfo.advancedQueryCapabilities.supportsLod))for(a=c.substring(0,d+1),c=0;c<arcgisonline.map.main.mapLayers.length;c++)if(d=arcgisonline.map.main.mapLayers[c],d.url&&-1<d.url.indexOf(a)&&-1<d.url.indexOf("/MapServer")&&d.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer)return d}},recreateFLsForMS:function(a,
c){if(a.url){var d=a.url,h=d.indexOf("/MapServer");if(-1<h)for(d=d.substring(0,h+1),h=0;h<arcgisonline.map.main.mapLayers.length;h++){var f=arcgisonline.map.main.mapLayers[h];!(f.url&&-1<f.url.indexOf(d)&&-1<f.url.indexOf("/FeatureServer/")&&f.layer&&f.layer.isEditable())||f.serviceInfo.advancedQueryCapabilities&&f.serviceInfo.advancedQueryCapabilities.supportsLod||f.layer.mode===c||(arcgisonline.map.layer.recreateFL(f,c),c===esri.layers.FeatureLayer.MODE_SELECTION?f.showLegend=!1:delete f.showLegend)}}},
switchFlsForMS:function(a){if(a.url){var c=a.url,d=c.indexOf("/MapServer");if(-1<d&&a.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer){c=c.substring(0,d+1);for(var h=0;h<arcgisonline.map.main.mapLayers.length;h++){var f=arcgisonline.map.main.mapLayers[h];if(f.url&&-1<f.url.indexOf(c)&&-1<f.url.indexOf("/FeatureServer/")&&f.layer&&f.layer instanceof esri.layers.FeatureLayer&&f.layer.mode===esri.layers.FeatureLayer.MODE_SELECTION)if(a.layer.visible){d=f.url.indexOf("/FeatureServer/");var g=
f.url.indexOf("?");-1==g&&(g=f.url.lengthl);d=f.url.substring(d+15,g);-1<e.indexOf(a.layer.visibleLayers,d)?f.layer.show():f.layer.hide()}else f.layer.hide()}}}},getFlForMSL:function(a,c){if(a.url){var d=a.url,h=d.indexOf("/MapServer");if(-1<h&&a.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer)for(d=d.substring(0,h+1),h=0;h<arcgisonline.map.main.mapLayers.length;h++){var f=arcgisonline.map.main.mapLayers[h];if(f.url&&-1<f.url.indexOf(d+"FeatureServer/"+c)&&f.layer&&f.layer.mode===esri.layers.FeatureLayer.MODE_SELECTION)return f}return null}},
hasMSaFl:function(a){if(a.url){var c=a.url,d=c.indexOf("/MapServer");if(-1<d&&a.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer)for(a=c.substring(0,d+1),c=0;c<arcgisonline.map.main.mapLayers.length;c++)if(d=arcgisonline.map.main.mapLayers[c],d.url&&-1<d.url.indexOf(a)&&-1<d.url.indexOf("/FeatureServer/")&&d.layer&&d.layer.mode===esri.layers.FeatureLayer.MODE_SELECTION)return!0;return!1}},containsLayerInfo:function(a,c){for(var d=0;d<a.layers.length;d++)if(a.layers[d]&&a.layers[d].id===c)return a.layers[d];
return null},getLayerInfoForQuery:function(a,c,d){var h=new e.Deferred;if(arcgisonline.map.featColl.isFeatureCollection(a)&&a.layer instanceof esri.layers.WMSLayer)return h.errback(),h;var f=!1;if(a.queryServiceUrl)if(a.queryLayersInfo)if("Table"===a.layer.type){var g=a.url.toLowerCase().indexOf("/mapserver/");-1<g&&(c=parseInt(a.url.substring(g+11)));e.forEach(a.queryLayersInfo.tables,function(t){t.id===c&&(t.url=a.queryServiceUrl,h.callback(t))})}else e.forEach(a.queryLayersInfo.layers,function(t){t.id===
c&&(t.url=a.queryServiceUrl,h.callback(t))});else g=function(t,w){if("Table"===a.layer.type){var u=a.url.toLowerCase().indexOf("/mapserver/");-1<u&&(c=parseInt(a.url.substring(u+11)));e.forEach(a.queryLayersInfo.tables,function(v){v.id===c&&(v.url=a.queryServiceUrl,h.callback(v))})}else e.forEach(a.queryLayersInfo.layers,function(v){v.id===c&&(v.url=a.queryServiceUrl,h.callback(v))})},arcgisonline.map.main.getQueryLayersInfo(a,e.hitch(this,g));else!a.identify&&a.layer instanceof esri.layers.ArcGISTiledMapServiceLayer&&
a.itemLayers&&e.forEach(a.itemLayers,function(t){if(t.id===c)if(t._layerInfo)f=!0,a.layersInfo=a.layersInfo||{},a.layersInfo.layers=a.layersInfo.layers||[],a.layersInfo.layers[c]||(a.layersInfo.layers[c]=t._layerInfo),t._layerInfo.url=t.layerUrl,h.callback(t._layerInfo);else if(t.layerUrl){f=!0;var w=!1,u;a.layersInfo&&a.layersInfo.layers&&(w=e.some(a.layersInfo.layers,function(v){u=v;return v.id===t.id}));w?(u.url=t.layerUrl,h.callback(u)):arcgisonline.map.main.getJson(t.layerUrl,e.hitch(this,function(v,
x){a.layersInfo=a.layersInfo||{};a.layersInfo.layers=a.layersInfo.layers||[];t._layerInfo=v;v.tileSvcLayerId=t.id;a.layersInfo.layers.push(v);v.url=t.layerUrl;h.callback(v)}),e.hitch(this,function(v,x){h.errback()}))}},this);if(!a.queryServiceUrl&&!f)if(a.layer){g=!1;var n=arcgisonline.map.main.getFlForMSL(a,c);if(n)return g=!0,m=n.serviceInfo,m.url=n.layer.url,h.callback(m),h;if(a.layersInfo&&(a.layersInfo.layers||a.layersInfo.tables)){var m=arcgisonline.map.main.containsLayerInfo(a.layersInfo,c);
m&&(g=!0,m.url=a.layer.url,h.callback(m))}g||(10.01<=a.layer.version&&a.itemId&&(a.layer instanceof esri.layers.ArcGISTiledMapServiceLayer||a.layer instanceof esri.layers.FeatureLayer&&"Table"===a.layer.type)&&(arcgisonline.sharing.util.isHostedService(a.url)||arcgisonline.sharing.util.portalSupportsHostedServices()&&-1<e.indexOf(a.itemCard.typeKeywords,"Hosted Service"))?arcgisonline.map.main.getServiceToServiceFS(a,function(){var t=function(w,u){if("Table"===a.layer.type){var v=a.url.toLowerCase().indexOf("/mapserver/");
-1<v&&(c=parseInt(a.url.substring(v+11)));e.forEach(a.queryLayersInfo.tables,function(x){x.id===c&&(x.url=a.layer.url,h.callback(x))})}else e.forEach(a.queryLayersInfo.layers,function(x){x.id===c&&(x.url=a.layer.url,h.callback(x))})};a.queryLayersInfo?t():arcgisonline.map.main.getQueryLayersInfo(a,e.hitch(this,t),e.hitch(this,function(){h.errback()}))},function(){h.errback()}):10<=a.layer.version?a.layersInfo||a.thematicGroup?(d=function(t,w,u){e.filter(a.layersInfo.layers,function(v){return v.id===
c}).length||a.layersInfo.layers.push(w);w.url=t;h.callback(w)},n=function(t,w){h.errback()},m=a.url,g=m.indexOf("?"),m=-1==g?m+("/"+c):m.substring(0,g)+"/"+c+layersUrl.substring(g,layersUrl.length),arcgisonline.map.main.getJson(m,e.hitch(this,d,m),e.hitch(this,n))):a.layer.capabilities.toLowerCase&&-1===a.layer.capabilities.toLowerCase().indexOf("query")?(a.layersInfo={},a.layersInfo.layers=[],h.errback()):(g=function(t,w){e.forEach(a.layersInfo.layers,function(u){u.id===c&&(u.url=a.layer.url,h.callback(u))})},
arcgisonline.map.main.getLayersInfo(a,e.hitch(this,g))):!a.identify||d?h.errback():(d=function(t,w,u){a.layersInfo=a.layersInfo||{};a.layersInfo.layers=a.layersInfo.layers||[];a.layersInfo.layers.push(w);e.forEach(a.layersInfo.layers,function(v){v.id===c&&(v.url=t,h.callback(v))})},n=function(t,w){h.errback()},m=a.url,g=m.indexOf("?"),m=-1==g?m+("/"+c):m.substring(0,g)+"/"+c+layersUrl.substring(g,layersUrl.length),arcgisonline.map.main.getJson(m,e.hitch(this,d,m),e.hitch(this,n))))}else h.errback();
return h},getLayerInfoForQueryFromUrl:function(a,c,d,h){if(c&&c.capabilities&&-1<c.capabilities.toLowerCase().indexOf("map"))if(-1===c.capabilities.toLowerCase().indexOf("query"))h({layers:[]});else{var f=a;a=f.indexOf("?");f=-1==a?f+"/layers":f.substring(0,a)+"/layers"+f.substring(a,f.length);arcgisonline.map.main.getJson(f,e.hitch(this,function(g,n){h(g)}))}else c=a,a=c.indexOf("?"),c=-1==a?c+("/"+d):c.substring(0,a)+"/"+d+f.substring(a,f.length),arcgisonline.map.main.getJson(c,e.hitch(this,function(g,
n){var m={layers:[]};m.layers.push(g);h&&h(m)}),e.hitch(this,function(g,n){h({layers:[]})}))},getLayersInfo:function(a,c){if(a.layersInfo)c(a.layersInfo);else if(!a.layer||10>a.layer.version||a.thematicGroup)a.layersInfo={layers:[]},c(a.layersInfo);else if(a.layersInfoInProgress)setTimeout(e.hitch(this,function(f,g){arcgisonline.map.main.getLayersInfo(f,g)},a,c),500);else{a.layersInfoInProgress=!0;var d=a.url,h=d.indexOf("?");d=-1==h?d+"/layers":d.substring(0,h)+"/layers"+d.substring(h,d.length);
arcgisonline.map.main.getJson(d,e.hitch(this,function(f,g){delete a.layersInfoInProgress;a.layersInfo=f;c(f)}),e.hitch(this,function(){delete a.layersInfoInProgress;a.layersInfo={layers:[]};c(a.layersInfo)}))}},getQueryLayersInfo:function(a,c,d){d=function(g,n){d()};var h=a.queryServiceUrl,f=h.indexOf("?");h=-1==f?h+"/layers":h.substring(0,f)+"/layers"+h.substring(f,h.length);arcgisonline.map.main.getJson(h,e.hitch(this,function(g,n){a.queryLayersInfo=g;c(g,n)}),e.hitch(this,d))},getLayerInfo:function(a,
c){var d=new e.Deferred,h=null;a.itemLayers&&e.forEach(a.itemLayers,function(w){w.id===c&&w.layerUrl&&(h=w)});if(h){var f=function(w,u,v){a.layersInfo=a.layersInfo||{};a.layersInfo.layers=a.layersInfo.layers||[];a.layersInfo.layers.push(v);w._layerInfo=v;u.callback(v)},g=function(w,u){delete h.layerUrl;w.errback(Error("Query layer not accessible."))},n=!1;arcgisonline.sharing.util.getUser()||(n=!0);arcgisonline.map.layer.getServiceInfo(h.layerUrl,null,e.hitch(this,f,h,d),e.hitch(this,g,d),n)}else if(a.layersInfo&&
a.layersInfo.layers&&!arcgisonline.sharing.util.isHostedService(a.url)){var m=!1;e.forEach(a.layersInfo.layers,function(w){w.id===c&&(d.callback(w),m=!0)});if(!m){f=function(w,u){a.layersInfo=a.layersInfo||{layers:[]};e.filter(a.layersInfo.layers,function(v){return v.id===c}).length||a.layersInfo.layers.push(u);w.callback(u)};g=function(w,u){w.errback(u)};n=a.url;var t=n.indexOf("?");n=-1==t?n+("/"+c):n.substring(0,t)+"/"+c+n.substring(t,n.length);arcgisonline.map.layer.getServiceInfo(n,null,e.hitch(this,
f,d),e.hitch(this,g,d))}}else d.errback();return d},getItemWithId:function(a,c){var d;e.forEach(a,function(h){h&&h.id===c&&(d=h)});return d},getItemWithSourceMapLayerId:function(a,c){var d;e.forEach(a,function(h){h&&h.layerDefinition&&h.layerDefinition.source&&h.layerDefinition.source.mapLayerId===c&&(d=h)});return d},getServiceToServiceFS:function(a,c,d){a.noQueryServiceUrl?d&&d():a.queryServiceUrlProcessing?setTimeout(e.hitch(arcgisonline.map.main,"getServiceToServiceFS",a,c,d),500):a.queryServiceUrl?
c():(a.queryServiceUrlProcessing=!0,arcgisonline.sharing.util.getJson(esriGeowConfig.restBaseUrl+"content/items/"+a.itemId+"/relatedItems?relationshipType\x3dService2Service\x26direction\x3dreverse",e.hitch(this,function(h){h&&h.total&&e.forEach(h.relatedItems,function(f){"Feature Service"===f.type&&(a.queryServiceUrl=f.url,!esriGeowConfig.allSSL&&"https:"!=location.protocol||!arcgisonline.sharing.util.isHostedService(a.queryServiceUrl)&&!arcgisonline.sharing.util.supportsHttps(a.queryServiceUrl)||
(a.queryServiceUrl=a.queryServiceUrl.replace("http:","https:")),a.queryServiceItemId=f.id,delete a.queryServiceUrlProcessing,c())});a.queryServiceUrl||(a.noQueryServiceUrl=!0,delete a.queryServiceUrlProcessing,d&&d())}),e.hitch(this,function(){a.noQueryServiceUrl=!0;delete a.queryServiceUrlProcessing;d&&d()})))},hasFullEditingControl:function(a){var c=!1,d=arcgisonline.sharing.util.getUser();if(d&&a.itemId){var h=arcgisonline.sharing.util.urlToObject(document.URL);h.query=h.query||{};var f=h.query.layers||
h.query.services,g=[];h.query.webmap&&arcgisonline.map.save_open.openedWebMap&&(g=e.filter(arcgisonline.map.save_open.openedWebMap.operationalLayers,function(n){return n.itemId===a.itemId}));!a.itemCard&&arcgisonline.map.save_open.itemCards[a.itemId]&&(a.itemCard=arcgisonline.map.save_open.itemCards[a.itemId]);"true"===h.query.isAdmin&&(f&&-1<f.indexOf(a.itemId)||g.length)&&a.itemCard&&-1<e.indexOf(a.itemCard.typeKeywords,"Hosted Service")&&("update"===a.itemCard.itemControl||"admin"===a.itemCard.itemControl?
c=!0:d&&esriGeowConfig.userRole&&esriGeowConfig.userRole.isAdmin()&&a.itemCard.isOrgItem?c=!0:d&&a.itemCard.owner&&a.itemCard.owner===d.username?c=!0:esriGeowConfig.userRole&&esriGeowConfig.userRole.canEditFeaturesFullControl()&&esriGeowConfig.userRole.canEditFeatures()&&a.itemCard.isOrgItem&&a.serviceInfo&&a.serviceInfo.capabilities&&(-1<a.serviceInfo.capabilities.indexOf("Create")||-1<a.serviceInfo.capabilities.indexOf("Update")||-1<a.serviceInfo.capabilities.indexOf("Delete"))&&(c=!0))}return c},
hasDynamicLayers:function(a){return a.layer&&a.itemLayers&&a.itemLayers.length&&a.layer.supportsDynamicLayers&&a.itemLayers[0].layerDefinition&&a.itemLayers[0].layerDefinition.source?!0:!1},getMapLayerInfo:function(){for(var a={supportsOffline:!0},c=0;c<arcgisonline.map.main.mapLayers.length;c++){var d=arcgisonline.map.main.mapLayers[c],h=d.layer;"base"!==d.type&&"labels"!==d.type&&(esri.isDefined(a.allOpLyrsSync)||(a.allOpLyrsSync=!0),a.allOpLyrsSync=!!(a.allOpLyrsSync&&h&&h instanceof esri.layers.FeatureLayer&&
h.capabilities&&-1<h.capabilities.indexOf("Sync")&&(arcgisonline.sharing.util.isHostedService(h.url)||10.4<=h.version)));if(h&&h.url&&h instanceof esri.layers.FeatureLayer&&(h.isEditable()||isEmbedded&&isEmbedded.hideEdit)){var f=!1,g=d.serviceInfo&&d.serviceInfo._origCapabilities||h.capabilities;g=g?g.toLowerCase():"";if(-1<g.indexOf("create")||-1<g.indexOf("edit")||-1<g.indexOf("delete")||-1<g.indexOf("update"))f=!0;f&&(a.hasEditableLayer=!0,d.isTrackingInfoLayer&&!a.trackingLayerId&&(a.trackingLayerId=
d.id))}!a.supportsOffline||h&&h instanceof esri.layers.FeatureLayer&&h.url&&h.capabilities&&-1<h.capabilities.indexOf("Sync")||"mapNotes"===d.type&&!d.itemId||arcgisonline.map.featColl.isFeatureCollection(d)&&!d.itemId||h&&h instanceof esri.layers.VectorTileLayer&&h.capabilities&&h.capabilities.exportTilesAllowed||h&&h instanceof esri.layers.ArcGISTiledMapServiceLayer&&(d.serviceInfo&&d.serviceInfo.exportTilesAllowed||!arcgisonline.sharing.util.isPortal()&&arcgisonline.sharing.util.isAgolService(h.url)&&
arcgisonline.map.main.agolServiceWithExportTilesAllowed(h.url))||(a.supportsOffline=!1)}for(c=0;c<arcgisonline.map.main.mapTables.length;c++)d=arcgisonline.map.main.mapTables[c],(h=d.layer)&&h.url&&h instanceof esri.layers.FeatureLayer&&h.isEditable()&&(a.hasEditableLayer=!0),h&&h instanceof esri.layers.FeatureLayer&&h.url&&h.capabilities&&-1<h.capabilities.indexOf("Sync")||(a.supportsOffline=!1);return a},agolServiceWithExportTilesAllowed:function(a){if(esriGeowConfig.agolServicesWithExportTilesAllowed)for(var c=
0;c<esriGeowConfig.agolServicesWithExportTilesAllowed.length;c++)if(-1<a.indexOf("/"+esriGeowConfig.agolServicesWithExportTilesAllowed[c]+"/"))return!0;return!1},adjustWebMapTypeKeywords:function(a){a=a.split(",");var c=arcgisonline.map.main.getMapLayerInfo(),d=e.indexOf(a,"ArcGIS API for JavaScript");-1<d&&a.splice(d,1);c.hasEditableLayer?(-1===e.indexOf(a,"Data Editing")&&a.push("Data Editing"),-1<e.indexOf(a,"Workforce Project")||-1<e.indexOf(a,"Workforce Worker")||-1<e.indexOf(a,"Workforce Dispatcher")?
(d=e.indexOf(a,"Collector"),-1<d&&a.splice(d,1)):(d=arcgisonline.sharing.util.getUser())&&d.accountId&&-1===e.indexOf(a,"CollectorDisabled")&&(-1===e.indexOf(a,"Collector")&&d&&d.accountId?a.push("Collector"):d&&d.accountId||(d=e.indexOf(a,"Collector"),-1<d&&a.splice(d,1)))):(d=e.indexOf(a,"Data Editing"),-1<d&&a.splice(d,1),d=e.indexOf(a,"Collector"),-1<d&&a.splice(d,1),d=e.indexOf(a,"CollectorDisabled"),-1<d&&a.splice(d,1));(d=arcgisonline.sharing.util.getUser())&&d.accountId&&-1===e.indexOf(a,
"OfflineDisabled")&&(c.supportsOffline?-1===e.indexOf(a,"Offline")&&a.push("Offline"):(d=e.indexOf(a,"Offline"),-1<d&&a.splice(d,1)));return a.toString()},reloadFeatureLayer:function(a){arcgisonline.map.main.map.infoWindow.clearFeatures();arcgisonline.map.main.map.infoWindow.hide();delete a.__createDefaultPopup;var c=!1;e.forEach(arcgisonline.map.geocode.geocoder.sources,function(f){f.layerId===a.layer.id&&(c=!0)});a.scaleChanged&&(a.serviceInfo.minScale=a.layer.minScale,a.serviceInfo.maxScale=a.layer.maxScale);
a.rendererChanged&&(a.layerDefinition=a.layerDefinition||{},a.layerDefinition.drawingInfo=a.layerDefinition.drawingInfo||{},a.layerDefinition.drawingInfo.renderer=a.layer.renderer.toJson(),a.layer.labelingInfo&&(a.serviceInfo.drawingInfo.labelingInfo=e.map(a.layer.labelingInfo,function(f){return f.toJson()})));a.featureTemplatesChanged&&(a.serviceInfo.types=a.layer.types,a.serviceInfo.templates=a.layer.templates,a.serviceInfo.typeIdField=a.layer.typeIdField);!1===a.layer.useMapTime?a.timeAnimation=
!1:!0===a.layer.useMapTime&&(a.timeAnimation=!0);a.defaultOpacity=a.layer.opacity;var d=e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,a.id),h=e.connect(arcgisonline.map.main.map,"onLayerRemove",function(){e.disconnect(h);arcgisonline.map.labels.removeLabelsForLayer(a.layer);delete a.layer;arcgisonline.map.layer.addLayer(a,d,function(){e.publish("onLayerUpdate",["reopen"]);c&&arcgisonline.map.geocode.recreateGeocoder()})});arcgisonline.map.main.map.removeLayer(a.layer);arcgisonline.map.labels.removeLabelsForLayer(a.layer)},
maxOffset:function(a){return Math.floor(arcgisonline.map.main.map.extent.getWidth()/arcgisonline.map.main.map.width)*a},updateLayerScaleInfo:function(a,c){if(10.1>=c.version&&a.serviceInfo&&a.serviceInfo.layers)for(var d=parseInt(c.url.substring(c.url.lastIndexOf("/")+1,c.url.length)),h=a.serviceInfo.layers.length-1;0<=h;h--)if(a.serviceInfo.layers[h].id==d)if(0<=a.serviceInfo.layers[h].minScale&&c.setMinScale(Math.min(c.minScale,a.serviceInfo.layers[h].minScale)||a.serviceInfo.layers[h].minScale||
c.minScale),0<=a.serviceInfo.layers[h].maxScale&&c.setMaxScale(Math.max(c.maxScale,a.serviceInfo.layers[h].maxScale)),-1<a.serviceInfo.layers[h].parentLayerId)d=a.serviceInfo.layers[h].parentLayerId;else break},removeUrlParameter:function(a,c){-1!=a.indexOf("\x26"+c+"\x3d")?(start=a.indexOf(c),end=a.indexOf("\x26",start+2),a=-1==end?a.substring(0,start):a.substring(0,start)+a.substring(end,a.length)):-1!=a.indexOf("?"+c+"\x3d")&&(start=a.indexOf(c),end=a.indexOf("\x26",start+2),a=-1==end?a.substring(0,
start):a.substring(0,start+1)+a.substring(end+1,a.length));return a},isTextLayer:function(a){return a.renderer&&"esri.renderer.UniqueValueRenderer"===a.renderer.declaredClass&&a.renderer.infos&&a.renderer.infos.length&&a.renderer.infos[0].symbol&&"textsymbol"===a.renderer.infos[0].symbol.type?!0:!1},switchBingToEsriBasemap:function(a){a.baseMap="BingMapsAerial"===a.baseMap.baseMapLayers[0].type||"BingMapsAerial"===a.baseMap.baseMapLayers[0].layerType?{title:"Imagery",baseMapLayers:[{id:"World_Imagery_2017",
visibility:!0,opacity:1,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]}:"BingMapsRoad"===a.baseMap.baseMapLayers[0].type||"BingMapsRoad"===a.baseMap.baseMapLayers[0].layerType?{title:"Streets",baseMapLayers:[{id:"World_Street_Map_8421",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]}:{title:"Imagery with Labels",baseMapLayers:[{id:"World_Imagery_6611",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},
{id:"World_Boundaries_and_Places_1145",isReference:!0,opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer"}]};return a},getJson:function(a,c,d){a=0<=a.indexOf("?")?a+"\x26f\x3djson":a+"?f\x3djson";esri.request({url:a,callbackParamName:"callback",load:function(h,f){arcgisonline.sharing.util.handler(h,f,a,c,d)},error:function(h,f){arcgisonline.sharing.util.errorHandler(h,f,a,d)}})},roundVal:function(a){return arcgisonline.map.main.roundValue(a,
1E4)},roundValue:function(a,c){return Math.round(a*c)/c},onKeyPress:function(a){a.keyCode==e.keys.BACKSPACE&&"INPUT"!==a.currentTarget.activeElement.nodeName&&"TEXTAREA"!==a.currentTarget.activeElement.nodeName&&(a.preventDefault(),a.stopPropagation())},doNothing:function(a){a.preventDefault()},contains:function(a,c){for(var d=a.length;d--;)if(a[d]===c)return!0;return!1},createMapObject:function(a,c,d){e.style("map","position","relative");var h=new esri.dijit.Popup({visibleWhenEmpty:!1},e.create("div",
{"class":"blueTheme"},e.byId("map")));c={nav:!1,lods:arcgisonline.map.main.mapLods,extent:c,wrapAround180:!0,infoWindow:h,showInfoWindowOnClick:!1,sliderStyle:"small"};d&&esri.isDefined(d.minScale)&&esri.isDefined(d.maxScale)&&(c.minScale=d.minScale,c.maxScale=d.maxScale);arcgisonline.map.save_open.openedWebMap&&arcgisonline.map.save_open.openedWebMap.background&&arcgisonline.map.save_open.openedWebMap.background.color&&esri.isDefined(arcgisonline.map.save_open.openedWebMap.background.color[0])&&
(c.backgroundColor=esri.Color.toDojoColor(arcgisonline.map.save_open.openedWebMap.background.color));arcgisonline.map.main.map=new esri.Map("map",c);null==a&&(a=e.hitch(arcgisonline.map.main,"onMapLoad"));e.connect(arcgisonline.map.main.map,"onLoad",a);e.connect(arcgisonline.map.main.map,"onClick",function(){arcgisonline.map.geocode.closeInfoWindow();document.activeElement&&document.activeElement.blur&&document.activeElement.blur()});arcgisonline.map.main.onLayerAddHandler=e.connect(arcgisonline.map.main.map,
"onLayerAddResult",e.hitch(arcgisonline.map.main,"onLayerAddResult"))},destroyMapObject:function(a,c){arcgisonline.map.main.map&&(arcgisonline.map.main.scalebar=null,arcgisonline.map.time.hideTimeSlider(),arcgisonline.map.time.removeTimeSlider(),arcgisonline.map.multiDimensions.removeMdSlider(),arcgisonline.map.main.destroyOverviewMap(),arcgisonline.map.main.destroyMeasureTool(),arcgisonline.map.geocode.destroyGeocoder(),arcgisonline.map.table.destroyTable(),arcgisonline.map.main.map.destroy(),arcgisonline.map.labels.labelLayer=
null,arcgisonline.map.main.map=null,e.byId("map").innerHTML="")},getDirectionsDisplayField:function(a){var c="";if(a.displayField)c=a.displayField;else{for(var d=null,h=null,f=null,g=null,n=null,m=0;m<a.fields.length;m++){var t=a.fields[m];if("name"==t.name.toLowerCase()){c=t.name;break}else"address"==t.name.toLowerCase()?h=t.name:"street"==t.name.toLowerCase()?f=t.name:"city"==t.name.toLowerCase()?g=t.name:!d&&-1<t.name.toLowerCase().indexOf("name")?d=t.name:n||"esriFieldTypeString"!==t.type||(n=
t.name)}c||(d?c=d:h?c=h:f?c=f:g?c=g:n&&(c=n))}return c},numOperationalLayers:function(){for(var a=0,c=0;c<arcgisonline.map.main.mapLayers.length;c++)"user"==arcgisonline.map.main.mapLayers[c].type&&a++;return a},numLabelsLayers:function(){for(var a=0,c=0;c<arcgisonline.map.main.mapLayers.length;c++)"labels"===arcgisonline.map.main.mapLayers[c].type&&a++;return a},numMapNotesLayers:function(){for(var a=0,c=0;c<arcgisonline.map.main.mapLayers.length;c++)"mapNotes"===arcgisonline.map.main.mapLayers[c].type&&
a++;return a},countMapNotesSubLayers:function(){for(var a=0,c=0;c<arcgisonline.map.main.mapLayers.length;c++)"mapNotes"===arcgisonline.map.main.mapLayers[c].type&&arcgisonline.map.main.mapLayers[c].layers&&(a+=arcgisonline.map.main.mapLayers[c].layers.length);return a},itemCardExtentValid:function(a){return!a||2!=a.length||2!=a[0].length||2!=a[1].length||-90>a[1][1]||90<a[1][1]||-180>a[1][0]||180<a[1][0]||-180>a[0][0]||180<a[0][0]||-90>a[0][1]||90<a[0][1]||a[1][0]<=a[0][0]||a[1][1]<=a[0][1]?!1:!0},
getNameFromUrl:function(a){var c=a;-1<a.indexOf("/MapServer")?(c=a.substring(0,a.indexOf("/MapServer")),c=c.substring(c.lastIndexOf("/")+1,c.length)):-1<a.indexOf("/ImageServer")?(c=a.substring(0,a.indexOf("/ImageServer")),c=c.substring(c.lastIndexOf("/")+1,c.length)):-1<a.indexOf("/FeatureServer")&&(c=a.substring(0,a.indexOf("/FeatureServer")),c=c.substring(c.lastIndexOf("/")+1,c.length));-1<c.indexOf("%")&&(c=arcgisonline.map.main.decodeUrl(c));return c},addLayerId:function(a,c){var d=a,h=d.indexOf("?");
return d=-1<h?d.substring(0,h)+"/"+c+d.substring(h,d.length):d+("/"+c)},decodeUrl:function(a){try{var c=decodeURIComponent(a)}catch(d){c=a}return c},displayDefaultExtent:function(){var a=new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new e.Color([255,0,0]),2);arcgisonline.map.main.map.graphics.add(new esri.Graphic(new esri.geometry.Extent(esriGeowConfig.defaultExtent),a))},calcFilterDlgWidth:function(){if(!arcgisonline.map.main.filterDlgWidth){var a=e.string.substitute(esri.i18nBundle.FilterDlg.expressionTemplate,
{field_dropdown:"",operator_dropdown:"",values_input:esri.i18nBundle.FilterDlg.value+esri.i18nBundle.FilterDlg.field+esri.i18nBundle.FilterDlg.uniqueValues}).replace(/\s/g,"\x26nbsp;"),c=e.create("div",{innerHTML:a,style:{top:-1E3,left:0,position:"absolute"}},document.body);a=e.string.substitute(esri.i18nBundle.FilterDlg.expressionTemplate,{field_dropdown:"",operator_dropdown:"",values_input:esri.i18nBundle.FilterDlg.andBetweenValues}).replace(/\s/g,"\x26nbsp;");a=e.create("div",{innerHTML:a,style:{top:-1E3,
left:0,position:"absolute"}},document.body);var d=e.create("div",{innerHTML:"",style:{top:0,left:0,position:"absolute"},"class":"submitButtons dijitDialogPaneActionBar dijitDialog"},document.body),h=new U.form.Button({label:esri.i18nBundle.FilterDlg.applyFilterBtn,"class":"primary",type:"button"});e.place(h.domNode,d,"last");h=new U.form.Button({label:esri.i18nBundle.FilterDlg.applyFilterAndZoomBtn,"class":"primary",type:"button"});e.place(h.domNode,d,"last");h=new U.form.Button({label:esri.i18nBundle.common.close,
"class":"cancel",type:"button"});e.place(h.domNode,d,"last");h=e.coords(c).w+465;var f=e.coords(a).w+590,g=e.coords(d).w+30;arcgisonline.map.main.filterDlgWidth=Math.max(h,Math.max(f,g));document.body.removeChild(c);document.body.removeChild(a);document.body.removeChild(d)}return arcgisonline.map.main.filterDlgWidth},openFilterDlg:function(a,c,d){var h=arcgisonline.map.main.calcFilterDlgWidth(),f=(new U.Dialog({"class":"esriAGOFilterDialog",style:"width:"+(h+30)+"px;"})).placeAt(document.body),g=
new arcgisonline.sharing.dijit.dialog.FilterDlg({id:"filterDlg",dialog:f,style:"width:"+h+"px;"});h=esri.i18nBundle.FilterDlg.filter+": "+a.title;d&&(h=esri.i18nBundle.FilterDlg.defineFeatures+": "+a.title);a.layer instanceof esri.layers.ArcGISDynamicMapServiceLayer&&(h+=" - "+c.name);f.set({title:h,content:g});f.show();if(d&&!c.adminFields){var n=a.url.replace("/rest/services","/rest/admin/services"),m={f:"json"};arcgisonline.map.itemData.getServerToken(a).then(e.hitch(this,function(t){m.token=t;
esri.request({url:n,content:m,callbackParamName:"callback",load:function(w){c.adminFields=w.fields;g.start(a,c,null,d)},error:function(w){g.start(a,c,null,d)}})}),function(t){g.start(a,c,null,d)})}else g.start(a,c,null,d)},openFieldsDlg:function(a){arcgisonline.map.main.map.infoWindow.hide();arcgisonline.map.table.hideAttributeTable();var c=function(f){var g=(new U.Dialog({"class":"esriAGOFieldsDialog",style:"width: 500px"})).placeAt(document.body),n=new arcgisonline.sharing.dijit.dialog.FieldsDlg({id:"fieldsDlg",
dialog:g});g.set({title:esri.i18nBundle.FieldsDlg.defineFields+": "+a.title,content:n});g.show();n.start(a,f)};if(a.serviceInfo.adminFields)c(a.serviceInfo.adminFields);else{var d=a.url.replace("/rest/services","/rest/admin/services"),h={f:"json"};arcgisonline.map.itemData.getServerToken(a).then(e.hitch(this,function(f){h.token=f;esri.request({url:d,content:h,callbackParamName:"callback",load:function(g){a.serviceInfo.adminFields=g.fields;c(a.serviceInfo.adminFields)},error:function(g){c(a.serviceInfo.fields)}})}),
function(f){c(a.serviceInfo.fields)})}},openMapSettingsDlg:function(){var a=(new U.Dialog({"class":"esriAGOMapSettingsDialog"})).placeAt(document.body),c=new arcgisonline.sharing.dijit.dialog.MapSettingsDlg({id:"mapSettingsDlg",dialog:a});a.set({title:esri.i18nBundle.MapSettingsDlg.timeSettings,content:c});a.show();c.start()},onUTCOffsetChange:function(){var a=arcgisonline.map.table.openTableMapLayerSubId;if(arcgisonline.map.table.openTableMapLayerId){var c=arcgisonline.map.main.getParameterListById(arcgisonline.map.table.openTableMapLayerId);
arcgisonline.map.table.refreshTablePrep(c,a)}},applyUTCOffsetToMS:function(a){var c=arcgisonline.map.main.map.utcOffset;if(esri.isDefined(c)){var d=-1*(new Date).getTimezoneOffset();a=a-6E4*d+6E4*c}return a},getWebmapId:function(){return arcgisonline.map.save_open.webMapInfo?arcgisonline.map.save_open.webMapInfo.id:null},getWebmapTitle:function(){return arcgisonline.map.save_open.webMapInfo?arcgisonline.map.save_open.webMapInfo.title:null},updateRecentWebMaps:function(a){arcgisonline.map.main.storeRecentMapsHandler||
(arcgisonline.map.main.storeRecentMapsHandler=e.subscribe("onSaveExistingWebMap",function(f){arcgisonline.map.main.storeRecentWebMaps()}),e.subscribe("onWebMapSave",function(f,g,n,m,t){arcgisonline.map.main.storeRecentWebMaps(f,g,t,"thumbnail/ago_downloaded.png")}),e.subscribe("onMapFullyLoaded",function(){arcgisonline.map.save_open.webMapInfo&&arcgisonline.map.main.storeRecentWebMaps()}));if("none"!==e.style(e.byId("header_map_newMap"),"display")||"none"!==e.style(e.byId("header_map_recentMaps"),
"display")){arcgisonline.map.main.recentMapsHandlers=arcgisonline.map.main.recentMapsHandlers||[];var c;window.localStorage&&(c=window.localStorage.getItem("Esri_recent_webmaps"))&&(c=e.json.parse(c));var d=arcgisonline.sharing.util.getUser();if((c=c&&c[d?d.username:window.location.host])&&c.length)if(arcgisonline.map.main.didCheckRecentMaps)arcgisonline.map.main.displayRecentMaps(c,a);else{var h=[];e.forEach(c,function(f,g){h.push(arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+
"content/items/"+f.id},{disableIdentityLookup:!0}))});h.length?(new e.DeferredList(h)).addCallback(function(f){var g=[];e.forEach(f,function(m){(m=m[1])&&m.id&&g.push({id:m.id,title:m.title,owner:m.owner,thumbnail:m.thumbnail})});if(window.localStorage){var n;window.localStorage&&(n=window.localStorage.getItem("Esri_recent_webmaps"))&&(n=e.json.parse(n));n=n||{};g.length?n[d?d.username:window.location.host]=g:delete n[d?d.username:window.location.host];window.localStorage.setItem("Esri_recent_webmaps",
e.json.stringify(n))}arcgisonline.map.main.displayRecentMaps(g,a)}):arcgisonline.map.main.displayRecentMaps([],a);arcgisonline.map.main.didCheckRecentMaps=!0}else arcgisonline.map.main.displayRecentMaps(c,a);arcgisonline.map.main.checkTitleDiv()}},displayRecentMaps:function(a,c){a&&a.length&&(a=e.filter(a,function(g){return esri.isDefined(c)&&c===g.id||!esri.isDefined(c)&&arcgisonline.map.save_open.webMapInfo&&g.id===arcgisonline.map.save_open.webMapInfo.id?!1:!0}));if(a&&a.length){e.byId("webmap-recentMap-new-link").innerHTML=
'\x3cspan style\x3d"margin-right: 4px;vertical-align: -4px;" class\x3d"esriPublishIcon"\x3e\x3c/span\x3e'+esri.i18nBundle.siteHeader.createNewMap;e.disconnect(arcgisonline.map.main.recentMapsHandlers["new"]);arcgisonline.map.main.recentMapsHandlers["new"]=e.connect(e.byId("webmap-recentMap-new-link"),"onclick",e.hitch(this,function(g){g.preventDefault();arcgisonline.map.main.openNewMap()}));for(var d=0;5>d;d++)e.style(e.byId("webmap-recentMap-title"),"display","none"),e.style(e.byId("webmap-recentMap-"+
d+"-link"),"display","none"),e.disconnect(arcgisonline.map.main.recentMapsHandlers[d]);a.reverse();var h=0;e.forEach(a,function(g){if(!(4<h)){var n='\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"width:270px;"\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd style\x3d"width:77px;" valign\x3d"top"\x3e',m=g.thumbnail||arcgisonline.sharing.util.getStaticImagesUrl()+"/desktopapp.png";-1<m.indexOf("thumbnail/")&&(m=esriGeowConfig.restBaseUrl+"content/items/"+g.id+"/info/"+m);var t=arcgisonline.sharing.util.getUser();
t&&t.token&&(m+="?token\x3d"+t.token);t=g.title;75<t.length&&(t=t.substring(0,72)+"...");n=n+("\x3cimg src\x3d'"+m+"' border\x3d'0' style\x3d'width:67px; height:44px;'/\x3e\x3c/td\x3e\x3ctd style\x3d'width:190px; white-space:normal;' valign\x3d'top'\x3e\x3cspan\x3e")+(t+"\x3c/span\x3e");n+="\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e";e.byId("webmap-recentMap-"+h+"-link").innerHTML=n;e.style(e.byId("webmap-recentMap-"+h+"-link"),"display","");e.style(e.byId("webmap-recentMap-title"),"display",
"");arcgisonline.map.main.recentMapsHandlers[h]=e.connect(e.byId("webmap-recentMap-"+h+"-link"),"onclick",e.hitch(this,function(w){w.preventDefault();w=esriGeowConfig.baseUrl+"webmap/viewer.html?webmap\x3d"+g.id;1==arcgisonline.map.main.mapHasChanged?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(w,null,arcgisonline.map.main.mapLayers,arcgisonline.map.main.mapTables,arcgisonline.map.save_open.webMapInfo?arcgisonline.map.save_open.webMapInfo.title:null):document.location=
w}));h++}});e.style(e.byId("header_map_newMap"),"display","none");e.style(e.byId("header_map_recentMaps"),"display","");if(esriGeowConfig.isRightToLeft){d=e.coords(e.byId("header_map_recentMaps"));d=d.x+d.w;var f=e.query(".js-dropdown-menu",e.byId("header_map_recentMaps"))[0];310>d?e.style(f,"left","5px"):e.style(f,"left","auto")}else d=window.innerWidth-e.coords(e.byId("header_map_recentMaps")).x,f=e.query(".js-dropdown-menu",e.byId("header_map_recentMaps"))[0]}else e.style(e.byId("header_map_recentMaps"),
"display","none"),e.style(e.byId("header_map_newMap"),"display","")},storeRecentWebMaps:function(a,c,d,h){var f;window.localStorage&&(f=window.localStorage.getItem("Esri_recent_webmaps"))&&(f=e.json.parse(f));f=f||{};var g=arcgisonline.sharing.util.getUser();var n=f[g?g.username:window.location.host]||[];n=e.filter(n,function(m){return m.id!==(a||arcgisonline.map.save_open.webMapInfo.id)});n.push({id:a||arcgisonline.map.save_open.webMapInfo.id,title:d||arcgisonline.map.save_open.webMapInfo.title,
owner:c||arcgisonline.map.save_open.webMapInfo.owner,thumbnail:h||arcgisonline.map.save_open.webMapInfo.thumbnail});10<n.length&&n.splice(0,1);window.localStorage&&(f[g?g.username:window.location.host]=n,window.localStorage.setItem("Esri_recent_webmaps",e.json.stringify(f)));arcgisonline.map.main.updateRecentWebMaps(a)},hideRouteLayer:function(a){arcgisonline.map.main.showRouteLayer();arcgisonline.map.main.hiddenRouteLayers=[];e.forEach(arcgisonline.map.main.mapLayers,function(c){c.itemId===a&&(c.layers?
e.forEach(c.layers,function(d){d.visible&&(d.hide(),arcgisonline.map.main.hiddenRouteLayers.push(d))}):(c.layer.hide(),arcgisonline.map.main.hiddenRouteLayers.push(c.layer)))})},showRouteLayer:function(){arcgisonline.map.main.hiddenRouteLayers=arcgisonline.map.main.hiddenRouteLayers||[];e.forEach(arcgisonline.map.main.hiddenRouteLayers,function(a){a.show()});delete arcgisonline.map.main.hiddenRouteLayers},getPictureMarkerSize:function(a){var c=new e.Deferred;if(!a||10>a.length||0!==a.indexOf("http"))c.errback();
else{arcgisonline.map.main.testImageHandler&&e.disconnect(arcgisonline.map.main.testImageHandler);arcgisonline.map.main.testImageHandler=e.connect(e.byId("viewer_testImage"),"onload",function(){clearTimeout(d);d=null;var h=e.style(e.byId("viewer_testImage"),"width"),f=e.style(e.byId("viewer_testImage"),"height");1==h&&1==f||0===h||0===f?c.errback():c.callback([h,f])},{});var d=setTimeout(e.hitch(this,function(){clearTimeout(d);d=null;c.errback()}),5E3);e.byId("viewer_testImage").src=a;return c}},
getTitleFromUrl:function(a,c){if(!a)return null;var d=null,h=a.toLowerCase();-1<h.indexOf("/mapserver")?(d=a.substring(0,h.indexOf("/mapserver")),d=d.substring(d.lastIndexOf("/")+1,d.length)):-1<h.indexOf("/vectortileserver")?(d=a.substring(0,h.indexOf("/vectortileserver")),d=d.substring(d.lastIndexOf("/")+1,d.length)):-1<h.indexOf("/imageserver")?(d=a.substring(0,h.indexOf("/imageserver")),d=d.substring(d.lastIndexOf("/")+1,d.length)):-1<h.indexOf("/featureserver")?(d=a.substring(0,h.indexOf("/featureserver")),
d=d.substring(d.lastIndexOf("/")+1,d.length)):c&&c.documentInfo&&c.documentInfo.Title&&0<c.documentInfo.Title.length?d=c.documentInfo.Title:c&&c.mapName&&0<c.mapName.length&&(d=c.mapName);d&&-1<d.indexOf("%")&&(d=arcgisonline.map.main.decodeUrl(d));return d=arcgisonline.sharing.util.stripHTML(d)},getSpecialTitle:function(a){var c=null;if("BingMapsRoad"===a.type||"BingMapsRoad"===a.layerType)c="Bing Maps Road";else if("BingMapsAerial"===a.type||"BingMapsAerial"===a.layerType)c="Bing Maps Aerial";else if("BingMapsHybrid"===
a.type||"BingMapsHybrid"===a.layerType)c="Bing Maps Hybrid";else if("OpenStreetMap"===a.type||"OpenStreetMap"===a.layerType)c="OpenStreetMap";return c},getLayerTitle:function(a,c){var d=a.title;if(a.layer&&a.layer.layerInfos)if(arcgisonline.map.main.hasDynamicLayers(a))e.forEach(a.itemLayers,function(f){c===f.id&&f.name&&(d+=" - "+f.name)});else{var h=arcgisonline.map.main.getItemWithId(a.layer.layerInfos,c);h.name&&(d+=" - "+h.name)}else if(a.layers||a.tables)h=a.layers,a.tables&&(h=h.concat(a.tables)),
h=arcgisonline.map.main.getItemWithId(h,a.id+"_"+c),h.name&&(d+=" - "+h.name);return d},getTitleForBasemapLayer:function(a){var c=function(h){var f=h.url||h.templateUrl;h.layer instanceof esri.layers.VectorTileLayer&&h.itemCard&&(f=h.itemCard.url);if(!f)return null;(h=arcgisonline.map.main.getTitleFromUrl(f,h.serviceInfo))||(h=f.substring(f.indexOf("://")+3).replace(/\//g,"-"));return h},d=a.title&&a.title!==arcgisonline.map.main.mapLayers[0].title?a.title:null;return arcgisonline.sharing.util.stripHTML(a.itemId&&
a.itemCard&&a.itemCard.title||d||a.layer&&a.layer.name||c(a)||a.title||"No Name")},isBlankViewer:function(){if(arcgisonline.map.save_open.webMapItemCard||arcgisonline.map.save_open.itemCard)return!1;var a=arcgisonline.sharing.util.urlToObject(document.URL);a.query=a.query||{};delete a.query.useExisting;return arcgisonline.isEmpty(a.query)?!0:0===arcgisonline.map.main.numOperationalLayers()&&0===arcgisonline.map.main.numMapNotesLayers()?!0:!1},hasMapOnly:function(){var a=arcgisonline.sharing.util.urlToObject(document.URL);
a.query=a.query||{};return a.query.mapOnly&&"true"===a.query.mapOnly?!0:!1},isItemFromSamePortal:function(a){return a&&a.restBaseUrl&&-1===esriGeowConfig.restBaseUrl.indexOf(a.restBaseUrl)?!1:!0},setupMapAlert:function(){arcgisonline.map.main.handlers=arcgisonline.map.main.handlers||{};e.byId("alertDiv")||(e.create("div",{id:"alertDiv","class":"alertIcon",style:"display:none;"},e.byId("map")),arcgisonline.map.main.handlers.onLayerUpdateHandler&&e.unsubscribe(arcgisonline.map.main.handlers.onLayerUpdateHandler),
arcgisonline.map.main.handlers.updateEndHandler&&e.unsubscribe(arcgisonline.map.main.handlers.updateEndHandler),delete arcgisonline.map.main.handlers.onLayerUpdateHandler,delete arcgisonline.map.main.handlers.updateEndHandler);arcgisonline.map.main.handlers.onLayerUpdateHandler=e.subscribe("onLayerUpdate",null,e.hitch(this,function(a){arcgisonline.map.main.checkMapAlert()}));arcgisonline.map.main.handlers.updateEndHandler||(arcgisonline.map.main.handlers.updateEndHandler=arcgisonline.map.main.map.on("update-end",
e.hitch(this,function(){arcgisonline.map.main.checkMapAlert()})));arcgisonline.map.main.handlers.updateStartHandler||(arcgisonline.map.main.handlers.updateStartHandler=arcgisonline.map.main.map.on("update-start",e.hitch(this,function(){})))},checkMapAlert:function(a){arcgisonline.map.main.alertHandler||"execute"===a?a&&(arcgisonline.map.main.queryLimitExceededLayers=[],e.forEach(arcgisonline.map.main.mapLayers,function(c){if(c){var d=c.layer;d&&"esri.layers.FeatureLayer"===d.declaredClass&&!d.hasAllFeatures()&&
arcgisonline.map.main.createMapAlert(c)}}),arcgisonline.map.main.queryLimitExceededLayers.length?e.byId("alertDiv")&&e.style(e.byId("alertDiv"),"display",""):e.byId("alertDiv")&&e.style(e.byId("alertDiv"),"display","none")):arcgisonline.map.main.alertHandler=setTimeout(function(){delete arcgisonline.map.main.alertHandler;arcgisonline.map.main.checkMapAlert("execute")},2E3)},createMapAlert:function(a){if(a.layer&&!a.layer.suspended){-1===e.indexOf(arcgisonline.map.main.queryLimitExceededLayers,a.title)&&
arcgisonline.map.main.queryLimitExceededLayers.push({title:a.title,hasFeatureReduction:a.layer.hasFeatureReduction&&a.layer.hasFeatureReduction(),hasUpdateError:a.layer.hasUpdateError()});if(1===arcgisonline.map.main.queryLimitExceededLayers.length)var c=a.layer.hasFeatureReduction&&a.layer.hasFeatureReduction()?a.layer.hasUpdateError()?e.string.substitute(esri.i18nBundle.viewer.layer.queryLimitExceededSingleMsgCluster,{name:a.title}):e.string.substitute(esri.i18nBundle.viewer.layer.queryLimitExceededSingleMsgCluster,
{name:a.title})+" "+esri.i18nBundle.viewer.layer.queryLimitExceededClusterTooMany:a.layer.hasUpdateError()?e.string.substitute(esri.i18nBundle.viewer.layer.queryLimitExceededSingleMsg,{name:a.title}):e.string.substitute(esri.i18nBundle.viewer.layer.queryLimitExceededSingleMsg,{name:a.title})+" "+esri.i18nBundle.viewer.layer.queryLimitExceededTooMany;else{for(var d=a=!1,h=0;h<arcgisonline.map.main.queryLimitExceededLayers.length;h++)arcgisonline.map.main.queryLimitExceededLayers[h].hasFeatureReduction&&
(a=!0),arcgisonline.map.main.queryLimitExceededLayers[h].hasUpdateError&&(d=!0);c=a?d?esri.i18nBundle.viewer.layer.queryLimitExceededMultipleMsgCluster:esri.i18nBundle.viewer.layer.queryLimitExceededMultipleMsgCluster+" "+esri.i18nBundle.viewer.layer.queryLimitExceededClusterTooMany:d?esri.i18nBundle.viewer.layer.queryLimitExceededMultipleMsg:esri.i18nBundle.viewer.layer.queryLimitExceededMultipleMsg+" "+esri.i18nBundle.viewer.layer.queryLimitExceededTooMany;c+="\x3cul\x3e";e.forEach(arcgisonline.map.main.queryLimitExceededLayers,
function(f){c+="\x3cli\x3e"+f.title+"\x3c/li\x3e"});c+="\x3c/ul\x3e"}arcgisonline.map.layer.tooManyFeaturesTooltip&&arcgisonline.map.layer.tooManyFeaturesTooltip.destroy();arcgisonline.map.layer.tooManyFeaturesTooltip=new U.Tooltip({connectId:e.byId("alertDiv"),label:"\x3cdiv class\x3d'tooManyFeaturesTooltip' style\x3d'width:350px;'\x3e"+c+"\x3c/div\x3e",position:["above","after"]})}},refreshMapTables:function(){var a=arcgisonline.map.storage.buildWebMapText().tables||[];e.forEach(arcgisonline.map.main.mapLayers,
function(c){!c.url&&c.tables&&e.forEach(c.tables,function(d){var h=d.toJson();h.id=d.id;h.title=c.title+" - "+d.name;a.push(h)})});arcgisonline.map.main.map.tables=a},setupHandlerForCache:function(){var a=arcgisonline.sharing.util.getUser();a&&a.accountId&&e.subscribe("layerAdded",e.hitch(this,function(c){(c=arcgisonline.map.main.getParameterListById(c))&&c.url&&c.itemCard&&arcgisonline.sharing.util.isHostedService(c.url)&&-1<c.url.toLowerCase().indexOf("/featureserver")&&(e.connect(c.layer,"onAddAttachmentComplete",
e.hitch(this,function(d){arcgisonline.map.main.ignoreCache(d)},c)),e.connect(c.layer,"onDeleteAttachmentsComplete",e.hitch(this,function(d){arcgisonline.map.main.ignoreCache(d)},c)))}))},initIgnoreCache:function(a){var c=new e.Deferred,d=arcgisonline.sharing.util.getUser();if(!(d&&a.url&&a.itemCard&&arcgisonline.sharing.util.isHostedService(a.url))||-1===e.indexOf(a.itemCard.typeKeywords,"Hosted Service")||-1===a.url.toLowerCase().indexOf("/featureserver")||a.itemCard.owner!==d.username&&"update"!==
a.itemCard.itemControl&&"admin"!==a.itemCard.itemControl)return c.callback(),c;d=a.url.toLowerCase().indexOf("/featureserver");var h=a.url.substring(0,d+14).replace("/rest/services","/rest/admin/services"),f=function(m){if(m.adminServiceInfo&&esri.isDefined(m.adminServiceInfo.cacheMaxAge)&&0<m.adminServiceInfo.cacheMaxAge&&m.layers){var t=0;e.forEach(m.layers,function(w){w.editingInfo&&w.editingInfo.lastEditDate&&(t=Math.max(t,w.editingInfo.lastEditDate))});0<t&&((new Date).getTime()-t)/1E3<m.adminServiceInfo.cacheMaxAge&&
arcgisonline.map.main.ignoreCache(a)}};arcgisonline.map.main.adminLayerInfos=arcgisonline.map.main.adminLayerInfos||{};if(arcgisonline.map.main.adminLayerInfos[h]){var g=function(m){var t=arcgisonline.map.main.adminLayerInfos[h];"failed"===t?m.callback():"inProgress"===t?setTimeout(e.hitch(this,function(){g(m)}),1E3):(f(t),m.callback())};g(c)}else{arcgisonline.map.main.adminLayerInfos[h]="inProgress";var n={f:"json",_ts:Math.round((new Date).getTime()/1E4)};arcgisonline.map.itemData.getServerToken(a).then(e.hitch(this,
function(m){n.token=m;esri.request({url:h,content:n,callbackParamName:"callback",load:e.hitch(this,function(t){arcgisonline.map.main.adminLayerInfos[h]=t;f(t);c.callback()}),error:function(t){arcgisonline.map.main.adminLayerInfos[h]="failed";c.callback()}})}),function(){arcgisonline.map.main.adminLayerInfos[h]="failed";c.callback()})}return c},ignoreCache:function(a){if(-1!==document.location.href.indexOf("viewer.html")){var c=arcgisonline.sharing.util.getUser();if(c&&a.url&&a.itemCard&&arcgisonline.sharing.util.isHostedService(a.url)&&
-1!==a.url.toLowerCase().indexOf("/featureserver")&&(a.itemCard.owner===c.username||"update"===a.itemCard.itemControl||"admin"===a.itemCard.itemControl)){c=a.url.toLowerCase().indexOf("/featureserver");var d=a.url.substring(0,c+14),h=d.replace("/rest/services","/rest/admin/services");arcgisonline.map.main.adminLayerInfos=arcgisonline.map.main.adminLayerInfos||{};(a=arcgisonline.map.main.adminLayerInfos[h])&&a.adminServiceInfo&&esri.isDefined(a.adminServiceInfo.cacheMaxAge)&&0!==a.adminServiceInfo.cacheMaxAge&&
(d=d.substring(7),h=h.substring(7),arcgisonline.map.main.cacheTimestamp=(new Date).getTime(),arcgisonline.map.main.requestPreCallbacks=arcgisonline.map.main.requestPreCallbacks||{},arcgisonline.map.main.requestPreCallbacks[d]||(arcgisonline.map.main.requestPreCallbacks[d]=!0,esri.setRequestPreCallback(e.hitch(this,function(f){f.url&&(-1<f.url.indexOf(d)||-1<f.url.indexOf(h))&&(f.content=f.content||{},f.content._ts=arcgisonline.map.main.cacheTimestamp);return f}))))}}},corsCheck:function(a){var c=
a.tileIndexUrl||a.url;!c||arcgisonline.sharing.util.isHostedService(c)||esri.hasSameOrigin(c,window.location.href)||-1===e.indexOf("esri.layers.FeatureLayer esri.layers.StreamLayer esri.layers.MapImageLayer esri.layers.ArcGISDynamicMapServiceLayer esri.layers.ArcGISImageServiceLayer esri.layers.ArcGISImageServiceVectorLayer esri.layers.ArcGISTiledMapServiceLayer".split(" "),a.declaredClass)||(arcgisonline.map.main.telemetry||(arcgisonline.map.main.telemetry=arcgisonline.telemetry["default"].init({name:"Map Viewer",
config:esriGeowConfig.self,logPageView:!1})),esri.canUseXhr(c)?arcgisonline.map.main.telemetry.logEvent({eventType:"click",category:"CORS",label:"yes"}):arcgisonline.map.main.telemetry.logEvent({eventType:"click",category:"CORS",label:"no"}))},logFeatureLayerLoadTime:function(a){esriGeowConfig.usageTrackingEnabled&&!arcgisonline.sharing.util.isPortal()&&(arcgisonline.map.main.telemetry||(arcgisonline.map.main.telemetry=arcgisonline.telemetry["default"].init({name:"Map Viewer",config:esriGeowConfig.self,
logPageView:!1})),a.onUpdateStartHndl=e.connect(a.layer,"onUpdateStart",function(){a.onUpdateStartTime=(new Date).getTime();e.disconnect(a.onUpdateStartHndl);delete a.onUpdateStartHndl}),a.onUpdateEndHndl=e.connect(a.layer,"onUpdateEnd",function(){var c=(new Date).getTime();if(a.onUpdateStartTime){var d=c-a.onUpdateStartTime;c=arcgisonline.sharing.util.isHostedService(a.url);var h=a.url;switch(a.layer.geometryType){case "esriGeometryPoint":var f="point";break;case "esriGeometryMultiPoint":f="multipoint";
break;case "esriGeometryPolyline":f="line";break;case "esriGeometryPolygon":f="polygon";break;default:f="unknown"}d={eventType:"performance",category:"load",action:"feature layer",label:"initial load",duration:d,attribute:"geometryType: "+f,details:c?"hosted":"not hosted",count:a.layer.graphics?a.layer.graphics.length:0};c&&(c=-1<h.indexOf("://")?h.split("/")[2]:h.split("/")[0],c=c.split(":")[0],d.urlRequested=c);arcgisonline.map.main.telemetry.logEvent(d);delete a.onUpdateStartTime}e.disconnect(a.onUpdateEndHndl);
delete a.onUpdateEndHndl}))},showRFxEditor:function(a){a&&(arcgisonline.map.main.rasterFunctionEditor?(arcgisonline.map.main.rasterFunctionEditor.set("parent",a.parent),arcgisonline.map.main.rasterFunctionEditor.set("item",a.item),arcgisonline.map.main.rasterFunctionEditor.open()):this.loadNewEditor(a))},updateRFxEditor:function(a){a&&arcgisonline.map.main.rasterFunctionEditor&&a.parent&&arcgisonline.map.main.rasterFunctionEditor.set("parent",a.parent)},loadNewEditor:function(a){a=a||{};a.showOnStart=
!0;arcgisonline.map.main.rasterFunctionEditor=null;a=new arcgisonline.sharing.dijit.RasterFunctionEditor(a,e.place(e.create("div"),document.body,"last"));a.startup();e.place(a.domNode,document.body);arcgisonline.map.main.rasterFunctionEditor=a},dojoPatch:function(){e.mixin(U.byId("dijitToolbar"),{_onContainerKeypress:function(a){if(!a.ctrlKey&&!a.altKey&&a.keyCode!=e.keys.HOME&&a.keyCode!=e.keys.END&&a.keyCode!=e.keys.LEFT_ARROW&&a.keyCode!=e.keys.RIGHT_ARROW){var c=this._keyNavCodes[a.charOrCode];
c&&(c(),event.stop(a))}}})}}})},"arcgisonline/map/popup":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/map/main,arcgisonline/map/dijit/StructuredPopupWidget,esri/tasks/RelationshipQuery,esri/ArcadeExpression,esri/arcadeProfiles/popupProfile,dojo/promise/all,dijit/DropDownMenu,dijit/PopupMenuItem,dijit/MenuItem,dojo/aspect,esri/layers/ArcGISImageServiceVectorLayer,esri/layers/ArcGISImageServiceLayer,esri/layers/RasterXLayer"],function(e,U,q){e.provide("arcgisonline.map.popup");
e.require("arcgisonline.map.main");e.require("arcgisonline.map.dijit.StructuredPopupWidget");e.require("esri.tasks.RelationshipQuery");e.require("esri.ArcadeExpression");e.require("esri.arcadeProfiles.popupProfile");e.require("dojo.promise.all");e.require("dijit.DropDownMenu");e.require("dijit.PopupMenuItem");e.require("dijit.MenuItem");e.require("dojo.aspect");e.require("esri.layers.ArcGISImageServiceVectorLayer");e.require("esri.layers.ArcGISImageServiceLayer");e.require("esri.layers.RasterXLayer");
arcgisonline.map.popup={onSelectionChangeHandler:null,feature:null,infoWindowHideHandler:null,footprintGraphic:null,onInfoWindowShowHandle:null,onClickEditLinkHandle:null,addEditLink:function(b,l){if(!isEmbedded||!isEmbedded.hideEdit&&!isEmbedded.isItemDetail){var p=b.getLayer();if(!(p&&p.getFeatureReduction&&p.getFeatureReduction())){p=e.query(".actionList",arcgisonline.map.main.map.infoWindow.domNode)[0];var r=e.query(".zoomTo",p);r&&r.length&&e.style(r[0],"whiteSpace","nowrap");r=e.byId("popupEditLink");
r||(e.create("span",{innerHTML:" "},p),p=e.create("span",{id:"popupEditLink","class":"action",style:"white-space: nowrap"},p),9>e.isIE&&e.create("br",null,p),r=e.create("a",{innerHTML:esri.i18nBundle.common.edit,href:"javascript:void(0);"},p));arcgisonline.map.popup.onClickEditLinkHandle&&(e.disconnect(arcgisonline.map.popup.onClickEditLinkHandle),arcgisonline.map.popup.onClickEditLinkHandle=null);arcgisonline.map.popup.onClickEditLinkHandle=e.connect(r,"onclick",function(a){a.preventDefault();(a=
(a=b.getLayer())&&arcgisonline.map.main.getParameterList(a))&&arcgisonline.map.featColl.isFeatureCollection(a);a&&a.itemId&&a.itemCard&&-1<a.itemCard.typeKeywords.indexOf("Route Layer")?arcgisonline.map.leftPanel.openLeftDirectionsPanel(null,{itemId:a.itemId}):arcgisonline.map.leftPanel.openLeftEditPanel(null,{feature:b,mapPoint:l})})}}},removeEditLink:function(){var b=e.byId("popupEditLink");b&&e.destroy(b)},addAddToMapLink:function(b,l){var p=b.attributes.type;arcgisonline.map.popup.infoWindowHideHandler&&
e.disconnect(arcgisonline.map.popup.infoWindowHideHandler);arcgisonline.map.popup.footprintGraphic&&(arcgisonline.map.main.map.graphics.remove(arcgisonline.map.popup.footprintGraphic),arcgisonline.map.popup.footprintGraphic=null);if(b.attributes.xmin&&b.attributes.ymin&&b.attributes.xmax&&b.attributes.ymax){var r=new esri.geometry.Extent(b.attributes.xmin,b.attributes.ymin,b.attributes.xmax,b.attributes.ymax,b.getLayer().fullExtent.spatialReference),a=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,
new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_DASH,new e.Color([0,0,0]),1),new e.Color([0,0,0,.2]));arcgisonline.map.popup.footprintGraphic=new esri.Graphic(r,a);arcgisonline.map.main.map.graphics.add(arcgisonline.map.popup.footprintGraphic);arcgisonline.map.popup.infoWindowHideHandler=e.connect(arcgisonline.map.main.map.infoWindow,"onHide",e.hitch(this,function(){arcgisonline.map.popup.footprintGraphic&&(arcgisonline.map.main.map.graphics.remove(arcgisonline.map.popup.footprintGraphic),
arcgisonline.map.popup.footprintGraphic=null);e.disconnect(arcgisonline.map.popup.infoWindowHideHandler)}))}r=function(){var h=b.attributes.link;h&&(arcgisonline.map.save_open.addServiceByUrl(h,null),arcgisonline.map.main.map.infoWindow.hide())};a=function(){var h=b.attributes.link;h&&(arcgisonline.map.save_open.switchBaseMapByUrl(h),arcgisonline.map.main.map.infoWindow.hide())};var c=e.query(".actionList",arcgisonline.map.main.map.infoWindow.domNode)[0],d=e.query(".zoomTo",c);d&&d.length&&e.style(d[0],
"whiteSpace","nowrap");d=e.byId("addToMap");d||(e.create("span",{innerHTML:" "},c),d=e.create("span",{id:"addToMap","class":"action",style:"white-space: nowrap"},c),9>e.isIE&&e.create("br",null,d),c=e.create("a",{innerHTML:esri.i18nBundle.arcGISOnlineServices.addToMap,alt:esri.i18nBundle.arcGISOnlineServices.addToMap,title:esri.i18nBundle.arcGISOnlineServices.addToMap,"class":"esriItemLinks",href:"JavaScript:void(0);",onclick:e.hitch(this,r)},d),"MapServer"!=p&&"ImageServer"!=p)||(p=e.create("div",
{innerHTML:"","class":"dijitReset dijitInline esriArrows",title:esri.i18nBundle.siteHeader.moreOptions,alt:esri.i18nBundle.siteHeader.moreOptions,style:{marginLeft:"5px",cursor:"pointer"}},d),new arcgisonline.sharing.dijit.TextMenu({triggerNode:p,labelNode:c,textMenuItems:[{label:esri.i18nBundle.arcGISOnlineServices.addToMap,onClick:e.hitch(this,r)},{label:esri.i18nBundle.arcGISOnlineServices.useAsBasemap,onClick:e.hitch(this,a)}]}))},removeAddToMapLink:function(){arcgisonline.map.popup.footprintGraphic&&
(arcgisonline.map.main.map.graphics.remove(arcgisonline.map.popup.footprintGraphic),arcgisonline.map.popup.footprintGraphic=null);arcgisonline.map.popup.infoWindowHideHandler&&e.disconnect(arcgisonline.map.popup.infoWindowHideHandler);arcgisonline.map.popup.infoWindowZoomToHandler&&e.disconnect(arcgisonline.map.popup.infoWindowZoomToHandler);var b=e.byId("addToMap");b||e.destroy(b)},addDirectionsLink:function(b,l){if(arcgisonline.map.role.canShowDirections()&&(!isEmbedded||!isEmbedded.hideDirections&&
!isEmbedded.isItemDetail)){arcgisonline.map.popup.removeDirectionsLink();var p=b.getLayer();if(!(p instanceof esri.layers.WMSLayer||p&&p.getFeatureReduction&&p.getFeatureReduction())){if(!p.map){var r=arcgisonline.map.main.map.popupManager.getMapLayer(b);if(r){if(r=arcgisonline.map.main.getParameterList(r),!r)return}else return}(r=p&&arcgisonline.map.main.getParameterList(p))&&arcgisonline.map.featColl.isFeatureCollection(r);if(!(r&&r.itemId&&r.itemCard&&-1<r.itemCard.typeKeywords.indexOf("Route Layer"))&&
(p=arcgisonline.sharing.util.getUser())&&p.accountId){p=e.query(".actionList",arcgisonline.map.main.map.infoWindow.domNode)[0];(r=e.query(".zoomTo",p))&&r.length&&e.style(r[0],"whiteSpace","nowrap");var a=b.attributes.RouteLayerItemID||b.attributes.routelayeritemid;r=e.byId("popupDirectionsLink");r||(e.create("span",{innerHTML:" "},p),p=e.create("span",{id:"popupDirectionsLink","class":"action directions",style:"white-space: nowrap"},p),9>e.isIE&&e.create("br",null,p),r=e.create("a",{innerHTML:a?
esri.i18nBundle.viewer.popup.openRoute:esri.i18nBundle.viewer.popup.directions,href:"javascript:void(0);"},p),arcgisonline.map.popup.directionsLinkHandler=e.connect(r,"onclick",e.hitch(this,function(c,d,h){h.preventDefault();(h=c.geometry)?"point"!==h.type&&(h=new esri.geometry.Point(d.x,d.y,c.geometry.spatialReference)):h=new esri.geometry.Point(d.x,d.y,d.spatialReference);d=c.getLayer();var f=d.name;if(!d.map){var g=arcgisonline.map.main.map.popupManager.getMapLayer(c);g&&(g=arcgisonline.map.main.getParameterList(g),
"mapNotes"===g.type&&(f=g.title))}if(a){arcgisonline.map.main.map.infoWindow.hide();var n=e.filter(arcgisonline.map.main.mapLayers,function(w){if(w.itemId===a)return w});if(n.length)n[0].visibility||(n[0].visibility=!0,e.forEach(n[0].visibleLayers.split(","),function(w){n[0].layers[parseInt(w)].visible||n[0].layers[parseInt(w)].show()}),e.publish("onLayerUpdate",["reopen"])),arcgisonline.map.dijit.toc.options.showTocTools(n[0].id);else{var m=e.connect(arcgisonline.map.main.map,"onLayerAdd",e.hitch(this,
function(w){e.disconnect(m);m=null;(w=arcgisonline.map.main.getParameterList(w))&&arcgisonline.map.dijit.toc.options.showTocTools(w.id)}));setTimeout(function(){m&&e.disconnect(m)},3E4);arcgisonline.map.save_open.openServiceItemCards(a,!1)}"contentStack"===arcgisonline.map.leftPanel.getLeftContentPanelStack()||arcgisonline.map.main.hasMapOnly()||arcgisonline.map.leftPanel.openLeftTOCPanel()}else{g=arcgisonline.map.main.getDirectionsDisplayField(d);g=c.attributes[g];var t="";d.objectIdField&&esri.isDefined(c.attributes[d.objectIdField])&&
(t=c.attributes[d.objectIdField]);c=new esri.Graphic(h,null,{layerName:f,objectIdInLayer:t,displayName:g});arcgisonline.map.leftPanel.openLeftDirectionsPanel(null,{feature:c})}},b,l)))}}}},removeDirectionsLink:function(){arcgisonline.map.popup.directionsLinkHandler&&(e.disconnect(arcgisonline.map.popup.directionsLinkHandler),arcgisonline.map.popup.directionsLinkHandler=null);var b=e.byId("popupDirectionsLink");b&&e.destroy(b)},setupPopupHandler:function(){arcgisonline.map.popup.onSelectionChangeHandler||
!arcgisonline.map.main.map||arcgisonline.map.edit.editActivated||(arcgisonline.map.main.map.setInfoWindowOnClick(!0),arcgisonline.map.popup.onSelectionChangeHandler=e.connect(arcgisonline.map.main.map.infoWindow,"onSelectionChange",e.hitch(arcgisonline.map.popup,"onPopupSelectionChange")))},disablePopupHandler:function(){arcgisonline.map.popup.onSelectionChangeHandler&&(arcgisonline.map.main.map.infoWindow.clearFeatures(),arcgisonline.map.main.map.infoWindow.hide(),arcgisonline.map.main.map.setInfoWindowOnClick(!1),
e.disconnect(arcgisonline.map.popup.onSelectionChangeHandler),arcgisonline.map.popup.onSelectionChangeHandler=null)},onPopupSelectionChange:function(){arcgisonline.map.geocode.removeAddToLayerLink();var b=arcgisonline.map.main.map.infoWindow.getSelectedFeature();if(b){var l=function(p){var r=arcgisonline.map.main.map.infoWindow.location,a=p.getLayer(),c,d=!0;a&&a.isEditable&&a.isEditable()?((c=arcgisonline.sharing.util.getUser())&&arcgisonline.sharing.util.isHostedService(a.url),c=a.getEditCapabilities({feature:p}),
a.mode!==esri.layers.FeatureLayer.MODE_SELECTION&&(c.canUpdate||c.canDelete)?arcgisonline.map.featColl.isFeatureCollectionLayer(a)||a instanceof esri.layers.CSVLayer?!arcgisonline.map.role.isAllowed("tool_edit_featCol")||!arcgisonline.map.role.isAllowed("tool_edit")||isEmbedded&&isEmbedded.hideEdit?arcgisonline.map.mapNotes.isMapNotesFeatColl(a.toJson())&&arcgisonline.map.role.isAllowed("tool_edit_mapNotes")?arcgisonline.map.popup.addEditLink(p,r):arcgisonline.map.popup.removeEditLink():arcgisonline.map.popup.addEditLink(p,
r):!arcgisonline.map.role.isAllowed("tool_edit")||isEmbedded&&isEmbedded.hideEdit?arcgisonline.map.popup.removeEditLink():arcgisonline.map.popup.addEditLink(p,r):arcgisonline.map.popup.removeEditLink()):arcgisonline.map.popup.removeEditLink();(c=arcgisonline.sharing.util.getUser())&&c.accountId&&esriGeowConfig.self.helperServices.route&&esriGeowConfig.self.helperServices.route.url&&(a?arcgisonline.map.popup.addDirectionsLink(p,r):arcgisonline.map.popup.removeDirectionsLink());a&&a.__isFootprintLayer&&
p.attributes&&p.attributes.link&&("MapServer"==p.attributes.type||"ImageServer"==p.attributes.type||"FeatureServer"==p.attributes.type)?arcgisonline.map.popup.addAddToMapLink(p,r):arcgisonline.map.popup.removeAddToMapLink();if(a&&a.relationships&&0<a.relationships.length){(c=p.getInfoTemplate())&&c.info&&(d=!esri.isDefined(c.info.relatedRecordsInfo)||!esri.isDefined(c.info.relatedRecordsInfo.showRelatedRecords)||c.info.relatedRecordsInfo&&c.info.relatedRecordsInfo.showRelatedRecords);var h=e.some(a.relationships,
function(f){f=arcgisonline.map.popup._getRelatedLayerUrl(a.url,f.relatedTableId);selMapTable=arcgisonline.map.popup._findRelatedTable(f).selMapTable;return esri.isDefined(selMapTable)},this);arcgisonline.map.popup.removeRelatedRecordsLink();d&&h&&arcgisonline.map.popup.addRelatedRecordsLink({feature:p,mapPoint:r,relations:a.relationships,relatedRecordsInfo:c.info.relatedRecordsInfo})}else arcgisonline.map.popup.removeRelatedRecordsLink()};arcgisonline.map.main.map.infoWindow.isShowing?l(b):(arcgisonline.map.popup.onInfoWindowShowHandle&&
(e.disconnect(arcgisonline.map.popup.onInfoWindowShowHandle),arcgisonline.map.popup.onInfoWindowShowHandle=null),arcgisonline.map.popup.onInfoWindowShowHandle=e.connect(arcgisonline.map.main.map.infoWindow,"onShow",e.hitch(this,function(p){e.disconnect(arcgisonline.map.popup.onInfoWindowShowHandle);arcgisonline.map.popup.onInfoWindowShowHandle=null;l(p)},b)))}else arcgisonline.map.popup.removeEditLink(),arcgisonline.map.popup.removeAddToMapLink(),arcgisonline.map.popup.removeDirectionsLink();b=e.query(".esri_matchButton");
b.length&&e.addClass(b[0],"calcite orange");b=e.query(".esri_deleteButton");b.length&&e.addClass(b[0],"calcite")},addPopupLayers:function(b){e.forEach(arcgisonline.map.main.mapLayers,function(l){(!b||b&&("base"===l.type||"labels"===l.type))&&l&&l.layer&&!l.layer.infoTemplates&&!l.disablePopup&&(l.itemLayers&&l.itemLayers.length?arcgisonline.map.main.getLayersInfo(l,e.hitch(this,function(){arcgisonline.map.main.hasDynamicLayers(l)?e.forEach(l.itemLayers,function(p){arcgisonline.map.popup.addPopupLayer(l,
p.id)}):e.forEach(l.layer.layerInfos,function(p){arcgisonline.map.popup.addPopupLayer(l,p.id)})})):l.popupInfo&&arcgisonline.map.popup._isImageServiceLayer(l.layer)&&arcgisonline.map.popup.addPopupLayer(l))})},addPopupLayer:function(b,l){if(b)if(arcgisonline.map.featColl.isFeatureCollection(b)||b.layer instanceof esri.layers.CSVLayer)if(b.layers)for(var p=0;p<b.layers.length;p++){if(p===l){var r=b.layers[p].__popupInfo;r&&arcgisonline.map.mapUtil.setInfoTemplate(b.layers[p],r)}}else(r=b.popupInfo)&&
arcgisonline.map.mapUtil.setInfoTemplate(b.layer,r);else if(b.layer instanceof esri.layers.GeoRSSLayer){var a=b.layer.getFeatureLayers()[l];(r=a.__popupInfo)&&arcgisonline.map.mapUtil.setInfoTemplate(a,r)}else if(b.layer instanceof esri.layers.WFSLayer)b.layer.setInfoTemplate(new esri.dijit.PopupTemplate(b.popupInfo));else if(b.layer instanceof esri.layers.StreamLayer)b.popupInfo&&arcgisonline.map.mapUtil.setInfoTemplate(b.layer,b.popupInfo);else if(!l&&0!==l&&arcgisonline.map.popup._isImageServiceLayer(b.layer))b.popupInfo&&
arcgisonline.map.mapUtil.setInfoTemplate(b.layer,b.popupInfo);else if(!l&&0!==l&&b.layer instanceof esri.layers.FeatureLayer)b.popupInfo&&arcgisonline.map.mapUtil.setInfoTemplate(b.layer,b.popupInfo),arcgisonline.map.main.updateLayerScaleInfo(b,b.layer);else{var c=r=null,d=null;a=l;var h=!1,f=[];if(b.itemLayers&&b.itemLayers.length){for(p=0;p<b.itemLayers.length;p++)if(b.itemLayers[p].id===l){arcgisonline.map.main.hasDynamicLayers(b)&&(a=b.itemLayers[p].layerDefinition.source.mapLayerId);b.itemLayers[p].disablePopup&&
(delete b.itemLayers[p].popupInfo,delete b.itemLayers[p].disablePopup);r=b.itemLayers[p].popupInfo;c=b.itemLayers[p].layerUrl;!esriGeowConfig.allSSL&&"https:"!=location.protocol||!arcgisonline.sharing.util.isHostedService(c)&&!arcgisonline.sharing.util.supportsHttps(c)||(c=c.replace("http:","https:"));d=b.itemLayers[p]._layerInfo;if(r&&!d){h=!0;var g=new e.Deferred;f.push(g);arcgisonline.map.main.getLayerInfo(b,a).then(function(n){d=n;b.layer.infoTemplates=b.layer.infoTemplates||{};b.layer.infoTemplates[l]=
{infoTemplate:new esri.dijit.PopupTemplate(r),layerUrl:c,resourceInfo:d};g.callback()})}break}f.length&&(new e.DeferredList(f)).addCallback(function(n){leftPanel&&leftPanel.checkLegendStack()})}r||(p=arcgisonline.map.main.getFlForMSL(b,l))&&p.popupInfo&&(r=p.popupInfo,c=p.url,d=p.serviceInfo);if(r&&!d&&b.layersInfo&&b.layersInfo.layers)for(p=0;p<b.layersInfo.layers.length;p++)if(b.layersInfo.layers[p].id==a){d=b.layersInfo.layers[p];d||(h=!0,arcgisonline.map.main.getLayerInfo(b,a).then(function(n){d=
n;b.layer.infoTemplates=b.layer.infoTemplates||{};b.layer.infoTemplates[l]={infoTemplate:new esri.dijit.PopupTemplate(r),layerUrl:c,resourceInfo:d}}));break}r&&!h&&(b.layer.infoTemplates=b.layer.infoTemplates||{},b.layer.infoTemplates[l]={infoTemplate:new esri.dijit.PopupTemplate(r),layerUrl:c,resourceInfo:d})}},removePopupLayers:function(b){b&&b.layer&&b.layer.infoTemplates&&e.forEach(b.layer.layerInfos,function(l){b.layer.infoTemplates[l.id]&&(arcgisonline.map.main.map.infoWindow.clearFeatures(),
delete b.layer.infoTemplates[l.id])})},removePopup:function(b,l){arcgisonline.map.main.map&&arcgisonline.map.main.map.infoWindow&&arcgisonline.map.main.map.infoWindow.hide();if(arcgisonline.map.featColl.isFeatureCollection(b)||b.layer instanceof esri.layers.CSVLayer)if(b.layers||b.tables){var p=b.layers;b.tables&&(p=p.concat(b.tables));for(var r=0;r<p.length;r++)p[r].id===l&&(arcgisonline.map.mapUtil.setInfoTemplate(p[r],null),p[r].__popupInfo&&delete p[r].__popupInfo)}else arcgisonline.map.mapUtil.setInfoTemplate(b.layer,
null),b.popupInfo&&delete b.popupInfo,b.layer.__popupInfo&&delete b.layer.__popupInfo;else if(b.layer instanceof esri.layers.GeoRSSLayer)l=l||0,p=b.layer.getFeatureLayers(),arcgisonline.map.mapUtil.setInfoTemplate(p[l],null),p[l].__popupInfo&&delete p[l].__popupInfo;else if(b.layer instanceof esri.layers.WFSLayer)arcgisonline.map.mapUtil.setInfoTemplate(b.layer,null),b.popupInfo&&delete b.popupInfo;else if(!l&&0!==l&&(b.layer instanceof esri.layers.FeatureLayer||arcgisonline.map.popup._isImageServiceLayer(b.layer)))arcgisonline.map.mapUtil.setInfoTemplate(b.layer,
null),delete b.popupInfo;else if(b.layer&&b.layer.infoTemplates){if(b.layer.infoTemplates[l])if(arcgisonline.map.main.map.infoWindow.clearFeatures(),delete b.layer.infoTemplates[l],b.itemLayers&&b.itemLayers.length)for(r=0;r<b.itemLayers.length;r++){if(b.itemLayers[r].id===l){delete b.itemLayers[r].popupInfo;delete b.itemLayers[r].layerUrl;delete b.itemLayers[r].layerItemId;delete b.itemLayers[r]._layerInfo;break}}else(p=arcgisonline.map.main.getFlForMSL(b,l))&&delete p.popupInfo;b.thematicGroup&&
(b.disablePopup=!0)}},hasPopup:function(b,l){if(arcgisonline.map.featColl.isFeatureCollection(b)||b.layer instanceof esri.layers.CSVLayer)if(b.layers||b.tables){var p=b.layers;b.tables&&(p=p.concat(b.tables));for(var r=0;r<p.length;r++)if((p[r].id===l||p[r].id===b.id+"_"+l)&&(p[r].__popupInfo||p[r].infoTemplate))return!0}else{if(b.layer.infoTemplate)return!0}else if(b.layer instanceof esri.layers.GeoRSSLayer){if(esri.isDefined(l)){p=b.layer.getFeatureLayers();var a=!1;e.forEach(p,function(c,d){d==
l&&c.infoTemplate&&(a=!0)});return a}if(b.layer.getFeatureLayers()[0].infoTemplate)return!0}else{if(b.layer instanceof esri.layers.WMSLayer&&esri.isDefined(l))return b.layer.layerInfos[l].showPopup;if(b.layer instanceof esri.layers.WFSLayer)return b.layer.infoTemplate?!0:!1;if(esri.isDefined(l))if(p=arcgisonline.map.main.getFlForMSL(b,l)){if(p.popupInfo)return!0}else{if(b.itemLayers&&b.itemLayers.length)for(r=0;r<b.itemLayers.length;r++)if(b.itemLayers[r].id===l)if(b.itemLayers[r].popupInfo)if(b.itemLayers[r].layerUrl||
b.itemLayers[r].layerItemId){if(b.itemLayers[r]._layerInfo)return!0;break}else return!0;else break}else if((arcgisonline.map.popup._isImageServiceLayer(b.layer)||b.layer instanceof esri.layers.FeatureLayer)&&b.popupInfo)return!0}return!1},getPopupInfo:function(b,l){if(arcgisonline.map.featColl.isFeatureCollection(b)||b.layer instanceof esri.layers.CSVLayer)if(b.layers||b.tables){var p=b.layers;b.tables&&(p=p.concat(b.tables));for(var r=0;r<p.length;r++)if((r===l||p[r].id===l)&&p[r].infoTemplate)return p[r].__popupInfo}else{if(b.layer.infoTemplate)return b.popupInfo}else if(b.layer instanceof
esri.layers.GeoRSSLayer)for(p=b.layer.getFeatureLayers(),r=0;r<p.length;r++){var a=p[r];if(a.id===l&&a.infoTemplate)return a.__popupInfo}else{if(b.layer instanceof esri.layers.WFSLayer)return b.popupInfo;if(!l&&0!==l)if(arcgisonline.map.popup._isImageServiceLayer(b.layer)||b.layer instanceof esri.layers.FeatureLayer){if(b.popupInfo)return b.popupInfo}else if(r=arcgisonline.map.main.getFlForMSL(b,l)){if(r.popupInfo)return r.popupInfo}else{if(b.itemLayers&&b.itemLayers.length)for(r=0;r<b.itemLayers.length;r++)if(b.itemLayers[r].id===
l){if(b.itemLayers[r].popupInfo)return b.itemLayers[r].popupInfo;break}}else if((l||0===l)&&b.itemLayers&&b.itemLayers.length)for(r=0;r<b.itemLayers.length;r++)if(b.itemLayers[r].id===l){if(b.itemLayers[r].popupInfo)return b.itemLayers[r].popupInfo;break}}return null},getDefaultPopupInfo:function(b,l,p){var r=arcgisonline.map.popup.getDisplayField(b),a=b.fields;e.some(a,function(t){return t.name===r})||(r=null);l=b.name+(r&&r.length?": {"+r+"}":"");var c=!1,d=!1,h=!1;p&&arcgisonline.map.popup._isImageServiceLayer(p)&&
(a=p.getCustomRasterFields({rasterAttributeTableFieldPrefix:"Raster."}),h=0>e.indexOf(["F32","F64"],p.pixelType),p&&p.capabilities&&(d=(c=p.capabilities&&-1<p.capabilities.toLowerCase().indexOf("catalog")||p.fields&&0<p.fields.length)&&("esriImageServiceDataTypeVector-UV"===p.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===p.serviceDataType)));var f={esriFieldTypeDouble:1,esriFieldTypeSingle:1},g={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1},n={esriFieldTypeDate:1},m=",";b.editFieldsInfo&&
(b.editFieldsInfo.creatorField&&(m+=b.editFieldsInfo.creatorField+","),b.editFieldsInfo.creationDateField&&(m+=b.editFieldsInfo.creationDateField+","),b.editFieldsInfo.editorField&&(m+=b.editFieldsInfo.editorField+","),b.editFieldsInfo.editDateField&&(m+=b.editFieldsInfo.editDateField+","),m=m.toLowerCase());a=e.map(a,e.hitch(this,function(t,w){var u="esriFieldTypeOID"!==t.type&&"esriFieldTypeGlobalID"!==t.type&&"esriFieldTypeGUID"!==t.type&&"esriFieldTypeGeometry"!==t.type;u&&b.objectIdField&&(u=
t.name!==b.objectIdField);var v,x=t.editable&&"esriFieldTypeOID"!==t.type&&"esriFieldTypeGlobalID"!==t.type&&"esriFieldTypeGUID"!==t.type;if(u){var y=t.name.toLowerCase(),C=m+"stretched value,fnode_,tnode_,lpoly_,rpoly_,poly_,subclass,subclass_,rings_ok,rings_nok,";c&&(C+="raster.itempixelvalue,",d&&(C+="raster.magnitude,raster.direction,"));if(-1<C.indexOf(","+y+",")||-1<y.indexOf("shape")||-1<y.indexOf("perimeter")||-1<y.indexOf("objectid")||-1<y.indexOf("raster.servicepixelvalue.")||-1<y.indexOf("_i")&&
y.indexOf("_i")==y.length-2||t.name===b.objectIdField)u=!1;t.type in g?v={places:0,digitSeparator:!0}:t.type in f?v={places:h&&(-1<y.indexOf("raster.servicepixelvalue")||-1<y.indexOf("raster.itempixelvalue"))?0:2,digitSeparator:!0}:t.type in n&&(10<=b.currentVersion||p&&10<=p.version)&&(v={dateFormat:"shortDateShortTime"})}x=x?-1===m.indexOf(","+t.name.toLowerCase()+","):x;u=e.mixin({},{fieldName:t.name,label:t.alias,isEditable:x,tooltip:"",visible:u,stringFieldOption:"textbox"});v&&(u.format=v);
return u}));l={title:l,fieldInfos:a,description:null,showAttachments:!0,mediaInfos:[]};!p||!this._isImageServiceLayer(p)||p instanceof esri.layers.RasterXLayer||(l.layerOptions={},l.layerOptions.showNoDataRecords=!0,l.layerOptions.returnTopmostRaster=p&&p.currentVersion?10.8<=p.currentVersion:!1);return l},getDisplayField:function(b){var l=b.displayField?b.displayField.trim():null;if(!l&&b.fields&&(l=arcgisonline.map.popup.getFirstNameOrTitleField(b.fields),!l&&(l=arcgisonline.map.popup.getFirstUniqueIdentifierField(b.fields),
!l&&(l=arcgisonline.map.popup.getFirstTypeOrCategoryField(b.fields),!l))))for(var p=0;p<b.fields.length;p++){var r=b.fields[p];if(-1<r.name.toLowerCase().indexOf("name")||-1<r.name.toLowerCase().indexOf("title"))l=r.name}return l},getFirstNameOrTitleField:function(b){for(var l=0;l<b.length;l++){var p=b[l];if(p.description){var r=e.json.parse(p.description);if(r&&"nameOrTitle"===r.fieldValueType)return p.name}}return null},getFirstUniqueIdentifierField:function(b){for(var l=0;l<b.length;l++){var p=
b[l];if(p.description){var r=e.json.parse(p.description);if(r&&"uniqueIdentifier"===r.fieldValueType)return p.name}}return null},getFirstTypeOrCategoryField:function(b){for(var l=0;l<b.length;l++){var p=b[l];if(p.description){var r=e.json.parse(p.description);if(r&&"typeOrCategory"===r.fieldValueType)return p.name}}return null},updateLayerWithPopupFieldAlias:function(b,l,p){var r=arcgisonline.map.popup.getPopupInfo(b,p);r&&r.fieldInfos?e.forEach(l.fields,e.hitch(this,function(a,c){var d;a:{for(d=
0;d<r.fieldInfos.length;d++){var h=r.fieldInfos[d];if(h.fieldName==a.name){d=h.label;break a}}d=null}a.alias=d||a.alias}),this):e.forEach(l.fields,e.hitch(this,function(a,c){var d;a:{if(b.serviceInfo)for(d=0;d<b.serviceInfo.fields.length;d++){var h=b.serviceInfo.fields[d];if(h.name==a.name){d=h.alias;break a}}d=null}a.alias=d||a.alias}),this)},_extentFromPoint:function(b){var l=arcgisonline.map.main.map.toScreen(b);b=new esri.geometry.Point(l.x-5,l.y+5);l=new esri.geometry.Point(l.x+5,l.y-5);b=arcgisonline.map.main.map.toMap(b);
l=arcgisonline.map.main.map.toMap(l);return new esri.geometry.Extent(b.x,b.y,l.x,l.y,arcgisonline.map.main.map.spatialReference)},_calculateClickTolerance:function(b){var l=6;e.forEach(b,function(p){(p=p.layer.renderer)&&"esri.renderer.SimpleRenderer"===p.declaredClass?(p=p.symbol,p.xoffset&&(l=Math.max(l,Math.abs(p.xoffset))),p.yoffset&&(l=Math.max(l,Math.abs(p.yoffset)))):!p||"esri.renderer.UniqueValueRenderer"!==p.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==p.declaredClass||e.forEach(p.infos,
function(r){r=r.symbol;r.xoffset&&(l=Math.max(l,Math.abs(r.xoffset)));r.yoffset&&(l=Math.max(l,Math.abs(r.yoffset)))})});return l},toc_enablePopup:function(b,l){if(arcgisonline.map.featColl.isFeatureCollection(b)||b.layer instanceof esri.layers.CSVLayer)if(b.layers||b.tables){var p=b.layers;b.tables&&(p=p.concat(b.tables));p=p[l];var r=p.getFeatureReduction&&p.getFeatureReduction();r&&r.disablePopup&&(delete r.disablePopup,p.setFeatureReduction(r));p.__popupInfo=arcgisonline.map.featColl.generateDefaultPopupInfo(p.toJson());
arcgisonline.map.mapUtil.setInfoTemplate(p,p.__popupInfo);b.popupChanged=!0;delete p.__disablePopup}else b.layer&&((r=b.layer.getFeatureReduction&&b.layer.getFeatureReduction())&&r.disablePopup&&(delete r.disablePopup,b.layer.setFeatureReduction(r)),b.popupInfo=arcgisonline.map.featColl.generateDefaultPopupInfo(b.layer.toJson()),arcgisonline.map.mapUtil.setInfoTemplate(b.layer,b.popupInfo),b.popupChanged=!0,delete b.disablePopup);else if(b.layer instanceof esri.layers.GeoRSSLayer)p=b.layer.getFeatureLayers(),
e.forEach(p,function(h,f){f===l&&(h.__popupInfo=arcgisonline.map.featColl.generateDefaultPopupInfo(h.toJson()),arcgisonline.map.mapUtil.setInfoTemplate(h,h.__popupInfo),b.popupChanged=!0,delete h.__disablePopup)},this);else if(b.layer instanceof esri.layers.WMSLayer)b.layer.layerInfos[l].showPopup=!0,b.popupChanged=!0;else if(b.layer instanceof esri.layers.WFSLayer)b.popupInfo=arcgisonline.map.popup.getDefaultPopupInfo({name:b.title,fields:b.layer.fields},!1,b.layer),b.layer.setInfoTemplate(new esri.dijit.PopupTemplate(b.popupInfo)),
b.popupChanged=!0,delete b.disablePopup;else if(b.layer instanceof esri.layers.StreamLayer)b.itemId&&(p=arcgisonline.map.itemData.itemDataContents[b.itemId])&&p.popupInfo&&(b.popupInfo=e.clone(p.popupInfo)),b.popupInfo=b.popupInfo||arcgisonline.map.popup.getDefaultPopupInfo(b.serviceInfo,b.layer.isEditable?b.layer.isEditable():!1,b.layer),arcgisonline.map.mapUtil.setInfoTemplate(b.layer,b.popupInfo),b.popupChanged=!0,delete b.disablePopup;else if(b.layer instanceof esri.layers.FeatureLayer||arcgisonline.map.popup._isImageServiceLayer(b.layer))b.itemId&&
b.origItemLayers&&b.url&&(p=parseInt(b.url.substring(b.url.lastIndexOf("/")+1,b.url.length)),(p=arcgisonline.map.main.getItemWithId(b.origItemLayers,p))&&p.popupInfo&&(b.popupInfo=e.clone(p.popupInfo))),(r=b.layer.getFeatureReduction&&b.layer.getFeatureReduction())&&r.disablePopup&&(delete r.disablePopup,b.layer.setFeatureReduction(r)),b.popupInfo=b.popupInfo||arcgisonline.map.popup.getDefaultPopupInfo(b.serviceInfo,b.layer.isEditable?b.layer.isEditable():!1,b.layer),arcgisonline.map.popup.addPopupLayer(b,
null),b.popupChanged=!0,delete b.disablePopup;else if(b.queryServiceUrl){var a=b.layer.layerInfos[l],c=function(h,f){if(b.itemId&&b.origItemLayers){var g=arcgisonline.map.main.getItemWithId(b.origItemLayers,a.id);g&&g.popupInfo&&g.layerUrl===b.queryServiceUrl+"/"+a.id&&(h=e.clone(g.popupInfo))}if(!b.itemLayers||arcgisonline.isEmpty(b.itemLayers))b.itemLayers=[],e.forEach(b.layer.layerInfos,function(m){b.itemLayers.push({id:m.id})}),g=arcgisonline.map.main.getItemWithId(b.itemLayers,a.id),e.mixin(g,
{layerUrl:b.queryServiceUrl+"/"+a.id,layerItemId:b.queryServiceItemId,popupInfo:h,_layerInfo:f});else{g=!1;for(var n=0;n<b.itemLayers.length;n++)if(b.itemLayers[n].id===a.id){b.itemLayers[n].layerUrl=b.queryServiceUrl+"/"+a.id;b.itemLayers[n].layerItemId=b.queryServiceItemId;b.itemLayers[n].popupInfo=h;b.itemLayers[n]._layerInfo=f;g=!0;break}g||b.itemLayers.push({id:a.id,layerUrl:b.queryServiceUrl+"/"+a.id,layerItemId:b.queryServiceItemId,popupInfo:h,_layerInfo:f})}arcgisonline.map.popup.addPopupLayer(b,
a.id);b.popupChanged=!0},d=function(){arcgisonline.map.main.getLayerInfoForQuery(b,a.id,null).then(function(h){var f=!1,g=h.capabilities?h.capabilities.toLowerCase():"";if(-1<g.indexOf("create")||-1<g.indexOf("edit")||-1<g.indexOf("delete")||-1<g.indexOf("update"))f=!0;var n;b.itemId&&b.origItemLayers&&(g=arcgisonline.map.main.getItemWithId(b.origItemLayers,a.id))&&g.popupInfo&&g.layerUrl===b.queryServiceUrl+"/"+a.id&&(n=e.clone(g.popupInfo));n=n||arcgisonline.map.popup.getDefaultPopupInfo(h,f);c(n,
h)})};b.queryServiceItemId?arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+"content/items/"+b.queryServiceItemId+"/data"},{disableIdentityLookup:!0}).then(e.hitch(this,function(h){if(h&&h.layers){for(var f=!1,g=0;g<h.layers.length;g++)if(a.id==h.layers[g].id){h.layers[g].popupInfo&&(f=!0,c(h.layers[g].popupInfo));break}f||d()}else d()}),e.hitch(this,function(h){d()})):d()}else b.layer instanceof esri.layers.ArcGISTiledMapServiceLayer&&(!b.layer.capabilities||-1===b.layer.capabilities.toLowerCase().indexOf("query"))?
(a=b.layer.layerInfos[l],p=(new U.Dialog).placeAt(document.body),r=new arcgisonline.sharing.dijit.dialog.QueryLayerDlg({dialog:p}),p.set({title:esri.i18nBundle.QueryLayerDlg.title,content:r}),p.show(),r.start(b,a.id)):(a=arcgisonline.map.main.hasDynamicLayers(b)?b.layer.dynamicLayerInfos[l]:b.layer.layerInfos[l],arcgisonline.map.main.getLayerInfoForQuery(b,a.id).then(function(h){var f;if(b.itemId&&b.origItemLayers){var g=arcgisonline.map.main.getItemWithId(b.origItemLayers,a.id);g&&g.popupInfo&&(f=
e.clone(g.popupInfo))}f=f||arcgisonline.map.popup.getDefaultPopupInfo(h,!1,b.layer);if(h=arcgisonline.map.main.getFlForMSL(b,a.id))h.popupInfo=f,h.popupChanged=!0;else if(b.itemLayers){h=!1;for(g=0;g<b.itemLayers.length;g++)if(b.itemLayers[g].id===a.id){b.itemLayers[g].popupInfo=f;h=!0;break}h||b.itemLayers.push({id:a.id,popupInfo:f})}else b.itemLayers=[],e.forEach(b.layer.layerInfos,function(n){b.itemLayers.push({id:n.id})}),g=arcgisonline.map.main.getItemWithId(b.itemLayers,a.id),g.popupInfo=f;
arcgisonline.map.popup.addPopupLayer(b,a.id);b.popupChanged=!0}));arcgisonline.map.main.markMapAsChanged("enablePopup");e.publish("_onRendererUpdate",[])},toc_removePopup:function(b,l){if(arcgisonline.map.featColl.isFeatureCollection(b)||b.layer instanceof esri.layers.CSVLayer)if(b.layers||b.tables){var p=b.layers;b.tables&&(p=p.concat(b.tables));arcgisonline.map.popup.removePopup(b,p[l].id);b.__disablePopup=!0;b.popupChanged=!0}else b.layer&&(arcgisonline.map.popup.removePopup(b),b.disablePopup=
!0,b.popupChanged=!0);else b.layer instanceof esri.layers.GeoRSSLayer?(p=b.layer.getFeatureLayers(),e.forEach(p,function(r,a){a===l&&(arcgisonline.map.popup.removePopup(b,a),r.__disablePopup=!0,b.popupChanged=!0)},this)):(b.layer instanceof esri.layers.WMSLayer?delete b.layer.layerInfos[l].showPopup:b.layer instanceof esri.layers.WFSLayer?arcgisonline.map.popup.removePopup(b):b.layer instanceof esri.layers.FeatureLayer||arcgisonline.map.popup._isImageServiceLayer(b.layer)?(arcgisonline.map.popup.removePopup(b),
b.disablePopup=!0):-1===l?arcgisonline.map.main.hasDynamicLayers(b)?e.forEach(b.layer.dynamicLayerInfos,function(r){arcgisonline.map.popup.removePopup(b,r.id)}):e.forEach(b.layer.layerInfos,function(r){arcgisonline.map.popup.removePopup(b,r.id)}):(p=arcgisonline.map.main.hasDynamicLayers(b)?b.layer.dynamicLayerInfos[l]:b.layer.layerInfos[l],arcgisonline.map.popup.removePopup(b,p.id)),b.popupChanged=!0);arcgisonline.map.main.markMapAsChanged("removePopup");e.publish("_onRendererUpdate",[])},hasFeatureSetMapExpression:function(b){var l=
!1;(b=b.popupInfo)&&b.expressionInfos&&e.forEach(b.expressionInfos,function(p){p=new esri.ArcadeExpression({expression:p.expression,returnType:p.returnType,profile:esri.arcadeProfiles.popupProfile});esri.support.expressionUtils.hasFeatureSetOperations(p.syntaxTree)&&esri.support.expressionUtils.hasVariable(p.syntaxTree,"$map")&&(l=!0)},this);return l},addRelatedRecordsLink:function(b){if(!b)return!1;var l=b.feature,p=b.relations,r=e.query(".actionList",arcgisonline.map.main.map.infoWindow.domNode)[0],
a=e.byId("popupRelationsLink"),c=e.query(".zoomTo",r);c&&c.length&&e.style(c[0],"whiteSpace","nowrap");(c=e.query(".directions",r))&&c.length&&e.style(c[0],"whiteSpace","nowrap");a&&(arcgisonline.map.popup.removeRelatedRecordsLink(),a=e.byId("popupRelationsLink"));if(!p||0===p.length)return!1;if(1===p.length)a||(e.create("span",{innerHTML:" "},r),a=e.create("a",{id:"popupRelationsLink","class":"action related",innerHTML:esri.i18nBundle.popupBuilder.showRelatedRecords,href:"javascript:void(0);",style:"white-space: nowrap;"},
r)),arcgisonline.map.popup.relationsLinkHandler=e.connect(a,"onclick",e.hitch(this,this._handleRelatedRecordsClick,l,p[0],{relatedRecordsInfo:b.relatedRecordsInfo}));else if(!a){a=new U.DropDownMenu({},e.create("div",{id:"popupRelationsLink"},r));var d=new U.Menu({});var h=l.getSourceLayer();e.forEach(p,function(f){var g=this._getRelatedLayerUrl(h.url,f.relatedTableId);g=this._findRelatedTable(g).selMapTable;f=new U.MenuItem({label:g?g.title?g.title:g.layer.name:f.name,onClick:e.hitch(this,this._handleRelatedRecordsClick,
l,f,{relatedRecordsInfo:b.relatedRecordsInfo})});d.addChild(f)},this);a.addChild(new U.PopupMenuItem({label:esri.i18nBundle.popupBuilder.showRelatedRecords,popup:d}))}},removeRelatedRecordsLink:function(){arcgisonline.map.popup.relationsLinkHandler&&(e.disconnect(arcgisonline.map.popup.relationsLinkHandler),arcgisonline.map.popup.relationsLinkHandler=null);var b=e.byId("popupRelationsLink"),l=U.byId("popupRelationsLink");b&&(l&&l.destroyRecursive(!1),(b=e.byId("popupRelationsLink"))&&e.destroy(b),
b=null)},_getOrderedByFields:function(b,l){if(!b||!b.orderByFields||!l)return null;var p=e.map(b.orderByFields,function(r){var a=r.field&&-1!==r.field.indexOf("relationships/")&&r.field.split("/");if(parseInt(a[1],10)===l.id)return a[2]+" "+r.order.toUpperCase()},this);return p=e.filter(p,function(r){return esri.isDefined(r)})},_getRelatedLayerUrl:function(b,l){var p=esri.isDefined(b)&&esri.isDefined(l)?b.replace(/[0-9|\w]+$/i,l):"",r=p.lastIndexOf("//");-1!==r&&r!==p.indexOf("//")&&(p=p.substring(0,
r)+p.substring(r+1,p.length));return p},_handleRelatedRecordsClick:function(b,l,p){var r;this._getRelatedRecords(b,l,p).then(e.hitch(this,function(a){r=b.getSourceLayer();if(a&&a[b.attributes[r.objectIdField]]){var c={},d=this._getOrderedByFields(p.relatedRecordsInfo,l);c.relatedFeatures=a[b.attributes[r.objectIdField]].features;c.relatedlayerUrl=this._getRelatedLayerUrl(r.url,l.relatedTableId);c.feature=b;d&&(c.orderByFields=d);this._showRelatedTable(c)}else this._showNoResultsDlg()}),e.hitch(this,
function(a){}))},_getRelatedRecords:function(b,l,p){var r=b.getSourceLayer();var a=new esri.tasks.RelationshipQuery;a.outFields=["*"];a.relationshipId=l.id;a.objectIds=[b.attributes[r.objectIdField]];p.relatedRecordsInfo&&p.relatedRecordsInfo.orderByFields&&(e.map(p.relatedRecordsInfo.orderByFields,function(c){var d=c.field&&-1!==c.field.indexOf("relationships/")&&c.field.split("/");if(parseInt(d[1],10)===l.id)return d[2]+" "+c.order.toUpperCase()}),a.orderByFields=this._getOrderedByFields(p.relatedRecordsInfo,
l));return r.queryRelatedFeatures(a)},_getObjectIDField:function(b){return e.filter(b,function(l){return"esriFieldTypeOID"===l.type})[0]},_showRelatedTable:function(b){if(!b||!b.relatedlayerUrl||!b.relatedFeatures)return!1;var l=b.relatedFeatures,p=this._findRelatedTable(b.relatedlayerUrl),r=p.selMapTable,a=p.tableId,c;r&&r.layer?(l=e.map(l,function(d){var h=d.getLayer(),f;void 0!==a&&h.url.endsWith("/dynamicLayer")&&void 0!==r.layersInfo&&(f=arcgisonline.map.main.getItemWithId([].concat(r.layersInfo.layers,
r.layersInfo.tables),a));if(r.layer.objectIdField)var g=r.layer.objectIdField;else h.url.endsWith("/dynamicLayer")&&void 0!==f&&void 0!==f.fields?(c=this._getObjectIDField(f.fields),void 0!==c&&(g=c.name)):g=h.objectIdField;return d.attributes[g]},this))&&l.length?(l={mapLayer:r,subLayerId:a,ids:l},b.orderByFields&&(l.orderByFields=b.orderByFields),arcgisonline.map.table.popup_showRelatedRecordsTable(l)):this._showNoResultsDlg():this._showNoResultsDlg()},_findRelatedTable:function(b){var l,p;0<arcgisonline.map.main.mapLayers.length&&
e.some(arcgisonline.map.main.mapLayers,function(a,c){var d=a.layersInfo&&a.layersInfo.layers?a.layersInfo.layers:a.queryServiceUrl?a.queryLayersInfo.layers:[];if(a.layer&&a.layer.url===b)return l=a,!0;if(d&&0<d.length){var h=parseInt(b.substring(b.lastIndexOf("/")+1),10),f=a.layer instanceof esri.layers.ArcGISTiledMapServiceLayer,g;a.layer.url&&(g=a.layer.url+"/"+h);f&&g&&(g=g.replace("MapServer","FeatureServer"));if(g===b&&d[h])return l=a,p=h,!0}});if(!l&&0<arcgisonline.map.main.mapTables.length){var r=
parseInt(b.substring(b.lastIndexOf("/")+1),10);e.some(arcgisonline.map.main.mapTables,function(a,c){var d=a.layer instanceof esri.layers.ArcGISTiledMapServiceLayer;if(a.layer&&a.layer.url===b)return l=a,d&&(p=r),!0})}return{selMapTable:l,tableId:p}},_showNoResultsDlg:function(){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.myOrganization.noData.searchTitle,message:esri.i18nBundle.searchPage.noResultsFound})},_isImageServiceLayer:function(b){return b instanceof
esri.layers.ArcGISImageServiceLayer||b instanceof esri.layers.ArcGISImageServiceVectorLayer||b instanceof esri.layers.RasterXLayer}}})},"arcgisonline/map/dijit/StructuredPopupWidget":function(){define(["dojo","dijit","dojox","dojo/require!dijit/_Widget,dijit/_Templated,dojox/charting/Chart2D,dojox/charting/themes/PlotKit/blue,dojox/charting/action2d/Tooltip,dojox/charting/action2d/Highlight,dojox/charting/widget/Legend"],function(e,U,q){e.provide("arcgisonline.map.dijit.StructuredPopupWidget");e.require("dijit._Widget");
e.require("dijit._Templated");e.require("dojox.charting.Chart2D");e.require("dojox.charting.themes.PlotKit.blue");e.require("dojox.charting.action2d.Tooltip");e.require("dojox.charting.action2d.Highlight");e.require("dojox.charting.widget.Legend");e.declare("arcgisonline.map.dijit.StructuredPopupWidget",[U._Widget,U._Templated],{templateString:"\x3cdiv\x3e\x3cdiv dojoAttachPoint\x3d'_descriptionNode'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_pictureNode'\x3e\x3c/div\x3e\x3c/div\x3e",startup:function(){this.inherited(arguments);
var b=this.definition,l=this.graphic.attributes,p=esri.substitute(l,b.description);this._descriptionNode.innerHTML=p;l.IMAGE_URL&&l.IMAGE_LINK_URL?(p="\x3cA href\x3d'"+esri.substitute(l,b.pictureLink)+"' target\x3d'_blank'\x3e\x3cimg src\x3d'"+esri.substitute(l,b.picture)+"' /\x3e\x3c/A\x3e",e.place(p,this._pictureNode,"only")):l.IMAGE_URL?(p="\x3cimg src\x3d'"+esri.substitute(l,b.picture)+"' /\x3e",e.place(p,this._pictureNode,"only")):l.IMAGE_LINK_URL&&(p="\x3cA href\x3d'"+esri.substitute(l,b.pictureLink)+
"' target\x3d'_blank'\x3e"+esri.substitute(l,b.pictureLink)+"\x3c/A\x3e",e.place(p,this._pictureNode,"only"));if(b.chart){var r=b.chart;p=this._chart=new q.charting.Chart2D(this._chartNode);p.setTheme(q.charting.themes.PlotKit.blue);p.addPlot("default",{type:r.type,font:"14t",fontColor:"white"});p.addSeries("Series A",e.map(r.fields,function(a,c){return{y:l[a],text:esri.substitute(l,r.labels[c]),tooltip:l[a],color:r.colors[c]}}));this._actions=[new q.charting.action2d.Tooltip(p),new q.charting.action2d.Highlight(p)];
p.render();this._legend=new q.charting.widget.Legend({chart:p},this._legendNode)}l.VIDEO_URL&&(b="\x3ciframe frameborder\x3d'0' width\x3d'250' height\x3d'212' src\x3d'"+esri.substitute(l,b.video)+"'\x3e\x3c/iframe\x3e",this._mediaNode.innerHTML=b)},destroy:function(){e.forEach([this._chart,this._legend].concat(this._actions),function(b){b.destroy()});this.definition=this.graphic=this._chart=this._legend=this._actions=null;this.inherited(arguments)}})})},"dojox/charting/themes/PlotKit/blue":function(){define(["./base",
"../../Theme"],function(e,U){e.blue=e.base.clone();e.blue.chart.fill=e.blue.plotarea.fill="#e7eef6";e.blue.colors=U.defineColors({hue:217,saturation:60,low:40,high:88});return e.blue})},"dojox/charting/themes/PlotKit/base":function(){define(["dojo/_base/lang","dojo/_base/Color","../../Theme","../common"],function(e,U,q,b){e=e.getObject("PlotKit",!0,b);e.base=new q({chart:{stroke:null,fill:"yellow"},plotarea:{stroke:null,fill:"yellow"},axis:{stroke:{color:"#fff",width:1},line:{color:"#fff",width:.5},
majorTick:{color:"#fff",width:.5,length:6},minorTick:{color:"#fff",width:.5,length:3},tick:{font:"normal normal normal 7pt Helvetica,Arial,sans-serif",fontColor:"#999"}},series:{stroke:{width:2.5,color:"#fff"},fill:"#666",font:"normal normal normal 7.5pt Helvetica,Arial,sans-serif",fontColor:"#666"},marker:{stroke:{width:2},fill:"#333",font:"normal normal normal 7pt Helvetica,Arial,sans-serif",fontColor:"#666"},colors:["red","green","blue"]});e.base.next=function(l,p,r){var a=q.prototype.next.apply(this,
arguments);"line"==l?(a.marker.outline={width:2,color:"#fff"},a.series.stroke.width=3.5,a.marker.stroke.width=2):"candlestick"==l?a.series.stroke.width=1:a.series.stroke.color&&a.series.stroke.color.toString()==(new U(this.colors[(this._current-1)%this.colors.length])).toString()&&(a.series.stroke.color="#fff");return a};return e})},"dojox/charting/widget/Legend":function(){define("dojo/_base/declare dijit/_WidgetBase dojox/gfx dojo/_base/array dojo/has dojo/has!dojo-bidi?../bidi/widget/Legend dojox/lang/functional dojo/dom dojo/dom-construct dojo/dom-class dijit/registry".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h){U=e(l("dojo-bidi")?"dojox.charting.widget.NonBidiLegend":"dojox.charting.widget.Legend",U,{chartRef:"",horizontal:!0,swatchSize:18,legendBody:null,postCreate:function(){!this.chart&&this.chartRef&&(this.chart=h.byId(this.chartRef)||h.byNode(a.byId(this.chartRef)));this.chart=this.chart.chart||this.chart;this.refresh()},buildRendering:function(){this.domNode=c.create("table",{role:"group","aria-label":"chart legend","class":"dojoxLegendNode"});this.legendBody=c.create("tbody",
null,this.domNode);this.inherited(arguments)},destroy:function(){this._surfaces&&b.forEach(this._surfaces,function(f){f.destroy()});this.inherited(arguments)},refresh:function(){this._surfaces&&b.forEach(this._surfaces,function(n){n.destroy()});for(this._surfaces=[];this.legendBody.lastChild;)c.destroy(this.legendBody.lastChild);this.horizontal&&(d.add(this.domNode,"dojoxLegendHorizontal"),this._tr=c.create("tr",null,this.legendBody),this._inrow=0);var f=this.series||this.chart.series;if(0!=f.length)if("dojox.charting.plot2d.Pie"==
f[0].chart.stack[0].declaredClass){var g=f[0].chart.stack[0];"number"==typeof g.run.data[0]?(f=r.map(g.run.data,"Math.max(x, 0)"),f=r.map(f,"/this",r.foldl(f,"+",0)),b.forEach(f,function(n,m){this._addLabel(g.dyn[m],g._getLabel(100*n)+"%")},this)):b.forEach(g.run.data,function(n,m){this._addLabel(g.dyn[m],n.legend||n.text||n.y)},this)}else b.forEach(f,function(n){this._addLabel(n.dyn,n.legend||n.name)},this)},_addLabel:function(f,g){var n=c.create("td"),m=c.create("div",null,n),t=c.create("label",
null,n),w=c.create("div",{style:{width:this.swatchSize+"px",height:this.swatchSize+"px","float":"left"}},m);d.add(m,"dojoxLegendIcon dijitInline");d.add(t,"dojoxLegendText");this._tr?(this._tr.appendChild(n),++this._inrow===this.horizontal&&(this._tr=c.create("tr",null,this.legendBody),this._inrow=0)):c.create("tr",null,this.legendBody).appendChild(n);this._makeIcon(w,f);t.innerHTML=String(g);l("dojo-bidi")&&(t.dir=this.getTextDir(g,t.dir))},_makeIcon:function(f,g){var n=this.swatchSize,m=this.swatchSize,
t=q.createSurface(f,m,n);this._surfaces.push(t);if(g.fill)t.createRect({x:2,y:2,width:m-4,height:n-4}).setFill(g.fill).setStroke(g.stroke);else if(g.stroke||g.marker){var w={x1:0,y1:n/2,x2:m,y2:n/2};g.stroke&&t.createLine(w).setStroke(g.stroke);g.marker&&t.createPath({path:"M"+m/2+" "+n/2+" "+g.marker}).setFill(g.markerFill).setStroke(g.markerStroke)}else t.createRect({x:2,y:2,width:m-4,height:n-4}).setStroke("black"),t.createLine({x1:2,y1:2,x2:m-2,y2:n-2}).setStroke("black"),t.createLine({x1:2,y1:n-
2,x2:m-2,y2:2}).setStroke("black")}});return l("dojo-bidi")?e("dojox.charting.widget.Legend",[U,p]):U})},"arcgisonline/map/mapUtil":function(){define(["dojo","dijit","dojox","dojo/require!esri/arcadeProfiles/labelingProfile,esri/arcadeProfiles/visualizationProfile,esri/ArcadeExpression,arcgisonline/map/main,esri/support/expressionUtils"],function(e,U,q){e.provide("arcgisonline.map.mapUtil");e.require("esri/arcadeProfiles/labelingProfile");e.require("esri/arcadeProfiles/visualizationProfile");e.require("esri/ArcadeExpression");
e.require("arcgisonline.map.main");e.require("esri.support.expressionUtils");arcgisonline.map.mapUtil={getWebMapAuthoringInfo:function(){return{authoringApp:"WebMapViewer",authoringAppVersion:arcgisonline.sharing.util.isPortal()?"11.0":"10.2",version:"2.25"}},openBlankMap:function(){var b=esriGeowConfig.baseUrl+"webmap/viewer.html";arcgisonline.map.storage.getMapCookie(function(l){l&&!0===l.c?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(b,l):document.location=
b})},openOnMap:function(b,l,p){b=e.mixin({layers:b},!0===p?{panel:"gallery",suggestField:!0}:{});var r=esriGeowConfig.baseUrl+"webmap/viewer.html?"+e.objectToQuery(b),a=esriGeowConfig.baseUrl+"signin.html?returnUrl\x3d"+encodeURIComponent(r);l="boolean"===typeof l?l:!1;arcgisonline.map.storage.getMapCookie(function(c){c&&!0===c.c?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(l?a:r,c):document.location=l?a:r})},openOnGCSMap:function(b){var l=esriGeowConfig.baseUrl+
"webmap/viewer.html?layers\x3d"+b+"\x26basemapUrl\x3d"+esriGeowConfig.gcsBasemapService;arcgisonline.map.storage.getMapCookie(function(p){p&&!0===p.c?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(l,p):document.location=l})},addToMap:function(b,l,p){b=e.mixin({layers:b,useExisting:1},!0===p?{panel:"gallery",suggestField:!0}:{});b=esriGeowConfig.baseUrl+"webmap/viewer.html?"+e.objectToQuery(b);p=esriGeowConfig.baseUrl+"signin.html?returnUrl\x3d"+encodeURIComponent(b);
document.location="boolean"===typeof l&&l?p:b},openUrlOnMap:function(b){b=esriGeowConfig.baseUrl+"webmap/viewer.html?url\x3d"+b;arcgisonline.map.storage.getMapCookie(function(l){l&&!0===l.c?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(b,l):document.location=b})},addUrlToMap:function(b){document.location=esriGeowConfig.baseUrl+"webmap/viewer.html?useExisting\x3d1\x26url\x3d"+b},openMap:function(b,l){var p=esriGeowConfig.baseUrl+"webmap/viewer.html?webmap\x3d"+b,
r=esriGeowConfig.baseUrl+"signin.html?returnUrl\x3d"+encodeURIComponent(p);l="boolean"===typeof l?l:!1;arcgisonline.map.storage.getMapCookie(function(a){a&&!0===a.c?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(l?r:p,a):document.location=l?r:p})},openMapWithBase:function(b,l,p){var r=esriGeowConfig.baseUrl+"webmap/viewer.html";null!=b&&0<b.length&&null!=l&&0<l.length?r+="?basemapType\x3d"+b+"\x26layers\x3d"+l:null!=b&&0<b.length?r+="?basemapType\x3d"+b:null!=l&&
0<l.length&&(r+="?layers\x3d"+l);esri.isDefined(p)&&p.length&&"/"!=p&&(r=-1===r.indexOf("?")?r+("?folder\x3d"+p):r+("\x26folder\x3d"+p));arcgisonline.map.storage.getMapCookie(function(a){a&&!0===a.c?arcgisonline.sharing.dijit.dialog.OpenMapDlg.prototype.statics.getInstance().show(r,a):document.location=r})},previewTemplate:function(b,l,p){p&&p.preventDefault();l=esriGeowConfig.restBaseUrl+"content/items/"+l+"/data";p=arcgisonline.sharing.util.getToken();null!=p&&""!=p&&(l=l+"?token\x3d"+p);esri.request({url:l,
callbackParamName:"callback"});l=b.indexOf("?");p=-1!==l?b.substr(l,b.length):"";p+=p&&p.length?"\x26":"?";p+="webmap\x3d"+arcgisonline.map.save_open.webMapInfo.id;b=b.substr(0,-1!==l?l:b.length)+p;window.open(b)},supportsOffline:function(b){for(var l=new e.Deferred,p=[],r=0;r<b.baseMap.baseMapLayers.length;r++){var a=b.baseMap.baseMapLayers[r];if(!a.url||a.type||a.layers)return l.callback(!1),l;-1==e.indexOf(p,a.url)&&p.push(a.url)}for(r=0;r<b.operationalLayers.length;r++){a=b.operationalLayers[r];
if(!a.url||a.type||a.layers)return l.callback(!1),l;-1==e.indexOf(p,a.url)&&p.push(a.url)}b=[];for(r=0;r<p.length;r++)b.push(arcgisonline.map.mapUtil.getServiceInfoHelper(p[r]));b.length?(new e.DeferredList(b)).addCallback(function(c){var d=null;for(r=0;r<p.length;r++){var h=p[r],f=c[r][1];f?(0===r&&(d=f.spatialReference),f.capabilities&&-1<f.capabilities.indexOf("Sync")||f.exportTilesAllowed||arcgisonline.sharing.util.isAgolService(h)&&arcgisonline.map.main.agolServiceWithExportTilesAllowed(h)?0<
r&&f.singleFusedMapCache&&!arcgisonline.map.main.sameSpatialReference(d,f.spatialReference)&&l.callback(!1):l.callback(!1)):l.callback(!1)}l.callback(!0)}):l.callback(!1);return l},getServiceInfoHelper:function(b){var l=new e.Deferred;arcgisonline.map.layer.getServiceInfo(b,null,function(p){l.callback(p)},function(){l.errback()});return l},checkFSItemAccess:function(b,l){!b.itemOwner&&b.itemCard&&(b.itemOwner=b.itemCard.owner);!b.itemId||b.itemOwner||b._itemNotAccessible?l():arcgisonline.sharing.util.request({url:esriGeowConfig.restBaseUrl+
"content/items/"+b.itemId},{disableIdentityLookup:!0}).then(e.hitch(this,function(p){p.id===b.itemId&&(b.itemOwner=p.owner,b.itemCard=p,l())}),e.hitch(this,function(){b._itemNotAccessible=!0;l()}))},checkHostedFSAccess:function(b,l,p){b.layer&&b.layer instanceof esri.layers.FeatureLayer&&b.itemId&&(arcgisonline.sharing.util.isHostedService(b.url)||b.itemCard&&-1<e.indexOf(b.itemCard.typeKeywords,"providerSDS"))?arcgisonline.map.mapUtil.checkFSItemAccess(b,e.hitch(this,function(){if(b.itemCard&&-1<
e.indexOf(b.itemCard.typeKeywords,"Hosted Service")){var r=arcgisonline.sharing.util.getUser();"update"===b.itemCard.itemControl||"admin"===b.itemCard.itemControl?l&&l(b):r&&esriGeowConfig.userRole&&esriGeowConfig.userRole.isAdmin()&&-1<b.url.indexOf("/"+r.accountId+"/")?l&&l(b):r&&b.itemOwner&&b.itemOwner===r.username?l&&l(b):p&&p(b)}else p&&p(b)})):p&&p(b)},setRenderer:function(b,l){b&&l&&l.initializeArcadeEngine().then(function(){b.setRenderer(l);b.redraw()},function(){b.setRenderer(l)})},setLabelingInfo:function(b,
l,p){if(b&&l){for(var r=0;r<l.length;r++){var a=l[r];a.labelExpressionInfo&&a.labelExpressionInfo.expression&&(a=new esri.ArcadeExpression({expression:a.labelExpressionInfo.expression,returnType:a.labelExpressionInfo.returnType,profile:esri.arcadeProfiles.labelingProfile}),esri.arcadeProfiles.labelingProfile.initialize([a]).then(e.hitch(this,function(){b.setLabelingInfo(l);p&&setTimeout(function(){arcgisonline.map.labels.addLabelsForLayer(b)},1)}),e.hitch(this,function(){b.setLabelingInfo(l);p&&setTimeout(function(){arcgisonline.map.labels.addLabelsForLayer(b)},
1)})))}b.setLabelingInfo(l)}},setInfoTemplate:function(b,l){if(b)if(l&&l.expressionInfos&&l.expressionInfos.length){for(var p=[],r=0;r<l.expressionInfos.length;r++){var a=l.expressionInfos[r];a=new esri.ArcadeExpression({expression:a.expression,returnType:a.returnType,profile:esri.arcadeProfiles.popupProfile});p.push(esri.arcadeProfiles.popupProfile.initialize([a]))}(new e.DeferredList(p)).addCallback(e.hitch(this,function(c,d,h){c.setInfoTemplate(new esri.dijit.PopupTemplate(d))},b,l))}else b.setInfoTemplate(l&&
new esri.dijit.PopupTemplate(l))}}})},"arcgisonline/map/featColl":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/map/main"],function(e,U,q){e.provide("arcgisonline.map.featColl");e.require("arcgisonline.map.main");arcgisonline.map.featColl={addFeatureLayers:function(b,l,p){if(!b.itemId||b.featureCollection&&b.featureCollection.layers&&b.featureCollection.layers[0].featureSet){e.forEach(b.featureCollection.layers,function(d){d.layerDefinition.capabilities||(d.layerDefinition.capabilities=
"Query")});var r=Math.floor(10001*Math.random()),a={layer:null,id:b.id?b.id:"featColl_"+r,type:"user",title:l?l:b.title,defaultVisibility:null!=b.visibility?b.visibility:!0,defaultOpacity:null!=b.opacity?b.opacity:1,snippet:"",visibility:null!=b.visibility?b.visibility:!0,identify:!1,timeAnimation:b.timeAnimation};b.featureCollection&&!0!==b.featureCollection.showLegend&&(a.showLegend=!1);b.featureCollection||!1!==b.showLegend||(a.showLegend=!1);b.featureCollectionType&&(a.featureCollectionType=b.featureCollectionType);
if(b.itemId||p&&p.itemId)a.itemId=b.itemId||p.itemId;b.url&&(a.url=b.url);if(b.itemCard||p&&p.itemCard)a.itemCard=b.itemCard||p.itemCard;b.locationInfo&&(a.locationInfo=b.locationInfo);b.columnDelimiter&&(a.columnDelimiter=b.columnDelimiter);esri.isDefined(b.visibleLayers)&&(a.visibleLayers=b.visibleLayers.toString(),0<b.visibleLayers.length&&isNaN(b.visibleLayers[0])&&(visibleLayers=e.map(b.visibleLayers,function(d){return d.substring(d.lastIndexOf("_")+1)}),a.visibleLayers=visibleLayers.toString()));
arcgisonline.map.mapNotes.isMapNotesLayer(b)&&(a.fieldInfos=arcgisonline.map.mapNotes.getFieldInfos(),a.type="mapNotes",a.featureCollectionType="notes");p&&(a=e.mixin(a,p));var c=!1;e.forEach(b.featureCollection.layers,function(d){d.layerDefinition&&"Table"===d.layerDefinition.type||(c=!0)});c?(p=arcgisonline.map.layer.getLayerPosition(a),arcgisonline.map.main.mapLayers.splice(p.list,0,a),arcgisonline.map.featColl.addFeatureLayersfromCollection(a,b.featureCollection,l,p.map)):(arcgisonline.map.featColl.addFeatureLayersfromCollection(a,
b.featureCollection,l,0),arcgisonline.map.main.mapTables=arcgisonline.map.main.mapTables||[],e.forEach(a.tables,function(d,h){var f={layer:d,id:d.id,title:1<a.tables.length?a.title+" - "+d.name:a.title,featureCollection:b.featureCollection};a.itemId&&(f.itemId=a.itemId,f.itemCard=a.itemCard);esri.isDefined(a.popupChanged)&&(f.popupChanged=a.popupChanged);arcgisonline.map.main.mapTables.push(f);arcgisonline.map.main.refreshMapTables();e.publish("layerAdded",[a.id])}),e.publish("onLayerUpdate",[""]));
return a}arcgisonline.map.featColl.mergeFeatureCollectionItem(b,l,p,e.hitch(arcgisonline.map.featColl,"addFeatureLayers"))},addFeatureLayersfromCollection:function(b,l,p,r){var a=0,c=0,d=[],h=[];e.forEach(l.layers,function(u){u.layerDefinition&&"Table"===u.layerDefinition.type?(c++,h.push(u)):(a++,d.push(u))});if(1<a+c){b.layers=[];var f=d.concat(h);l.layers=f}arcgisonline.map.featColl.fixCapabilities(l,b.itemCard);for(f=0;f<l.layers.length;f++){var g=l.layers[f],n=b.id+(1<l.layers.length?"_"+f:"");
if(g.layerDefinition&&"Table"===g.layerDefinition.type){var m=new esri.layers.FeatureLayer(e.json.parse(e.json.stringify(g)),{id:n,arcgisProps:{title:b.title+" - "+g.name},outFields:["*"]});m.name=g.layerDefinition.name;g.popupInfo&&(m.__popupInfo=g.popupInfo,arcgisonline.map.mapUtil.setInfoTemplate(m,g.popupInfo));b.tables=b.tables||[];b.tables.push(m);arcgisonline.map.main.refreshMapTables()}else g.layerDefinition.name||(g.layerDefinition.name=b.title),m=null,!1===g.showLegend&&(m=!1),delete g.showLegend,
n=arcgisonline.map.featColl.addFeatureLayer(g,b.defaultVisibility,b.defaultOpacity,n,b),!1===m&&(n.__showLegend=!1),b.layers?((""==b.visibleLayers||b.visibleLayers&&-1==(","+b.visibleLayers+",").indexOf(","+f+","))&&n.hide(),b.layers.push(n)):(b.layer=n,g.popupInfo&&!g.disablePopup&&(b.popupInfo=g.popupInfo))}!b.itemId&&p&&0<p.length&&(b.layer&&b.layer.isEditable()||b.layers&&b.layers[0].isEditable())&&("editStack"===arcgisonline.map.leftPanel.getLeftContentPanelStack()?setTimeout(function(){U.byId("editPanel").recreateEditor()},
0):("contentStack"!==arcgisonline.map.leftPanel.getLeftContentPanelStack()&&arcgisonline.map.leftPanel.openLeftTOCPanel(),arcgisonline.map.edit.enableEditButton()));if(b.layers)if(l=arcgisonline.sharing.util.urlToObject(document.URL),l.query&&l.query.layers&&l.query.layerId){var t=parseInt(l.query.layerId),w=t;e.forEach(b.layers,function(u,v){u.layerId===t&&(w=v)});e.forEach(b.layers,function(u){u.id.endsWith("_"+w)&&(arcgisonline.map.main.map.addLayer(u,r),u.show())})}else e.forEach(b.layers,function(u,
v){arcgisonline.map.main.map.addLayer(u,r+v)});else arcgisonline.map.main.map.addLayer(b.layer,r);e.publish("layerAdded",[b.id])},addFeatureLayer:function(b,l,p,r,a){var c=null;b.popupInfo&&(c=new esri.dijit.PopupTemplate(b.popupInfo));arcgisonline.map.main.checkUnsupportedRendererType(b);l=new esri.layers.FeatureLayer(e.json.parse(e.json.stringify(b)),{id:r,infoTemplate:c,outFields:["*"],visible:l,opacity:p,arcgisProps:{title:b.title},displayOnPan:9>e.isIE?!1:!0});l.labelingInfo&&arcgisonline.map.labels.addLabelsForLayer(l);
b.popupInfo&&(l.__popupInfo=b.popupInfo);b.layerDefinition&&b.layerDefinition.featureReduction&&(b=e.clone(b.layerDefinition.featureReduction),b.clusterRadius=q.gfx.pt2px(b.clusterRadius||b.clusterSize),b.popupInfo&&b.disablePopup&&(delete b.popupInfo,delete b.disablePopup),b.popupInfo?(b.infoTemplate=new esri.dijit.PopupTemplate(b.popupInfo),delete b.popupInfo):b.disablePopup=!0,l.setFeatureReduction(b));a&&!1===a.timeAnimation&&l.timeInfo&&(l.useMapTime=!1);return l},addFeatureCollectionByUrl:function(b){if(b.endsWith(".js")||
-1<b.indexOf(".js?")||-1<b.indexOf(".js%"))arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.error.layerNotAdded,{layer:b})});else{var l=arcgisonline.sharing.util.urlToObject(document.URL),p=l.query&&l.query.supportsProjection,r=b,a=null;"true"==(l.query&&l.query.supportsJSONP)?a="callback":r=(0===b.indexOf("https://")?esri.config.defaults.io.proxyUrl.replace("http:",
"https:"):esri.config.defaults.io.proxyUrl)+"?"+b;"true"==p&&(l=arcgisonline.map.main.map&&arcgisonline.map.main.map.spatialReference?arcgisonline.map.main.map.spatialReference:arcgisonline.map.main.defaultExtent.spatialReference,r+=(-1<b.indexOf("?")?"\x26":"?")+"outsr\x3d"+(l.wkid?l.wkid:l.wkt));var c=b.substring(b.lastIndexOf("/")+1,b.length);-1<c.indexOf("?")&&(c=c.substring(0,c.indexOf("?")));-1<b.indexOf("option\x3dfootprints")&&(-1<b.indexOf("/rest/services?")?(c=b.substring(b.indexOf("://")+
3,b.length),c=c.substring(0,c.indexOf("/"))+" - "+esri.i18nBundle.viewer.featColl.footprints):-1<b.indexOf("/rest/services/")&&(-1<b.indexOf("Server?")?(c=b.substring(0,b.indexOf("Server?")),c=c.substring(0,c.lastIndexOf("/")),c=c.substring(c.lastIndexOf("/")+1,c.length)):(c=b.substring(b.indexOf("/rest/services/")+15,b.indexOf("?")),-1<c.indexOf("/")&&(c=c.substring(c.lastIndexOf("/")+1,c.length))),c+=" - "+esri.i18nBundle.viewer.featColl.footprints));esri.request({url:r,callbackParamName:a,load:function(d){if(d.layerDefinition)d.layerDefinition.name&&
(c=d.layerDefinition.name),d.layerDefinition.capabilities?-1===d.layerDefinition.capabilities.indexOf("Editing")&&(d.layerDefinition.capabilities+=", Editing"):d.layerDefinition.capabilities="Query, Editing",arcgisonline.map.featColl.checkLayerDefinitionSR(d,c,b);else if(d.featureCollection)1==d.featureCollection.layers.length&&d.featureCollection.layers[0].layerDefinition.name&&(c=d.featureCollection.layers[0].layerDefinition.name),e.forEach(d.featureCollection.layers,function(f){f.layerDefinition.capabilities?
-1===f.layerDefinition.capabilities.indexOf("Editing")&&(f.layerDefinition.capabilities+=", Editing"):f.layerDefinition.capabilities="Query, Editing"}),arcgisonline.map.featColl.checkFeatureCollectionSR(d.featureCollection,c,e.hitch(arcgisonline.map.featColl,"addAndZoom",c,b));else{d=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();var h=e.string.substitute(esri.i18nBundle.viewer.featColl.featureCollectionNoLayers,{url:b});d.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,
message:h})}},error:function(d){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:e.string.substitute(esri.i18nBundle.viewer.featColl.featureCollectionNotAccessible,{url:b})})}},{usePost:!1})}},addFeatureCollectionItem:function(b){var l=function(p,r){e.publish("ServiceAnswerReceived",[]);e.publish("layerAddFailed",[{itemId:b.id}]);arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,
message:esri.i18nBundle.viewer.error.layerFailedToLoad})};esri.request({url:(b.restBaseUrl||esriGeowConfig.restBaseUrl)+"content/items/"+b.id+"/data?f\x3djson",callbackParamName:"callback",load:e.hitch(this,function(p,r){e.publish("ServiceAnswerReceived",[]);p.featureCollection&&p.featureCollection.layers||p.layers||l(p,r);p.layers&&(p.featureCollection={layers:p.layers},delete p.layers,esri.isDefined(p.showLegend)&&(p.featureCollection.showLegend=p.showLegend,delete p.showLegend));arcgisonline.map.featColl.loadFeatCollFromItemData(p||
{},b,e.hitch(this,function(){if(null!=arcgisonline.map.save_open.itemCard&&null!=b&&arcgisonline.map.save_open.itemCard.id===b.id){null===arcgisonline.map.save_open.webMapInfo&&arcgisonline.map.main.setTitle(b.title);arcgisonline.map.leftPanel.recreateAboutStack();var a=arcgisonline.sharing.util.urlToObject(document.URL);a.query=a.query||{};arcgisonline.map.leftPanel.openLeftTOCPanel()}else null===arcgisonline.map.save_open.webMapInfo&&null===arcgisonline.map.save_open.itemCard&&arcgisonline.map.main.setTitle(esri.i18nBundle.viewer.defaultMapTitle)}))}),
error:e.hitch(this,l)})},loadFeatCollFromItemData:function(b,l,p){arcgisonline.map.featColl.checkFeatureCollectionSR(b.featureCollection,l.title,function(r){arcgisonline.map.save_open.itemCard&&arcgisonline.map.save_open.itemCard.id===l.id?(arcgisonline.map.main.setTitle(l.title),arcgisonline.map.leftPanel.recreateAboutStack()):null===arcgisonline.map.save_open.webMapInfo&&arcgisonline.map.main.setTitle(esri.i18nBundle.viewer.defaultMapTitle);arcgisonline.map.featColl.fixCapabilities(b.featureCollection,
l);r=arcgisonline.map.featColl.addFeatureLayers(b,l.title,{itemId:l.id,itemCard:l});r.itemId&&((r.itemCard=l)&&-1<e.indexOf(l.typeKeywords,"Route Layer")?r.featureCollectionType="route":l&&-1<e.indexOf(l.typeKeywords,"Markup")&&(r.featureCollectionType="markup"),r.origItemDataProps=e.clone(b),e.forEach(r.origItemDataProps.featureCollection.layers,function(a){delete a.featureSet;delete a.nextObjectId}));p()})},addFeatCollByReferenceLayerFromJson:function(b){b&&esri.request({url:esriGeowConfig.restBaseUrl+
"content/items/"+b.itemId+"?f\x3djson",callbackParamName:"callback",load:e.hitch(this,function(l,p){arcgisonline.map.featColl.addFeatureLayers(l,null,{itemId:l.itemId,itemCard:p})},b),error:e.hitch(this,function(l,p){e.publish("layerAddFailed",[b.itemId?{itemId:b.itemId,id:b.id}:b.id]);setTimeout(function(){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.viewer.error.layerFailedToLoad})},5E3)})})},
mergeFeatureCollectionItem:function(b,l,p,r){!arcgisonline.sharing.util.getUser()||b.itemCard?arcgisonline.map.featColl.mergeFeatureCollectionItem_part2(b,l,p,r):esri.request({url:esriGeowConfig.restBaseUrl+"content/items/"+b.itemId+"?f\x3djson",callbackParamName:"callback",load:e.hitch(this,function(a){b.itemCard=a;arcgisonline.map.featColl.mergeFeatureCollectionItem_part2(b,l,p,r)}),error:e.hitch(this,function(a,c){b.itemCard={owner:null};arcgisonline.map.featColl.mergeFeatureCollectionItem_part2(b,
l,p,r)})})},mergeFeatureCollectionItem_part2:function(b,l,p,r){var a=function(c,d){e.publish("layerAddFailed",[b.itemId?{itemId:b.itemId,id:b.id}:b.id]);arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:esri.i18nBundle.viewer.error.layerFailedToLoad})};esri.request({url:esriGeowConfig.restBaseUrl+"content/items/"+b.itemId+"/data?f\x3djson",callbackParamName:"callback",load:e.hitch(this,function(c,d,h){if(d.featureCollection||
d.layers){d.layers&&(d.featureCollection={layers:d.layers},delete d.layers,esri.isDefined(d.showLegend)&&(d.featureCollection.showLegend=d.showLegend,delete d.showLegend));var f=e.filter(d.featureCollection.layers,function(n){return n.layerDefinition&&"Table"===n.layerDefinition.type?!1:!0}),g=e.filter(d.featureCollection.layers,function(n){return n.layerDefinition&&"Table"===n.layerDefinition.type?!0:!1});d.featureCollection.layers=f.concat(g);b.featureCollection&&b.featureCollection.layers&&d.featureCollection.layers.length!==
b.featureCollection.layers.length?a({msg:(l||b.title)+": FeatureCollection layer in web map has less layers than on item."},h):arcgisonline.map.featColl.checkFeatureCollectionSR(d.featureCollection,l||b.title,e.hitch(this,function(n,m){n=n||{};n.origItemData=e.clone(d);esri.isDefined(b.visibleLayers)?n.visibleLayersChanged=!0:d.visibleLayers&&(b.visibleLayers=d.visibleLayers.toString());d.featureCollection=m;b.featureCollection&&b.featureCollection.layers?(0<f.length&&b.featureCollection.showLegend!==
d.featureCollection.showLegend&&(n.legendChanged=!0),e.forEach(d.featureCollection.layers,function(t,w){var u=b.featureCollection.layers[w];u.popupInfo&&u.disablePopup&&(delete u.popupInfo,delete u.disablePopup);t.popupInfo&&t.disablePopup&&(delete t.popupInfo,delete t.disablePopup);if(u.popupInfo&&!t.popupInfo||!u.popupInfo&&t.popupInfo&&!u.disablePopup||u.popupInfo&&t.popupInfo&&e.json.stringify(u.popupInfo)!==e.json.stringify(t.popupInfo))n.popupChanged=!0,delete u.disablePopup;if(u.layerDefinition){if(u.layerDefinition.minScale!==
t.layerDefinition.minScale||u.layerDefinition.maxScale!==t.layerDefinition.maxScale)n.scaleChanged=!0;delete t.layerDefinition.minScale;delete t.layerDefinition.maxScale;u.layerDefinition.drawingInfo&&e.json.stringify(u.layerDefinition.drawingInfo)!==e.json.stringify(t.layerDefinition.drawingInfo)&&(n.rendererChanged=!0,delete t.layerDefinition.drawingInfo);u.layerDefinition.featureReduction&&e.json.stringify(u.layerDefinition.featureReduction)!==e.json.stringify(t.layerDefinition.featureReduction)&&
(n.featureReductionChanged=!0,delete t.layerDefinition.featureReduction);u.layerDefinition.showLegend!==t.layerDefinition.showLegend&&(n.legendChanged=!0,delete t.layerDefinition.showLegend);u.layerDefinition=e.mixin(u.layerDefinition,t.layerDefinition)}else u.layerDefinition=t.layerDefinition;u.featureSet=t.featureSet;u.nextObjectId=t.nextObjectId})):(b.featureCollection=b.featureCollection||{},b.featureCollection=e.mixin(b.featureCollection,d.featureCollection));b.itemCard&&-1<e.indexOf(b.itemCard.typeKeywords,
"Route Layer")?b.featureCollectionType="route":b.itemCard&&-1<e.indexOf(b.itemCard.typeKeywords,"Markup")?b.featureCollectionType="markup":arcgisonline.map.mapNotes.isMapNotesLayer(b)&&(b.featureCollectionType="notes");arcgisonline.map.featColl.fixCapabilities(b.featureCollection,b.itemCard);r(b,l,n)},c))}else a(d,h)},p||{}),error:e.hitch(this,a)})},fixCapabilities:function(b,l){var p=arcgisonline.sharing.util.getUser(),r=!1;l?!p||l.owner!==p.username&&"update"!==l.itemControl&&"admin"!==l.itemControl||
(r=!0):p&&(r=!0);e.forEach(b.layers,function(a){if(r)a.layerDefinition.capabilities?-1===a.layerDefinition.capabilities.indexOf("Editing")&&(a.layerDefinition.capabilities+=", Editing"):a.layerDefinition.capabilities="Query, Editing";else if(a.layerDefinition.capabilities){var c=a.layerDefinition.capabilities.split(","),d=[];e.forEach(c,function(h){var f=h.toLowerCase();"editing"!==f&&"create"!==f&&"update"!==f&&"delete"!==f&&d.push(h)});a.layerDefinition.capabilities=d.toString()}else a.layerDefinition.capabilities=
"Query"})},checkFeatureCollectionSR:function(b,l,p){for(var r=!1,a=[],c=0;c<b.layers.length;c++){var d=b.layers[c];if(d.layerDefinition&&"Table"===d.layerDefinition.type)r=!0;else{var h=arcgisonline.map.featColl.getSR(d);h&&a.push(function(){var f=new e.Deferred;arcgisonline.map.featColl.projectFeatureSet(d,h,e.hitch(this,function(g,n,m){n.layers[g]=m;f.callback()},c,b));return f}())}}a.length?(new e.DeferredList(a)).addCallback(function(){if(arcgisonline.map.main.map.extent&&isNaN(arcgisonline.map.main.map.extent.xmin)){arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent);
var f=e.connect(arcgisonline.map.main.map,"onExtentChange",e.hitch(this,function(){e.disconnect(f);p(b)}))}else p(b)}):(a=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),b.layers.length?r?p(b):(l=e.string.substitute(esri.i18nBundle.viewer.featColl.featureCollectionNoSR,{url:l}),a.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:l})):(l=e.string.substitute(esri.i18nBundle.viewer.featColl.featureCollectionNoLayers,{url:l}),a.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,
message:l})))},addAndZoom:function(b,l,p){b=arcgisonline.map.featColl.addFeatureLayers({featureCollection:p},b);b.layer?-1<l.indexOf("option\x3dfootprints")&&-1<l.indexOf("/rest/services")&&(b.layer.__isFootprintLayer=!0):e.forEach(b.layers,function(a){-1<l.indexOf("option\x3dfootprints")&&-1<l.indexOf("/rest/services")&&(a.__isFootprintLayer=!0)});var r=null;e.forEach(p.layers,function(a){a.layerDefinition.extent&&(r=r?r.union(new esri.geometry.Extent(a.layerDefinition.extent)):new esri.geometry.Extent(a.layerDefinition.extent))},
this);r?arcgisonline.map.main.projectToMapSpatialReference(r,function(a){arcgisonline.map.main.map.setExtent(a[0],!0)}):(r=arcgisonline.map.featColl.getFullExtent(b))&&arcgisonline.map.main.map.setExtent(r,!0)},checkLayerDefinitionSR:function(b,l,p){var r=arcgisonline.map.featColl.getSR(b);r?arcgisonline.map.featColl.projectFeatureSet(b,r,e.hitch(this,function(a){if(arcgisonline.map.main.map.extent&&isNaN(arcgisonline.map.main.map.extent.xmin)){arcgisonline.map.main.map.setExtent(arcgisonline.map.main.defaultExtent);
var c=e.connect(arcgisonline.map.main.map,"onExtentChange",e.hitch(this,function(){e.disconnect(c);arcgisonline.map.featColl.addAndLayerDefZoom(a,l,p)}))}else arcgisonline.map.featColl.addAndLayerDefZoom(a,l,p)})):(b=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance(),r=e.string.substitute(esri.i18nBundle.viewer.featColl.featureCollectionNoSR,{url:p}),b.show({title:esri.i18nBundle.generalDlg.errorDlgTitle,message:r}))},addAndLayerDefZoom:function(b,l,p){b.layerDefinition.capabilities||
(b.layerDefinition.capabilities="Query");var r={layer:null,id:"featColl_"+Math.floor(10001*Math.random()),type:"user",title:l?l:b.name,defaultVisibility:!0,defaultOpacity:1,snippet:"",visibility:!0,identify:!1},a=arcgisonline.map.layer.getLayerPosition(r);arcgisonline.map.main.mapLayers.splice(a.list,0,r);a=a.map;-1<p.indexOf("option\x3dfootprints")&&-1<p.indexOf("/rest/services")&&(r.layer.__isFootprintLayer=!0);b.layerDefinition.name||(b.layerDefinition.name=r.title);p=arcgisonline.map.featColl.addFeatureLayer(b,
r.defaultVisibility,r.defaultOpacity,r.id,r);r.layer=p;b.popupInfo&&(r.popupInfo=b.popupInfo);!r.itemId&&l&&0<l.length&&r.layer&&r.layer.isEditable()&&("editStack"===arcgisonline.map.leftPanel.getLeftContentPanelStack()?setTimeout(function(){U.byId("editPanel").recreateEditor()},0):(arcgisonline.map.leftPanel.openLeftTOCPanel(),arcgisonline.map.edit.enableEditButton()));arcgisonline.map.main.map.addLayer(r.layer,a);l=null;b.layerDefinition.extent&&(l=l?l.union(new esri.geometry.Extent(b.layerDefinition.extent)):
new esri.geometry.Extent(b.layerDefinition.extent));l&&arcgisonline.map.main.projectToMapSpatialReference(l,function(c){arcgisonline.map.main.map.setExtent(c[0],!0)})},generateDefaultPopupInfo:function(b){var l={esriFieldTypeDouble:1,esriFieldTypeSingle:1},p={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1},r={esriFieldTypeDate:1},a=null;b=e.map(b.layerDefinition.fields,e.hitch(this,function(c){"NAME"===c.name.toUpperCase()&&(a=c.name);var d="esriFieldTypeOID"!==c.type&&"esriFieldTypeGlobalID"!==
c.type&&"esriFieldTypeGeometry"!==c.type,h=null;if(d){var f=c.name.toLowerCase();if(-1<",stretched value,fnode_,tnode_,lpoly_,rpoly_,poly_,subclass,subclass_,rings_ok,rings_nok,".indexOf(","+f+",")||-1<f.indexOf("shape")||-1<f.indexOf("perimeter")||-1<f.indexOf("objectid")||f.indexOf("_")==f.length-1||f.indexOf("_i")==f.length-2&&1<f.length)d=!1;c.type in p?h={places:0,digitSeparator:!0}:c.type in l?h={places:2,digitSeparator:!0}:c.type in r&&(h={dateFormat:"longMonthDayYear"})}return e.mixin({},
{fieldName:c.name,label:c.alias,isEditable:esri.isDefined(c.editable)?c.editable:!0,tooltip:"",visible:esri.isDefined(c.visible)?c.visible:d,format:h,stringFieldOption:"textbox"})}));return{title:a?"{"+a+"}":"",fieldInfos:b,description:null,showAttachments:!1,mediaInfos:[]}},buildInfoTemplate:function(b){var l={content:"\x3ctable\x3e",title:b.title.replace("{","${")};e.forEach(b.fieldInfos,function(p){-1===b.title.indexOf("{"+p.fieldName+"}")&&p.visible&&(l.content+="\x3ctr\x3e\x3ctd valign\x3d'top'\x3e"+
p.label+": \x3c/td\x3e\x3ctd valign\x3d'top'\x3e${"+p.fieldName+"}\x3c/td\x3e\x3c/tr\x3e")});l.content+="\x3c/table\x3e";return l},getFullExtent:function(b){var l=null;b.layer?l=arcgisonline.map.featColl.getLayerFullExtent(b.layer):e.forEach(b.layers,function(p){(p=arcgisonline.map.featColl.getLayerFullExtent(p))&&(l=l?l.union(p):p)},this);return l},getLayerFullExtent:function(b){var l=null;e.forEach(b.graphics,function(p,r){var a=arcgisonline.map.featColl.getExtent(p.geometry);a&&(l=l?l.union(a):
a)},this);return l},getExtent:function(b){if(!b)return null;var l=null;if("esri.geometry.Extent"==b.declaredClass)l=b;else if("esri.geometry.Point"==b.declaredClass)l=new esri.geometry.Extent(b.x-1E-4,b.y-1E-4,b.x+1E-4,b.y+1E-4,b.spatialReference);else if(l=b.getExtent())l.spatialReference=new esri.SpatialReference(b.spatialReference.toJson());return l},getFeatureSetFullExtent:function(b,l){var p=null;if(b&&"esriGeometryPoint"===b.geometryType&&b.features&&1===b.features.length&&l&&l.layerDefinition&&
l.layerDefinition.extent)return l.layerDefinition.extent;e.forEach(b.features,function(r){if(r.geometry){var a=esri.geometry.getGeometryType(b.geometryType),c=r.geometry.spatialReference||b.spatialReference;r=new a(e.mixin(r.geometry,{spatialReference:{wkid:c.wkid,latestWkid:c.latestWkid,wkt:c.wkt}}));(r="esri.geometry.Extent"==r.declaredClass?r:"esri.geometry.Point"==r.declaredClass?new esri.geometry.Extent(r.x-1E-4,r.y-1E-4,r.x+1E-4,r.y+1E-4,r.spatialReference):r.getExtent())&&(p=p?p.union(r):r)}},
this);return p},getLayerSR:function(b){return b.graphics&&b.graphics.length&&b.graphics[0].geometry&&b.graphics[0].geometry.spatialReference?b.graphics[0].geometry.spatialReference:arcgisonline.map.main.map.spatialReference},projectFeatureSet:function(b,l,p){if(b.featureSet&&b.featureSet.features&&0!==b.featureSet.features.length)if(newSpatialReference=arcgisonline.map.main.map.spatialReference,arcgisonline.map.main.sameSpatialReference(newSpatialReference,l))b.layerDefinition.extent=arcgisonline.map.featColl.getFeatureSetFullExtent(b.featureSet,
b),p(b);else{var r=function(h){e.forEach(b.featureSet.features,function(f,g){h[g]&&(f.geometry=h[g])},this);b.layerDefinition.extent=arcgisonline.map.featColl.getFeatureSetFullExtent(b.featureSet,b);p(b)},a=function(h,f){arcgisonline.map.main.projectJsonGeometries(d,b.featureSet.geometryType,l,newSpatialReference,e.hitch(this,r),e.hitch(this,c))},c=function(h,f){p(b)};if(b.featureSet.features&&0<b.featureSet.features.length){var d=[];e.forEach(b.featureSet.features,function(h){d.push(h.geometry)});
arcgisonline.map.main.projectJsonGeometries(d,b.featureSet.geometryType,l,newSpatialReference,e.hitch(this,r),e.hitch(this,a))}else p(b)}else p(b)},roundFeatureSetCoordinates:function(b){e.forEach(b.featureSet.features,function(l){l=l.geometry;l.xmin?(l.xmin=Math.round(100*l.xmin)/100,l.xmax=Math.round(100*l.xmax)/100,l.ymin=Math.round(100*l.ymin)/100,l.ymax=Math.round(100*l.ymax)/100):l.rings?e.forEach(l.rings,function(p){e.forEach(p,function(r){r[0]=Math.round(100*r[0])/100;r[1]=Math.round(100*
r[1])/100},this)},this):l.paths?e.forEach(l.paths,function(p){e.forEach(p,function(r){r[0]=Math.round(100*r[0])/100;r[1]=Math.round(100*r[1])/100},this)},this):l.x&&(l.x=Math.round(100*l.x)/100,l.y=Math.round(100*l.y)/100)});b.layerDefinition.extent&&(b.layerDefinition.extent.xmax=Math.round(100*b.layerDefinition.extent.xmax)/100,b.layerDefinition.extent.xmin=Math.round(100*b.layerDefinition.extent.xmin)/100,b.layerDefinition.extent.ymax=Math.round(100*b.layerDefinition.extent.ymax)/100,b.layerDefinition.extent.ymin=
Math.round(100*b.layerDefinition.extent.ymin)/100)},isFeatureCollection:function(b){return b.layer?arcgisonline.map.featColl.isFeatureCollectionLayer(b.layer):b.layers||b.tables?!0:!1},isFeatureCollectionLayer:function(b){return"esri.layers.FeatureLayer"!=b.declaredClass||b.url?!1:!0},is4xSketchLayer:function(b){var l=!1;if(arcgisonline.map.featColl.isFeatureCollection(b)&&b.layers&&b.layers.length){var p=b.layers[0].fields;p||(p=b.layers[0].layerDefinition&&b.layers[0].layerDefinition.fields);p&&
2===p.length&&-1<["OBJECTID","title"].indexOf(p[0].name)&&-1<["OBJECTID","title"].indexOf(p[1].name)&&(l=!0)}return l},getSR:function(b){var l=null;b.featureSet&&b.featureSet.features&&b.featureSet.features.length&&b.featureSet.features[0].geometry&&b.featureSet.features[0].geometry.spatialReference?l=new esri.SpatialReference(b.featureSet.features[0].geometry.spatialReference):b.featureSet&&b.featureSet.spatialReference?l=new esri.SpatialReference(b.featureSet.spatialReference):b.layerDefinition&&
b.layerDefinition.extent&&b.layerDefinition.extent.spatialReference?l=new esri.SpatialReference(b.layerDefinition.extent.spatialReference):b.featureSet&&b.featureSet.features&&b.featureSet.features.length||b.layerDefinition&&b.layerDefinition.extent&&b.layerDefinition.extent.spatialReference||(l=new esri.SpatialReference({wkid:4326}));return l},getSubLayerById:function(b,l){for(var p=0;p<b.layers.length;p++){var r=b.layers[p];if(r.id===l)return r}if(b.tables)for(p=0;p<b.tables.length;p++)if(r=b.tables[p],
r.id===l)return r;return null},buildConfig:function(b){var l={layerType:"ArcGISFeatureLayer"};b.featureCollectionType&&(l.featureCollectionType=b.featureCollectionType);b.id&&"undefined"!==b.id&&(l.id=b.id);l.title=b.title;l.featureCollection=arcgisonline.map.featColl.buildFeatureCollectionJson(b);b.layers?(l.opacity=b.layers[0].opacity||0===b.layers[0].opacity?b.layers[0].opacity:1,l.visibility=0==b.visibility?!1:!0,""==b.visibleLayers?l.visibleLayers=[]:esri.isDefined(b.visibleLayers)&&(!b.itemId||
b.itemId&&b.visibleLayersChanged)&&(l.visibleLayers=e.map(b.visibleLayers.split(","),function(p){return parseInt(p)}))):(l.visibility=b.layer.visible,l.opacity=b.layer.opacity||0===b.layer.opacity?b.layer.opacity:1);b.url&&(l.type="CSV",l.layerType="CSV",delete l.featureCollectionType,l.url=b.url,l.layerDefinition=l.featureCollection.layers[0].layerDefinition,l.popupInfo=l.featureCollection.layers[0].popupInfo,l.locationInfo=b.locationInfo?b.locationInfo:null,l.columnDelimiter=b.columnDelimiter?b.columnDelimiter:
",",delete l.featureCollection,!1===b.showLegend&&(l.showLegend=!1));b.itemId&&(l.type="Feature Collection",l.layerType="ArcGISFeatureLayer",l.itemId=b.itemId,l.featureCollection.showLegend=!1===b.showLegend?!1:!0,b.popupChanged||b.scaleChanged||b.rendererChanged||b.featureReductionChanged||b.legendChanged?e.forEach(l.featureCollection.layers,function(p){delete p.featureSet;delete p.nextObjectId;if("Table"===p.layerDefinition.type)delete p.layerDefinition;else{var r={drawingInfo:p.layerDefinition.drawingInfo};
esri.isDefined(p.layerDefinition.featureReduction)&&(r.featureReduction=p.layerDefinition.featureReduction);esri.isDefined(p.layerDefinition.minScale)&&(r.minScale=p.layerDefinition.minScale);esri.isDefined(p.layerDefinition.maxScale)&&(r.maxScale=p.layerDefinition.maxScale);!1===p.layerDefinition.showLegend&&(r.showLegend=!1);p.layerDefinition=r}}):delete l.featureCollection,b.timeChanged&&b.layer&&b.layer.timeInfo&&0==b.layer.useMapTime&&(l.timeAnimation=!1),e.json.stringify(b.origItemDataProps)===
e.json.stringify({featureCollection:l.featureCollection})&&delete l.featureCollection);return l},buildFeatureCollectionJson:function(b){var l={layers:[]},p=!1;if("mapNotes"==b.type){var r=[102113,102100,3857],a=arcgisonline.map.main.map.spatialReference.wkid;esri.isDefined(a)&&arcgisonline.map.main.contains(r,a)&&(p=!0)}r=b.layers;b.tables&&(r=r.concat(b.tables));r?(e.forEach(r,function(c){var d=c.toJson();d.featureSet.features=d.featureSet.features||[];c.labelingInfo&&!arcgisonline.map.labels.hasLayer(c)&&
delete d.layerDefinition.drawingInfo.labelingInfo;p&&arcgisonline.map.featColl.roundFeatureSetCoordinates(d);c.__popupInfo?d.popupInfo=c.__popupInfo:delete d.popupInfo;c.minScale||c.maxScale?(d.layerDefinition.minScale=c.minScale?c.minScale:0,d.layerDefinition.maxScale=c.maxScale&&1!==c.maxScale?c.maxScale:0,d.layerDefinition.minScale===Number.POSITIVE_INFINITY&&(d.layerDefinition.minScale=0),0===d.layerDefinition.minScale&&0===d.layerDefinition.maxScale&&(delete d.layerDefinition.minScale,delete d.layerDefinition.maxScale,
arcgisonline.isEmpty(d.layerDefinition)&&delete d.layerDefinition)):(delete d.layerDefinition.minScale,delete d.layerDefinition.maxScale);var h=c.getFeatureReduction();h?(d.layerDefinition=d.layerDefinition||{},d.layerDefinition.featureReduction=h,d.layerDefinition.featureReduction.clusterRadius=q.gfx.px2pt(d.layerDefinition.featureReduction.clusterRadius),d.layerDefinition.featureReduction.infoTemplate&&(d.layerDefinition.featureReduction.popupInfo=d.layerDefinition.featureReduction.infoTemplate.toJson(),
delete d.layerDefinition.featureReduction.infoTemplate)):d.layerDefinition&&delete d.layerDefinition.featureReduction;delete d.showLegend;!1===c.__showLegend?d.showLegend=!1:!0===c.__showLegend&&(d.showLegend=!0);h=arcgisonline.map.featColl.getLayerFullExtent(c);d.layerDefinition.extent=h?h.toJson():null;d.layerDefinition.spatialReference=arcgisonline.map.featColl.getLayerSR(c).toJson();l.layers.push(d)},this),arcgisonline.map.featColl.is4xSketchLayer(b)&&(r=arcgisonline.map.main.getItemWithId((arcgisonline.map.save_open.originalWebMap||
arcgisonline.map.save_open.openedWebMap).operationalLayers||[],b.id))&&(l=e.clone(r.featureCollection))):(r=b.layer.toJson(),b.layer.labelingInfo&&!arcgisonline.map.labels.hasLayer(b.layer)&&delete r.layerDefinition.drawingInfo.labelingInfo,b.popupInfo?r.popupInfo=b.popupInfo:b.layer.__popupInfo?r.popupInfo=b.layer.__popupInfo:delete r.popupInfo,b.layer.minScale||b.layer.maxScale?(r.layerDefinition.minScale=b.layer.minScale,r.layerDefinition.maxScale=b.layer.maxScale,r.layerDefinition.minScale===
Number.POSITIVE_INFINITY&&(r.layerDefinition.minScale=0),r.layerDefinition.minScale||r.layerDefinition.maxScale||(delete r.layerDefinition.minScale,delete r.layerDefinition.maxScale,arcgisonline.isEmpty(r.layerDefinition)&&delete r.layerDefinition)):(delete r.layerDefinition.minScale,delete r.layerDefinition.maxScale,arcgisonline.isEmpty(r.layerDefinition)&&delete r.layerDefinition),(a=b.layer.getFeatureReduction())?(r.layerDefinition=r.layerDefinition||{},r.layerDefinition.featureReduction=a,r.layerDefinition.featureReduction.clusterRadius=
q.gfx.px2pt(r.layerDefinition.featureReduction.clusterRadius),r.layerDefinition.featureReduction.infoTemplate&&(r.layerDefinition.featureReduction.popupInfo=r.layerDefinition.featureReduction.infoTemplate.toJson(),delete r.layerDefinition.featureReduction.infoTemplate)):r.layerDefinition&&delete r.layerDefinition.featureReduction,a=arcgisonline.map.featColl.getLayerFullExtent(b.layer),r.layerDefinition.extent=a?a.toJson():null,r.layerDefinition.spatialReference=arcgisonline.map.featColl.getLayerSR(b.layer).toJson(),
l.layers.push(r));l.showLegend=!1===b.showLegend?!1:!0;return l}}})},"arcgisonline/map/labels":function(){define(["dojo","dijit","dojox","dojo/require!arcgisonline/map/main,esri/layers/LabelLayer"],function(e,U,q){e.provide("arcgisonline.map.labels");e.require("arcgisonline.map.main");e.require("esri.layers.LabelLayer");arcgisonline.map.labels={labelLayer:null,updateLabelsForLayer:function(b){b.labelingInfo?(arcgisonline.map.labels.createLabelLayer(),arcgisonline.map.labels.hasLayer(b)||(arcgisonline.map.labels.labelLayer.addFeatureLayer(b),
b.setShowLabels&&b.setShowLabels(!0),arcgisonline.map.labels.orderLayers())):arcgisonline.map.labels.hasLayer(b)&&arcgisonline.map.labels.removeLabelsForLayer(b)},addLabelsForLayer:function(b){b.labelingInfo&&(arcgisonline.map.labels.createLabelLayer(),arcgisonline.map.labels.hasLayer(b)||(arcgisonline.map.labels.labelLayer.addFeatureLayer(b),setTimeout(function(){arcgisonline.map.labels.labelLayer.refresh()},2E3)),b.setShowLabels&&b.setShowLabels(!0),arcgisonline.map.labels.orderLayers())},removeLabelsForLayer:function(b){arcgisonline.map.labels.hasLayer(b)&&
(arcgisonline.map.labels.labelLayer.removeFeatureLayer(b.id),b.setShowLabels&&b.setShowLabels(!1))},createLabelLayer:function(){arcgisonline.map.labels.labelLayer||(arcgisonline.map.labels.labelLayer=new esri.layers.LabelLayer({id:"LabelLayer"}),arcgisonline.map.main.map.addLayer(arcgisonline.map.labels.labelLayer))},hasLayer:function(b){return arcgisonline.map.labels.labelLayer&&arcgisonline.map.labels.labelLayer.getFeatureLayer(b.id)?!0:!1},orderLayers:function(){if(arcgisonline.map.labels.labelLayer){-1<
e.indexOf(arcgisonline.map.main.map.graphicsLayerIds,"LabelLayer")&&arcgisonline.map.main.map.reorderLayer("LabelLayer",arcgisonline.map.main.map.graphicsLayerIds.length);var b=!1,l=0;e.forEach(arcgisonline.map.main.map.graphicsLayerIds,function(p){var r=arcgisonline.map.main.map.getLayer(p);if(r.labelingInfo&&arcgisonline.map.labels.hasLayer(r)){var a=0;e.forEach(arcgisonline.map.labels.labelLayer.featureLayers,function(c,d){c.id===r.id&&(a=d)});a!==l&&(p=arcgisonline.map.labels.labelLayer.featureLayers.splice(a,
1)[0],arcgisonline.map.labels.labelLayer.featureLayers.splice(l,0,p),p=arcgisonline.map.labels.labelLayer._featureLayerInfos.splice(a,1)[0],arcgisonline.map.labels.labelLayer._featureLayerInfos.splice(l,0,p),b=!0);l++}});b&&arcgisonline.map.labels.labelLayer.refresh()}},hideAllLabels:function(){arcgisonline.map.labels.labelLayer&&arcgisonline.map.labels.labelLayer.hide()},showAllLabels:function(){arcgisonline.map.labels.labelLayer&&arcgisonline.map.labels.labelLayer.show()}}})},"esri/layers/LabelLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/i18n!dojo/cldr/nls/number dojo/number dojo/has dojox/gfx/_base ../kernel ../lang ../graphic ../PopupInfo ../ArcadeExpression ../core/timerUtils ../symbols/TextSymbol ../symbols/ShieldLabelSymbol ../geometry/Extent ../geometry/Point ../geometry/webMercatorUtils ../renderers/SimpleRenderer ../arcadeProfiles/labelingProfile ./labelLayerUtils/DynamicLabelClass ./labelLayerUtils/StaticLabelClass ./GraphicsLayer ./LabelClass".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O){function V(N){return"sizeInfo"===N.type}e=e(F,{declaredClass:"esri.layers.LabelLayer",constructor:function(N){this._refreshLabels=U.hitch(this,this._refreshLabels);this.id="labels";this.featureLayers=[];this._featureLayerInfos=[];this._preparedLabels=[];this._engineType="STATIC";this._mapEventHandlers=[];N&&(N.id&&(this.id=N.id),N.mode&&(this._engineType="DYNAMIC"===N.mode.toUpperCase()?"DYNAMIC":"STATIC"))},_setMap:function(N){this._mapEventHandlers.push(N.on("extent-change",
U.hitch(this,"_handleLevelChange")));var J=this.inherited(arguments);this.refresh();return J},_unsetMap:function(){var N;for(N=0;N<this._mapEventHandlers.length;N++)b.disconnect(this._mapEventHandlers[N]);this.refresh();n.clearTimeout(this._refreshHandle);this._refreshHandle=null;this.inherited(arguments)},setAlgorithmType:function(N){this._engineType=N&&"DYNAMIC"===N.toUpperCase()?"DYNAMIC":"STATIC";this.refresh()},addFeatureLayer:function(N,J,D,K){if(!this.getFeatureLayer(N.layerId)){var G=[];G.push(N.on("update-end",
U.hitch(this,"refresh")));G.push(N.on("suspend",U.hitch(this,"refresh")));G.push(N.on("resume",U.hitch(this,"refresh")));G.push(N.on("edits-complete",U.hitch(this,"refresh")));G.push(N.on("labeling-info-change",U.hitch(this,"refresh")));G.push(N.on("time-extent-change",U.hitch(this,"refresh")));G.push(N.on("show-labels-change",U.hitch(this,"refresh")));G.push(N.on("feature-reduction-change",U.hitch(this,"refresh")));this._featureLayerInfos.push({FeatureLayer:N,LabelExpressionInfo:D,LabelingOptions:K,
LabelRenderer:J,EventHandlers:G});this.featureLayers.push(N);this.refresh()}},getFeatureLayer:function(N){var J;for(J=0;J<this.featureLayers.length;J++){var D=this.featureLayers[J];if(void 0!==D&&D.id==N)return D}return null},removeFeatureLayer:function(N){N=this.getFeatureLayer(N);if(void 0!==N){var J=q.indexOf(this.featureLayers,N);if(-1<J){this.featureLayers.splice(J,1);for(N=0;N<this._featureLayerInfos[J].EventHandlers.length;N++)b.disconnect(this._featureLayerInfos[J].EventHandlers[N]);this._featureLayerInfos.splice(J,
1);this.refresh()}}},removeAllFeatureLayers:function(){var N;for(N=0;N<this.featureLayers.length;N++){for(var J=0;J<this._featureLayerInfos[N].EventHandlers.length;J++)b.disconnect(this._featureLayerInfos[N].EventHandlers[J]);this.featureLayers=[];this._featureLayerInfos=[]}this.refresh()},getFeatureLayers:function(){return this.featureLayers},getFeatureLayerInfo:function(N){var J;for(J=0;J<this.featureLayers.length;J++){var D=this.featureLayers[J];if(void 0!==D&&D.id==N)return this._featureLayerInfos[J]}return null},
refresh:function(){null==this._refreshHandle&&(this._refreshHandle=n.setTimeout(this._refreshLabels,n.priority.LOW))},_handleLevelChange:function(N){N.levelChange&&this.clear();this.refresh()},_refreshLabels:function(N){this._refreshHandle=null;var J=[],D,K="DYNAMIC"===this._engineType?new C:new z;if(this._map){K.setMap(this._map,this);this._preparedLabels=[];for(N=0;N<this.featureLayers.length;N++){var G=this.featureLayers[N];if(G.visible&&G.showLabels&&G.visibleAtMapScale&&!G._suspended){var I=
this._featureLayerInfos[N];var R=this._convertOptions(null);if(I.LabelRenderer){if(J=G.labelingInfo)if(D=J[0]){var A=this._getLabelExpression(D);R=this._convertOptions(D)}var B=I.LabelRenderer;I.LabelExpressionInfo&&(A=I.LabelExpressionInfo);I.LabelingOptions&&(R=this._convertOptions(null),void 0!==I.LabelingOptions.pointPriorities&&(J=I.LabelingOptions.pointPriorities,R.pointPriorities="above-center"==J||"AboveCenter"==J||"esriServerPointLabelPlacementAboveCenter"==J?"AboveCenter":"above-left"==
J||"AboveLeft"==J||"esriServerPointLabelPlacementAboveLeft"==J?"AboveLeft":"above-right"==J||"AboveRight"==J||"esriServerPointLabelPlacementAboveRight"==J?"AboveRight":"below-center"==J||"BelowCenter"==J||"esriServerPointLabelPlacementBelowCenter"==J?"BelowCenter":"below-left"==J||"BelowLeft"==J||"esriServerPointLabelPlacementBelowLeft"==J?"BelowLeft":"below-right"==J||"BelowRight"==J||"esriServerPointLabelPlacementBelowRight"==J?"BelowRight":"center-center"==J||"CenterCenter"==J||"esriServerPointLabelPlacementCenterCenter"==
J?"CenterCenter":"center-left"==J||"CenterLeft"==J||"esriServerPointLabelPlacementCenterLeft"==J?"CenterLeft":"center-right"==J||"CenterRight"==J||"esriServerPointLabelPlacementCenterRight"==J?"CenterRight":"AboveRight"),void 0!==I.LabelingOptions.lineLabelPlacement&&(R.lineLabelPlacement=I.LabelingOptions.lineLabelPlacement),void 0!==I.LabelingOptions.lineLabelPosition&&(R.lineLabelPosition=I.LabelingOptions.lineLabelPosition),void 0!==I.LabelingOptions.labelRotation&&(R.labelRotation=I.LabelingOptions.labelRotation),
void 0!==I.LabelingOptions.howManyLabels&&(R.howManyLabels=I.LabelingOptions.howManyLabels));B instanceof O&&(A=this._getLabelExpression(B),B=new x(B.symbol),R=this._convertOptions(B));this._addLabels(G,B,A,R)}else if(J=G.labelingInfo)for(I=J.length-1;0<=I;I--)if(D=J[I])B=new O(D instanceof O?D.toJson():D),A=this._getLabelExpression(D),R=this._convertOptions(D),this._addLabels(G,B,A,R)}}A=K._process(this._preparedLabels);this.clear();this.drawLabels(this._map,A)}},drawLabels:function(N,J){this._scale=
(N.extent.xmax-N.extent.xmin)/N.width;var D;for(D=0;D<J.length;D++){var K=J[D],G=K.x,I=K.y,R=K.text,A=K.angle,B=K.layer.labelSymbol;"polyline"==K.layer.geometry.type&&K.layer.options.labelRotation&&B.setAngle(180/Math.PI*A);B.setText(R);B instanceof m&&(R=B.getHeight(),G-=.25*R*this._scale*Math.sin(A),I-=.33*R*this._scale);A=new h(new u(G,I,N.extent.spatialReference));A.setParentGraphic(K.layer.graphic);A.setSymbol(B);this.add(A)}},_addLabels:function(N,J,D,K){var G;if(this._isWithinScaleRange(J.minScale,
J.maxScale)&&D&&""!==D){var I=this._map,R=!N.url&&!I.spatialReference.equals(N.spatialReference);for(G=0;G<N.graphics.length;G++){var A=N.graphics[G];if(!1!==A.visible&&!A._suspended){var B=A.geometry;if(R){if(!v.canProject(B,I))continue;B=v.project(B,I)}if(B&&this._isWhere(J.where,A.attributes)&&this._isWithinScreenArea(B)){var H=this._buildLabelText(D,A,N.fields,K);this._addLabel(H,J,N.renderer,A,K,B,I)}}}}},_isWithinScreenArea:function(N){N="point"===N.type?new w(N.x,N.y,N.x,N.y,N.spatialReference):
N.getExtent();if(void 0===N)return!1;N=this._intersects(this._map,N);return null===N||0===N.length?!1:!0},_isWithinScaleRange:function(N,J){var D=this._map.getScale();return 0<N&&D>=N||0<J&&D<J?!1:!0},_isWhere:function(N,J){try{if(!N)return!0;if(N){var D=N.split(" ");if(3===D.length)return this._sqlEquation(J[this._removeQuotes(D[0])],D[1],this._removeQuotes(D[2]));if(7===D.length){var K=this._sqlEquation(J[this._removeQuotes(D[0])],D[1],this._removeQuotes(D[2])),G=D[3],I=this._sqlEquation(J[this._removeQuotes(D[4])],
D[5],this._removeQuotes(D[6]));switch(G){case "AND":return K&&I;case "OR":return K||I}}}return!1}catch(R){}},_sqlEquation:function(N,J,D){switch(J){case "\x3d":return N==D?!0:!1;case "\x3c\x3e":return N!=D?!0:!1;case "\x3e":return N>D?!0:!1;case "\x3e\x3d":return N>=D?!0:!1;case "\x3c":return N<D?!0:!1;case "\x3c\x3d":return N<=D?!0:!1}return!1},_removeQuotes:function(N){var J=N.indexOf('"'),D=N.lastIndexOf('"');if(-1!=J&&-1!=D)return N.substr(1,N.length-2);J=N.indexOf("'");D=N.lastIndexOf("'");return-1!=
J&&-1!=D?N.substr(1,N.length-2):N},_getSizeInfo:function(N){return N?N.sizeInfo||q.filter(N.visualVariables,V)[0]:null},_addLabel:function(N,J,D,K,G,I,R){var A;if(N&&""!==U.trim(N)&&J){N=N.replace(/[\f\n\r\t\v\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/g," ");var B=J.getSymbol(K);B instanceof m?(B=new m(B.toJson()),B.setVerticalAlignment("baseline"),B.setHorizontalAlignment("center")):B=B instanceof t?new t(B.toJson()):new m;B.setText(N);J.symbol=B;if(A=this._getProportionalSize(J.sizeInfo,
K.attributes))B instanceof m?B.setSize(A):B instanceof t&&(B.setWidth(A),B.setHeight(A));var H=A=0;if(D){var T=D.getSymbol(K);var M=this._getSizeInfo(D);if((D=M?D.getSize(K,{sizeInfo:M,resolution:R.getResolutionInMeters()}):K.size)&&null!==D)A=H=D;else if(T)if("simplemarkersymbol"==T.type)H=A=T.size;else if("picturemarkersymbol"==T.type)A=T.width,H=T.height;else if("simplelinesymbol"==T.type||"cartographiclinesymbol"==T.type)A=T.width}D={};D.graphic=K;D.options=G;D.geometry=I;D.labelRenderer=J;D.labelSymbol=
B;D.labelWidth=B.getWidth()/2;D.labelHeight=B.getHeight()/2;D.symbolWidth=a.normalizedLength(A)/2;D.symbolHeight=a.normalizedLength(H)/2;D.text=N;D.angle=B.angle;this._preparedLabels.push(D)}},_buildLabelText:function(N,J,D,K){if(K.hasExpression)return N=y.getEvalOptions({expression:K.arcadeExpr,feature:J,layer:J.getLayer(),spatialReference:this._map.spatialReference}),J=J.evaluateExpression(K.arcadeExpr,N),d.isDefined(J)?""+J:"";var G=J.attributes;return N.replace(/{[^}]*}/g,function(I){var R,A=
I;for(R=0;R<D.length;R++)if("{"+D[R].name+"}"==I){A=G[D[R].name];var B=D[R].domain;if(B&&U.isObject(B)){if("codedValue"==B.type&&K.useCodedValues)for(R=A,I=0;I<B.codedValues.length;I++)if(B.codedValues[I].code==R){A=B.codedValues[I].name;break}break}B=D[R].type;if(K.fieldInfos){var H=K.fieldInfos;for(R=0;R<H.length;R++)if("{"+H[R].fieldName+"}"==I){I=H[R].format;"esriFieldTypeDate"==B?A=d.substitute({myKey:A},"${myKey}",{format:{myKey:U.mixin({formatType:"DateFormat"},f.prototype._dateFormatsJson[I&&
I.dateFormat||"shortDate"])}}):"esriFieldTypeInteger"!=B&&"esriFieldTypeSingle"!=B&&"esriFieldTypeSmallInteger"!=B&&"esriFieldTypeLong"!=B&&"esriFieldTypeDouble"!=B||!I||(A=p.format(A,{places:I.places}),I.digitSeparator||l.group&&(A=A.replace(new RegExp("\\"+l.group,"g"),"")));break}}break}else A="";return null==A?"":A})},_getLabelExpression:function(N){var J="";N.labelExpressionInfo?J=N.labelExpressionInfo.value||N.labelExpressionInfo.expression:this._validSyntax(N.labelExpression)&&(J=this._convertLabelExpression(N.labelExpression));
return J},_validSyntax:function(N){return/^(\s*\[[^\]]+\]\s*)+$/i.test(N)},_convertLabelExpression:function(N){return N.replace(RegExp("\\[","g"),"{").replace(RegExp("\\]","g"),"}")},_getProportionalSize:function(N,J){if(!N)return null;var D=d.substitute(J,"${"+N.field+"}",{first:!0});return!(N.minSize&&N.maxSize&&N.minDataValue&&N.maxDataValue&&D)||0>=N.maxDataValue-N.minDataValue?null:(N.maxSize-N.minSize)/(N.maxDataValue-N.minDataValue)*(D-N.minDataValue)+N.minSize},_convertOptions:function(N){var J=
!0,D="shortDate",K=null,G=null,I="",R=!0;if(N&&(N.format&&(D=N.format.dateFormat,K={places:N.format.places,digitSeparator:N.format.digitSeparator}),G=N.fieldInfos,I=N.labelPlacement,null!=N.useCodedValues&&(J=N.useCodedValues),N=N.labelExpressionInfo)){var A=N.expression;if(A&&!N.value){var B=!0;var H=new g({expression:A,returnType:"string",profile:y})}}if("always-horizontal"==I||"esriServerPolygonPlacementAlwaysHorizontal"==I)R=!1;return{useCodedValues:J,dateFormat:D,numberFormat:K,fieldInfos:G,
pointPriorities:"above-center"==I||"esriServerPointLabelPlacementAboveCenter"==I?"AboveCenter":"above-left"==I||"esriServerPointLabelPlacementAboveLeft"==I?"AboveLeft":"above-right"==I||"esriServerPointLabelPlacementAboveRight"==I?"AboveRight":"below-center"==I||"esriServerPointLabelPlacementBelowCenter"==I?"BelowCenter":"below-left"==I||"esriServerPointLabelPlacementBelowLeft"==I?"BelowLeft":"below-right"==I||"esriServerPointLabelPlacementBelowRight"==I?"BelowRight":"center-center"==I||"esriServerPointLabelPlacementCenterCenter"==
I?"CenterCenter":"center-left"==I||"esriServerPointLabelPlacementCenterLeft"==I?"CenterLeft":"center-right"==I||"esriServerPointLabelPlacementCenterRight"==I?"CenterRight":"AboveRight",lineLabelPlacement:"above-start"==I||"below-start"==I||"center-start"==I?"PlaceAtStart":"above-end"==I||"below-end"==I||"center-end"==I?"PlaceAtEnd":"PlaceAtCenter",lineLabelPosition:"above-after"==I||"esriServerLinePlacementAboveAfter"==I||"above-along"==I||"esriServerLinePlacementAboveAlong"==I||"above-before"==I||
"esriServerLinePlacementAboveBefore"==I||"above-start"==I||"esriServerLinePlacementAboveStart"==I||"above-end"==I||"esriServerLinePlacementAboveEnd"==I?"Above":"below-after"==I||"esriServerLinePlacementBelowAfter"==I||"below-along"==I||"esriServerLinePlacementBelowAlong"==I||"below-before"==I||"esriServerLinePlacementBelowBefore"==I||"below-start"==I||"esriServerLinePlacementBelowStart"==I||"below-end"==I||"esriServerLinePlacementBelowEnd"==I?"Below":"center-after"==I||"esriServerLinePlacementCenterAfter"==
I||"center-along"==I||"esriServerLinePlacementCenterAlong"==I||"center-before"==I||"esriServerLinePlacementCenterBefore"==I||"center-start"==I||"esriServerLinePlacementCenterStart"==I||"center-end"==I||"esriServerLinePlacementCenterEnd"==I?"OnLine":"Above",labelRotation:R,howManyLabels:"OneLabel",hasExpression:B,arcadeExpr:H}}});U.setObject("layers.LabelLayer",e,c);return e})},"esri/layers/labelLayerUtils/DynamicLabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/Extent ../../geometry/Polygon".split(" "),
function(e,U,q,b,l,p){e=e(null,{declaredClass:"esri.layers.labelLayerUtils.DynamicLabelClass",constructor:function(){this._preparedLabels=[];this._placedLabels=[];this._extent=null;this._y1=this._x1=this._y0=this._x0=this._ymax=this._ymin=this._xmax=this._xmin=0;this._scale=1},setMap:function(r,a){this._labelLayer=a;this._xmin=r.extent.xmin;this._xmax=r.extent.xmax;this._ymin=r.extent.ymin;this._ymax=r.extent.ymax;this._scale=(this._xmax-this._xmin)/r.width},_process:function(r){this._preparedLabels=
r;this._placedLabels=[];var a;for(r=this._preparedLabels.length-1;0<=r;r--){var c=this._preparedLabels[r],d=Math.min(c.labelWidth,c.labelHeight),h=c.labelWidth+0*d;d=c.labelHeight+0*d;var f=(a=c.options)&&void 0!==a.lineLabelPlacement?a.lineLabelPlacement:"PlaceAtCenter",g=a&&void 0!==a.lineLabelPosition?a.lineLabelPosition:"Above",n=a&&void 0!==a.pointPriorities?a.pointPriorities:"AboveRight",m=[2,2,1,3,0,2,3,3,2];"AboveLeft"==n?m=[1,2,2,2,0,3,2,3,3]:"AboveCenter"==n?m=[2,1,2,2,0,2,3,3,3]:"AboveRight"==
n?m=[2,2,1,3,0,2,3,3,2]:"CenterLeft"==n?m=[2,2,3,1,0,3,2,2,3]:"CenterCenter"==n?m=[0,0,0,0,1,0,0,0,0]:"CenterRight"==n?m=[3,2,2,3,0,1,3,2,2]:"BelowLeft"==n?m=[2,3,3,2,0,3,1,2,2]:"BelowCenter"==n?m=[3,3,3,2,0,2,2,1,2]:"BelowRight"==n&&(m=[3,3,2,3,0,2,2,2,1]);var t=a&&void 0!==a.labelRotation?a.labelRotation:!0;n=Math.PI/180*c.angle;a=a&&void 0!==a.howManyLabels?a.howManyLabels:"OneLabel";if("point"==c.geometry.type)this._generatePointPositions(c,c.geometry.x,c.geometry.y,c.text,n,h,d,c.symbolWidth,
c.symbolHeight,m);else if("multipoint"==c.geometry.type)for(f=c.geometry,g=0;g<f.points.length;g++)this._generatePointPositions(c,f.points[g][0],f.points[g][1],c.text,n,h,d,c.symbolWidth,c.symbolHeight,m);else"polyline"==c.geometry.type?this._generateLinePositions(c,c.geometry,c.text,h,d,2*c.symbolHeight+d,f,g,t):"polygon"==c.geometry.type&&this._generatePolygonPositions(c,a,c.geometry,c.text,n,h,d)}return this._placedLabels},_generatePointPositions:function(r,a,c,d,h,f,g,n,m,t){n=(n+f)*this._scale;
m=(m+g)*this._scale;var w,u;for(w=1;3>=w;w++)for(u=1;9>=u;u++)if(t[u-1]==w)switch(u){case 1:if(this._findPlace(r,d,a-n,c+m,h,f,g))return;break;case 2:if(this._findPlace(r,d,a,c+m,h,f,g))return;break;case 3:if(this._findPlace(r,d,a+n,c+m,h,f,g))return;break;case 4:if(this._findPlace(r,d,a-n,c,h,f,g))return;break;case 5:if(this._findPlace(r,d,a,c,h,f,g))return;break;case 6:if(this._findPlace(r,d,a+n,c,h,f,g))return;break;case 7:if(this._findPlace(r,d,a-n,c-m,h,f,g))return;break;case 8:if(this._findPlace(r,
d,a,c-m,h,f,g))return;break;case 9:if(this._findPlace(r,d,a+n,c-m,h,f,g))return}},_generateLinePositions:function(r,a,c,d,h,f,g,n,m){var t=d*this._scale*d*this._scale,w,u;for(w=0;w<a.paths.length;w++){var v=a.paths[w],x=v.length,y=Math.floor((x-1)/2),C=0!==(x-1)%2?1:-1;"PlaceAtStart"==g&&(y=0,C=1);"PlaceAtEnd"==g&&(y=x-2,C=-1);for(;0<=y&&y<x-1;){for(u=y;u<x;u++){var z=v[y][0],F=v[y][1],O=v[u][0]-z,V=v[u][1]-F;if(O*O+V*V>t){for(var N=Math.atan2(V,O);N>Math.PI/2;)N-=Math.PI;for(;N<-(Math.PI/2);)N+=
Math.PI;var J=Math.sin(N),D=Math.cos(N),K=0,G=0;"Above"==n&&(K=f*J*this._scale,G=f*D*this._scale);"Below"==n&&(K=-f*J*this._scale,G=-f*D*this._scale);if(1==u-y){if(this._clipLine(z,F,v[u][0],v[u][1])){z=this._x1-this._x0;var I=this._y1-this._y0;if(z*z+I*I>t&&(u=Math.atan2(I,z),O=d/2+2*h,F=O*this._scale*Math.cos(u),O=O*this._scale*Math.sin(u),"PlaceAtStart"==g?(z=this._x0+F,I=this._y0+O):"PlaceAtEnd"==g?(z=this._x1-F,I=this._y1-O):(z=this._x0+z/2,I=this._y0+I/2),this._findPlace(r,c,z-K,I+G,m?-u:0,
d,h)))return}}else{var R=0;for(I=y;I<=u;I++)R=Math.max(R,Math.abs((v[I][1]-F)*D-(v[I][0]-z)*J));if(R<h&&this._findPlace(r,c,z+O/2-K,F+V/2+G,m?-N:0,d,h))return}break}}y+=C}}},_generatePolygonPositions:function(r,a,c,d,h,f,g){if("ManyLabels"==a)for(a=0;a<c.rings.length;a++){var n=c.rings[a];p.prototype.isClockwise(n)&&(n=this._findCentroid(n,this._xmin,this._ymin,this._xmax,this._ymax),this._findPlace(r,d,n[0],n[1],h,f,g))}else{n=this._findCentroidForFeature(c,this._xmin,this._ymin,this._xmax,this._ymax);
var m=n[1],t=0;for(a=0;10>a;a++){t+=g/4;n=this._findCentroidForFeature(c,this._xmin,m+(t-g/4),this._xmax,m+(t+g/4));if(this._findPlace(r,d,n[0],n[1],h,f,g))break;n=this._findCentroidForFeature(c,this._xmin,m-(t+g/4),this._xmax,m-(t-g/4));if(this._findPlace(r,d,n[0],n[1],h,f,g))break}}},_findCentroid:function(r,a,c,d,h){var f=r.length,g=[0,0],n=0,m=r[0][0],t=r[0][1];m>d&&(m=d);m<a&&(m=a);t>h&&(t=h);t<c&&(t=c);for(var w=1;w<f-1;w++){var u=r[w][0],v=r[w][1],x=r[w+1][0],y=r[w+1][1];u>d&&(u=d);u<a&&(u=
a);v>h&&(v=h);v<c&&(v=c);x>d&&(x=d);x<a&&(x=a);y>h&&(y=h);y<c&&(y=c);var C=(u-m)*(y-t)-(x-m)*(v-t);g[0]+=C*(m+u+x);g[1]+=C*(t+v+y);n+=C}g[0]/=3*n;g[1]/=3*n;if(isNaN(g[0])||isNaN(g[1]))return g;c=[];this._fillBuffer(r,c,g);g[0]=this._sortBuffer(c,g[0],a,d);return g},_findCentroidForFeature:function(r,a,c,d,h){for(var f,g=0,n=[0,0],m=0;m<r.rings.length;m++){var t=r.rings[m],w=t.length,u=t[0][0],v=t[0][1];u>d&&(u=d);u<a&&(u=a);v>h&&(v=h);v<c&&(v=c);for(f=1;f<w-1;f++){var x=t[f][0],y=t[f][1],C=t[f+1][0],
z=t[f+1][1];x>d&&(x=d);x<a&&(x=a);y>h&&(y=h);y<c&&(y=c);C>d&&(C=d);C<a&&(C=a);z>h&&(z=h);z<c&&(z=c);var F=(x-u)*(z-v)-(C-u)*(y-v);n[0]+=F*(u+x+C);n[1]+=F*(v+y+z);g+=F}}n[0]/=3*g;n[1]/=3*g;if(isNaN(n[0])||isNaN(n[1]))return n;c=[];for(f=0;f<r.rings.length;f++)this._fillBuffer(r.rings[f],c,n);n[0]=this._sortBuffer(c,n[0],a,d);return n},_fillBuffer:function(r,a,c){for(var d=r.length-1,h=r[0][1]>=r[d][1]?1:-1,f=0;f<=d;f++){var g=f,n=f+1;f==d&&(n=0);var m=r[g][0];g=r[g][1];var t=r[n][0];n=r[n][1];var w=
n>=g?1:-1;if(g<=c[1]&&c[1]<=n||n<=c[1]&&c[1]<=g)c[1]!=g&&c[1]!=n?(a.push((c[1]-g)*(t-m)/(n-g)+m),h=w):c[1]==g&&c[1]!=n?(h!=w&&a.push(m),h=w):c[1]!=g&&c[1]==n?(a.push(t),h=w):c[1]==g&&c[1]==n&&(1==h&&a.push(m),a.push(t),h=w)}},_sortBuffer:function(r,a,c,d){var h=r.length;r.sort();if(0<h){for(var f=0,g=a=0;g<h-1;g+=2){var n=Math.abs(r[g+1]-r[g]);!(r[g]<=c&&r[g+1]<=c||r[g]>=d&&r[g+1]>=d)&&n>f&&(f=n,a=g)}h=r[a];r=r[a+1];h>d&&(h=d);h<c&&(h=c);r>d&&(r=d);r<c&&(r=c);a=(h+r)/2}return a},_findPlace:function(r,
a,c,d,h,f,g){if(isNaN(c)||isNaN(d))return!1;for(var n=0;n<this._placedLabels.length;n++){var m=this._placedLabels[n].angle,t=this._placedLabels[n].width*this._scale,w=this._placedLabels[n].height*this._scale,u=this._placedLabels[n].x-c,v=this._placedLabels[n].y-d;if(0===h&&0===m){if(this._findPlace2(-f*this._scale,-g*this._scale,f*this._scale,g*this._scale,u-t,v-w,u+t,v+w))return!1}else{var x=new l(-f*this._scale,-g*this._scale,f*this._scale,g*this._scale,null),y=0,C=1;0!==h&&(y=Math.sin(h),C=Math.cos(h));
var z=u*C-v*y;u=u*y+v*C;m-=h;y=Math.sin(m);C=Math.cos(m);var F=-t*C- -w*y;v=-t*y+-w*C;m=+t*C- -w*y;var O=+t*y+-w*C;t=z+F;w=u-v;y=z+m;C=u-O;F=z-F;v=u+v;z-=m;u+=O;m=new p;m.addRing([[t,w],[y,C],[F,v],[z,u],[t,w]]);if(x.intersects(m))return!1}}for(;h>Math.PI/2;)h-=Math.PI;for(;h<-(Math.PI/2);)h+=Math.PI;n={};n.layer=r;n.text=a;n.angle=h;n.x=c;n.y=d;n.width=f;n.height=g;this._placedLabels.push(n);return!0},_findPlace2:function(r,a,c,d,h,f,g,n){return(r>=h&&r<=g||c>=h&&c<=g||r<=h&&c>=g)&&(a>=f&&a<=n||
d>=f&&d<=n||a<=f&&d>=n)?!0:!1},_clipLine:function(r,a,c,d){for(var h=this._code(r,a),f=this._code(c,d);0!==h||0!==f;){if(0!==(h&f))return!1;var g=c-r,n=d-a;0!==h?(r<this._xmin?(a+=n*(this._xmin-r)/g,r=this._xmin):r>this._xmax?(a+=n*(this._xmax-r)/g,r=this._xmax):a<this._ymin?(r+=g*(this._ymin-a)/n,a=this._ymin):a>this._ymax&&(r+=g*(this._ymax-a)/n,a=this._ymax),h=this._code(r,a)):(c<this._xmin?(d+=n*(this._xmin-c)/g,c=this._xmin):c>this._xmax?(d+=n*(this._xmax-c)/g,c=this._xmax):d<this._ymin?(c+=
g*(this._ymin-d)/n,d=this._ymin):d>this._ymax&&(c+=g*(this._ymax-d)/n,d=this._ymax),f=this._code(c,d))}this._x0=r;this._y0=a;this._x1=c;this._y1=d;return!0},_code:function(r,a){var c=0;r<this._xmin&&(c+=8);r>this._xmax&&(c+=4);a<this._ymin&&(c+=2);a>this._ymax&&(c+=1);return c}});U.setObject("layers.labelLayerUtils.DynamicLabelClass",e,b);return e})},"esri/layers/labelLayerUtils/StaticLabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/Extent ../../geometry/Point ../../geometry/Polygon".split(" "),
function(e,U,q,b,l,p,r){return e(null,{declaredClass:"esri.layers.labelLayerUtils.StaticLabel",constructor:function(){this._preparedLabels=[];this._placedLabels=[];this._extent=null;this._ymax=this._ymin=this._xmax=this._xmin=0;this._scale=1;this._LINE_STEP_CONST=1.5;this._POLYGON_X_STEP_CONST=1;this._POLYGON_Y_STEP_CONST=.75;this._OVERRUN=2},setMap:function(a,c){this._labelLayer=c;this._map=a;this._xmin=a.extent.xmin;this._xmax=a.extent.xmax;this._ymin=a.extent.ymin;this._ymax=a.extent.ymax;this._scale=
(this._xmax-this._xmin)/a.width},_process:function(a){var c;this._preparedLabels=a;this._placedLabels=[];for(a=this._preparedLabels.length-1;0<=a;a--){var d=this._preparedLabels[a];var h=d.labelWidth;var f=d.labelHeight;var g=(c=d.options)&&c.lineLabelPlacement?c.lineLabelPlacement:"PlaceAtCenter";var n=c&&c.lineLabelPosition?c.lineLabelPosition:"Above";var m=c&&c.labelRotation?c.labelRotation:!0;var t=Math.PI/180*d.angle;var w=c&&c.howManyLabels?c.howManyLabels:"OneLabel";var u=[];if("point"===d.geometry.type)this._generatePointPositions(d.geometry.x,
d.geometry.y,d.text,t,h,f,d.symbolWidth,d.symbolHeight,c,u);else if("multipoint"===d.geometry.type)for(m=0;m<d.geometry.points.length;m++)this._generatePointPositions(d.geometry.points[m][0],d.geometry.points[m][1],d.text,t,h,f,d.symbolWidth,d.symbolHeight,c,u);else if("polyline"===d.geometry.type)if("PlaceAtStart"===g)this._generateLinePositionsPlaceAtStart(d.geometry,!0,d.text,h,f,2*d.symbolHeight+f,g,n,m,u);else if("PlaceAtEnd"===g)this._generateLinePositionsPlaceAtEnd(d.geometry,!0,d.text,h,f,
2*d.symbolHeight+f,g,n,m,u);else{c=[];var v=d.geometry.getExtent(),x=this._map.extent;if(v.getWidth()<h*this._scale/this._OVERRUN&&v.getHeight()<h*this._scale/this._OVERRUN)continue;else.5*v.getWidth()<x.getWidth()&&.5*v.getHeight()<x.getHeight()?this._generateLinePositionsPlaceAtCenter(d.geometry,!1,.1*Math.min(this._map.width,this._map.height)*this._scale,d.text,h,f,2*d.symbolHeight+f,g,n,m,c):this._generateLinePositionsPlaceAtCenter(d.geometry,!0,.2*Math.min(this._map.width,this._map.height)*this._scale,
d.text,h,f,2*d.symbolHeight+f,g,n,m,c);this._postSorting(x,c,u)}else if("polygon"===d.geometry.type){g=[];for(m=0;m<d.geometry.rings.length;m++)n=d.geometry.rings[m],1<d.geometry.rings.length&&!r.prototype.isClockwise(n)||(c=this._calcRingExtent(n),c.xmax-c.xmin<4*h*this._scale/this._OVERRUN&&c.ymax-c.ymin<4*f*this._scale/this._OVERRUN||g.push(n));g.sort(function(y,C){return C.length-y.length});for(m=0;m<g.length;m++)this._generatePolygonPositionsForManyLabels(g[m],d.geometry.spatialReference,d.text,
t,h,f,u)}for(m=0;m<u.length&&(g=u[m].x,n=u[m].y,void 0!==u[m].angle&&(t=u[m].angle),c=this._findPlace(d,d.text,g,n,t,h,f),"OneLabel"!==w||!c||!this._labelLayer._isWithinScreenArea(new p(g,n,d.geometry.spatialReference)));m++);}return this._placedLabels},_generatePointPositions:function(a,c,d,h,f,g,n,m,t,w){d=t&&t.pointPriorities?t.pointPriorities:"AboveRight";f=(n+f)*this._scale;g=(m+g)*this._scale;switch(d.toLowerCase()){case "aboveleft":a-=f;c+=g;break;case "abovecenter":c+=g;break;case "aboveright":a+=
f;c+=g;break;case "centerleft":a-=f;break;case "centercenter":break;case "centerright":a+=f;break;case "belowleft":a-=f;c-=g;break;case "belowcenter":c-=g;break;case "belowright":a+=f;c-=g;break;default:return}w.push({x:a,y:c})},_generateLinePositionsPlaceAtStart:function(a,c,d,h,f,g,n,m,t,w){n=h*this._scale;var u=this._LINE_STEP_CONST*Math.min(this._map.width,this._map.height)*this._scale,v,x;for(v=0;v<a.paths.length;v++){var y=a.paths[v],C=n,z=0;for(x=0;x<y.length-1;x++){var F=y[x][0];var O=y[x][1];
var V=y[x+1][0];var N=y[x+1][1];var J=V-F;var D=N-O;J=Math.sqrt(J*J+D*D);z+J>C?(z=this._generatePositionsOnLine(a.spatialReference,c,C,u,z,F,O,V,N,d,h,f,g,m,t,w),C=u):z+=J}}},_generateLinePositionsPlaceAtEnd:function(a,c,d,h,f,g,n,m,t,w){n=h*this._scale;var u=this._LINE_STEP_CONST*Math.min(this._map.width,this._map.height)*this._scale,v,x;for(v=0;v<a.paths.length;v++){var y=a.paths[v],C=n,z=0;for(x=y.length-2;0<=x;x--){var F=y[x+1][0];var O=y[x+1][1];var V=y[x][0];var N=y[x][1];var J=V-F;var D=N-
O;J=Math.sqrt(J*J+D*D);z+J>C?(z=this._generatePositionsOnLine(a.spatialReference,c,C,u,z,F,O,V,N,d,h,f,g,m,t,w),C=u):z+=J}}},_generateLinePositionsPlaceAtCenter:function(a,c,d,h,f,g,n,m,t,w,u){var v;for(m=0;m<a.paths.length;m++){var x=a.paths[m];if(!(2>x.length)){if(2==x.length){var y=x[0];var C=x[1];var z=y[0];y=y[1];x=C[0];var F=C[1];var O=(x-z)*(x-z)+(F-y)*(F-y);var V=Math.atan2(F-y,x-z);F=Math.cos(V);V=Math.sin(V);x=[];var N=z;for(var J=y;(N-z)*(N-z)+(J-y)*(J-y)<O;)x.push([N,J]),N+=d/2*F,J+=d/
2*V;x.push(C)}var D=0;for(C=0;C<x.length-1;C++)z=x[C][0],y=x[C][1],O=x[C+1][0],F=x[C+1][1],V=O-z,N=F-y,D+=Math.sqrt(V*V+N*N);for(C=J=0;C<x.length-1;C++){z=x[C][0];y=x[C][1];O=x[C+1][0];F=x[C+1][1];V=O-z;N=F-y;V=Math.sqrt(V*V+N*N);if(J+V>D/2)break;J+=V}C==x.length-1&&C--;z=x[C][0];y=x[C][1];O=x[C+1][0];F=x[C+1][1];V=O-z;N=F-y;J=D/2-J;V=Math.atan2(N,V);N=z+J*Math.cos(V);V=y+J*Math.sin(V);z=this._angleAndShifts(z,y,O,F,n,t,w);u.push({x:N+z.shiftX,y:V+z.shiftY,angle:z.angle});D=N;var K=V;J=0;for(v=C;v<
x.length-1;v++)v==C?(z=D,y=K):(z=x[v][0],y=x[v][1]),O=x[v+1][0],F=x[v+1][1],V=O-z,N=F-y,V=Math.sqrt(V*V+N*N),J=J+V>d?this._generatePositionsOnLine(a.spatialReference,c,d,d,J,z,y,O,F,h,f,g,n,t,w,u):J+V;J=0;for(v=C;0<=v;v--)v==C?(z=D,y=K):(z=x[v+1][0],y=x[v+1][1]),O=x[v][0],F=x[v][1],V=O-z,N=F-y,V=Math.sqrt(V*V+N*N),J=J+V>d?this._generatePositionsOnLine(a.spatialReference,c,d,d,J,z,y,O,F,h,f,g,n,t,w,u):J+V}}},_generatePositionsOnLine:function(a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z){w=Math.atan2(t-n,m-g);u=
g;v=n;var F=u,O=v;do if(f=d-f,u+=f*Math.cos(w),v+=f*Math.sin(w),this._belongs(u,v,g,n,m,t))f=this._angleAndShifts(g,n,m,t,x,y,C),d=u+f.shiftX,O=v+f.shiftY,c?this._labelLayer._isWithinScreenArea(new l(d,O,d,O,a))&&z.push({x:d,y:O,angle:f.angle}):z.push({x:d,y:O,angle:f.angle}),F=u,O=v,f=0,d=h;else return a=m-F,t-=O,Math.sqrt(a*a+t*t);while(1)},_postSorting:function(a,c,d){if(a&&0<c.length){var h=.5*(a.xmin+a.xmax);a=.5*(a.ymin+a.ymax);for(var f=c[0].x,g=c[0].y,n=Math.sqrt((f-h)*(f-h)+(g-a)*(g-a)),
m=c[0].angle,t=0;t<c.length;t++){var w=c[t].x,u=c[t].y,v=Math.sqrt((w-h)*(w-h)+(u-a)*(u-a));v<n&&(f=w,g=u,n=v,m=c[t].angle)}d.push({x:f,y:g,angle:m})}},_belongs:function(a,c,d,h,f,g){if(f==d&&g==h)return!1;if(f>d){if(a>f||a<d)return!1}else if(a<f||a>d)return!1;if(g>h){if(c>g||c<h)return!1}else if(c<g||c>h)return!1;return!0},_angleAndShifts:function(a,c,d,h,f,g,n){for(a=Math.atan2(h-c,d-a);a>Math.PI/2;)a-=Math.PI;for(;a<-(Math.PI/2);)a+=Math.PI;h=Math.sin(a);var m=Math.cos(a);d=c=0;"Above"==g&&(c=
f*h*this._scale,d=f*m*this._scale);"Below"==g&&(c=-f*h*this._scale,d=-f*m*this._scale);f=[];f.angle=n?-a:0;f.shiftX=-c;f.shiftY=d;return f},_generatePolygonPositionsForManyLabels:function(a,c,d,h,f,g,n){f=this._findCentroidForRing(a);h=f[0];var m=f[1],t=this._calcRingExtent(a);f=t.xmin;g=t.ymin;var w=t.xmax;t=t.ymax;var u=(t-g)/(this._map.height*this._scale);if(!(10<(w-f)/(this._map.width*this._scale)&&10<u)){var v=!0;if(w-f>this._map.width*this._scale||t-g>this._map.height*this._scale)v=!1;u=this._map.width*
this._scale*(v?.1875:.5);v=this._map.height*this._scale*(v?.1875:.5);var x=!0,y=!0,C=0;do{m+=(C%2?-1:1)*C*v;if(this._scanRingByX(d,c,a,h,m,f,w,u,n))break;m<g&&(x=!1);m>t&&(y=!1);C++}while(x||y)}},_scanRingByX:function(a,c,d,h,f,g,n,m,t){var w=!0,u=!0,v=0,x=1E3;do{h+=(v%2?-1:1)*v*m;var y=this._movePointInsideRing(d,h,f),C=this._labelLayer._isWithinScreenArea(new l(y,f,y,f,c)),z=this._isPointWithinRing(a,d,y,f);if(C&&z)return t.push({x:y,y:f}),!0;h<g&&(w=!1);h>n&&(u=!1);v++;x--;if(0>=x)return!0}while(w||
u);return!1},_movePointInsideRing:function(a,c,d){for(var h=[],f=a.length-1,g=a[0][1]>=a[f][1]?1:-1,n=0;n<=f;n++){var m=n,t=n+1;n==f&&(t=0);var w=a[m][0];m=a[m][1];var u=a[t][0];t=a[t][1];var v=t>=m?1:-1;if(m<=d&&d<=t||t<=d&&d<=m)d!=m&&d!=t?(h.push((d-m)*(u-w)/(t-m)+w),g=v):d==m&&d!=t?(g!=v&&h.push(w),g=v):d!=m&&d==t?(h.push(u),g=v):d==m&&d==t&&(1==g&&h.push(w),h.push(u),g=v)}h.sort(function(x,y){return x-y});a=h.length;if(0<a){for(n=d=c=0;n<a-1;n+=2)f=Math.abs(h[n+1]-h[n]),f>c&&(c=f,d=n);c=(h[d]+
h[d+1])/2}return c},_calcRingExtent:function(a){var c;var d=new l;for(c=0;c<a.length-1;c++){var h=a[c][0],f=a[c][1];if(void 0===d.xmin||h<d.xmin)d.xmin=h;if(void 0===d.ymin||f<d.ymin)d.ymin=f;if(void 0===d.xmax||h>d.xmax)d.xmax=h;if(void 0===d.ymax||f>d.ymax)d.ymax=f}return d},_isPointWithinPolygon:function(a,c,d,h){var f;for(f=0;f<c.rings.length;f++)if(this._isPointWithinRing(a,c.rings[f],d,h))return!0;return!1},_isPointWithinRing:function(a,c,d,h){var f=[],g=c.length;for(a=0;a<g-1;a++){var n=c[a][0];
var m=c[a][1];var t=c[a+1][0];var w=c[a+1][1];if(n!=t||m!=w){if(m==w)if(h==m)f.push(n);else continue;n==t?(m<w&&h>=m&&h<w&&f.push(n),m>w&&h<=m&&h>w&&f.push(n)):(m=(t-n)/(w-m)*(h-m)+n,n<t&&m>=n&&m<t&&f.push(m),n>t&&m<=n&&m>t&&f.push(m))}}f.sort(function(u,v){return u-v});for(a=0;a<f.length-1;a++)if(n=f[a],t=f[a+1],d>=n&&d<t)if(a%2)break;else return!0;return!1},_findCentroidForRing:function(a){for(var c=a.length,d=[0,0],h=0,f=a[0][0],g=a[0][1],n=1;n<c-1;n++){var m=a[n][0],t=a[n][1],w=a[n+1][0],u=a[n+
1][1],v=(m-f)*(u-g)-(w-f)*(t-g);d[0]+=v*(f+m+w);d[1]+=v*(g+t+u);h+=v}d[0]/=3*h;d[1]/=3*h;return d},_findCentroidForFeature:function(a){for(var c=0,d=[0,0],h=0;h<a.rings.length;h++)for(var f=a.rings[h],g=f.length,n=f[0][0],m=f[0][1],t=1;t<g-1;t++){var w=f[t][0],u=f[t][1],v=f[t+1][0],x=f[t+1][1],y=(w-n)*(x-m)-(v-n)*(u-m);d[0]+=y*(n+w+v);d[1]+=y*(m+u+x);c+=y}d[0]/=3*c;d[1]/=3*c;return d},_findPlace:function(a,c,d,h,f,g,n){if(isNaN(d)||isNaN(h))return!1;for(var m=0;m<this._placedLabels.length;m++){var t=
this._placedLabels[m].angle,w=this._placedLabels[m].width*this._scale,u=this._placedLabels[m].height*this._scale,v=this._placedLabels[m].x-d,x=this._placedLabels[m].y-h;if(0===f&&0===t){if(this._findPlace2(-g*this._scale,-n*this._scale,g*this._scale,n*this._scale,v-w,x-u,v+w,x+u))return!1}else{var y=new l(-g*this._scale,-n*this._scale,g*this._scale,n*this._scale,null),C=0,z=1;0!==f&&(C=Math.sin(f),z=Math.cos(f));var F=v*z-x*C;v=v*C+x*z;t-=f;C=Math.sin(t);z=Math.cos(t);var O=-w*z- -u*C;x=-w*C+-u*z;
t=+w*z- -u*C;var V=+w*C+-u*z;w=F+O;u=v-x;C=F+t;z=v-V;O=F-O;x=v+x;F-=t;v+=V;t=new r;t.addRing([[w,u],[C,z],[O,x],[F,v],[w,u]]);if(y.intersects(t))return!1}}for(;f>Math.PI/2;)f-=Math.PI;for(;f<-(Math.PI/2);)f+=Math.PI;m={};m.layer=a;m.text=c;m.angle=f;m.x=d;m.y=h;m.width=g;m.height=n;this._placedLabels.push(m);return!0},_findPlace2:function(a,c,d,h,f,g,n,m){return(a>=f&&a<=n||d>=f&&d<=n||a<=f&&d>=n)&&(c>=g&&c<=m||h>=g&&h<=m||c<=g&&h>=m)?!0:!1}})})},"arcgisonline/map/edit":function(){define(["dojo",
"dijit","dojox","dojo/require!arcgisonline/map/main"],function(e,U,q){e.provide("arcgisonline.map.edit");e.require("arcgisonline.map.main");arcgisonline.map.edit={editActivated:!1,hasEditableFS:!1,notEditableLayers:[],proxyCheckedServers:[],checkGoingOn:!1,startMsg:null,addPointMsg:null,checkOnEditButton:function(){arcgisonline.map.edit.checkGoingOn||arcgisonline.map.edit.checkInternalLayer()},checkInternalLayer:function(){arcgisonline.map.edit.checkGoingOn=!0;for(var b=!1,l=0;l<arcgisonline.map.main.mapLayers.length;l++){var p=
arcgisonline.map.main.mapLayers[l];if(p&&p.layer&&p.layer.visible&&p.url&&!arcgisonline.map.featColl.isFeatureCollection(p)&&!arcgisonline.sharing.util.isHostedService(p.url)&&p.layer instanceof esri.layers.FeatureLayer&&p.layer.isEditable()&&!p.proxyCheck)if(esri.hasSameOrigin(p.url,window.location.href))p.proxyCheck="sameOrigin";else if(esri.canUseXhr(p.url))p.proxyCheck="cors";else{b=!0;arcgisonline.map.edit.getProxyServiceInfo(l,1);break}}b||(arcgisonline.map.edit.checkGoingOn=!1,arcgisonline.map.edit.hasEditableLayer())},
hasEditableLayer:function(){if(!arcgisonline.map.role.isAllowed("tool_edit")||isEmbedded&&isEmbedded.hideEdit)if(arcgisonline.map.role.isAllowed("tool_edit_mapNotes")){for(var b=!1,l=0;l<arcgisonline.map.main.mapLayers.length;l++){var p=arcgisonline.map.main.mapLayers[l];if("mapNotes"===p.type){for(var r=0;r<p.layers.length;r++){var a=p.layers[r];if(a.visible&&a.isEditable()){b=!0;break}}break}}b?arcgisonline.map.edit.enableEditButton():arcgisonline.map.edit.disableEditButton()}else arcgisonline.map.edit.disableEditButton();
else{b=!1;arcgisonline.map.edit.hasEditableFS=!1;for(l=0;l<arcgisonline.map.main.mapLayers.length;l++)if(p=arcgisonline.map.main.mapLayers[l],r=arcgisonline.map.featColl.isFeatureCollection(p),a=arcgisonline.map.featColl.is4xSketchLayer(p),r&&!a&&arcgisonline.map.role.isAllowed("tool_edit_featCol")||"mapNotes"===p.type&&arcgisonline.map.role.isAllowed("tool_edit_mapNotes"))if(p.layer&&p.layer.visible&&p.layer.isEditable())b=!0;else{if(p.layers&&0<p.layers.length&&(r=!1,"notes"===p.featureCollectionType&&
e.some(p.layers,function(c){c=c.fields;return 1===c.length&&"OBJECTID"===c[0].name})&&(r=!0),!r))for(r=0;r<p.layers.length;r++)if(a=p.layers[r],a.visible&&a.isEditable()){b=!0;break}}else p&&p.layer&&p.layer.visible&&p.layer.url&&p.layer instanceof esri.layers.FeatureLayer&&p.layer.isEditable()&&("success"===p.proxyCheck||"cors"===p.proxyCheck||"sameOrigin"===p.proxyCheck||arcgisonline.sharing.util.isHostedService(p.url)&&p.layer.isEditable()?b=arcgisonline.map.edit.hasEditableFS=!0:p.layer._editable=
!1);b?arcgisonline.map.edit.enableEditButton():arcgisonline.map.edit.disableEditButton()}},getProxyServiceInfo:function(b,l){var p=arcgisonline.map.main.mapLayers[b],r=function(m,t){clearTimeout(n);n=null;if(m){var w=p.layer.url,u=-1<w.indexOf("/FeatureServer")?w.substring(0,w.indexOf("/FeatureServer")+14):null;arcgisonline.map.edit.proxyCheckedServers[d]=arcgisonline.map.edit.proxyCheckedServers[d]||[];e.filter(arcgisonline.map.edit.proxyCheckedServers[d],function(v){return v.service===u}).length||
arcgisonline.map.edit.proxyCheckedServers[d].push({service:u,result:{},proxyCheck:"success"})}p.proxyCheck="success";p.layer._editable=!0;arcgisonline.map.edit.checkInternalLayer()},a=function(m){clearTimeout(n);n=null;if(m||1!==l){p.proxyCheck="failure";arcgisonline.map.edit.checkInternalLayer();arcgisonline.map.edit.notEditableLayers.push(p.title);var t=p.layer.url,w=-1<t.indexOf("/FeatureServer")?t.substring(0,t.indexOf("/FeatureServer")+14):null;arcgisonline.map.edit.proxyCheckedServers[d]=arcgisonline.map.edit.proxyCheckedServers[d]||
[];e.filter(arcgisonline.map.edit.proxyCheckedServers[d],function(u){return u.service===w}).length||(arcgisonline.map.edit.proxyCheckedServers[d].push({service:w,result:m||{},proxyCheck:"failure"}),setTimeout(function(){var u="";u=m&&400===m.status?1<arcgisonline.map.edit.notEditableLayers.length?e.string.substitute(esri.i18nBundle.viewer.edit.notEditableLayers,{layers:"\x3cbr/\x3e-\x26nbsp;\x26nbsp;"+arcgisonline.map.edit.notEditableLayers.toString().replace(/,/g,"\x3cbr/\x3e-\x26nbsp;\x26nbsp;")+
"\x3cbr/\x3e\x3cbr/\x3e",appName:esriGeowConfig.portalName?esriGeowConfig.portalName:esri.i18nBundle.common.arcgisCom}):e.string.substitute(esri.i18nBundle.viewer.edit.notEditableLayer,{layer:arcgisonline.map.edit.notEditableLayers[0],appName:esriGeowConfig.portalName?esriGeowConfig.portalName:esri.i18nBundle.common.arcgisCom}):esriGeowConfig.self.isPortal&&m&&(-1===m.code||403===m.code&&2===m.subcode)?1<arcgisonline.map.edit.notEditableLayers.length?e.string.substitute(esri.i18nBundle.viewer.edit.notEditableLayersTrusted,
{layers:"\x3cbr/\x3e-\x26nbsp;\x26nbsp;"+arcgisonline.map.edit.notEditableLayers.toString().replace(/,/g,"\x3cbr/\x3e-\x26nbsp;\x26nbsp;")+"\x3cbr/\x3e\x3cbr/\x3e",appName:esriGeowConfig.portalName?esriGeowConfig.portalName:esri.i18nBundle.common.arcgisCom}):e.string.substitute(esri.i18nBundle.viewer.edit.notEditableLayerTrusted,{layer:arcgisonline.map.edit.notEditableLayers[0],appName:esriGeowConfig.portalName?esriGeowConfig.portalName:esri.i18nBundle.common.arcgisCom}):1<arcgisonline.map.edit.notEditableLayers.length?
e.string.substitute(esri.i18nBundle.viewer.edit.notEditableLayersGeneric,{layers:"\x3cbr/\x3e-\x26nbsp;\x26nbsp;"+arcgisonline.map.edit.notEditableLayers.toString().replace(/,/g,"\x3cbr/\x3e-\x26nbsp;\x26nbsp;")+"\x3cbr/\x3e\x3cbr/\x3e",appName:esriGeowConfig.portalName?esriGeowConfig.portalName:esri.i18nBundle.common.arcgisCom}):e.string.substitute(esri.i18nBundle.viewer.edit.notEditableLayerGeneric,{layer:arcgisonline.map.edit.notEditableLayers[0],appName:esriGeowConfig.portalName?esriGeowConfig.portalName:
esri.i18nBundle.common.arcgisCom});var v=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();v.show({title:esri.i18nBundle.viewer.edit.editing,message:u});e.aspect.after(v,"onHide",function(){arcgisonline.map.edit.notEditableLayers=[]})},2E3))}else arcgisonline.map.edit.getProxyServiceInfo(b,2)};if(arcgisonline.map.edit.proxyCheckedServers){var c=p.layer.url,d=c.substring(0,c.indexOf("/",9)),h=arcgisonline.map.edit.proxyCheckedServers[d];if(h){var f=-1<c.indexOf("/FeatureServer")?
c.substring(0,c.indexOf("/FeatureServer")+14):null,g=h[0];f&&e.forEach(h,function(m){m.service===f&&(g=m)});if("success"===g.proxyCheck){if(!esriGeowConfig.self.isPortal||!f||g.service===f){r();return}}else if(403!==g.result.code||2!==g.result.subcode||g.service===f){a(g.result);return}}}var n=setTimeout(function(){a({})},2E4);p.layer._editable=!1;c=p.layer.url+"?f\x3djson";(h=p.layer._getToken())&&(c+="\x26token\x3d"+h);esri.request({url:c,content:null,callbackParamName:"callback",load:function(m,
t){n&&(m.error&&0<m.error.length?a(m):r(m,t))},error:function(m,t){n&&a(m)}},{usePost:!0,useProxy:!0})},enableEditButton:function(){U.byId("webmap-edit")&&"none"===e.style(U.byId("webmap-edit").domNode,"display")&&(U.byId("webmap-edit").set("disabled",!1),10>=e.isIE?e.style(U.byId("webmap-edit").domNode,"display","inline-block"):e.style(U.byId("webmap-edit").domNode,"display",""),isEmbedded&&isEmbedded.hideBasemap&&e.style(e.byId("webmap-spacer2"),"display",""),arcgisonline.map.main.checkMinWidthOfPage())},
disableEditButton:function(){U.byId("webmap-edit")&&"none"!==e.style(U.byId("webmap-edit").domNode,"display")&&(e.style(U.byId("webmap-edit").domNode,"display","none"),isEmbedded&&isEmbedded.hideBasemap&&e.style(e.byId("webmap-spacer2"),"display","none"),arcgisonline.map.main.checkMinWidthOfPage())},clearSelection:function(){arcgisonline.map.edit.editActivated&&leftPanel.editPanel.editorWidget._clearSelection()},activateEdit:function(){arcgisonline.map.main.map.infoWindow.hide();arcgisonline.map.popup.disablePopupHandler();
arcgisonline.map.edit.editActivated=!0;arcgisonline.map.main.map.setMapCursor("default");arcgisonline.map.geocode.geocoder&&e.forEach(arcgisonline.map.geocode.geocoder.sources,function(b){if(b.layerId){var l=arcgisonline.map.main.getParameterListById(b.layerId);l&&l.layer&&l.layer.isEditable()&&(b.showInfoWindowOnSelect=!1)}});arcgisonline.map.edit.createTypesAndTemplatesForAllFeatCollLayers();e.forEach(arcgisonline.map.main.mapLayers,function(b){b.layer&&b.layer instanceof esri.layers.FeatureLayer&&
b.layer.isEditable()?arcgisonline.map.mapUtil.checkHostedFSAccess(b,e.hitch(this,function(l){"esri.renderer.HeatmapRenderer"===l.layer.renderer.declaredClass&&(l.layer.__currentRenderer=l.layer.renderer.toJson(),l.layer.setRenderer(new esri.renderers.SimpleRenderer(new esri.symbols.SimpleMarkerSymbol)),l.layer.redraw())}),e.hitch(this,function(){if(b.serviceInfo&&b.serviceInfo.drawingInfo&&b.serviceInfo.drawingInfo.renderer){var l=b.layer.renderer.toJson();if(e.toJson(b.serviceInfo.drawingInfo.renderer)!==
e.toJson(l)){b.layer.__currentRenderer=b.layer.renderer.toJson();l=esri.renderer.fromJson(b.serviceInfo.drawingInfo.renderer,{geometryType:b.layer.geometryType});if("esri.renderer.HeatmapRenderer"===l.declaredClass)b.layer.setRenderer(new esri.renderers.SimpleRenderer(new esri.symbols.SimpleMarkerSymbol));else if(b.layer.setRenderer(l),9>e.has("ie")){var p=[];l.symbol&&p.push(l.symbol);l.defaultSymbol&&p.push(l.defaultSymbol);l.infos&&e.forEach(l.infos,function(c){c.symbol&&p.push(c.symbol)});var r=
b.layer._url.path+"/images/",a=b.layer._getToken();e.forEach(p,function(c){var d=c.url;d&&(-1===d.search(/https?:/)&&-1===d.indexOf("data:")&&(c.url=r+d),a&&-1!==c.url.search(/https?:/)&&(c.url+="?token\x3d"+a))})}b.layer.redraw()}}else"esri.renderer.HeatmapRenderer"===b.layer.renderer.declaredClass&&(b.layer.__currentRenderer=b.layer.renderer.toJson(),b.layer.setRenderer(new esri.renderers.SimpleRenderer(new esri.symbols.SimpleMarkerSymbol)),b.layer.redraw())})):b.layers&&e.forEach(b.layers,function(l){l&&
l.isEditable()&&"esri.renderer.HeatmapRenderer"===l.renderer.declaredClass&&(l.__currentRenderer=l.renderer.toJson(),l.setRenderer(new esri.renderers.SimpleRenderer(new esri.symbols.SimpleMarkerSymbol)),l.redraw())})});arcgisonline.map.edit.startMsg=esri.bundle.toolbars.draw.start;arcgisonline.map.edit.addPointMsg=esri.bundle.toolbars.draw.addPoint;-1===esri.bundle.toolbars.draw.start.indexOf(esri.i18nBundle.viewer.main.snappingTip)&&(esri.bundle.toolbars.draw.start=esri.bundle.toolbars.draw.start+
"\x3cbr/\x3e"+esri.i18nBundle.viewer.main.snappingTip);-1===esri.bundle.toolbars.draw.addPoint.indexOf(esri.i18nBundle.viewer.main.snappingTip)&&(esri.bundle.toolbars.draw.addPoint=esri.bundle.toolbars.draw.addPoint+"\x3cbr/\x3e"+esri.i18nBundle.viewer.main.snappingTip)},stopEdit:function(){leftPanel&&leftPanel.editPanel&&leftPanel.editPanel.editorWidget&&leftPanel.editPanel.destroyEditor();arcgisonline.map.edit.editActivated=!1;arcgisonline.map.main.map&&arcgisonline.map.main.map.infoWindow.resize(300,
300);arcgisonline.map.main.setHandCursor();arcgisonline.map.popup.setupPopupHandler();arcgisonline.map.edit.removeTypesAndTemplatesForAllFeatCollLayers();arcgisonline.map.geocode.geocoder&&e.forEach(arcgisonline.map.geocode.geocoder.sources,function(b){delete b.showInfoWindowOnSelect});e.forEach(arcgisonline.map.main.mapLayers,function(b){b.layer&&b.layer.__currentRenderer?(b.layer.setRenderer(esri.renderer.fromJson(b.layer.__currentRenderer)),b.layer.redraw(),delete b.layer.__currentRenderer):b.layers&&
e.forEach(b.layers,function(l){l&&l.__currentRenderer&&(l.setRenderer(esri.renderer.fromJson(l.__currentRenderer)),l.redraw(),delete l.__currentRenderer)})});esri.bundle.toolbars.draw.start=arcgisonline.map.edit.startMsg||esri.bundle.toolbars.draw.start;esri.bundle.toolbars.draw.addPoint=arcgisonline.map.edit.addPointMsg||esri.bundle.toolbars.draw.addPoint},createTypesAndTemplatesForAllFeatCollLayers:function(){for(var b=arcgisonline.map.main.mapLayers.length-1;0<=b;b--){var l=arcgisonline.map.main.mapLayers[b];
if(arcgisonline.map.featColl.isFeatureCollection(l)&&!arcgisonline.map.mapNotes.isMapNotesMapLayer(l))if(l.layer)arcgisonline.map.edit.createTypesAndTemplatesOnLayer(l.layer);else if(l.layers)for(var p=l.layers.length-1;0<=p;p--)arcgisonline.map.edit.createTypesAndTemplatesOnLayer(l.layers[p])}},createTypesAndTemplatesOnMapLayer:function(b){if(b.layer&&arcgisonline.map.featColl.isFeatureCollection(b)&&!arcgisonline.map.mapNotes.isMapNotesMapLayer(b))if(b.layer){var l=b.layer;if(l.visible){var p=l.toJson();
p.layerDefinition.types&&0!=p.layerDefinition.types.length||p.layerDefinition.templates&&0!=p.layerDefinition.templates.length||arcgisonline.map.edit.createTypesAndTemplatesOnLayer(l)}}else for(var r=b.layers.length-1;0<=r;r--)l=b.layers[r],l.visible&&(p=l.toJson(),p.layerDefinition.types&&0!=p.layerDefinition.types.length||p.layerDefinition.templates&&0!=p.layerDefinition.templates.length||arcgisonline.map.edit.createTypesAndTemplatesOnLayer(l));else b.layer&&b.layer instanceof esri.layers.FeatureLayer&&
(!b.serviceInfo||b.serviceInfo&&b.serviceInfo.types&&b.serviceInfo.templates)&&(l=b.layer,l.templates.length||l.types.length||arcgisonline.map.edit.createTypesAndTemplatesOnLayer(l))},createTypesAndTemplatesOnLayer:function(b){var l=b.renderer;if("esri.renderer.SimpleRenderer"==l.declaredClass||"esri.renderer.ClassBreaksRenderer"==l.declaredClass||"esri.renderer.HeatmapRenderer"==l.declaredClass||"esri.renderer.UniqueValueRenderer"==l.declaredClass&&!l.attributeField){l=new esri.layers.FeatureTemplate;
l.description="";l.name=esri.i18nBundle.viewer.edit.newFeature;var p={};e.forEach(b.fields,function(g){g.editable&&(p[g.name]=g.defaultValue||null)});var r=new esri.Graphic({attributes:p});l.prototype=r;arcgisonline.map.edit.updateTypeIdField(b,"");arcgisonline.map.edit.updateTemplates(b,[l]);b.__hasTemporaryTypes=!0}else if("esri.renderer.UniqueValueRenderer"==l.declaredClass){var a=l.attributeField,c=["esriFieldTypeDouble","esriFieldTypeSingle"],d=["esriFieldTypeOID","esriFieldTypeInteger","esriFieldTypeSmallInteger"],
h=!1,f=!1;e.forEach(b.fields,function(g){g.name===a&&(fieldType=g.type,-1<e.indexOf(c,fieldType)?f=!0:-1<e.indexOf(d,fieldType)&&(h=!0))});b.types=[];e.forEach(l.infos,function(g,n){var m=g.value;(h||f)&&"string"===typeof m&&(m&&m.length&&"\x3cNull\x3e"!==m&&"Null"!==m?(m=h?parseInt(m):parseFloat(m),isNaN(m)&&(m=null)):m=null);if(esri.isDefined(m)){var t=new esri.layers.FeatureType;t.id=m;t.name=g.label||g.value;var w=new esri.layers.FeatureTemplate;w.description="";w.name=g.label||g.value;var u=
{};u[a]=m;e.forEach(b.fields,function(v){v.name!==a&&v.editable&&(u[v.name]=v.defaultValue||null)});m=new esri.Graphic(null,null,u,null);w.prototype=m;t.templates=[w];b.addType(t)}});arcgisonline.map.edit.updateTypeIdField(b,a);b.__hasTemporaryTypes=!0}},removeTypesAndTemplatesForAllFeatCollLayers:function(){for(var b=arcgisonline.map.main.mapLayers.length-1;0<=b;b--){var l=arcgisonline.map.main.mapLayers[b];if(arcgisonline.map.featColl.isFeatureCollection(l)&&!arcgisonline.map.mapNotes.isMapNotesMapLayer(l))if(l.layer)arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(l.layer);
else if(l.layers)for(var p=l.layers.length-1;0<=p;p--)arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(l.layers[p])}},removeTypesAndTemplatesOnMapLayer:function(b,l){if(b.layer&&arcgisonline.map.featColl.isFeatureCollection(b)&&!arcgisonline.map.mapNotes.isMapNotesMapLayer(b))if(b.layer)l&&b.layer.__hasTemporaryTypes?(arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(b.layer),delete b.layer.__hasTemporaryTypes):l||arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(b.layer);else for(var p=
b.layers.length-1;0<=p;p--){var r=b.layers[p];l&&r.__hasTemporaryTypes?(arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(r),delete r.__hasTemporaryTypes):l||arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(r)}},removeTypesAndTemplatesOnLayer:function(b){b.types&&(b.types=[],b._typesDirty=!0,arcgisonline.map.edit.updateTypeIdField(b,""));b.templates&&arcgisonline.map.edit.updateTemplates(b,[])},updateTypesAndTemplatesOnLayer:function(b){var l=function(r,a){var c=[];e.forEach(a,function(d){var h=
new esri.layers.FeatureTemplate;h.description=d.description||"";h.name=d.name||esri.i18nBundle.viewer.edit.newFeature;var f={};e.forEach(r.fields,function(n){var m=!1;for(prototypeAttr in d.prototype.attributes)if(prototypeAttr===n.name){m=!0;f[n.name]=d.prototype.attributes[n.name];break}m||n.editable&&(f[n.name]=n.defaultValue||null)});var g=new esri.Graphic({attributes:f});h.prototype=g;c.push(h)});return c};if(b.templates&&b.templates.length)arcgisonline.map.edit.updateTemplates(b,l(b,b.templates)),
b.__hasTemporaryTypes=!0;else if(b.types){var p=b.types;b.types=[];e.forEach(p,function(r){r.templates=l(b,r.templates);b.addType(r)});b.__hasTemporaryTypes=!0}},checkTypesAndTemplatesOnLayer:function(b){if(b.templates&&b.templates.length&&b.types&&b.types.length){if("esri.renderer.SimpleRenderer"==b.renderer.declaredClass||"esri.renderer.ClassBreaksRenderer"==b.renderer.declaredClass||"esri.renderer.HeatmapRenderer"==b.renderer.declaredClass||"esri.renderer.UniqueValueRenderer"==b.renderer.declaredClass&&
!b.renderer.attributeField)b.types=[],b._typesDirty=!0,arcgisonline.map.edit.updateTypeIdField(b,"");"esri.renderer.UniqueValueRenderer"==b.renderer.declaredClass&&arcgisonline.map.edit.updateTemplates(b,[])}if(!(b.templates&&b.templates.length||"esri.renderer.SimpleRenderer"!=b.renderer.declaredClass&&"esri.renderer.ClassBreaksRenderer"!=b.renderer.declaredClass&&"esri.renderer.HeatmapRenderer"!=b.renderer.declaredClass&&("esri.renderer.UniqueValueRenderer"!=b.renderer.declaredClass||b.renderer.attributeField))||
!(b.types&&b.types.length||"esri.renderer.UniqueValueRenderer"!=b.renderer.declaredClass)&&b.renderer.attributeField)arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(b),arcgisonline.map.edit.createTypesAndTemplatesOnLayer(b);else if(b.types&&b.types.length&&"esri.renderer.UniqueValueRenderer"==b.renderer.declaredClass){var l=b.renderer;l.attributeField!==b.typeIdField?(arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(b),arcgisonline.map.edit.createTypesAndTemplatesOnLayer(b)):e.forEach(l.infos,
function(p){var r=!1;e.forEach(b.types,function(a){l.attributeField2?p.value.startsWith(a.id+",")?r=!0:null==a.id&&p.value.startsWith("\x3cNull\x3e,")&&(r=!0):a.id==p.value?r=!0:null==a.id&&"\x3cNull\x3e"==p.value&&(r=!0)});r||(arcgisonline.map.edit.removeTypesAndTemplatesOnLayer(b),arcgisonline.map.edit.createTypesAndTemplatesOnLayer(b))})}},updateTypeIdField:function(b,l){b.typeIdField=l;if(b._collection){var p=9>e.isIE?e.json.parse(b._json):JSON.parse(b._json);p.layerDefinition?p.layerDefinition.typeIdField=
l:p.typeIdField=l;b._json=9>e.isIE?e.json.stringify(p):JSON.stringify(p)}},updateTemplates:function(b,l){b.templates=l;if(b._collection){var p=9>e.isIE?e.json.parse(b._json):JSON.parse(b._json);p.layerDefinition?p.layerDefinition.templates=l:p.templates=l;b._json=9>e.isIE?e.json.stringify(p):JSON.stringify(p)}},hasDefaultTypesAndTemplates:function(b){var l=b.renderer;if("esri.renderer.SimpleRenderer"==l.declaredClass||"esri.renderer.ClassBreaksRenderer"==l.declaredClass||"esri.renderer.HeatmapRenderer"==
l.declaredClass||"esri.renderer.UniqueValueRenderer"==l.declaredClass&&!l.attributeField){if(b.templates&&1===b.templates.length){var p=b.templates[0];if(""!==p.description||p.name!==esri.i18nBundle.viewer.edit.newFeature)return!1}else return!1;if(!b.typeIdField&&p.prototype&&p.prototype.attributes){p=p.prototype.attributes;var r=0;for(r=0;r<b.fields.length;r++){var a=b.fields[r];if(a.editable&&p[a.name]!==a.defaultValue&&" "!==p[a.name]&&0!==p[a.name]&&p[a.name])return!1}}else return!1}else if("esri.renderer.UniqueValueRenderer"==
l.declaredClass&&l.infos)if(b.typeIdField===l.attributeField&&b.types&&b.types.length===l.infos.length){var c,d;for(r=0;r<l.infos.length;r++){var h=l.infos[r],f=!1;for(c=0;c<b.types.length;c++)if(p=b.types[c],p.id==h.value&&(p.name==h.label||p.name==h.value))if(f=!0,p.templates&&1===p.templates.length){p=p.templates[0];if(""!=p.description||p.name!=h.label&&p.name!=h.value)return!1;p=p.prototype.attributes;for(d=0;d<b.fields.length;d++)if(a=b.fields[d],a.editable&&(a.name===l.attributeField&&p[l.attributeField]!=
h.value||a.name!==l.attributeField&&p[a.name]!==a.defaultValue&&" "!==p[a.name]&&0!==p[a.name]&&p[a.name]))return!1}else return!1;if(!f)return!1}}else return!1;else return!1;return!0},toc_enableEditing:function(b){if(b.layer){if(b.layer.url)b.serviceInfo&&b.serviceInfo.capabilities&&b.serviceInfo._origCapabilities&&(b.serviceInfo.capabilities=b.serviceInfo._origCapabilities,delete b.serviceInfo._origCapabilities,arcgisonline.map.main.reloadFeatureLayer(b));else{b.layer.setEditable(!0);var l=arcgisonline.sharing.util.getUser();
l&&b.itemCard&&b.itemCard.owner===l.username&&(b.editableChanged=!0)}b.itemCard&&-1<e.indexOf(b.itemCard.typeKeywords,"Location Tracking")&&-1<e.indexOf(b.itemCard.typeKeywords,"Collector")&&(b.isTrackingInfoLayer=!0);b.layer.getFeatureReduction&&b.layer.getFeatureReduction()&&(b.layer.setFeatureReduction(null),b.featureReductionChanged=!0)}else e.forEach(b.layers,function(p){p.setEditable(!0)}),b.editableChanged=!0;arcgisonline.map.edit.createTypesAndTemplatesOnMapLayer(b);arcgisonline.map.edit.checkOnEditButton();
arcgisonline.map.main.markMapAsChanged("enableEditing")},toc_disableEditing:function(b){if(b.layer)if(b.layer.url)b.serviceInfo&&b.serviceInfo.capabilities&&(b.serviceInfo._origCapabilities=b.serviceInfo.capabilities,b.serviceInfo.capabilities=arcgisonline.map.edit.removeEditCapabilities(b.serviceInfo.capabilities),arcgisonline.map.main.reloadFeatureLayer(b));else{b.layer.setEditable(!1);var l=arcgisonline.sharing.util.getUser();l&&b.itemCard&&b.itemCard.owner===l.username&&(b.editableChanged=!0)}else e.forEach(b.layers,
function(p){p.setEditable(!1)}),b.editableChanged=!0;arcgisonline.map.edit.removeTypesAndTemplatesOnMapLayer(b);arcgisonline.map.edit.checkOnEditButton();arcgisonline.map.main.markMapAsChanged("disableEditing")},removeEditCapabilities:function(b){b=b.split(",");b=e.filter(b,function(l){var p=l.toLowerCase();if("create"!==p&&"update"!==p&&"delete"!==p&&"editing"!==p&&"uploads"!==p)return l});return b.toString()}}})},"arcgisonline/pages/utils/data":function(){define("require exports tslib dojo/i18n!../../nls/arcgisonline dojo/_base/lang esri/graphic esri/layers/FeatureTemplate".split(" "),
function(e,U,q,b,l,p,r){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);return function(){function a(){}a.getPopupInfo=function(c){var d;return null!==(d=null===c||void 0===c?void 0:c.popupInfo)&&void 0!==d?d:this._getPopupInfo(c)};a._getPopupInfo=function(c){var d,h,f,g,n=null!==(h=null!==(d=null===c||void 0===c?void 0:c.id)&&void 0!==d?d:null===c||void 0===c?void 0:c.layerId)&&void 0!==h?h:0;d=null===(f=null===c||void 0===c?void 0:c.layerInfos)||void 0===
f?void 0:f[n];return null!==(g=null===d||void 0===d?void 0:d.popupInfo)&&void 0!==g?g:this._getDefaultPopupInfo(c)};a._getDefaultPopupInfo=function(c){var d=c.fields,h=this.getDisplayField(c);h=c.name+((null===h||void 0===h?0:h.length)?": {"+h+"}":"");var f={esriFieldTypeDouble:1,esriFieldTypeSingle:1},g={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1},n={esriFieldTypeDate:1},m=",";c.editFieldsInfo&&(c.editFieldsInfo.creatorField&&(m+=c.editFieldsInfo.creatorField+","),c.editFieldsInfo.creationDateField&&
(m+=c.editFieldsInfo.creationDateField+","),c.editFieldsInfo.editorField&&(m+=c.editFieldsInfo.editorField+","),c.editFieldsInfo.editDateField&&(m+=c.editFieldsInfo.editDateField+","),m=m.toLowerCase());d=(d||[]).map(function(t){var w="esriFieldTypeOID"!==t.type&&"esriFieldTypeGlobalID"!==t.type&&"esriFieldTypeGeometry"!==t.type;w&&c.objectIdField&&(w=t.name!==c.objectIdField);var u=t.editable&&"esriFieldTypeOID"!==t.type&&"esriFieldTypeGlobalID"!==t.type,v;if(w){var x=m+"stretched value,fnode_,tnode_,lpoly_,rpoly_,poly_,subclass,subclass_,rings_ok,rings_nok,",
y=t.name.toLowerCase();if(-1<x.indexOf(","+y+",")||-1<y.indexOf("shape")||-1<y.indexOf("perimeter")||-1<y.indexOf("objectid")||-1<y.indexOf("raster.servicepixelvalue.")||-1<y.indexOf("_i")&&y.indexOf("_i")===y.length-2||t.name===c.objectIdField)w=!1;t.type in g?v={places:0,digitSeparator:!0}:t.type in f?v={places:2,digitSeparator:!0}:t.type in n&&(10<=c.currentVersion||c&&10<=c.version)&&(v={dateFormat:"shortDateShortTime"})}u=u?-1===m.indexOf(","+t.name.toLowerCase()+","):u;t=l["default"].mixin({},
{fieldName:t.name,label:t.alias,isEditable:u,tooltip:"",visible:w,stringFieldOption:"textbox"});v&&(t.format=v);return t});return{title:h,fieldInfos:d,description:null,showAttachments:!0,mediaInfos:[]}};a.getDisplayField=function(c){var d,h,f=c.fields;c=null!==(h=null===(d=c.displayField)||void 0===d?void 0:d.trim())&&void 0!==h?h:null;if(!c&&f&&(c=this.getFirstNameOrTitleField(f),!c&&(c=this.getFirstUniqueIdentifierField(f),!c&&(c=this.getFirstTypeOrCategoryField(f),!c))))for(d=0;d<f.length;d++)if(h=
f[d],-1<h.name.toLowerCase().indexOf("name")||-1<h.name.toLowerCase().indexOf("title"))c=h.name;return c};a.getFirstNameOrTitleField=function(c){for(var d=0;d<c.length;d++){var h=c[d];if(h.description){var f=h.description;if("nameOrTitle"===(null===f||void 0===f?void 0:f.fieldValueType))return h.name}}return null};a.getFirstUniqueIdentifierField=function(c){for(var d=0;d<c.length;d++){var h=c[d];if(h.description){var f=h.description;if("uniqueIdentifier"===(null===f||void 0===f?void 0:f.fieldValueType))return h.name}}return null};
a.getFirstTypeOrCategoryField=function(c){for(var d=0;d<c.length;d++){var h=c[d];if(h.description){var f=h.description;if("typeOrCategory"===(null===f||void 0===f?void 0:f.fieldValueType))return h.name}}return null};a.updateTypesAndTemplatesOnLayer=function(c){var d=this,h;if(null===(h=c.templates)||void 0===h?0:h.length){h=this._getUpdatedTemplatesForLayer(c,c.templates);c.templates=h;if(c._collection){var f=JSON.parse(c._json);f.layerDefinition?f.layerDefinition.templates=h:f.templates=h;c._json=
JSON.stringify(f)}c.__hasTemporaryTypes=!0}else c.types&&(h=c.types,c.types=[],h.forEach(function(g){g.templates=d._getUpdatedTemplatesForLayer(c,g.templates);c.addType(g)}),c.__hasTemporaryTypes=!0)};a._getUpdatedTemplatesForLayer=function(c,d){var h=[];(null!==d&&void 0!==d?d:[]).forEach(function(f){var g,n,m=new r["default"];m.description=null!==(g=f.description)&&void 0!==g?g:"";m.name=f.name||b["default"].viewer.edit.newFeature;var t={};(null!==(n=c.fields)&&void 0!==n?n:[]).forEach(function(w){var u=
!1,v;for(v in f.prototype.attributes)if(v===w.name){u=!0;t[w.name]=f.prototype.attributes[w.name];break}!u&&w.editable&&(t[w.name]=w.defaultValue||null,t[w.name]||!1!==w.nullable||(t[w.name]="esriFieldTypeString"===w.type?" ":0))});g=new p["default"]({attributes:t});m.prototype=g;h.push(m)});return h};return a}()})},"arcgisonline/pages/item/widgets/AttributesView/_attributesView":function(){define("require exports tslib ../../../_filterStateMixin ../../../pageUtil ../../../dijit/FilterSingle ../../../dijit/FilterStatus ../../../dijit/ControlBar ../../../dijit/View ../../../dijit/AttributeFieldDetails ./_attributeCard ../../../utils/arrays ../../../utils/dom ../../../utils/clone ../../../utils/icons calcite-web/js/calcite-web dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/event dojo/query dojo/topic dojo/Deferred esri/Evented dojo/i18n!../../../../nls/arcgisonline dojo/text!./templates/_attributesViewActions.html dojo/text!./templates/_attributesView.html dojo/text!./templates/tableHead.html dojo/text!./templates/tableRow.html dojo/text!./templates/empty.html dojo/text!./templates/none.html ../../../../tsutils/declareDecorator xstyle/css!./css/attributesView.css".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D,K,G){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);y=q.__importDefault(y);C=q.__importDefault(C);
z=q.__importDefault(z);F=q.__importDefault(F);O=q.__importDefault(O);V=q.__importDefault(V);N=q.__importDefault(N);J=q.__importDefault(J);D=q.__importDefault(D);K=q.__importDefault(K);G=q.__importDefault(G);return function(){function I(R,A){this.templateString=V["default"];this.widgetsInTemplate=!0;this.icons=m["default"];this.i18n=F["default"];this._selection=[];this._searchTerm="";this._filterState={fieldType:null};this._filters={fieldType:{param:"fieldType",chipText:F["default"].attributesView.fieldTypeFilterChipset,
options:{Number:{value:"Number",label:F["default"].attributesView.numberFilter},String:{value:"String",label:F["default"].attributesView.stringFilter},Date:{value:"Date",label:F["default"].attributesView.datesFilter},Id:{value:"Id",label:F["default"].attributesView.OidFilter},Attachment:{value:"Attachment",label:F["default"].attributesView.attachmentFilter},Relationship:{value:"Relationship",label:F["default"].attributesView.relationshipFilter}}},fieldValueType:{param:"fieldValueType",chipText:F["default"].attributesView.fieldValueTypeFilterChipset,
options:{nameOrTitle:{value:"nameOrTitle",label:F["default"].attributeFieldDetails.fieldValueTypesList.nameOrTitle},description:{value:"description",label:F["default"].attributeFieldDetails.fieldValueTypesList.description},typeOrCategory:{value:"typeOrCategory",label:F["default"].attributeFieldDetails.fieldValueTypesList.typeOrCategory},countOrAmount:{value:"countOrAmount",label:F["default"].attributeFieldDetails.fieldValueTypesList.countOrAmount},percentageOrRatio:{value:"percentageOrRatio",label:F["default"].attributeFieldDetails.fieldValueTypesList.percentageOrRatio},
measurement:{value:"measurement",label:F["default"].attributeFieldDetails.fieldValueTypesList.measurement},uniqueIdentifier:{value:"uniqueIdentifier",label:F["default"].attributeFieldDetails.fieldValueTypesList.uniqueIdentifier},phoneNumber:{value:"phoneNumber",label:F["default"].attributeFieldDetails.fieldValueTypesList.phoneNumber},emailAddress:{value:"emailAddress",label:F["default"].attributeFieldDetails.fieldValueTypesList.emailAddress},orderedOrRanked:{value:"orderedOrRanked",label:F["default"].attributeFieldDetails.fieldValueTypesList.orderedOrRanked},
binary:{value:"binary",label:F["default"].attributeFieldDetails.fieldValueTypesList.binary},locationOrPlaceName:{value:"locationOrPlaceName",label:F["default"].attributeFieldDetails.fieldValueTypesList.locationOrPlaceName},coordinate:{value:"coordinate",label:F["default"].attributeFieldDetails.fieldValueTypesList.coordinate},currency:{value:"currency",label:F["default"].attributeFieldDetails.fieldValueTypesList.currency},dateAndTime:{value:"dateAndTime",label:F["default"].attributeFieldDetails.fieldValueTypesList.dateAndTime}}}};
this._sort={property:"defaultFSOrder",label:F["default"].attributesView.defaultFSOrder,ascending:!1};this._sortOptions=[{property:"defaultFSOrder",label:F["default"].attributesView.defaultFSOrder,ascending:!1,active:!0},{property:"fieldAlias",label:F["default"].attributesView.fieldAlias,ascending:!0},{property:"fieldName",label:F["default"].attributesView.fieldName,ascending:!0},{property:"fieldType",label:F["default"].attributesView.fieldType,ascending:!0}];this._filtersExpanded=!0;this.delay=function(){var B;
return function(H,T){clearTimeout(B);B=setTimeout(H,T)}}()}I.prototype.startup=function(R,A,B,H){this.inherited(arguments);this.item=R;this.layer=A;this.layerInfos=B;this.canAddField=H;this.attributesList=null;this.setAttributesList();this.reset();this.initUI();this.isAdminView()||this.domNode.classList.add("is-consumer-view");this.isHostedServiceView()&&this.domNode.classList.add("is-hosted-service-view");this.setupAttributeViewEvents()};I.prototype.destroy=function(R){this.inherited(arguments);
this.reset()};I.prototype.initUI=function(R){this._sortOptions.dontUpdateQueryParams=!0;this._initialView=this.getInitialView();R=new C["default"];var A={select:!0,sortOptions:this._sortOptions,emptyView:D["default"],noneView:K["default"],tableHead:N["default"],tableRow:J["default"],mobileView:h["default"],listView:h["default"],activeView:this._initialView},B={search:{placeholder:this.i18n.attributesView.searchPlaceholder},sort:this._sortOptions,filterContainer:this.domNode.querySelector(".js-filter-wrap"),
viewContainer:this.domNode.querySelector(".js-view-wrap")};this.layer.supportsFieldDescription&&(B.views={activeView:this._initialView,views:["table","list"]});this.isAdminView()&&this.canAddField&&(B.actions=O["default"]);this._fieldTypeFilter=new p["default"](this._filters.fieldType,this.domNode.querySelector(".js-filter-field-type"));this._fieldValueTypeFilter=new p["default"](this._filters.fieldValueType,this.domNode.querySelector(".js-filter-field-value-type"));this._filterStatus=new r["default"]({dontUpdateQueryParams:!0},
this.domNode.querySelector(".js-filter-status"));this._controlBar=new a["default"](B,this.domNode.querySelector(".js-control-bar"));this._view=new c["default"](A,this.domNode.querySelector(".js-views"));this._totalFields.textContent=l["default"].getPageRangeString({start:1,end:this.attributesList.length,total:this.attributesList.length});y["default"].publish("view/update",this.attributesList,this._selection,this.hasFilters());y["default"].publish("sort/update",n["default"](this._sort));this.addEventListeners();
t["default"].init();R.resolve();return R.promise};I.prototype.setAttributesList=function(R){for(var A=this,B,H,T,M=n["default"](this.layer.fields),L=0;L<M.length;L++)M[L].alias||(M[L].alias=M[L].name),M[L].description?(M[L].description.value=(null===(B=M[L].description)||void 0===B?0:B.value)?M[L].description.value:"",M[L].description.fieldValueType=(null===(H=M[L].description)||void 0===H?0:H.fieldValueType)?M[L].description.fieldValueType:""):M[L].description={value:"",fieldValueType:""},M[L].id=
this.layer.fields[L].name,M[L].isViewOverride=this.layer.fields[L].isViewOverride,M[L].disabled="",M[L].fieldType=this.getFieldType(this.layer.fields[L].type),M[L].nullable=this.layer.fields[L].nullable?this.i18n.attributesView.commonYes:this.i18n.attributesView.commonNo,M[L].editable=this.layer.fields[L].editable?this.i18n.attributesView.commonYes:this.i18n.attributesView.commonNo;R||(this.layer.hasAttachments&&M.push({id:this.layer.name+"__Attach",alias:this.i18n.attributesView.photosAndFiles,name:this.i18n.attributesView.photosAndFiles,
fieldType:this.i18n.attributesView.attachmentType,type:"Attachment",description:{value:"",fieldValueType:""},disabled:"disabled",canDeleteField:!1}),0<(null===(T=this.layer.relationships)||void 0===T?void 0:T.length)&&this.layer.relationships.forEach(function(X){M.push({id:X.name+"__Relationship",alias:X.name,name:X.name,fieldType:A.i18n.attributesView.relationshipType,type:"Relationship",description:{value:"",fieldValueType:""},disabled:"disabled",canDeleteField:!1})}));this.attributesList=M};I.prototype.getFieldType=
function(R){R=R||this.i18n.attributesView.commonUndefined;return this.i18n.attributesView.fieldTypes[R]||R};I.prototype.render=function(){var R=this.getFilteredList();this._totalFields.textContent=l["default"].getPageRangeString({start:R.length?1:0,end:R.length,total:R.length});y["default"].publish("view/update",R,this._selection,this.hasFilters())};I.prototype.getFilteredList=function(){var R=this;this.setAttributesList();var A=this.attributesList;if(this._filterState.fieldType||this._filterState.fieldValueType||
this._searchTerm)A=this.attributesList.filter(function(B){if(-1!==B.alias.toLowerCase().indexOf(R._searchTerm.toLowerCase())||-1!==B.name.toLowerCase().indexOf(R._searchTerm.toLowerCase()))return R._filterState.fieldType&&R._filterState.fieldValueType?R.filterResults(B,R._filterState)&&R.filterFieldValueTypeResults(B,R._filterState):R._filterState.fieldType?R.filterResults(B,R._filterState):R._filterState.fieldValueType?R.filterFieldValueTypeResults(B,R._filterState):!0});"fieldAlias"===this._sort.property?
A=this.sortFieldAlias(A,this._sort.ascending):"fieldName"===this._sort.property?A=this.sortFieldName(A,this._sort.ascending):"fieldType"===this._sort.property?A=this.sortFieldType(A,this._sort.ascending):"editable"===this._sort.property&&(A=this.sortEditable(A,this._sort.ascending));return A};I.prototype.filterResults=function(R,A){return"Id"!==A.fieldType||"esriFieldTypeOID"!==R.type&&"esriFieldTypeGlobalID"!==R.type?"Number"!==A.fieldType||"esriFieldTypeSmallInteger"!==R.type&&"esriFieldTypeInteger"!==
R.type&&"esriFieldTypeSingle"!==R.type&&"esriFieldTypeDouble"!==R.type?"String"===A.fieldType&&"esriFieldTypeString"===R.type?!0:"Date"===A.fieldType&&"esriFieldTypeDate"===R.type?!0:"Attachment"===A.fieldType&&"Attachment"===R.type?!0:"Relationship"===A.fieldType&&"Relationship"===R.type?!0:!1:!0:!0};I.prototype.filterFieldValueTypeResults=function(R,A){return A.fieldValueType===R.description.fieldValueType};I.prototype.reset=function(){this._filterState.fieldType=null;this._selection=[];this._searchTerm=
"";this._sort={property:"defaultFSOrder",label:F["default"].attributesView.defaultFSOrder,ascending:!1}};I.prototype.getInitialView=function(){return this.layer.supportsFieldDescription?this.item.isAdmin&&this.item.isOwner?"table":"list":"table"};I.prototype.isAdminView=function(){var R,A=!1!==(null===(R=this.item.serviceInfo)||void 0===R?void 0:R.sourceSchemaChangesAllowed);return this.item.isHostedService&&!this.item.isLocationTrackingService&&(this.item.isAdmin||this.item.isOwner)&&A};I.prototype.isHostedServiceView=
function(){return this.item.isHostedService&&f["default"].includes(this.item.typeKeywords,"View Service")};I.prototype.sortFieldAlias=function(R,A){return R.sort(function(B,H){return A?B.alias.localeCompare(H.alias):H.alias.localeCompare(B.alias)})};I.prototype.sortFieldName=function(R,A){return R.sort(function(B,H){return A?B.name.localeCompare(H.name):H.name.localeCompare(B.name)})};I.prototype.sortFieldType=function(R,A){return R.sort(function(B,H){return A?B.fieldType.localeCompare(H.fieldType)||
B.name.localeCompare(H.name):H.fieldType.localeCompare(B.fieldType)||H.name.localeCompare(B.name)})};I.prototype.sortNullable=function(R,A){return R.sort(function(B,H){return A?B.nullable.localeCompare(H.nullable):H.nullable.localeCompare(B.nullable)})};I.prototype.sortEditable=function(R,A){return R.sort(function(B,H){return A?B.editable.localeCompare(H.editable):H.editable.localeCompare(B.editable)})};I.prototype.updateSelectedView=function(){var R;0<this._selection.length?(x["default"](".hide-if-selected").addClass("hide"),
x["default"](".show-if-selected").removeClass("hide"),null===(R=this.filterSelectedViewActions)||void 0===R?void 0:R.call(this,this._selection)):(x["default"](".hide-if-selected").removeClass("hide"),x["default"](".show-if-selected").addClass("hide"));this.selectedCount.innerHTML=""+this._selection.length};I.prototype.filterSelectedViewActions=function(R){var A=[],B=[];R=f["default"].find(R,function(H){return!H.canDeleteField});this.isAdminView()&&!R?B.push(this._deleteFields):A.push(this._deleteFields);
g["default"].hideNodes(A);g["default"].showNodes(B)};I.prototype.hasFilters=function(){var R=this,A=0<Object.keys(this._filterState).filter(function(B){return R._filterState[B]}).length;return""!==this._searchTerm||A};I.prototype.addEventListeners=function(){var R=this;this.own(x["default"](".js-deselect",this.domNode).on("click",this.deselectAll.bind(this)),y["default"].subscribe("view/update",this.setupAttributeViewEvents.bind(this)),y["default"].subscribe("filter/update",this.filterUpdate.bind(this)),
y["default"].subscribe("filter/clear",this.filterClear.bind(this)),y["default"].subscribe("filter/remove",this.filterRemove.bind(this)),y["default"].subscribe("sort/update",this.sortUpdate.bind(this)),y["default"].subscribe("view/select",this.viewSelect.bind(this)),y["default"].subscribe("view/deselect",this.viewDeselect.bind(this)),y["default"].subscribe("search/update",this.searchUpdate.bind(this)),y["default"].subscribe("view/toggle",this.toggleUpdateIfNeeded.bind(this)),y["default"].subscribe("attributeCard/fieldName",
this.setupAttributeFieldDetails.bind(this)),x["default"](".js-delete-multiple-fields",this.domNode).on("click",function(A){v["default"].stop(A);2>R._view._selected.length&&R._view._selected[0].canDeleteField?y["default"].publish("attributesView/deleteSingleField",R._view._selected[0]):y["default"].publish("attributesView/deleteMultipleFields",R._view._selected)}),y["default"].subscribe("attributeFieldDetails/updateFieldOnlyTable",this.setTableRowsFieldNameOnly.bind(this)))};I.prototype.setupAttributeViewEvents=
function(){var R=this;this._attributeViewEvents=[];this._attributeFieldsEvents=[x["default"](".js-field-name",this.domNode).on("click",function(A){v["default"].stop(A);R.clickedFieldName=A.target.getAttribute("fieldName");R.setupAttributeFieldDetails()})]};I.prototype.setupAttributeFieldDetails=function(R){R&&(this.clickedFieldName=R);this.setTableRowsFieldNameOnly();this.hideDetailsPage(!1);this.attributeFieldDetails&&(this.attributeFieldDetails.destroy(!0),this.attributeFieldDetails=null);R=new d["default"](null,
this.domNode.querySelector(".js-attributes-details"));R.startup(this.item,this.layer,this.clickedFieldName,this.layerInfos);this.attributeFieldDetails=R;this.setUpAttributeFieldDetailsEvents()};I.prototype.setUpAttributeFieldDetailsEvents=function(){this.attributeFieldDetails.own(y["default"].subscribe("attributeFieldDetails/closeDetails",this.closeFieldDetails.bind(this)))};I.prototype.closeFieldDetails=function(R){this.hideDetailsPage(!0);this.searchFieldResult="";this.domNode.querySelector(".js-field-only-search").value=
"";R&&(this.setAttributesList(),this.render())};I.prototype.setTableRowsFieldNameOnly=function(){for(var R=this,A=this.domNode.querySelector(".js-attributes-details-body");0<A.rows.length;)A.deleteRow(0);this.setAttributesList(!0);var B="fieldAlias"===this._sort.property?this.sortFieldAlias(this.attributesList,this._sort.ascending):"fieldName"===this._sort.property?this.sortFieldName(this.attributesList,this._sort.ascending):"fieldType"===this._sort.property?this.sortFieldType(this.attributesList,
this._sort.ascending):this.attributesList;this.searchFieldResult&&(B=B.filter(function(H){return-1!==H.alias.toLowerCase().indexOf(R.searchFieldResult.toLowerCase())}));0<(null===B||void 0===B?void 0:B.length)&&B.reduce(function(H,T){var M=A.insertRow(A.rows.length);M.insertCell(0).innerHTML='\x3cbutton class\x3d"btn btn-transparent btn-small js-field-details-name btn-field-details-name table-select-cell-wrap" fieldName\x3d"'+T.name+'"\x3e'+T.alias+"\x3c/button\x3e";T.name===R.clickedFieldName&&(M.style.backgroundColor=
"#d2e9f9")},"");this._attributeTableOnlyEvents=[];this._attributeTableOnlyEvents=[x["default"](".js-field-details-name",this.domNode).on("click",function(H){v["default"].stop(H);R.clickedFieldName=H.target.getAttribute("fieldName");R.setupAttributeFieldDetails()}),x["default"](".js-field-only-search",this.domNode).on("keyup, search",function(H){v["default"].stop(H);R.searchFieldResult=H.target.getAttribute("value");R.delay(function(){R.setTableRowsFieldNameOnly()},500)})]};I.prototype.collapseDetails=
function(){var R=this;this._detailsFiltersExpanded?(this._collapseDetailsBtn.setAttribute("aria-checked","true"),this._collapseDetailsBtn.tabIndex=0,x["default"](".js-attribute-field-only").removeClass("collapsed"),x["default"](".js-attribute-field-details").removeClass("expanded"),this._detailsFiltersExpanded=!1):(this._collapseDetailsBtn.setAttribute("aria-checked","false"),this._collapseDetailsBtn.tabIndex=-1,x["default"](".js-attribute-field-only").addClass("collapsed"),x["default"](".js-attribute-field-details").addClass("expanded"),
this._detailsFiltersExpanded=!0);setTimeout(function(){R._collapseDetailsBtn.blur()},100)};I.prototype.disableScrollOnBody=function(){document.querySelector("body").classList.add("field--no-scroll-on-body")};I.prototype.enableScrollOnBody=function(){document.querySelector("body").classList.remove("field--no-scroll-on-body")};I.prototype.refreshContent=function(){this._selection=[];this.updateSelectedView();this.render()};I.prototype.filterUpdate=function(R){"fieldType"===R.param?this._filterState.fieldType=
R.selected[0].value:"fieldValueType"===R.param?this._filterState.fieldValueType=R.selected[0].value:this._filterState[R.param]=R.selected;this.render()};I.prototype.filterClear=function(){this._filterState.fieldType=null;this._filterState.fieldValueType=null;this.render()};I.prototype.filterRemove=function(R){"fieldType"===R.param&&(this._filterState.fieldType=null);"fieldValueType"===R.param&&(this._filterState.fieldValueType=null);this.render()};I.prototype.viewSelect=function(R){f["default"].find(this._selection,
function(A){return A.name===R.name})||(R.isSelected=!0,this._selection.push(R));this.updateSelectedView()};I.prototype.viewDeselect=function(R){R.isSelected=!1;this._selection=this._selection.filter(function(A){return A.name!==R.name});this.updateSelectedView()};I.prototype.deselectAll=function(){this._selection=[];y["default"].publish("view/deselectAll");this.updateSelectedView()};I.prototype.searchWait=function(R){y["default"].publish("view/loading",R)};I.prototype.searchUpdate=function(R){this._searchTerm=
R;this.render()};I.prototype.sortUpdate=function(R){this._sort.property=R.property;this._sort.ascending=R.ascending;this.render()};I.prototype.toggleUpdateIfNeeded=function(R){this.hideDetailsPage(!0);this.setAttributesList();this.render()};I.prototype.hideDetailsPage=function(R){R?(x["default"](".js-attributes-details-info").addClass("hide"),x["default"](".js-field-main-body").removeClass("hide"),x["default"](".js-field-search-bar").removeClass("hide")):(x["default"](".js-attributes-details-info").removeClass("hide"),
x["default"](".js-field-main-body").addClass("hide"),x["default"](".js-field-search-bar").addClass("hide"))};return I=q.__decorate([G["default"](w["default"],u["default"],z["default"],b["default"])],I)}()})},"arcgisonline/pages/_filterStateMixin":function(){define("require exports tslib ./pageUtil ./utils/arrays ./utils/clone".split(" "),function(e,U,q,b,l,p){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);return function(){function r(){this._initialLoading=!0;this._initialStart=
1;this._initialNum=20;this._initialMembershipRequestToggle=!1}r.prototype._applyQueryParameters=function(){var a=b["default"].getQueryParams();this._applySortParameters(a);this._applyViewParameter(a);this._applyPaginationParameter(a);this._applyTypeParameter(a);this._applyMembershipRequestParameter(a);this._applyDateParameter(a);this._applyDateUploadedParameter(a);this._applyDateCreatedParameter(a);this._applyFolderParameter(a);this._applySharingParameter(a);this._applyStatusParameter(a);this._applyRoleParameter(a);
this._applyUserTypeParameter(a);this._applyOwnerParameter(a);this._applySpecialGroupsParameter(a);this._applyCategoriesParameter(a);this._applyLevelParameter(a);this._applyLastLoginParameter(a);this._applySearchInputParameter(a);this._applySearchByParameter(a);this._applyTagsParameter(a);this._applyBBoxParameter(a);this._applyCollaborationParameter(a);this._applyGroupsParameter(a);this._applyAppParameter(a);this._applyCreditsParameter(a)};r.prototype._applyFilters=function(){this._applyPagination();
this._applyItemTypeFilter();this._applySpecialGroupsFilter();this._applyDateFilter();this._applyDateUploadedFilter();this._applyDateCreatedFilter();this._applyFolderFilter();this._applyMembershipRequestFilter();this._applySharingFilter();this._applyStatusFilter();this._applyRoleFilter();this._applyUserTypeFilter();this._applyGroupFilter();this._applyAppFilter();this._applyCreditsFilter();this._applyLastLoginFilter();this._applyOwnerFilter();this._applyCategoryFilter();this._applyLevelFilter();this._applySearchInput();
this._applySearchByDropdown();this._applyTagsFilter();this._applyBBoxFilter();this._applyCollaborationFilter()};r.prototype._applySortParameters=function(a){if(a.sortField){var c=a.sortField;if(c&&this._sortOptions&&this._sortOptions.length){var d=l["default"].find(this._sortOptions,function(h){return h.property===c});d&&(this._sort=p["default"](d))}}a.sortOrder&&this._sort&&(this._sort.ascending="asc"===a.sortOrder)};r.prototype._applyViewParameter=function(a){a.view&&(this._initialView=a.view)};
r.prototype._applyPaginationParameter=function(a){if(a.num){var c=parseInt(a.num,10);-1<[20,60,100].indexOf(c)&&(this._initialNum=c,this._page&&this._page.num&&(this._page.num=this._initialNum))}a.start&&this._page&&(this._initialStart=parseInt(a.start,10)||1,0<this._initialStart%this._page.num&&(this._initialStart=Math.floor(this._initialStart/this._page.num)*this._page.num+1,this._page&&this._page.start&&(this._page.start=this._initialStart)))};r.prototype._applyTypeParameter=function(a){a.focus&&
(this._initialTypeFilter="layers-weblayers"===a.focus?"layers":a.focus)};r.prototype._applyDateParameter=function(a){a.modified&&(this._initialDateFilter=a.modified,this._initialDateFilterTo=a.modified_to?a.modified_to:void 0,this._initialDateFilterFrom=a.modified_from?a.modified_from:void 0)};r.prototype._applyDateCreatedParameter=function(a){a.created&&(this._initialDateCreatedFilter=a.created,this._initialDateCreatedFilterTo=a.created_to?a.created_to:void 0,this._initialDateCreatedFilterFrom=a.created_from?
a.created_from:void 0)};r.prototype._applyDateUploadedParameter=function(a){a.uploaded&&(this._initialDateUploadedFilter=a.uploaded,this._initialDateUploadedFilterTo=a.uploaded_to?a.uploaded_to:void 0,this._initialDateUploadedFilterFrom=a.uploaded_from?a.uploaded_from:void 0)};r.prototype._applyFolderParameter=function(a){a.folder&&(this._initialFolderFilter=a.folder)};r.prototype._applyMembershipRequestParameter=function(a){a._membershipRequestToggle&&(this._initialMembershipRequestToggle="true"===
a._membershipRequestToggle)};r.prototype._applySharingParameter=function(a){a.access&&(this._initialSharingFilter=a.access)};r.prototype._applyStatusParameter=function(a){a.contentstatus&&(this._initialStatusFilter=a.contentstatus)};r.prototype._applyRoleParameter=function(a){a.memberType?this._initialRoleFilter=a.memberType:a.role&&(this._initialRoleFilter=a.role)};r.prototype._applyUserTypeParameter=function(a){a.userLicenseType&&(this._initialUserTypeFilter=a.userLicenseType)};r.prototype._applyGroupsParameter=
function(a){a.group&&(this._initialGroupFilter=a.group)};r.prototype._applyAppParameter=function(a){a.app&&(this._initialAppFilter=a.app)};r.prototype._applyCreditsParameter=function(a){a.availablecredits&&(this._initialCreditsFilter=a.availablecredits)};r.prototype._applyOwnerParameter=function(a){a.owner&&(this._initialOwnerFilter=a.owner)};r.prototype._applySpecialGroupsParameter=function(a){a.specialGroups&&(this._initialSpecialGroupsFilter=a.specialGroups)};r.prototype._applyCategoriesParameter=
function(a){if(a.categories)try{this._initialCategoryFilter=JSON.parse(a.categories)}catch(c){}if(a.regions){this._initialCategoryFilter=this._initialCategoryFilter||[];try{this._initialCategoryFilter=this._initialCategoryFilter.concat(JSON.parse(a.regions))}catch(c){}}};r.prototype._applySearchByParameter=function(a){a.searchBy&&(this._initialSearchBy=a.searchBy)};r.prototype._applySearchInputParameter=function(a){a.searchTerm&&(this._initialSearchInput=a.searchTerm)};r.prototype._applyTagsParameter=
function(a){a.tags&&(this._initialTagsFilter=a.tags.split(","))};r.prototype._applyBBoxParameter=function(a){if(a.bbox){a.sortField="bbox";var c=a.bbox.split(",");4===c.length&&(this._initialBBoxFilter=[[c[0],c[1]],[c[2],c[3]]],this._initialBBoxLabel=a.bboxLabel)}};r.prototype._applyCollaborationParameter=function(a){a.origin&&(this._initialCollaborationFilter=a.origin)};r.prototype._applyLevelParameter=function(a){a.level&&(this._initialLevelFilter=a.level)};r.prototype._applyLastLoginParameter=
function(a){a.lastlogin&&(this._initialDateFilter=a.lastlogin,this._initialDateFilterTo=a.lastlogin_to?a.lastlogin_to:void 0,this._initialDateFilterFrom=a.lastlogin_from?a.lastlogin_from:void 0)};r.prototype._applyPagination=function(){this._pagination&&this._pagination.setInitialProperties({num:this._initialNum,start:this._initialStart});this._page&&(this._page.num=this._initialNum,this._page.start=this._initialStart)};r.prototype._applyItemTypeFilter=function(){this._initialTypeFilter&&this._typeFilter&&
this._typeFilter.select&&this._typeFilter.select(this._initialTypeFilter)};r.prototype._applyDateFilter=function(){this._initialDateFilter&&this._dateFilter&&this._dateFilter.select&&this._dateFilter.select(this._initialDateFilter,this._initialDateFilterFrom,this._initialDateFilterTo)};r.prototype._applyDateCreatedFilter=function(){this._initialDateCreatedFilter&&this._dateFilter&&this._dateFilter.select&&this._dateFilter.select(this._initialDateCreatedFilter,this._initialDateCreatedFilterFrom,this._initialDateCreatedFilterTo)};
r.prototype._applyFolderFilter=function(){this._initialFolderFilter&&this._folderList&&(this._folderList.setInitialFolder(this._initialFolderFilter),this._folderListMobile.setInitialFolder(this._initialFolderFilter))};r.prototype._applyMembershipRequestFilter=function(){var a;this._initialMembershipRequestToggle&&(null===(a=this._membershipRequestToggle)||void 0===a?0:a.isChecked)&&this._membershipRequestToggle.setChecked(this._initialMembershipRequestToggle)};r.prototype._applyDateUploadedFilter=
function(){this._initialDateUploadedFilter&&this._dateCreatedFilter&&this._dateCreatedFilter.select&&this._dateCreatedFilter.select(this._initialDateUploadedFilter,this._initialDateUploadedFilterFrom,this._initialDateUploadedFilterTo)};r.prototype._applySharingFilter=function(){this._initialSharingFilter&&this._sharingFilter&&this._sharingFilter.select&&this._sharingFilter.select(this._initialSharingFilter)};r.prototype._applyStatusFilter=function(){this._initialStatusFilter&&this._statusFilter&&
this._statusFilter.select&&this._statusFilter.select(this._initialStatusFilter)};r.prototype._applyRoleFilter=function(){this._initialRoleFilter&&this._roleFilter&&this._roleFilter.select&&this._roleFilter.select(this._initialRoleFilter)};r.prototype._applyUserTypeFilter=function(){this._initialUserTypeFilter&&this._userTypeFilter&&this._userTypeFilter.select&&this._userTypeFilter.select(this._initialUserTypeFilter)};r.prototype._applyGroupFilter=function(){this._initialGroupFilter&&this._groupFilter&&
this._groupFilter.select&&this._groupFilter.select(this._initialGroupFilter)};r.prototype._applyAppFilter=function(){this._initialAppFilter&&this._appFilter&&this._appFilter.select&&this._appFilter.select(this._initialAppFilter)};r.prototype._applyCreditsFilter=function(){this._initialCreditsFilter&&this._creditsFilter&&this._creditsFilter.select&&this._creditsFilter.select(this._initialCreditsFilter)};r.prototype._applyLastLoginFilter=function(){this._initialDateFilter&&this._lastLoginFilter&&this._lastLoginFilter.select&&
this._lastLoginFilter.select(this._initialDateFilter,this._initialDateFilterFrom,this._initialDateFilterTo)};r.prototype._applySpecialGroupsFilter=function(){var a;this._initialSpecialGroupsFilter&&(null===(a=this._specialGroupsFilter)||void 0===a?0:a.select)&&this._specialGroupsFilter.select(this._initialSpecialGroupsFilter)};r.prototype._applyOwnerFilter=function(){this._initialOwnerFilter&&this._ownerFilter&&this._ownerFilter.select&&this._ownerFilter.select(this._initialOwnerFilter)};r.prototype._applyCategoryFilter=
function(){this._initialCategoryFilter&&this._categoryFilter&&this._categoryFilter.select&&this._categoryFilter.select(this._initialCategoryFilter,this._initialLoading)};r.prototype._applyLevelFilter=function(){this._initialLevelFilter&&this._levelFilter&&this._levelFilter.select&&this._levelFilter.select(this._initialLevelFilter)};r.prototype._applySearchInput=function(){var a,c=this._searchInput||(null===(a=this._controlBar)||void 0===a?void 0:a._searchInput);this._initialSearchInput&&(null===c||
void 0===c?0:c.setValue)&&c.setValue(this._initialSearchInput)};r.prototype._applySearchByDropdown=function(){var a=this._searchByDropdown||this._controlBar&&this._controlBar._searchDropdown;this._initialSearchBy&&a&&a.setSelection&&a.setSelection(this._initialSearchBy)};r.prototype._applyTagsFilter=function(){this._initialTagsFilter&&this._tagsFilter&&this._tagsFilter.select&&this._tagsFilter.select(this._initialTagsFilter)};r.prototype._applyBBoxFilter=function(){this._initialBBoxFilter&&this._bBoxFilter&&
this._bBoxFilter.addExtentFilter&&this._bBoxFilter.addExtentFilter(this._initialBBoxFilter,this._initialBBoxLabel)};r.prototype._applyCollaborationFilter=function(){this._initialCollaborationFilter&&this._collaborationFilter&&this._collaborationFilter.select&&this._collaborationFilter.select(this._initialCollaborationFilter)};return r}()})},"arcgisonline/pages/dijit/FilterSingle":function(){define("require exports tslib ../utils/arrays ../../tsutils/declareDecorator dijit/_WidgetBase dojo/_base/event dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/query dojo/string dojo/topic esri/Evented dojo/i18n!../../nls/arcgisonline dojo/text!./FilterSingle/templates/FilterSingle.html dojo/text!./FilterSingle/templates/FilterOption.html dojo/text!./FilterSingle/templates/ClearAll.html".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);return function(){function v(x,y){this.summedAggregationProperties={}}v.prototype.postMixInProperties=function(){var x;
this.inherited(arguments);this._state=a["default"].clone(this.params);this.topicPrefix=null!==(x=this._state.topic||this._state.topicPrefix)&&void 0!==x?x:""};v.prototype.postCreate=function(){this._updateUI();this._attachEvents()};v.prototype.destroy=function(){this._clear();this.inherited(arguments)};v.prototype._attachEvents=function(){var x=h["default"](".js-filter-link",this.domNode),y=h["default"](".js-clear-filter[data-filter-param\x3d'"+this._state.param+"']");this.own(y.on("click",this._removeFilter.bind(this)),
x.on("click",this._clickHandler.bind(this)),g["default"].subscribe(this.topicPrefix+"filter/clear",this._clear.bind(this)),g["default"].subscribe(this.topicPrefix+"filter/remove",this._remove.bind(this)),g["default"].subscribe(this.topicPrefix+"aggregations/update",this._updateCounts.bind(this)))};v.prototype.select=function(x){this._state.options[x]&&(this._clear(),this._state.options[x].active=!0,h["default"](".js-filter-item[data-value\x3d'"+x+"']",this.domNode).addClass("is-active"),h["default"](".js-filter-item[data-value\x3d'"+
x+"']",this.domNode).attr("aria-current","true"),this._setSelected(),g["default"].publish(this.topicPrefix+"filter/update",this._state))};v.prototype.getState=function(){return this._state};v.prototype._clear=function(){b["default"].toArray(this._state.options).forEach(function(x){return x.active=!1});h["default"](".js-filter-item",this.domNode).removeClass("is-active");h["default"](".js-filter-item",this.domNode).removeAttr("aria-current");h["default"](".js-filter-link",this.domNode).attr("aria-selected",
!1);h["default"](".js-clear-filter[data-filter-param\x3d'"+this._state.param+"']").addClass("hide")};v.prototype._remove=function(x){var y;if(x.param===this._state.param){var C=this._state.options[x.value];C&&(C.active=!1);this._setSelected();x=h["default"](".js-filter-item[data-value\x3d'"+x.value+"']",this.domNode);x.removeClass("is-active");x.removeAttr("aria-current");null===(y=x[0])||void 0===y?void 0:y.querySelector(".js-filter-link").setAttribute("aria-selected","false")}};v.prototype._updateUI=
function(){var x,y=b["default"].toArray(this._state.options).reduce(this._renderList.bind(this),"");this.domNode.innerHTML=f["default"].substitute(t["default"],{list:y});if(y=h["default"](".accordion-title",h["default"](this.domNode).closest(".accordion-section").shift())[0]){var C=0<(null===(x=this._state.selected)||void 0===x?void 0:x.length)?"":"hide";d["default"].place(f["default"].substitute(u["default"],{i18n:m["default"],hide:C,param:this._state.param}),y)}};v.prototype._renderList=function(x,
y,C,z){y.label=y.label.replace(/"/g,"\x26quot;");C=y.active?"is-active":"";z=this.param;C=q.__assign(q.__assign({},a["default"].clone(y)),{param:z,selected:C});C=f["default"].substitute(w["default"],C);y.aggregationFields&&(this.summedAggregationProperties[y.value]=y.aggregationFields);return x+C};v.prototype._setSelected=function(){var x=[];b["default"].toArray(this._state.options).forEach(function(C){C.active&&x.push(C)});this._state.selected=0<x.length?x:!1;var y=h["default"](".js-clear-filter[data-filter-param\x3d'"+
this._state.param+"']");this._state.selected?y.removeClass("hide"):y.addClass("hide")};v.prototype._clickHandler=function(x){r["default"].stop(x);var y=x.target.parentNode,C=c["default"].contains(y,"is-active"),z=x.target.getAttribute("data-value");C?g["default"].publish(this.topicPrefix+"filter/remove",{param:this._state.param,value:x.target.getAttribute("data-value")}):(b["default"].toArray(this._state.options).forEach(function(F){return F.active=F.value===z}),h["default"](".js-filter-item",this.domNode).removeClass("is-active"),
h["default"](".js-filter-item",this.domNode).removeAttr("aria-current"),c["default"].add(y,"is-active"),y.setAttribute("aria-current",!0),x.target.setAttribute("aria-selected",!0),this._setSelected(),g["default"].publish(this.topicPrefix+"filter/update",this._state))};v.prototype._removeFilter=function(x){var y;x.stopPropagation();0<(null===(y=this._state.selected)||void 0===y?void 0:y.length)&&g["default"].publish(this.topicPrefix+"filter/remove",{param:this._state.param,value:this._state.selected[0].value})};
v.prototype._getCountForFieldValue=function(x,y){var C=b["default"].find(x,function(z){return z.value===y});return(null===C||void 0===C?void 0:C.count)||0};v.prototype._updateCounts=function(x){var y=this;x.fieldName===this.param&&(h["default"](".js-filter-link-count",this.domNode).innerHTML(""),x.fieldValues.forEach(function(C){var z=y.domNode.querySelector(".js-filter-link-count[data-value\x3d'"+C.value+"']");z&&(z.innerHTML="("+C.count+")")}),Object.keys(this.summedAggregationProperties).forEach(function(C){var z=
y.summedAggregationProperties[C].reduce(function(F,O){return F+y._getCountForFieldValue(x.fieldValues,O)},0);(C=y.domNode.querySelector(".js-filter-link-count[data-value\x3d'"+C+"']"))&&z&&(C.innerHTML="("+z+")")}))};return v=q.__decorate([l["default"](p["default"],n["default"])],v)}()})},"arcgisonline/pages/dijit/FilterStatus":function(){define("require exports tslib ../../tsutils/declareDecorator dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/on dojo/query dojo/topic dojo/string dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./FilterStatus/templates/FilterStatus.html dojo/text!./FilterStatus/templates/FilterChip.html dojo/i18n!../../nls/arcgisonline ../pageUtil ../utils/icons ../utils/arrays".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);return function(){function x(y,C){this.templateString=n["default"];this.i18n=t["default"];
this._state={}}x.prototype.postMixInProperties=function(){var y=this,C;this.inherited(arguments);this._state={};this._dontUpdateQueryParams=this.params.dontUpdateQueryParams;this._topic=null!==(C=this.params.topic)&&void 0!==C?C:"";v["default"].toArray(l["default"].clone(this.params)).forEach(function(z){var F;0<(null===(F=z.selected)||void 0===F?void 0:F.length)&&(y._state[z.param]=z)})};x.prototype.postCreate=function(){this.inherited(arguments);v["default"].toArray(this._state).forEach(l["default"].hitch(this,
this._update));this._addEventListeners()};x.prototype.destroy=function(){this.inherited(arguments);this._state={}};x.prototype._addEventListeners=function(){this.own(a["default"](this.clearAll,"click",l["default"].hitch(this,this._clearHandler)),a["default"](this.filterChips,"click",l["default"].hitch(this,this._clickHandler)),d["default"].subscribe(this._topic+"filter/remove",l["default"].hitch(this,this._remove)),d["default"].subscribe(this._topic+"filter/update",l["default"].hitch(this,this._update)),
d["default"].subscribe(this._topic+"filter/clear",l["default"].hitch(this,this._clear)))};x.prototype._clear=function(){this.filterChips.innerHTML="";p["default"].add(this.filterChipWrap,"hide");var y=[];v["default"].toArray(this._state).forEach(function(C){y.push(C.param)});this._state={};this._topic||w["default"].removeQueryParams(y);this._updateMoreChip()};x.prototype._clearHandler=function(y){d["default"].publish(this._topic+"filter/clear",y)};x.prototype._remove=function(y){var C=this;c["default"](".js-filter-chip[data-filter\x3d'"+
y.param+"']",this.filterChips).forEach(r["default"].destroy);if(y.partial){var z=this._state[y.param];z.selected=z.selected.filter(function(F){return F.value!==y.value}).filter(function(F,O,V){return V.indexOf(F)===O});1>z.selected.length?delete this._state[y.param]:z.selected.forEach(function(F){F=h["default"].substitute(m["default"],{filter:z,i18n:t["default"],selected:F,icons:u["default"]});r["default"].place(F,C.filterChips)})}else delete this._state[y.param];1>Object.keys(this._state).length&&
p["default"].add(this.filterChipWrap,"hide");this._dontUpdateQueryParams||this._removeQueryString(y);this._updateMoreChip()};x.prototype._updateMoreChip=function(){var y=this,C=-1;Object.keys(this._state).forEach(function(F){y._state[F].selected&&(C+=y._state[F].selected.length)});var z=this.filterChips.querySelector(".js-more-chip");z&&this.filterChips.removeChild(z);0<C&&(z=document.createElement("span"),z.className="filter-chip filter-chip__more js-more-chip",this.filterChips.appendChild(z),z.textContent=
"+ "+C)};x.prototype._update=function(y){var C=this;p["default"].remove(this.filterChipWrap,"hide");this._state[y.param]=y;c["default"](".js-filter-chip[data-filter\x3d'"+y.param+"']",this.filterChips).forEach(r["default"].destroy);y.selected&&(y.selected.forEach(function(z){var F=document.createElement("div");!z.label&&z.simpleLabel&&(z.label=z.simpleLabel);F.innerHTML=z.label;z.simpleLabel=F.textContent||F.innerText||"";z=h["default"].substitute(m["default"],{filter:y,i18n:t["default"],selected:z,
icons:u["default"]});r["default"].place(z,C.filterChips)}),0===y.selected.length&&(delete this._state[y.param],this._topic||w["default"].removeQueryParams([y.param])));this._updateMoreChip();1>Object.keys(this._state).length&&p["default"].add(this.filterChipWrap,"hide");this._dontUpdateQueryParams||this._topic||this._updateQueryString()};x.prototype._updateQueryString=function(){var y={};v["default"].toArray(this._state).forEach(function(C){y[C.param]=C.selected&&C.selected.map(function(z){"custom"===
z.value&&z.to&&z.from?(y[C.param+"_to"]=z.to.valueOf(),y[C.param+"_from"]=z.from.valueOf()):(delete y[C.param+"_to"],delete y[C.param+"_from"]);if(C.isCategory)return JSON.stringify([z.value]);"bbox"===C.param&&(y.bboxLabel=z.label,y.srSort="true");return z.value}).join(",")||""},this);"bbox"in y&&(y.sortField="bbox");this._topic||w["default"].updateQueryParams(y)};x.prototype._removeQueryString=function(y){var C=w["default"].getQueryParams(),z=[];y.isCategory||"categories"===y.param?C[y.param]=[]:
"bbox"===y.param?(C[y.param]=[],z.push("srSort","bboxLabel","sortField")):(C[y.param]&&(C[y.param]=C[y.param].split(",").filter(function(F){return F!==y.value}).join(",")),w["default"].updateQueryParams(C));C=C[y.param];1>(null===C||void 0===C?void 0:C.length)&&(z.push(y.param),"custom"===y.value&&(z.push(y.param+"_to"),z.push(y.param+"_from")));w["default"].removeQueryParams(z)};x.prototype._clickHandler=function(y){if(p["default"].contains(y.target,"js-filter-chip-remove")){y.preventDefault();var C=
y.target.getAttribute("data-filter"),z=y.target.getAttribute("data-value");d["default"].publish(this._topic+"filter/remove",{param:C,value:z,partial:1<this._state[C].selected.length,lastFilter:1===Object.keys(this._state).length,evt:y})}};return x=q.__decorate([b["default"](f["default"],g["default"])],x)}()})},"arcgisonline/pages/dijit/ControlBar":function(){define("require exports tslib calcite-web/js/calcite-web dojo/debounce dojo/dom-construct dojo/string dojo/topic dojo/on dojo/query dijit/_TemplatedMixin dijit/_WidgetBase ./SearchInput ../components/ViewToggle ../components/SortDropdown ../components/Refresh ../organization/widgets/SearchDropdown ../pageUtil ../utils/icons ../utils/productGlyphs dojo/text!./ControlBar/templates/ControlBar.html dojo/text!./ControlBar/templates/Filters.html dojo/i18n!../../nls/arcgisonline arcgisonline/tsutils/declareDecorator preact preact/compat".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);y=q.__importDefault(y);C=q.__importDefault(C);z=
q.__importDefault(z);F=q.__importDefault(F);return function(){function N(J,D){this.templateString=y["default"];this.i18n=z["default"];this.icons=v["default"];this.productGlyphs=x["default"];this.showOnResize=!0;this.mobileBreakPoint=860;this.screenWidth=1080;this.telemetryOptions=this.telemetry=void 0;this.collapsed=!1;this.hideMobileActions=!0;this.refresh=!1;this.refreshLabel="";this.dontUpdateQueryParams=!1}N.prototype.postMixInProperties=function(){this.inherited(arguments);this.showFilters=this.showFilters.bind(this);
this.hideFilters=this.hideFilters.bind(this);this.searchActionClass=this.actions?"control-bar__search--has-actions":"";this.filterActiveClass=this.collapsed?"":"is-active";this.hideFilterClass=this.noFilters?"hide":"";this.hideActionClass=this.hideMobileActions?"control-bar--hide-mobile-actions":"";this.positionAbsoluteClass=this.absolute?"control-bar--absolute":"";this.search.cssTheme="control-bar__search-input flex-1";this.queryParams=u["default"].getQueryParams();this.hideRightClass=this.filterContainer||
this.views||this.sort?"":"control-bar--hide-right";this.marginClass=this.noMargin?"control-bar--no-margin":""};N.prototype.postCreate=function(){var J=this,D,K,G,I,R;this.inherited(arguments);if(this.filterContainer){var A=p["default"].toDom(r["default"].substitute(C["default"],{i18n:z["default"],icons:v["default"]})),B=this.filterContainer.parentNode;B.insertBefore(A,this.filterContainer);B.querySelector(".js-filters-insert").appendChild(this.filterContainer);this.filtersWrap=B.querySelector(".js-filters-mobile-wrap");
this.filtersWrapParent=B;("false"===this.queryParams.showFilters||this.noFilters||this.collapsed)&&this.filtersWrap.classList.add("is-collapsed")}this.search&&(this.searchDropdown&&(this.search.searchBy=null!==(D=this.queryParams.searchBy)&&void 0!==D?D:"fullname"),this.search.topic=this.topic,this.telemetry&&(null===(K=this.telemetryOptions)||void 0===K?0:K.search)&&(this.search.telemetry=this.telemetry),this._searchInput=new g["default"](this.search,this.domNode.querySelector(".js-control-bar-search")));
this.views&&(this.views.topic=this.topic,this.telemetry&&(null===(G=this.telemetryOptions)||void 0===G?0:G.viewToggle)&&(this.views.telemetry=this.telemetry),this._viewToggle=O.render(O.h(n["default"],q.__assign({},this.views)),this.domNode.querySelector(".js-control-bar-view-dropdown")));this.refresh&&(D=this.domNode.querySelector(".js-control-bar-refresh"),D.classList.remove("hide"),O.render(O.h(t["default"],{topic:this.topic,label:this.refreshLabel}),D));this.sort&&(D={options:this.sort,topic:this.topic,
telemetry:this.telemetry&&(null===(I=this.telemetryOptions)||void 0===I?0:I.sortOrderToggle)?this.telemetry:null},this._sortDropdown=O.render(O.h(m["default"],q.__assign({},D)),this.domNode.querySelector(".js-control-bar-sort-dropdown")));this.searchDropdown&&(this._searchDropdown=new w["default"]({},this.domNode.querySelector(".js-control-bar-search-dropdown")));this.actions?this.domNode.querySelector(".js-control-bar-actions").innerHTML=r["default"].substitute(this.actions,{i18n:z["default"],icons:v["default"],
productGlyphs:x["default"]}):p["default"].destroy(this.domNode.querySelector(".js-control-bar-actions"));this.noFilters&&(null===(R=this.filterContainer)||void 0===R?void 0:R.parentNode.removeChild(this.filterContainer));if(this.sticky)var H=setInterval(function(){var T;0<(null===(T=J.domNode)||void 0===T?void 0:T.clientHeight)&&(clearInterval(H),J.initStickyInterface())},100);this.filtersWrap&&("false"===this.queryParams.showFilters?(this.hideFilters(),this.showOnResize=!1):this.resizeHandler(),
window.innerWidth<this.mobileBreakPoint&&this.insideOverlay&&document.querySelector(".js-overlay-control-bar-filters").appendChild(this.filtersWrap));this.domNode.querySelector(".js-toggle-filters").setAttribute("aria-expanded",this.collapsed?"false":"true");this.own(d["default"](".js-toggle-filters",this.domNode).on("click",function(){return J.toggleFilters()}),c["default"](window,"resize",l["default"](function(){return J.resizeHandler()},30)),d["default"](".js-collapse-filters-button",this.filtersWrap).on("click",
function(){return J.hideFilters()}),a["default"].subscribe(this.topic+"search/error",this.showSearchError.bind(this)),a["default"].subscribe(this.topic+"search/update",this.hideSearchError.bind(this)))};N.prototype.destroy=function(){this.domNode&&(this.sort&&V.unmountComponentAtNode(this.domNode.querySelector(".js-control-bar-sort-dropdown")),this.views&&V.unmountComponentAtNode(this.domNode.querySelector(".js-control-bar-view-dropdown")));this.inherited(arguments)};N.prototype.setSearchValue=function(J){a["default"].publish("search/setValue",
J,!0);this._searchInput.setValue(J,!0)};N.prototype.getSearchValue=function(){return this._searchInput.getValue()};N.prototype.toggleFilters=function(){var J,D;if(null===(J=this.telemetryOptions)||void 0===J?0:J.filterToggle)null===(D=this.telemetry)||void 0===D?void 0:D.logEvent({category:"Control Bar Filter Toggle",action:this.collapsed?"show":"hide",pageUrl:window.location.href});this.collapsed?this.showFilters():this.hideFilters();this.screenWidth>this.mobileBreakPoint&&(this.showOnResize=!this.collapsed)};
N.prototype.showFilters=function(){var J=window.document.documentElement;this.collapsed=!1;this.dontUpdateQueryParams||u["default"].updateQueryParams({showFilters:!0});this.filtersWrap&&this.filtersWrap.classList.remove("is-collapsed");var D=this.domNode.querySelector(".js-toggle-filters");D.classList.add("is-active");D.setAttribute("aria-expanded","true");this.screenWidth<this.mobileBreakPoint&&J.classList.add("filters-open");a["default"].publish("control-bar/filters-toggle")};N.prototype.hideFilters=
function(){var J=window.document.documentElement;this.collapsed=!0;this.dontUpdateQueryParams||u["default"].updateQueryParams({showFilters:!1});this.filtersWrap&&this.filtersWrap.classList.add("is-collapsed");var D=this.domNode.querySelector(".js-toggle-filters");D.classList.remove("is-active");D.setAttribute("aria-expanded","false");J.classList.remove("filters-open");a["default"].publish("control-bar/filters-toggle")};N.prototype.resizeHandler=function(){var J=window.innerWidth,D=window.document.documentElement;
!this.collapsed&&900<=this.screenWidth&&900>J&&this.hideFilters();this.showOnResize&&this.collapsed&&900>this.screenWidth&&900<=J&&this.showFilters();(720>this.screenWidth&&720<=J||720<=this.screenWidth&&720>J)&&a["default"].publish("view/refresh");this._searchInput&&480<=this.screenWidth&&480>J&&a["default"].publish("search/setPlaceholder",z["default"].common.search);this._searchInput&&480>this.screenWidth&&480<=J&&this._searchInput.setPlaceholder();J>this.mobileBreakPoint&&D.classList.remove("filters-open");
this.moveFilters(J);this.screenWidth=J};N.prototype.setPlaceholder=function(J){this._searchInput.setPlaceholder(J)};N.prototype.focus=function(){var J;null===(J=this._searchInput)||void 0===J?void 0:J.focus()};N.prototype.initStickyInterface=function(){window.scrollTo(0,0);b["default"].sticky();this._scrollingSideMenu=this.filterContainer.querySelector(".js-scrolling-side-menu");this._scrollingMenusStart=this.domNode.getBoundingClientRect().top;this._scrollingOptionsMenuPlaceHolder=p["default"].create("div",
{"class":"js-scrolling-top-menu-placeholder hide",style:"height:\n          "+(this.domNode.clientHeight+Number(getComputedStyle(this.domNode)["margin-bottom"].split("px")[0]))+"px;"},this.domNode,"before");this.own(b["default"].bus.on("scrolling:at",this.stickyCallback?this._handlePageScrollWithCallback.bind(this):this.handlePageScroll.bind(this)))};N.prototype.showSearchError=function(J,D){var K;(null===(K=this._searchInput)||void 0===K?void 0:K.id)===D&&(K=this.domNode.querySelector(".js-control-bar-search-error"),
K.innerHTML=J,K.classList.add("is-active"),this.domNode.querySelector("js-control-bar-search-wrap").classList.add("ontrol-bar__search--error"))};N.prototype.hideSearchError=function(J){this._searchInput&&this._searchInput.id===J&&(J=this.domNode.querySelector(".js-control-bar-search-error"),J.innerHTML="",J.classList.remove("is-active"),this.domNode.querySelector(".js-control-bar-search-wrap").classList.remove("control-bar__search--error"))};N.prototype._handlePageScrollWithCallback=function(J,D){this.handlePageScroll();
this.stickyCallback(J,D)};N.prototype.handlePageScroll=function(){var J=document.documentElement,D=this.domNode.clientHeight;(window.pageYOffset||J.scrollTop)>=this._scrollingMenusStart?(this._scrollingOptionsMenuPlaceHolder.classList.remove("hide"),this.domNode.classList.add("fixed-to"),window.innerWidth>this.mobileBreakPoint?(this._scrollingSideMenu.classList.add("fixed-to"),this._scrollingSideMenu.style.top=D+"px"):this._scrollingSideMenu.style.top="0"):(this._scrollingOptionsMenuPlaceHolder.classList.add("hide"),
this.domNode.classList.remove("fixed-to"),this._scrollingSideMenu.classList.remove("fixed-to"),this._scrollingSideMenu.style.top="0")};N.prototype.moveFilters=function(J){this.insideOverlay&&this.filtersWrap&&(this.screenWidth<this.mobileBreakPoint&&J>=this.mobileBreakPoint&&p["default"].place(this.filtersWrap,this.filtersWrapParent,"first"),this.screenWidth>=this.mobileBreakPoint&&J<this.mobileBreakPoint&&document.querySelector(".js-overlay-control-bar-filters").appendChild(this.filtersWrap))};return N=
q.__decorate([F["default"](f["default"],h["default"])],N)}()})},"arcgisonline/pages/dijit/SearchInput":function(){define("require exports tslib ../../tsutils/declareDecorator dojo/topic dojo/debounce dojo/dom-class dojo/on dojo/i18n!../../nls/arcgisonline dojo/text!./SearchInput/SearchInput.html dijit/_TemplatedMixin dijit/_WidgetBase esri/libs/sanitizer/Sanitizer ../utils/icons ../utils/dom ../utils/strings".split(" "),function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t){b=q.__importDefault(b);l=q.__importDefault(l);
p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);return function(){function w(u,v){var x=this;this.templateString=d["default"];this.i18n=c["default"];this.icons=n["default"];this.queryParam=this.cssTheme=this.searchTerm="";this.hasSearchBy=!1;this.topic=this.searchBy="";this.dontDebounce=!1;this.sanitizer=
new g["default"];this.searchStarted=this.cancelDebounce=!1;this._searchWithDebounce=p["default"](function(y){x.cancelDebounce||x._search(y);x.cancelDebounce=!1},1E3)}w.prototype.postMixInProperties=function(){this.inherited(arguments);this.searchTerm=this.params.searchTerm||"";this.cssTheme=this.cssTheme||"";this.queryParam=this.params.queryParam||"searchTerm";this.searchBy=this.params.searchBy||"";this.topic=this.params.topic||"";this.params.validateInput&&(this.validateInput=this.params.validateInput.bind(this));
this.params.generateErrorMessage&&(this.generateErrorMessage=this.params.generateErrorMessage.bind(this))};w.prototype.postCreate=function(){var u=this;this.inherited(arguments);this.searchInput.value=this.searchTerm;m["default"].showHide(this.clearBtn,!!this.searchTerm);this.clearBtn.innerHTML=n["default"].getIconWithTitle("x","16",c["default"].manageLicenses.clearLabel,this.id+"_clear_btn");this.own(a["default"](this.searchInput,"input",function(v){m["default"].showHide(u.clearBtn,!!u.searchInput.value);
v=v.target.value;(2<v.length||0===v.length)&&v!==u.searchTerm&&(u.searchTerm=v,l["default"].publish(u.topic+"search/wait",u.sanitizer.sanitize(v),u.queryParam),u._testAndSearch(v,!!v))}),a["default"](this.searchInput,"focus",function(v){r["default"].add(v.target.parentNode,"control-bar__search--active");u.searchInput.value&&m["default"].showNode(u.clearBtn);l["default"].publish("search/focus",u.searchTerm)}),a["default"](this.searchInput,"blur",function(v){r["default"].remove(v.target.parentNode,
"control-bar__search--active");u.searchStarted=!1}),a["default"](this.searchInput,"keydown",function(v){13===v.keyCode&&u._testAndSearch(v.target.value,!1)}),a["default"](this.clearBtn,"click",function(){u.searchInput.value="";m["default"].hideNode(u.clearBtn);u.searchTerm="";l["default"].publish(u.topic+"search/wait","",u.queryParam);u._testAndSearch("",!1);u.searchInput.focus()}),l["default"].subscribe("membersSearchBy/update",function(v){u.hasSearchBy&&(u.searchBy=v)}))};w.prototype.focus=function(){this.searchInput.focus()};
w.prototype.setValue=function(u,v){this.searchTerm=u;this.searchInput.value=u;m["default"].showHide(this.clearBtn,!!this.searchTerm);v||(l["default"].publish(this.topic+"search/wait",this.sanitizer.sanitize(u),this.queryParam),this._testAndSearch(u,!1))};w.prototype.getValue=function(){return this.searchInput.value};w.prototype.setPlaceholder=function(u,v){u=u||this.placeholder;v||(this.placeholder=u);this.searchInput.placeholder=u;this.searchInput.setAttribute("aria-label",u)};w.prototype.validateInput=
function(u,v){return!0};w.prototype.generateErrorMessage=function(u,v){return c["default"].controlBar.invalidSyntax};w.prototype._testAndSearch=function(u,v){void 0===v&&(v=!0);this.validateInput(u,this.searchBy)?(this.cancelDebounce=!1,v&&!this.dontDebounce?this._searchWithDebounce(u):(this._search(u),this.cancelDebounce=!0)):l["default"].publish(this.topic+"search/error",this.generateErrorMessage(u,this.searchBy),this.id)};w.prototype._search=function(u){var v,x=this.sanitizer.sanitize(u);x=t["default"].escapeQuestionMarks(x);
l["default"].publish(this.topic+"search/update",x,this.searchBy,this.id);null===(v=this.telemetry)||void 0===v?void 0:v.logEvent({category:"Search",action:this.searchStarted?"update":"start",label:u,pageUrl:window.location.href});this.searchStarted=!0};return w=q.__decorate([b["default"](f["default"],h["default"])],w)}()})},"arcgisonline/pages/components/ViewToggle":function(){define("require exports tslib preact dojo/i18n!../../nls/arcgisonline dojo/topic arcgisonline/pages/pageUtil calcite-web/js/calcite-web".split(" "),
function(e,U,q,b,l,p,r,a){Object.defineProperty(U,"__esModule",{value:!0});l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);e=function(c){function d(){var h=null!==c&&c.apply(this,arguments)||this;h.domNodeRef=b.createRef();h.toggleView=function(f){var g;f.stopPropagation();f=f.target.dataset.view;h.updateUI(f);null===(g=h.props.telemetry)||void 0===g?void 0:g.logEvent({category:"Control Bar View Selector",action:f,pageUrl:window.location.href});a["default"].bus.emit("dropdown:close")};
h.closeMenu=function(){var f;a["default"].bus.emit("dropdown:close");(null===(f=h.domNodeRef.current)||void 0===f?void 0:f.querySelector(".js-toggle-view-dropdown")).focus()};h.updateUI=function(f){h.setState({activeView:f});h.props.topic||r["default"].updateQueryParams({view:f});p["default"].publish(h.props.topic+"view/toggle",f)};return h}q.__extends(d,c);d.prototype.componentDidMount=function(){this.updateUI(this.props.activeView)};d.prototype.handleToggle=function(h){if(this.domNodeRef.current){var f=
this.domNodeRef.current;setTimeout(function(){if(f.classList.contains("is-active")){var g=f.querySelectorAll(".js-view-option")[0];null===g||void 0===g?void 0:g.focus()}},0)}};d.prototype.render=function(){var h=this,f=this.state.activeView,g=this.props.views;return b.h("div",{"class":"control-bar__action control-bar__action--view js-dropdown flex",ref:this.domNodeRef},b.h("button",{"class":"control-bar__btn\r\n          flex flex-align-center js-dropdown-toggle js-toggle-view-dropdown","aria-label":l["default"].viewToggle.selectView,
"aria-haspopup":"true","aria-controls":"viewmenu",onClick:function(n){return h.handleToggle(n)}},b.h("calcite-icon",{"class":"margin-right-quarter icon-inline",icon:f,scale:"s"}),b.h("span",{"class":"control-bar__btn-text"},l["default"].viewToggle[f])),b.h("div",{"class":"control-bar__overlay"}),b.h("div",{"class":"control-bar__dropdown-menu dropdown-menu",role:"menu",id:"viewmenu","aria-labelledby":"viewmenutitle"},b.h("h3",{"class":"control-bar__dropdown-menu__title",id:"viewmenutitle"},l["default"].viewToggle.view,
b.h("button",{"class":"js-dropdown-toggle control-bar__dropdown-menu__close control-bar__btn right","aria-label":l["default"].common.close},b.h("calcite-icon",{"class":"icon-inline incon-inline--on-left",icon:"x",scale:"m"}))),b.h("nav",null,g.map(function(n){return b.h("button",{"class":"js-view-option dropdown-link control-bar__dropdown-item "+(n===f?"is-active":""),"data-view":n,role:"menuitem",onClick:h.toggleView},b.h("calcite-icon",{"class":"icon-inline",icon:n,scale:"s",flipRtl:!0}),b.h("span",
{"class":"control-bar__dropdown-item__label"},l["default"].viewToggle[n]))}),b.h("div",{"tab-index":"0","class":"js-focus-fence",onClick:this.closeMenu}))))};d.defaultProps={activeView:"grid",views:["table","list","grid"],topic:""};return d}(b.Component);U["default"]=e})},"arcgisonline/pages/components/SortDropdown":function(){define("require exports tslib preact ../utils/arrays dojo/i18n!../../nls/arcgisonline dojo/topic ../pageUtil calcite-web/js/calcite-web".split(" "),function(e,U,q,b,l,p,r,a,
c){Object.defineProperty(U,"__esModule",{value:!0});l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);var d={title:{asc:"alphabetical",desc:"reverseAlphabetical"},owner:{asc:"alphabetical",desc:"reverseAlphabetical"},modified:{asc:"leastRecent",desc:"mostRecent"},added:{asc:"leastRecent",desc:"mostRecent"},numviews:{asc:"leastToMost",desc:"mostToLeast"},relevance:{asc:"leastToMost",desc:"mostToLeast",disabled:!0},lastlogin:{asc:"leastRecent",
desc:"mostRecent"},name:{asc:"alphabetical",desc:"reverseAlphabetical"},fullname:{asc:"alphabetical",desc:"reverseAlphabetical"},joined:{asc:"leastRecent",desc:"mostRecent"},level:{asc:"alphabetical",desc:"reverseAlphabetical"},role:{asc:"alphabetical",desc:"reverseAlphabetical"},created:{asc:"leastRecent",desc:"mostRecent"},email:{asc:"alphabetical",desc:"reverseAlphabetical"},fieldAlias:{asc:"alphabetical",desc:"reverseAlphabetical"},fieldName:{asc:"alphabetical",desc:"reverseAlphabetical"},fieldType:{asc:"alphabetical",
desc:"reverseAlphabetical"},defaultFSOrder:{asc:"leastToMost",desc:"mostToLeast",disabled:!0},mfaenabled:{asc:"ascending",desc:"descending"},membertype:{asc:"alphabetical",desc:"reverseAlphabetical"},username:{asc:"alphabetical",desc:"reverseAlphabetical"},layerName:{asc:"alphabetical",desc:"reverseAlphabetical"},layerType:{asc:"alphabetical",desc:"reverseAlphabetical"},datasetName:{asc:"alphabetical",desc:"reverseAlphabetical"},datasetPath:{asc:"alphabetical",desc:"reverseAlphabetical"},machine:{asc:"alphabetical",
desc:"reverseAlphabetical"},containerId:{asc:"alphabetical",desc:"reverseAlphabetical"},runtimeName:{asc:"alphabetical",desc:"reverseAlphabetical"},version:{asc:"alphabetical",desc:"reverseAlphabetical"},avgrating:{asc:"highestRated",desc:"highestRated",disabled:!0},custom:{asc:"mostRecent",desc:"leastRecent",disabled:!0},type:{asc:"alphabetical",desc:"reverseAlphabetical"}};e=function(h){function f(){var g=null!==h&&h.apply(this,arguments)||this;g.domNodeRef=b.createRef();g.state={ascending:!0,property:"",
label:"",sortEnabled:!0,disabled:!1,showOnlyRelevance:!1};g.sortDisable=function(){g.setState({showOnlyRelevance:!0})};g.sortEnable=function(){g.setState({showOnlyRelevance:!1})};g.handleSortOptionClick=function(n){var m;r["default"].publish(g.props.topic+"sort/update",n);null===(m=g.props.telemetry)||void 0===m?void 0:m.logEvent({category:"Control Bar Sort Order",action:"selected sort order",pageUrl:window.location.href})};g.handleSortClick=function(n){var m;r["default"].publish(g.props.topic+"sort/update",
q.__assign(q.__assign({},g.state),{ascending:n}));null===(m=g.props.telemetry)||void 0===m?void 0:m.logEvent({category:"Control Bar Sort Order",action:"selected sort order",pageUrl:window.location.href})};g.handleToggle=function(){if(g.domNodeRef.current){var n=g.domNodeRef.current;if(!n.classList.contains("is-active")){var m=n.querySelectorAll(".control-bar__dropdown-item")[0];m&&setTimeout(function(){m.focus()})}}};g.sortUpdate=function(n){var m,t=g.props,w=t.dontUpdateQueryParams;t=t.topic;var u=
n.ascending,v=n.property;n=n.label;g.state.sortEnabled||c["default"].bus.emit("dropdown:close");g.setState({ascending:u,property:v,label:n,ascendingLabel:p["default"].gallery[d[v].asc],descendingLabel:p["default"].gallery[d[v].desc],disabled:!(null===(m=d[v])||void 0===m||!m.disabled)});w||t||a["default"].updateQueryParams({sortOrder:u?"asc":"desc",sortField:v})};return g}q.__extends(f,h);f.prototype.componentDidMount=function(){var g=this,n=l["default"].find(this.props.options,function(t){return t.active}),
m=d[n.property];this.setState(q.__assign(q.__assign({},n),{ascendingLabel:p["default"].gallery[m.asc],descendingLabel:p["default"].gallery[m.desc],disabled:null===m||void 0===m?void 0:m.disabled}));this.sortUpdateHandler=r["default"].subscribe(this.props.topic+"sort/update",function(t){return g.sortUpdate(t)});this.sortDisableHandler=r["default"].subscribe(this.props.topic+"sort/disable",function(){return g.sortDisable()});this.sortEnableHandler=r["default"].subscribe(this.props.topic+"sort/enable",
function(){return g.sortEnable()})};f.prototype.componentWillUnmount=function(){[this.sortDisableHandler,this.sortEnableHandler,this.sortUpdateHandler].forEach(function(g){g.remove()})};f.prototype.render=function(){var g=this,n=this.state,m=n.label,t=n.ascendingLabel,w=n.descendingLabel,u=n.ascending,v=n.property,x=n.showOnlyRelevance;n=n.disabled;var y=this.props.options;return b.h("div",{"class":"control-bar__action control-bar__sort-dropdown js-dropdown",ref:this.domNodeRef},b.h("button",{"class":"control-bar__btn flex flex-align-center js-toggle-sort-dropdown js-dropdown-toggle js-toggle-btn",
"aria-label":p["default"].gallery.changeSortDirection,"aria-haspopup":"true","aria-controls":"sortmenu",onClick:function(){return g.handleToggle()}},b.h("calcite-icon",{"class":"margin-right-quarter",icon:"sort-descending",scale:"s"}),b.h("span",{"class":"control-bar__btn-text js-sort-label"},m)),b.h("div",{"class":"control-bar__overlay"}),b.h("div",{"class":"control-bar__dropdown-menu dropdown-menu js-control-bar-sort-dropdown",role:"menu",id:"sortmenu","aria-labelledby":"sortmenutitle"},b.h("h3",
{"class":"control-bar__dropdown-menu__title",id:"sortmenutitle"},p["default"].gallery.sortBy,b.h("button",{"class":"js-dropdown-toggle control-bar__dropdown-menu__close control-bar__btn right","aria-label":"${i18n.common.close}"},b.h("calcite-icon",{icon:"x",scale:"m"}))),b.h("nav",{"class":"js-sort-options"},y.map(function(C){return b.h("button",{"class":"js-sort-option control-bar__dropdown-item dropdown-link padding-right-1 "+(v===C.property?"is-active":"")+"\n                  "+("relevance"===
C.property&&x?"hide":""),"data-property":v,"data-order":"${sortOrder}",role:"menuitem",onClick:function(){return g.handleSortOptionClick(C)}},b.h("span",{"class":"control-bar__dropdown-item__label"},C.label))})),b.h("div",{"class":"js-sort-direction-section leader-half "+(n?"hide":"")},b.h("h3",{"class":"control-bar__dropdown-menu__title"},p["default"].gallery.sortDirection),b.h("nav",{"class":"js-sort-direction-options"},b.h("button",{"class":"js-sort-direction dropdown-link control-bar__dropdown-item padding-right-1 "+
(u?"is-active":""),"data-value":"asc",role:"menuitem",onClick:function(){return g.handleSortClick(!0)}},b.h("span",{"class":"control-bar__dropdown-item__label js-ascending-label"},t)),b.h("button",{"class":"js-sort-direction dropdown-link control-bar__dropdown-item padding-right-1 "+(u?"":"is-active"),"data-value":"desc",role:"menuitem",onClick:function(){return g.handleSortClick(!1)}},b.h("span",{"class":"control-bar__dropdown-item__label js-descending-label"},w))))))};f.defaultProps={topic:""};
return f}(b.Component);U["default"]=e})},"arcgisonline/pages/components/Refresh":function(){define(["require","exports","tslib","dojo/topic","preact"],function(e,U,q,b,l){Object.defineProperty(U,"__esModule",{value:!0});b=q.__importDefault(b);e=function(p){function r(){return null!==p&&p.apply(this,arguments)||this}q.__extends(r,p);r.prototype.onRefresh=function(){b["default"].publish(this.props.topic+"refresh")};r.prototype.render=function(){var a=this;return l.h("div",null,l.h("calcite-button",
{label:this.props.label,onClick:function(){return a.onRefresh()},appearance:"transparent",color:"neutral",iconStart:"refresh",scale:"s"}))};r.defaultProps={topic:"",label:""};return r}(l.Component);U["default"]=e})},"arcgisonline/pages/organization/widgets/SearchDropdown":function(){define("require exports tslib ../../utils/icons ../../../tsutils/declareDecorator dijit/_TemplatedMixin dijit/_WidgetBase dojo/query dojo/dom-class dojo/topic dojo/text!./templates/members/SearchDropdown.html dojo/i18n!../../../nls/arcgisonline".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);return function(){function g(n,m){this.templateString=h["default"];this.i18n=f["default"];this.icons=b["default"]}g.prototype.setSelection=function(n){var m=a["default"]("[data-property*\x3d"+n+"]",this.domNode);0<m.length&&(c["default"].remove(a["default"](".js-search-dropdown-property.is-active",
this.domNode).shift(),"is-active"),m.addClass("is-active"),this._searchLabel.innerHTML=m.innerHTML(),d["default"].publish("membersSearchBy/update",n))};g.prototype.postCreate=function(){this._searchLabel.innerHTML=this.i18n.myOrganization.membersTab.fullName;this._addEventListeners()};g.prototype._addEventListeners=function(){this.own(a["default"](".js-search-dropdown-property").on("click",this._optionSelect.bind(this)))};g.prototype._optionSelect=function(n){n.preventDefault();c["default"].remove(a["default"](".js-search-dropdown-property.is-active",
this.domNode).shift(),"is-active");c["default"].add(n.target,"is-active");var m=n.target.getAttribute("data-property");this._searchLabel.innerHTML=n.target.textContent;d["default"].publish("membersSearchBy/update",m)};return g=q.__decorate([l["default"](r["default"],p["default"])],g)}()})},"arcgisonline/pages/dijit/View":function(){define("require exports tslib preact esri/Evented dojo/string dojo/on dojo/query dojo/topic dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin ./Card ./CardMobile ./CardWide ./TableRow ../pageUtil ../utils/arrays ../utils/icons dojo/text!./View/templates/tableHeader.html dojo/text!./View/templates/empty.html dojo/text!./View/templates/none.html dojo/text!./View/templates/loader.html dojo/text!./View/templates/View.html dojo/i18n!../../nls/arcgisonline ../../tsutils/declareDecorator ../utils/dropdown ../components/SearchFeedback ../utils/search".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D){l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);y=q.__importDefault(y);C=q.__importDefault(C);z=q.__importDefault(z);
F=q.__importDefault(F);O=q.__importDefault(O);V=q.__importDefault(V);return function(){function K(G,I){this.templateString=F["default"];this.i18n=O["default"];this.select=!0;this.listTemplate=null;this.tableHead=x["default"];this.emptyView=y["default"];this.noneView=C["default"];this.loaderView=z["default"];this.listView=m["default"];this.mobileView=n["default"];this.tableRowView=t["default"];this.showSource=this.fullItemTypes=!1;this.location=O["default"].contentPage.searchingFor;this.sortOptions=
[];this.showShareGroups=this.allowShare=this.hasSharedOwnershipGroups=!1;this.searchTerm="";this._shiftPressed=this._hasFilters=this.showFeedback=this.allowDragAndDrop=this.recordSelection=this.recordSortToggle=!1;this._lastSelected=null;this._items=[];this._selected=[];this._dijits=[];this._itemViews={};this.feedbackSearchTerm=""}K.prototype.postCreate=function(){this.inherited(arguments);this._view=this.activeView;var G={i18n:O["default"],location:this.location,searchTerm:""};this.domNode.querySelector(".js-empty-wrap").innerHTML=
p["default"].substitute(this.emptyView,{i18n:O["default"]});this.domNode.querySelector(".js-none-wrap").innerHTML=p["default"].substitute(this.noneView,{i18n:O["default"]});this.domNode.querySelector(".js-loader-wrap").innerHTML=p["default"].substitute(this.loaderView,G);this.domNode.querySelector(".js-table-header").innerHTML=p["default"].substitute(this.tableHead,{i18n:O["default"],icons:v["default"],selectClass:this.select?"":"hide"});0<this.sortOptions.length&&(G=u["default"].find(this.sortOptions,
function(I){return I.active}))&&this._sortUpdate(G);this._itemViews=this.declareItemViews();this._addEventListeners()};K.prototype.destroy=function(){this.inherited(arguments);this._dijits.forEach(function(G){return G.destroy()})};K.prototype.setEmptyView=function(G){this.emptyView=G;this.domNode.querySelector(".js-empty-wrap").innerHTML=p["default"].substitute(this.emptyView,{i18n:O["default"]})};K.prototype.declareItemViews=function(){return{grid:{template:g["default"],containerClass:".js-grid-wrap"},
mobile:{template:this.mobileView,containerClass:".js-mobile-wrap"},list:{template:this.listView,containerClass:".js-list-wrap"},table:{template:this.tableRowView,containerClass:".js-table-rows"}}};K.prototype.allowCategorization=function(){a["default"](this.domNode).addClass("allow-categorization")};K.prototype.preventCategorization=function(){a["default"](this.domNode).removeClass("allow-categorization")};K.prototype.updateSearchFeedback=function(G,I,R,A,B,H){var T=this;this.searchTerm=G;var M=this.domNode.querySelector(".js-search-feedback");
b.render(b.h(null,null),M);M.classList.add("hide");I&&this.showFeedback&&this.telemetry&&G&&G!==this.feedbackSearchTerm&&((null===B||void 0===B?0:B.eueiEnabled)||H&&!H.orgId)&&(M.classList.remove("hide"),b.render(b.h(J.SearchFeedback,{telemetry:this.telemetry,searchTerm:this.searchTerm,page:R,onlyOrg:A,section:"content",enriched:D.semanticSearchEnabled(this.portal,this.portalUser),onSubmit:function(){return T.feedbackSearchTerm=G}}),M))};K.prototype._addEventListeners=function(){var G=this;this.own(r["default"](window,
"keydown",function(I){return G._shiftPressed=I.shiftKey}),r["default"](window,"keyup",function(I){return G._shiftPressed=!1}),a["default"](".js-table-sort-header",this.domNode).on("click",this._sortHeader.bind(this)),r["default"](this.domNode.querySelector(".js-select-all"),"click",this._toggleAll.bind(this)),c["default"].subscribe("view/toggle",this._toggleView.bind(this)),c["default"].subscribe("view/update",this._updateView.bind(this)),c["default"].subscribe("view/deselect",this._deselectItem.bind(this)),
c["default"].subscribe("view/deselectAll",this._deselectAll.bind(this)),c["default"].subscribe("view/select",this._parseSelect.bind(this)),c["default"].subscribe("view/loading",this._showLoadingScreen.bind(this)),c["default"].subscribe("view/updateShare",this._updateItemsSharing.bind(this)),c["default"].subscribe("sort/update",this._sortUpdate.bind(this)),c["default"].subscribe("pagination/page",this._scrollToTop.bind(this)),c["default"].subscribe("item/update",this._updateItem.bind(this)));this.allowDragAndDrop&&
(this.domNode.classList.add("drag-and-drop-well"),this.own(r["default"](this.domNode,"dragover",function(I){I.preventDefault();G.dragover||(G.dragover=!0,G.domNode.classList.add("drag-and-drop-well--dragging"))}),r["default"](this.domNode,"dragleave",function(I){I.preventDefault();G.dragover=!1;G.domNode.classList.remove("drag-and-drop-well--dragging")}),r["default"](this.domNode,"drop",function(I){I.preventDefault();G.dragover=!1;G.domNode.classList.remove("drag-and-drop-well--dragging");c["default"].publish("view/drop",
I.dataTransfer)})))};K.prototype._toggleView=function(G){this._view=G;c["default"].publish("view/update",this._items,this._selected,this._hasFilters)};K.prototype._showLoadingScreen=function(G){a["default"](".js-view",this.domNode).addClass("hide");var I=this.domNode.querySelector(".js-loader-wrap"),R=p["default"].substitute(this.location,{term:G});I.innerHTML=p["default"].substitute(this.loaderView,{i18n:O["default"],location:R,searchTerm:G});I.classList.remove("hide")};K.prototype._parseSelect=
function(G,I){var R=this._items.indexOf(G);I||!this._lastSelected&&0!==this._lastSelected||!this._shiftPressed?(this._selectItem(G),this._lastSelected=R):this._selectRange(Math.min(this._lastSelected,R),Math.max(this._lastSelected,R))};K.prototype._selectItem=function(G){u["default"].find(this._selected,function(I){return I.id===G.id})||(G.isSelected=!0,this._selected.push(G));this._setSelectAllState()};K.prototype._toggleAll=function(G){var I;this._lastSelected=null;this._shiftPressed=!1;(G=G.target.checked)?
this._selectPage():this._deselectPage();this.recordSelection&&(null===(I=this.telemetry)||void 0===I?void 0:I.logEvent({category:"Select",action:(G?"Select":"Unselect")+" page",count:this._items.length}))};K.prototype._selectRange=function(G,I){this._lastSelected=null;for(var R=G;R<=I;R++)c["default"].publish("view/select",this._items[R],!0);c["default"].publish("view/update",this._items,this._selected,this._hasFilters)};K.prototype._selectPage=function(){this._lastSelected=null;this._items.forEach(function(G){return c["default"].publish("view/select",
G)});c["default"].publish("view/update",this._items,this._selected,this._hasFilters)};K.prototype._deselectItem=function(G){this._lastSelected=null;G.isSelected=!1;this._selected=this._selected.filter(function(I){return I.id!==G.id});this._setSelectAllState()};K.prototype._deselectPage=function(){this._lastSelected=null;this._items.forEach(function(G){return c["default"].publish("view/deselect",G)});c["default"].publish("view/update",this._items,this._selected,this._hasFilters)};K.prototype._deselectAll=
function(){this._lastSelected=null;this._items=this._items.map(function(G){G.isSelected=!1;return G});this._selected=[];this._setSelectAllState()};K.prototype._sortUpdate=function(G){this._currentSort=G;this._lastSelected=null;if("table"===this._view){var I=G.ascending?"is-ascending":"is-descending";a["default"](".js-table-sort-header").removeClass(["is-descending","is-ascending"]).attr("aria-sort","none");var R=a["default"](".js-table-sort-header[data-sort\x3d'"+G.property+"']");0<R.length&&(R.addClass(I),
R.attr({"aria-sort":G.ascending?"ascending":"descending","data-sort-order":G.ascending?"asc":"desc"}))}};K.prototype._updateItem=function(G){G&&"isFavorite"!==G.name&&this._updateView(this._items,this._selected,this._hasFilters)};K.prototype._updateItemsSharing=function(G){var I=this;(G||[]).forEach(function(R){var A=u["default"].find(I._items,function(B){return B.id===R.id});A&&(A.set("access",R.access),A.set("groupData",R.groupData),A.set("sharedGroups",R.sharedGroups))})};K.prototype._sortHeader=
function(G){this._lastSelected=null;var I=G.target;if(!I.getAttribute("data-sort")){var R=a["default"](G.target).closest(".js-table-sort-header")[0];R&&(I=R)}var A=I.getAttribute("data-sort");R=d["default"].contains(I,"is-ascending")||d["default"].contains(I,"is-descending");I=I.getAttribute("data-sort-order");R&&(I="asc"===I?"desc":"asc");G=(R=u["default"].find(this.sortOptions,function(B){return B.property===A}))?R.label:G.target.innerHTML;this.telemetry&&this.recordSortToggle&&this.telemetry.logEvent({category:"Table Sort Order",
action:"selected sort order"});c["default"].publish("sort/update",{label:G,property:A,ascending:"asc"===I})};K.prototype._updateView=function(G,I,R,A,B){var H=this;this._lastSelected=null;A=this.domNode.querySelector(".js-content-loader");B=this.domNode.querySelector(".js-table-wrap");null===A||void 0===A?void 0:A.classList.add("is-active");this._dijits.forEach(function(ba){return ba.destroy()});a["default"](".js-view",this.domNode).addClass("hide");this._items=G||[];this._selected=I||[];this._hasFilters=
R;var T=this.mobileView&&720>=window.innerWidth?"mobile":this._view;I=this._itemViews[T];var M=I.template,L=this.domNode.querySelector(I.containerClass);I=this.domNode.querySelector(".js-none-wrap");var X=this.domNode.querySelector(".js-empty-wrap");R=R?I:X;0<G.length?(G.forEach(function(ba,ma){var ta=u["default"].find(H._selected,function(Ea){return Ea.id===ba.id});ta={item:ba,options:w["default"].getQueryParams(),select:H.select,isSelected:ta,portalUser:H.portalUser,fullItemTypes:H.fullItemTypes,
showSource:H.showSource,hasSharedOwnershipGroups:H.hasSharedOwnershipGroups,allowShare:H.allowShare,showShareGroups:H.showShareGroups,itemIndex:ma,telemetry:H.telemetry,page:H.page,telemetryOptions:H.telemetryOptions,portal:H.portal,recordSelection:H.recordSelection,searchTerm:H.searchTerm,addSearchTelemetryParams:H.addSearchTelemetryParams};H.tableRow&&"table"===T&&(ta.template=H.tableRow);H.listTemplate&&"list"===T&&(ta.template=H.listTemplate);ta=new M(ta);ta.startup();ta.placeAt(L);H._dijits.push(ta)}),
d["default"].remove(L,"hide"),c["default"].publish("view/show"),"table"===T&&(B.classList.remove("hide"),this._setSelectAllState(),this._sortUpdate(this._currentSort))):R.classList.remove("hide");null===A||void 0===A?void 0:A.classList.remove("is-active");N.dropdown()};K.prototype._setSelectAllState=function(){var G=this.domNode.querySelector(".js-select-all"),I=this._items.filter(function(R){return R.isSelected});0===I.length?(G.checked=!1,G.indeterminate=!1):I.length===this._items.length?(G.checked=
!0,G.indeterminate=!1,G.disabled=!1):G.indeterminate=!0};K.prototype._scrollToTop=function(){this._lastSelected=null;var G=this.domNode.getBoundingClientRect().top;0>G&&window.scrollBy(0,G-50)};K.prototype.getItemCount=function(){return this._items.length};return K=q.__decorate([V["default"](h["default"],f["default"],l["default"])],K)}()})},"arcgisonline/pages/dijit/Card":function(){define("require exports tslib ../../tsutils/declareDecorator dojo/string ./Card/_CardBase dojo/text!./Card/Card.html dojo/text!./Card/MinimalCard.html dojo/i18n!../../nls/arcgisonline".split(" "),
function(e,U,q,b,l,p,r,a,c){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);return function(){function d(h,f){this.alwaysShowDrag=this.draggable=!1;this.templateString=h.minimal?a["default"]:r["default"]}d.prototype.postMixInProperties=function(){var h,f;this.inherited(arguments);this.item.ownerText=null!==(f=null===(h=this.item.verified)||void 0===h?void 0:h.name)&&void 0!==f?f:this.item.owner;this.item.viewMsg=
l["default"].substitute(c["default"].viewsWidget.universalViewsMsgAlone,{viewcount:this.item.numViews})};d.prototype.postCreate=function(){this.inherited(arguments);this.draggable&&this.domNode.classList.add("card--draggable");this.alwaysShowDrag&&this.domNode.classList.add("card--show-drag")};d.prototype.setDraggable=function(h){(this.draggable=h)?this.domNode.classList.add("card--draggable"):this.domNode.classList.remove("card--draggable")};return d=q.__decorate([b["default"](p["default"])],d)}()})},
"arcgisonline/pages/dijit/Card/_CardBase":function(){define("require exports tslib dojo/dom-construct dojo/query dojo/string dojo/on dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin ../Favorite ../ItemShareSummary ../../utils/formatters ../../utils/item ../../utils/setItemUrls ../../utils/icons ../../utils/arrays ../../utils/dom ../../item/_Actions ../../../esriGeowConfig ./_getItemClasses dojo/text!./Card.html dojo/text!./OpenDropdown.html dojo/i18n!../../../nls/arcgisonline ../../../tsutils/declareDecorator ../OrgPopup/OrgPopup".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);y=q.__importDefault(y);C=q.__importDefault(C);z=
q.__importDefault(z);F=q.__importDefault(F);O=q.__importDefault(O);V=q.__importDefault(V);var N;(function(J){J.notebook="notebookViewer";J.map="mapViewer";J.newMap="newMapViewer";J.download="download";J.desktop="openDesktop";J.pro="openPro";J.story="storyMapViewer"})(N||(N={}));return function(){function J(D){this.i18n=F["default"];this.template=C["default"];this.fullDate=g["default"].fullDate;this.completeDate=g["default"].completeDate;this.empty=g["default"].empty;this.getAccess=g["default"].getAccess;
this.getAccessIcon=g["default"].getAccessIcon;this.formatNumViews=g["default"].formatNumViews;this.formatViewsLabel=g["default"].formatViewsLabel;this.hasSharedOwnershipGroups=this.fullItemTypes=!1;this.hide=g["default"].hide;this.show=g["default"].show;this.icons=t["default"];this.isImage=!1;this.imageClass="";this.cssClasses=[];this.select=this.favoritesDisabled=!1;this.checked=this.selectedClass="";this.selectItem=F["default"].GroupWidget.selectItem;this.disabled="disabled";this.addSearchTelemetryParams=
!1;this.searchTerm="";this.canCreateNotebooks=!1}J.prototype.postMixInProperties=function(){var D=this,K,G,I,R,A,B;this.formatDisplayName=g["default"].formatDisplayName.bind(this,this.item,this.fullItemTypes);this.favoritesDisabled=!this.portalUser;this.selectCardClass=this.select?"card-select":"";this.isSelected&&(this.selectedClass="card-select-active",this.checked="checked",this.selectItem=F["default"].GroupWidget.unselectItem);this.hasSublayers=!(null===(K=this.item.sublayers)||void 0===K||!K.length);
this.removedClass=this.isRemoved?"card-select-removed":"";this.item.canShare=this.allowShare&&n["default"].canShareItem(this.item,this.portalUser);this.item.isAdmin=null!==(G=this.item.isAdmin)&&void 0!==G?G:(null===(I=this.portalUser)||void 0===I?void 0:I.isOrgAdmin)&&this.item.portal.id===this.portalUser.orgId;this.item.snippet=250<this.item.snippet.length?this.item.snippet.substring(0,250)+"\u2026":this.item.snippet;this.item.badges=n["default"].getBadges(this.item,this.isWide,this.portalUser);
this.item.ownerText=g["default"].formatOwnerText(this.item);this.item.accessIcon=g["default"].getAccessIcon(this.item.access);this.canCreateNotebooks=null===(R=this.portalUser)||void 0===R?void 0:R.userRole.canCreateNotebooks();this.item.openIn.forEach(function(H){return m["default"][H](D.item)});this.item.downloadUrl="file"===this.item.classification?m["default"].getItemDataUrl(this.item):"";this.item.defaultOpenUrl=this._getDefaultOpenUrl(this.item);this.item.defaultOpenIcon=this.item.defaultOpenIcon||
"launch";this.item.defaultOpenSvg=null!==(B=null===(A=t["default"].inline[this.item.defaultOpenIcon])||void 0===A?void 0:A["16"])&&void 0!==B?B:t["default"].inline.launch["16"];this.item.defaultOpenText=this._getDefaultOpenText(this.item);this._setDefaultThumbnail(this.item);this.cssClasses=y["default"](this.item,this.portalUser);"Image"===this.item.type&&(this.isImage=!0,this.imageClass="card--image-item")};J.prototype._setDefaultThumbnail=function(D){var K;D.thumbnailUrl=null!==(K=this.useMostRecentToken(D.thumbnailUrl))&&
void 0!==K?K:"";"Notebook"===D.type&&(K=x["default"].baseUrl+"js/arcgisonline/css/images/notebook-thumb.png",D.thumbnailUrl=D.thumbnailUrl||K);D.largeThumbnailUrl=""+D.thumbnailUrl+(-1<D.thumbnailUrl.search("\\?token\x3d")?"\x26":"?")+"w\x3d400"};J.prototype.useMostRecentToken=function(D){var K,G=this.item.portal.getPortalUser(),I=null===(K=null===G||void 0===G?void 0:G.credential)||void 0===K?void 0:K.token;return m["default"].swivelToken(D,null===G||void 0===G?void 0:G.token,I)};J.prototype._getDefaultOpenText=
function(D){return"Notebook"!==D.type||this.canCreateNotebooks?this.item.defaultOpenText||F["default"].itemLinks.viewDetails:F["default"].itemLinks.viewDetails};J.prototype.postCreate=function(){var D=this,K,G;this.inherited(arguments);this.cssClasses.filter(function(T){return T}).forEach(function(T){return D.domNode.classList.add(T)});var I=this.item,R=this.portalUser,A=this.domNode.querySelector(".js-favorites-container"),B=this.domNode.querySelector(".js-open-dropdown-container"),H=this.domNode.querySelector(".js-default-open");
this.favoritesDisabled||(this._favoriteDijit=new h["default"]({item:I},A));B&&b["default"].place(p["default"].substitute(z["default"],{item:I,i18n:F["default"],icons:t["default"],telemetryParams:this.addSearchTelemetryParams?"\x26fromSearch\x3dtrue\x26searchPosition\x3d"+this.itemIndex+"\x26searchTerm\x3d"+this.searchTerm+"\x26searchFacet\x3dcard%20dropdown%20item%20details":""},null,this),B);if("Feature Service"===I.type||"Feature Collection"===I.type)A=this.domNode.querySelector(".js-layers-tables"),
B=this.domNode.querySelector(".js-layers-tables-toggle"),A&&B&&x["default"].deepLayerSearchEnabled&&u["default"].createElement("arcgis-layers-and-tables-summary-popup",{item:I,layers:I.sublayers,portal:I.portal,api:3,user:R,searchTerm:this.searchTerm,config:x["default"],telemetry:this.telemetry,border:!0,tooltip:this.formatDisplayName(I.displayName),i18nNoService:F["default"].publishWizard.errors.selectedServiceNotExist.message,i18nNoLayers:F["default"].SelectLayersWFS.noLayers},A).appendChild(B);
new f["default"]({item:I,portalUser:R,right:!0,canShare:this.item.canShare,allowShare:this.allowShare,showShareGroups:this.showShareGroups&&this.isWide,telemetry:this.telemetry},this.domNode.querySelector(".js-share-summary"));if(H){I=this.item.defaultOpenUrl;if(I===N.download||I===N.desktop||I===N.pro)H.classList.add("js-action"),H.setAttribute("data-action",this.item.defaultOpenUrl);this.item.defaultOpenUrl===N.newMap&&(I="modern"===this.item.portal.defaultMapViewer&&this.item.canOpenInNewMapViewer?
this.item.newMapViewerUrl:this.item.mapViewerUrl,H.href=I,H.setAttribute("data-href",I));(I=this.item.openIn)&&I[0]&&I[0]!==N.map&&this.item[I[0]+"Url"]&&H.setAttribute("target","_blank")}this._addEventListeners();(null===(K=this.item.portal)||void 0===K?0:K.isPortal)&&u["default"].hideNodes(null===(G=this.domNode)||void 0===G?void 0:G.querySelectorAll(".js-hide-portal"))};J.prototype.destroy=function(){this.inherited(arguments);this._popup&&this._popup.destroy()};J.prototype._getDefaultOpenUrl=function(D){var K=
"item.html?id\x3d"+D.id,G=D.openIn&&D.openIn[0];return D.defaultOpenText===F["default"].itemLinks.openDesktop?N.desktop:D.defaultOpenText===F["default"].itemLinks.openPro?N.pro:D.defaultOpenText===F["default"].itemLinks.openVRExperience?D.vrExperienceUrl:!G||G!==N.notebook||this.portalUser&&this.portalUser.userRole.canCreateNotebooks()?G&&G!==N.map&&D[G+"Url"]?D[G+"Url"]:"download-to"===D.defaultOpenIcon||w["default"].includes(D.types,"is-pdf")?N.download:G===N.map?N.newMap:G===N.story?N.story:K:
K};J.prototype._addEventListeners=function(){var D=this;this.own(l["default"](".js-card-select-check-mark-wrap",this.domNode).on("click",function(G){G.stopPropagation()}),l["default"](".js-card-select-check-mark",this.domNode).on("change",function(G){D[G.target.checked?"_select":"_deselect"]()}),l["default"](this.domNode).on("click",this._toggleSelected.bind(this)),l["default"](".js-card-item-owner",this.domNode).on("click",this._showProfile.bind(this)),l["default"](".js-action",this.domNode).on("click",
this._handleAction.bind(this)),a["default"].subscribe("view/deselectAll",this._deselect.bind(this)),l["default"](".js-card-image",this.domNode).on("error",this._cardImageError.bind(this)),l["default"](".js-card-title-link",this.domNode).on("click",this._cardOpen.bind(this)),l["default"](".js-item-share-dropdown",this.domNode).on("click",this._shareItemDropdown.bind(this)),l["default"](".js-item-categorize",this.domNode).on("click",this._categorizeItem.bind(this)),this.item.watch(this._itemUpdate.bind(this)));
var K=this.domNode.querySelector(".js-verified-owner-link");K&&this.own(r["default"](K,"click",this.showOrgPopup.bind(this)));this._favoriteDijit&&this.own(this._favoriteDijit.on("click",function(G){G.stopPropagation()}))};J.prototype._handleAction=function(D){var K=this;D.preventDefault();var G=D.currentTarget.getAttribute("data-action"),I=this.item,R=this.portalUser,A=this.item.portal;if(G&&v["default"][G])if("share"!==G||this.item.isOwner)v["default"][G]({evt:D,item:I,user:R,portal:A});else this.item.getOwnerProfile(!0,
!0).then(function(B){K.item.itemOwner=B;v["default"].share({evt:D,item:I,user:R,portal:A})})};J.prototype._select=function(){this.domNode.classList.add("card-select-active");this.item.isSelected=!0;var D=this.domNode.querySelector(".js-card-select-check-mark");D.parentNode.setAttribute("aria-label",F["default"].GroupWidget.unselectItem);D.checked=!0;a["default"].publish("view/select",this.item)};J.prototype._deselect=function(){this.domNode.classList.remove("card-select-active");this.item.isSelected=
!1;var D=this.domNode.querySelector(".js-card-select-check-mark");D&&(D.parentNode.setAttribute("aria-label",F["default"].GroupWidget.selectItem),D.checked=!1);a["default"].publish("view/deselect",this.item)};J.prototype._toggleSelected=function(D){"ARCGIS-LAYERS-AND-TABLES-SUMMARY-POPUP"!==D.target.tagName&&this.select&&(this.domNode.classList.contains("card-select-active")?this._deselect():this._select())};J.prototype._showProfile=function(D){D.stopPropagation();a["default"].publish("profile/show",
D)};J.prototype.showOrgPopup=function(D){D.stopPropagation();(new V["default"]({item:this.item,opener:D.target})).open()};J.prototype._cardImageError=function(D){D.preventDefault();D.target.src="js/arcgisonline/css/images/default_thumb.png"};J.prototype._cardOpen=function(D){a["default"].publish("card/open",this.itemIndex,D)};J.prototype._itemUpdate=function(D,K,G){a["default"].publish("item/update",{item:this.item,name:D,oldValue:K,value:G})};J.prototype._shareItemDropdown=function(D){this.domNode.querySelector(".js-item-share-dropdown").blur()};
J.prototype._categorizeItem=function(){a["default"].publish("item/categorize",this.item,this.domNode.querySelector(".js-dropdown-toggle"))};return J=q.__decorate([O["default"](c["default"],d["default"])],J)}()})},"arcgisonline/pages/dijit/Favorite":function(){define("require exports tslib ../../tsutils/declareDecorator dojo/dom-class dojo/on dojo/topic dojo/text!./Favorite/Favorite.html dojo/i18n!../../nls/arcgisonline dijit/_TemplatedMixin dijit/_WidgetBase ../pageUtil ../utils/icons ../../sharing/geow/Content ./_CheckReadonlyMixin".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);return function(){function t(w,u){this.templateString=a["default"];this.i18n=c["default"]}t.prototype.postMixInProperties=function(){this.inherited(arguments)};t.prototype.postCreate=function(){this.inherited(arguments);
this._setState(this.item.isFavorite);this._addEventListeners()};t.prototype.getFavorite=function(){var w=this;f["default"].isFavorite(this.item).then(function(u){w._setState(u)},function(){w._setState(!1)})};t.prototype._setState=function(w){void 0!==this.button&&((this.isFavorite=w)?(this.button.setAttribute("aria-label",c["default"].common.unfavorite),l["default"].add(this.button,"btn-link-yellow"),this.button.innerHTML='\x3cspan class\x3d"screen-readers-only"\x3e'+this.i18n.common.isFavorite+"\x3c/span\x3e"+
g["default"]["star-f"]["16"]):(this.button.setAttribute("aria-label",c["default"].common.favorite),l["default"].remove(this.button,"btn-link-yellow"),this.button.innerHTML='\x3cspan class\x3d"screen-readers-only"\x3e'+this.i18n.common.notFavorite+"\x3c/span\x3e"+g["default"].star["16"]))};t.prototype._addEventListeners=function(){this.own(p["default"](this.button,"click",this._clickHandler.bind(this)))};t.prototype._clickHandler=function(w){var u=this;this.checkReadonly(this.item.portal)||(w=this.isFavorite?
"removeFromFavorites":"addToFavorites",this._setState(!this.isFavorite),this.item.set("isFavorite",this.isFavorite),n["default"][w](this.item).then(function(){u.button.blur()},function(v){r["default"].publish("alert/show",{type:"error",text:null===v||void 0===v?void 0:v.message});u._setState(!u.isFavorite);u.item.set("isFavorite",!u.isFavorite)}))};return t=q.__decorate([b["default"](h["default"],d["default"],m["default"])],t)}()})},"arcgisonline/pages/dijit/Card/_getItemClasses":function(){define("require exports tslib ../../utils/arrays ../../utils/organization dojo/sniff arcgisonline/pages/utils/mapViewer".split(" "),
function(e,U,q,b,l,p,r){Object.defineProperty(U,"__esModule",{value:!0});b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);U["default"]=function(a,c){var d,h,f,g=a.url||"";var n=a.isHostedService;var m=a.serviceInfo||{},t=null!==(h=null===m||void 0===m?void 0:m.capabilities)&&void 0!==h?h:"";h=null===c||void 0===c?void 0:c.userRole;g=c&&-1<g.indexOf(c.orgId);t=-1<t.indexOf("Editing");m=b["default"].includes(a.typeKeywords,"Multi Services View")||m.isMultiServicesView;var w=a.isAdminView?
null===h||void 0===h?void 0:h.canUpdateOrgItems():a.canUpdate;n=n&&!m&&(w||t&&(null===h||void 0===h?void 0:h.canEditFeaturesFullControl())&&g);n=null!==(f=a.canEditService)&&void 0!==f?f:n;a.isEditableByUser=n;f=p["default"]("trident");n=l["default"].isMobile();f=f||n;h="Scene Service"===a.type&&b["default"].includes(a.typeKeywords,"Voxel");m=a.portal.isPortal;n=[].concat(a.types);n.push(a.hasResources?"has-resources":"");n.push(a.hasViewStyle?"has-viewStyle":"");n.push(a.url?"has-url":"");n.push(!m&&
b["default"].includes(a.typeKeywords,"Presentation Map")?"has-presentation":"");n.push((null===c||void 0===c?0:c.isOrgUser)&&"Form"===a.type?"is-surveyForm":"");n.push(a.portal&&!a.portal.isPortal&&(null===c||void 0===c?0:c.isOrgUser)&&"Form"===a.type?"is-surveyFormBrowser":"");n.push(a.isConfigurableApp?"can-configure":"");n.push(a.isEditableByUser&&"Feature Service"===a.type?"can-edit-service":"");n.push(h?"is-voxel":"");n.push(a.isOwner?"is-owner":"");n.push(a.isAdmin?"is-admin":"");n.push((null===
c||void 0===c?0:c.isOrgUser)?"":"is-public-user");n.push((null===c||void 0===c?0:c.isOrgAdmin)?"is-admin":"");n.push(a.canUpdate?"can-update":"is-viewer");n.push(b["default"].includes(a.typeKeywords,"Web AppBuilder")&&a.canUpdate&&!a.origin?"can-edit-wab":"");n.push(!m&&a.canUpdate?"can-create-presentation":"");n.push((null===c||void 0===c?0:c.isOrgUser)&&"Notebook"===a.type?"is-notebook":"");h=-1<(null===(d=a.openIn)||void 0===d?void 0:d.indexOf("mapViewer"));n.push(h&&!f?"is-map-viewer-beta":"");
n.push(c&&(null===c||void 0===c?void 0:c.defaultMapViewer)!==r.MapViewerType.Modern?"is-map-viewer-classic":"is-map-viewer-modern");"OGCFeatureServer"===a.type&&n.push("no-legacy-viewer-support");a.addBlockClasses(n);return n}})},"arcgisonline/pages/dijit/CardMobile":function(){define("require exports tslib ../../tsutils/declareDecorator dojo/text!./CardMobile/CardMobile.html ../utils/formatters ./Card/_CardBase".split(" "),function(e,U,q,b,l,p,r){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);
r=q.__importDefault(r);return function(){function a(c){this.templateString=l["default"];this.alwaysShowDrag=this.draggable=!1}a.prototype.postMixInProperties=function(){this.inherited(arguments);this.item.ownerText=p["default"].formatOwnerText(this.item,!0)};a.prototype.postCreate=function(){this.inherited(arguments);this.draggable&&this.domNode.classList.add("card--draggable");this.alwaysShowDrag&&this.domNode.classList.add("card--show-drag")};a.prototype.setDraggable=function(c){(this.draggable=
c)?this.domNode.classList.add("card--draggable"):this.domNode.classList.remove("card--draggable")};return a=q.__decorate([b["default"](r["default"])],a)}()})},"arcgisonline/pages/dijit/CardWide":function(){define("require exports tslib ../../tsutils/declareDecorator ./Card/_CardBase dojo/text!./CardWide/CardWide.html".split(" "),function(e,U,q,b,l,p){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);return function(){function r(){this.isWide=!0;this.templateString=p["default"]}
r.prototype.postCreate=function(){this.inherited(arguments)};return r=q.__decorate([b["default"](l["default"])],r)}()})},"arcgisonline/pages/dijit/TableRow":function(){define("require exports tslib dojo/dom-construct dojo/query dojo/string dojo/on dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin ../utils/formatters ../../esriGeowConfig ./ItemShareSummary ../utils/item ../utils/setItemUrls ../utils/icons ../utils/dom ./Card/_getItemClasses ../item/_Actions ./_CheckReadonlyMixin dojo/text!./TableRow/templates/TableRow.html dojo/text!./Card/OpenDropdown.html dojo/i18n!../../nls/arcgisonline ../../tsutils/declareDecorator ./OrgPopup/OrgPopup preact ../components/Favorite".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);y=q.__importDefault(y);C=q.__importDefault(C);
z=q.__importDefault(z);F=q.__importDefault(F);O=q.__importDefault(O);N=q.__importDefault(N);return function(){function J(D,K){this.template=y["default"];this.i18n=z["default"];this.fullDate=h["default"].fullDate;this.completeDate=h["default"].completeDate;this.capitalize=h["default"].capitalize;this.empty=h["default"].empty;this.shortenNumber=h["default"].shortenNumber;this.getAccess=h["default"].getAccess;this.getAccessIcon=h["default"].getAccessIcon;this.show=h["default"].show;this.hide=h["default"].hide;
this.icons=t["default"];this.cssClasses=[];this.dropdownClass=this.removedRow=this.activeRow=this.selectClass=this.checked="";this.recordSelection=this.favoritesDisabled=this.showShareGroups=this.hasSharedOwnershipGroups=this.showSource=this.fullItemTypes=this.isRemoved=this.isSelected=this.select=!1}J.prototype.postMixInProperties=function(){var D=this,K,G;this.inherited(arguments);this.formatDisplayName=h["default"].formatDisplayName.bind(this,this.item,this.fullItemTypes);this.templateString=this.template||
y["default"];this.checked=this.isSelected?"checked":"";this.selectClass=this.select?"":"hide";this.activeRow=this.isSelected?"table-select-row-active":"";this.removedRow=this.isRemoved?"table-select-row-removed":"";this.dropdownClass=2<this.itemIndex?"dropdown-up":"";if(null===(K=this.item)||void 0===K?0:K.classification)this.favoritesDisabled=!this.portalUser,this.item.openIn.forEach(function(I){return m["default"][I](D.item)}),this.item.premiumClass=this.item.isPremium?"":"hide",this.cssClasses=
u["default"](this.item,this.portalUser),this.item.isAdmin=this.item.isAdmin||(null===(G=this.portalUser)||void 0===G?void 0:G.isOrgAdmin)&&this.item.portal.id===this.portalUser.orgId,this.item.canShare=this.allowShare&&n["default"].canShareItem(this.item,this.portalUser),this.item.ownerText=h["default"].formatOwnerText(this.item),this.item.badges=n["default"].getBadges(this.item,!1,this.portalUser)};J.prototype.postCreate=function(){var D=this,K,G;this.inherited(arguments);this.cssClasses&&this.cssClasses.forEach(function(H){return H&&
D.domNode.classList.add(H)});!this.favoritesDisabled&&0<l["default"](".js-favorites-container",this.domNode).length&&(this.favorite=V.render(V.h(N["default"],{item:this.item}),this.domNode.querySelector(".js-favorites-container")));if(0<l["default"](".js-open-dropdown-container",this.domNode).length){var I=this.domNode.querySelector(".js-open-dropdown-container"),R=p["default"].substitute(C["default"],{item:this.item,i18n:z["default"],icons:t["default"]},null,this);b["default"].place(R,I);(null===
(K=this.item.portal)||void 0===K?0:K.isPortal)&&w["default"].hideNodes(I.querySelectorAll(".js-hide-portal"))}K=this.item;I=this.portalUser;R=this.allowShare;var A=this.telemetry,B=this.showShareGroups;(null===(G=this.item)||void 0===G?0:G.classification)&&new g["default"]({item:K,portalUser:I,showShareGroups:B,allowShare:R,telemetry:A},this.domNode.querySelector(".js-share-summary"));if("Feature Service"===K.type||"Feature Collection"===K.type)G=this.domNode.querySelector(".js-layers-tables"),R=
this.domNode.querySelector(".js-layers-tables-toggle"),G&&R&&f["default"].deepLayerSearchEnabled&&w["default"].createElement("arcgis-layers-and-tables-summary-popup",{item:K,layers:K.sublayers,portal:K.portal,api:3,user:I,searchTerm:this.searchTerm,config:f["default"],telemetry:this.telemetry,tooltip:this.formatDisplayName(K.displayName),i18nNoService:z["default"].publishWizard.errors.selectedServiceNotExist.message,i18nNoLayers:z["default"].SelectLayersWFS.noLayers},G).appendChild(R);this._addEventListeners()};
J.prototype.destroy=function(){this.inherited(arguments);this._popup&&this._popup.destroy();this.favorite&&V.render(null,this.domNode.querySelector(".js-favorites-container"),this.favorite)};J.prototype._addEventListeners=function(){var D;this.own(l["default"](".js-table-select-checkbox",this.domNode).on("change",this._toggleSelected.bind(this)),l["default"](".js-card-item-owner",this.domNode).on("click",this._showProfile.bind(this)),l["default"](".js-action",this.domNode).on("click",this._handleAction.bind(this)),
l["default"](".js-item-share-dropdown",this.domNode).on("click",this._shareItemDropdown.bind(this)),l["default"](".js-item-categorize",this.domNode).on("click",this._categorizeItem.bind(this)),a["default"].subscribe("view/deselectAll",this._deselect.bind(this)),a["default"].subscribe("view/items/"+this.item.id+"/deselect",this._deselect.bind(this)));var K=this.domNode.querySelector(".js-verified-owner-link");K&&this.own(r["default"](K,"click",this.showOrgPopup.bind(this)));(null===(D=this.item)||
void 0===D?0:D.watch)&&this.own(this.item.watch(this._itemUpdate.bind(this)))};J.prototype._handleAction=function(D){var K=this;D.preventDefault();var G=D.target.getAttribute("data-action");if(G&&v["default"][G]&&("share"!==G||!this.checkReadonly(this.item.portal))){var I={evt:D,item:this.item,user:this.portalUser,portal:this.item.portal,telemetry:this.telemetry};if("share"!==G||this.item.isOwner)v["default"][G](I);else this.item.getOwnerProfile(!0,!0).then(function(R){K.item.itemOwner=R;v["default"].share(I)})}};
J.prototype.selectItem=function(){this.domNode.classList.add("table-select-row-active");this.item.isSelected=!0;this.domNode.querySelector(".js-table-select-checkbox").checked=!0};J.prototype._select=function(){this.selectItem();a["default"].publish("view/select",this.item)};J.prototype._deselect=function(){this.domNode.classList.remove("table-select-row-active");this.item.isSelected=!1;this.domNode.querySelector(".js-table-select-checkbox").checked=!1;a["default"].publish("view/deselect",this.item)};
J.prototype._toggleSelected=function(){var D;if(this.domNode.classList.contains("table-select-row-active")){var K="Unselect row";this._deselect()}else K="Select row",this._select();this.recordSelection&&(null===(D=this.telemetry)||void 0===D?void 0:D.logEvent({category:"Select",action:K,count:1}))};J.prototype._itemUpdate=function(D,K,G){a["default"].publish("item/update",{item:this.item,name:D,oldValue:K,value:G})};J.prototype._showProfile=function(D){a["default"].publish("profile/show",D)};J.prototype.showOrgPopup=
function(D){D.stopPropagation();(new O["default"]({item:this.item,opener:D.target})).open()};J.prototype._shareItemDropdown=function(D){this.domNode.querySelector(".js-item-share-dropdown").blur()};J.prototype._categorizeItem=function(D){a["default"].publish("item/categorize",this.item,this.domNode.querySelector(".js-dropdown-toggle"))};return J=q.__decorate([F["default"](c["default"],d["default"],x["default"])],J)}()})},"arcgisonline/pages/components/Favorite":function(){define("require exports tslib preact dojo/i18n!../../nls/arcgisonline dojo/topic ../../sharing/geow/Content arcgisonline/sharing/dijit/dialog/GeneralDlg arcgisonline/pages/pageUtil".split(" "),
function(e,U,q,b,l,p,r,a,c){Object.defineProperty(U,"__esModule",{value:!0});l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);e=function(d){function h(){var f=null!==d&&d.apply(this,arguments)||this;f.buttonRef=b.createRef();f.handleClick=function(g){var n=f.state.isFavorite,m=f.props.item;f.checkReadonly(m.portal)||(f.setState(function(t){return{isFavorite:!t.isFavorite}}),m.set("isFavorite",n),(n?r["default"].removeFromFavorites(m):
r["default"].addToFavorites(m)).then(function(){f.buttonRef.current.blur()},function(t){p["default"].publish("alert/show",{type:"error",text:null===t||void 0===t?void 0:t.message});f.setState(function(w){return{isFavorite:!w.isFavorite}});m.set("isFavorite",n)}))};return f}q.__extends(h,d);h.prototype.componentDidMount=function(){this.setState({isFavorite:this.props.item.isFavorite})};h.prototype.checkReadonly=function(f){return(null===f||void 0===f?0:f.isPortal)&&f.isReadOnly?(c["default"].createSpecifiedDialog(a["default"]).show({title:l["default"].common.errorTitle,
message:l["default"].common.errors.portalInReadOnlyModeMsg}),!0):!1};h.prototype.render=function(){var f=this.state.isFavorite;return b.h("span",null,b.h("button",{onClick:this.handleClick,ref:this.buttonRef,role:"checkbox","aria-label":l["default"].common.favorite,"aria-checked":f?"true":"false","class":"favorites__button position-relative card-action "+(f?"btn-link-yellow":"")},b.h("calcite-icon",{icon:f?"star-f":"star",scale:"s"}),b.h("span",{"aria-hidden":"true","class":"favorites__tooltip"},
f?l["default"].common.unfavorite:l["default"].common.favorite)))};return h}(b.Component);U["default"]=e})},"arcgisonline/pages/utils/dropdown":function(){define(["require","exports","tslib","calcite-web/js/calcite-web","dojo/query"],function(e,U,q,b,l){Object.defineProperty(U,"__esModule",{value:!0});U.dropdown=void 0;b=q.__importDefault(b);l=q.__importDefault(l);U.dropdown=function(){b["default"].dropdown();l["default"](".dropdown-link").on("mouseover",function(p){var r;null===(r=p.target)||void 0===
r?void 0:r.focus()})}})},"arcgisonline/pages/components/SearchFeedback":function(){define("require exports tslib preact dojo/i18n!../../nls/arcgisonline preact/hooks".split(" "),function(e,U,q,b,l,p){Object.defineProperty(U,"__esModule",{value:!0});U.SearchFeedback=void 0;l=q.__importDefault(l);U.SearchFeedback=function(r){var a=r.telemetry,c=r.searchTerm,d=r.page,h=r.onlyOrg,f=r.section,g=r.enriched,n=r.onSubmit,m=p.useState(1);r=m[0];var t=m[1];m=p.useState({dontSee:!1,irrelevant:!1,filters:!1,
notEnoughInfo:!1});var w=m[0],u=m[1];h=f+" "+(h?"org only":"all");f=p.useState("");var v=f[0],x=f[1],y={category:"search result page feedback "+(1===r?"1":"2"),pageName:h,statusCode:g?"enriched":"not enriched",pageUrl:window.location.href,number:Math.ceil(d.start/d.num),searchquery:c};return b.h("div",null,1===r&&b.h("div",{"class":"leader-1 trailer-1 panel panel-white padding-leader-1 padding-trailer-1 padding-left-1 padding-right-1 flex flex-center"},b.h("div",{"class":"flex-1"},b.h("h4",{"class":"font-size-0 text-black avenir-demi trailer-quarter"},
l["default"].searchFeedback.areTheseResultsHelpful),b.h("p",{"class":"text-off-black font-size--2 trailer-0"},l["default"].searchFeedback.helpUsImprove)),b.h("calcite-button",{"icon-start":"thumbs-up",appearance:"outline","class":"padding-left-1",onClick:function(){a.logEvent(q.__assign(q.__assign({},y),{label:"yes"}));t(3);n()}},l["default"].searchFeedback.helpful),b.h("calcite-button",{appearance:"outline","icon-start":"thumbs-down","class":"padding-left-1",onClick:function(){a.logEvent(q.__assign(q.__assign({},
y),{label:"no"}));t(2)}},l["default"].searchFeedback.notHelpful)),2===r&&b.h("div",{"class":"trailer-1 panel panel-white padding-leader-1 padding-trailer-1 padding-left-1 padding-right-1"},b.h("h4",{"class":"font-size-0 text-black avenir-demi trailer-0"},l["default"].searchFeedback.whatMakes),b.h("p",{"class":"text-off-black font-size--2 trailer-half"},l["default"].searchFeedback.selectAllThatApply),Object.keys(w).map(function(C){return b.h("calcite-chip",{"class":"margin-right-half trailer-half",
value:C,appearance:w[C]?"solid":"clear",color:w[C]?"blue":"grey",onClick:function(){var z;u(q.__assign(q.__assign({},w),(z={},z[C]=!w[C],z)))}},l["default"].searchFeedback[C])}),b.h("div",{"class":"leader-1"},b.h("calcite-label",null,b.h("span",{"class":"display-block padding-trailer-half"},l["default"].searchFeedback.tellUsMore),b.h("calcite-input",{type:"textarea",maxLength:250,oncalciteInputInput:function(C){return x(C.detail.value)}})),b.h("div",{"class":"flex flex-end trailer-1"},b.h("span",
{"class":"font-size--2 text-darker-gray"},v.length," / ",250))),b.h("div",{"class":"flex flex-end"},b.h("calcite-button",{appearance:"outline",color:"blue",onClick:function(){t(3);n()},"class":"margin-right-quarter"},l["default"].searchFeedback.close),b.h("calcite-button",{appearance:"solid",color:"blue",onClick:function(){t(3);Object.keys(w).filter(function(C){return w[C]}).forEach(function(C){a.logEvent(q.__assign(q.__assign({},y),{label:C}))});v&&a.logEvent(q.__assign(q.__assign({},y),{details:v,
label:"other"}));n()}},l["default"].searchFeedback.sendFeedback))),3===r&&b.h("calcite-alert",{label:l["default"].searchFeedback.thankYou,active:!0,color:"green",icon:"check-circle",scale:"m","intl-close":"Close"},b.h("div",{slot:"title"},l["default"].searchFeedback.thankYou)))}})},"arcgisonline/pages/utils/search":function(){define(["require","exports","tslib","arcgisonline/esriGeowConfig"],function(e,U,q,b){Object.defineProperty(U,"__esModule",{value:!0});U.separateFilterFromQuery=U.semanticSearchEnabled=
void 0;b=q.__importDefault(b);U.semanticSearchEnabled=function(l,p){var r;return!!(b["default"].semanticSearchEnabled&&(null===(r=null===l||void 0===l?void 0:l.portalProperties)||void 0===r?0:r.semanticSearchEnabled))||p&&!p.orgId};U.separateFilterFromQuery=function(l){var p=/(tags:".+?")/gi;p=null===l||void 0===l?void 0:l.match(p);null===p||void 0===p?void 0:p.forEach(function(r){l=l.replace(new RegExp(r),"")});return{q:l,filter:(null===p||void 0===p?void 0:p.join(" "))||""}}})},"arcgisonline/pages/dijit/AttributeFieldDetails":function(){define("require exports tslib ../../esriGeowConfig ./DomainOverlay ./InlineEdit ../utils/arrays ../utils/clone ../utils/dom ../utils/icons ../../sharing/util ../../sharing/dijit/dialog/_CreateItemUtilMixin dijit/_TemplatedMixin dijit/_WidgetBase dijit/registry dojo/_base/event dojo/dom-construct dojo/on dojo/topic dojo/Deferred dojo/dom-form esri/Evented esri/layers/CodedValueDomain esri/layers/RangeDomain dojo/i18n!../../nls/arcgisonline dojo/text!./AttributeFieldDetails/templates/AttributeFieldDetails.html ../../tsutils/declareDecorator".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);y=q.__importDefault(y);C=q.__importDefault(C);
z=q.__importDefault(z);F=q.__importDefault(F);O=q.__importDefault(O);V=q.__importDefault(V);N=q.__importDefault(N);return function(){function J(D,K){this.templateString=V["default"];this.i18n=O["default"];this.icons=d["default"];this.fieldValueTypeList={fieldValueType:[{title:"nameOrTitle"},{title:"description"},{title:"typeOrCategory"},{title:"countOrAmount"},{title:"percentageOrRatio"},{title:"measurement"},{title:"currency"},{title:"uniqueIdentifier"},{title:"phoneNumber"},{title:"emailAddress"},
{title:"orderedOrRanked"},{title:"binary"},{title:"locationOrPlaceName"},{title:"coordinate"},{title:"dateAndTime"},{title:"none"}]}}J.prototype.startup=function(D,K,G,I){var R;this.inherited(arguments);this.item=D;this.layer=K;this.layerInfos=I;this.clickedFieldName=G;this.currentSettingsField=null;this.updateAttributeView=!1;this.descriptionDocUrl=b["default"].self?b["default"].self.helpBase+b["default"].self.helpMap.m["120001692"]:"";this.fieldValueTypeText.innerHTML=this.i18n.attributeFieldDetails.fieldValueType+
"\x3ca href\x3d"+this.descriptionDocUrl+' target\x3d"_blank" title\x3d"'+this.i18n.common.help+'"\x3e\x3ci class\x3d"icon-ui-question margin-left-half font-size--1"\x3e\x3c/i\x3e\x3c/a\x3e';this.initUI();this.item.portal.isPortal&&r["default"].includes(this.item.typeKeywords,"View Service")&&(null===(R=this.domNode.querySelector(".js-portal-view"))||void 0===R?void 0:R.classList.add("hide"))};J.prototype.initUI=function(){this.displayValuesInTable();this.displayIndexValuesInTable();this.addEventListeners()};
J.prototype.addEventListeners=function(){var D=this;this.own(u["default"](this.domNode.querySelector(".js-close-attribute-details"),"click",function(K){t["default"].stop(K);v["default"].publish("attributeFieldDetails/closeDetails",D.updateAttributeView)}),u["default"](this.domNode.querySelector(".js-delete-btn"),"click",function(K){t["default"].stop(K);v["default"].publish("attributeFieldDetails/deleteField",{name:D.clickedFieldName})}),u["default"](this.domNode.querySelector(".js-domain-btn"),"click",
function(K){var G;t["default"].stop(K);(null===(G=D.currentSettingsField)||void 0===G?0:G.hasIndex)?v["default"].publish("alert/show",{type:"error",text:O["default"].attributeFieldDetails.codedValueOnUniqueIndexMessage}):(new l["default"]({item:D.item,layer:D.layer,clickedFieldName:D.clickedFieldName,domainType:"Coded"},w["default"].place(w["default"].create("div"),document.body,"last"))).open()}),u["default"](this.domNode.querySelector(".js-domain-edit"),"click",function(K){t["default"].stop(K);
(new l["default"]({item:D.item,layer:D.layer,clickedFieldName:D.clickedFieldName,domainType:"Coded"},w["default"].place(w["default"].create("div"),document.body,"last"))).open()}),u["default"](this.domNode.querySelector(".js-range-domain-edit"),"click",function(K){t["default"].stop(K);K={item:D.item,layer:D.layer,clickedFieldName:D.clickedFieldName,domainType:"Range"};var G=document.createElement("div");document.body.appendChild(G);(new l["default"](K,G)).open()}),v["default"].subscribe("domainOverlay/updateDomain",
this.displayDomainValues.bind(this)),u["default"](this.domNode.querySelector(".js-index-form"),"change",function(K){t["default"].stop(K);K=D.serviceIndexEdit.checked;D.domNode.querySelector(".js-index-form-submit").disabled=D.currentSettingsField.hasIndex&&!K?!1:!D.currentSettingsField.hasIndex&&K?!1:!0}),u["default"](this.domNode.querySelector(".js-editable-form"),"change",function(K){t["default"].stop(K);if(K=D.domNode.querySelector(".js-editable-form-submit"))K.disabled=!1}),u["default"](this.domNode.querySelector(".js-details-reset-btn"),
"click",function(K){t["default"].stop(K);D.updateStuff(null,"resetToSource").then(function(){D.displayValuesInTable()})}),v["default"].subscribe("inlineEdit/submit",function(K){var G=K.prop;delete K.prop;D.updateStuff(K,G).then(function(){D.showDetailsProperties();v["default"].publish("attributeFieldDetails/updateFieldOnlyTable",!0);v["default"].publish("inlineEdit/"+G+"/done",K[G])})}));c["default"].forEachNode(this.domNode.querySelectorAll(".js-old-inline-edit"),function(K){D.own(u["default"](K,
"click",function(G){var I,R,A,B;t["default"].stop(G);G=G.target.dataset.editId;var H=D.domNode.querySelector("[data-edit-id\x3d'"+G+"'].js-inline-edit-form");H=m["default"].findWidgets(H).shift()||(null===(R=null===(I=H.children)||void 0===I?void 0:I[0])||void 0===R?void 0:R.children[0])&&H.children[0].children[0][0]||(null===(B=null===(A=H.children)||void 0===A?void 0:A[0])||void 0===B?void 0:B.children[0])&&H.children[0][0];c["default"].forEachNode(D.domNode.querySelectorAll("[data-edit-id\x3d'"+
G+"'].js-inline-edit-form"),function(T){T.classList.remove("hide")});c["default"].forEachNode(D.domNode.querySelectorAll("[data-edit-id\x3d'"+G+"'].js-old-inline-edit"),function(T){T.classList.add("hide")});H&&H.focus()}))});c["default"].forEachNode(this.domNode.querySelectorAll(".js-cancel-inline-edit"),function(K){D.own(u["default"](K,"click",function(G){t["default"].stop(G);G=(G.target.form||G.target.closest("form").shift()).dataset.editId;D.cancelInlineEdit(G)}))});c["default"].forEachNode(this.domNode.querySelectorAll(".js-inline-edit-form"),
function(K){D.own(u["default"](K,"submit",function(G){t["default"].stop(G);G=G.target;var I=y["default"].toObject(G),R=G.dataset.editId;(m["default"].findWidgets(G)||[]).forEach(function(A){I[R]=A.get("value")});D.updateStuff(I,R).then(function(){D.displayValuesInTable();D.cancelInlineEdit(R);"serviceIndex"===R&&D.displayIndexValuesInTable()})}))})};J.prototype.updateStuff=function(D,K){var G=this,I,R,A=new x["default"],B=this.item.adminUrl+"/"+this.layer.layerId;if("serviceAlias"===K||"description"===
K||"fieldValueType"===K||"fieldEditable"===K||"resetToSource"===K){var H={fields:[a["default"](this.currentSettingsField)]};"serviceAlias"===K?H.fields[0].alias=D.serviceAlias:"fieldEditable"===K?(c["default"].forEachNode(this.domNode.querySelectorAll("[data-edit-id\x3d'fieldEditable'].js-inline-edit-form"),function(M){M.classList.add("hide")}),H.fields[0].editable=this.fieldEditableEdit.checked):"resetToSource"===K?H={fields:[{name:this.currentSettingsField.name,isViewOverride:!1}]}:("description"===
K?D.fieldValueType=(null===(I=this.currentSettingsField.description)||void 0===I?0:I.fieldValueType)?this.currentSettingsField.description.fieldValueType:"":("fieldValueType"===K&&"none"===D.fieldValueType&&(D.fieldValueType=""),D.description=(null===(R=this.currentSettingsField.description)||void 0===R?0:R.value)?this.currentSettingsField.description.value:""),H.fields[0].description={value:D.description,fieldValueType:D.fieldValueType});B+="/updateDefinition";I={updateDefinition:JSON.stringify(H),
async:!1};h["default"].request({url:B,content:I},{usePost:!0}).then(function(){G.item.set("maxAgeCheck",!0);r["default"].includes(G.item.typeKeywords,"View Service")&&(G.currentSettingsField.isViewOverride=!0);"serviceAlias"===K?G.currentSettingsField.alias=D.serviceAlias:"fieldEditable"===K?G.currentSettingsField.editable=G.fieldEditableEdit.checked:"resetToSource"===K?G.currentSettingsField.isViewOverride=!1:(G.currentSettingsField.description={value:D.description,fieldValueType:D.fieldValueType},
G.showHideDescriptionAndFieldValueType());G.updateAttributeView=!0;"serviceAlias"===K||"fieldEditable"===K?G.updatePopupData().then(function(){A.resolve()},function(M){A.reject(M)}):"resetToSource"===K?h["default"].request({url:G.layer.url}).then(function(M){for(var L=0;L<M.fields.length;L++){var X=M.fields[L];if(X.name===G.currentSettingsField.name){G.currentSettingsField.alias=X.alias;G.currentSettingsField.editable=X.editable;if(X.domain&&"codedValue"===X.domain.type){var ba=new z["default"];ba.type=
"codedValue";ba.name=X.domain.name;ba.codedValues=[];for(var ma=0;ma<X.domain.codedValues.length;ma++)ba.codedValues.push({code:X.domain.codedValues[ma].code,name:X.domain.codedValues[ma].name});G.currentSettingsField.domain=ba}else X.domain&&"range"===X.domain.type?(ba=new F["default"],ba.type="range",ba.name=X.domain.name,ba.minValue=Number(X.domain.range[0]),ba.maxValue=Number(X.domain.range[1]),G.currentSettingsField.domain=ba):G.currentSettingsField.domain=X.domain;G.currentSettingsField.description=
G.getDescription(X.description);G.titleEdit.updateValue(G.currentSettingsField.alias||G.currentSettingsField.name);G.descriptionSection.updateValue(G.currentSettingsField.description&&G.currentSettingsField.description.value||"");G.fieldValueTypeSection.updateValue(G.currentSettingsField.description&&G.currentSettingsField.description.fieldValueType||"");v["default"].publish("attributeFieldDetails/updateFieldOnlyTable",!0);G.updateAttributeView=!0;G.updatePopupData().then(function(){A.resolve()},
function(ta){A.reject(ta)})}}},function(M){A.reject(M)}):A.resolve()},function(M){A.reject(M)})}else if("serviceIndex"===K){c["default"].forEachNode(this.domNode.querySelectorAll("[data-edit-id\x3d'serviceIndex'].js-inline-edit-form"),function(M){M.classList.add("hide")});var T=this.serviceIndexEdit.checked;this.serviceIndex.innerHTML=T?this.i18n.itemProperties.createUniqueIndex:this.i18n.itemProperties.deleteUniqueIndex;B=this.generateIndexJsonParameters(T);this.buildOrDeleteIndex(T,B).then(function(){setTimeout(function(){G.item.set("maxAgeCheck",
!0);v["default"].publish("alert/show",{type:"success",text:G.i18n.itemProperties.createindexSuccess});G.currentSettingsField.hasIndex=T;A.resolve()},1E3)},function(M){setTimeout(function(){v["default"].publish("alert/show",{type:"error",text:G.i18n.itemProperties.error.indexFailure})},1E3)})}return A};J.prototype.getDescription=function(D){return D?(D=JSON.parse(D),{value:D.value||"",fieldValueType:D.fieldValueType||""}):{value:"",fieldValueType:""}};J.prototype.buildOrDeleteIndex=function(D,K){var G=
new x["default"],I=this.item.adminUrl+"/"+this.layer.layerId;if(!D&&this.item.portal.isPortal){I+="/deleteFromDefinition";var R={deleteFromDefinition:JSON.stringify(K),async:!1};h["default"].request({url:I,content:R},{usePost:!0}).then(function(){G.resolve()},function(A){G.reject(A)})}else D?(I+="/addToDefinition",R={addToDefinition:JSON.stringify(K),async:!0}):(I+="/deleteFromDefinition",R={deleteFromDefinition:JSON.stringify(K),async:!0}),h["default"].request({url:I,content:R},{usePost:!0}).then(this.checkStatus.bind(this),
function(A){G.reject(A)}).then(function(A){G.resolve(A)});return G};J.prototype.checkStatus=function(D,K,G){var I=this,R=(null===D||void 0===D?void 0:D.statusURL)||(null===D||void 0===D?void 0:D.statusUrl),A=G||new x["default"],B=K||500;h["default"].request({url:R}).then(function(H){var T,M;H=H||{status:"completed"};"completed"===(null===(T=H.status)||void 0===T?void 0:T.toLowerCase())?A.resolve(!0):"failed"===(null===(M=H.status)||void 0===M?void 0:M.toLowerCase())||400<H.code||""===H.status?A.reject(H):
(B=(B||500)+250,setTimeout(function(){I.checkStatus(D,B,A)},K))},function(H){setTimeout(function(){v["default"].publish("alert/show",{type:"error",text:I.i18n.itemProperties.error.indexFailure});I.displayIndexValuesInTable();I.cancelInlineEdit("serviceIndex");A.reject(H)},1E3)});return A};J.prototype.generateIndexJsonParameters=function(D){var K=this.currentSettingsField,G=this.layer.indexes,I={indexes:[]},R={};if(D)R.name=K.name+"_Index",R.fields=K.name,R.isUnique=!0;else for(D=0;D<G.length;D++){if(G[D].fields===
K.name){R.name=G[D].name;break}D!==G.length-1||R.name||(R.name=K.name+"_Index")}I.indexes[0]=R;return I};J.prototype.showHideDescriptionAndFieldValueType=function(){if(this.currentSettingsField.description){var D=this.domNode.querySelector(".js-fieldDescription"),K=this.domNode.querySelector(".js-noFieldDescription"),G=this.domNode.querySelector(".js-fieldValueType"),I=this.domNode.querySelector(".js-noFieldValueType");this.currentSettingsField.description.value?(null===D||void 0===D?void 0:D.classList.remove("hide"),
null===K||void 0===K?void 0:K.classList.add("hide")):(null===K||void 0===K?void 0:K.classList.remove("hide"),null===D||void 0===D?void 0:D.classList.add("hide"));this.currentSettingsField.description.fieldValueType?(null===G||void 0===G?void 0:G.classList.remove("hide"),null===I||void 0===I?void 0:I.classList.add("hide")):(null===I||void 0===I?void 0:I.classList.remove("hide"),null===G||void 0===G?void 0:G.classList.add("hide"))}};J.prototype.showDetailsProperties=function(){if(!this.item.portal.isPortal&&
this.item.isHostedService&&(this.item.isAdmin||this.item.isOwner)&&r["default"].includes(this.item.typeKeywords,"View Service")){var D=this.domNode.querySelector(".js-details-reset-btn");c["default"].forEachNode(this.domNode.querySelectorAll(".js-details-properties"),function(K){K.classList.remove("hide")});this.currentSettingsField.isViewOverride?(null===D||void 0===D?void 0:D.classList.remove("hide"),this.detailsProperties.innerHTML=O["default"].attributeFieldDetails.overridden,this.detailsPropertiesInfo.setAttribute("aria-label",
O["default"].attributeFieldDetails.overriddenMessage)):(null===D||void 0===D?void 0:D.classList.add("hide"),this.detailsProperties.innerHTML=O["default"].attributeFieldDetails.inherited,this.detailsPropertiesInfo.setAttribute("aria-label",O["default"].attributeFieldDetails.inheritedMessage))}};J.prototype.displayValuesInTable=function(){var D=this;this.currentSettingsField=r["default"].find(this.layer.fields,function(K){return K.name===D.clickedFieldName});this.showHideDescriptionAndFieldValueType();
this.titleEdit||(this.titleEdit=new p["default"]({prop:"serviceAlias",value:this.currentSettingsField.alias?this.currentSettingsField.alias:this.clickedFieldName,required:!0,pattern:"^[^\x3c|\x3e]+$",emptyText:O["default"].itemProperties.error.needTitle,invalidText:O["default"].itemProperties.error.badCharacter,inputClass:"input-minimal flex-1 font-size-3",titleClass:"font-size-3 trailer-0",titleId:"attributeTitle",editButtonClasses:"btn-link-darker-gray focus-inset field-admin-owner-view js-portal-view",
cancelButtonClasses:"btn btn-transparent",saveButtonClasses:"btn",showLoader:h["default"].isPortal()},w["default"].create("div",{},this.domNode.querySelector(".js-attribute-title-edit"))));this.setupAllStuff();this.showDetailsProperties();this.serviceNullable.innerHTML=this.currentSettingsField.nullable?O["default"].attributeFieldDetails.commonYes:O["default"].attributeFieldDetails.commonNo;this.fieldEditable.innerHTML=this.currentSettingsField.editable?O["default"].attributeFieldDetails.commonYes:
O["default"].attributeFieldDetails.commonNo;this.serviceDefaultValue.innerHTML=this.getDefaultValue(this.currentSettingsField);this.serviceLength.innerHTML=this.currentSettingsField.length?this.currentSettingsField.length:O["default"].attributeFieldDetails.none;this.rangeMinMax.innerHTML=O["default"].attributeFieldDetails.none;this.detailsType.innerHTML=this.getFieldType(this.currentSettingsField.type);this.detailsName.innerHTML=this.currentSettingsField.name;this.currentSettingsField.domain&&this.displayDomainValues()};
J.prototype.getDefaultValue=function(D){return D.defaultValue||0===D.defaultValue?"esriFieldTypeDate"===D.type?new Date(D.defaultValue):D.defaultValue:O["default"].attributeFieldDetails.none};J.prototype.getFieldType=function(D){D=D||this.i18n.attributesView.commonUndefined;return this.i18n.attributesView.fieldTypes[D]||D};J.prototype.displayIndexValuesInTable=function(){var D=this;this.domNode.querySelector(".js-index-form-submit").disabled=!0;this.currentSettingsField&&void 0===this.currentSettingsField.hasIndex&&
(this.currentSettingsField.hasIndex=!1,this.currentSettingsField.hasIndex=!!r["default"].find(this.layer.indexes,function(K){return K.fields===D.clickedFieldName&&K.isUnique}));this.serviceIndex.innerHTML=this.currentSettingsField.hasIndex?O["default"].attributeFieldDetails.commonYes:O["default"].attributeFieldDetails.commonNo;this.serviceIndexEdit.checked=this.currentSettingsField.hasIndex};J.prototype.setupAllStuff=function(){var D;this.setupDescriptionAndFieldValueType();this.currentSettingsField.canDeleteField||
(null===(D=this.domNode.querySelector(".js-delete-btn"))||void 0===D?void 0:D.classList.add("hide"));D=this.domNode.querySelector("[data-edit-id\x3d'serviceIndex'].js-old-inline-edit");this.currentSettingsField.canDeleteField?null===D||void 0===D?void 0:D.classList.remove("hide"):null===D||void 0===D?void 0:D.classList.add("hide");D=this.domNode.querySelector("[data-edit-id\x3d'fieldEditable'].js-old-inline-edit");this.currentSettingsField.canFieldEditableProp?(null===D||void 0===D?void 0:D.classList.remove("hide"),
this.fieldEditableEdit.checked=this.currentSettingsField.editable):null===D||void 0===D?void 0:D.classList.add("hide");this.setupDomains()};J.prototype.setupDescriptionAndFieldValueType=function(){var D;this.layer.supportsFieldDescription?(this.descriptionSection=new p["default"]({inputType:"textArea",rows:4,maxLength:500,inputLabel:this.i18n.attributeFieldDetails.editDescription,prop:"description",editButtonUpdatePermissionClasses:"field-admin-owner-view js-portal-view",value:this.currentSettingsField.description&&
this.currentSettingsField.description.value||"",pattern:"^[^\x3c\x3e]*$",invalidText:this.i18n.itemProperties.error.badCharacterSnippet,showCharactersLeft:!0,showLoader:h["default"].isPortal()},this.domNode.querySelector(".js-description-section")),this.fieldValueTypeSection=new p["default"]({inputType:"fieldValueType",inputLabel:this.i18n.attributeFieldDetails.editFieldValueType,editButtonUpdatePermissionClasses:"field-admin-owner-view js-portal-view",prop:"fieldValueType",value:(null===(D=this.currentSettingsField.description)||
void 0===D?void 0:D.fieldValueType)||"",fieldValueTypeList:this.fieldValueTypeList,showLoader:h["default"].isPortal()},this.domNode.querySelector(".js-fieldValueType-section"))):c["default"].forEachNode(this.domNode.querySelectorAll(".js-description-section, .js-fieldValueType-section"),function(K){K.classList.add("hide")})};J.prototype.setupDomains=function(){var D,K;if(this.ifShowDomainEditingButtons()){var G=this.currentSettingsField.type;/string|integer|double|single/g.test(G.toLowerCase())&&
(null===(D=this.domNode.querySelector(".js-domain-btn"))||void 0===D?void 0:D.classList.remove("hide"));/integer|double|single/g.test(G.toLowerCase())&&(null===(K=this.domNode.querySelector(".js-range-field-details"))||void 0===K?void 0:K.classList.remove("hide"))}};J.prototype.ifShowDomainEditingButtons=function(){return this.currentSettingsField.canDeleteField&&!r["default"].includes(this.item.typeKeywords,"Spatiotemporal")};J.prototype.displayDomainValues=function(){var D,K,G;if(this.currentSettingsField.domain&&
"range"===this.currentSettingsField.domain.type)c["default"].forEachNode(this.domNode.querySelectorAll(".js-domain-btn, .js-coded-value-field-details"),function(R){R.classList.add("hide")}),null===(D=this.domNode.querySelector(".js-range-field-details"))||void 0===D?void 0:D.classList.remove("hide"),this.rangeMinMax.innerHTML=this.currentSettingsField.domain.minValue+" - "+this.currentSettingsField.domain.maxValue;else if(this.currentSettingsField.domain&&"codedValue"===this.currentSettingsField.domain.type){c["default"].forEachNode(this.domNode.querySelectorAll(".js-domain-btn, .js-range-field-details"),
function(R){R.classList.add("hide")});null===(K=this.domNode.querySelector(".js-coded-value-field-details"))||void 0===K?void 0:K.classList.remove("hide");this.codedValueDomainText.innerHTML=O["default"].attributeFieldDetails.codedValueDomain+" \x3csmall\x3e"+O["default"].attributeFieldDetails.domainSmall+"\x3c/small\x3e";for(var I=this.domNode.querySelector(".js-coded-value-table");0<I.rows.length;)I.deleteRow(0);this.currentSettingsField.domain.codedValues.forEach(function(R){I.insertRow(I.rows.length).insertCell(0).innerHTML=
R.name})}else this.currentSettingsField.domain||(null===(G=this.domNode.querySelector(".js-coded-value-field-details"))||void 0===G?void 0:G.classList.add("hide"),this.rangeMinMax.innerHTML=O["default"].attributeFieldDetails.none,this.setupDomains())};J.prototype.cancelInlineEdit=function(D){D?(c["default"].forEachNode(this.domNode.querySelectorAll("[data-edit-id\x3d'"+D+"'].js-inline-edit-form"),function(K){K.classList.add("hide")}),c["default"].forEachNode(this.domNode.querySelectorAll("[data-edit-id\x3d'"+
D+"'].js-old-inline-edit"),function(K){K.classList.remove("hide")})):(c["default"].forEachNode(this.domNode.querySelectorAll(".js-inline-edit-form"),function(K){K.classList.add("hide")}),c["default"].forEachNode(this.domNode.querySelectorAll(".js-old-inline-edit"),function(K){K.classList.remove("hide")}))};J.prototype.getPopupInfo=function(){var D=this.layer.id||this.layer.layerId;if(this.layerInfos&&0<this.layerInfos.length)for(var K=0;K<this.layerInfos.length;K++)if(D===this.layerInfos[K].id)return this.layerInfos[K].popupInfo;
return null};J.prototype.updatePopupData=function(){var D=this,K=new x["default"],G=this.getPopupInfo();if(G){for(var I=0;I<G.fieldInfos.length;I++)if(G.fieldInfos[I].fieldName===this.currentSettingsField.name){G.fieldInfos[I].label=this.currentSettingsField.alias;G.fieldInfos[I].isEditable=this.currentSettingsField.editable;break}G=this.item;G={owner:G.owner,folderId:G.folderId,id:G.id,text:JSON.stringify({layers:this.layerInfos})};f["default"].updateItem(G,this.item.portal).then(function(){D.updateItemData().then(function(){K.resolve()})},
function(R){K.reject(R)})}else K.resolve();return K};J.prototype.updateItemData=function(){var D=this,K=new x["default"];h["default"].request({url:this.item.itemUrl+"/data"}).then(function(G){D.item.itemData=G;K.resolve()});return K};return J=q.__decorate([N["default"](n["default"],g["default"],C["default"])],J)}()})},"arcgisonline/pages/dijit/DomainOverlay":function(){define("require exports tslib dijit/registry dojo/_base/event dojo/dom-construct dojo/dom-form dojo/Deferred dojo/on dojo/query dojo/string dojo/topic dojox/uuid/generateRandomUuid ./Overlay ../utils/arrays ../utils/clone ../utils/dom ../utils/formatters ../utils/icons ../../sharing/util dragula/dragula esri/layers/CodedValueDomain esri/layers/RangeDomain dojo/i18n!../../nls/arcgisonline dojo/text!./DomainOverlay/templates/DomainOverlay.html dojo/text!./DomainOverlay/templates/CodedValueTemplate.html dojo/text!./DomainOverlay/templates/_generateOrDelete.html ../../tsutils/declareDecorator".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);y=q.__importDefault(y);C=q.__importDefault(C);
z=q.__importDefault(z);F=q.__importDefault(F);O=q.__importDefault(O);V=q.__importDefault(V);N=q.__importDefault(N);J=q.__importDefault(J);var D;(function(K){K.Coded="Coded";K.Range="Range"})(D||(D={}));return function(){function K(G,I){this.overlayContents=h["default"].substitute(O["default"],{i18n:F["default"],icons:v["default"]},null);this.showActionBar=!0;this.i18n=F["default"];this.icons=v["default"];this.unsavedChangesText=F["default"].domainOverlay.errors.unsavedChangesExplain;this.title=F["default"].domainOverlay.domainOverlayTitle;
this.validateInputDomainValue=this.validateInputDomainValue.bind(this)}K.prototype.postMixInProperties=function(){var G=this;this.inherited(arguments);this.domainType=this.domainType||D.Coded;this.currentField=m["default"].find(this.layer.fields,function(I){return I.name===G.clickedFieldName});this.domainType===D.Coded?this.title=F["default"].domainOverlay.domainOverlayTitle+": "+this.currentField.alias:this.domainType===D.Range&&(this.title=F["default"].domainOverlay.domainRangeOverlayTitle+": "+
this.currentField.alias)};K.prototype.postCreate=function(){var G=this;p["default"].place(h["default"].substitute(N["default"],{i18n:F["default"]}),this._overlayActionBar);this.inherited(arguments);this.codedValueCount=0;this.codedValueEvents=[];this.codedValueJson=[];this.submitButton=this._primaryBtn;this.submitButton.disabled=!0;this.disableAddButton(!0);this.setupDomainPage();this.domainType===D.Coded?d["default"](".js-domain-explanation",this.domNode).attr("innerHTML",this.currentField.domain?
F["default"].domainOverlay.editListPart1+"\x3cbr\x3e\x3cbr\x3e"+F["default"].domainOverlay.editListPart2:F["default"].domainOverlay.newEmptyListPart1+"\x3cbr\x3e\x3cbr\x3e"+F["default"].domainOverlay.newEmptyListPart2):d["default"](".js-domain-explanation",this.domNode).attr("innerHTML",(this.currentField.domain?F["default"].domainOverlay.editRange:F["default"].domainOverlay.newRange)+"\x3cbr\x3e\x3cbr\x3e"+F["default"].domainOverlay.rangePart2);var I=w["default"].nodeListToArray(d["default"](".js-manage-domain-coded-value",
this.domNode));this.drag=y["default"](I,{moves:function(R,A,B){return B.classList.contains("js-template-div")||B.classList.contains("js-template-code-value")||B.classList.contains("js-template-code-key")||B.classList.contains("js-template-code-count")},accepts:function(R,A,B,H){return A===B}});this.drag.on("drop",function(){G.setUnsaved(!0);G.validateInputDomainValue()})};K.prototype.render=function(){var G=this,I,R,A=new a["default"];(null===(R=null===(I=this.currentField)||void 0===I?void 0:I.domain)||
void 0===R?0:R.codedValues)?(this.loaderHelper(!0),this.layer.addPlugin("esri/plugins/FeatureLayerStatistics").then(function(){G.getUniqueValuesData(G.currentField).then(function(B){for(var H=0;H<G.currentField.domain.codedValues.length;H++)for(var T=G.currentField.domain.codedValues[H].count=0;T<B.uniqueValueInfos.length;T++)if(G.currentField.domain.codedValues[H].code===B.uniqueValueInfos[T].value){G.currentField.domain.codedValues[H].count=B.uniqueValueInfos[T].count;break}G.setupInitialDomainForm();
G.setupCodedValueEvents();G.loaderHelper(!1);G.domNode.querySelector(".js-template-code-value").focus();A.resolve()},function(B){G.loaderHelper(!1);f["default"].publish("alert/show",{type:"error",text:F["default"].domainOverlay.errors.domainRequestFailed});A.reject()})})):(this.setupInitialDomainForm(),this.setupCodedValueEvents(),this.domainType===D.Coded?setTimeout(function(){G.domNode.querySelector(".js-template-code-value").focus()},300):this.domainType===D.Range&&setTimeout(function(){G.domNode.querySelector(".js-template-range-key").focus()},
300),A.resolve());return A};K.prototype.setupDomainPage=function(){var G,I,R;this.domainType===D.Coded?(this.domNode.querySelector(".js-domain-generate-button").innerHTML=F["default"].domainOverlay.generateList,this.domNode.querySelector(".js-domain-delete-button").innerHTML=F["default"].domainOverlay.deleteList):this.domainType===D.Range&&(this.domNode.querySelector(".js-domain-generate-button").innerHTML=F["default"].domainOverlay.generateRange,this.domNode.querySelector(".js-domain-delete-button").innerHTML=
F["default"].domainOverlay.deleteRange);"range"===(null===(I=null===(G=this.currentField)||void 0===G?void 0:G.domain)||void 0===I?void 0:I.type)||(null===(R=this.currentField.domain)||void 0===R?0:R.codedValues)?this.domNode.querySelector(".js-domain-generate-button").classList.add("hide"):this.domNode.querySelector(".js-domain-delete-button").classList.add("hide")};K.prototype.getUniqueValuesData=function(G){return this.layer.statisticsPlugin.getUniqueValues({field:G.name})};K.prototype.getFieldStatisticsData=
function(G){return this.layer.statisticsPlugin.getFieldStatistics({field:G.name})};K.prototype._addEventListeners=function(){var G=this;this.inherited(arguments);this.own(c["default"](this.domNode.querySelector(".js-domain-generate-button"),"click",function(I){l["default"].stop(I);G.loaderHelper(!0);var R=t["default"](G.currentField);G.domNode.querySelector(".js-domain-generate-button").disabled=!0;G.layer.addPlugin("esri/plugins/FeatureLayerStatistics").then(function(){G.domainType===D.Coded?G.getUniqueValuesData(G.currentField).then(function(A){var B;
A.uniqueValueInfos.sort(function(T,M){return parseFloat(M.count)-parseFloat(T.count)});var H={name:(null===(B=G.currentField.domain)||void 0===B?0:B.name)?G.currentField.domain.name:G.currentField.name+"_Domain",type:"codedValue",codedValues:[]};for(B=0;B<A.uniqueValueInfos.length;B++)null!==A.uniqueValueInfos[B].value&&void 0!==A.uniqueValueInfos[B].value&&""!==A.uniqueValueInfos[B].value&&H.codedValues.push({code:A.uniqueValueInfos[B].value,name:A.uniqueValueInfos[B].value,count:A.uniqueValueInfos[B].count||
0});R.domain=H;G.setupInitialDomainForm(R);G.setupCodedValueEvents();G.setUnsaved(!0);G.validateInputDomainValue();G.loaderHelper(!1);A.partialData&&f["default"].publish("alert/show",{type:"warning",text:h["default"].substitute(F["default"].domainOverlay.ifPartialDataNote,[A.uniqueValueInfos.length])});0!==A.uniqueValueInfos.length&&(1!==A.uniqueValueInfos.length||null!==A.uniqueValueInfos[0].value&&""!==A.uniqueValueInfos[0].value)||f["default"].publish("alert/show",{type:"warning",text:F["default"].domainOverlay.generateListNoValues})},
function(A){G.loaderHelper(!1);f["default"].publish("alert/show",{type:"error",text:F["default"].domainOverlay.errors.domainRequestFailed})}):G.getFieldStatisticsData(G.currentField).then(function(A){var B;A={name:(null===(B=G.currentField.domain)||void 0===B?0:B.name)?G.currentField.domain.name:G.currentField.name+"_Domain",type:"range",minValue:A.min,maxValue:A.max};R.domain=A;G.setupInitialDomainForm(R);G.setupCodedValueEvents();G.setUnsaved(!0);G.validateInputDomainValue();G.loaderHelper(!1)},
function(A){G.loaderHelper(!1);f["default"].publish("alert/show",{type:"error",text:F["default"].domainOverlay.errors.domainRequestFailed})})})}),c["default"](this.domNode.querySelector(".js-domain-delete-button"),"click",function(I){l["default"].stop(I);if(confirm(F["default"].domainOverlay.errors.deleteExplain)){G.setUnsaved(!1);G.loaderHelper(!0);var R={fields:[t["default"](G.currentField)]};R.fields[0].domain=null;I=G.item.adminUrl+"/"+G.layer.layerId+"/updateDefinition";R={updateDefinition:JSON.stringify(R)};
x["default"].request({url:I,content:R},{usePost:!0}).then(function(){G.item.set("maxAgeCheck",!0);G.currentField.domain=null;f["default"].publish("domainOverlay/updateDomain");G.loaderHelper(!1);G.close();f["default"].publish("alert/show",{type:"success",text:G.domainType===D.Coded?F["default"].domainOverlay.deleteSuccessList:F["default"].domainOverlay.deleteSuccessRange})},function(A){G.loaderHelper(!1);f["default"].publish("alert/show",{type:"error",text:F["default"].domainOverlay.errors.domainRequestFailed})})}}))};
K.prototype.handlePrimary=function(G){var I=this;l["default"].stop(G);this.setUnsaved(!1);this.loaderHelper(!0,F["default"].domainOverlay.saveLoading);G=this.domNode.querySelector(".js-manage-domain-form");var R=G.dataset.editId,A=r["default"].toObject(G);(b["default"].findWidgets(G)||[]).forEach(function(T){A[R]=T.get("value")});var B=this.validateDomainAndReturnDomainObject(A);if(B.error)this.loaderHelper(!1),this.domNode.querySelector(".js-domain-validation-message").classList.add("is-active");
else{G=this.item.adminUrl+"/"+this.layer.layerId+"/updateDefinition";var H={updateDefinition:JSON.stringify(B)};x["default"].request({url:G,content:H},{usePost:!0}).then(function(){I.item.set("maxAgeCheck",!0);I.currentField.domain={};I.currentField.domain=B.fields[0].domain;f["default"].publish("domainOverlay/updateDomain");I.loaderHelper(!1);I.close();f["default"].publish("alert/show",{type:"success",text:I.domainType===D.Coded?F["default"].domainOverlay.updateSuccessList:F["default"].domainOverlay.updateSuccessRange})},
function(T){I.loaderHelper(!1);f["default"].publish("alert/show",{type:"error",text:F["default"].domainOverlay.errors.domainRequestFailed})})}};K.prototype.getCodedValueTree=function(){var G=this,I=this.domNode.querySelector(".js-manage-domain-coded-value"),R=[];Array.prototype.slice.call(I.children).filter(function(A){return A.classList.contains("js-template-div")}).forEach(function(A){var B=A.querySelector(".js-template-code-key").value;-1===G.currentField.type.toLowerCase().indexOf("integer")&&
-1===G.currentField.type.toLowerCase().indexOf("double")&&-1===G.currentField.type.toLowerCase().indexOf("single")||""===B||null===B||void 0===B||(B=Number(B));A=A.querySelector(".js-template-code-value").value;R.push({key:B,value:A})});return R};K.prototype.validateDomainAndReturnDomainObject=function(G){var I={fields:[t["default"](this.currentField)]},R=null,A=this.getDomainName();if(this.domainType===D.Coded)for(R=new C["default"],R.type="codedValue",R.name=A,R.codedValues=[],G=this.getCodedValueTree(),
A=0;A<G.length;A++)R.codedValues.push({code:G[A].key,name:G[A].value});else R=new z["default"],R.type="range",R.name=A,R.minValue=Number(G.rangeMinimum),R.maxValue=Number(G.rangeMaximum);I.fields[0].domain=R;return I};K.prototype.getDomainName=function(){var G;return(null===(G=this.currentField.domain)||void 0===G?0:G.name)?this.currentField.domain.name===this.currentField.name+"_Domain"?this.layer.name+"_"+this.currentField.name+"_"+g["default"]():this.currentField.domain.name:this.layer.name+"_"+
this.currentField.name+"_"+g["default"]()};K.prototype.setupInitialDomainForm=function(G){var I,R=this.domNode.querySelector(".js-manage-domain-coded-value"),A=G?G:this.currentField;if(null===(I=null===A||void 0===A?void 0:A.domain)||void 0===I?0:I.codedValues){this.domNode.querySelector(".js-coded-value").classList.remove("hide");this.domNode.querySelector(".js-coded-range").classList.add("hide");for(I=0;I<A.domain.codedValues.length;I++){if(0===I&&1===this.codedValueCount&&G){var B=this.getCodedValueTree();
1!==B.length||B[0].key||B[0].value||R.removeChild(d["default"](".0",this.domNode).shift())}A.domain.codedValues[I].count="("+(A.domain.codedValues[I].count||0)+")";R.appendChild(this.codedValueTemplate(I,A.domain.codedValues[I]));this.codedValueCount++}this.disableAddButton(!1)}else"range"===(null===(B=null===A||void 0===A?void 0:A.domain)||void 0===B?void 0:B.type)?(this.domNode.querySelector(".js-template-range-key").value=A.domain.minValue,this.domNode.querySelector(".js-template-range-value").value=
A.domain.maxValue,this.domNode.querySelector(".js-coded-range").classList.remove("hide"),this.domNode.querySelector(".js-coded-value").classList.add("hide")):this.domainType===D.Coded?(this.domNode.querySelector(".js-coded-value").classList.remove("hide"),this.domNode.querySelector(".js-coded-range").classList.add("hide"),R.appendChild(this.codedValueTemplate(this.codedValueCount)),this.codedValueCount++):this.domainType===D.Range?(d["default"](".js-coded-range").removeClass("hide"),d["default"](".js-coded-value").addClass("hide")):
(d["default"](".js-coded-value").removeClass("hide"),d["default"](".js-coded-range").addClass("hide"));this.checkInitialDuplicates()};K.prototype.setupCodedValueEvents=function(){var G=this;this.codedValueEvents&&((this.codedValueEvents||[]).forEach(function(I){I.remove()}),this.codedValueEvents=[]);this.codedValueEvents=[d["default"](".js-template-delete",this.domNode).on("click",function(I){l["default"].stop(I);G.setUnsaved(!0);var R=G.domNode.querySelector(".js-manage-domain-coded-value");I=d["default"]("."+
I.currentTarget.name,G.domNode).shift();R.removeChild(I);G.validateInputDomainValue()}),d["default"](".js-btn-add-coded-value",this.domNode).on("click",function(I){l["default"].stop(I);G.setUnsaved(!0);G.domNode.querySelector(".js-manage-domain-coded-value").appendChild(G.codedValueTemplate(G.codedValueCount));G.domNode.querySelector("[name\x3d'"+G.codedValueCount+"'].js-template-code-value").focus();G.codedValueCount++;G.setupCodedValueEvents();G.submitButton.disabled=!0;G.disableAddButton(!0)}),
d["default"](this.domNode).on("input",function(I){G.setUnsaved(!0);var R=G.validateInputDomainValue;I.target.classList.contains("js-template-code-key")&&R(I);R=G.validateInputDomainValue;I.target.classList.contains("js-template-code-value")&&R(I);R=G.validateInputDomainValue;I.target.classList.contains("js-template-range-key")&&R(I);R=G.validateInputDomainValue;I.target.classList.contains("js-template-range-value")&&R(I)})]};K.prototype.validateInputDomainValue=function(G){this.submitButton.disabled=
!1;var I=this.domNode.querySelector(".js-manage-domain-form"),R=r["default"].toObject(I);if(this.domainType===D.Coded){this.disableAddButton(!0);if(null===G||void 0===G?0:G.target){R=d["default"](G.target).closest(".js-template-div").shift();I=R.querySelector(".js-domain-coded-error");R=R.querySelector(".js-domain-coded-error-value");var A=this.checkForInvalidKeyType(),B=this.checkForDuplicates(G.target.value,"key");-1!==G.target.className.indexOf("js-template-code-key")?G.target.value?B?(G.target.classList.add("input-error"),
I.innerHTML=F["default"].domainOverlay.errors.duplicateCode,I.classList.add("is-active"),this.submitButton.disabled=!0):A.invalidType?(G.target.classList.add("input-error"),I.innerHTML=A.errorMessage,I.classList.add("is-active"),this.submitButton.disabled=!0):(G.target.classList.remove("input-error"),I.classList.remove("is-active"),this.submitButton.disabled=!1):this.submitButton.disabled=!0:(I=this.checkForDuplicates(G.target.value,"value"),G.target.value?I?(G.target.classList.add("input-error"),
R.innerHTML=F["default"].domainOverlay.errors.duplicateCode,R.classList.add("is-active"),this.submitButton.disabled=!0):(G.target.classList.remove("input-error"),R.classList.remove("is-active"),this.submitButton.disabled=!1):this.submitButton.disabled=!0)}if(!this.submitButton.disabled){if(this.checkForGeneralKeyValueDuplicates("key")||this.checkForGeneralKeyValueDuplicates("value")||this.checkForInvalidKeyType().invalidType)this.submitButton.disabled=!0;G=this.getCodedValueTree();for(I=0;I<G.length;I++)if(!(G[I].key&&
G[I].value||0===G[I].key)){this.submitButton.disabled=!0;break}this.submitButton.disabled||(this.disableAddButton(!1),d["default"](".js-template-code-key",this.domNode).removeClass("input-error"),d["default"](".js-template-code-value",this.domNode).removeClass("input-error"),d["default"](".js-domain-coded-error",this.domNode).removeClass("is-active"),d["default"](".js-domain-coded-error-value",this.domNode).removeClass("is-active"))}}else{I=R.rangeMinimum;R=R.rangeMaximum;if(null===G||void 0===G?
0:G.target)A=d["default"](G.target).closest(".js-coded-range-input-wrap").shift().querySelector(".js-domain-range-error"),B=this.checkForRangeDomain(G.target.value),G.target.value?B.invalidDomain?(G.target.classList.add("input-error"),A.innerHTML=B.errorMessage,A.classList.add("is-active"),this.submitButton.disabled=!0):(G.target.classList.remove("input-error"),A.classList.remove("is-active"),this.submitButton.disabled=!1):this.submitButton.disabled=!0;this.submitButton.disabled||(Number(I)>Number(R)&&
(this.submitButton.disabled=!0),this.checkForRangeDomain(I,R).invalidDomain&&(this.submitButton.disabled=!0),I&&R||(this.submitButton.disabled=!0),this.submitButton.disabled||(this.domNode.querySelector(".js-template-range-key").classList.remove("input-error"),this.domNode.querySelector(".js-template-range-value").classList.remove("input-error"),w["default"].forEachNode(this.domNode.querySelectorAll(".js-domain-range-error"),function(H){H.classList.remove("is-active")})))}};K.prototype.checkInitialDuplicates=
function(){var G=[];w["default"].forEachNode(this.domNode.querySelectorAll(".js-template-code-value"),function(I){-1<G.indexOf(I.value)?(I.classList.add("input-error"),I=I.parentElement.querySelector(".js-domain-coded-error-value"),I.innerHTML=F["default"].domainOverlay.errors.duplicateCode,I.classList.add("is-active")):G.push(I.value)})};K.prototype.disableAddButton=function(G){w["default"].forEachNode(this.domNode.querySelectorAll(".js-btn-add-coded-value"),function(I){I.disabled=G})};K.prototype.getKeyOrValueCodedValueTree=
function(G){var I=this.domNode.querySelector(".js-manage-domain-coded-value"),R=[];Array.prototype.slice.call(I.children).filter(function(A){return A.classList.contains("js-template-div")}).forEach(function(A){R.push(A.querySelector("value"===G?".js-template-code-value":".js-template-code-key").value)});return R};K.prototype.checkForDuplicates=function(G,I){var R=this.getKeyOrValueCodedValueTree(I);R.sort();for(var A=0,B=0;B<R.length;B++)if(R[B]===G){if(0<A)return!0;A++}return!1};K.prototype.checkForGeneralKeyValueDuplicates=
function(G){G=this.getKeyOrValueCodedValueTree(G);G.sort();for(var I=G[0],R=1;R<G.length;R++){if(G[R]===I)return!0;I=G[R]}return!1};K.prototype.checkForInvalidKeyType=function(){for(var G=this.getKeyOrValueCodedValueTree("key"),I=this.currentField.type,R=this.currentField.length?this.currentField.length:null,A=0;A<G.length;A++)if(-1!==I.toLowerCase().indexOf("string")){if(G[A].length>R)return{invalidType:!0,errorMessage:F["default"].domainOverlay.errors.stringTooLong}}else if(-1!==I.toLowerCase().indexOf("integer")){if(!this.isInteger(G[A]))return{invalidType:!0,
errorMessage:F["default"].domainOverlay.errors.mustBeInteger}}else if(-1!==I.toLowerCase().indexOf("double")||-1!==I.toLowerCase().indexOf("single")){if(isNaN(G[A]))return{invalidType:!0,errorMessage:F["default"].domainOverlay.errors.mustBeFloat}}else return{invalidType:!0,errorMessage:F["default"].domainOverlay.errors.invalidForCodedDomain};return{invalidType:!1}};K.prototype.checkForRangeDomain=function(G,I){I=I?I:G;var R=this.currentField.type;if(-1!==R.toLowerCase().indexOf("integer")){if(!this.isInteger(G)||
!this.isInteger(I))return{invalidDomain:!0,errorMessage:F["default"].domainOverlay.errors.mustBeInteger}}else if(-1!==R.toLowerCase().indexOf("double")||-1!==R.toLowerCase().indexOf("single")){if(isNaN(G)||isNaN(I))return{invalidDomain:!0,errorMessage:F["default"].domainOverlay.errors.mustBeFloat}}else return{invalidDomain:!0,errorMessage:F["default"].domainOverlay.errors.invalidForRangeDomain};return{invalidDomain:!1}};K.prototype.codedValueTemplate=function(G,I){I&&(I.name=I.name.toString().replace(/"/g,
"\x26quot;"),-1!==this.currentField.type.toLowerCase().indexOf("string")&&(I.code=I.code.toString().replace(/"/g,"\x26quot;")));return p["default"].toDom(h["default"].substitute(V["default"],{i18n:F["default"],id:G,codedValues:I||{name:"",code:"",count:""}},null,u["default"]))};K.prototype.showError=function(G){f["default"].publish("alert/show",{type:"success",text:F["default"].domainOverlay.errors.error})};K.prototype.loaderHelper=function(G,I){var R=I?I:F["default"].domainOverlay.defaultLoading,
A=this.domNode.querySelector(".js-domain-wrapper");!0===G?(this.showHideDiv(".loader",!0),this.domNode.querySelector(".loader-text").innerHTML=R,A.style.opacity="0.5",A.style.pointerEvents="none"):(this.domNode.querySelector(".loader-text").innerHTML=R,this.showHideDiv(".loader",!1),A.style.opacity="1",A.style.pointerEvents="auto")};K.prototype.showHideDiv=function(G,I){this.domNode.querySelector(G).classList[I?"add":"remove"]("hide")};K.prototype.isInteger=function(G){return 0===G%1};return K=q.__decorate([J["default"](n["default"])],
K)}()})},"arcgisonline/pages/item/widgets/AttributesView/_attributeCard":function(){define("require exports tslib ../../../utils/formatters ../../../../tsutils/declareDecorator dijit/_WidgetBase dijit/_TemplatedMixin dojo/on dojo/dom-class dojo/query dojo/topic dojo/_base/event esri/Evented dojo/text!./templates/attributeCard.html dojo/i18n!../../../../nls/arcgisonline".split(" "),function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);
a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);return function(){function t(){this.templateString=n["default"];this.i18n=m["default"];this.formatters=b["default"]}t.prototype.postMixInProperties=function(){this.inherited(arguments);this.selectCardClass=this.select?"card-select":"";this.selectedClass=this.isSelected?"card-select-active":"";this.checked=this.isSelected?
"checked":"";this.selectItem=this.isSelected?m["default"].GroupWidget.unselectItem:m["default"].GroupWidget.selectItem;this.removedClass=this.isRemoved?"card-select-removed":"";this.disabled=this.isRemoved?"disabled":""};t.prototype.postCreate=function(){this.inherited(arguments);this.addEventListeners();this.item.description.fieldValueType?this._fieldValueType.innerHTML=this.i18n.attributeFieldDetails.fieldValueTypesList[this.item.description.fieldValueType]||this.item.description.fieldValueType:
this._fieldValueType.className+=" hide"};t.prototype.addEventListeners=function(){var w=this;this.own(a["default"](this._checkboxWrap,"click",function(u){u.stopPropagation()}),a["default"](this._checkboxBtn,"change",function(u){w[u.target.checked?"selectCard":"deselectCard"]()}),a["default"](this.domNode,"click",this.toggleSelected.bind(this)),h["default"].subscribe("view/deselectAll",this.deselectCard.bind(this)),d["default"](".js-field-name-card",this.domNode).on("click",function(u){f["default"].stop(u);
u=u.target.getAttribute("fieldName");h["default"].publish("attributeCard/fieldName",u)}))};t.prototype.toggleSelected=function(){if(this.select)this[c["default"].contains(this.domNode,"card-select-active")?"deselectCard":"selectCard"]()};t.prototype.selectCard=function(){this.domNode.classList.add("card-select-active");this.item.isSelected=!0;this._checkboxBtn.setAttribute("aria-label",m["default"].GroupWidget.unselectItem);this._checkboxBtn.checked=!0;h["default"].publish("view/select",this.item)};
t.prototype.deselectCard=function(){this.domNode.classList.remove("card-select-active");this.item.isSelected=!1;this._checkboxBtn.setAttribute("aria-label",m["default"].GroupWidget.selectItem);this._checkboxBtn.checked=!1;h["default"].publish("view/deselect",this.item)};return t=q.__decorate([l["default"](p["default"],r["default"],g["default"])],t)}()})},"arcgisonline/pages/dijit/ArcadeCalculatorDlg":function(){define("require exports tslib esri/Evented esri/lang dojo/_base/lang dojo/topic dojo/query dojo/on dojo/_base/kernel dojo/_base/event dojo/dom-construct dojo/dom-style dojo/_base/json esri/support/expressionUtils esri/tasks/QueryTask esri/tasks/query esri/sniff esri/arcadeProfiles/fieldCalculateProfile esri/ArcadeExpression dojo/Deferred arcgisonline/sharing/dijit/dialog/ConfirmDialog dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/Dialog ./ArcadeFieldValidation arcgisonline/sharing/util dojo/i18n!../../nls/arcgisonline dojo/text!./ArcadeCalculatorDlg/templates/ArcadeCalculatorDlg.html arcgisonline/esriGeowConfig arcgisonline/tsutils/declareDecorator".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D,K,G,I){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);y=q.__importDefault(y);C=q.__importDefault(C);
z=q.__importDefault(z);F=q.__importDefault(F);O=q.__importDefault(O);V=q.__importDefault(V);N=q.__importDefault(N);J=q.__importDefault(J);D=q.__importDefault(D);K=q.__importDefault(K);G=q.__importDefault(G);I=q.__importDefault(I);return function(){function R(A,B){this.baseClass="arcadeCalculatorDlg";this.templateString=K["default"];this.MAX_SIZE_FOR_PBF=2E4}R.prototype.postMixInProperties=function(){this.inherited(arguments);this.i18n=p["default"].mixin({},D["default"]);this.whereClause=this.whereClause||
"1\x3d1";this.layerUrl=this.item.url+"/"+this.layer.layerId;this.localStorageName="Esri_ArcadeCalculator_"+this.item.id+"_"+this.layer.layerId+"_"+this.fieldInfo.name;this.localStorageObject=JSON.parse(window.localStorage.getItem(this.localStorageName));this.startFresh=!0};R.prototype.showModal=function(A){var B=this;this.dlg=new V["default"]({"class":"dijitDialog__arcade-calculator"});this.dlg.setContent(this.domNode);this.dlg.show();this.dlg.titleBar.hidden=!0;this.initHandlers();this.loaderHelper(!0,
D["default"].arcadeCalculatorDlg.defaultLoading);this.defaultScript="// "+D["default"].arcadeCalculatorDlg.defaultExpressionScript_line1+"\n// "+D["default"].arcadeCalculatorDlg.defaultExpressionScript_line2+"$feature.Sales2016 + $feature.Sales2017\n// "+D["default"].arcadeCalculatorDlg.defaultExpressionScript_line3+"$feature.TotalPop / Area ($feature, \u2019square-miles\u2019)\n// "+D["default"].arcadeCalculatorDlg.defaultExpressionScript_line4+"Geometry($feature).x\n\n";this.arcadeScript=this.localStorageObject?
this.localStorageObject.arcadeScript:this.defaultScript;this.failedObjectId=0;A=new t["default"](this.layerUrl);var H=new w["default"];H.where=this.whereClause;H.num=1;H.outFields=["*"];H.returnGeometry=!0;A.execute(H).then(function(T){1>(null===T||void 0===T?void 0:T.features.length)?(B.onCancel(),r["default"].publish("alert/show",{type:"success",text:B.i18n.arcadeCalculatorDlg.errors.noRecordsExist})):(B.singleFeatureResponse=T,B.initArcadeUI(),B._showContinueMessage())})};R.prototype.onCancel=
function(){var A;null===(A=this.dlg)||void 0===A?void 0:A.destroyRecursive();clearInterval(this.editorFrameListener);window.removeEventListener("message",this.receiveMessageHitch)};R.prototype._setupLocalStorage=function(){var A;if(this.startFresh){this._clearAllLocalStorage();var B={};B.arcadeScript=this._arcadeScript;B.whereClause=this.whereClause;B.timeStamp=null===(A=this.layer.editingInfo)||void 0===A?void 0:A.lastEditDate;B.featureCount=this.totalRecordCount;B.uploadId=this.registeredResultId;
B.partIdDone=null;B.startRecordNumber=null;B.resultRecordCount=null;window.localStorage.setItem(this.localStorageName,JSON.stringify(B))}};R.prototype._clearAllLocalStorage=function(){window.localStorage.removeItem(this.localStorageName)};R.prototype._showContinueMessage=function(){var A=this;if(this.localStorageObject){var B=new C["default"]({closable:!1,title:D["default"].arcadeCalculatorDlg.continueMessageTitle,content:D["default"].arcadeCalculatorDlg.continueMessagecontent,buttonOk:D["default"].common.commonYes,
buttonCancel:D["default"].common.commonNo,style:{width:"40%",height:"auto"}});B.show();B.own(c["default"](B,"ok",function(){B.hide();A.checkContinueOrStartFresh().then(function(H){A.whereClause=A.localStorageObject.whereClause||"1\x3d1";A.startFresh=H?!1:!0;A.onSubmit(A.localStorageObject.arcadeScript)})}),c["default"](B,"cancel",function(){A._clearAllLocalStorage();B.hide()}))}};R.prototype.checkContinueOrStartFresh=function(){var A=this,B=new y["default"];this.localStorageObject.timeStamp===this.layer.editingInfo.lastEditDate&&
this.localStorageObject.partIdDone&&this.localStorageObject.startRecordNumber?J["default"].request({url:this.item.url+"/uploads/"+this.localStorageObject.uploadId+"/parts"}).then(function(H){var T;0<(null===(T=null===H||void 0===H?void 0:H.parts)||void 0===T?void 0:T.length)?(A.readjustPartIdAndstartRecordNumberIfNeeded(H.parts.length),B.resolve(!0)):B.resolve(!1)},function(H){B.resolve(!1)}):B.resolve(!1);return B};R.prototype.readjustPartIdAndstartRecordNumberIfNeeded=function(A){this.localStorageObject.partIdDone===
A&&(this.localStorageObject.partIdDone+=1,this.localStorageObject.startRecordNumber+=this.localStorageObject.resultRecordCount)};R.prototype.onSubmit=function(A){var B=this,H=new y["default"];this._arcadeScript=A;this.set("readOnly",!0);this.loaderHelper(!0,D["default"].arcadeCalculatorDlg.defaultLoadingCalculating);this.showHideDiv(".js-arcade-calculatorDlg",!1);this.showHideDiv(".js-arcade-statusDlg",!0);this.getFeatureCount().then(function(T){1>B.totalRecordCount&&B.showError(D["default"].arcadeCalculatorDlg.errors.noRecordsExist);
B.totalRecordCount=T;B.totalRecords.innerHTML=B.totalRecordCount.toString();B.showHideDiv(".js-progress-bar-counts",!0);B.canUsePbf=B.checkIfCanUsePBF();B.setupArcade().then(function(){B.registerUpload().then(function(M){B.registeredResultId=M;B._setupLocalStorage();B.queryAndUploadProcess(B.startFresh?0:B.localStorageObject.startRecordNumber,B.startFresh?1:B.localStorageObject.partIdDone).then(function(L){B.domNode.querySelector(".loader-text").innerHTML=B.i18n.arcadeCalculatorDlg.commitLoading;
var X=B.item.url+"/uploads/"+B.registeredResultId+"/commit";B._clearAllLocalStorage();a["default"](".js-cancel-button",B.domNode).attr("disabled","true");setTimeout(function(){J["default"].request({url:X,content:{parts:B.allPartsInString(L),f:"json"}},{usePost:!0}).then(function(ba){a["default"](".loader-text",B.domNode).attr("innerHTML",B.i18n.arcadeCalculatorDlg.appendLoading);B.appendToFS().then(function(ma){B.onCancel();r["default"].publish("arcadeCalculatorDlg/done",{type:"success"});r["default"].publish("alert/show",
{type:"success",text:l["default"].substitute({count:ma},B.i18n.arcadeCalculatorDlg.updateSuccess)});H.resolve()},function(ma){B.showError(ma)})},function(ba){B.showError(ba)})},2E3)},function(L){})},function(M){B.showError(M)})})},function(T){B.showError(T)});return H};R.prototype.initHandlers=function(){var A=this;this.own(a["default"](".js-cancel-button",this.domNode).on("click",function(B){h["default"].stop(B);A._clearAllLocalStorage();A.onCancel()}),a["default"](".js-review-button",this.domNode).on("click",
function(B){h["default"].stop(B);clearInterval(A.editorFrameListener);window.removeEventListener("message",A.receiveMessageHitch);A.loaderHelper(!0,D["default"].arcadeCalculatorDlg.defaultLoading);A.showHideDiv(".js-arcade-statusDlg",!1);A.showHideDiv(".js-show-error",!1);A.showHideDiv(".js-review-button",!1);A.showHideDiv(".js-arcade-calculatorDlg",!0);B=new t["default"](A.layerUrl);var H=new w["default"];H.where=A.layer.objectIdField+"\x3d"+A.failedObjectId;H.num=1;H.outFields=["*"];H.returnGeometry=
!0;B.execute(H).then(function(T){T.features&&1>T.features.length||(A.singleFeatureResponse=T);A.initArcadeUI()})}))};R.prototype.showError=function(A){var B=this,H;-1<(null===(H=null===A||void 0===A?void 0:A.message)||void 0===H?void 0:H.indexOf("Object reference not set to"))&&(A=this.i18n.arcadeCalculatorDlg.errors.error);this.errorDlg=new C["default"]({showCancel:!1,style:{width:"400px",height:"auto"}});this.errorDlg.show(A).then(function(){B.set("readOnly",!1);B._clearAllLocalStorage();B.showHideDiv(".js-arcade-statusDlg",
!1);B.showHideDiv(".js-show-error,",!1);B.showHideDiv(".js-arcade-calculatorDlg",!0);a["default"](".js-cancel-button",B.domNode).removeAttr("disabled");B.errorDlg.hide();B.onCancel()});this.loaderHelper(!1)};R.prototype.loaderHelper=function(A,B){var H=B||"Loading...";A?(this.showHideDiv(".loader",!0),this.domNode.querySelector(".loader-text").innerHTML=H,this.domNode.querySelector(".js-arcade-calculatorDlg").style.opacity="0.5",this.domNode.querySelector(".js-arcade-calculatorDlg").style.pointerEvents=
"none"):(this.domNode.querySelector(".loader-text").innerHTML=H,this.showHideDiv(".loader",!1),this.domNode.querySelector(".js-arcade-calculatorDlg").style.opacity="1",this.domNode.querySelector(".js-arcade-calculatorDlg").style.pointerEvents="auto")};R.prototype.showHideDiv=function(A,B){B?a["default"](A).removeClass("hide"):a["default"](A).addClass("hide")};R.prototype.setupArcade=function(){var A=new y["default"];this.arcadeExpr=new x["default"]({expression:this._arcadeScript,returnType:this.getFieldType(),
profile:v["default"]});this.extractedFieldNames=m["default"].extractFieldNames(this.arcadeExpr.syntaxTree);this.requestReturnGeometry=this.arcadeExpr.hasGeometryOperations()||m["default"].hasFunction(this.arcadeExpr.syntaxTree,"Geometry")||m["default"].hasFunction(this.arcadeExpr.syntaxTree,"Centroid");v["default"].initialize([this.arcadeExpr]).then(function(){A.resolve()});return A};R.prototype.getFieldType=function(){return/integer|double|single/g.test(this.fieldInfo.type.toLowerCase())?"number":
/date/g.test(this.fieldInfo.type.toLowerCase())?"date":"string"};R.prototype.updateProgressBar=function(A,B){1>B&&(B=1);var H=A*B>this.totalRecordCount?this.totalRecordCount:A*B;this.progressBar.style.width=Math.min(100,Math.floor(A/(this.totalRecordCount/B)*100))+"%";this.completedRecords.innerHTML=H.toString()};R.prototype.addToLocalStorage=function(A,B){var H=JSON.parse(window.localStorage.getItem(this.localStorageName));H&&(H[A]=B,window.localStorage.setItem(this.localStorageName,JSON.stringify(H)))};
R.prototype.queryAndUploadProcess=function(A,B,H){var T=this,M=H||new y["default"],L=B||1,X=A||0;A=this.getQuery(X);var ba=A.maxSize;B=new t["default"](this.layerUrl);B.requestOptions={timeout:3E5};B.execute(A.query,void 0,void 0).then(function(ma){T.runThroughArcadeAndGetCsvToUpload(ma.features,L).then(function(ta){null===ta?M.reject(!1):J["default"].request({url:T.item.url+"/uploads/"+T.registeredResultId+"/uploadPart",content:{partId:L,f:"json"},form:ta,timeout:0},{usePost:!0}).then(function(Ea){ma.exceededTransferLimit?
(X+=ba,L++,T.addToLocalStorage("partIdDone",L),T.addToLocalStorage("startRecordNumber",X),T.addToLocalStorage("resultRecordCount",ba),ma=ta=void 0,T.updateProgressBar(L-1,ba),T.queryAndUploadProcess(X,L,M)):(ma=ta=void 0,T.updateProgressBar(L,ba),M.resolve(L))})})},function(ma){T.showError(ma)});return M};R.prototype.getQuery=function(A){var B=new w["default"];B.outFields=[this.layer.objectIdField];this.extractedFieldNames.forEach(function(T){B.outFields.push(T)});B.where=this.whereClause;B.start=
A;B.returnGeometry=this.requestReturnGeometry;A=this.layer.maxRecordCount||1E3;var H={format:"json"};this.canUsePbf&&(H.format="pbf",B.resultType="tile",this.requestReturnGeometry?(A=this.layer.tileMaxRecordCount,B.maxRecordCountFactor=1):(A=this.MAX_SIZE_FOR_PBF,this.layer.tileMaxRecordCount<=A&&(B.maxRecordCountFactor=A/this.layer.tileMaxRecordCount)),this.requestReturnGeometry&&(B.quantizationParameters={mode:"edit"}));B.num=A;return{query:B,options:H,maxSize:A}};R.prototype.checkIfCanUsePBF=function(){var A,
B;return u["default"]("esri-pbf")&&(null===(A=this.layer.advancedQueryCapabilities)||void 0===A?void 0:A.supportsQueryWithResultType)&&(null===(B=this.layer.advancedQueryCapabilities)||void 0===B?void 0:B.supportsMaxRecordCountFactor)&&this.layer.supportsFormatPBF&&this.layer.supportsQuantizationEditMode};R.prototype.runThroughArcadeAndGetCsvToUpload=function(A,B){var H=this,T=new y["default"];this.getAllFeaturesFromArcade(A,B).then(function(M){null===M&&T.resolve(null);1===B?T.resolve(H.exportCSVFile(M,
"uploadFile"+B,{FID:H.layer.objectIdField,ArcadeField:H.fieldInfo.name})):T.resolve(H.exportCSVFile(M,"uploadFile"+B))});return T};R.prototype.getAllFeaturesFromArcade=function(A,B){var H=this,T=new y["default"],M=[];if(this.arcadeExpr.async){var L=1;this.reduceArrayWithPromises(A,function(ma,ta,Ea){var wa=new y["default"];try{var Q=v["default"].getEvalOptions({expression:H.arcadeExpr,feature:ta,layer:H.layer,spatialReference:H.layer.spatialReference,portal:G["default"].restBaseUrl.substring(0,G["default"].restBaseUrl.indexOf("/sharing/rest"))});
Q.strictReturnType=!1;H.arcadeAsyncWithTimeout(ta,H.arcadeExpr,Q,Ea).then(function(Z){try{var aa={FID:ta.attributes[H.layer.objectIdField],ArcadeField:Z};aa=H.validateArcadeResult(aa);M.push(aa);H.updateProgressBar(B,L++);wa.resolve(!0)}catch(ea){wa.reject(ea)}},function(Z){H.showError(Z)})}catch(Z){H.showError(Z)}return wa.promise}).then(function(ma){T.resolve(M)},function(ma){T.reject(ma)})}else{for(var X=0;X<A.length;X++){var ba=v["default"].getEvalOptions({expression:this.arcadeExpr,feature:A[X],
layer:this.layer,spatialReference:this.layer.spatialReference,portal:G["default"].restBaseUrl.substring(0,G["default"].restBaseUrl.indexOf("/sharing/rest"))});ba.strictReturnType=!1;ba={FID:A[X].attributes[this.layer.objectIdField],ArcadeField:A[X].evaluateExpression(this.arcadeExpr,ba)};ba=this.validateArcadeResult(ba);M.push(ba)}T.resolve(M)}return T};R.prototype.arcadeAsyncWithTimeout=function(A,B,H,T){var M=new y["default"];0===T%100?setTimeout(function(){A.evaluateExpression(B,H).then(function(L){M.resolve(L)},
function(L){M.reject(L)})},0):A.evaluateExpression(this.arcadeExpr,H).then(function(L){M.resolve(L)},function(L){M.reject(L)});return M};R.prototype.reduceArrayWithPromises=function(A,B,H){var T=new y["default"];H=new y["default"];H.resolve(!0);A.reduce(function(M,L,X,ba){return M.then(function(ma){try{return B(ma,L,X,ba)}catch(ta){return ma=new y["default"],ma.reject(ta),ma.promise}},function(ma){var ta=new y["default"];ta.reject(ma);return ta.promise})},H.promise).then(function(M){T.resolve(M)},
function(M){T.reject(M)});return T.promise};R.prototype.validateArcadeResult=function(A){var B=A.ArcadeField,H=A.FID;null===B&&(B="");var T=N["default"].arcadeFieldValidation(B,this.fieldInfo);if(T.isFieldValid)-1!==this.fieldInfo.type.toLowerCase().indexOf("string")&&(B=this.sanitizeStringForCsv(B));else throw this.showHideDiv(".js-show-error",!0),this.showHideDiv(".js-review-button",!0),this._clearAllLocalStorage(),this.startFresh=!0,this.reviewErrorHeading.innerHTML=T.errorMessage,this.reviewErrorFid.innerHTML=
this.layer.objectIdField,this.reviewErrorFidValue.innerHTML=H,this.reviewErrorValue.innerHTML=""!==B?B:"",this.failedObjectId=H,this.loaderHelper(!1),T.errorMessage;A.ArcadeField=B;return A};R.prototype.sanitizeStringForCsv=function(A){"string"===typeof A&&(A=A.replace(/"/g,'""'));return'"'+A+'"'};R.prototype.convertToCSV=function(A){A="object"!==typeof A?JSON.parse(A):A;for(var B="",H=0;H<A.length;H++){var T="",M;for(M in A[H])""!==T&&(T+=","),T+=A[H][M];B+=T+"\r\n"}return B};R.prototype.exportCSVFile=
function(A,B,H){H&&A.unshift(H);A=JSON.stringify(A);A=this.convertToCSV(A);B=B+".csv"||"export.csv";A=new Blob([A],{type:"text/csv;charset\x3dutf-8;"});H=f["default"].create("form",{enctype:"multipart/form-data"});H=new FormData(H);H.append("file",A,B);return H};R.prototype.allPartsInString=function(A){for(var B="",H=1;H<=A;H++)B=H===A?B+H:B+(H+",");return B};R.prototype.appendToFS=function(){var A=this,B=new y["default"],H=this.item.url+"/"+this.layer.layerId+"/append",T=this.getAppendParams();J["default"].request({url:H,
content:T},{usePost:!0}).then(function(M){return A.checkStatus(M)},function(M){B.reject(M)}).then(function(M){B.resolve(M)});return B};R.prototype.checkStatus=function(A,B,H){var T=this,M=null===A||void 0===A?void 0:A.statusUrl,L=H||new y["default"],X=B||500;J["default"].request({url:M}).then(function(ba){ba=ba||{status:"completed"};ba.status&&"completed"===ba.status.toLowerCase()?L.resolve(ba.recordCount):ba.status&&"failed"===ba.status.toLowerCase()||400<ba.code||""===ba.status?T.showError(ba):
(X=(X||500)+250,setTimeout(function(){T.checkStatus(A,X,L)},B))},function(ba){T.showError(ba)});return L};R.prototype.getAppendParams=function(){var A=[this.fieldInfo.name,this.layer.objectIdField];return{fieldMappings:JSON.stringify([{source:this.fieldInfo.name,name:this.fieldInfo.name},{source:this.layer.objectIdField,name:this.layer.objectIdField}]),upsert:!0,skipUpdates:!1,useGlobalIds:!1,skipInserts:!0,updateGeometry:!1,appendFields:JSON.stringify(A),appendUploadId:this.registeredResultId,appendUploadFormat:"csv",
rollbackOnFailure:!0,upsertMatchingField:this.layer.objectIdField,appendSourceInfo:"{}"}};R.prototype.getFeatureCount=function(){var A=new y["default"];if(this.startFresh){var B=new t["default"](this.layerUrl),H=new w["default"];H.returnGeometry=!1;H.where=this.whereClause;B.executeForCount(H,function(T){A.resolve(T)},function(T){A.reject(T)})}else A.resolve(this.localStorageObject.featureCount);return A};R.prototype.registerUpload=function(){var A,B,H=new y["default"];this.startFresh?J["default"].request({url:this.item.url+
"/uploads/register",content:{itemName:""+this.item.id+((null===(A=this.item.portal)||void 0===A?0:A.isPortal)||(null===(B=G["default"].self)||void 0===B?0:B.isPortal)?".csv":""),description:"Arcade Calculate"}},{usePost:!0}).then(function(T){T.success&&H.resolve(T.item.itemID)}):H.resolve(this.localStorageObject.uploadId);return H};R.prototype.initArcadeUI=function(){var A=this,B=0;this.editorFrameLoaded=!1;this.editorUrl=G["default"].arcadeEditor+"?locale\x3d"+d["default"].locale;this.expressionEditor&&
(this.expressionEditor.onload=function(){g["default"].set(A.expressionEditor,"visibility","visible")},this.expressionEditor.src=this.editorUrl);this.receiveMessageHitch=this.receiveMessage.bind(this);window.addEventListener("message",this.receiveMessageHitch,!1);this.editorFrameListener=window.setInterval(function(){A.editorFrameLoaded?(clearInterval(A.editorFrameListener),A.editorFrameListener=null):A.sendPostMessage({type:"isLoaded"});B++;60<B&&A.showError("Arcade time out")},500)};R.prototype.sendPostMessage=
function(A){var B,H,T;null===(T=null===(H=null===(B=this.expressionEditor)||void 0===B?void 0:B.contentWindow)||void 0===H?void 0:H.postMessage)||void 0===T?void 0:T.call(H,n["default"].toJson(A),this.editorUrl)};R.prototype.receiveMessage=function(A){var B;if(-1!==this.editorUrl.indexOf(A.origin))switch(A="string"===typeof A.data?n["default"].fromJson(A.data):A.data,A.type){case "loaded":(this.editorFrameLoaded=A.value)&&this.sendPostMessage({type:"initializeDialog",title:this.i18n.arcadeCalculatorDlg.arcadeCalculatorDlgTitle+
(this.fieldInfo.alias?this.fieldInfo.alias:this.fieldInfo.name),captureTitle:!1,predictOutputType:!0,script:this.arcadeScript,async:!0,profile:this.makeCurrentProfile(),includeRelationships:!0,includeGeometryWarning:!1,arcadeProfile:"Field Calculation",bannedFunctions:["Length3D"],spatialReference:this.layer.spatialReference.toJson(),portalDefinition:{app_id:"",url:G["default"].restBaseUrl,token:(null===(B=G["default"].userInfo.credential)||void 0===B?void 0:B.token)||G["default"].userInfo.token,
expires:G["default"].userInfo.expires,userId:G["default"].userInfo.username}});break;case "initFinished":this.editorFrameLoaded&&this.loaderHelper(!1,null);break;case "scriptSaveAndClose":if(!A.script||A.script===this.defaultScript)break;this.arcadeScript=A.script;this.onSubmit(A.script);break;case "scriptClose":this.onCancel()}};R.prototype.makeCurrentProfile=function(){var A=this.layer.fields.map(function(B){var H;-1<(null===(H=B.domain)||void 0===H?void 0:H.type.indexOf(["range","codedValue"]))&&
(B=p["default"].clone(B));return B});A=[{type:"Feature",dontExpand:!0,value:{attributes:null,geometry:null,_hydrateLayer:{portalItem:{id:this.item.id},layerId:this.layer.layerId,outFields:["*"]},layer:{fields:A,objectIdField:this.layer.objectIdField,typeIdField:this.layer.typeIdField,types:this.layer.types?this.layer.types.map(function(B){return B.toJson?B.toJson():B}):null,templates:this.layer.templates,relationships:this.layer.relationships}},id:"$feature",displayTitle:""},{type:"Layer",value:{portalItem:{id:this.item.id},
layerId:this.layer.layerId,outFields:["*"]},id:"$layer",displayTitle:this.layer.name},{type:"Workspace",value:{portalItem:{id:this.item.id}},id:"$datastore",displayTitle:this.item.title}];A[0].value.attributes=this.singleFeatureResponse.features[0].attributes;A[0].value.geometry=this.singleFeatureResponse.features[0].geometry;this.layer.displayField&&(A[0].displayTitle=this.singleFeatureResponse.features[0].attributes[this.layer.displayField]);A[0].value._hydrateLayer={url:this.layerUrl};return A};
return R=q.__decorate([I["default"](z["default"],F["default"],O["default"],b["default"])],R)}()})},"esri/arcadeProfiles/fieldCalculateProfile":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../promiseList ../arcade/Feature ../arcade/featureset/support/RecentlyUsedCache ../support/expressionUtils ./utils".split(" "),function(e,U,q,b,l,p,r,a,c){e=new (e(null,{declaredClass:"esri.arcadeProfiles.FieldCalculateProfile",defaults:{globals:{featureSet:["$layer","$datastore"],async:["$layer",
"$datastore"]},context:{vars:{$feature:"any",$layer:"any",$datastore:"any"}}},_lruCache:null,constructor:function(){this._lruCache=new r},initialize:function(d){var h=[];c.hasGeometryOperations(d)&&h.push(a.enableGeometryOperations());(c.hasFeatureSetOperations(d)||c.hasVariables(d,this.defaults.globals.featureSet))&&h.push(a.enableFeatureSetOperations());c.isAsync(d)&&h.push(a.enableAsyncOperations());return l(h)},isAsync:function(d){d=[d];return c.hasFeatureSetOperations(d)||c.hasVariables(d,this.defaults.globals.async)},
parse:function(d){return a.createSyntaxTree(d.expression)},compile:function(d){var h=U.clone(this.defaults.context);h.useAsync=d.async;return d.syntaxTree?a.createFunction(d.syntaxTree,h):null},getEvalOptions:function(d){var h=d.expression,f=d.feature,g=d.layer,n=d.spatialReference;d=d.portal;var m,t,w={spatialReference:n,cache:this._lruCache};if(g&&(h.hasVariable("$layer")&&(m=t=g.getMap()?a.createFeatureSetFromLayer(g,w):a.createFeatureSetFromLayerUrl(g.url,w)),h.hasVariable("$datastore")))var u=
(u=c.getServiceUrl(g.url))?a.createFeatureSetCollectionFromServiceUrl(u,w):null;h=f&&h.hasVariable("$feature")?p.createFromGraphicLikeObject(f.geometry,f.attributes,(h.hasFunction("attachments")||h.hasFunction("featuresetbyrelationship"))&&g&&!g.getMap()?t||a.createFeatureSetFromLayerUrl(g.url,w):g):null;if(d){d=d.replace(/\/+$/ig,"");var v={url:d,portalUrl:d+"/sharing/rest"}}return{context:{vars:{$feature:h,$layer:m,$datastore:u},services:v?{portal:v}:null,lrucache:this._lruCache,spatialReference:n}}}}));
U.setObject("arcadeProfiles.fieldCalculateProfile",e,b);return e})},"esri/arcade/featureset/support/RecentlyUsedCache":function(){define(["require","exports"],function(e,U){var q=function(){function l(p){var r=this;r._keys=[];r._values=[];r.length=0;p&&p.forEach(function(a){r.set(a[0],a[1])})}l.prototype.entries=function(){var p=this;return[].slice.call(this.keys().map(function(r){return[r,p.get(r)]}))};l.prototype.keys=function(){return[].slice.call(this._keys)};l.prototype.values=function(){return[].slice.call(this._values)};
l.prototype.has=function(p){return this._keys.includes(p)};l.prototype.get=function(p){p=this._keys.indexOf(p);return-1<p?this._values[p]:void 0};l.prototype.deepGet=function(p){if(!p||!p.length)return null;var r=function(a,c){return void 0===a||null===a?null:c.length?r(a instanceof l?a.get(c[0]):a[c[0]],c.slice(1)):a};return r(this.get(p[0]),p.slice(1))};l.prototype.set=function(p,r){var a=this._keys.indexOf(p);-1<a?this._values[a]=r:(this._keys.push(p),this._values.push(r),this.length=this._values.length);
return this};l.prototype.sortedSet=function(p,r,a,c){var d=this._keys.length;a=a||0;c=void 0!==c?c:d-1;if(0===d)return this._keys.push(p),this._values.push(r),this;if(p===this._keys[a])return this._values.splice(a,0,r),this;if(p===this._keys[c])return this._values.splice(c,0,r),this;if(p>this._keys[c])return this._keys.splice(c+1,0,p),this._values.splice(c+1,0,r),this;if(p<this._keys[a])return this._values.splice(a,0,r),this._keys.splice(a,0,p),this;if(a>=c)return this;d=a+Math.floor((c-a)/2);return p<
this._keys[d]?this.sortedSet(p,r,a,d-1):p>this._keys[d]?this.sortedSet(p,r,d+1,c):this};l.prototype.size=function(){return this.length};l.prototype.clear=function(){this._keys.length=this.length=this._values.length=0;return this};l.prototype["delete"]=function(p){p=this._keys.indexOf(p);return-1<p?(this._keys.splice(p,1),this._values.splice(p,1),this.length=this._keys.length,!0):!1};l.prototype.forEach=function(p){var r=this;this._keys.forEach(function(a,c){p(r.get(a),a,c)})};l.prototype.map=function(p){var r=
this;return this.keys().map(function(a,c){return p(r.get(a),a,c)})};l.prototype.filter=function(p){var r=this;r._keys.forEach(function(a,c){!1===p(r.get(a),a,c)&&r["delete"](a)});return this};l.prototype.clone=function(){return new l(this.entries())};return l}(),b=function(){function l(p){void 0===p&&(p=20);this.maxEntries=p;this.values=new q}l.prototype["delete"]=function(p){this.values.has(p)&&this.values["delete"](p)};l.prototype.get=function(p){var r=null;this.values.has(p)&&(r=this.values.get(p),
this.values["delete"](p),this.values.set(p,r));return r};l.prototype.put=function(p,r){if(this.values.size()>=this.maxEntries){var a=this.values.keys()[0];this.values["delete"](a)}this.values.set(p,r)};return l}();return function(){function l(p){void 0===p&&(p=20);this.maxEntries=p;this._cache=new b(this.maxEntries)}l.prototype.clear=function(){this._cache=new b(this.maxEntries)};l.prototype.addToCache=function(p,r){this._cache.put(p,r)};l.prototype.removeFromCache=function(p){this._cache["delete"](p)};
l.prototype.getFromCache=function(p){return this._cache.get(p)};return l}()})},"arcgisonline/pages/dijit/ArcadeFieldValidation":function(){define(["require","exports","tslib","esri/lang","dojo/i18n!../../nls/arcgisonline"],function(e,U,q,b,l){function p(d,h){return d instanceof Date?{isFieldValid:!0}:{isFieldValid:!1,errorMessage:b["default"].substitute({fieldType:a(h)},l["default"].arcadeFieldValidation.notValidFieldType)}}function r(d){return"number"===typeof d&&!isNaN(d)&&Infinity!==d&&-Infinity!==
d}function a(d){return l["default"].arcadeFieldValidation.fieldTypes[d.type]||l["default"].arcadeFieldValidation.commonUndefined}function c(d,h){return d.domain&&"range"===d.domain.type?h>=d.domain.minValue&&h<=d.domain.maxValue:!0}Object.defineProperty(U,"__esModule",{value:!0});b=q.__importDefault(b);l=q.__importDefault(l);U["default"]={arcadeFieldValidation:function(d,h){var f=h.type.toLowerCase();if(null===d||""===d||void 0===d)return h.nullable?{isFieldValid:!0}:{isFieldValid:!1,errorMessage:l["default"].arcadeFieldValidation.nullNotAllowed};
var g=null===d?!1:d instanceof Date?!1:"function"===typeof d||"object"===typeof d;return g?{isFieldValid:!1,errorMessage:b["default"].substitute({fieldType:a(h)},l["default"].arcadeFieldValidation.cannotInsertObject)}:"esrifieldtypestring"===f?(f=(p(d,h)||r(d))&&d.toString().length<=h.length?{isFieldValid:!0}:"string"===typeof d&&d.length<=h.length?{isFieldValid:!0}:{isFieldValid:!1,errorMessage:b["default"].substitute({maxStringLength:h.length},l["default"].arcadeFieldValidation.stringLengthError)},
f):f="esrifieldtypedouble"===f?r(d)?-Infinity<=d&&Infinity>=d?c(h,d)?{isFieldValid:!0}:{isFieldValid:!1,errorMessage:b["default"].substitute({min:h.domain.minValue,max:h.domain.maxValue},l["default"].arcadeFieldValidation.domainOutOfRange)}:{isFieldValid:!1,errorMessage:b["default"].substitute({fieldType:a(h),min:-Infinity,max:Infinity},l["default"].arcadeFieldValidation.outOfRange)}:{isFieldValid:!1,errorMessage:b["default"].substitute({fieldType:a(h)},l["default"].arcadeFieldValidation.notValidFieldType)}:
"esrifieldtypesingle"===f?r(d)?-3.402823E38<=d&&3.402823E38>=d?c(h,d)?{isFieldValid:!0}:{isFieldValid:!1,errorMessage:b["default"].substitute({min:h.domain.minValue,max:h.domain.maxValue},l["default"].arcadeFieldValidation.domainOutOfRange)}:{isFieldValid:!1,errorMessage:b["default"].substitute({fieldType:a(h),min:-3.402823E38,max:3.402823E38},l["default"].arcadeFieldValidation.outOfRange)}:{isFieldValid:!1,errorMessage:b["default"].substitute({fieldType:a(h)},l["default"].arcadeFieldValidation.notValidFieldType)}:
"esrifieldtypeinteger"===f?r(d)&&d===parseInt(d,10)?-2147483648<=d&&2147483647>=d?c(h,d)?{isFieldValid:!0}:{isFieldValid:!1,errorMessage:b["default"].substitute({min:h.domain.minValue,max:h.domain.maxValue},l["default"].arcadeFieldValidation.domainOutOfRange)}:{isFieldValid:!1,errorMessage:b["default"].substitute({fieldType:a(h),min:-2147483648,max:2147483647},l["default"].arcadeFieldValidation.outOfRange)}:{isFieldValid:!1,errorMessage:b["default"].substitute({fieldType:a(h)},l["default"].arcadeFieldValidation.notValidFieldType)}:
"esrifieldtypesmallinteger"===f?r(d)&&d===parseInt(d,10)?-32768<=d&&32767>=d?c(h,d)?{isFieldValid:!0}:{isFieldValid:!1,errorMessage:b["default"].substitute({min:h.domain.minValue,max:h.domain.maxValue},l["default"].arcadeFieldValidation.domainOutOfRange)}:{isFieldValid:!1,errorMessage:b["default"].substitute({fieldType:a(h),min:-32768,max:32767},l["default"].arcadeFieldValidation.outOfRange)}:{isFieldValid:!1,errorMessage:b["default"].substitute({fieldType:a(h)},l["default"].arcadeFieldValidation.notValidFieldType)}:
"esrifieldtypedate"===f?p(d,h):{isFieldValid:!1,errorMessage:l["default"].arcadeFieldValidation.unexpectedValue}}}})},"arcgisonline/pages/dijit/CalculateWithOptionsDlg":function(){define("require exports tslib ../../esriGeowConfig ../utils/icons ../../sharing/util ../../tsutils/declareDecorator dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/Dialog dojo/query dojo/on dojo/_base/event dojo/Deferred dojo/topic esri/Evented dojo/i18n!../../nls/arcgisonline dojo/text!./CalculateWithOptionsDlg/templates/CalculateWithOptionsDlg.html".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);return function(){function x(){this.templateString=v["default"];this.baseClass="calculateWithOptions";
this.i18n=u["default"];this.icons=l["default"]}x.prototype.startup=function(y){this.inherited(arguments);this.fieldInfo=null===y||void 0===y?void 0:y.fieldInfo;this.canDoArcadeCalculation=null===y||void 0===y?void 0:y.showArcadeOption;p["default"].isPortal()&&!this.canDoArcadeCalculation&&(this.domNode.querySelector(".js-disabled-text").textContent=u["default"].calculateSQLArcadeDlg.arcadeDisabledPortal);this.initHandlers()};x.prototype.showModal=function(y){var C=this;y=new m["default"];var z=u["default"].calculateSQLArcadeDlg.calculateDlgTitle+
' : \x3cmark class\x3d"label calculate-with-options__field-label"\x3e'+this.fieldInfo.name+"\x3c/mark\x3e";this.docUrl.href=b["default"].self?""+b["default"].self.helpBase+b["default"].self.helpMap.m["120001514"]:"";this.arcadeDisabledHelpUrl.href=b["default"].self?""+b["default"].self.helpBase+b["default"].self.helpMap.m["120001735"]:"";this.dlg=new h["default"]({title:z,"class":"dijitDialog__calculate-with-options"});this.dlg.setContent(this.domNode);this.dlg.show();this.canDoArcadeCalculation||
(f["default"](".js-arcade-button").addClass("hide"),f["default"](".js-panel-arcade-disabled").removeClass("hide"));this.own(g["default"](this.dlg,"cancel",function(){C.set("readOnly",!0);C.onCancel()}));return y};x.prototype.onCancel=function(){this.dlg&&this.dlg.destroyRecursive()};x.prototype.initHandlers=function(){var y=this;this.own(f["default"](".js-arcade-button",this.domNode).on("click",function(C){n["default"].stop(C);t["default"].publish("calculateWithOptionsDlg/arcade",y.fieldInfo);y.onCancel()}),
f["default"](".js-sql-button",this.domNode).on("click",function(C){n["default"].stop(C);t["default"].publish("calculateWithOptionsDlg/sql",y.fieldInfo);y.onCancel()}))};return x=q.__decorate([r["default"](a["default"],c["default"],d["default"],w["default"])],x)}()})},"arcgisonline/sharing/dijit/dialog/TableAddFieldDlg":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has dojo/on dojo/json dojo/string dojo/dom-style dojo/dom-attr dojo/dom-construct dojo/dom-class dojo/aspect dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_OnDijitClickMixin dijit/_FocusMixin dijit/form/Button dijit/form/Form dijit/form/Select dijit/form/TextBox dijit/form/ValidationTextBox dijit/form/NumberTextBox dijit/form/DateTextBox dijit/Dialog esri/kernel esri/lang esri/request esri/tasks/query esri/tasks/QueryTask ../../util dojo/i18n!esri/nls/jsapi dojo/text!./templates/TableAddFieldDlg.html".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D,K,G,I,R,A,B){e=U([m,t,w,u,v],{widgetsInTemplate:!0,declaredClass:"arcgisonline.sharing.dijit.dialog.TableAddFieldDlg",templateString:B,basePath:e.toUrl("."),statics:{_instance:null,getInstance:function(){null==this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.TableAddFieldDlg);return this._instance}},_css:{table:"esriAddFormTable",container:"esriAddFieldContainer",longInput:"esriLongInput",longLabel:"esriLongLabel",
typeSelect:"esriTypeSelect",buttonContainer:"esriAddButtonContainer",defaultLabelContainer:"esriDefaultLabelContainer",optionLabelContainer:"esriOptionLabelContainer",button:"btn calcite primary tiny",closeButton:"btn calcite cancel tiny",leadingMargin1:"esriLeadingMargin1",trailing:"esriFloatTrailing"},constructor:function(H){this.inherited(arguments);H&&q.mixin(this._css,H.css)},postMixInProperties:function(){this.inherited(arguments);this.i18n={};q.mixin(this.i18n,A.common);q.mixin(this.i18n,A.calculateFields)},
postCreate:function(){this.inherited(arguments);this._typeSelect.set("value","esriFieldTypeString");this._handleTypeChange("esriFieldTypeString");this._nameInput.set("validator",q.hitch(this,this._validateFieldName));this._checkNullable()},_checkNullable:function(){if(this.params&&this.params.layer){for(var H=document.querySelectorAll(".nullable-row"),T=0;T<H.length;T++)H[T].style.display="none";H=new esri.tasks.Query;H.where="1\x3d1";this.params.layer.queryCount(H,function(M){if(0===M){M=document.querySelectorAll(".nullable-row");
for(var L=0;L<M.length;L++)M[L].style.display="table-row"}},function(M){})}},_handleTypeChange:function(H){this._lengthInput.set("required","esriFieldTypeString"===H);this._lengthInput.set("constraints",{min:1,places:0});d.set(this._lengthRow,"display","esriFieldTypeString"!==H?"none":"table-row");var T={esriFieldTypeDouble:1,esriFieldTypeSingle:1},M={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1};H in{esriFieldTypeDate:1}?(d.set(this._defaultStrInput.domNode,"display","none"),d.set(this._defaultNumInput.domNode,
"display","none"),d.set(this._defaultDblInput.domNode,"display","none"),d.set(this._defaultDateInput.domNode,"display","block"),d.set(this._defaultTimeInput.domNode,"display","block"),this._defaultTimeInput.on("change",function(L){if(this._defaultTimeInput.get("value")&&!this._defaultDateInput.get("value")){L=new Date;var X=""+(L.getMonth()+1),ba=""+L.getDate(),ma=L.getFullYear(),ta=10>X?"0"+X:X;L=10>ba?"0"+ba:ba;document.getElementById("dijit_form_DateTextBox_0").value=X+"/"+ba+"/"+ma;this._defaultDateInput.value=
ma+"-"+ta+"-"+L}}.bind(this))):(H in M?(d.set(this._defaultStrInput.domNode,"display","none"),d.set(this._defaultNumInput.domNode,"display","block"),d.set(this._defaultDblInput.domNode,"display","none")):H in T?(d.set(this._defaultStrInput.domNode,"display","none"),d.set(this._defaultNumInput.domNode,"display","none"),d.set(this._defaultDblInput.domNode,"display","block")):(d.set(this._defaultStrInput.domNode,"display","block"),d.set(this._defaultNumInput.domNode,"display","none"),d.set(this._defaultDblInput.domNode,
"display","none")),d.set(this._defaultDateInput.domNode,"display","none"),d.set(this._defaultTimeInput.domNode,"display","none"))},_handleAddButtonClick:function(){if(this._addForm.validate()){var H={f:"json"},T=this.params.layer.url.replace("/rest/services","/rest/admin/services")+"/addToDefinition",M=[],L={esriFieldTypeDouble:1,esriFieldTypeSingle:1},X={esriFieldTypeDate:1},ba={},ma;var ta={name:this._nameInput.get("value"),type:this._typeSelect.get("value"),alias:this._aliasInput.get("value"),
nullable:this._nullable.get("checked"),editable:!0};var Ea=ta.type in{esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1};"esriFieldTypeString"===ta.type&&(ta.length=this._lengthInput.get("value"));if(Ea)var wa=parseInt(this._defaultNumInput.get("value"),10);else ta.type in L?wa=parseFloat(this._defaultDblInput.get("value"),10):ta.type in X?(L=this._defaultDateInput.get("value")?this._defaultDateInput.get("value").toDateString():null,null!==L?(wa=this._defaultTimeInput.get("value")?this._defaultTimeInput.get("value").toTimeString():
(new Date(L)).toTimeString(),wa=(new Date(L+" "+wa)).getTime()):this._defaultTimeInput.get("value")&&(wa=(new Date).toDateString(),this._defaultDateInput.set("value",wa),wa=wa+" "+this._defaultTimeInput.get("value").toTimeString(),wa=(new Date(wa)).getTime())):wa=this._defaultStrInput.get("value");if(wa||Ea&&0===wa)ta.defaultValue=wa;M.push(ta);ba.fields=M;H.addToDefinition=l.toJson(ba);arcgisonline.map.itemData.getServerToken(this.params.mapLayer).then(dojo.hitch(this,function(Q){H.token=Q;ma=K({url:T,
content:H},{usePost:!0});this._addBtn.set("disabled",!0);ma.then(q.hitch(this,function(Z){this._dialog.hide();this._addBtn.set("disabled",!1);this.params.popup?arcgisonline.map.main.ignoreCache(this.params.mapLayer):this.params.mapLayer.itemCard.set("maxAgeCheck",!0);K({url:this.params.layer.url,content:{f:"json",_ts:(new Date).getTime()},callbackParamName:"callback"}).then(q.hitch(this,function(aa){this.params.mapLayer.layer.fields=aa.fields;var ea=b.filter(aa.fields,function(Ha){return Ha.name.toLowerCase()===
ta.name.toLowerCase()?(Ha.name!==ta.name&&(ta.name=Ha.name,this._nameInput.set("value",ta.name)),!0):!1},this)[0];this.params.mapLayer.serviceInfo=aa;if(this.params.mapLayer.origItemLayers)for(var oa=parseInt(this.params.mapLayer.layer.url.substring(this.params.mapLayer.layer.url.lastIndexOf("/")+1)),ra=0;ra<this.params.mapLayer.origItemLayers.length;ra++)if(this.params.mapLayer.origItemLayers[ra].id===oa){var za=this.params.mapLayer.origItemLayers[ra];break}if(this.params.mapLayer.popupInfo||za&&
za.popupInfo&&this.params.mapLayer.popupChanged)if(aa=this.params.popup?this.params.popup.getDefaultPopupInfo(aa,this.params.mapLayer.layer.isEditable(),this.params.mapLayer.layer):this.params.table.getDefaultPopupInfo(aa,this.params.mapLayer.layer.isEditable(),this.params.mapLayer.layer),aa.fieldInfos=b.filter(aa.fieldInfos,function(Ha){return Ha.fieldName!==ea.name}),this.params.mapLayer.popupInfo){oa=this.updatePopupInfo(this.params.mapLayer.popupInfo,ea,aa);arcgisonline.map.popup.removePopup(this.params.mapLayer);
this.params.mapLayer.popupInfo=oa;if(this.params.popup){if(za&&za.popupInfo&&this.params.mapLayer.popupChanged){var ya=this.updatePopupInfo(za.popupInfo,ea,aa);za.popupInfo=ya}this.params.mapLayer.popupChanged=this.params.mapLayer.popupChanged||(za&&za.popupInfo?!0:!1)}else this.params.mapLayer.popupChanged=!0;arcgisonline.map.popup.addPopupLayer(this.params.mapLayer,this.params.subLayerId)}else ya=this.updatePopupInfo(za.popupInfo,ea,aa),za.popupInfo=ya;-1!==["Feature Layer","Table"].indexOf(this.params.mapLayer.layer.type)?
(arcgisonline.map.edit.updateTypesAndTemplatesOnLayer(this.params.mapLayer.layer),this.params.mapLayer.featureTemplatesChanged=!0,this.params.popup&&arcgisonline.map.main.markMapAsChanged("addField"),za={id:this.params.mapLayer.id,itemCard:this.params.mapLayer.itemCard,itemId:this.params.mapLayer.itemId,layer:this.params.mapLayer.layer,origItemlayers:this.params.mapLayer.origItemlayers,popupInfo:ya||this.params.mapLayer.popupInfo,popupChanged:(ya||this.params.mapLayer.popupInfo)&&"Feature Layer"===
this.params.mapLayer.layer.type,serverToken:this.params.mapLayer.serverToken,serviceInfo:this.params.mapLayer.serviceInfo,title:this.params.mapLayer.title,type:this.params.mapLayer.type,url:this.params.mapLayer.url},za.serviceInfo.templates&&za.serviceInfo.templates.length?dojo.forEach(za.serviceInfo.templates,function(Ha){Ha.prototype.attributes[ea.name]=ea.defaultValue||null}):dojo.forEach(za.serviceInfo.types,function(Ha){dojo.forEach(Ha.templates,function(ua){ua.prototype.attributes[ea.name]=
ea.defaultValue||null})}),arcgisonline.map.itemData.updateFeatureServiceAfterAddRemoveField(za,q.hitch(this,function(Ha){this.params.mapLayer.layer.refresh();this.params.table.refreshTable(this.params.mapLayer,this.params.subLayerId,"add",ea.name)}))):this.params.table.refreshTable(this.params.mapLayer,this.params.subLayerId,"add",ea.name)}),q.hitch(this,function(aa){var ea=arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance();this._addBtn.set("disabled",!1);ea.show({title:this.i18n.errorTitle,
message:aa.details.join("\x3cbr/\x3e")})}))}),q.hitch(this,function(Z){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:Z.details.join("\x3cbr/\x3e")});this._addBtn.set("disabled",!1)}),q.hitch(this,function(Z){arcgisonline.sharing.dijit.dialog.GeneralDlg.prototype.statics.getInstance().show({title:this.i18n.errorTitle,message:Z.details.join("\x3cbr/\x3e")});this._addBtn.set("disabled",!1)}))}))}},updatePopupInfo:function(H,T,M){M=
{esriFieldTypeDouble:1,esriFieldTypeSingle:1};var L={esriFieldTypeDate:1};if(T.type in{esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1}){var X={places:0,digitSeparator:!0};esri.isDefined(T.defaultValue)&&(T.defaultValue=parseInt(T.defaultValue,10))}else T.type in M?(X={places:2,digitSeparator:!0},esri.isDefined(T.defaultValue)&&(T.defaultValue=parseFloat(T.defaultValue,10))):T.type in L&&(10<=this.params.mapLayer.layer.version||this.params.layer&&10<=this.params.layer.version)&&(X={dateFormat:"shortDateLongTime"});
var ba=q.mixin({},{fieldName:T.name,label:T.alias,isEditable:T.editable,tooltip:"",visible:!0,format:X,stringFieldOption:"textbox"});H&&H.fieldInfos&&(b.some(H.fieldInfos,function(ma){return ma.fieldName===ba.fieldName},this)||H.fieldInfos.push(ba));return H},_handleCancelButtonClick:function(){this._dialog.hide()},show:function(H){this._addForm.reset();this._addBtn.set("disabled",!1);this._dialog.show();this.params=H;this._checkNullable()},_validateFieldName:function(H){var T="ABSOLUTE ACCESS ACTION ADD ALL ALLOCATE ALPHANUMERIC ALTER And ANY ARE AS ASC ASSERTION AT AUTHORIZATION AUTOINCREMENT AVG BEGIN Between BINARY BIT BIT_LENGTH BOOLEAN BOTH BY BYTE CASCADE CASCADED CASE CAST CATALOG CHAR CHAR_LENGTH CHARACTER CHARACTER_LENGTH CHECK CLOSE COALESCE COLLATE COLLATION COLUMN COMMENT COMMIT CONNECT CONNECTION CONSTRAINT CONSTRAINTS CONTINUE CONVERT CORRESPONDING COUNT COUNTER CREATE CROSS CURRENCY CURRENT CURRENT_DATE CURRENT_TIME CURRENT_TIMESTAMP CURRENT_USER CURSOR DATABASE DATE DATETIME DAY DEALLOCATE DEC DECIMAL DECLARE DEFAULT DEFERRABLE DEFERRED DELETE DESC DESCRIBE DESCRIPTOR DIAGNOSTICS DISCONNECT DISALLOW DISTINCT DISTINCTROW DOMAIN DOUBLE DROP EQV ELSE END END-EXEC ESCAPE EXCEPT EXCEPTION EXEC EXECUTE EXISTS EXTERNAL EXTRACT FALSE FETCH FIRST FLOAT FLOAT4 FLOAT8 FOR FOREIGN FOUND FROM FULL GENERAL GET GLOBAL GO GOTO GRANT GROUP GUID HAVING HOUR IDENTITY IEEEDOUBLE IEEESINGLE IGNORE IMMEDIATE IMAGE IN IMP INDEX INDICATOR INITIALLY INNER INPUT INSENSITIVE INSERT INT INTEGER INTEGER4 INTEGER1 INTEGER2 INTERSECT INTERVAL INTO IS ISOLATION JOIN KEY LANGUAGE LAST LEADING LEFT LEVEL LIKE LOCAL LOCK LOGICAL LOGICAL1 LONG LONGBINARY LONGTEXT LOWER MATCH MAX MEMO MIN MINUTE MODULE MONTH MOD MONEY NAMES NATIONAL NATURAL NCHAR NEXT NO NOT NULL NULLIF NUMBER NUMERIC OCTET_LENGTH OF OFF OLEOBJECT ON ONLY OPEN OPTION OR ORDER OUTER OUTPUT OWNERACCESS OVERLAPS PAD PARTIAL PARAMETERS PERCENT PIVOT POSITION PRECISION PREPARE PRESERVE PRIMARY PRIOR PRIVILEGES PROCEDURE PUBLIC READ REAL REFERENCES RELATIVE RESTRICT REVOKE RIGHT ROLLBACK ROWID ROWS SCHEMA SCROLL SECOND SECTION SELECT SESSION SESSION_USER SET SHORT SINGLE SIZE SMALLINT SOME SPACE SQL SQLCODE SQLERROR SQLSTATE STDev STDEVP STRING SUBTYPE SUBSTRING SUM SYSTEM_USER TABLE TABLEID TEMPORARY TEXT THEN TIME TIMESTAMP TIMEZONE_HOUR TIMEZONE_MINUTE TO TOP TRAILING TRANSACTION TRANSFORM TRANSLATE TRANSLATION TRIM TRUE TYPE UNION UNIQUE UNKNOWN UPDATE UPPER USAGE USER USING VALUE VALUES VAR VARCHAR VARBINARY VARP VARYING VIEW WHEN WHENEVER WHERE WITH WORK WRITE XOR YEAR YESNO ZONE".split(" ");
if(H){if(128<H.length)return this._nameInput.set("invalidMessage",this.i18n.invalidFieldLengthMsg),!1;if(/[`~@#\$%\^&\*\(\)\\\-\+=\|,<>\?\/\{\}\.!'\[\]:;\n\r\s"]/.test(H)||/[`~@#\$%\^&\*\(\)\\\-\+=\|,<>\?\/\{\}\.!'\[\]:;\n\r\d_"]/.test(H.charAt(0)))return this._nameInput.set("invalidMessage",this.i18n.inValidFielNameCharMsg),!1;if(-1!==b.indexOf(T,H.toUpperCase()))return this._nameInput.set("invalidMessage",this.i18n.invalidSqlkeywordsMsg),!1;if(this.params.layer.fields&&0<this.params.layer.fields.length&&
(T=b.map(this.params.layer.fields,function(M){return M.name.toLowerCase()}),-1!==b.indexOf(T,H.toLowerCase())))return this._nameInput.set("invalidMessage",this.i18n.sameFielNameMsg),!1}else return!1;return!0}});q.setObject("arcgisonline.sharing.dijit.dialog.TableAddFieldDlg",e);return e})},"arcgisonline/sharing/dijit/dialog/WaitingDlg":function(){define(["dojo","dijit","dojox","dojo/require!dijit/Dialog,dijit/_Widget,dijit/_Templated"],function(e,U,q){e.provide("arcgisonline.sharing.dijit.dialog.WaitingDlg");
e.require("dijit.Dialog");e.require("dijit._Widget");e.require("dijit._Templated");e.declare("arcgisonline.sharing.dijit.dialog.WaitingDlg",[U._Widget,U._Templated],{widgetsInTemplate:!0,templateString:'\x3cdiv class\x3d"widgetContent"\x3e\r\n  \x3cdiv dojotype\x3d"dijit.Dialog" id\x3d"waiting-dialog" title\x3d"Notification" execute\x3d""\x3e\r\n    \x3cdiv id\x3d"waiting-dialog-content"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',reference:null,statics:{_instance:null,getInstance:function(){null==
this._instance&&(this._instance=new arcgisonline.sharing.dijit.dialog.WaitingDlg);return this._instance}},postCreate:function(){this.loadConnections()},show:function(b){this.clear();this.setTitle(b.title);this.setMessage(b.message);this.reference=b.reference;b.error&&e.addClass("waiting-dialog-content","error");esri.isDefined(b.duration)&&(U.byId("waiting-dialog").duration=b.duration);U.byId("waiting-dialog").show()},clear:function(){e.byId("waiting-dialog_title").innerHTML="";e.byId("waiting-dialog-content").innerHTML=
"";e.removeClass("waiting-dialog-content","error")},loadConnections:function(){},setTitle:function(b){b&&(e.byId("waiting-dialog_title").innerHTML=b)},setMessage:function(b){b&&(e.byId("waiting-dialog-content").innerHTML="\x3cp\x3e"+b+"\x3c/p\x3e")},hide:function(b){U.byId("waiting-dialog")&&(this.reference&&b&&this.reference!==b||U.byId("waiting-dialog").hide())}})})},"arcgisonline/pages/item/widgets/_usage":function(){define("require exports tslib ./_usageTheme ../../utils/arrays ../../utils/date ../../utils/number ../../../esriGeowConfig esri/Evented esri/request dojo/_base/lang dojo/_base/Color dojo/_base/fx dojo/_base/kernel dojo/query dojo/on dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-style dojo/date dojo/promise/all dojo/Deferred dojo/store/Memory dojo/text!./templates/_usage.html dojo/text!./templates/_usage-empty.html dojo/i18n!../../../nls/arcgisonline dojox/charting/Chart dojox/charting/plot2d/Grid dojox/charting/action2d/Tooltip dojox/charting/action2d/Highlight dojox/charting/action2d/Magnify dijit/_WidgetBase dijit/_TemplatedMixin dijit/registry dijit/form/DateTextBox ../../../tsutils/declareDecorator".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D,K,G,I,R,A,B,H,T){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);y=q.__importDefault(y);C=q.__importDefault(C);
z=q.__importDefault(z);F=q.__importDefault(F);O=q.__importDefault(O);V=q.__importDefault(V);N=q.__importDefault(N);J=q.__importDefault(J);D=q.__importDefault(D);K=q.__importDefault(K);G=q.__importDefault(G);I=q.__importDefault(I);R=q.__importDefault(R);A=q.__importDefault(A);B=q.__importDefault(B);H=q.__importDefault(H);T=q.__importDefault(T);return function(){function M(L){this.i18n=N["default"];this.templateString=O["default"];this.baseClass="usageDiv";this.totReqCountTitle=this.qDateLbl=this.dateToLbl=
this.dateFromLbl=this.custDateRngTitle=this.iuTitle="";this.totReqCountVal="--";this.totBandwidthTitle="";this.totBandwidthVal="--";this.avgCountPerDayTitle="";this.avgCountPerDayVal="--";this.avgBandwidthPerDayTitle="";this.avgBandwidthPerDayVal="--";this.chartInGmtMsg=this.bwChartTitle=this.countChartTitle=this.loginsVal=this.loginsTitle=this.creditsUsedVal=this.creditsUsedTitle="";this.showFileTypesAsView="Explorer Map;Explorer Layer;Map Document;Published Map;Scene Document;Document Link".split(";");
this.activeItem=L.item}M.prototype.postMixInProperties=function(){this.inherited(arguments);this.portal=this.page.portal;this.i18n=h["default"].mixin(this.i18n,this.i18n.usageView);this.periodParam="1d";this.dRangeObj={};this.itemAgeInDays=0;this.dir="ar"===n["default"].locale||"he"===n["default"].locale?"rtl":"ltr";this.definedQueryLengths=[{queryId:"last24Hours",queryLength:24,factor:"hour"},{queryId:"last7Days",queryLength:7,factor:"day"},{queryId:"last14Days",queryLength:14,factor:"day"},{queryId:"last30Days",
queryLength:30,factor:"day"},{queryId:"last45Days",queryLength:45,factor:"day"},{queryId:"last60Days",queryLength:60,factor:"day"},{queryId:"last6Months",queryLength:6,factor:"month"},{queryId:"last12Months",queryLength:12,factor:"month"}];this.isCustomRange=!1;this.createLocaleDatePatternsStore();this.writePageElements()};M.prototype.startup=function(){this.inherited(arguments);var L=new z["default"];this.initUI();L.resolve(this);return L};M.prototype.initUI=function(){this.itemAgeInDays=y["default"].difference(new Date(this.activeItem.created));
this.initHandlers()};M.prototype.initHandlers=function(){var L=this;this.createDropSelectElements(this.itemAgeInDays).then(function(){L.fetchUsageInfo()});this.own(t["default"](w["default"].byId(this.id+"-dateSelect"),"change",function(){return L.fetchUsageInfo()}));t["default"](window,"resize",function(){L.rChart&&L.rChart.axes&&L.rChart.resize()});t["default"](this.qDateRngBtn,"click",function(){return L.handleDateRngBtn()});t["default"](w["default"].byId("cntChartDiv"),"click",function(){document.activeElement instanceof
HTMLElement&&document.activeElement.blur()})};M.prototype.fetchUsageInfo=function(){this.handleViewLoader();this.resetDateRangeErrorMsg();this.usageDateRangeObj=this.calculateDateRange();this.handleDatePickerVisibility();this.isHosted=this.activeItem.isHostedService;this.isFile="file"===this.activeItem.classification&&!l["default"].includes(this.activeItem.types,"is-views")&&!l["default"].includes(this.activeItem.types,"is-pdf");this.isAppProxy=this.activeItem.isAppProxy;this.isRegApp=this.activeItem.isRegisteredApp;
this.setCountType();this.resetCountValues();if(null!==this.usageDateRangeObj||void 0!==this.usageDateRangeObj)this.usageParams=this.getItemTypeUsageParams(),this.qDatesArr=this.getQueryDatesArr(this.usageParams),this.isRegApp?this.getRegAppInfos(this.qDatesArr,this.usageParams):this.hideRegAppStats(),this.fetchItemUsage(this.qDatesArr,this.usageParams)};M.prototype.fetchItemUsage=function(L,X){var ba=this,ma=[],ta=this.getUsageUrl(),Ea=this.usageDateRangeObj,wa="1h"===this.periodParam?"1h":"1d";this.writeDateRangeTitle({start:Ea.startDate,
end:Ea.endDate});L.forEach(function(Q){X.startTime=Q.startDate;X.endTime=Q.endDate;X.period=wa;ma.push(d["default"]({url:ta,content:X}))});Ea=C["default"](ma);Ea.then(function(Q){var Z=0,aa=[];Q.forEach(function(ea){ea=ba.getUsageObject(ea);Z+=ea.count;ea.data.forEach(function(oa){aa.push(oa)})});0===Z?(v["default"].empty("cntChartEmptyDiv"),ba.setNoUsageValue(),ba.handleResultsContainerDisplay(!1),ba.writeChartTitle(Z),ba.handleViewLoader()):(v["default"].empty("cntChartDiv"),aa.sort(function(ea,
oa){return ea.date-oa.date}),ba.handleResultsContainerDisplay(!0),ba.writeChartTitle(Z),ba.processResults(aa))});Ea.otherwise(function(Q){ba.writeASMErrorReport(Q);ba.handleViewLoader()})};M.prototype.getUsageObject=function(L){var X=this,ba=[],ma=0;if(0<L.data.length)L.data[0].num.forEach(function(Q){Q={epoch:Number(Q[0]),date:new Date(Number(Q[0])),utc:(new Date(Number(Q[0]))).toUTCString(),count:Number(Q[1]),lbl:X.createChartLabel(Number(Q[0]))};ba.push(Q);ma+=Q.count});else{var ta=new Date(L.startTime);
L=y["default"].difference(ta,new Date(L.endTime));for(var Ea=0;Ea<L;Ea++){var wa=y["default"].add(ta,"day",Ea);wa={epoch:wa.getTime(),date:wa,utc:wa.toUTCString(),count:0,lbl:this.createChartLabel(wa.getTime())};ba.push(wa)}}return this.responseObj={data:ba,count:ma}};M.prototype.getRegAppInfos=function(L,X){var ba=this,ma=[],ta="1h"===this.periodParam?"1h":"1d",Ea=this.getUsageUrl();d["default"]({url:this.getRegisteredAppInfoUrl(),content:{f:"json"}}).then(function(wa){X.appId=wa.client_id;L.forEach(function(Z){Z=
q.__assign(q.__assign({},X),{startTime:Z.startDate,endTime:Z.endDate,period:ta,appId:wa.client_id,vars:"credits,num",name:void 0,groupby:"etype,stype"});ma.push(d["default"]({url:Ea,content:Z}))});var Q=C["default"](ma);Q.then(function(Z){return ba.calculateRegAppUsage(Z)});Q.otherwise(function(){return ba.hideRegAppStats()})})};M.prototype.hideRegAppStats=function(){u["default"].add("creditsUsedLbl","hide");u["default"].add("loginsValLbl","hide");w["default"].byId("creditsUsedVal").innerHTML="";
w["default"].byId("loginsVal").innerHTML=""};M.prototype.handleDatePickerVisibility=function(){var L=w["default"].byId(this.id+"-dateSelect").value;x["default"].set("datePickerDiv","display","block");"dsCustomRng"===L?(this.runNodeAnimation("datePickerDiv",{height:480>window.innerWidth?360:200}),this.createDateSelectors()):this.runNodeAnimation("datePickerDiv",{height:0})};M.prototype.runNodeAnimation=function(L,X){g["default"].animateProperty({node:w["default"].byId(L),duration:350,properties:X,
onEnd:function(){0===X.height?x["default"].set("datePickerDiv","display","none"):x["default"].set("datePickerDiv","display","block")}}).play()};M.prototype.createDateSelectors=function(){var L=this,X=B["default"].byId("dsStart"),ba=B["default"].byId("dsEnd");if(X||ba)this.usageDateRangeObj&&(B["default"].byId("dsStart").set("value",this.usageDateRangeObj.startDate),B["default"].byId("dsEnd").set("value",this.usageDateRangeObj.endDate));else{var ma=y["default"].add(new Date,"year",-2);this.usageDateRangeObj?
(X=this.usageDateRangeObj.startDate,ba=this.usageDateRangeObj.endDate):(X=y["default"].add(new Date,"day",-2),ba=new Date);(new H["default"]({name:"startDate",constraints:{min:new Date(ma.valueOf()),max:new Date},value:X,onChange:function(){return L.handleDateSelectorChange()}},"dsStart")).startup();(new H["default"]({name:"endDate",constraints:{min:new Date(ma.valueOf()),max:new Date},value:ba,onChange:function(){return L.handleDateSelectorChange()}},"dsEnd")).startup()}};M.prototype.handleDateSelectorChange=
function(){var L=B["default"].byId("dsStart").get("value"),X=B["default"].byId("dsEnd").get("value"),ba=y["default"].difference(L,X),ma=y["default"].isLeapYear(X)?366:365;L&&X&&(0<=ba&&ba<=ma?(this.qDateRngBtn.disabled=!1,this.resetDateRangeErrorMsg()):(this.qDateRngBtn.disabled=!0,ba>ma?w["default"].byId("customDateErrorDiv").innerHTML=this.i18n.dateRangeErrorMsgLength:w["default"].byId("customDateErrorDiv").innerHTML=this.i18n.dateRangeErrorMsgOrder,u["default"].add("customDateErrorDiv","is-active")))};
M.prototype.calculateDateRange=function(){var L=w["default"].byId(this.id+"-dateSelect").value;this.isCustomRange=L&&"dsCustomRng"===L;if(!this.isCustomRange){var X=this.definedQueryLengths.filter(function(ba){return ba.queryId===L});this.dRangeObj={};this.dRangeObj.endDate=new Date;this.dRangeObj.startDate=y["default"].add(new Date,X[0].factor,-1*X[0].queryLength);this.dRangeObj.diff=y["default"].difference(this.dRangeObj.startDate,this.dRangeObj.endDate);this.periodParam=this.getPeriodParamVal(this.dRangeObj.diff)}return this.dRangeObj};
M.prototype.clearChartDivs=function(){v["default"].empty("cntChartDiv")};M.prototype.getItemTypeUsageParams=function(){var L=this.usageDateRangeObj.endDate;if(this.isCustomRange){L=y["default"].add(L,"day",1);var X=new Date;L.getTime()>X.getTime()&&(L=X)}L={f:"json",startTime:Math.floor(this.usageDateRangeObj.startDate.getTime()/1E3)+"000",endTime:Math.floor(L.getTime()/1E3)+"000",period:this.periodParam,vars:"num",groupby:"name",etype:"svcusg",name:"",stype:this.getUsageStypeByItemType(this.activeItem.type)};
this.isHosted?(X=/(\/(MapServer|WFSServer|GeocodeServer|SceneServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|WMServer|VectorTileServer)).*/gi,X=this.activeItem.url&&this.activeItem.url.replace(X,"").replace(/^.*\//,"").replace(/\?.*$/,""),L.etype="svcusg",L.name=X,L.stype=this.getUsageStypeByItemType(this.activeItem.type)):L.name=this.activeItem.id;return L};M.prototype.getUsageUrl=function(){return a["default"].restBaseUrl+"portals/"+this.portal.id+
"/usage"};M.prototype.getRegisteredAppInfoUrl=function(){var L=this.activeItem,X=L.owner,ba=L.folderId;L=L.id;var ma=a["default"].restBaseUrl.split(":");ma[0]="https:";ma=ma[0]+ma[1]+"content/users/";return ba&&void 0!==ba?""+ma+X+"/"+ba+"/items/"+L+"/registeredAppInfo":""+ma+X+"/items/"+L+"/registeredAppInfo"};M.prototype.getUsageStypeByItemType=function(L){switch(L){case "Feature Service":var X="features";break;case "Map Service":X="tiles";break;case "WFS":X="wfs";break;case "WMTS":X="wmts";break;
case "Scene Service":X="scene";break;case "Vector Tile Service":X="vectortiles"}return X};M.prototype.processResults=function(L){var X=0,ba=this.usageDateRangeObj.diff;this.clearChartDivs();this.createUsageCharts(L);this.createAccessibilityTable(L);L.forEach(function(ma){X+=ma.count;w["default"].byId("totReqCountVal").innerHTML=r["default"].format(X,0);w["default"].byId("avgCountPerDayVal").innerHTML=1<ba?r["default"].format(X/ba,2):"--"});this.handleViewLoader()};M.prototype.setNoUsageValue=function(){this.clearChartDivs();
var L='\x3cdiv class\x3d"emptyChartDiv text-center"\x3e'+V["default"]+'\x3cp class\x3d"font-size-3 text-gray"\x3e'+this.i18n.noUsageMsg+"\x3c/p\x3e\x3c/div\x3e";w["default"].byId("totReqCountVal").innerHTML="0";w["default"].byId("avgCountPerDayVal").innerHTML="0";v["default"].place(L,"cntChartDiv","last");u["default"].add("cntChartDiv","hide");u["default"].remove("cntChartEmptyDiv","hide");v["default"].place(L,"cntChartEmptyDiv","last");this.createAccessibilityTable([])};M.prototype.createAccessibilityTable=
function(L){var X;m["default"](".accessTable").forEach(v["default"].destroy);if(0<L.length)L.forEach(function(ma){ba="\x3ctr\x3e\x3ctd\x3e"+ma.utc+"\x3c/td\x3e\x3ctd\x3e"+ma.count+"\x3c/td\x3e\x3c/tr\x3e";X+=ba});else{var ba="\x3ctr\x3e\x3ctd\x3e"+this.i18n.noUsageMsg+"\x3c/td\x3e\x3ctd\x3e0\x3c/td\x3e\x3c/tr\x3e";X+=ba}v["default"].place("\x3cdiv class\x3d\"accessTable screen-readers-only\"\x3e\x3ctable\x3e\n      \x3ccaption style\x3d'caption-side: top'\x3e\n        "+(this.i18n.uTableCaption+"\n      \x3c/caption\x3e\n      \x3cthead\x3e\n        \x3ctr\x3e\n          \x3cth scope\x3d'column'\x3e\n           "+
this.i18n.date+"\n          \x3c/th\x3e\n          \x3cth scope\x3d'column'\x3e\n            "+this.i18n.cValue+"\n          \x3c/th\x3e\n        \x3c/tr\x3e\n      \x3c/thead\x3e\n        "+X+'\n    \x3c/table\x3e"\x3c/div\x3e'),"tzMsg","last")};M.prototype.createUsageCharts=function(L){var X=this;this.getUsageChart(L,"cntChartDiv").then(function(ba){X.rChart=ba;var ma=X.getUsageChartTooltipLabel();X.rChart.axes.y.opt.title=ma;new I["default"](X.rChart,"default",{scale:3});new G["default"](X.rChart,
"default",{highlight:"#fff"});new K["default"](X.rChart,"default",{text:function(ta){return'\x3cspan style\x3d"text-align: center"\x3e'+ma+": "+ta.y+"\x3c/span\x3e"}});X.rChart.render()})};M.prototype.getUsageChartTooltipLabel=function(){return this.isHosted?this.i18n.requests:this.isFile?l["default"].includes(this.showFileTypesAsView,this.activeItem.type)?this.i18n.views:this.i18n.downloads:"Desktop Application"===this.activeItem.type?this.i18n.downloads:this.i18n.views};M.prototype.getUsageChart=
function(L,X){var ba=new z["default"],ma=new J["default"](X,{dir:"ltr",textDir:this.dir}),ta=[],Ea=0,wa=new f["default"]({r:246,g:249,b:253,a:.8});L.forEach(function(oa){ta.push(oa.count);Ea=oa.count>Ea?oa.count:Ea});var Q=this.calculateVertTickStep(Ea),Z=this.calculateHorTickStep(),aa=this.calculateVertOffset(Ea),ea=this.calculateHortOffset(ta.length);ma.setTheme(b["default"]);ma.setDir(this.dir);ma.addPlot("default",{type:"Areas",markers:!0,tension:"S"});ma.addAxis("x",{includeZero:!1,majorTicks:!0,
majorTick:{length:6,color:"#D5D5D5",width:1},minorTicks:!1,majorTickStep:Z,labels:!0,htmlLabels:"rtl"!==this.dir,max:ta.length+ea,labelFunc:function(oa,ra){var za=ra-1;return za+1>ta.length?" ":L[za].lbl}});ma.addAxis("y",{natural:!0,vertical:!0,majorTicks:!0,majorTick:{length:6,color:"#D5D5D5",width:1},minorTicks:!1,includeZero:!0,majorTickStep:Q,titleFontColor:"#959595",fixUpper:"major",max:Ea+aa,htmlLabels:"rtl"!==this.dir,majorLabels:!0,minorLabels:!1,labelFunc:function(oa,ra){return 0===ra?" ":
oa}});ma.addSeries("usageseries",ta,{stroke:{color:"#0079C1",width:2},fill:"rgba(86,165,219,0.5)",marker:"m-3,0 c0,-4 6,-4 6,0 m-6,0 c0,4 6,4 6,0"});ma.addPlot("grid",{type:D["default"],renderOnAxis:!0,hFill:wa,vFill:wa,hMajorLines:!1,vMajorLines:!1,hStripes:!0,vStripes:!1});ba.resolve(ma);return ba.promise};M.prototype.writeDateRangeTitle=function(L){var X=new Date(L.end),ba="rtl"===this.dir?" \x26#8207;":" ";L=p["default"].format(new Date(L.start),"long-month-day-year");X=p["default"].format(X,
"long-month-day-year");w["default"].byId("uTitle").innerHTML="\x3cspan class\x3d'font-size--1'\x3e\n        "+this.i18n.iuTitle+"\n      \x3c/span\x3e\n      \x3cbr/\x3e\n      \x3cspan class\x3d'trailer-half header-light font-size-1 text-darkest-gray'\x3e\n        "+L+"\n        "+ba+" - "+ba+"\n        "+X+"\n      \x3c/span\x3e";this.setLocalTimeStamp()};M.prototype.writeChartTitle=function(L){w["default"].byId("countChartTitle").innerHTML=0===L?"":this.i18n.cTitleCountsRequests};M.prototype.createChartLabel=
function(L){L=new Date(L);return"1h"===this.periodParam?p["default"].format(L,"short-time"):"en"===n["default"].locale||"en-us"===n["default"].locale?p["default"].format(L,"short-date-no-year"):p["default"].format(L,"day-short-month-year")};M.prototype.writePageElements=function(){this.totReqCountTitle=this.i18n.totalRequests;this.avgCountPerDayTitle=this.i18n.avgDailyRequests;this.creditsUsedTitle=this.i18n.totalCredits;this.countChartTitle=this.i18n.cTitleCountsRequests;this.custDateRngTitle=this.i18n.custDateRngTitle;
this.dateFromLbl=this.i18n.dateFromLbl;this.dateToLbl=this.i18n.dateToLbl;this.qDateLbl=this.i18n.qDateLbl;this.loginsTitle=this.i18n.totalLogins};M.prototype.setCountType=function(){this.isHosted?(w["default"].byId("totReqCountLbl").innerHTML=this.i18n.totalRequests,w["default"].byId("avgCountPerDayLbl").innerHTML=this.i18n.avgDailyRequests):this.isFile?l["default"].includes(this.showFileTypesAsView,this.activeItem.type)?(w["default"].byId("totReqCountLbl").innerHTML=this.i18n.totalViews,w["default"].byId("avgCountPerDayLbl").innerHTML=
this.i18n.avgDailyViews):(w["default"].byId("totReqCountLbl").innerHTML=this.i18n.totalDownloads,w["default"].byId("avgCountPerDayLbl").innerHTML=this.i18n.avgDailyDownloads):("Desktop Application"===this.activeItem.type&&(w["default"].byId("totReqCountLbl").innerHTML=this.i18n.totalDownloads,w["default"].byId("avgCountPerDayLbl").innerHTML=this.i18n.avgDailyDownloads),w["default"].byId("totReqCountLbl").innerHTML=this.i18n.totalViews,w["default"].byId("avgCountPerDayLbl").innerHTML=this.i18n.avgDailyViews)};
M.prototype.createDropSelectElements=function(L){var X=new z["default"],ba,ma=w["default"].byId(this.id+"-dateSelect"),ta=ma.options;w["default"].byId("last24Hours").innerHTML=this.i18n.dsLast24h;w["default"].byId("last7Days").innerHTML=this.i18n.dsLast7d;w["default"].byId("last14Days").innerHTML=this.i18n.dsLast14d;w["default"].byId("last30Days").innerHTML=this.i18n.dsLast30d;w["default"].byId("last45Days").innerHTML=this.i18n.dsLast45d;w["default"].byId("last60Days").innerHTML=this.i18n.dsLast60d;
w["default"].byId("last6Months").innerHTML=this.i18n.dsLast6m;w["default"].byId("last12Months").innerHTML=this.i18n.dsLast12m;w["default"].byId("dsCustomRng").innerHTML=this.i18n.dsCustomRng;1>L?ba="last24hours":1<L&&8>L?ba="last7Days":7<L&&15>L?ba="last14Days":14<L&&(ba="last30Days");for(L=0;L<ta.length;L++)ta[0].id===ba&&(ma.selectedIndex=L);X.resolve();return X.promise};M.prototype.handleDateRngBtn=function(){var L=B["default"].byId("dsStart").get("value"),X=B["default"].byId("dsEnd").get("value"),
ba=y["default"].difference(L,X);this.qDateRngBtn.disabled=!0;document.activeElement instanceof HTMLElement&&document.activeElement.blur();this.dRangeObj={endDate:X,startDate:L,diff:ba};this.periodParam=this.getPeriodParamVal(ba);this.fetchUsageInfo()};M.prototype.getPeriodParamVal=function(L){var X;2>L?X="1h":1<L&&90>L?X="1d":89<L&&180>L?X="1w":181<L&&(X="1m");return X};M.prototype.calculateVertTickStep=function(L){return 9<L?Math.round(1.5*L/5):5<L&&10>L?Math.round(1.5*L/2):2};M.prototype.calculateVertOffset=
function(L){var X=0;1<L?X=.5:50<L?X=1:1E3<L?X=10:5E3<L?X=25:1E4<L&&(X=50);return X};M.prototype.calculateHorTickStep=function(){return Math.ceil(this.dRangeObj.diff/30)||1};M.prototype.calculateHortOffset=function(L){var X=.25;250<L?X=5:175<L?X=2.75:60<L?X=1.25:18<L&&(X=.75);return X};M.prototype.setLocalTimeStamp=function(){r["default"].format((new Date).getTimezoneOffset()/60*-1)};M.prototype.calculateRegAppUsage=function(L){var X=0,ba=0;null===L||void 0===L?void 0:L.forEach(function(ma){null===
ma||void 0===ma?void 0:ma.data.forEach(function(ta){"svcusg"===ta.etype&&"apploginprovider"===ta.stype?ta.num.forEach(function(Ea){ba+=Number(Ea[1])}):ta.credits.forEach(function(Ea){X+=Number(Ea[1])})})});w["default"].byId("creditsUsedVal").innerHTML=r["default"].format(X,2);w["default"].byId("loginsVal").innerHTML=r["default"].format(ba,0);this.isAppProxy?(u["default"].remove("creditsUsedLbl","hide"),u["default"].add("loginsValLbl","hide")):(u["default"].remove("loginsValLbl","hide"),u["default"].add("creditsUsedLbl",
"hide"))};M.prototype.getQueryDatesArr=function(L){var X=[],ba=L.period,ma=L.startTime;L=L.endTime;var ta=new Date(Number(ma)),Ea=new Date(Number(L));"1h"===ba||"1d"===ba?X.push({startDate:ma,endDate:L}):X=this.calculateDatesArr(ta,Ea);return X};M.prototype.calculateDatesArr=function(L,X){function ba(wa){wa>=X?ma.push({startDate:String(ta.getTime()),endDate:String(X.getTime())}):(ma.push({startDate:String(ta.getTime()),endDate:String(wa.getTime())}),ta=wa,wa=y["default"].add(ta,"day",60),ba(wa))}
var ma=[],ta=L,Ea=y["default"].add(ta,"day",60);ba(Ea);return ma};M.prototype.resetDateRangeErrorMsg=function(){u["default"].remove("customDateErrorDiv","is-active");w["default"].byId("customDateErrorDiv").innerHTML=""};M.prototype.resetCountValues=function(){w["default"].byId("totReqCountVal").innerHTML="--";w["default"].byId("avgCountPerDayVal").innerHTML="--";w["default"].byId("creditsUsedVal").innerHTML="--";w["default"].byId("loginsVal").innerHTML="--"};M.prototype.writeASMErrorReport=function(L){this.clearChartDivs();
w["default"].byId("totReqCountVal").innerHTML="--";w["default"].byId("avgCountPerDayVal").innerHTML="--";v["default"].place('\x3cdiv class\x3d"emptyChartDiv text-center"\x3e\n        '+V["default"]+'\n      \x3cp class\x3d"font-size-3 text-gray"\x3e\n        '+this.i18n.errUsageMsg+"\n      \x3c/p\x3e\n      \x3c/div\x3e","cntChartDiv","last");this.createAccessibilityTable([])};M.prototype.createLocaleDatePatternsStore=function(){this.localeDatePatternsStore=new F["default"]({data:[{locale:"en",shortTime:"h:mm a",
shortDate:"M/d/yy",shortDateNoYear:"M/d",shortDateNoDay:"M/yy"},{locale:"en-us",shortTime:"h:mm a",shortDate:"M/d/yy",shortDateNoYear:"M/d",shortDateNoDay:"M/yy"},{locale:"ar",shortTime:"h:mm a",shortDate:"d/M/y",shortDateNoYear:"d/M",shortDateNoDay:"M/y"},{locale:"ar",shortTime:"h:mm a",shortDate:"y/M/d",shortDateNoYear:"M/d",shortDateNoDay:"y/M"},{locale:"bs",shortTime:"H:mm",shortDate:"dd.MM.yy",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.yy"},{locale:"cs",shortTime:"H:mm",shortDate:"dd.MM.yy",
shortDateNoYear:"dd.MM",shortDateNoDay:"MM.yy"},{locale:"da",shortTime:"HH:mm",shortDate:"dd/MM/y",shortDateNoYear:"dd/MM",shortDateNoDay:"MM/y"},{locale:"de",shortTime:"HH:mm",shortDate:"dd.MM.yy",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.yy"},{locale:"el",shortTime:"h:mm a",shortDate:"d/MM/yy",shortDateNoYear:"d/MM",shortDateNoDay:"M/yy"},{locale:"es",shortTime:"H:mm",shortDate:"d/MM/yy",shortDateNoYear:"d/MM",shortDateNoDay:"MM/yy"},{locale:"et",shortTime:"HH:mm",shortDate:"dd.MM.yy",shortDateNoYear:"dd.MM",
shortDateNoDay:"MM.yy"},{locale:"fi",shortTime:"H.mm",shortDate:"d.M.y",shortDateNoYear:"d.M",shortDateNoDay:"M.y"},{locale:"fr",shortTime:"HH:mm",shortDate:"dd/MM/y",shortDateNoYear:"dd/MM",shortDateNoDay:"MM/y"},{locale:"he",shortTime:"H:mm",shortDate:"d.M.y",shortDateNoYear:"d.M",shortDateNoDay:"M.y"},{locale:"hi",shortTime:"h:mm a",shortDate:"d/M/yy",shortDateNoYear:"d/M",shortDateNoDay:"M/yy"},{locale:"hr",shortTime:"HH:mm",shortDate:"dd.MM.y.",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.y"},
{locale:"id",shortTime:"HH:mm",shortDate:"dd/MM/yy",shortDateNoYear:"dd/MM",shortDateNoDay:"MM/yy"},{locale:"it",shortTime:"HH:mm",shortDate:"dd/MM/yy",shortDateNoYear:"dd/MM",shortDateNoDay:"MM/yy"},{locale:"ja",shortTime:"H:mm",shortDate:"y/MM/dd",shortDateNoYear:"MM/dd",shortDateNoDay:"y/MM"},{locale:"ko",shortTime:"a h:mm",shortDate:"yy.M.d.",shortDateNoYear:"M.d.",shortDateNoDay:"yy.M"},{locale:"lt",shortTime:"HH:mm",shortDate:"y-MM-dd",shortDateNoYear:"MM-dd",shortDateNoDay:"y-MM"},{locale:"lv",
shortTime:"HH:mm",shortDate:"dd.MM.yy",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.yy"},{locale:"nb",shortTime:"HH:mm",shortDate:"dd.MM.y",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.y"},{locale:"nl",shortTime:"HH:mm",shortDate:"dd-MM-yy",shortDateNoYear:"dd-MM",shortDateNoDay:"MM-yy"},{locale:"pl",shortTime:"HH:mm",shortDate:"dd.MM.y",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.y"},{locale:"pt-br",shortTime:"HH:mm",shortDate:"dd/MM/y",shortDateNoYear:"dd/MM",shortDateNoDay:"MM/y"},{locale:"pt-pt",shortTime:"HH:mm",
shortDate:"dd/MM/yy",shortDateNoYear:"dd/MM",shortDateNoDay:"MM/yy"},{locale:"ro",shortTime:"HH:mm",shortDate:"dd.MM.y",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.y"},{locale:"ru",shortTime:"H:mm",shortDate:"dd.MM.y",shortDateNoYear:"dd.MM",shortDateNoDay:"MM.y"},{locale:"sr",shortTime:"HH:mm",shortDate:"d.M.yy.",shortDateNoYear:"d.M",shortDateNoDay:"M.yy"},{locale:"sv",shortTime:"HH:mm",shortDate:"y-MM-dd",shortDateNoYear:"MM-dd",shortDateNoDay:"y-MM"},{locale:"th",shortTime:"HH:mm",shortDate:"d/M/yy",
shortDateNoYear:"d/M",shortDateNoDay:"M/yy"},{locale:"tr",shortTime:"HH:mm",shortDate:"d.MM.y",shortDateNoYear:"d.MM",shortDateNoDay:"MM.y"},{locale:"vi",shortTime:"HH:mm",shortDate:"dd/MM/y",shortDateNoYear:"dd/MM",shortDateNoDay:"MM/y"},{locale:"zh-cn",shortTime:"ah:mm",shortDate:"y/M/d",shortDateNoYear:"M/d",shortDateNoDay:"y/M"},{locale:"zh-hk",shortTime:"ah:mm",shortDate:"y/M/d",shortDateNoYear:"M/d",shortDateNoDay:"y/M"},{locale:"zh-tw",shortTime:"ah:mm",shortDate:"y/M/d",shortDateNoYear:"M/d",
shortDateNoDay:"y/M"}],idProperty:"locale"})};M.prototype.getLocaleDatePatternValue=function(L,X){var ba="MMM d",ma=this.localeDatePatternsStore.query({locale:L});0<ma.length&&(ba=ma[0][X]);return ba};M.prototype.handleViewLoader=function(){"none"===x["default"].get("chartLoaderDiv","display")?x["default"].set("chartLoaderDiv","display","block"):x["default"].set("chartLoaderDiv","display","none")};M.prototype.handleResultsContainerDisplay=function(L){L?(u["default"].remove("cntChartDiv","hide"),u["default"].add("cntChartEmptyDiv",
"hide")):(u["default"].add("cntChartDiv","hide"),u["default"].remove("cntChartEmptyDiv","hide"))};return M=q.__decorate([T["default"](R["default"],A["default"],c["default"])],M)}()})},"arcgisonline/pages/item/widgets/_usageTheme":function(){define(["require","exports","tslib","dojox/charting/SimpleTheme"],function(e,U,q,b){Object.defineProperty(U,"__esModule",{value:!0});b=q.__importDefault(b);e=new b["default"]({chart:{stroke:null,fill:"inherit"},plotarea:{stroke:null,fill:"transparent"},axis:{stroke:{width:1,
color:"#CCCCCC"},titleFontColor:"#FF0000",tick:{position:"center",font:"normal normal normal 8pt 'Avenir Next W01', 'Avenir Next W00', 'Avenir Next', 'Avenir', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif",labelGap:4},majorTick:{color:"#959595",width:1,length:5},minorTick:{color:"#D5D5D5",width:1,length:2},title:{gap:10,font:"normal normal normal 11pt 'Avenir Next W01', 'Avenir Next W00', 'Avenir Next', 'Avenir', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif",fontColor:"#959595",orientation:"axis"}},
series:{outline:null,stroke:{width:1,color:"#959595"},fill:"#FF0000",font:"normal normal normal 7pt Arial",fontColor:"#717171"},marker:{stroke:{width:1,color:"#000000"},fill:"#333333",font:"normal normal normal 7pt Arial",fontColor:"#959595"},indicator:{lineStroke:{width:1.5,color:"#959595"},lineOutline:{width:.3,color:"#FFFFFF"},lineShadow:null,lineFill:null,stroke:{width:3,color:"#56A5DB"},outline:{width:3,color:"#56A5DB"},shadow:null,fill:"#56A5DB",radius:0,font:"normal normal normal 11pt 'Avenir Next W01', 'Avenir Next W00', 'Avenir Next', 'Avenir', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif",
fontColor:"#FFFFFF",markerFill:"#FF0000",markerSymbol:"m-3,0 c0,-4 6,-4 6,0 m-6,0 c0,4 6,4 6,0",markerStroke:{width:1,color:"#FF0000"},markerOutline:{width:.1,color:"#959595"},markerShadow:null},title:{style:{color:"#FF0000",font:"bold 16px 'Trebuchet MS', Verdana, sans-serif"}},colors:["#5BAFE8","#8C8B62","#CA8536","#70828C","#BFAF99"]});U["default"]=e})},"arcgisonline/pages/item/widgets/_preview":function(){define("require exports tslib dojo/dom dojo/on dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin dojo/Deferred dojo/text!./templates/_preview.html arcgisonline/pages/utils/notebook arcgisonline/tsutils/declareDecorator arcgisonline/pages/utils/dom ../../utils/queryHandler".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importStar(n);return function(){function m(t,w){this.templateString=d["default"];this.queryObject=n.queryToObject(window.location.search.substring(1))}m.prototype.startup=function(){this.inherited(arguments);return this.initUI()};
m.prototype.postCreate=function(){this.inherited(arguments);g["default"].hideNode(document.getElementById("footer"))};m.prototype.destroy=function(){this.inherited(arguments);this.page.removeError();g["default"].showNode(b["default"].byId("footer"))};m.prototype.setupEventListeners=function(){var t=this;l["default"](this.notebookFrame,"load",function(){t.loader.classList.remove("is-active");t.notebookFrame.style.display="inherit";t.notebookFrame.style.height=t.notebookFrame.contentWindow.document.body.scrollHeight+
50+"px"})};m.prototype.initUI=function(){var t=this,w=new c["default"];this.setupEventListeners();h["default"].showNotebookPreview(this.notebookFrame,this.queryObject.id,"notebook_preview.json").then(function(u){u.success||t.showPreviewError();w.resolve(u.success)},function(u){t.showPreviewError(u);w.resolve(!1)});return w};m.prototype.showPreviewError=function(t){var w=this.i18n.itemProperties,u=w.previewError404;w=w.previewError;this.error.innerHTML=404===(null===t||void 0===t?void 0:t.code)?u:
w;p["default"].add(this.error,"is-active");this.page.hideLoader()};return m=q.__decorate([f["default"](r["default"],a["default"])],m)}()})},"arcgisonline/pages/item/widgets/_layers":function(){define("require exports tslib dojo/_base/lang dojo/Deferred dojo/dom-class dojo/dom-attr dojo/on dojo/topic dojo/string dojo/promise/all dojo/cookie dijit/_WidgetBase dijit/_TemplatedMixin arcgisonline/pages/item/_Info arcgisonline/pages/pageUtil arcgisonline/pages/utils/alerts arcgisonline/pages/utils/arrays arcgisonline/pages/utils/date arcgisonline/pages/dijit/View arcgisonline/pages/dijit/Pagination arcgisonline/pages/dijit/ControlBar arcgisonline/sharing/dijit/dialog/CreateLayersDlg arcgisonline/sharing/dijit/dialog/DeleteWarningDlg arcgisonline/sharing/dijit/dialog/SyncLayersDlg arcgisonline/sharing/util arcgisonline/esriGeowConfig dojo/text!./templates/_layers.html dojo/text!./templates/layers/_empty.html dojo/text!./templates/layers/_none.html dojo/text!./templates/layers/_tableHead.html dojo/text!./templates/layers/_tableRow.html dojo/text!./templates/layers/_controlBarActions.html dojo/i18n!arcgisonline/nls/arcgisonline arcgisonline/tsutils/declareDecorator arcgisonline/pages/utils/dom".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D,K,G,I,R,A,B,H){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);y=q.__importDefault(y);C=q.__importDefault(C);
z=q.__importDefault(z);F=q.__importDefault(F);O=q.__importDefault(O);V=q.__importDefault(V);N=q.__importDefault(N);J=q.__importDefault(J);D=q.__importDefault(D);K=q.__importDefault(K);G=q.__importDefault(G);I=q.__importDefault(I);R=q.__importDefault(R);A=q.__importDefault(A);B=q.__importDefault(B);H=q.__importDefault(H);return function(){function T(){this.templateString=d["default"].substitute(J["default"],{i18n:A["default"]});this.initialView="table";this.filteredLayers=[];this.searchTerm="";this.searchBy=
"layerName";this.folderSvg='\x3csvg viewBox\x3d"0 0 16 16" width\x3d"16" height\x3d"16" class\x3d"folder-icon"\x3e\x3cpath d\x3d"M7.3 3.002L5.98 2H3L1.7 3H0v11h15V3zM14 6H1V4h1.04l1.3-1h2.304l1.319 1H14zm0 7H1V7h13z"\x3e\x3c/path\x3e\x3c/svg\x3e';this.tablePage={start:1,num:20,total:0,nextStart:-1};this._sort={property:"created",label:A["default"].itemProperties.layerCreated,ascending:!1};this.sortOptions=[{property:"layerName",label:A["default"].itemProperties.layerName1,ascending:!0},{property:"layerType",
label:A["default"].itemProperties.layerTypeLabel,ascending:!0},{property:"datasetName",label:A["default"].itemProperties.datasetName,ascending:!0},{property:"created",label:A["default"].itemProperties.layerCreated,ascending:!1,active:!0}]}T.prototype.postCreate=function(){this.inherited(arguments);this.i18n=A["default"];this.sortOptions=b["default"].clone(this.sortOptions)};T.prototype.startup=function(){var M=this;this.inherited(arguments);this.addEventListeners();this.setHelpLinks();var L=new l["default"];
this.getLayersAndStatus().then(function(){return M.initUI(!0)}).then(function(X){return L.resolve(X)},function(X){return L.reject(X)});return L};T.prototype.setHelpLinks=function(){var M=N["default"].self;this._createLayersMessage.innerHTML=d["default"].substitute(this.i18n.itemProperties.createLayersMessage,[(null===M||void 0===M?0:M.helpMap)?M.helpBase+M.helpMap.m["120001719"]:""])};T.prototype.getLayersAndStatus=function(){var M=this,L=new l["default"];h["default"]([this.getItemStatus(),this.getLayers()]).then(function(X){var ba=
X[0];X=X[1];ba&&X?(M.status=ba,M.layers=X.layerAndDatasets.map(function(ma){var ta,Ea,wa=ma.layer;"map service"===(null===(ta=null===wa||void 0===wa?void 0:wa.type)||void 0===ta?void 0:ta.toLowerCase())?(wa.iconUrl="/mapimages16.svg",wa.layerType="Map Image Layer"):"feature service"===(null===(Ea=null===wa||void 0===wa?void 0:wa.type)||void 0===Ea?void 0:Ea.toLowerCase())?(wa.iconUrl="/features16.png",wa.layerType="Feature Layer"):(wa.iconUrl="/features16.png",wa.layerType="");ta=wa.id;Ea=wa.title;
var Q=wa.created,Z=wa.type,aa=wa.url;return{info:m["default"].getItemInfo(wa),itemUrl:N["default"].baseUrl+"item.html?id\x3d"+ta,layerId:ta,layerName:Ea,layerType:wa.layerType,layerUrl:aa,iconUrl:ma.layer.svgIconUrl16,createdDisplay:M.formatDate(parseInt(Q,10),"medium"),created:Q,datasetName:M.formatPath(ma.dataset.path),datasetType:Z}})):M.status={status:"error",message:(null===ba||void 0===ba?void 0:ba.message)||""};M.checkDeleteJob();M.checkSyncJob();M.isDeleteJob||M.findPublishedFolder();L.resolve()});
return L};T.prototype.formatPath=function(M){return"/"===(null===M||void 0===M?void 0:M[0])?M.substring(1):M};T.prototype.findPublishedFolder=function(){var M=this;this.getFolder().then(function(L){L.currentFolder&&(M.folder=L.currentFolder,M._folderContainer.innerHTML=d["default"].substitute(M.i18n.itemProperties.layersFolder,[M.folderSvg,'\x3ca class\x3d"tooltip tooltip-top" aria-label\x3d"'+M.i18n.itemProperties.viewLayersFolder+'" href\x3d"'+N["default"].baseUrl+"content.html?folder\x3d"+M.folder.id+
'"\x3e'+M.folder.title+"\x3c/a\x3e"]))},function(L){})};T.prototype.checkDeleteJob=function(){var M,L;this.isDeleteJob="deleteAllBPLayers"===(null===(L=null===(M=this.status)||void 0===M?void 0:M.jobInfo)||void 0===L?void 0:L.jobType)};T.prototype.formatDate=function(M,L){var X;!1===M instanceof Date&&(X=new Date(M));var ba="short-date-numeric";"medium"===L?ba="day-short-month-year":"long"===L&&(ba="long-month-day-year");return M?v["default"].format(X,ba):""};T.prototype.startDeleteLayers=function(){var M=
this;t["default"].createSpecifiedDialog(F["default"]).show(this.layers.length,null,function(){return M.handleDelete()})};T.prototype.handleDelete=function(){var M=this;this.hidePublishedLayers();H["default"].showNode(this.domNode.querySelector(".icon-ui"));H["default"].hideNode(this._dismissBtn);H["default"].showNode(this._iconJobRunning);H["default"].showNode(this._notificationContainer);H["default"].hideNode(this._errorContainer);this._statusTextContainer.innerHTML=this.i18n.itemProperties.deletingLayers;
V["default"].request({url:N["default"].restBaseUrl+"portals/self/datastores/allDatasets/deleteLayers",content:{datastoreId:this.item.id}},{usePost:!0}).then(function(){f["default"]("dismissLayersTabNotification"+M.item.id,null,{expires:-1});M.getLayersAndStatus().then(function(){return M.initUI()})},function(){w["default"].showAlert("error",M.i18n.itemProperties.deleteLayersError)})};T.prototype.getFolder=function(){var M=this,L,X=new l["default"],ba=null;(null===(L=this.layers)||void 0===L?0:L.length)?
(ba=this.layers[0].layerId,V["default"].request({url:N["default"].restBaseUrl+"content/items/"+ba}).then(function(ma){ma.ownerFolder&&V["default"].request({url:N["default"].restBaseUrl+"content/users/"+M.portalUser.username+"/"+ma.ownerFolder}).then(X.resolve,X.reject)},function(ma){return X.reject(ma)})):X.reject();return X};T.prototype.getLayers=function(){var M=this,L=new l["default"];V["default"].request({url:N["default"].restBaseUrl+"portals/self/datastores/allDatasets/getLayers",content:{datastoreId:this.item.id}},
{usePost:!0}).then(function(X){return L.resolve(X)},function(X){M.showError(X);L.reject(X)});return L};T.prototype.getItemStatus=function(){var M=this,L=new l["default"];V["default"].request({url:N["default"].restBaseUrl+"content/users/"+this.item.owner+"/items/"+this.item.id+"/status"}).then(function(X){L.resolve(X)},function(X){M.showError(X);L.reject(X)});return L};T.prototype.initUI=function(M){var L=this,X=new l["default"];if(M){M=this.i18n;var ba=this.page,ma=ba.portalUser,ta=ba.portal;ba=M.itemProperties;
var Ea=this.domNode.querySelector(".js-view-wrap");ma={select:!1,sortOptions:this.sortOptions,emptyView:d["default"].substitute(D["default"],{i18n:M}),noneView:K["default"],tableHead:G["default"],tableRow:I["default"],portalUser:ma,portal:ta,activeView:this.initialView};M={search:{placeholder:ba.searchLayers,searchTerm:""},views:{activeView:this.initialView,views:["table"]},sort:this.sortOptions,viewContainer:Ea,actions:d["default"].substitute(R["default"],{i18n:M})};this._controlBar=new C["default"](M,
this.domNode.querySelector(".js-control-bar"));this._syncLayersBtn=this.domNode.querySelector("#syncLayersBtn");this.item.isOwner?this.own(a["default"](this._syncLayersBtn,"click",function(){return L.syncLayers()}),a["default"](this._createLayersBtn,"click",function(){return L.createLayers()})):H["default"].disableNodes([this._syncLayersBtn,this._createLayersBtn],!0);this.view=new x["default"](ma,this.domNode.querySelector(".js-views"));this.pagination=new y["default"]({start:this.initialStart,num:this.tablePage.num},
this.domNode.querySelector(".js-pagination"))}this.layers.length||this.status.status&&"error"!==this.status.status?this.status.status?this.processJobStatus(this.status):this.status.status&&"error"!==this.status.status||!this.layers.length?(this._errorMessage.innerHTML=this.i18n.itemProperties.layersError,H["default"].showNode(this._errorContainer),this.page.hideLoader()):(this.showPublishedLayers(),H["default"].hideNode(this._notificationContainer),this.domNode.querySelector("syncLayersBtn").removeAttribute("disabled"),
p["default"].remove(this._deleteBtn,"hide"),p["default"].remove(this._folderContainer,"hide")):H["default"].showNode(this._createLayersContainer);this.filteredLayers=b["default"].clone(this.layers);this.initLayerGrid();X.resolve(!0);return X};T.prototype.render=function(){this.updateView(this.updateState())};T.prototype.showPublishedLayers=function(){H["default"].hideNode(this._createLayersContainer);this.layers.length&&H["default"].showNodes([this._controlBarContainer,this._layersListContainer])};
T.prototype.hidePublishedLayers=function(){H["default"].hideNodes([this._controlBarContainer,this._layersListContainer])};T.prototype.processJobStatus=function(M){var L=this,X=this.i18n.itemProperties,ba=X.bulkPublishSyncJobRunning,ma=X.bulkPublishJobRunning,ta=X.bulkPublishJobNumbers,Ea=X.deletingLayers,wa=X.deleteLayersError,Q=X.bulkPublishSyncJobCompleted,Z=X.bulkPublishJobCompleted,aa=X.itemsDeleteSuccess;X=X.bulkPublishJobUnknownError;switch(M.status.toUpperCase()){case "PARTIAL":case "PROCESSING":H["default"].hideNodes([this._iconJobUnknownStatus,
this._iconJobCompleted,this._dismissBtn]);H["default"].showNodes([this._notificationContainer,this._iconJobRunning]);H["default"].disableNode(this._syncLayersBtn,!0);this.isDeleteJob?this._statusTextContainer.innerHTML=Ea:(this.showPublishedLayers(),this._statusTextContainer.innerHTML=this.isSync?ba:ma,M.jobProgress&&(M=M.jobProgress,ba=M.publishing,this._statusTextContainer.innerHTML+=d["default"].substitute(ta,[this.isSync?ba:this.layers.length,M.total])));setTimeout(function(){L.getLayersAndStatus().then(L.initUI.bind(L))},
1E4);break;case "COMPLETED":H["default"].hideNode(this._iconJobRunning);H["default"].showNodes([this._dismissBtn,this._iconJobCompleted]);this.layers.length?(H["default"].showNodes([this._deleteBtn,this._folderContainer]),this.item.isOwner&&this._syncLayersBtn.removeAttribute("disabled"),this.showNotification(),this.showPublishedLayers(),this._statusTextContainer.innerHTML=this.isDeleteJob?wa:this.layers.length+" "+(this.isSync?Q:Z)):(this.isDeleteJob&&(this._statusTextContainer.innerHTML=aa,this.showNotification()),
H["default"].showNode(this._createLayersContainer));break;case "FAILED":H["default"].showNodes([this._dismissBtn,this._iconJobUnknownStatus]);H["default"].hideNode(this._iconJobRunning);this._statusTextContainer.innerHTML=this.isDeleteJob?wa:X;ta=!this.showNotification();this.layers.length?(H["default"].showNodes([this._deleteBtn,this._folderContainer]),this.item.isOwner&&(this._syncLayersBtn.removeAttribute("disabled"),r["default"].remove(this._syncLayersBtn,"disabled")),this.showPublishedLayers()):
ta&&H["default"].showNode(this._createLayersContainer);break;default:H["default"].hideNode(this._iconJobRunning),H["default"].showNodes([this._dismissBtn,this._iconJobUnknownStatus,this._deleteBtn,this._folderContainer]),this.item.isOwner&&this._syncLayersBtn.removeAttribute("disabled"),this.showNotification(),this.showPublishedLayers(),this._statusTextContainer.innerHTML=X}};T.prototype.updateState=function(){var M=this.pagination.getCurrentPageObj(),L=1===this.tablePage.start&&M.num===this.tablePage.num;
this.tablePage.start=L?this.tablePage.start:M.start;this.tablePage.total=L?this.filteredLayers.length:M.total;this.tablePage.nextStart=L?this.tablePage.start+this.tablePage.num:M.nextStart;return this.filteredLayers.slice(this.tablePage.start-1,-1!==this.tablePage.nextStart?this.tablePage.nextStart-1:this.tablePage.total)};T.prototype.initLayerGrid=function(M){M&&b["default"].mixin(this._sort,M);c["default"].publish("sort/update",b["default"].clone(this._sort))};T.prototype.updateView=function(M){c["default"].publish("view/update",
M);this.pagination.render(this.tablePage);M=this.pagination.getCurrentPageObj();this._rangeText.textContent=t["default"].getPageRangeString({start:0!==M.total?M.start:M.total,end:M.total<M.end?M.total:M.end,total:M.total});return!0};T.prototype.addEventListeners=function(){this.own(a["default"](this._deleteBtn,"click",this.startDeleteLayers.bind(this)),a["default"](this._dismissBtn,"click",this.dismissNotification.bind(this)),c["default"].subscribe("sort/update",this.sortUpdate.bind(this)),c["default"].subscribe("search/update",
this.searchUpdate.bind(this)),c["default"].subscribe("pagination/page",this.paginationPage.bind(this)))};T.prototype.searchUpdate=function(M){var L=this;this.searchTerm=M;this.tablePage.start=1;c["default"].publish("view/loading",M);this.filteredLayers=M?this.layers.filter(function(X){var ba;return u["default"].includes(null===(ba=X.layerName)||void 0===ba?void 0:ba.toLowerCase(),L.searchTerm.toLowerCase())}):b["default"].clone(this.layers);c["default"].publish("sort/update",b["default"].clone(this._sort))};
T.prototype.sortUpdate=function(M){this.tablePage.start=1;this.filteredLayers=M.ascending?this.filteredLayers.sort(function(L,X){return L[M.property]>X[M.property]?1:L[M.property]<X[M.property]?-1:0}):this.filteredLayers.sort(function(L,X){return L[M.property]<X[M.property]?1:L[M.property]>X[M.property]?-1:0});this.render()};T.prototype.paginationPage=function(M){this.tablePage.start=M.start;this.render()};T.prototype.createLayers=function(){var M=this,L=this.page,X=new z["default"]({portal:L.portal,
portalUser:L.portalUser,datastoreId:this.item.id});X.startup().then(function(){a["default"].once(X.dialog,"hide",function(){f["default"]("publishLayersSyncJob"+M.item.id,null,{expires:-1});f["default"]("dismissLayersTabNotification"+M.item.id,null,{expires:-1});M.getLayersAndStatus().then(function(){return M.initUI()},function(ba){return M.showError(ba)})})},function(ba){return M.showError(ba)})};T.prototype.showError=function(M){var L=this.i18n.itemProperties.error.error;M.message&&(L+=": "+M.message);
w["default"].showAlert("error",L)};T.prototype.syncLayers=function(){var M=this;(new O["default"]({itemId:this.item.id,onOk:function(){M.getLayersAndStatus().then(M.initUI.bind(M))}})).showModal()};T.prototype.checkSyncJob=function(){this.isSync=!!f["default"]("publishLayersSyncJob"+this.item.id)};T.prototype.dismissNotification=function(){var M,L;f["default"]("dismissLayersTabNotification"+this.item.id,this.item.id);H["default"].hideNode(this._notificationContainer);"FAILED"!==((null===(M=this.status)||
void 0===M?void 0:M.status)||"").toUpperCase()||(null===(L=this.layers)||void 0===L?0:L.length)||this.initUI()};T.prototype.showNotification=function(){if(f["default"]("dismissLayersTabNotification"+this.item.id))return!1;H["default"].showNode(this._notificationContainer);return!0};T.prototype.destroy=function(){this.inherited(arguments)};return T=q.__decorate([B["default"](g["default"],n["default"])],T)}()})},"arcgisonline/pages/dijit/Pagination":function(){define("require exports tslib dojo/on dojo/topic dojo/query dojo/string dojo/dom-attr dojo/dom-class dojo/_base/event dijit/_TemplatedMixin dijit/_WidgetBase calcite-web/js/calcite-web ../pageUtil ../utils/dom ../utils/icons dojo/text!./Pagination/templates/Number.html dojo/text!./Pagination/templates/Ellipsis.html dojo/text!./Pagination/templates/Pagination.html dojo/i18n!../../nls/arcgisonline arcgisonline/tsutils/declareDecorator".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);y=q.__importDefault(y);return function(){function C(z,F){this.templateString=
v["default"];this.pageSizeLabel=x["default"].contentPage.paginationPerPage;this.i18n=x["default"];this.icons=t["default"];this.smallestPageSize=this.num=20;this.topic=""}C.prototype.postCreate=function(){this.inherited(arguments);this._addEventListeners();this.hideDropdown&&m["default"].hideNode(this._pageDropdown)};C.prototype.render=function(z){this.total=z.total;this.start=z.start;this.nextStart=z.nextStart;this.end=-1===this.nextStart?this.total:this.nextStart-1;this.currentPage=(this.start-1)/
this.num+1;this.pages=Math.ceil(this.total/this.num);this._updateUI()};C.prototype._addEventListeners=function(){var z=this;this.own(b["default"](this.next,"click",function(F){d["default"].stop(F);z.nextPage()}),b["default"](this.pageLinks,"click",function(F){var O;d["default"].stop(F);F=a["default"].get(F.target,"data-page");null===(O=z.telemetry)||void 0===O?void 0:O.logEvent({pageUrl:window.location.href,category:"Change page",action:F});z.selectPage(F)}),b["default"](this.previous,"click",function(F){d["default"].stop(F);
z.previousPage()}),p["default"](".js-page-num-link",this.domNode).on("click",function(F){F=F.target.getAttribute("data-num");z.updateNum(F)}))};C.prototype._updateUI=function(){var z=this.currentPage,F=Math.min(this.pages,Math.floor(1E4/this.num)),O=p["default"](".js-btn-previous",this.domNode),V=p["default"](".js-btn-next",this.domNode);p["default"](".js-btn",this.domNode).addClass("btn-transparent");1===z?O.addClass("btn-disabled").attr("tabindex",-1):O.removeClass("btn-disabled").removeAttr("tabindex");
-1===this.nextStart||1E4<this.nextStart+this.num?V.addClass("btn-disabled").attr("tabindex",-1):V.removeClass("btn-disabled").removeAttr("tabindex");this._pageNumLabel.innerHTML=r["default"].substitute(this.pageSizeLabel,{num:this.num});p["default"](".js-page-num-link",this.domNode).removeClass("is-active");p["default"](".js-page-num-link[data-num\x3d'"+this.num+"']",this.domNode).addClass("is-active");if(1<F){V=Math.max(4,z);var N=12<F&&F<V+3;O=[];if(6>F)for(V=1;V<=F;V++)O.push(V);else{if(4<z)O.push(1,
"..."),N||O.push(z-1,z);else for(var J=1;J<=z;J++)O.push(J);if(4>z&&4<F)for(J=z+1;4>=J;J++)O.push(J);if(N)for(V=F-3;V<=F;V++)O.push(V);else if(2<F-V)O.push(V+1,"...",F);else for(V+=1;V<=F;V++)O.push(V)}this.pageLinks.innerHTML='\x3cul class\x3d"clear-list-style flex-center"\x3e'+O.reduce(function(D,K){var G=K===z;return D+r["default"].substitute("..."===K?u["default"]:w["default"],{pageNum:K,"is-active":G?"no-pointer pagination-btn--active":"btn-transparent pagination-btn--inactive",label:r["default"].substitute(G?
x["default"].contentPage.paginationActive:x["default"].contentPage.paginationLink,{pageNum:K}),current:G?"aria-current\x3d'true' tabindex\x3d'-1'":""})},"")+"\x3c/ul\x3e";c["default"].remove(this.domNode,"hide");c["default"].remove(this.navigation,"hide")}else this.total>this.smallestPageSize?(c["default"].add(this.navigation,"hide"),c["default"].remove(this.domNode,"hide")):c["default"].add(this.domNode,"hide");p["default"](".js-over-limit",this.domNode).removeClass("is-active");1E4<=this.total&&
1E4<=this.start+this.num&&p["default"](".js-over-limit",this.domNode).addClass("is-active")};C.prototype.setInitialProperties=function(z){this.start=z.start||this.start;this.num=z.num||this.num;this._updateUI()};C.prototype.selectPage=function(z){this.currentPage=parseInt(z||1,10);this.start=(this.currentPage-1)*this.num+1;this.nextStart=this.start+this.num>this.total?-1:this.start+this.num;this.end=-1===this.nextStart?this.total:this.nextStart-1;this._updateUI();this.topic||n["default"].updateQueryParams({start:this.start,
num:this.num});l["default"].publish(this.topic+"pagination/page",this.getCurrentPageObj())};C.prototype.nextPage=function(){var z;this.currentPage=Math.min(this.currentPage+1,this.pages);null===(z=this.telemetry)||void 0===z?void 0:z.logEvent({pageUrl:window.location.href,category:"Change page",action:"Next"});this.selectPage(this.currentPage)};C.prototype.previousPage=function(){var z;this.currentPage=Math.max(this.currentPage-1,1);null===(z=this.telemetry)||void 0===z?void 0:z.logEvent({pageUrl:window.location.href,
category:"Change page",action:"Prev"});this.selectPage(this.currentPage)};C.prototype.updateNum=function(z){var F,O=parseInt(z,10);O!==this.num&&(this.num=O,this.pages=Math.ceil(this.total/this.num),null===(F=this.telemetry)||void 0===F?void 0:F.logEvent({pageUrl:window.location.href,category:"Row count per page",action:z}),this.selectPage(1),g["default"].bus.emit("dropdown:close"))};C.prototype.getCurrentPageObj=function(){return{num:this.num,total:this.total,start:this.start,end:this.end,nextStart:this.nextStart,
currentPage:this.currentPage,pages:this.pages}};C.prototype.hide=function(){this.domNode.classList.add("hide")};C.prototype.show=function(){this.domNode.classList.remove("hide")};return C=q.__decorate([y["default"](f["default"],h["default"])],C)}()})},"arcgisonline/sharing/dijit/dialog/CreateLayersDlg":function(){define("require esri/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin calcite-web/js/calcite-web arcgisonline/esriGeowConfig arcgisonline/sharing/util arcgisonline/pages/pageUtil arcgisonline/sharing/dijit/_federated-servers-table arcgisonline/sharing/dijit/dialog/GeneralDlg arcgisonline/sharing/dijit/dialog/CreateFolder dijit/Dialog dojo/cookie dojo/json dojo/Deferred dojo/promise/all dojo/_base/array dojo/_base/url dojo/on dojo/string dojo/query dojo/dom-class dojo/dom-attr dojo/topic dojo/text!./templates/CreateLayersDlg.html dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N){return U([q,b,l],{templateString:y.substitute(V,{i18n:N.CreateLayersDlg}),dialog:null,servers:null,currentStep:null,item:null,postCreate:function(){this.inherited(arguments)},constructor:function(J){this.currentStep=1;this.i18n=N;this.datastoreId=J.datastoreId;this.item={datastoreId:J.datastoreId};this.serversUrl=r.restBaseUrl+"portals/self/datastores/getServers";this.publishLayersUrl=r.restBaseUrl+"portals/self/datastores/allDatasets/publishLayers";
this.serverFolderOption="sameAsPortalFolder";this.folderRegex=/\s|\+|\?|&|\/|\(|\)|\\|!|#|"|\||\*|:|<|>|%|\$|@|'|\^|\[|\]|,|=|;/gi},startup:function(){this.inherited(arguments);var J=new t;w({tags:a.loadUserTags(this.portalUser.username),categories:this.portal.getCategories(),folders:this.portalUser.getFolders(),servers:a.request({url:this.serversUrl,content:{datastoreId:this.datastoreId}},{usePost:!0})}).then(function(D){this._setupFolders(D.folders);this._setupServers(D.servers);this._showModal();
J.resolve()}.bind(this),function(D){J.reject(D)});return J},_setupServers:function(J){this.servers=J.servers;this.serversTable=(new d({federatedServers:this.servers,datastoreId:this.datastoreId,singleSelect:!0})).placeAt(this.serversGridContainer)},_setupFolders:function(J){var D=(J||[]).filter(function(K){return K.id!==this.portalUser.username}.bind(this));D.unshift({title:J.length?N.CreateLayersDlg.selectFolder:N.CreateLayersDlg.createFolder,id:""});this._folders.options=u.map(D,"return { label:item.title, value:item.id };");
this._folders.set("value","")},_addFolder:function(J){this._removePreviouslyAddedFolder(J);this._setSelectionText();this._folders.addOption([{label:J.title,value:J.id}]);this._folders.set("value",J.id)},_removePreviouslyAddedFolder:function(J){this.folderAdded&&this._folders.removeOption(this.folderAdded);this.folderAdded=J.id},_setSelectionText:function(){for(var J=0;J<this._folders.options.length;J++){var D=this._folders.options[J];if(!D.value){D.label=N.CreateLayersDlg.selectFolder;break}}},_showModal:function(){this.dialog=
new g({title:N.itemProperties.createLayers,content:this.domNode,"class":"create-layers-dlg",onHide:this.destroy.bind(this),closable:!0});this.dialog.show().then(function(){this.addEventListeners();p.init()}.bind(this))},addEventListeners:function(){this.own(x(this.createButton,"click",function(J){J.preventDefault();this._createFolder()}.bind(this)),x(this.cancelButton,"click",function(J){J.preventDefault();this.dialog.hide()}.bind(this)),x(this.nextButton,"click",function(J){J.preventDefault();this._validateStep(this.currentStep)&&
this._goToStep(this.currentStep+1)}.bind(this)),x(this.backButton,"click",function(J){J.preventDefault();this._goToStep(this.currentStep-1)}.bind(this)),x(this.startButton,"click",function(J){J.preventDefault();this._validateStep(this.currentStep)&&this._startPublishLayers(this.item)}.bind(this)),x(this.serverFolder,"input",function(J){this._generateExampleUrl()}.bind(this)),O.subscribe("servers/serverAutoSelected",function(){this._generateExampleUrl()}.bind(this)),C("input[name\x3d'serverFolderRadio']",
this.domNode).on("change",function(J){this.serverFolderOption=J.target.value;"newFolder"===J.target.value?F.remove(this.serverFolder,"disabled"):(F.set(this.serverFolder,"disabled","disabled"),this.serverFolder.value=this._sanitizeFolderName(this._getPortalFolder(this.item.portalFolderId)));this._generateExampleUrl()}.bind(this)),C("input[name\x3d'serverId']",this.domNode).on("change",function(J){this._generateExampleUrl()}.bind(this)))},_generateExampleUrl:function(){var J=null;if((this.serversTable.selectedServers||
[]).length){var D=this.serversTable.selectedServers[0].url;a.isValidUrl(D)&&(J=new v(D),J=N.CreateLayersDlg.exampleUrl+"\x26nbsp;"+J.uri+"/rest/services/"+this.serverFolder.value)}J?(this.exampleUrlContainer.innerHTML=J,z.remove(this.exampleUrlContainer,"hide")):z.add(this.exampleUrlContainer,"hide")},_createItemDataObject:function(J){var D={};D.serverId=J.serverId;D.portalFolderId=J.portalFolderId;D.serverFolder=this._sanitizeFolderName(J.serverFolder);D.datastoreId=J.datastoreId;D.templateSvcConfig=
JSON.stringify({serviceName:null,type:"MapServer",capabilities:"Map,Query,Data",extensions:[{typeName:"FeatureServer",capabilities:"Query",enabled:"true",properties:{maxRecordCount:"4000"}}]});return D},_validateServerFolderName:function(J){var D={valid:!0,errorMessage:""};if(!J)return D.valid=!1,D.message=this.i18n.CreateLayersDlg.validation.invalidServerFolder,D;for(var K=0;K<J.length;K++){var G=J[K];if(G.match(this.folderRegex)){D.valid=!1;D.message=y.substitute(this.i18n.CreateLayersDlg.validation.invalidServerFolderCharacter,
{character:G});break}}return D},_sanitizeFolderName:function(J){return J.replace(this.folderRegex,"")},_startPublishLayers:function(J){J=this._getPortalFolder(this.item.portalFolderId);J===this.item.portalFolderId?this.portalUser.createFolder(J).then(function(D){this.item.portalFolderId=D.id;this._publishLayers(this.item)}.bind(this),function(D){this.showError(D)}.bind(this)):this._publishLayers(this.item)},_publishLayers:function(J){J=this._createItemDataObject(J);z.remove(this.errorNode,"is-active");
this.errorNode.innerHTML="";z.add(this.startButton,"hide");z.add(this.backButton,"hide");z.add(this.cancelButton,"hide");C(".step-"+this.currentStep).addClass("hide");z.add(this.loader,"is-active");a.request({url:this.publishLayersUrl,content:J},{usePost:!0}).then(function(D){D.success?this.dialog.hide():this._showError(error)}.bind(this),function(D){this._showError(D)}.bind(this))},_showError:function(J){this.errorNode.innerHTML=this.i18n.CreateLayersDlg.publishLayersError;"ORG_1181"===J.messageCode?
this.errorNode.innerHTML+=" "+this.i18n.CreateLayersDlg.validation.ORG_1181:J.message&&(this.errorNode.innerHTML+=" "+J.message,(J.details||[]).length&&(this.errorNode.innerHTML+=" "+J.details.join(" ")));C(".step-"+this.currentStep).removeClass("hide");z.remove(this.startButton,"hide");z.remove(this.backButton,"hide");z.remove(this.cancelButton,"hide");z.remove(this.loader,"is-active");z.add(this.errorNode,"is-active")},_validateStep:function(J){this._setStepFormData(this.currentStep);var D={valid:!0};
switch(J){case 1:this.item.portalFolderId||(D=this._generateInvalidResult(this.i18n.CreateLayersDlg.validation.invalidFolder));break;case 2:if(!this.item.serverId){D=this._generateInvalidResult(this.i18n.CreateLayersDlg.validation.invalidServer);break}J=this._validateServerFolderName(this.item.serverFolder);J.valid||(D=this._generateInvalidResult(J.message));break;default:throw"Invalid step";}D.valid||c.createSpecifiedDialog(h).show(D);return D.valid},_generateInvalidResult:function(J){return{title:this.i18n.generalDlg.errorDlgTitle,
valid:!1,message:J}},_getPortalFolder:function(J){var D=this._folders.options.filter(function(K){return K.value===J}.bind(this));return D.length?D[0].label:""},_setStepFormData:function(J){switch(J){case 1:this.item.portalFolderId=this._folders.value!==this.portalUser.username?this._folders.value:null;"newFolder"!==this.serverFolderOption&&(this.serverFolder.value=this._sanitizeFolderName(this._getPortalFolder(this.item.portalFolderId)));break;case 2:(this.serversTable.selectedServers||[]).length&&
(this.item.serverId=this.serversTable.selectedServers[0].id);this.item.serverFolder=this.serverFolder.value;break;default:throw"Error setting step data";}},_goToStep:function(J){this.currentStep=J;2===this.currentStep&&this._generateExampleUrl();this._changeStepIndicator(J);this._changeStepContent(J);this._changeStepButtons(J)},_changeStepIndicator:function(J){C(".add-datastore-step").removeClass("active");C(".add-datastore-step").removeClass("completed");C("#step"+J.toString()).addClass("active");
for(var D=1;D<J;D++)C("#step"+D.toString()).addClass("completed")},_changeStepContent:function(J){C(".step-container").addClass("hide");C(".step-"+J.toString()).removeClass("hide")},_changeStepButtons:function(J){switch(J){case 1:z.remove(this.nextButton,"hide");z.add(this.startButton,"hide");z.add(this.backButton,"hide");break;case 2:z.add(this.nextButton,"hide"),z.remove(this.backButton,"hide"),z.remove(this.startButton,"hide")}},_createFolder:function(){var J=new f({portalUser:this.portalUser,
bypassApi:!0});J.startup();J.showModal().then(function(D){this._addFolder(D)}.bind(this))},onSubmit:function(J){J.preventDefault()},destroy:function(){this.dialog.destroyRecursive()}})})},"arcgisonline/sharing/dijit/dialog/CreateFolder":function(){define("require esri/declare esri/Evented esri/kernel esri/lang esri/request esri/arcgis/Portal dojo/_base/lang dojo/_base/window dojo/_base/array dojo/topic dojo/string dojo/query dojo/on dojo/json dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/promise/all dojo/Deferred dojo/when ./ConfirmDialog dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/i18n!../../../nls/arcgisonline dojo/text!arcgisonline/sharing/dijit/dialog/templates/CreateFolder.html".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J){return U([F,O,V,q],{baseClass:"esriCreateFolderDlg",templateString:J,postMixInProperties:function(){this.inherited(arguments);this.i18n=a.mixin({},N)},startup:function(){this.inherited(arguments);this.addEventHandlers()},getFolder:function(){var D=w.get(this._input,"value");return f.trim(D)},showModal:function(){var D=new y,K=new z({title:N.folderDlg.folderDlgTitle,buttonOk:N.common.create,buttonCancel:N.common.cancel,busyMessage:N.folderDlg.creatingFolder,
style:{width:"475px",height:"auto"}});K.setContent(this.domNode);K.show();this.own(n(K,"ok",a.hitch(this,function(){this._validate(this.getFolder())&&this.createFolder().then(a.hitch(this,function(G){this.set("readOnly",!1);K.hide().then(a.hitch(function(){D.resolve(G)}))}),a.hitch(this,function(G){if(G&&G.messageCode&&"GWM_0021"===G.messageCode)this._showError(G);else{var I=f.substitute(N.folderDlg.invalid[G&&G.messageCode||"sameFolderName"],[this.getFolder()]);this._showError(a.mixin(G,{message:I}))}D.reject(G);
this.set("readOnly",!1)}))})));return D},createFolder:function(){var D=new y,K=this.portalUser,G=this.getFolder();this.set("readOnly",!0,N.folderDlg.creatingFolder);this.bypassApi?D.resolve({title:G,id:G}):K.createFolder(G).then(a.hitch(this,function(I){D.resolve(I)}),a.hitch(this,function(I){D.reject(I)}));return D},addEventHandlers:function(){var D=new y;this.own(n(this._createFolderForm,"submit",a.hitch(this,function(K){K.preventDefault()})));D.resolve(!0);return D},_validate:function(D){return 0===
D.length?this._showError({message:N.folderDlg.invalid.provideName}):-1<D.indexOf("\x3c")||-1<D.indexOf("\x3e")?this._showError({message:N.folderDlg.invalid.invalidCharacters}):this.portalUser&&this.portalUser.username&&this.portalUser.username.toLowerCase()===D.toLowerCase()?this._showError({message:b.substitute([D],N.folderDlg.invalid.sameFolderName)}):!0},_setReadOnlyAttr:function(D){h.publish("/esri/disable",D);w.set(this._input,"readOnly",D)},_showError:function(D){D=a.mixin(a.mixin({},N.publishWizard.errors.error),
D);this._errorDlg=new z({showCancel:!1,style:{width:"400px",height:"auto"}});this._errorDlg.show(D).then(a.hitch(this,function(){this.set("readOnly",!1);this._errorDlg.hide()}));return!1}})})},"arcgisonline/sharing/dijit/dialog/SyncLayersDlg":function(){define("require exports tslib dojo/string dojo/on dojo/cookie dijit/_TemplatedMixin dijit/_WidgetBase dijit/_WidgetsInTemplateMixin dijit/Dialog arcgisonline/tsutils/declareDecorator arcgisonline/sharing/util arcgisonline/pages/utils/alerts arcgisonline/esriGeowConfig dojo/text!./templates/SyncLayersDlg.html dojo/i18n!../../../nls/arcgisonline".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);return function(){function w(u){this.templateString=b["default"].substitute(m["default"],{i18n:t["default"]})}w.prototype.showModal=function(){var u=this;this.dialog=
new d["default"]({title:t["default"].itemProperties.syncLayers,content:this.domNode,"class":"sync-layers-dlg",closable:!0});this.dialog.show().then(function(){u.addEventListeners()})};w.prototype.syncLayers=function(u){var v=this;u={datastoreId:this.itemId,syncItemInfo:this.syncOptionCheckbox.checked,templateSvcConfig:JSON.stringify({serviceName:null,type:"MapServer",capabilities:"Map,Query",extensions:[{typeName:"FeatureServer",capabilities:"Query",enabled:"true",properties:{maxRecordCount:"4000"}}]})};
f["default"].request({url:n["default"].restBaseUrl+"portals/self/datastores/allDatasets/publishLayers",content:u},{usePost:!0}).then(function(x){var y;v.hideDialog();p["default"]("publishLayersSyncJob"+v.itemId,JSON.stringify(x));p["default"]("dismissLayersTabNotification"+v.itemId,null,{expires:-1});null===(y=v.onOk)||void 0===y?void 0:y.call(v)},function(x){v.hideDialog();g["default"].showAlert("error",x.message)})};w.prototype.addEventListeners=function(){this.own(l["default"](this.cancelButton,
"click",this.hideDialog.bind(this)),l["default"](this.okButton,"click",this.syncLayers.bind(this)))};w.prototype.hideDialog=function(u){null===u||void 0===u?void 0:u.preventDefault();this.dialog.hide();this.dialog.destroyRecursive()};return w=q.__decorate([h["default"](a["default"],r["default"],c["default"])],w)}()})},"arcgisonline/pages/item/widgets/_tasks":function(){define("require exports tslib dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin arcgisonline/tsutils/declareDecorator preact preact/compat ../components/tasks/TasksTab xstyle/css!./css/tasks.css".split(" "),
function(e,U,q,b,l,p,r,a,c,d){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);d=q.__importDefault(d);return function(){function h(){this.templateString='\x3cmain class\x3d"tasks-tab"\x3e\x3cdiv id\x3d"tasks-tab"\x3e\x3c/div\x3e\x3c/main\x3e'}h.prototype.startup=function(){this.inherited(arguments);this.container=document.getElementById("tasks-tab");a.render(a.h(d["default"],{itemId:this.item.id,username:this.portalUser.username}),this.container);return(new b["default"]).resolve(!0)};
h.prototype.destroy=function(){this.inherited(arguments);c.unmountComponentAtNode(this.container)};return h=q.__decorate([r["default"](l["default"],p["default"])],h)}()})},"arcgisonline/pages/item/components/tasks/TasksTab":function(){define("require exports tslib preact preact/hooks ./TasksNone ./TasksMain".split(" "),function(e,U,q,b,l,p,r){Object.defineProperty(U,"__esModule",{value:!0});p=q.__importDefault(p);r=q.__importDefault(r);U["default"]=function(a){var c=a.itemId,d=a.username,h=a.mini;
a=l.useState(!1);var f=a[0],g=a[1];a=l.useState(0);var n=a[0],m=a[1];return b.h("div",{"class":f?null:"hide"},function(){if(!h)return b.h("div",{"class":n?"hide":null},b.h(p["default"],{itemId:c}))}(),b.h("div",{"class":n||h?null:"hide"},b.h(r["default"],{itemId:c,username:d,mini:h,tasksCountCallback:function(t){f||g(!0);m(t)}})))}})},"arcgisonline/pages/item/components/tasks/TasksNone":function(){define("require exports tslib preact dojo/i18n!arcgisonline/nls/arcgisonline arcgisonline/esriGeowConfig".split(" "),
function(e,U,q,b,l,p){Object.defineProperty(U,"__esModule",{value:!0});l=q.__importDefault(l);p=q.__importDefault(p);U["default"]=function(r){return(r=r.itemId)?b.h("section",{"class":"grid-container"},b.h("div",{"class":"column-24"},b.h("div",{"class":"empty-view text-center leader-2"},b.h("i",{"class":"icon-ui-calendar"}),b.h("h3",null,l["default"].itemProperties.noTasks),b.h("p",{"class":"font-size--2 text-constrain margin-auto"},l["default"].itemProperties.noTasksMessage),b.h("a",{"class":"btn",
target:"_blank",href:p["default"].baseUrl+"notebook/notebook.html?id\x3d"+r},l["default"].itemProperties.openNotebook)))):b.h("section",{"class":"grid-container"},b.h("div",{"class":"column-24"},b.h("div",{"class":"empty-view text-center leader-2"},b.h("i",{"class":"icon-ui-calendar"}),b.h("h3",null,l["default"].notebookServerManager.tabs.tasks.noTasks))))}})},"arcgisonline/pages/item/components/tasks/TasksMain":function(){define("require exports tslib dojo/topic dojo/number preact preact/hooks arcgisonline/pages/utils/alerts arcgisonline/pages/utils/task dojo/i18n!arcgisonline/nls/arcgisonline ./TasksTable".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h){Object.defineProperty(U,"__esModule",{value:!0});b=q.__importDefault(b);l=q.__importDefault(l);a=q.__importDefault(a);d=q.__importDefault(d);h=q.__importDefault(h);U["default"]=function(f){var g=this,n=f.itemId,m=f.username,t=f.mini,w=f.tasksCountCallback;f=r.useState([]);var u=f[0],v=f[1],x=r.useState(!1);f=x[0];var y=x[1],C=r.useState(!1);x=C[0];var z=C[1],F=r.useState(!1);C=F[0];var O=F[1];F=r.useState(1);var V=F[0],N=F[1];F=r.useState(0);var J=F[0],D=F[1];F=r.useState(20);
var K=F[0],G=F[1],I=[],R=(F=!n&&!m)?c.TaskUtility.getAllTasksAdmin:c.TaskUtility.getTasks.bind(null,n,m),A=function(ta){y(!0);R(ta,K).then(function(Ea){return B(Ea,ta)}).always(function(){y(!1)})},B=function(ta,Ea){w(ta.total);D(ta.total);z(-1<ta.nextStart);t?(v((1===Ea?[]:u).concat(ta.tasks)),N(ta.nextStart)):(v(ta.tasks),N(-1<ta.nextStart?ta.nextStart:Ea+K))},H=function(){return q.__awaiter(g,void 0,void 0,function(){var ta;return q.__generator(this,function(Ea){switch(Ea.label){case 0:return Ea.trys.push([0,
2,3,4]),O(!0),[4,R(V,20)];case 1:return ta=Ea.sent(),B(ta,V),[3,4];case 2:return Ea.sent(),[3,4];case 3:return O(!1),[7];case 4:return[2]}})})},T=function(ta){N(ta.detail.start);A(ta.detail.start)},M=function(){if(t)N(1),A(1);else{var ta=V-K;ta>=J&&(ta=Math.floor(J/K)*K+1);A(ta)}},L=function(){a["default"].showAlert("success",d["default"].itemProperties.createTaskSuccess);M()},X=function(ta){ta=c.TaskUtility.formatErrorMessage(ta);a["default"].showAlert("error",ta||d["default"].itemProperties.createTaskError);
M()},ba=function(){a["default"].showAlert("success",d["default"].itemProperties.saveTaskSuccess);M()},ma=function(ta){ta=c.TaskUtility.formatErrorMessage(ta);a["default"].showAlert("error",ta||d["default"].itemProperties.saveTaskError);M()};r.useEffect(function(){A(V);I.concat([b["default"].subscribe("tasks__task-created",L)],[b["default"].subscribe("tasks__task-created-error",X)],[b["default"].subscribe("tasks__task-saved",ba)],[b["default"].subscribe("tasks__task-saved-error",ma)],[b["default"].subscribe("tasks__task-changed",
M)]);return function(){I.forEach(function(ta){return ta.remove()})}},[]);return t?p.h("div",null,p.h("div",{"class":"trailer-half"},p.h("calcite-button",{appearance:"outline",onClick:function(){return c.TaskUtility.startTaskCreate(n,m)},width:"full"},d["default"].notebookViewer.tabContent.tasks.createTask)),p.h("div",{"class":"leader-2 text-center "+((null===u||void 0===u?0:u.length)?"hide":"")},p.h("div",null,p.h("i",{"class":"icon-ui-calendar tab-empty-icon-large"})),d["default"].notebookViewer.tabContent.tasks.noTasks),
p.h("div",{"class":"sidebar-tab-panel "+((null===u||void 0===u?0:u.length)?"":"hide")},p.h("h4",{"class":"panel-header"},p.h("span",null,d["default"].notebookViewer.tabContent.tasks.scheduledTasks),p.h("button",{"class":"btn btn-link",onClick:M},p.h("i",{"class":"icon-ui-refresh"}))),p.h("div",{"class":"loader padding-leader-3 padding-trailer-3 "+(f?"is-active":"")},p.h("div",{"class":"loader-bars"}),p.h("div",{"class":"loader-text"},d["default"].itemProperties.tasksLoader)),p.h("div",{"class":f?
"hide":""},p.h(h["default"],{tasks:u,isAdmin:F,mini:t}),x&&!C&&p.h("div",{"class":"text-center"},p.h("a",{onClick:H},d["default"].common.loadMore)),x&&C&&p.h("div",{"class":"text-center"},p.h("calcite-loader",{scale:"m",inline:!0,active:!0,label:""}),p.h("span",null,d["default"].itemProperties.tasksLoader))))):p.h("section",null,p.h("div",{"class":"grid-container"},p.h("div",{"class":"panel panel-white leader-1"},p.h("div",{"class":"flex flex-space-between flex-align-center"},p.h("h4",{"class":"font-size-2 avenir-bold"},
d["default"].itemProperties.tasks),p.h("calcite-button",{"class":"margin-right-1",appearance:"transparent",color:"neutral","icon-start":"refresh",scale:"s",onClick:M})),p.h("div",{"class":"tasks-container"},p.h("p",null,d["default"].itemProperties.tasksDescription),p.h("div",{"class":"trailer-half "+(m?"":"hide")},p.h("button",{"class":"btn btn-clear",onClick:function(){return c.TaskUtility.startTaskCreate(n,m)}},d["default"].itemProperties.createTask)),p.h("div",{"class":"loader padding-leader-3 padding-trailer-3 "+
(f?"is-active":"")},p.h("div",{"class":"loader-bars"}),p.h("div",{"class":"loader-text"},d["default"].itemProperties.tasksLoader)),p.h("div",{"class":f?"hide":""},p.h(h["default"],{tasks:u,isAdmin:F}),p.h("div",{"class":"flex"},p.h("div",{"class":"flex-1 flex flex-justify-center"},p.h("calcite-pagination",{oncalcitePaginationChange:T,start:V-K,num:K,total:J})),p.h("div",null,p.h("calcite-dropdown",{width:"s"},p.h("calcite-button",{appearance:"outline",slot:"dropdown-trigger","icon-end":"caret-double-vertical"},
l["default"].format(K)),p.h("calcite-dropdown-group",{"group-title":d["default"].common.pageSize},[10,20,30,50].map(function(ta){return p.h("calcite-dropdown-item",{key:ta,value:ta,onClick:function(){G(ta);N(1);A(1)},active:K===ta},l["default"].format(ta))}))))))))))}})},"arcgisonline/pages/item/components/tasks/TasksTable":function(){define("require exports tslib preact ./TasksTableActions ../../../utils/task ../../../../sharing/util dojo/i18n!../../../../nls/arcgisonline".split(" "),function(e,
U,q,b,l,p,r,a){function c(d,h){return d?b.h("td",null,h):""}Object.defineProperty(U,"__esModule",{value:!0});l=q.__importDefault(l);r=q.__importDefault(r);a=q.__importDefault(a);U["default"]=function(d){var h=d.tasks,f=d.isAdmin,g=d.mini,n=d.item;d=(null===h||void 0===h?void 0:h.length)&&h.map(function(m){return b.h("tr",{key:m.id},b.h("td",null,b.h("a",{href:"#",onClick:function(t){p.TaskUtility.startTaskInfo(m.id,m.title,m.itemId,m.userId,t)}},m.title)),c(f,m.userId),c(!g,r["default"].toDateTimeString(m.created)),
c(!g,r["default"].toDateTimeString(m.updated)),b.h("td",null,p.TaskUtility.formatStatusText(m.taskState)),b.h("td",null,b.h(l["default"],{task:m,item:n})))})||null;return b.h("div",null,b.h("div",{"class":"loader padding-leader-3 padding-trailer-3"},b.h("div",{"class":"loader-bars"}),b.h("div",{"class":"loader-text"},a["default"].itemProperties.tasksLoader)),b.h("table",{"class":"table table-striped"},b.h("thead",null,b.h("tr",null,b.h("th",null,a["default"].itemProperties.tasksTable.name),f?b.h("th",
null,a["default"].itemProperties.tasksTable.user):"",g?"":b.h("th",null,a["default"].itemProperties.tasksTable.created),g?"":b.h("th",null,a["default"].itemProperties.tasksTable.updated),b.h("th",{colSpan:2},a["default"].itemProperties.tasksTable.status))),b.h("tbody",null,d)))}})},"arcgisonline/pages/item/components/tasks/TasksTableActions":function(){define("require exports tslib preact preact/hooks ../../../utils/task dojo/i18n!../../../../nls/arcgisonline".split(" "),function(e,U,q,b,l,p,r){Object.defineProperty(U,
"__esModule",{value:!0});r=q.__importDefault(r);U["default"]=function(a){function c(m){m.target!==g&&f(!h)}var d=a.task;a=l.useState(!1);var h=a[0],f=a[1];a=l.useState(null);var g=a[0],n=a[1];a=p.TaskUtility.getTaskStateAction(d.taskState);l.useEffect(function(){h&&document.addEventListener("click",c,!0);return function(){document.removeEventListener("click",c,!0)}},[h]);return b.h("div",{"class":"actions-cell"},b.h("div",{"class":"dropdown "+(h?"is-active":"")},b.h("button",{"class":"btn btn-link",
onClick:function(m){f(!h);h||n(m.target)},title:r["default"].itemProperties.tasksTable.actions,"aria-expanded":h},b.h("i",{"class":"icon-ui-handle-horizontal"})),b.h("nav",{"class":"dropdown-menu dropdown-right",role:"menu"},b.h("a",{href:"#","class":"dropdown-link",role:"menuitem",title:r["default"].itemProperties.tasksTable.viewTaskDetails,onClick:function(m){p.TaskUtility.startTaskInfo.bind(null,d.id,d.title,d.itemId,d.userId,m)()}},b.h("i",{"class":"icon-ui-table"})," ",r["default"].itemProperties.tasksTable.details),
b.h("a",{href:"#","class":"dropdown-link",role:"menuitem",title:r["default"].itemProperties.tasksTable.editTask,onClick:function(m){p.TaskUtility.startTaskEdit.bind(null,d.id,d.userId,d.itemId,m)()}},b.h("i",{"class":"icon-ui-edit"})," ",r["default"].itemProperties.tasksTable.edit),b.h("a",{href:"#","class":"dropdown-link",role:"menuitem",title:r["default"].itemProperties.tasksTable[a+"Task"],onClick:function(m){p.TaskUtility.startTaskPauseResume.bind(null,d,d.userId,m)()}},b.h("i",{"class":"icon-ui-"+
(d.active?"pause":"play")})," ",r["default"].itemProperties.tasksTable[""+a]),b.h("a",{href:"#","class":"dropdown-link",role:"menuitem",title:r["default"].itemProperties.tasksTable.deleteTask,onClick:function(m){p.TaskUtility.startTaskDelete.bind(null,d.id,d.title,d.userId,m)()}},b.h("i",{"class":"icon-ui-trash"})," ",r["default"].itemProperties.tasksTable["delete"]))))}})},"arcgisonline/pages/item/widgets/_snapshots":function(){define("require exports tslib dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin arcgisonline/tsutils/declareDecorator preact preact/compat ../components/snapshots/SnapshotsTab xstyle/css!./css/snapshots.css".split(" "),
function(e,U,q,b,l,p,r,a,c,d){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);d=q.__importDefault(d);return function(){function h(){this.templateString='\x3cmain class\x3d"snapshots-tab"\x3e\x3cdiv id\x3d"snapshots-tab"\x3e\x3c/div\x3e\x3c/main\x3e'}h.prototype.startup=function(){this.inherited(arguments);this.container=document.getElementById("snapshots-tab");a.render(a.h(d["default"],{itemId:this.item.id,username:this.portalUser.username}),this.container);
return(new b["default"]).resolve(!0)};h.prototype.destroy=function(){this.inherited(arguments);c.unmountComponentAtNode(this.container)};return h=q.__decorate([r["default"](l["default"],p["default"])],h)}()})},"arcgisonline/pages/item/components/snapshots/SnapshotsTab":function(){define("require exports tslib preact preact/hooks arcgisonline/esriGeowConfig arcgisonline/pages/notebook/components/SnapshotActions arcgisonline/pages/utils/formatters arcgisonline/pages/utils/notebook arcgisonline/pages/utils/alerts arcgisonline/pages/utils/snapshots dojo/i18n!arcgisonline/nls/arcgisonline dojo/Deferred".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g){Object.defineProperty(U,"__esModule",{value:!0});p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);f=q.__importDefault(f);g=q.__importDefault(g);U["default"]=function(n){var m=n.itemId;n=l.useState(!1);var t=n[0],w=n[1];n=l.useState([]);var u=n[0],v=n[1];n=l.useState(null);var x=n[0],y=n[1];l.useEffect(function(){w(!0);c["default"].getNotebookServer().then(function(O){y(O)})},[]);l.useEffect(function(){(null===
x||void 0===x?0:x.url)&&C()},[x]);var C=function(){w(!0);h.SnapshotsUtility.getSnapshots(x.url,m).then(function(O){"success"===O.status?v(O.snapshots||[]):(d["default"].showAlert("error",f["default"].notebookViewer.tabContent.snapshots.getSnapshotsError),v([]))},function(O){d["default"].showAlert("error",f["default"].notebookViewer.tabContent.snapshots.getSnapshotsError);v([])}).always(function(){w(!1)})},z=function(){C()},F=function(){return(new g["default"]).resolve()};return b.h("section",null,
function(){if(!t&&!u.length)return b.h("div",{"class":"leader-2 text-center"},b.h("div",null,b.h("i",{"class":"icon-ui-time-clock tab-empty-icon-large"})),f["default"].notebookViewer.tabContent.snapshots.noSnapshots)}(),function(){if(u.length)return b.h("div",null,b.h("div",{"class":"grid-container"},b.h("div",{"class":"panel panel-white leader-1"},b.h("h4",{"class":"font-size-2 avenir-bold"},f["default"].itemProperties.snapshots),b.h("div",{"class":"snapshots-container"},b.h("p",null,f["default"].notebookViewer.tabContent.snapshots.snapshotsDescription),
b.h("div",{"class":"trailer-half"},b.h("a",{"class":"btn btn-clear",target:"_blank",href:p["default"].baseUrl+"notebook/notebook.html?id\x3d"+m},f["default"].itemProperties.openNotebook),b.h("button",{"class":"btn btn-link margin-left-1",onClick:C,title:f["default"].common.refresh},f["default"].common.refresh)),b.h("calcite-loader",{"class":"padding-leader-1",active:t,text:f["default"].notebookViewer.tabContent.snapshots.loading,label:""}),b.h("table",{"class":"table table-striped "+(t?"hide":"")},
b.h("thead",null,b.h("tr",null,b.h("th",null,f["default"].notebookViewer.tabContent.snapshots.name),b.h("th",null,f["default"].notebookViewer.tabContent.snapshots.description),b.h("th",{colSpan:2},f["default"].notebookViewer.tabContent.snapshots.creationDate))),b.h("tbody",null,u.map(function(O){var V=a["default"].fullDate(parseInt(O.created,10)),N=a["default"].timeOnly(parseInt(O.created,10));return b.h("tr",null,b.h("td",null,O.properties.name||f["default"].notebookViewer.tabContent.snapshots.untitled),
b.h("td",null,O.properties.description),b.h("td",null,V+" "+N),b.h("td",null,b.h(r["default"],{itemId:m,snapshot:O,notebookServerUrl:x.url,onSnapshotDelete:z,onSnapshotRestore:F})))})))))))}())}})},"arcgisonline/pages/notebook/components/SnapshotActions":function(){define("require exports tslib preact preact/hooks arcgisonline/pages/components/BodyAppender arcgisonline/pages/utils/alerts arcgisonline/esriGeowConfig arcgisonline/pages/utils/snapshots dojo/i18n!arcgisonline/nls/arcgisonline".split(" "),
function(e,U,q,b,l,p,r,a,c,d){Object.defineProperty(U,"__esModule",{value:!0});p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);d=q.__importDefault(d);U["default"]=function(h){var f=l.useState(!1),g=f[0],n=f[1];f=l.useState(!1);var m=f[0],t=f[1];f=l.useState(!1);var w=f[0],u=f[1],v=l.useRef(),x=l.useRef(),y=function(V,N){u(!1);r["default"].showAlert("error",V)},C=function(){t(!1)},z=function(){n(!1)},F=function(){u(!0);c.SnapshotsUtility.deleteSnapshot(h.notebookServerUrl,h.itemId,
h.snapshot.resourceKey).then(function(V){"success"===V.status?(z(),h.onSnapshotDelete(),r["default"].showAlert("success",d["default"].notebookViewer.tabContent.snapshots.deleteSnapshotSuccess)):y(d["default"].notebookViewer.tabContent.snapshots.deleteSnapshotError,V.error)},function(V){y(d["default"].notebookViewer.tabContent.snapshots.deleteSnapshotError,V)})},O=function(){u(!0);c.SnapshotsUtility.restoreSnapshot(h.notebookServerUrl,h.itemId,h.snapshot.resourceKey).then(function(V){"success"===V.status?
h.onSnapshotRestore().then(function(){u(!1);C();r["default"].showAlert("success",d["default"].notebookViewer.tabContent.snapshots.restoreSnapshotSuccess)},function(N){y(d["default"].notebookViewer.tabContent.snapshots.restoreSnapshotError,N)}):y(d["default"].notebookViewer.tabContent.snapshots.restoreSnapshotError,V.error)},function(V){y(d["default"].notebookViewer.tabContent.snapshots.restoreSnapshotError,V)})};return b.h(b.Fragment,null,b.h("div",{"class":"flex"},b.h("calcite-dropdown",{"selection-mode":"none"},
b.h("button",{"class":"btn btn-transparent link-off-black flex-center padding-right-half padding-left-half padding-leader-0 padding-trailer-0",slot:"dropdown-trigger"},b.h("calcite-icon",{icon:"ellipsis"})),b.h("calcite-dropdown-group",null,b.h("calcite-dropdown-item",{onClick:function(){t(!0)}},d["default"].notebookViewer.tabContent.snapshots.restore),b.h("calcite-dropdown-item",{onClick:function(){x.current.value!==a["default"].userInfo.credential.token&&(x.current.value=a["default"].userInfo.credential.token);
v.current.submit()}},b.h("form",{method:"POST",target:"_blank",action:h.notebookServerUrl+"/admin/notebooks/snapshots/download",ref:v,id:"snapshot_"+h.itemId+"_"+h.snapshot.resourceKey,name:"snapshot_"+h.itemId+"_"+h.snapshot.resourceKey},b.h("input",{type:"hidden",name:"itemId",value:h.itemId}),b.h("input",{type:"hidden",name:"resourceKey",value:h.snapshot.resourceKey}),b.h("input",{type:"hidden",name:"token",ref:x,value:a["default"].userInfo.credential.token}),d["default"].notebookViewer.tabContent.snapshots.download)),
b.h("calcite-dropdown-item",{onClick:function(){n(!0)}},d["default"].notebookViewer.tabContent.snapshots["delete"])))),function(){var V;if(g)return b.h(p["default"],{id:"snapshot-delete-modal"},b.h("calcite-modal",{color:"red",width:"s",scale:"m",active:g,oncalciteModalClose:z,intlClose:d["default"].common.close},b.h("h3",{"class":"font-size-2 trailer-0",slot:"header"},d["default"].notebookViewer.tabContent.snapshots.deleteSnapshot),b.h("div",{slot:"content"},b.h("p",null,d["default"].notebookViewer.tabContent.snapshots.deleteSnapshotMessage),
b.h("p",null,b.h("strong",null,(null===(V=h.snapshot.properties)||void 0===V?void 0:V.name)||d["default"].common.untitled)),b.h("p",null,d["default"].notebookViewer.tabContent.snapshots.deleteSnapshotConfirm)),b.h("calcite-button",{slot:"secondary",width:"full",appearance:"outline",color:"red",onClick:z},d["default"].common.cancel),b.h("calcite-button",{slot:"primary",width:"full",color:"red",onClick:F,disabled:w},d["default"].common.deleteLabel)))}(),function(){var V;if(m)return b.h(p["default"],
{id:"snapshot-restore-modal"},b.h("calcite-modal",{width:"s",scale:"m",active:m,oncalciteModalClose:C,intlClose:d["default"].common.close},b.h("h3",{"class":"font-size-2 trailer-0",slot:"header"},d["default"].notebookViewer.tabContent.snapshots.restoreSnapshot),b.h("div",{slot:"content"},w?b.h("calcite-loader",{active:!0,text:d["default"].notebookViewer.tabContent.snapshots.restoringSnapshot,label:""}):b.h(b.Fragment,null,b.h("p",null,d["default"].notebookViewer.tabContent.snapshots.restoreSnapshotDescription),
b.h("p",null,b.h("strong",null,(null===(V=h.snapshot.properties)||void 0===V?void 0:V.name)||d["default"].common.untitled)),b.h("p",null,d["default"].notebookViewer.tabContent.snapshots.restoreSnapshotConfirm))),b.h("calcite-button",{slot:"secondary",width:"full",appearance:"outline",onClick:C},d["default"].common.cancel),b.h("calcite-button",{slot:"primary",width:"full",onClick:O,disabled:w},d["default"].notebookViewer.tabContent.snapshots.restore)))}())}})},"arcgisonline/pages/utils/snapshots":function(){define(["require",
"exports","tslib","arcgisonline/pages/utils/notebook"],function(e,U,q,b){Object.defineProperty(U,"__esModule",{value:!0});U.SnapshotsUtility=void 0;b=q.__importDefault(b);e=function(){function l(){}l.getSnapshots=function(p,r){return b["default"].notebookRequest(p+"/admin/notebooks/snapshots/list","POST",{itemId:r},{useJsonFormatParam:!0,useCredentials:!0})};l.createSnapshot=function(p,r){return b["default"].notebookRequest(p+"/admin/notebooks/snapshots/create","POST",r,{useJsonFormatParam:!0,useCredentials:!0})};
l.deleteSnapshot=function(p,r,a){return b["default"].notebookRequest(p+"/admin/notebooks/snapshots/delete","POST",{itemId:r,resourceKeys:a},{useJsonFormatParam:!0,useCredentials:!0})};l.restoreSnapshot=function(p,r,a){return b["default"].notebookRequest(p+"/admin/notebooks/snapshots/restore","POST",{itemId:r,resourceKey:a,preserveCurrentAsSnapshot:!1},{useJsonFormatParam:!0,useCredentials:!0})};return l}();U.SnapshotsUtility=e})},"arcgisonline/pages/dijit/SubNav":function(){define("require exports tslib dojo/dom-class dojo/has dojo/hash dojo/query dojo/string dojo/topic dijit/_TemplatedMixin dijit/_WidgetBase ../../tsutils/declareDecorator ../utils/formatters ../utils/arrays ../utils/dom ./InlineEdit dojo/text!./SubNav/templates/_option.html dojo/text!./SubNav/templates/_title.html dojo/text!./SubNav/templates/_paths.html dojo/text!./SubNav/templates/_path.html dojo/text!./SubNav/templates/SubNav.html dojo/i18n!../../nls/arcgisonline ../utils/icons".split(" "),
function(e,U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);x=q.__importDefault(x);y=q.__importDefault(y);C=q.__importDefault(C);z=q.__importDefault(z);
return function(){function F(O,V){this.templateString=y["default"];this.i18n=C["default"];this.linksHTML=this.activeLabel="";this.hideLinks="hide";this.edit=null;this._titleTypeSize="subnav-title";this.titleHTML=""}F.prototype.postMixInProperties=function(){var O=this,V;this.inherited(arguments);var N=this.links&&this.links.map(function(J){J.show=-1===Object.keys(J).indexOf("show")||J.show;return J}).filter(function(J){return J.show});0<(null===N||void 0===N?void 0:N.length)&&(this.hideLinks="",this.linksHTML=
this.links.reduce(function(J,D){D.logClick=!!D.logClick;D.isActive=D.id===O.active?"is-active":"";D.isActive&&(O.activeLabel=D.label);return J+a["default"].substitute(w["default"],D,null,g["default"])},""),document.title=this.titleText+" - "+this.activeLabel);if(100<(null===(V=this.title)||void 0===V?void 0:V.length)||this.paths)this._titleTypeSize+=" subnav-title--"+(180<this.titleText.length?"smaller":"small"),this.edit&&(this.edit.titleClass=this._titleTypeSize);this.titleHTML=this.paths?this.generateBreadCrumbs(this.paths):
a["default"].substitute(u["default"],this)};F.prototype.postCreate=function(){var O=this;this.inherited(arguments);this.own(r["default"](".js-subnav-expand",this.domNode).on("click",this.toggleNav.bind(this)),r["default"](".js-subnav-link",this.domNode).on("keyup",this.handleKeyUp.bind(this)),r["default"](".js-subnav-link",this.domNode).on("click",this.handleLinkClick.bind(this)),c["default"].subscribe("/dojo/hashchange",function(V){(l["default"]("ie")||l["default"]("trident")||l["default"]("edge"))&&
O.updateActiveTab(V)}));this.paths&&this.attachBreadCrumbEvents();window.addEventListener("popstate",function(){O.updateActiveTab(window.location.hash)});this.edit&&(this.edit.formClass="flex flex-center fullscreen",this.edit.inputLabel=C["default"].itemProperties.editTitle,this._titleEdit=new t["default"](this.edit,this.domNode.querySelector(".js-subnav-edit")),this.own(c["default"].subscribe("inlineEdit/"+this.edit.prop+"/done",this.closeEdit.bind(this)),c["default"].subscribe("inlineEdit/"+this.edit.prop+
"/cancel",this.closeEdit.bind(this)),c["default"].subscribe("inlineEdit/"+this.edit.prop+"/start",this.openEdit.bind(this))))};F.prototype.showTab=function(O){r["default"]('.js-subnav-link[data-tab\x3d"'+O+'"]',this.domNode).removeClass("hide")};F.prototype.hideTab=function(O){r["default"]('.js-subnav-link[data-tab\x3d"'+O+'"]',this.domNode).addClass("hide")};F.prototype.showEditLink=function(){var O;null===(O=this._titleEdit)||void 0===O?void 0:O.showEditLink()};F.prototype.hideEditLink=function(){var O;
null===(O=this._titleEdit)||void 0===O?void 0:O.hideEditLink()};F.prototype.updateText=function(O){var V;null===(V=this._titleEdit)||void 0===V?void 0:V.updateText(O)};F.prototype.setPageTitle=function(O){this.domNode.querySelector("#pagetitle").textContent=O};F.prototype.updateBreadCrumbs=function(O){this.paths=O;this.domNode.querySelector(".js-subnav-title-wrap").innerHTML=this.generateBreadCrumbs(O);this.attachBreadCrumbEvents()};F.prototype.updateActiveTab=function(O){O=O||"overview";var V=r["default"](".js-subnav-link",
this.domNode);V.removeClass("is-active").attr("aria-selected","false");if(V=n["default"].find(V,function(N){return N.getAttribute("href").replace("#","")===O.replace("#","")}))b["default"].add(V,"is-active"),V.setAttribute("aria-selected","true"),this.activeLabel=V.textContent,this.domNode.querySelector(".js-subnav-current-label").innerHTML=this.activeLabel,this.closeNav(),document.title=this.titleText+" - "+this.activeLabel};F.prototype.attachBreadCrumbEvents=function(){var O=this,V;this.domNode.querySelectorAll(".js-subnav-paths")&&
0<(null===(V=this.paths)||void 0===V?void 0:V.length)&&(m["default"].forEachNode(this.domNode.querySelectorAll(".js-subnav-path"),function(N,J){var D;(null===(D=O.paths[J])||void 0===D?0:D.onPathClick)&&N.addEventListener("click",function(K){O.paths[J].onPathClick(K)})}),V=this.paths[this.paths.length-1],V.edit&&(V.edit.formClass="flex flex-center fullscreen",V.edit.inputLabel=C["default"].itemProperties.editTitle,this._titleEdit=new t["default"](V.edit,this.domNode.querySelector(".js-last-path")),
this.own(c["default"].subscribe("inlineEdit/"+V.edit.prop+"/done",this.closeEdit.bind(this)),c["default"].subscribe("inlineEdit/"+V.edit.prop+"/cancel",this.closeEdit.bind(this)),c["default"].subscribe("inlineEdit/"+V.edit.prop+"/start",this.openEdit.bind(this)))))};F.prototype.generateBreadCrumbs=function(O){O=O.map(function(V,N,J){return a["default"].substitute(x["default"],q.__assign(q.__assign({},V),{icons:z["default"],showBack:1<J.length&&0===N?"":"hide",lastPath:N===J.length-1?"js-last-path subnav-breadcrumb-last flex-0":
"subnav-breadcrumb-first js-early-path"}))}).join("\x3cspan class\x3d'subnav-breadcrumb-separator flex-0 js-early-path'\x3e/\x3c/span\x3e");return a["default"].substitute(v["default"],{paths:O,_titleTypeSize:this._titleTypeSize})};F.prototype.openNav=function(){r["default"](".js-subnav-links, .js-subnav-expand",this.domNode).addClass("is-active")};F.prototype.closeNav=function(){r["default"](".js-subnav-links, .js-subnav-expand",this.domNode).removeClass("is-active")};F.prototype.toggleNav=function(O){b["default"].contains(O.target,
"is-active")?this.closeNav():this.openNav()};F.prototype.openEdit=function(O){r["default"](".js-subnav-links,.js-subnav-expand,.js-early-path").addClass("visibility-hidden")};F.prototype.closeEdit=function(){r["default"](".js-subnav-links,.js-subnav-expand,.js-early-path").removeClass("visibility-hidden")};F.prototype.handleKeyUp=function(O){32===O.keyCode&&(O.preventDefault(),this.logClickEvent(O.target,this.telemetry),p["default"](O.target.getAttribute("href"),!0))};F.prototype.handleLinkClick=
function(O){this.logClickEvent(O.target,this.telemetry)};F.prototype.logClickEvent=function(O,V){"true"===(null===O||void 0===O?void 0:O.dataset.logclick)&&(null===V||void 0===V?void 0:V.logEvent({category:"Secondary Nav",action:O.dataset.tab,size:window.innerWidth,pageUrl:window.location.href}))};return F=q.__decorate([f["default"](h["default"],d["default"])],F)}()})},"dojox/charting/bidi/widget/Chart":function(){define(["dojo/_base/declare"],function(e){return e(null,{postMixInProperties:function(){this.textDir=
this.params.textDir?this.params.textDir:this.params.dir},_setTextDirAttr:function(U){null!=(/^(ltr|rtl|auto)$/.test(U)?U:null)&&(this._set("textDir",U),this.chart.setTextDir(U))},_setDirAttr:function(U){this._set("dir",U);this.chart.setDir(U)}})})},"dojox/charting/bidi/axis2d/Default":function(){define(["dojo/_base/declare","dojo/dom-style"],function(e,U){return e(null,{labelTooltip:function(q,b,l,p,r,a){var c="rtl"==U.get(b.node,"direction"),d="rtl"==b.getTextDir(l);d&&!c&&(l="\x3cspan dir\x3d'rtl'\x3e"+
l+"\x3c/span\x3e");!d&&c&&(l="\x3cspan dir\x3d'ltr'\x3e"+l+"\x3c/span\x3e");this.inherited(arguments)},_isRtl:function(){return this.chart.isRightToLeft()}})})},"dojox/charting/bidi/action2d/Tooltip":function(){define(["dojo/_base/declare","dojo/dom-style"],function(e,U){return e(null,{_recheckPosition:function(q,b,l){if(this.chart.isRightToLeft()){var p=this.chart.offsets.l-this.chart.offsets.r;"marker"==q.element?(b.x=this.chart.dim.width-q.cx+p,l[0]="before-centered",l[1]="after-centered"):"circle"==
q.element?b.x=this.chart.dim.width-q.cx-q.cr+p:"bar"==q.element||"column"==q.element?(b.x=this.chart.dim.width-b.width-b.x+p,"bar"==q.element&&(l[0]="before-centered",l[1]="after-centered")):"candlestick"==q.element?b.x=this.chart.dim.width+p-q.x:"slice"==q.element&&("before-centered"!=l[0]&&"after-centered"!=l[0]||l.reverse(),b.x=q.cx+(q.cx-b.x))}},_format:function(q){var b="rtl"==U.get(this.chart.node,"direction"),l="rtl"==this.chart.getTextDir(q);return l&&!b?"\x3cspan dir \x3d 'rtl'\x3e"+q+"\x3c/span\x3e":
!l&&b?"\x3cspan dir \x3d 'ltr'\x3e"+q+"\x3c/span\x3e":q}})})},"dojox/charting/bidi/action2d/ZoomAndPan":function(){define(["dojo/_base/declare"],function(e){return e(null,{_getDelta:function(U){return this.inherited(arguments)*(this.chart.isRightToLeft()?-1:1)}})})},"dojox/charting/bidi/widget/Legend":function(){define("dojo/_base/declare dojo/dom dijit/registry dojo/_base/connect dojo/_base/array dojo/query".split(" "),function(e,U,q,b,l,p){function r(a){return/^(ltr|rtl|auto)$/.test(a)?a:null}return e(null,
{postMixInProperties:function(){if(this.chart)this.textDir=this.chart.textDir,b.connect(this.chart,"setTextDir",this,"_setTextDirAttr");else if(this.chartRef){var a=q.byId(this.chartRef);if(!a)if(a=U.byId(this.chartRef))a=q.byNode(a);else return;this.textDir=a.textDir;b.connect(a,"setTextDir",this,"_setTextDirAttr")}},_setTextDirAttr:function(a){null!=r(a)&&this.textDir!=a&&(this._set("textDir",a),a=p(".dojoxLegendText",this._tr),l.forEach(a,function(c){c.dir=this.getTextDir(c.innerHTML,c.dir)},this))}})})},
"url:arcgisonline/pages/dijit/InlineEdit/templates/InlineEdit.html":'\x3cdiv\x3e\r\n    \x3ch1 class\x3d"${titleClass} break-word flex text-ellipsis" data-edit-id\x3d"name" id\x3d"itemtitle" data-dojo-attach-point\x3d"_textView"\x3e\r\n        \x3cspan class\x3d"if-name js-view subnav-title__name" id\x3d"${titleId}"\x3e\x3c/span\x3e\r\n        \x3cbutton class\x3d"js-inline-edit btn btn-transparent padding-leader-quarter font-size--3 ${editButtonClasses}" aria-label\x3d"${inputLabel}"\x3e${!icons.edit.16}\x3c/button\x3e\r\n    \x3c/h1\x3e\r\n    \x3cform class\x3d"hide ${formClass}" data-edit-id\x3d"name" data-dojo-attach-point\x3d"_form"\x3e\r\n        \x3cdiv class\x3d"leader-0 flex flex-1"\x3e\r\n            \x3cinput maxlength\x3d"250" class\x3d"${inputClass} flex-1 margin-right-1 margin-left-0" name\x3d"name" type\x3d"text" placeholder\x3d"${placeholder}"\r\n                value\x3d"${value}" data-dojo-attach-point\x3d"_input" autocomplete\x3d"off"\x3e\r\n            \x3cspan class\x3d"flex-0"\x3e\r\n                \x3cbutton class\x3d"${saveButtonClasses}" type\x3d"submit" data-dojo-attach-point\x3d"_saveButton"\x3e${i18n.common.save}\x3c/button\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"flex-0"\x3e\r\n                \x3cbutton class\x3d"${cancelButtonClasses}" data-dojo-attach-point\x3d"_cancelButton"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"inline-edit-save-loader hide" data-dojo-attach-point\x3d"_saveLoader"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/InlineEdit/templates/inlineEditTextArea.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_textView"\x3e\r\n        \x3cbutton class\x3d"js-inline-edit right btn-link btn-link-darker-gray font-size--3 ${editButtonUpdatePermissionClasses}" aria-label\x3d"${inputLabel}"\x3e\r\n            ${!icons.inline.edit.16} ${i18n.common.edit}\r\n        \x3c/button\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cform data-dojo-attach-point\x3d"_form" class\x3d"hide" data-edit-id\x3d"snippet" aria-live\x3d"polite"\x3e\r\n        \x3clabel class\x3d"trailer-quarter" for\x3d"${inputId}"\x3e\r\n            ${inputLabel}\r\n            \x3ctextarea\r\n                id\x3d"${inputId}"\r\n                data-dojo-attach-point\x3d"_input"\r\n                name\x3d"snippet"\r\n                rows\x3d"${rows}"\r\n                class\x3d"js-snippet-input display-block resize-v"\x3e${value}\x3c/textarea\x3e\r\n        \x3c/label\x3e\r\n        \x3cdiv class\x3d"flex"\x3e\r\n            \x3cdiv class\x3d"flex-1"\x3e\r\n                \x3cdiv class\x3d"hide inline-edit__characters-left" data-dojo-attach-point\x3d"_charactersLeft"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"leader-quarter"\x3e\r\n                \x3cspan class\x3d"inline-edit-textarea__save-loader margin-right-half hide" data-dojo-attach-point\x3d"_saveLoader"\x3e\x3c/span\x3e\r\n                \x3cbutton data-dojo-attach-point\x3d"_saveButton" type\x3d"submit" class\x3d"btn"\x3e${i18n.common.save}\x3c/button\x3e\r\n                \x3cbutton data-dojo-attach-point\x3d"_cancelButton" class\x3d"btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/InlineEdit/templates/inlineEditFieldValueType.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_textView"\x3e\r\n    \x3cbutton class\x3d"js-inline-edit right btn-link btn-link-darker-gray font-size--3 ${editButtonUpdatePermissionClasses}" aria-label\x3d"${inputLabel}"\x3e${!icons.inline.edit.16}${i18n.common.edit}\x3c/button\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cform data-dojo-attach-point\x3d"_form" class\x3d"hide" data-edit-id\x3d"snippet" aria-live\x3d"polite"\x3e\r\n    \x3clabel class\x3d"trailer-half"\x3e\r\n      ${inputLabel}\r\n      \x3cselect class\x3d"dropdown-change" data-dojo-attach-point\x3d"_input"\x3e\x3c/select\x3e\r\n      \x3c!-- \x3cselect class\x3d"dropdown-change" data-dojo-attach-point\x3d"_type"\x3e\x3c/select\x3e --\x3e\r\n    \x3c/label\x3e\r\n    \x3cdiv class\x3d"text-right"\x3e\r\n        \x3cspan class\x3d"inline-edit-textarea__save-loader margin-right-half hide" data-dojo-attach-point\x3d"_saveLoader"\x3e\x3c/span\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_saveButton" type\x3d"submit" class\x3d"btn"\x3e${i18n.common.save}\x3c/button\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_cancelButton" class\x3d"btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/InlineEdit/templates/inlineEditRichText.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_textView" class\x3d"trailer-2"\x3e\r\n        \x3cbutton class\x3d"js-inline-edit btn-link btn-link-darker-gray ${editButtonUpdatePermissionClasses} font-size--3 right" aria-label\x3d"${inputLabel}"\x3e${!icons.inline.edit.16}${i18n.common.edit}\x3c/button\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cform data-dojo-attach-point\x3d"_form" action\x3d"" class\x3d"hide leader-1" aria-live\x3d"polite"\x3e\r\n        \x3clabel class\x3d"trailer-half" for\x3d"${inputId}"\x3e${inputLabel}\x3c/label\x3e\r\n        \x3cdiv id\x3d"${inputId}" class\x3d"rich-text" data-dojo-attach-point\x3d"_inputEl"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"text-right leader-half"\x3e\r\n            \x3cbutton data-dojo-attach-point\x3d"_saveButton" type\x3d"submit" class\x3d"btn"\x3e${i18n.common.save}\x3c/button\x3e\r\n            \x3cbutton data-dojo-attach-point\x3d"_cancelButton" class\x3d"btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/InlineEdit/templates/inlineEditCustom.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_textView" class\x3d"leader-1 padding-leader-half"\x3e\r\n        \x3cbutton class\x3d"js-inline-edit btn-link btn-link-darker-gray if-can-update font-size--3 right" aria-label\x3d"${inputLabel}"\x3e${!icons.inline.edit.16}${i18n.common.edit}\x3c/button\x3e\r\n        \x3ch5 class\x3d"trailer-half"\x3e\r\n            ${viewTitle}\r\n        \x3c/h5\x3e\r\n        \x3cp class\x3d"js-view break-word"\x3e\x3c/p\x3e\r\n    \x3c/div\x3e\r\n    \x3cform data-dojo-attach-point\x3d"_form" action\x3d"" class\x3d"hide ${formClass}" aria-live\x3d"polite"\x3e\r\n        ${formTitle}\r\n        \x3cdiv data-dojo-attach-point\x3d"_inputEl"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"text-right ${buttonsClass}"\x3e\r\n            \x3cbutton data-dojo-attach-point\x3d"_saveButton" type\x3d"submit" class\x3d"btn"\x3e${i18n.common.save}\x3c/button\x3e\r\n            \x3cbutton data-dojo-attach-point\x3d"_cancelButton" class\x3d"btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/InlineEdit/templates/inlineEditLayerRename.html":'\x3cdiv\x3e\r\n    \x3ch5 class\x3d"font-size-1 trailer-0 leader-0 sub-nav-title break-word" data-edit-id\x3d"name" id\x3d"itemtitle" data-dojo-attach-point\x3d"_textView"\x3e\r\n        \x3cspan class\x3d"padding-right-1 gutter-right-1 rtl-gutter-right-0"\x3e\r\n            \x3ca target\x3d"_blank" href\x3d"${layerUrl}" class\x3d"if-name js-view"\x3e\x3c/a\x3e\r\n        \x3c/span\x3e\r\n        \x3cbutton class\x3d"js-inline-edit right btn-link font-size--3 btn-link-darker-gray if-can-renameLayer" aria-label\x3d"${inputLabel}"\x3e${!icons.inline.edit.16}${i18n.common.edit}\x3c/button\x3e\r\n    \x3c/h5\x3e\r\n    \x3cform class\x3d"column-12 padding-leader-half padding-trailer-half hide" data-edit-id\x3d"name" data-dojo-attach-point\x3d"_form"\x3e\r\n        \x3cdiv class\x3d"input-group leader-0"\x3e\r\n            \x3cinput maxlength\x3d"250" class\x3d"input-group-input" name\x3d"name" type\x3d"text" placeholder\x3d"${placeholder}"\r\n                value\x3d"${value}" data-dojo-attach-point\x3d"_input"\x3e\r\n            \x3cspan class\x3d"input-group-button padding-right-quarter"\x3e\r\n                \x3cbutton class\x3d"btn" type\x3d"submit" data-dojo-attach-point\x3d"_saveButton"\x3e${i18n.common.save}\x3c/button\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"input-group-button"\x3e\r\n                \x3cbutton class\x3d"btn-link btn btn-clear btn-two cancel-title-edit" data-dojo-attach-point\x3d"_cancelButton"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"inline-edit-save-loader hide" data-dojo-attach-point\x3d"_saveLoader"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/InlineEdit/templates/inlineEditLayerRenameSubnav.html":'\x3cdiv class\x3d"flex-1 flex"\x3e\r\n    \x3ch5 class\x3d"trailer-0 leader-0 break-word flex" data-edit-id\x3d"name" id\x3d"itemtitle" data-dojo-attach-point\x3d"_textView"\x3e\r\n        \x3cspan class\x3d"padding-right-1 gutter-right-1 rtl-gutter-right-0 js-view subnav-breadcrumb flex-1 text-ellipsis"\x3e\x3c/span\x3e\r\n        \x3cbutton class\x3d"js-inline-edit right btn-link font-size--3 btn-link-white" aria-label\x3d"${inputLabel}"\x3e${!icons.edit.16}\x3c/button\x3e\r\n    \x3c/h5\x3e\r\n    \x3cform class\x3d"hide ${formClass}" data-edit-id\x3d"name" data-dojo-attach-point\x3d"_form"\x3e\r\n        \x3cdiv class\x3d"leader-0 flex flex-1"\x3e\r\n            \x3cinput maxlength\x3d"250" class\x3d"${inputClass} flex-1 margin-right-1 margin-left-0" name\x3d"name" type\x3d"text" placeholder\x3d"${placeholder}"\r\n                value\x3d"${value}" data-dojo-attach-point\x3d"_input" autocomplete\x3d"off"\x3e\r\n            \x3cspan class\x3d"flex-0"\x3e\r\n                \x3cbutton class\x3d"${saveButtonClasses}" type\x3d"submit" data-dojo-attach-point\x3d"_saveButton"\x3e${i18n.common.save}\x3c/button\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"flex-0"\x3e\r\n                \x3cbutton class\x3d"${cancelButtonClasses}" data-dojo-attach-point\x3d"_cancelButton"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"inline-edit-save-loader hide" data-dojo-attach-point\x3d"_saveLoader"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/InlineEdit/templates/inlineEditNotebookTags.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_textView"\x3e\r\n    \x3cbutton\r\n      class\x3d"js-inline-edit btn-link btn-link-darker-gray if-can-update font-size--3 right"\r\n      aria-label\x3d"${inputLabel}"\r\n    \x3e\r\n      ${!icons.inline.edit.16}${i18n.common.edit}\r\n    \x3c/button\x3e\r\n    \x3ch4 class\x3d"panel-header if-tag if-can-update"\x3e${viewTitle}\x3c/h5\x3e\r\n    \x3cp class\x3d"js-view"\x3e\x3c/p\x3e\r\n  \x3c/div\x3e\r\n  \x3cform data-dojo-attach-point\x3d"_form" action\x3d"" class\x3d"hide ${formClass}" aria-live\x3d"polite"\x3e\r\n    ${formTitle}\r\n    \x3cdiv data-dojo-attach-point\x3d"_inputEl"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"text-right ${buttonsClass}"\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_saveButton" type\x3d"submit" class\x3d"btn"\x3e${i18n.common.save}\x3c/button\x3e\r\n      \x3cbutton data-dojo-attach-point\x3d"_cancelButton" class\x3d"btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/ImageViewer/ImageViewer.html":'\x3cdiv class\x3d"image-viewer js-image-viewer"\x3e\r\n  \x3cimg src\x3d"${url}" alt\x3d"${alt}" class\x3d"image-viewer__img"\x3e\r\n\x3c/div\x3e',"url:arcgisonline/pages/dijit/ItemShareSummary/ItemShareSummary.html":'\x3cdiv class\x3d"share-summary ${directionClass} ${responsiveClass}"\x3e\r\n  \x3cbutton class\x3d"js-share-button share-summary__button flex flex-center flex-0 tooltip tooltip--data tooltip-multiline tooltip--multiline-short"\x3e\r\n    \x3cspan class\x3d"js-icon share-summary__level flex flex-center"\x3e${!levelIcon}\x3c/span\x3e\r\n    \x3cspan class\x3d"js-sharing-plus-icon share-summary__plus"\x3e${!icons.plus.16}\x3c/span\x3e\r\n    \x3cspan class\x3d"share-summary__group share-summary__group--unknown"\x3e\r\n      ${!icons.users.16}\r\n    \x3c/span\x3e\r\n  \x3c/button\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/ItemShareSummary/ItemShareSummaryOverflow.html":'\x3cspan class\x3d"share-summary__overflow"\x3e\x26#43;${num}\x3c/span\x3e',"url:arcgisonline/pages/dijit/OrgPopup/OrgPopup.html":'\x3cdiv\x3e\r\n  \x3cspan tabindex\x3d"0" data-dojo-attach-point\x3d"closeIcon" class\x3d"hide popover-close icon-ui-close" tab-index\x3d"0" aria-label\x3d"${i18n.common.close}"\x3e\x3c/span\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"loader" class\x3d"profile-popup__loader loader"\x3e\r\n    \x3cdiv class\x3d"profile-popup__loader-bars loader-bars"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"text-left" data-dojo-attach-point\x3d"content"\x3e\r\n    \x3cdiv class\x3d"profile-popup__top-section flex flex-align-center"\x3e\r\n      \x3cimg src\x3d"${item.verified.thumbnail}" class\x3d"profile-popup__org-thumbnail margin-right-1"\x3e\r\n      \x3cdiv class\x3d"flex-1 font-size-1 avenir-demi"\x3e\r\n        ${item.verified.name}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"profile-popup__org-bottom" data-dojo-attach-point\x3d"bottomSection"\x3e\r\n      \x3cdiv class\x3d"profile-popup__bio-container" data-dojo-attach-point\x3d"descContainer"\x3e\r\n        \x3cp class\x3d"profile-popup__bio-section trailer-half" data-dojo-attach-point\x3d"descEl"\x3e\x3c/p\x3e\r\n        \x3cbutton class\x3d"hide btn-link btn-link-darker-gray profile-popup__more-toggle" data-dojo-attach-point\x3d"descToggle"\x3e${!icons.chevron-down.24}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"leader-1"\x3e\r\n        \x3ca href\x3d"${item.verified.url}"  target\x3d"_blank"\x3e${i18n.myOrganization.homeTab.tabTitle} ${!icons.inline-end.launch.16}\x3c/a\x3e\r\n        \x3ca href\x3d"${item.verified.url}gallery.html"  target\x3d"_blank" class\x3d"margin-left-1"\x3e${i18n.myOrganization.galleryTab.tabTitle} ${!icons.inline-end.launch.16}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/ToggleSwitch/templates/ToggleSwitch.html":'\x3clabel class\x3d"toggle-switch clearfix ${labelClasses} ${hasTooltip}" for\x3d"${uid}"\x3e\r\n  \x3cinput id\x3d"${uid}" type\x3d"checkbox" class\x3d"toggle-switch-input" aria-label\x3d"${label}" data-dojo-attach-point\x3d"_checkbox"\x3e\r\n  \x3cspan class\x3d"toggle-switch-track ${direction}" data-dojo-attach-point\x3d"toggleTrack"\x3e\x3c/span\x3e\r\n  \x3cspan class\x3d"inline-block margin-${direction}-half toggle-switch-label ${tooltipClass} padding-leader-quarter padding-trailer-quarter" data-dojo-attach-point\x3d"_label"\x3e\r\n    \x3cspan class\x3d"toggle-switch-label--text" data-dojo-attach-point\x3d"labelWrapper"\x3e${!label}\x3c/span\x3e\r\n  \x3c/span\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"loaderContainer" class\x3d"toggle-switch__loader-container hide"\x3e\r\n    \x3ccalcite-loader scale\x3d"l" inline data-dojo-attach-point\x3d"loader"\x3e\x3c/calcite-loader\x3e\r\n  \x3c/div\x3e\r\n\x3c/label\x3e\r\n',
"url:arcgisonline/sharing/dijit/templates/CopyToClipboard.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"input-group js-copy-group"\x3e\r\n    \x3cinput data-dojo-attach-point\x3d"copyInput" class\x3d"input-group-input copy-to-clipboard-input" readonly type\x3d"text" value\x3d"${text}" id\x3d"copy-to-clipboard-${id}"\x3e\r\n    \x3cspan class\x3d"js-copy-tooltip input-group-button tooltip ${tooltipModifier}" aria-label\x3d"${i18n.tocPanel.copy}"\x3e\r\n      \x3cbutton aria-label\x3d"${i18n.itemProperties.copyToClipboard}"\r\n              class\x3d"js-copy-btn btn btn-clear"\r\n              data-dojo-attach-event\x3d"click: copy, mouseleave: reset"\x3e\r\n              \x3ccalcite-icon scale\x3d"s" icon\x3d"${icon}" \x3e\x3c/calcite-icon\x3e\r\n      \x3c/button\x3e\r\n    \x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cp role\x3d"alert" aria-live\x3d"polite" class\x3d"js-copy-alert screen-readers-only"\x3e\x3c/p\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_sublayer.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"js-sublayer-content hide"\x3e\r\n    \x3cdiv class\x3d"column-17 tablet-column-6 post-1 rtl-post-0"\x3e\r\n      \x3cdiv class\x3d"column-17 flex phone-flex-column phone-trailer-2 first-column tablet-column-6"\x3e\r\n        \x3cdiv class\x3d"phone-leader-1"\x3e\r\n          \x3cdiv class\x3d"sublayer-map" data-dojo-attach-point\x3d"map"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"js-snippet-section leader-1"\x3e\r\n            \x3cp class\x3d"trailer-half font-size--1 js-typeOwner-info"\x3e\r\n              ${!icon}\r\n              \x3cspan class\x3d"inline-block avenir-medium margin-right-quarter"\x3e${layerType}\x3c/span\x3e\r\n            \x3c/p\x3e\r\n          \x3c/div\x3e\r\n          \x3cbutton class\x3d"flex btn-link" data-dojo-attach-point\x3d"sublayerOwnerPopup"\x3e\r\n            \x3cspan class\x3d"js-sublayer-owner-thumb no-pointer"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"flex-1 font-size--2 padding-left-quarter no-pointer"\x3e${item.owner}\x3c/span\x3e\r\n          \x3c/button\x3e\r\n          \x3cp class\x3d"font-size--3 trailer-half leader-1 text-darker-gray" data-dojo-attach-point\x3d"lastUpdated"\x3e\r\n            \x3cspan class\x3d"inline-block margin-right-1 margin-left-0"\x3e\r\n              ${i18n.itemProperties.dataLastModified} ${lastUpdate}\r\n            \x3c/span\x3e\r\n          \x3c/p\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3caside class\x3d"column-6 right tablet-column-6 tablet-right padding-trailer-2"\x3e\r\n      \x3cdiv class\x3d"if-featureCollection if-vectorTile if-2d if-table"\x3e\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half display-block js-status-disable"\x3e\r\n          \x3cdiv class\x3d"flex clearfix"\x3e\r\n            \x3ca\r\n              data-dojo-attach-point\x3d"viewerLink"\r\n              class\x3d"btn btn-split btn-wrap flex-1 text-center text-ellipsis js-open-mapViewer js-open-btn js-action-newWebMapViewer"\r\n            \x3e\r\n              ${i18n.itemLinks.openMapViewer}\r\n            \x3c/a\x3e\r\n            \x3cbutton\r\n              class\x3d"btn btn-split-right inline-block btn-split js-dropdown-toggle"\r\n              aria-label\x3d"${i18n.itemProperties.openMenu}"\r\n            \x3e\r\n              ${!icons.chevron-down.16}\r\n            \x3c/button\x3e\r\n          \x3c/div\x3e\r\n          \x3cnav class\x3d"dropdown-menu dropdown-menu-full dropdown-right"\x3e\r\n            \x3ca data-dojo-attach-point\x3d"newViewerLink" class\x3d"dropdown-link test-ellipsis"\r\n              \x3e${i18n.itemLinks.addToNewViewer}\r\n            \x3c/a\x3e\r\n            \x3ca data-dojo-attach-point\x3d"newViewerWithEditLink" class\x3d"dropdown-link test-ellipsis if-can-edit-service"\r\n              \x3e${i18n.itemProperties.openViewerFullEditingRole}\r\n            \x3c/a\x3e\r\n            \x3cdiv class\x3d"if-map-viewer-beta"\x3e\r\n              \x3ca data-dojo-attach-point\x3d"newMapViewerLink" class\x3d"dropdown-link if-feature"\r\n                \x3e${!i18n.itemLinks.openMapViewerBetaLabel}\r\n              \x3c/a\x3e\r\n              \x3c!-- removed if-vectorTile if-mapService if-mapImage classes, reapply at 8.2 --\x3e\r\n            \x3c/div\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-can-export if-no-spatiotemporal if-not-velocity"\x3e\r\n        \x3cbutton\r\n          class\x3d"js-if-not-readonly btn btn-fill btn-clear js-dropdown-toggle js-open-btn text-ellipsis"\r\n          tabindex\x3d"0"\r\n        \x3e\r\n          ${i18n.itemProperties.exportLabel}${!icons.inline-end.chevron-down.16}\r\n        \x3c/button\x3e\r\n        \x3cnav data-dojo-attach-point\x3d"export" class\x3d"dropdown-menu dropdown-right can-export js-action-exportData"\x3e\r\n          \x3cbutton data-type\x3d"Shapefile" class\x3d"dropdown-link if-no-multipatch"\x3e\r\n            ${i18n.itemProperties.exportToShapefile}\r\n          \x3c/button\x3e\r\n          \x3cbutton data-type\x3d"CSV" class\x3d"dropdown-link if-no-multipatch"\x3e${i18n.itemProperties.exportToCSVFile}\x3c/button\x3e\r\n          \x3cbutton data-type\x3d"KML" class\x3d"dropdown-link js-kml-export if-no-multipatch if-no-location-tracking"\x3e\r\n            ${i18n.itemProperties.exportToKML}\r\n          \x3c/button\x3e\r\n          \x3cbutton data-type\x3d"Excel" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking"\x3e\r\n            ${i18n.itemProperties.exportToExcel}\r\n          \x3c/button\x3e\r\n          \x3cbutton data-type\x3d"File Geodatabase" class\x3d"dropdown-link if-no-location-tracking"\x3e\r\n            ${i18n.itemProperties.exportToFgdb}\r\n          \x3c/button\x3e\r\n          \x3cbutton data-type\x3d"GeoJson" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking"\x3e\r\n            ${i18n.itemProperties.exportToGeoJson}\r\n          \x3c/button\x3e\r\n          \x3cbutton data-type\x3d"Feature Collection" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking"\x3e\r\n            ${i18n.itemProperties.exportToFeatureCollection}\r\n          \x3c/button\x3e\r\n          \x3cbutton data-type\x3d"GeoPackage" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking"\x3e\r\n              ${i18n.itemProperties.exportToGeoPackage}\r\n            \x3c/button\x3e\r\n        \x3c/nav\x3e\r\n      \x3c/div\x3e\r\n      \x3cbutton\r\n        data-dojo-attach-point\x3d"viewLayer"\r\n        data-type\x3d"features"\r\n        class\x3d"trailer-half btn btn-fill btn-wrap text-ellipsis btn-clear if-can-publish-views if-not-velocity"\r\n      \x3e\r\n        ${i18n.itemProperties.publishViewLayer}\r\n      \x3c/button\x3e\r\n      \x3cbutton class\x3d"btn btn-fill btn-clear if-can-appendData trailer-half" data-dojo-attach-point\x3d"append"\x3e\r\n        ${i18n.itemProperties.appendData}\r\n      \x3c/button\x3e\r\n      \x3ca class\x3d"btn btn-fill btn-clear trailer-half" data-dojo-attach-point\x3d"geocodeReview"\x3e\r\n        ${i18n.geocodePanel.geocodePanelTitle}\r\n      \x3c/a\x3e\r\n\r\n      \x3cspan class\x3d"if-online"\x3e\r\n        \x3c!-- Metadata - for a viewer, only show metadata link to view HTML metadata if layer has metadata --\x3e\r\n        \x3cspan class\x3d"if-viewer"\x3e\r\n          \x3ca\r\n            target\x3d"_blank"\r\n            class\x3d"js-metadata-link if-layerMetadata trailer-half btn btn-fill btn-clear text-ellipsis"\r\n          \x3e\r\n            ${i18n.itemProperties.metadataURL}\r\n          \x3c/a\x3e\r\n        \x3c/span\x3e\r\n\r\n        \x3c!-- Metadata - for someone who can update, for a non-hosted layer, only show metadata link to view HTML metadata if layer has metadata --\x3e\r\n        \x3cspan class\x3d"if-can-update if-not-hosted if-not-onpremise"\x3e\r\n          \x3ca\r\n            target\x3d"_blank"\r\n            class\x3d"js-metadata-link if-no-viewer if-layerMetadata trailer-half btn btn-fill btn-clear text-ellipsis"\r\n            \x3e${i18n.itemProperties.metadataURL}\r\n          \x3c/a\x3e\r\n        \x3c/span\x3e\r\n\r\n        \x3c!-- Metadata - for someone who can update, for a hosted layer, and metadata for the org is enabled, allow opening metadata editor --\x3e\r\n        \x3cspan class\x3d"if-hosted if-can-update if-metadata-enabled if-not-onpremise"\x3e\r\n          \x3cbutton\r\n            class\x3d"if-no-viewer trailer-half btn btn-fill btn-clear text-ellipsis"\r\n            data-dojo-attach-point\x3d"metadataEdit"\r\n          \x3e\r\n            ${i18n.itemProperties.metadataURL}\r\n          \x3c/button\x3e\r\n        \x3c/span\x3e\r\n\r\n        \x3c!-- Metadata - for someone who can update, layer has metadata, but org has metadata disabled, allow viewing HTML metadata --\x3e\r\n        \x3cspan class\x3d"if-metadata-disabled"\x3e\r\n          \x3cspan class\x3d"if-layerMetadata"\x3e\r\n            \x3ca\r\n              target\x3d"_blank"\r\n              class\x3d"js-metadata-link if-no-viewer if-can-update if-hosted if-layerMetadata trailer-half btn btn-fill btn-clear text-ellipsis"\r\n            \x3e\r\n              ${i18n.itemProperties.metadataURL}\r\n            \x3c/a\x3e\r\n          \x3c/span\x3e\r\n        \x3c/span\x3e\r\n      \x3c/span\x3e\r\n\r\n      \x3c!-- On-premise Portal supported metadata layer actions --\x3e\r\n      \x3cspan class\x3d"if-on-premise"\x3e\r\n        \x3c!-- Metadata - for on-premise Portal, only show metadata link to view HTML metadata if layer has metadata --\x3e\r\n        \x3ca target\x3d"_blank" class\x3d"js-metadata-link if-layerMetadata trailer-half btn btn-fill btn-clear text-ellipsis"\x3e\r\n          ${i18n.itemProperties.metadataURL}\r\n        \x3c/a\x3e\r\n      \x3c/span\x3e\r\n    \x3c/aside\x3e\r\n\r\n    \x3cdiv class\x3d"column-17 post-1 rtl-post-0 trailer-4 tablet-trailer-2"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"subtypes"\x3e\r\n        \x3ch4 class\x3d"leader-2 font-size-1"\x3e${i18n.itemProperties.layers}\x3c/h4\x3e\r\n        \x3cul class\x3d"list-plain" data-dojo-attach-point\x3d"subtypesList"\x3e\x3c/ul\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"position-relative"\x3e\r\n        \x3cdiv class\x3d"js-sublayer-summary-section"\x3e\r\n          \x3ch4 class\x3d"leader-2 font-size-1"\x3e${i18n.itemProperties.summary}\x3c/h4\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"summary" class\x3d"js-view description-rich-text break-word overflow-auto"\x3e\x3c/div\x3e\r\n          \x3cp class\x3d"text-darker-gray trailer-0"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"summaryUnavailable"\x3e${i18n.sublayer.summaryUnavailable}\x3c/span\x3e\r\n            \x3cbutton data-dojo-attach-point\x3d"summaryAdd" class\x3d"js-inline-edit btn-link text-left"\x3e\r\n              ${i18n.sublayer.addSummary}\r\n            \x3c/button\x3e\r\n          \x3c/p\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"js-sublayer-summary-loader loader loader-flex overlay-white fullscreen"\x3e\r\n          \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"loader-text padding-leader-4"\x3e${i18n.itemProperties.updatingItemLabel}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"position-relative"\x3e\r\n        \x3cdiv class\x3d"js-sublayer-description-section"\x3e\r\n          \x3ch4 class\x3d"leader-2 font-size-1"\x3e${i18n.itemProperties.description}\x3c/h4\x3e\r\n          \x3cdiv\r\n            data-dojo-attach-point\x3d"description"\r\n            class\x3d"js-view description-rich-text break-word overflow-auto"\r\n          \x3e\x3c/div\x3e\r\n          \x3cp class\x3d"text-darker-gray trailer-0"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"descriptionUnavailable"\x3e${i18n.sublayer.descriptionUnavailable}\x3c/span\x3e\r\n            \x3cbutton data-dojo-attach-point\x3d"descriptionAdd" class\x3d"js-inline-edit btn-link text-left"\x3e\r\n              ${i18n.sublayer.addDescription}\r\n            \x3c/button\x3e\r\n          \x3c/p\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"js-sublayer-description-loader loader loader-flex overlay-white fullscreen"\x3e\r\n          \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"loader-text padding-leader-4"\x3e${i18n.itemProperties.updatingItemLabel}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"position-relative"\x3e\r\n        \x3cdiv class\x3d"js-sublayer-credits"\x3e\r\n          \x3ch4 class\x3d"leader-2 font-size-1"\x3e${i18n.itemProperties.credits}\x3c/h4\x3e\r\n          \x3cspan class\x3d"text-darker-gray trailer-half"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"creditsUnavailable"\x3e${i18n.itemProperties.creditsUnavailable}\x3c/span\x3e\r\n            \x3cbutton data-dojo-attach-point\x3d"creditsAdd" class\x3d"btn-link js-inline-edit text-left"\x3e\r\n              ${i18n.sublayer.source}\r\n            \x3c/button\x3e\r\n          \x3c/span\x3e\r\n          \x3cp data-dojo-attach-point\x3d"credits" class\x3d"js-view"\x3e\x3c/p\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"js-sublayer-credits-loader loader loader-flex overlay-white fullscreen"\x3e\r\n          \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"loader-text padding-leader-4"\x3e${i18n.itemProperties.updatingItemLabel}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3csection class\x3d"js-details font-size--1 column-6 tablet-column-6 tablet-leader-1 trailer-4"\x3e\r\n      \x3clabel for\x3d"service-url"\x3e\r\n        \x3ch5 class\x3d"trailer-half leader-2 tablet-leader-0 avenir-medium font-size-0"\x3e\r\n          ${i18n.itemProperties.url}\r\n          \x3ca\r\n            data-dojo-attach-point\x3d"viewLink"\r\n            target\x3d"_blank"\r\n            class\x3d"font-size--3 link-darker-gray avenir-regular right"\r\n          \x3e\r\n            ${!icons.inline.launch.16}${i18n.itemProperties.metadataView}\r\n          \x3c/a\x3e\r\n        \x3c/h5\x3e\r\n        \x3cdiv class\x3d"js-sublayer-copy"\x3e\x3c/div\x3e\r\n      \x3c/label\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"attachments"\x3e\r\n        \x3ch5 class\x3d"trailer-half leader-2 avenir-medium font-size-0"\x3e${i18n.sublayer.attachments}\x3c/h5\x3e\r\n        \x3cdiv class\x3d"js-toggle-attachments"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"timeSettings" class\x3d"if-hosted if-no-location-tracking"\x3e\r\n        \x3ch5 class\x3d"trailer-half leader-2 avenir-medium font-size-0"\x3e${i18n.sublayer.timeSettings}\x3c/h5\x3e\r\n        \x3cbutton\r\n          data-dojo-attach-point\x3d"timeSettingsEdit"\r\n          class\x3d"btn-settings"\r\n          aria-label\x3d"${i18n.sublayer.editTimeSettings}"\r\n        \x3e\r\n          \x3cspan data-dojo-attach-point\x3d"timeSettingsEnabled" class\x3d"no-pointer"\x3e\r\n            \x3cspan class\x3d"text-green"\x3e${!icons.inline.check-circle.16}\x3c/span\x3e ${i18n.sublayer.enabled}\r\n            \x3cspan class\x3d"right"\x3e${!icons.inline.edit.16}\x3c/span\x3e\r\n          \x3c/span\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"timeSettingsDisabled" class\x3d"no-pointer"\x3e\r\n            ${i18n.sublayer.notEnabled} \x3cspan class\x3d"right"\x3e${!icons.inline.edit.16}\x3c/span\x3e\r\n          \x3c/span\x3e\r\n        \x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/section\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"js-sublayer-loader"\x3e\r\n    \x3cdiv class\x3d"loader is-active padding-leader-4 padding-trailer-4"\x3e\r\n      \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"loader-text"\x3e${!i18n.common.loading}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/sublayer/_disableAttachments.html":'\x3cdiv class\x3d"panel panel-white panel-no-border padding-left-2 padding-right-2 padding-leader-2 padding-trailer-2"\x3e\r\n  \x3ch4 class\x3d"font-size-0 avenir-medium"\x3e${i18n.sublayer.disableAttachmentsTitle}\x3c/h4\x3e\r\n  \x3cp class\x3d"font-size--1 trailer-0"\x3e${i18n.sublayer.disableAttachmentsDescription}\x3c/p\x3e\r\n\x3c/div\x3e\r\n',"url:arcgisonline/sharing/dijit/templates/RasterFunctionEditor.html":"\x3cdiv class\x3d\"esriRFxEditorContainer\"\x3e\r\n  \x3cdiv class\x3d'close-btn'\x3e \r\n  \x3csvg xmlns\x3d'http://www.w3.org/2000/svg' width\x3d'15' height\x3d'15' viewBox\x3d'0 0 32 32' class\x3d'svg-icon'\x3e \r\n    \x3cpath d\x3d'M18.404 16l9.9 9.9-2.404 2.404-9.9-9.9-9.9 9.9L3.696 25.9l9.9-9.9-9.9-9.898L6.1 3.698l9.9 9.899 9.9-9.9 2.404 2.406-9.9 9.898z'/\x3e \r\n  \x3c/svg\x3e \r\n  \x3c/div\x3e \r\n  \x3cdiv data-dojo-attach-point\x3d'passiveOverlay' class\x3d'passive-overlay'\x3e\x3c/div\x3e \r\n  \x3ciframe data-dojo-attach-point\x3d'_iframe'\x3e \r\n  \x3c/iframe\x3e \r\n\x3c/div\x3e\r\n",
"url:arcgisonline/pages/item/widgets/templates/_comment.html":'\x3cdiv class\x3d"js-comment" data-comment-id\x3d"${comment.id}"\x3e\r\n    \x3cdiv class\x3d"panel panel-white panel-bordered border-bottom-clear flex ${classNames}"\x3e\r\n        \x3cdiv class\x3d"comment-avatar flex-0"\x3e\r\n            \x3cspan class\x3d"js-comment-avatar"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"flex-1 padding-left-1"\x3e\r\n            \x3cp class\x3d"comment-meta font-size--2"\x3e\r\n                \x3cspan\x3e\r\n                  \x3cbutton data-owner\x3d"${comment.owner}" class\x3d"js-comment-profile font-size-0 btn-link"\x3e\r\n                    \x3cspan class\x3d"padding-right-half"\x3e${commentOwnerProfile.username}\x3c/span\x3e\r\n                  \x3c/button\x3e\r\n                  \x3cspan class\x3d"js-comment-profile if-item-owner label"\x3e${i18n.common.itemOwner}\x3c/span\x3e\r\n                \x3c/span\x3e\r\n                \x3cspan class\x3d"padding-left-half tooltip"\r\n                      aria-label\x3d"${comment.created:_formatDate} ${comment.created:_formatTime}"\x3e${comment.created:_formatCommentDate}\x3c/span\x3e\r\n                \x3c!-- if owner of item or owner of comment, can delete --\x3e\r\n                \x3c!-- anybody can reply, only one level deep --\x3e\r\n                \x3cspan class\x3d"right clearfix"\x3e\r\n                    \x3cbutton data-id\x3d"${comment.id}"\r\n                            data-type\x3d"comment"\r\n                            class\x3d"if-can-delete-comment right btn-link btn-link-delete-reply js-action-deleteComment"\r\n                            aria-controls\x3d"comments"\x3e\r\n                        ${i18n.common.deleteLabel}\r\n                    \x3c/button\x3e\r\n                    \x3cbutton data-id\x3d"${comment.id}"\r\n                            class\x3d"btn-link btn-link-delete-reply right if-signed-in js-action-reply"\x3e\r\n                        ${i18n.common.reply}\r\n                    \x3c/button\x3e\r\n                \x3c/span\x3e\r\n            \x3c/p\x3e\r\n\r\n            \x3cp class\x3d"font-size--1 text-off-black trailer-half break-word"\x3e${comment.comment}\x3c/p\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"js-reply-${comment.id} if-signed-in padding-left-4 hide"\x3e\r\n        \x3cdiv class\x3d"panel border-bottom-clear"\x3e\r\n            \x3cdiv class\x3d"flex"\x3e\r\n                \x3cdiv class\x3d"comment-avatar flex-0"\x3e\r\n                    \x3cspan class\x3d"js-portal-user-avatar"\x3e\x3c/span\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"flex-1 padding-left-1"\x3e\r\n                    \x3ctextarea class\x3d"js-disable-addComment js-reply leader-0 trailer-half display-block" rows\x3d"3"\r\n                              placeholder\x3d"${i18n.itemProperties.leaveComment}"\x3e\x3c/textarea\x3e\r\n                    \x3cbutton class\x3d"js-action-cancelReply btn btn-small btn-clear btn-two right"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n                    \x3cbutton data-id\x3d"${comment.id}"\r\n                            data-type\x3d"reply"\r\n                            type\x3d"button"\r\n                            class\x3d"btn btn-small inline-block right js-action-addComment js-disable-addComment"\r\n                            aria-controls\x3d"comments"\x3e\r\n                        ${i18n.itemProperties.comment}\r\n                    \x3c/button\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/item/widgets/templates/_reply.html":'\x3cdiv class\x3d"panel panel-white panel-bordered padding-left-4 border-bottom-clear flex ${classNames}" data-comment-id\x3d"${comment.id}"\x3e\r\n    \x3cdiv class\x3d"comment-avatar flex-0"\x3e\r\n        \x3cspan class\x3d"js-comment-avatar"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"flex-1 padding-left-1"\x3e\r\n        \x3cp class\x3d"comment-meta font-size--2"\x3e\r\n            \x3cspan\x3e\r\n              \x3cbutton data-owner\x3d"${comment.owner}" class\x3d"js-comment-profile font-size-0 padding-right-half btn-link"\x3e${commentOwnerProfile.username}\x3c/button\x3e\r\n              \x3cspan class\x3d"js-comment-profile if-item-owner label"\x3e${i18n.common.itemOwner}\x3c/span\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"padding-left-half tooltip" aria-label\x3d"${comment.created:_formatDate} ${comment.created:_formatTime}"\x3e${comment.created:_formatCommentDate}\x3c/span\x3e\r\n\r\n            \x3cbutton data-id\x3d"${comment.id}"\r\n                    data-type\x3d"reply"\r\n                    class\x3d"if-can-delete-comment js-action-deleteComment right btn-link btn-link-delete-reply"\r\n                    aria-controls\x3d"comments"\x3e\r\n                ${i18n.common.deleteLabel}\r\n            \x3c/button\x3e\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"font-size--1 text-off-black trailer-half break-word"\x3e${comment.comment}\x3c/p\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_layerActions.html":'\x3ca href\x3d"${url}" class\x3d"side-nav-link layer-card js-sublayer-link" data-id\x3d"${layer.id}"\x3e\r\n  \x3cdiv class\x3d"flex flex-center padding-leader-quarter padding-trailer-quarter no-pointer"\x3e\r\n    \x3cdiv class\x3d"flex-0 margin-right-half margin-left-half"\x3e\r\n      ${geometryIcon}\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"flex-1"\x3e\r\n      \x3ch5 class\x3d"font-size--1 avenir-medium trailer-0 text-darkest-gray js-sublayer-name" data-id\x3d"${layer.id}"\x3e${layer.name}\x3c/h5\x3e\r\n      \x3cp class\x3d"font-size--3 trailer-0 text-darker-gray pointer-none"\x3e${geometryType}\x3c/h5\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"flex-0"\x3e\r\n      ${icons.chevron-right.16}\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/a\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_layerRenameActions.html":'\x3cdiv class\x3d"can-renameLayer panel panel-white panel-bordered panel-compact border-bottom-clear"\x3e\r\n  \x3cdiv class\x3d"js-layer-rename"\x3e\r\n    \x3c!-- Container for title InlineEdit --\x3e\r\n  \x3c/div\x3e  \r\n\x3c/div\x3e\r\n',"url:arcgisonline/pages/item/widgets/templates/_modelCharacteristics.html":'\x3cbutton class\x3d"block trailer-1 thumbnail-link thumbnail-link--mixed-height js-model-characteristic"\x3e\r\n  \x3cimg src\x3d"${url}" class\x3d"js-model-characteristic-img no-pointer"\x3e\r\n  \x3cspan class\x3d"thumbnail-overlay if-defaultOpen"\x3e\r\n    \x3cspan class\x3d"font-size--1 text-center thumbnail-icon"\x3e\r\n      ${icons.inline.magnifying-glass-plus.16} ${i18n.itemProperties.viewImage}\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n\x3c/button\x3e',
"url:arcgisonline/pages/item/widgets/templates/_toolActions.html":'\x3cdiv class\x3d"${attributes} panel panel-white panel-bordered panel-compact border-bottom-clear"\x3e\r\n  \x3ch5 class\x3d"font-size-1 trailer-0"\x3e\r\n    \x3ca target\x3d"_blank" href\x3d"${tool.url}"\x3e${tool.name}\x3c/a\x3e\r\n  \x3c/h5\x3e\r\n  \x3cnav class\x3d"inline-block" aria-label\x3d"${i18n.itemProperties.layerActions} ${tool.name}"\x3e\r\n    \x3c!-- Open --\x3e\r\n    \x3cdiv class\x3d"dropdown js-dropdown dropdown-right"\x3e\r\n      \x3cspan class\x3d"padding-right-1"\x3e\r\n        \x3cbutton class\x3d"js-dropdown-toggle font-size--3 icon-ui-link-external btn-link btn-link-darker-gray"\r\n                tabindex\x3d"0"\x3e${i18n.itemProperties.openIn}\r\n          \x3cspan class\x3d"icon-ui-down-arrow icon-ui-flush"\x3e\x3c/span\x3e\r\n        \x3c/button\x3e\r\n      \x3c/span\x3e\r\n      \x3c!-- extends side-nav --\x3e\r\n      \x3cnav class\x3d"dropdown-menu"\x3e\r\n          \x3ca href\x3d"${tool.mapViewerUrl}" class\x3d"dropdown-link js-open-mapViewer"\x3e${i18n.itemLinks.openMapViewer}\x3c/a\x3e\r\n      \x3c/nav\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3ca href\x3d"${tool.url}"\r\n       target\x3d"_blank"\r\n       class\x3d"link-darker-gray icon-ui-link-external inline-block font-size--3 js-open-url"\x3e${i18n.itemProperties.serviceURL}\x3c/a\x3e\r\n  \x3c/nav\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_owner.html":'\x3cp class\x3d"flex-center"\x3e\r\n  \x3cspan class\x3d"js-owner-thumbnail"\x3e\x3c/span\x3e\r\n  \x3cspan class\x3d"flex-1"\x3e${item.owner}\x3cspan\x3e\r\n\x3c/p\x3e',"url:arcgisonline/pages/item/widgets/templates/_ownerVerified.html":'\x3cp\x3e\r\n  \x3cspan class\x3d"font-size-0 flex-center"\x3e\r\n    \x3cspan class\x3d"js-verified-thumbnail"\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"flex-1"\x3e${item.verified.name}\x3c/span\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"font-size--2 leader-half display-block text-ellipsis"\x3e\r\n    \x3cspan class\x3d"display-block font-size--3"\x3e${i18n.itemProperties.managedBy}\x3c/span\x3e\r\n    \x3cspan class\x3d"flex-center leader-quarter"\x3e\r\n      \x3cspan class\x3d"js-owner-thumbnail"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"flex-1"\x3e${item.owner}\x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n\x3c/p\x3e',
"url:arcgisonline/pages/item/widgets/templates/_overview.html":'\x3cmain class\x3d"grid-container leader-1 item-pane-container" id\x3d"main-content-area"\x3e\r\n  \x3cdiv class\x3d"js-item-pane item-pane item-pane--active"\x3e\r\n    \x3cdiv class\x3d"column-17 post-1 rtl-post-0"\x3e\r\n      \x3ccalcite-notice class\x3d"js-empty-layer-notice trailer-1" dismissible\x3e\r\n          \x3cdiv slot\x3d"title"\x3e${i18n.itemProperties.emptyLayerTitle}\x3c/div\x3e\r\n          \x3cdiv slot\x3d"message"\x3e${i18n.itemProperties.emptyLayerDescription}\x3c/div\x3e\r\n      \x3c/calcite-notice\x3e\r\n      \x3cdiv class\x3d"column-17 if-can-update trailer-quarter"\x3e\r\n        \x3cbutton\r\n          id\x3d"thumbnail"\r\n          data-action\x3d"thumbnail"\r\n          data-edit-id\x3d"thumbnail"\r\n          class\x3d"js-action-editThumbnail js-edit-tags font-size--3 btn-link btn-link-darker-gray inline-block"\r\n        \x3e\r\n          ${icons.inline.edit.16}${i18n.itemProperties.editThumbnail}\r\n        \x3c/button\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"column-17 flex phone-flex-column first-column"\x3e\r\n        \x3cdiv class\x3d"thumbnail-wrap flex-0 padding-right-2 padding-left-0"\x3e\r\n          \x3cdiv class\x3d"flex-center"\x3e\r\n            \x3ca\r\n              data-action\x3d"openDefault"\r\n              href\x3d"${item:_formatMapViewerPrimaryLink}"\r\n              class\x3d"js-action-openDefault thumbnail-link flex-center js-status-disable"\r\n            \x3e\r\n              \x3cspan class\x3d"thumbnail-overlay if-defaultOpen"\x3e\r\n                \x3cspan class\x3d"js-thumbnail-overlay-text font-size--1 text-center thumbnail-icon"\r\n                  \x3e${i18n.common.open}\x3c/span\r\n                \x3e\r\n              \x3c/span\x3e\r\n              \x3cdiv\r\n                class\x3d"js-service-status loader js-sharing-loader overlay-white fullscreen padding-leader-1 padding-trailer-3"\r\n              \x3e\r\n                \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"loader-text"\x3e${i18n.itemProperties.creatingService}\x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cimg id\x3d"itemThumbnail" class\x3d"thumbnail-img js-thumbnail" src\x3d"${item.thumbnailUrl}" alt\x3d"" /\x3e\r\n            \x3c/a\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"if-signed-in"\x3e\r\n            \x3cbutton\r\n              data-action\x3d"toggleFavorite"\r\n              class\x3d"btn btn-wrap thumbnail-favorite link-darkest-gray js-action-toggle-favorite"\r\n              aria-live\x3d"polite"\r\n            \x3e\r\n              \x3cspan class\x3d"js-in-favorites screen-readers-only"\x3e${i18n.itemProperties.isFavorite}\x3c/span\x3e\r\n              \x3cspan class\x3d"js-favorite-text"\x3e${i18n.common.favorite}\x3c/span\x3e\r\n            \x3c/button\x3e\r\n          \x3c/div\x3e\r\n          \x3c!-- Check for ratio to show/hide this in _overview.js --\x3e\r\n          \x3cdiv\x3e\r\n            \x3cbutton\r\n              id\x3d"thumbnailAspectRatioTipButton"\r\n              data-action\x3d"thumbnail"\r\n              class\x3d"js-action-editThumbnail font-size--3 btn-link btn-link-darker-gray inline-block panel panel-white leader-half hide"\r\n            \x3e\r\n              ${icons.inline.lightbulb.24}\x3cbr /\x3e\r\n              \x3cspan id\x3d"thumbnailAspectRatioTip"\x3e ${i18n.itemProperties.thumbnailAspectRatioTip}\x3c/span\x3e\r\n            \x3c/button\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"phone-leader-1 ie9-summary-wrap snippet-wrap"\x3e\r\n          \x3cdiv class\x3d"js-snippet-section"\x3e\r\n            \x3c!-- Container for snippet InlineEdit --\x3e\r\n            \x3cp class\x3d"trailer-half break-word"\x3e\r\n              \x3cspan class\x3d"js-view if-snippet break-word"\x3e\x3c/span\x3e\r\n              \x3cspan class\x3d"if-no-snippet text-darker-gray trailer-half"\x3e\r\n                \x3cspan class\x3d"if-viewer"\x3e${i18n.itemProperties.summaryUnavailable}\x3c/span\x3e\r\n                \x3ca href\x3d"#" class\x3d"js-inline-edit if-can-update" data-edit-id\x3d"snippet"\r\n                  \x3e${i18n.itemProperties.noSummary}\x3c/a\r\n                \x3e\r\n              \x3c/span\x3e\r\n            \x3c/p\x3e\r\n            \x3cp class\x3d"js-premiumNode trailer-0 hide"\x3e\x3c/p\x3e\r\n            \x3cp class\x3d"js-collaboratedNode trailer-0 hide"\x3e\x3c/p\x3e\r\n            \x3cp class\x3d"trailer-half font-size--1 js-typeOwner-info"\x3e\r\n              \x3cspan alt\x3d"${item.sourceLabel}" title\x3d"${item.sourceLabel}"\x3e\r\n                \x3cimg\r\n                  class\x3d"icon-inline icon-inline--on-left"\r\n                  src\x3d"${item.svgIconUrl16}"\r\n                  width\x3d"16"\r\n                  height\x3d"16"\r\n                  alt\x3d""\r\n                /\x3e\r\n                \x3cspan\x3e${item.displayName}\x3c/span\x3e\r\n              \x3c/span\x3e\r\n              \x3cspan class\x3d"js-by-owner"\x3e${i18n.itemProperties.by}\x3c/span\x3e ${item.ownerText}\r\n            \x3c/p\x3e\r\n            \x3cp class\x3d"font-size--2 trailer-half leader-quarter text-darkest-gray"\x3e\r\n              \x3cspan\r\n                class\x3d"inline-block margin-right-1 margin-left-0"\r\n                title\x3d"${i18n.contentPage.createdLabel} ${item.created:completeDate}"\r\n                \x3e${i18n.contentPage.created} ${item.created:fullDate}\x3c/span\r\n              \x3e\r\n              \x3cspan\r\n                class\x3d"inline-block margin-right-1 margin-left-0"\r\n                title\x3d"${i18n.itemProperties.lastModified} ${item.modified:completeDate}"\r\n                \x3e${i18n.contentPage.modified} ${item.modified:fullDate}\x3c/span\r\n              \x3e\r\n              \x3cspan class\x3d"inline-block margin-right-1 margin-left-0"\r\n                \x3e${item:formatViewsLabel} ${item.numViews:formatNumViews}\x3c/span\r\n              \x3e\r\n            \x3c/p\x3e\r\n            \x3cp class\x3d"js-last-snapshot trailer-0 font-size--2 hide"\x3e\r\n              ${i18n.itemProperties.snapshot.last} \x3cspan class\x3d"js-last-snapshot-value"\x3e\x3c/span\x3e\r\n            \x3c/p\x3e\r\n            \x3cp class\x3d"flex js-item-badges"\x3e${item.badges}\x3c/p\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3caside class\x3d"column-6 right tablet-column-12 tablet-left trailer-2"\x3e\r\n      \x3cdiv class\x3d"column-6 tablet-column-6 tablet-leader-2 tablet-left"\x3e\r\n        \x3c!-- use item-type classes to show and hide actions --\x3e\r\n        \x3c!-- Primary Item Actions --\x3e\r\n        \x3cdiv class\x3d"if-featureCollection if-vectorTile if-2d if-table"\x3e\r\n          \x3cdiv class\x3d"dropdown js-dropdown trailer-half display-block js-status-disable"\x3e\r\n            \x3cdiv class\x3d"flex clearfix"\x3e\r\n              \x3ca\r\n                class\x3d"btn btn-split btn-wrap flex-1 text-center text-ellipsis js-open-mapViewer js-open-btn js-action-newWebMapViewer"\r\n                href\x3d"${item:_formatMapViewerPrimaryLink}"\r\n                data-href\x3d"${item:_formatMapViewerPrimaryLink}"\r\n                data-action\x3d"newMapViewer"\r\n                \x3e${item:_formatMapViewerPrimaryLabel}\x3c/a\r\n              \x3e\r\n              \x3cbutton\r\n                class\x3d"btn btn-split-right inline-block btn-split js-dropdown-toggle js-map-open-more-dropdown"\r\n                aria-label\x3d"${i18n.itemProperties.openMenu}"\r\n              \x3e\r\n                ${icons.chevron-down.16}\r\n              \x3c/button\x3e\r\n            \x3c/div\x3e\r\n            \x3cnav class\x3d"dropdown-menu dropdown-menu-constrained dropdown-menu-full dropdown-right"\x3e\r\n              \x3cdiv class\x3d"if-map-viewer-classic"\x3e\r\n                \x3cdiv class\x3d"if-map-viewer-beta"\x3e\r\n                  \x3ca\r\n                    role\x3d"menuitem"\r\n                    href\x3d"${item.newMapViewerUrl:empty}"\r\n                    class\x3d"dropdown-link if-can-openInNewMapViewer"\r\n                    \x3e${i18n.itemLinks.openMapViewerBetaLabel}\x3c/a\r\n                  \x3e\r\n                \x3c/div\x3e\r\n                \x3ca\r\n                  role\x3d"menuitem"\r\n                  href\x3d"${item.mapNewViewerUrl:empty}"\r\n                  data-href\x3d"${item.mapNewViewerUrl:empty}"\r\n                  class\x3d"dropdown-link if-featureCollection if-vectorTile if-2d if-table js-action"\r\n                  data-action\x3d"newMapViewer"\r\n                  \x3e${i18n.itemLinks.addToNewViewer}\x3c/a\r\n                \x3e\r\n                \x3ca\r\n                  role\x3d"menuitem"\r\n                  href\x3d"${item.mapViewerWithEditUrl:empty}"\r\n                  data-href\x3d"${item.mapViewerWithEditUrl:empty}"\r\n                  class\x3d"dropdown-link if-can-edit-service js-action"\r\n                  data-action\x3d"newMapViewer"\r\n                  \x3e${i18n.itemProperties.openViewerFullEditingRole}\x3c/a\r\n                \x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"if-map-viewer-modern"\x3e\r\n                \x3cspan class\x3d"if-can-openInNewMapViewer"\x3e\r\n                  \x3ca\r\n                    role\x3d"menuitem"\r\n                    href\x3d"${item.mapViewerUrl:empty}"\r\n                    data-href\x3d"${item.mapViewerUrl:empty}"\r\n                    class\x3d"dropdown-link if-map if-featureCollection if-vectorTile if-2d if-table js-action"\r\n                    data-action\x3d"newMapViewer"\r\n                    \x3e${i18n.itemLinks.openMapViewer}\x3c/a\r\n                  \x3e\r\n                \x3c/span\x3e\r\n                \x3ca\r\n                  role\x3d"menuitem"\r\n                  href\x3d"${item.mapViewerWithEditUrl:empty}"\r\n                  data-href\x3d"${item.mapViewerWithEditUrl:empty}"\r\n                  class\x3d"dropdown-link if-can-edit-service js-action btn-wrap"\r\n                  data-action\x3d"newMapViewer"\r\n                  \x3e${i18n.itemLinks.openMapViewerWithControl}\x3c/a\r\n                \x3e\r\n              \x3c/div\x3e\r\n            \x3c/nav\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"if-route-layer navigator-button-mobile hide"\x3e\r\n          \x3ca href\x3d"${item.navigatorUrl}" class\x3d"text-ellipsis trailer-half btn btn-fill btn-wrap"\r\n            \x3e${i18n.itemLinks.openNavigator}\x3c/a\r\n          \x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"if-map"\x3e\r\n          \x3c!-- Keep single button if map viewer beta disabled --\x3e\r\n          \x3cdiv class\x3d"if-no-map-viewer-beta"\x3e\r\n            \x3ca\r\n              href\x3d"${item.mapViewerUrl}"\r\n              class\x3d"text-ellipsis trailer-half btn btn-fill if-map js-open-mapViewer js-open-btn js-action-newWebMapViewer"\r\n              href\x3d"${item.mapViewerUrl}"\r\n              data-href\x3d"${item.mapViewerUrl}"\r\n              data-action\x3d"newMapViewer"\r\n              \x3e${i18n.itemLinks.openMapViewer}\x3c/a\r\n            \x3e\r\n          \x3c/div\x3e\r\n          \x3c!-- Otherwise, enable dropdown for web maps to load in map viewer or map viewer beta --\x3e\r\n          \x3cdiv class\x3d"if-map-viewer-beta"\x3e\r\n            \x3cdiv class\x3d"dropdown js-dropdown trailer-half display-block js-status-disable"\x3e\r\n              \x3cdiv class\x3d"flex clearfix"\x3e\r\n                \x3ca\r\n                  class\x3d"btn btn-split btn-wrap flex-1 text-center text-ellipsis js-open-mapViewer js-open-btn js-action-newWebMapViewer"\r\n                  href\x3d"${item:_formatMapViewerPrimaryLink}"\r\n                  data-href\x3d"${item:_formatMapViewerPrimaryLink}"\r\n                  data-action\x3d"newMapViewer"\r\n                  \x3e${item:_formatMapViewerPrimaryLabel}\x3c/a\r\n                \x3e\r\n                \x3cbutton\r\n                  class\x3d"btn btn-split-right inline-block btn-split js-dropdown-toggle"\r\n                  aria-label\x3d"${i18n.itemProperties.openMenu}"\r\n                \x3e\r\n                  ${icons.chevron-down.16}\r\n                \x3c/button\x3e\r\n              \x3c/div\x3e\r\n              \x3cnav class\x3d"dropdown-menu dropdown-menu-full dropdown-right"\x3e\r\n                \x3c!-- \x3ca href\x3d"${item.mapNewViewerUrl}" data-href\x3d"${item.mapNewViewerUrl}" data-action\x3d"newMapViewer" class\x3d"dropdown-link test-ellipsis js-action-newWebMapViewer add-to-new-viewer"\x3e${i18n.itemLinks.addToNewViewer}\x3c/a\x3e --\x3e\r\n                \x3ca href\x3d"${item:_formatMapViewerSecondaryLink}" class\x3d"dropdown-link if-map-viewer-beta"\r\n                  \x3e${item:_formatMapViewerSecondaryLabel}\x3c/a\r\n                \x3e\r\n              \x3c/nav\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3ca\r\n          href\x3d"${item.sceneViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-wrap if-scene if-3d js-open-sceneViewer js-status-disable js-open-btn"\r\n          \x3e${i18n.itemLinks.openSceneViewer}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.url:sanitizeUrl}"\r\n          target\x3d"_blank"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-app js-open-url js-open-btn js-view-btn"\r\n          \x3e${i18n.itemLinks.viewApp}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.appViewerUrl:sanitizeUrl}"\r\n          target\x3d"_blank"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-mobile js-open-url js-open-btn"\r\n          \x3e${i18n.itemLinks.getApp}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.appViewerUrl:sanitizeUrl}"\r\n          target\x3d"_blank"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-link js-open-url js-open-btn"\r\n          \x3e${i18n.itemLinks.open}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.workforceViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-workforceProject-and-not-blocked js-open-workforceViewer js-open-btn"\r\n          \x3e${i18n.itemLinks.openWorkforce}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.workflowViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-workflow js-open-workflowViewer js-open-btn"\r\n          \x3e${i18n.itemLinks.openWorkflow}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.excaliburViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-excaliburProject js-open-excaliburViewer js-open-btn"\r\n          \x3e${i18n.itemLinks.openExcalibur}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.excaliburProjectUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-excaliburProject js-open-excaliburViewer"\r\n          \x3e${i18n.itemLinks.viewExcaliburProject}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.excaliburMediaUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-excaliburMedia js-open-excaliburViewer js-open-btn"\r\n          \x3e${i18n.itemLinks.openExcalibur}\x3c/a\r\n        \x3e\r\n        \x3cdiv class\x3d"if-notebookServer-enabled"\x3e\r\n          \x3cdiv class\x3d"if-can-create-notebooks"\x3e\r\n            \x3ca\r\n              href\x3d"${item.notebookViewerUrl}"\r\n              target\x3d"_blank"\r\n              class\x3d"text-ellipsis trailer-half btn btn-fill if-notebook js-open-url js-open-btn js-open-notebook"\r\n              \x3e${i18n.itemLinks.openNotebook}\x3c/a\r\n            \x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-surveyForm-and-not-blocked"\x3e\r\n          \x3cbutton class\x3d"btn btn-fill btn-clear btn-wrap js-dropdown-toggle js-open-btn"\x3e\r\n            ${i18n.itemLinks.openSurvey123}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cnav class\x3d"dropdown-menu dropdown-menu-full dropdown-right"\x3e\r\n            \x3ca href\x3d"${item.surveyViewerUrl}" class\x3d"dropdown-link js-open-surveyViewer if-online"\r\n              \x3e${i18n.itemLinks.openSurveyBrowser}\x3c/a\r\n            \x3e\r\n            \x3ca href\x3d"${item.surveyAppUrl}" class\x3d"dropdown-link js-open-surveyViewer"\r\n              \x3e${i18n.itemLinks.openSurveyApp}\x3c/a\r\n            \x3e\r\n            \x3ca href\x3d"${item.surveyManageUrl}" class\x3d"dropdown-link if-can-edit-surveyForm js-open-surveyViewer"\r\n              \x3e${i18n.itemLinks.manageSurveyApp}\x3c/a\r\n            \x3e\r\n            \x3ca href\x3d"${item.surveyEditUrl}" class\x3d"dropdown-link if-can-edit-surveyForm js-open-surveyViewer"\r\n              \x3e${i18n.itemLinks.editSurveyApp}\x3c/a\r\n            \x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Web Experience Actions --\x3e\r\n        \x3ca\r\n          href\x3d"${item.webExperienceUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-published-webExperience-and-not-blocked js-open-webExperienceViewer js-open-btn"\r\n          target\x3d"_blank"\r\n          rel\x3d"noopener noreferrer"\r\n          \x3e${i18n.itemLinks.view}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.webExperienceEditUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-can-edit-webExperience-and-not-blocked js-open-btn"\r\n          \x3e${i18n.common.edit}\x3c/a\r\n        \x3e\r\n\r\n        \x3c!-- Web Experience Template Actions --\x3e\r\n        \x3ca\r\n          href\x3d"${item.webExperienceUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-published-webExperienceTemplate-and-not-blocked js-open-webExperienceViewer js-open-btn"\r\n          \x3e${i18n.itemLinks.view}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.webExperienceEditUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-can-edit-webExperienceTemplate js-open-btn"\r\n          \x3e${i18n.common.edit}\x3c/a\r\n        \x3e\r\n        \x3cspan class\x3d"if-published-webExperienceTemplate-and-not-blocked"\x3e\r\n          \x3ca\r\n            href\x3d"${item.webExperienceCreateUrl}"\r\n            class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-can-create-webExperienceTemplate if-no-public-user js-open-btn"\r\n            \x3e${i18n.itemLinks.createWebExperience}\x3c/a\r\n          \x3e\r\n        \x3c/span\x3e\r\n\r\n        \x3ca\r\n          href\x3d"${item.insightsViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-insights-and-not-blocked js-open-insightsViewer js-open-btn"\r\n          \x3e${i18n.itemLinks.openInsights}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.urbanViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-urbanModel js-open-urbanViewer js-open-btn"\r\n          \x3e${i18n.itemLinks.openUrbanModel}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.orthoMakerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-orthoMaker js-open-orthoMaker js-open-btn"\r\n          \x3e${i18n.itemLinks.openOrthoMaker}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.missionViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-mission js-open-missionViewer js-open-btn"\r\n          \x3e${i18n.itemLinks.openMission}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.geoAIStudioUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-geoAIStudioProject js-open-geoAIStudioUrlViewer js-open-btn"\r\n          \x3e${i18n.itemLinks.openGeoAIStudio}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.vrExperienceUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-vrExperience-and-not-blocked js-open-vrExperienceViewer js-hide-portal js-open-btn"\r\n          \x3e${i18n.itemLinks.openVRExperience}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.hubInitiativeUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear btn-wrap if-hubInitiative-and-not-blocked js-open-hubInitiative js-status-disable js-open-btn"\r\n          \x3e${i18n.itemLinks.openHubInitiative}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.hubEventUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-hubEvent-and-not-blocked js-open-hubEventViewer js-open-btn"\r\n          \x3e${i18n.itemLinks.viewInHub}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.hubProjectUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-hubProject-and-not-blocked js-open-hubProject js-open-btn"\r\n          \x3e${i18n.itemLinks.openHubInitiative}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.hubProjectEditUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-hubProject-and-not-blocked js-edit-hubProject js-open-btn"\r\n          \x3e${i18n.itemLinks.editHubProject}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.iotViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-bigDataAnalytic if-realTimeAnalytic js-open-iotViewer js-open-btn"\r\n          \x3e${i18n.itemLinks.openAnalyticsIoT}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.cityEngineViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-city-engine js-open-cityEngineViewer js-open-btn"\r\n          \x3e${i18n.itemLinks.viewApp}\x3c/a\r\n        \x3e\r\n        \x3cbutton\r\n          data-action\x3d"download"\r\n          target\x3d"_blank"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-pdf js-action-download js-open-btn"\r\n        \x3e\r\n          ${i18n.itemLinks.open}\r\n        \x3c/button\x3e\r\n        \x3ca\r\n          href\x3d"${item.dashboardUrl}"\r\n          target\x3d"_blank"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-wrap if-dashboard-and-not-blocked js-open-dashboard js-open-btn"\r\n          \x3e${i18n.itemLinks.dashboardView}\x3c/a\r\n        \x3e\r\n        \x3cbutton\r\n          data-action\x3d"registerApp"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-can-register js-action-register-app js-open-btn"\r\n        \x3e\r\n          ${i18n.itemProperties.registerApp}\r\n        \x3c/button\x3e\r\n        \x3ca\r\n          href\x3d"${item.storyMapViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-published-storymap-and-not-blocked js-open-btn"\r\n        \x3e\r\n          \x3cspan class\x3d"if-storymap-item"\x3e${i18n.itemLinks.viewStorymap}\x3c/span\x3e\r\n          \x3cspan class\x3d"if-storymap-collection"\x3e${i18n.itemLinks.viewStorymapCollection}\x3c/span\x3e\r\n        \x3c/a\x3e\r\n\r\n        \x3cdiv class\x3d"if-geoBIM"\x3e\r\n          \x3ca\r\n            href\x3d"${item.geoBIMUrl}"\r\n            class\x3d"text-ellipsis trailer-half btn btn-fill if-create-geoBIM js-open-btn js-open-geoBIM"\r\n            \x3e${i18n.itemLinks.openGeoBIM}\x3c/a\r\n          \x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Secondary Item Actions --\x3e\r\n        \x3ca\r\n          href\x3d"${item.wabEditUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-can-edit-wab-and-not-blocked js-open-wabEdit js-open-btn"\r\n          \x3e${i18n.itemLinks.editApp}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.dashboardEditUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear btn-wrap if-can-edit-dashboard js-open-dashboard js-open-btn"\r\n          \x3e${i18n.itemLinks.dashboardEdit}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.sceneViewerUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear btn-wrap if-scene-2 js-open-sceneViewer js-status-disable js-open-btn"\r\n          \x3e${i18n.itemLinks.openSceneViewer}\x3c/a\r\n        \x3e\r\n\r\n        \x3ca\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-can-edit-rfx-editor js-open-rfxEditor js-open-btn"\r\n          \x3e${i18n.itemLinks.openRFxEditor}\x3c/a\r\n        \x3e\r\n\r\n        \x3cbutton\r\n          data-action\x3d"openDesktop"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-desktop js-action-open-desktop js-status-disable js-open-btn"\r\n        \x3e\r\n          ${i18n.itemLinks.openDesktop}\r\n        \x3c/button\x3e\r\n        \x3cbutton\r\n          data-action\x3d"openPro"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-pro js-action-open-pro js-status-disable js-open-btn"\r\n        \x3e\r\n          ${i18n.itemLinks.openPro}\r\n        \x3c/button\x3e\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-desktopPro btn-fill"\x3e\r\n          \x3cbutton class\x3d"btn btn-fill btn-clear btn-wrap js-dropdown-toggle js-open-btn js-status-disable" tabindex\x3d"0"\x3e\r\n            ${i18n.itemLinks.openDesktop}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cnav data-action\x3d"openDesktop" class\x3d"dropdown-menu dropdown-right js-action-open-desktop"\x3e\r\n            \x3cbutton data-type\x3d"arcmap" class\x3d"dropdown-link if-no-tiled-imagery"\x3e${i18n.itemLinks.openArcMap}\x3c/button\x3e\r\n            \x3cbutton data-type\x3d"pro" class\x3d"dropdown-link"\x3e${i18n.itemLinks.openPro}\x3c/button\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3ca\r\n          href\x3d"${item.configureStoryMapUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-editable-storymap-and-not-blocked js-configure-storymap"\r\n        \x3e\r\n          \x3cspan class\x3d"if-storymap-item"\x3e${i18n.itemLinks.editStorymap}\x3c/span\x3e\r\n          \x3cspan class\x3d"if-storymap-collection"\x3e${i18n.itemLinks.editStorymapCollection}\x3c/span\x3e\r\n        \x3c/a\x3e\r\n\r\n        \x3cbutton\r\n          data-action\x3d"download"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-explorer js-action-download js-open-btn"\r\n        \x3e\r\n          ${i18n.itemLinks.openExplorer}\r\n        \x3c/button\x3e\r\n        \x3cbutton\r\n          data-action\x3d"download"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-file if-download js-action-download js-open-btn"\r\n        \x3e\r\n          ${i18n.itemLinks.download}\r\n        \x3c/button\x3e\r\n        \x3cbutton\r\n          data-action\x3d"publishService"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-can-publish if-publish js-action-publish js-open-btn"\r\n        \x3e\r\n          ${i18n.itemProperties.publishItem}\r\n        \x3c/button\x3e\r\n        \x3c!-- TODO-JOSH9445: Re-enable post 10.7 --\x3e\r\n        \x3c!-- \x3cdiv class\x3d"if-notebookServer-enabled"\x3e\r\n                \x3cspan class\x3d"if-notebook"\x3e\r\n                    \x3cbutton data-action\x3d"publishService" class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-can-publish-notebooks js-action-publish js-open-btn"\x3e${i18n.itemProperties.publishItem}\x3c/button\x3e\r\n                \x3c/span\x3e\r\n            \x3c/div\x3e --\x3e\r\n        \x3ca\r\n          href\x3d"${item.iotFeedUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-feedLayer js-open-iotFeed js-open-btn"\r\n          \x3e${i18n.itemLinks.openAnalyticsIoT}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.createPresentationUrl}"\r\n          class\x3d"js-if-not-readonly text-ellipsis trailer-half btn btn-fill if-no-presentation if-map btn-clear js-open-createPresentation js-open-btn"\r\n          \x3e${i18n.siteHeader.createPresentation}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.openPresentationUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill if-presentation btn-clear js-open-openPresentation js-open-btn"\r\n          \x3e${i18n.siteHeader.viewPresentation}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.createPresentationUrl}"\r\n          class\x3d"js-if-not-readonly text-ellipsis trailer-half btn btn-fill if-create-presentation btn-clear js-open-editPresentation"\r\n          \x3e${i18n.siteHeader.editPresentation}\x3c/a\r\n        \x3e\r\n        \x3cbutton\r\n          id\x3d"create-app-dropdown"\r\n          data-type\x3d"template"\r\n          data-action\x3d"createApp"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-hostedTemplate js-action-createApp"\r\n        \x3e\r\n          ${i18n.itemProperties.create}\r\n        \x3c/button\x3e\r\n        \x3ca href\x3d"${item.fieldMapsUrl}" class\x3d"text-ellipsis trailer-half btn btn-fill if-fieldMaps btn-clear"\r\n          \x3e${i18n.itemLinks.fieldMaps}\x3c/a\r\n        \x3e\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-can-create-app if-licensed phone-hide"\x3e\r\n          \x3cbutton\r\n            class\x3d"js-if-not-readonly btn btn-fill btn-clear btn-wrap js-dropdown-toggle js-open-btn"\r\n            tabindex\x3d"0"\r\n          \x3e\r\n            ${i18n.items.createApp}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cdiv\r\n            data-action\x3d"createApp"\r\n            class\x3d"dropdown-menu dropdown-menu-add-create__container dropdown-menu-add-create__overview can-createApp js-action-createApp"\r\n            role\x3d"menu"\r\n          \x3e\r\n            \x3cnav class\x3d"dropdown-menu-add-create dropdown-menu-add-create__column"\x3e\r\n              \x3ca\r\n                href\x3d"${item.instantAppsUrl}"\r\n                class\x3d"dropdown-link-add-create trailer-half if-map if-scene"\r\n                role\x3d"menuitem"\r\n                target\x3d"_blank"\r\n              \x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\x3e${productGlyphs.instant}\x3c/span\x3e\r\n                \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__title font-size-0"\x3e\r\n                    ${i18n.items.instantApps}\r\n                    \x3cspan class\x3d"dropdown-link-add-create__title--hover margin-left-quarter"\x3e\r\n                      \x3ccalcite-icon class\x3d"dropdown-link-add-create__title--hover margin-left-quarter margin-auto-vertical" icon\x3d"launch" scale\x3d"s" aria-hidden\x3d"true"\x3e\x3c/calcite-icon\x3e\r\n                    \x3c/span\x3e\r\n                  \x3c/span\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                    ${i18n.items.instantAppsDescription}\r\n                  \x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/a\x3e\r\n              \x3cbutton\r\n                id\x3d"create-wab"\r\n                data-type\x3d"wab"\r\n                class\x3d"dropdown-link-add-create if-wab-enabled-and-not-blocked trailer-half"\r\n                role\x3d"menuitem"\r\n              \x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\x3e${productGlyphs.webAppBuilder}\x3c/span\x3e\r\n                \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__title font-size-0"\x3e\r\n                    ${i18n.items.webAppBuilder}\r\n                    \x3cspan class\x3d"dropdown-link-add-create__title--hover margin-left-quarter"\x3e\r\n                      \x3ccalcite-icon class\x3d"dropdown-link-add-create__title--hover margin-left-quarter margin-auto-vertical" icon\x3d"arrowRight" scale\x3d"s" aria-hidden\x3d"true" flip-rtl\x3e\x3c/calcite-icon\x3e\r\n                    \x3c/span\x3e\r\n                  \x3c/span\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                    ${i18n.items.webAppBuilderDescription}\r\n                  \x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/button\x3e\r\n              \x3cbutton\r\n                id\x3d"create-storymaps"\r\n                data-type\x3d"storymap"\r\n                class\x3d"dropdown-link-add-create trailer-half if-storymap-not-blocked"\r\n                role\x3d"menuitem"\r\n              \x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\x3e${productGlyphs.storyMaps}\x3c/span\x3e\r\n                \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__title font-size-0"\x3e\r\n                    ${i18n.items.storyMap}\r\n                    \x3cspan class\x3d"dropdown-link-add-create__title--hover margin-left-quarter"\x3e\r\n                      \x3ccalcite-icon class\x3d"dropdown-link-add-create__title--hover margin-left-quarter margin-auto-vertical" icon\x3d"launch" scale\x3d"s" aria-hidden\x3d"true"\x3e\x3c/calcite-icon\x3e\r\n                    \x3c/span\x3e\r\n                  \x3c/span\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                    ${i18n.items.storyMapDescription}\r\n                  \x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/button\x3e\r\n              \x3ca\r\n                class\x3d"dropdown-link-add-create if-createDashboardFromItem-and-not-blocked trailer-half"\r\n                href\x3d"${item.createDashboardUrl}"\r\n                target\x3d"_blank"\r\n              \x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\x3e${productGlyphs.dashboard}\x3c/span\x3e\r\n                \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__title font-size-0"\x3e\r\n                    ${i18n.items.dashboard}\r\n                    \x3cspan class\x3d"dropdown-link-add-create__title--hover margin-left-quarter"\x3e\r\n                      \x3ccalcite-icon class\x3d"dropdown-link-add-create__title--hover margin-left-quarter margin-auto-vertical" icon\x3d"launch" scale\x3d"s" aria-hidden\x3d"true"\x3e\x3c/calcite-icon\x3e\r\n                    \x3c/span\x3e\r\n                  \x3c/span\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                    ${i18n.items.dashboardDescription}\r\n                  \x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/a\x3e\r\n              \x3ca\r\n                href\x3d"${item.experienceBuilderUrl}"\r\n                data-label\x3d"exb"\r\n                class\x3d"dropdown-link-add-create if-webExperience-enabled-and-not-blocked trailer-half"\r\n                role\x3d"menuitem"\r\n                target\x3d"_blank"\r\n              \x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\x3e${productGlyphs.experienceBuilder}\x3c/span\x3e\r\n                \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__title font-size-0"\x3e\r\n                    Experience Builder\r\n                    \x3cspan class\x3d"dropdown-link-add-create__title--hover margin-left-quarter"\x3e\r\n                      \x3ccalcite-icon class\x3d"dropdown-link-add-create__title--hover margin-left-quarter margin-auto-vertical" icon\x3d"launch" scale\x3d"s" aria-hidden\x3d"true"\x3e\x3c/calcite-icon\x3e\r\n                    \x3c/span\x3e\r\n                  \x3c/span\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                    ${i18n.items.experienceBuilderDescription}\r\n                  \x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/a\x3e\r\n              \x3cbutton\r\n                id\x3d"create-template"\r\n                data-type\x3d"template"\r\n                class\x3d"dropdown-link-add-create trailer-half"\r\n                role\x3d"menuitem"\r\n              \x3e\r\n                \x3cspan class\x3d"dropdown-link-add-create__thumbnail"\x3e${productGlyphs.online}\x3c/span\x3e\r\n                \x3cdiv class\x3d"dropdown-link-add-create__content margin-left-half"\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__title font-size-0"\x3e\r\n                    ${i18n.items.configurableApp}\x3ccalcite-icon class\x3d"dropdown-link-add-create__title--hover margin-left-quarter margin-auto-vertical" icon\x3d"arrowRight" scale\x3d"m" aria-hidden\x3d"true" flip-rtl\x3e\x3c/calcite-icon\x3e\r\n                  \x3c/span\x3e\r\n                  \x3cspan class\x3d"dropdown-link-add-create__description font-size--3"\x3e\r\n                    ${i18n.items.configurableAppDescription}\r\n                  \x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/button\x3e\r\n            \x3c/nav\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"if-can-update"\x3e\r\n          \x3ca\r\n            href\x3d"${item.configureUrl}"\r\n            class\x3d"js-if-not-readonly text-ellipsis trailer-half btn btn-fill btn-clear if-can-configure js-action-configure js-open-btn js-configure-btn"\r\n            \x3e${i18n.itemProperties.configureApp}\x3c/a\r\n          \x3e\r\n        \x3c/div\x3e\r\n        \x3ca\r\n          href\x3d"${item.viewStyleUrl}"\r\n          target\x3d"_blank"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-vectorTile if-viewStyle js-open-viewStyle js-open-btn js-status-disable"\r\n          \x3e${i18n.itemLinks.viewStyle}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.downloadStyleUrl}"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-resources js-open-downloadStyle js-open-btn js-status-disable"\r\n          \x3e${i18n.itemLinks.downloadStyle}\x3c/a\r\n        \x3e\r\n        \x3ca\r\n          href\x3d"${item.downloadAttachmentUrl}"\r\n          target\x3d"_blank"\r\n          class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-codeAttachment js-open-downloadAttachment js-open-btn"\r\n          \x3e${i18n.itemLinks.download}\x3c/a\r\n        \x3e\r\n        \x3cdiv\r\n          class\x3d"dropdown js-dropdown trailer-half if-not-velocity if-can-publish-tiles if-can-publish-vectorTiles if-can-publish-wfs if-can-publish-ogcfeatures if-can-publish-scenes"\r\n        \x3e\r\n          \x3cbutton\r\n            class\x3d"js-if-not-readonly btn btn-fill btn-clear js-dropdown-toggle js-open-btn text-ellipsis"\r\n            tabindex\x3d"0"\r\n          \x3e\r\n            ${i18n.itemProperties.publishItem}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cnav data-action\x3d"publishTiles" class\x3d"dropdown-menu dropdown-right can-publish-tiles js-action-publish"\x3e\r\n            \x3cbutton data-type\x3d"tiles" class\x3d"dropdown-link if-can-publish-tiles if-no-spatiotemporal"\x3e\r\n              ${i18n.itemProperties.publishTileLayer}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"vectorTiles" class\x3d"dropdown-link if-can-publish-vectorTiles if-no-spatiotemporal"\x3e\r\n              ${i18n.itemProperties.publishVectorTileLayer}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"wfs" class\x3d"dropdown-link if-can-publish-wfs if-no-spatiotemporal"\x3e\r\n              ${i18n.itemProperties.publishWFSLayer}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"ogcfeatures" class\x3d"dropdown-link if-can-publish-ogcfeatures if-no-spatiotemporal"\x3e\r\n              ${i18n.itemProperties.publishOGCFeatureLayer}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"scenes" class\x3d"dropdown-link if-can-publish-scenes"\x3e\r\n              ${i18n.itemProperties.publishSceneLayer}\r\n            \x3c/button\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-can-publish-imagery-tiles if-can-publish-imagery-dynamic"\x3e\r\n          \x3cbutton\r\n            class\x3d"js-if-not-readonly btn btn-fill btn-clear js-dropdown-toggle js-open-btn text-ellipsis"\r\n            tabindex\x3d"0"\r\n          \x3e\r\n            ${i18n.itemProperties.publishItem}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cnav data-action\x3d"publishImagery" class\x3d"dropdown-menu dropdown-right js-action-publish"\x3e\r\n            \x3cbutton data-type\x3d"tiledImagery" class\x3d"dropdown-link if-can-publish-imagery-tiles"\x3e\r\n              ${i18n.addLayerFromUrlDlg.tiledImagery}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"dynamicImagery" class\x3d"dropdown-link if-can-publish-imagery-dynamic"\x3e\r\n              ${i18n.addLayerFromUrlDlg.dynamicImageryFull}\r\n            \x3c/button\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n        \x3cbutton\r\n          data-action\x3d"publishTiles"\r\n          data-type\x3d"features"\r\n          class\x3d"trailer-half btn btn-fill btn-wrap text-ellipsis btn-clear if-can-publish-views if-not-velocity js-open js-action-publish"\r\n        \x3e\r\n          ${i18n.itemProperties.publishViewLayer}\r\n        \x3c/button\x3e\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-not-velocity if-can-export if-no-spatiotemporal"\x3e\r\n          \x3cbutton\r\n            class\x3d"js-if-not-readonly btn btn-fill btn-clear js-dropdown-toggle js-open-btn text-ellipsis"\r\n            tabindex\x3d"0"\r\n          \x3e\r\n            ${i18n.itemProperties.exportLabel}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cnav data-action\x3d"exportData" class\x3d"dropdown-menu dropdown-right can-export js-action-exportData"\x3e\r\n            \x3cbutton data-type\x3d"Shapefile" class\x3d"dropdown-link if-no-multipatch"\x3e\r\n              ${i18n.itemProperties.exportToShapefile}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"CSV" class\x3d"dropdown-link if-no-multipatch"\x3e\r\n              ${i18n.itemProperties.exportToCSVFile}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"KML" class\x3d"dropdown-link js-hide-portal if-no-multipatch if-no-location-tracking"\x3e\r\n              ${i18n.itemProperties.exportToKML}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"Excel" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking"\x3e\r\n              ${i18n.itemProperties.exportToExcel}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"File Geodatabase" class\x3d"dropdown-link if-no-location-tracking"\x3e\r\n              ${i18n.itemProperties.exportToFgdb}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"GeoJson" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking"\x3e\r\n              ${i18n.itemProperties.exportToGeoJson}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"Feature Collection" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking"\x3e\r\n              ${i18n.itemProperties.exportToFeatureCollection}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"GeoPackage" class\x3d"dropdown-link if-no-multipatch if-no-location-tracking"\x3e\r\n              ${i18n.itemProperties.exportToGeoPackage}\r\n            \x3c/button\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-can-export-imagery"\x3e\r\n          \x3cbutton\r\n            class\x3d"js-if-not-readonly btn btn-fill btn-clear js-dropdown-toggle js-open-btn text-ellipsis"\r\n            tabindex\x3d"0"\r\n          \x3e\r\n            ${i18n.itemProperties.exportLabel}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cnav data-action\x3d"exportImagery" class\x3d"dropdown-menu dropdown-right can-export-imagery js-action-exportImagery"\x3e\r\n            \x3cbutton data-type\x3d"Tile Package" class\x3d"dropdown-link"\x3e\r\n              ${i18n.itemProperties.exportToTilePackage}\r\n            \x3c/button\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cbutton\r\n          data-action\x3d"updateData"\r\n          class\x3d"trailer-half btn btn-fill if-update text-ellipsis btn-clear js-action-updateData js-open-btn"\r\n        \x3e\r\n          ${i18n.common.update}\r\n        \x3c/button\x3e\r\n\r\n        \x3cdiv class\x3d"dropdown js-dropdown trailer-half if-overwrite if-overwriteCloud if-can-appendData"\x3e\r\n          \x3cbutton\r\n            class\x3d"js-if-not-readonly btn btn-fill btn-clear js-dropdown-toggle js-open-btn text-ellipsis"\r\n            tabindex\x3d"0"\r\n          \x3e\r\n            ${i18n.itemProperties.updateData}${icons.inline-end.chevron-down.16}\r\n          \x3c/button\x3e\r\n          \x3cnav data-action\x3d"updateData" class\x3d"dropdown-menu dropdown-right can-export js-action-updateData"\x3e\r\n            \x3cbutton data-type\x3d"overwrite" class\x3d"dropdown-link if-overwrite"\x3e\r\n              ${i18n.appendDataDlg.overwriteLayer}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"overwriteFromCloud" class\x3d"dropdown-link if-overwriteCloud"\x3e\r\n              ${i18n.appendDataDlg.overwriteLayer}\r\n            \x3c/button\x3e\r\n            \x3cbutton data-type\x3d"append" class\x3d"dropdown-link if-can-appendData"\x3e\r\n              ${i18n.itemProperties.appendData}\r\n            \x3c/button\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cbutton\r\n          data-action\x3d"refreshSnapshot"\r\n          class\x3d"trailer-half btn btn-fill if-uses-snapshot text-ellipsis btn-clear js-action-refreshSnapshot"\r\n        \x3e\r\n          ${i18n.itemProperties.snapshot.refresh}\r\n        \x3c/button\x3e\r\n\r\n        \x3cdiv class\x3d"if-published-storymap-theme"\x3e\r\n          \x3cdiv class\x3d"dropdown js-dropdown trailer-half display-block"\x3e\r\n            \x3cdiv class\x3d"flex clearfix"\x3e\r\n              \x3ca\r\n                class\x3d"btn btn-split btn-wrap flex-1 text-center text-ellipsis js-open-btn"\r\n                href\x3d"${item.newStoryMapFromThemeUrl}"\r\n              \x3e\r\n                ${i18n.itemLinks.newStoryFromTheme}\r\n              \x3c/a\x3e\r\n              \x3cbutton\r\n                class\x3d"btn btn-split-right inline-block btn-split js-dropdown-toggle"\r\n                aria-label\x3d"${i18n.itemProperties.openMenu}"\r\n              \x3e\r\n                ${icons.chevron-down.16}\r\n              \x3c/button\x3e\r\n            \x3c/div\x3e\r\n            \x3cnav class\x3d"dropdown-menu dropdown-menu-constrained dropdown-menu-full dropdown-right"\x3e\r\n              \x3ca role\x3d"menuitem" href\x3d"${item.newStoryMapCollectionFromThemeUrl}" class\x3d"dropdown-link"\x3e\r\n                ${i18n.itemLinks.newCollectionFromTheme}\r\n              \x3c/a\x3e\r\n            \x3c/nav\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"if-not-from-collaboration"\x3e\r\n          \x3ca\r\n            href\x3d"${item.configureStoryMapThemeUrl}"\r\n            class\x3d"text-ellipsis trailer-half btn btn-clear btn-fill js-open-btn if-editable-storymap-theme"\r\n          \x3e\r\n            ${i18n.itemLinks.editStorymapTheme}\r\n          \x3c/a\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Constant Item Actions --\x3e\r\n        \x3c!--\x3cbutton data-action\x3d"downloadImage" class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear if-downloadImage js-action-downloadImage js-open-btn"\x3e${i18n.downloadImageDlg.title}\x3c/button\x3e--\x3e\r\n        \x3cbutton\r\n          data-action\x3d"share"\r\n          class\x3d"trailer-half btn btn-fill btn-clear text-ellipsis if-can-share js-action-share js-open-btn"\r\n        \x3e\r\n          ${i18n.common.share}\r\n        \x3c/button\x3e\r\n\r\n        \x3c!-- Replace Vector Tile Layer Action --\x3e\r\n        \x3cdiv class\x3d"if-replaceLayer-enabled"\x3e\r\n          \x3cdiv class\x3d"if-can-update"\x3e\r\n            \x3cbutton\r\n              data-action\x3d"replaceLayer"\r\n              class\x3d"if-vectorTile if-tiled-imagery if-tile if-scene-2 trailer-half btn btn-fill btn-clear text-ellipsis js-action-replaceLayer js-open-btn"\r\n            \x3e\r\n              ${i18n.itemLinks.replaceLayer}\r\n            \x3c/button\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Replace Scene Layer Action --\x3e\r\n        \x3cdiv class\x3d"if-replaceLayer-enabled"\x3e\r\n          \x3cdiv class\x3d"if-can-update"\x3e\r\n            \x3cbutton\r\n              data-action\x3d"replaceSceneLayer"\r\n              class\x3d"if-3d if-scene if-scene-2 trailer-half btn btn-fill btn-clear text-ellipsis js-action-replaceSceneLayer js-open-btn"\r\n            \x3e\r\n              ${i18n.itemLinks.replaceLayer}\r\n            \x3c/button\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Metadata Actions --\x3e\r\n        \x3c!-- if item has metadata for viewer --\x3e\r\n        \x3cbutton\r\n          data-action\x3d"viewMetadata"\r\n          class\x3d"trailer-half btn btn-fill btn-clear text-ellipsis if-viewer if-metadata js-action-viewMetadata js-open-btn"\r\n        \x3e\r\n          ${i18n.itemProperties.metadata}\r\n        \x3c/button\x3e\r\n\r\n        \x3c!-- if item has metadata for non-viewer --\x3e\r\n        \x3cbutton\r\n          data-action\x3d"viewMetadata"\r\n          class\x3d"trailer-half btn btn-fill btn-clear text-ellipsis if-no-viewer if-metadata-disabled if-metadata js-action-viewMetadata"\r\n        \x3e\r\n          ${i18n.itemProperties.metadata}\r\n        \x3c/button\x3e\r\n\r\n        \x3c!-- if metadata enabled, and the user can update --\x3e\r\n        \x3cbutton\r\n          data-action\x3d"editMetadata"\r\n          class\x3d"trailer-half btn btn-fill btn-clear text-ellipsis if-can-update if-metadata-enabled if-no-viewer js-action-editMetadata"\r\n        \x3e\r\n          ${i18n.itemProperties.metadata}\r\n        \x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/aside\x3e\r\n\r\n    \x3cdiv class\x3d"column-17 leader-1 trailer-2 post-1 rtl-post-0"\x3e\r\n      \x3cdiv class\x3d"js-description-section"\x3e\r\n        \x3c!-- Container for Description InlineEdit --\x3e\r\n        \x3ch4 class\x3d"leader-quarter"\x3e${i18n.itemProperties.description}\x3c/h4\x3e\r\n        \x3cdiv class\x3d"js-view if-description description-rich-text break-word overflow-auto"\x3e\x3c/div\x3e\r\n        \x3cp class\x3d"if-no-description text-darker-gray"\x3e\r\n          \x3cspan class\x3d"if-viewer"\x3e${i18n.itemProperties.descriptionUnavailable}\x3c/span\x3e\r\n          \x3cbutton class\x3d"js-inline-edit btn-link if-can-update text-left" data-edit-id\x3d"description"\x3e\r\n            ${i18n.itemProperties.noDescription}\r\n          \x3c/button\x3e\r\n        \x3c/p\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"related-items-section"\x3e\x3c/div\x3e\r\n\r\n      \x3cdiv\r\n        class\x3d"js-serviceLayers if-featureLayers if-operationalLayers if-baseMapLayers if-elevationLayers if-tools trailer-2"\r\n      \x3e\r\n        \x3cdiv class\x3d"if-featureLayers if-operationalLayers trailer-2"\x3e\r\n          \x3ch4\x3e${i18n.itemProperties.mapLayers}\x3c/h4\x3e\r\n          \x3cdiv class\x3d"js-layers js-layerNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"if-elevationLayers trailer-2"\x3e\r\n          \x3cdiv class\x3d"layer trailer-half"\x3e${i18n.itemProperties.groundLayers}\x3c/div\x3e\r\n          \x3cdiv class\x3d"js-elevationLayers js-layerNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"if-tools trailer-2"\x3e\r\n          \x3ch4 class\x3d"layer trailer-half"\x3e${i18n.itemProperties.toolLayers}\x3c/h4\x3e\r\n          \x3cdiv class\x3d"js-tools"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"js-serviceTables if-tables trailer-2"\x3e\r\n        \x3ch4\x3e${i18n.itemProperties.mapTables}\x3c/h4\x3e\r\n        \x3cdiv class\x3d"js-tables js-layerNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"if-baseMapLayers trailer-2"\x3e\r\n        \x3c!-- TODO: Create basemap string for itemProperties after string freeze --\x3e\r\n        \x3ch4\x3e${i18n.viewer.basemapBtn}\x3c/h4\x3e\r\n        \x3cdiv class\x3d"js-baseMapLayers js-layerNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"if-projectContent trailer-2"\x3e\r\n        \x3ch4\x3e${i18n.itemProperties.projectContents}\x3c/h4\x3e\r\n        \x3ctable class\x3d"table table-striped"\x3e\r\n          \x3ctbody class\x3d"js-projectContent"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"if-solutionContent trailer-2"\x3e\r\n        \x3ch4\x3e${i18n.itemProperties.solutionContents}\x3c/h4\x3e\r\n        \x3ctable class\x3d"table table-striped"\x3e\r\n          \x3ctbody class\x3d"js-solutionContent"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"if-workflowContent trailer-2"\x3e\r\n        \x3ch4\x3e${i18n.itemProperties.workflowContents}\x3c/h4\x3e\r\n        \x3ctable\x3e\r\n          \x3ctbody class\x3d"js-workflowContent"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"if-formContent trailer-2"\x3e\r\n        \x3ch4\x3e${i18n.itemProperties.mapLayers}\x3c/h4\x3e\r\n        \x3cdiv class\x3d"js-formContent"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"if-screenshots"\x3e\r\n        \x3ch4 class\x3d"leader-2 js-screenshots-title"\x3e${i18n.itemProperties.screenshots}\x3c/h4\x3e\r\n        \x3cdiv\r\n          class\x3d"block-group block-group-3-up tablet-block-group-2-up phone-block-group-1-up js-screenshotGroup"\r\n        \x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"js-licenseInfo-section"\x3e\r\n        \x3c!-- Container for Terms of Use InlineEdit --\x3e\r\n        \x3ch4 class\x3d"leader-2"\x3e${i18n.itemProperties.access}\x3c/h4\x3e\r\n        \x3cdiv class\x3d"js-view if-licenseInfo break-word overflow-auto"\x3e\x3c/div\x3e\r\n        \x3cp class\x3d"if-no-licenseInfo text-darker-gray"\x3e\r\n          \x3cspan class\x3d"if-viewer"\x3e${i18n.itemProperties.attributionUnavailable}\x3c/span\x3e\r\n          \x3cbutton class\x3d"btn-link js-inline-edit if-can-update text-left" data-edit-id\x3d"licenseInfo"\x3e\r\n            ${i18n.itemProperties.noAttribution}\r\n          \x3c/button\x3e\r\n        \x3c/p\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"js-comments if-commentsEnabled trailer-half"\x3e\r\n        \x3ch4 class\x3d"leader-2"\x3e\r\n          ${i18n.itemProperties.comments}\r\n          \x3cspan class\x3d"js-numComments font-size--2"\x3e(${item.numComments:_formatCount})\x3c/span\x3e\r\n          \x3cspan class\x3d"inline-block padding-left-2"\x3e\r\n            \x3ca\r\n              target\x3d"_blank"\r\n              href\x3d"${item.commentsRssUrl}"\r\n              class\x3d"if-public icon-social-rss icon-social-small js-open-rss"\r\n              aria-label\x3d"${i18n.itemProperties.rssFeed}"\r\n            \x3e\x3c/a\x3e\r\n          \x3c/span\x3e\r\n\r\n          \x3clabel class\x3d"font-size--3 padding-left-1 right if-numComments"\x3e\r\n            ${i18n.gallery.sortBy}\r\n            \x3cselect class\x3d"margin-left-1 inline-block js-sort-comments leader-0" aria-controls\x3d"comments"\x3e\r\n              \x3coption value\x3d"created" selected\x3e${i18n.common.newLabel}\x3c/option\x3e\r\n              \x3coption value\x3d"latest_reply"\x3e${i18n.common.latestReply}\x3c/option\x3e\r\n            \x3c/select\x3e\r\n          \x3c/label\x3e\r\n        \x3c/h4\x3e\r\n        \x3cdiv class\x3d"js-commentbox if-signed-in"\x3e\r\n          \x3cdiv class\x3d"panel border-bottom-clear"\x3e\r\n            \x3clabel class\x3d"trailer-half font-size-0" for\x3d"addComment"\x3e${i18n.itemProperties.leaveComment}\x3c/label\x3e\r\n            \x3cdiv class\x3d"flex"\x3e\r\n              \x3cdiv class\x3d"comment-avatar flex-0"\x3e\r\n                \x3cspan class\x3d"js-portal-user-top-level-avatar"\x3e\x3c/span\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"flex-1 padding-left-1"\x3e\r\n                \x3ctextarea\r\n                  class\x3d"js-disable-addComment leader-0 trailer-half display-block"\r\n                  id\x3d"addComment"\r\n                  rows\x3d"3"\r\n                  placeholder\x3d"${i18n.itemProperties.leaveComment}"\r\n                \x3e\x3c/textarea\x3e\r\n                \x3cbutton\r\n                  data-id\x3d"${comment.id}"\r\n                  data-type\x3d"comment"\r\n                  type\x3d"button"\r\n                  class\x3d"btn btn-small inline-block right js-action-addComment js-disable-addComment"\r\n                  aria-controls\x3d"comments"\r\n                \x3e\r\n                  ${i18n.itemProperties.comment}\r\n                \x3c/button\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"if-signed-out"\x3e\r\n          \x3cdiv class\x3d"panel border-bottom-clear"\x3e\r\n            \x3ca href\x3d"signin.html?returnUrl\x3d${currentHref}"\x3e${i18n.common.signIn}\x3c/a\x3e\r\n            ${i18n.itemProperties.toAddNewComment}\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"hide" id\x3d"comments" role\x3d"region" aria-live\x3d"polite"\x3e\x3c/div\x3e\r\n        \x3cbutton class\x3d"js-loadMore-comments hide btn btn-clear btn-fill leader-half" aria-controls\x3d"comments"\x3e\r\n          ${i18n.itemProperties.loadMore}\r\n        \x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"column-6 leader-1 trailer-2"\x3e\r\n      \x3c!-- closed view --\x3e\r\n      \x3csection\r\n        class\x3d"font-size--1 column-6 tablet-column-6 if-scoreCompleteness if-can-update js-scoreCompletenessClosed"\r\n      \x3e\r\n        \x3ch5 class\x3d"trailer-half"\x3e\r\n          ${i18n.itemCompleteness.itemDetails}\r\n          \x3cbutton class\x3d"btn-link btn-link-darker-gray font-size--3 right js-show-itemCompleteness"\x3e\r\n            ${icons.inline.question.16}${i18n.addItemFrm.learnMore}\r\n          \x3c/button\x3e\r\n        \x3c/h5\x3e\r\n        \x3cdiv class\x3d"progress-bar"\x3e\r\n          \x3cdiv class\x3d"progress-bar-fill js-item-scoreCompleteness-bar" style\x3d"width: ${item.scoreCompleteness}%"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cp class\x3d"font-size--3 leading-quarter trailer-half clearfix"\x3e\r\n          \x3cspan class\x3d"left"\x3e${i18n.common.lowLbl}\x3c/span\x3e\x3cspan class\x3d"right"\x3e${i18n.common.highLbl}\x3c/span\x3e\r\n        \x3c/p\x3e\r\n        \x3cp\r\n          class\x3d"font-size--2 text-darker-gray padding-left-quarter trailer-0 text-center hide js-itemCompleteness-top"\r\n        \x3e\x3c/p\x3e\r\n        \x3cp class\x3d"font-size--3 trailer-half js-itemCompleteness-wellDone hide"\x3e\r\n          ${item.scoreCompleteness:_formatWellDone}\r\n        \x3c/p\x3e\r\n      \x3c/section\x3e\r\n\r\n      \x3c!-- open view --\x3e\r\n      \x3csection\r\n        class\x3d"font-size--1 leader-1 column-6 tablet-column-6 tablet-leader-1 if-scoreCompleteness if-can-update hide js-scoreCompletenessOpen"\r\n      \x3e\r\n        \x3ch5 class\x3d"padding-leader-half trailer-half"\x3e\r\n          ${i18n.itemCompleteness.itemDetails}\r\n          \x3cbutton class\x3d"btn-link btn-link-darker-gray font-size--3 right js-hide-itemCompleteness"\x3e\r\n            ${icons.inline.x.16}${i18n.common.hideLbl}\r\n          \x3c/button\x3e\r\n        \x3c/h5\x3e\r\n        \x3cspan class\x3d"progress-bar-label text-green"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"progress-bar"\x3e\r\n          \x3cdiv class\x3d"progress-bar-fill js-item-scoreCompleteness-bar" style\x3d"width: ${item.scoreCompleteness}%"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cp class\x3d"font-size--3 leading-quarter trailer-half clearfix"\x3e\r\n          \x3cspan class\x3d"left"\x3e${i18n.common.lowLbl}\x3c/span\x3e\x3cspan class\x3d"right"\x3e${i18n.common.highLbl}\x3c/span\x3e\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"font-size--3 inline-block trailer-half"\x3e${i18n.itemCompleteness.itemCompletenessTip}\x3c/p\x3e\r\n        \x3cul class\x3d"list-plain font-size--3 leader-0 trailer-half js-itemCompleteness-list"\x3e\x3c/ul\x3e\r\n        \x3cp class\x3d"font-size--3 trailer-half js-itemCompleteness-wellDone hide"\x3e\r\n          ${item.scoreCompleteness:_formatWellDone}\r\n        \x3c/p\x3e\r\n      \x3c/section\x3e\r\n\r\n      \x3csection class\x3d"js-details font-size--1 padding-trailer-2 column-6 tablet-column-6 tablet-leader-1"\x3e\r\n        \x3ch5 class\x3d"leader-1 padding-leader-half trailer-half"\x3e${i18n.itemLinks.details}\x3c/h5\x3e\r\n        \x3cdiv class\x3d"if-urbanModel"\x3e\r\n          \x3cp class\x3d"hide js-urban-database trailer-0"\x3e\x3c/p\x3e\r\n          \x3cp class\x3d"hide js-urban-view"\x3e\x3c/p\x3e\r\n        \x3c/div\x3e\r\n        \x3cp class\x3d"if-serviceLink trailer-0 font-size--1"\x3e\r\n          ${i18n.itemProperties.source} \x3cspan class\x3d"js-service-link"\x3e${item:_formatServiceLink}\x3c/span\x3e\r\n          \x3cspan class\x3d"js-image-service-source-collection hide"\x3e${i18n.itemProperties.imageCollection}\x3c/span\x3e\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"js-relationshipsCreatedFrom if-sourceData if-cloudDriveData trailer-0 font-size--1"\x3e\x3c/p\x3e\r\n        \x3cspan class\x3d"js-otherStyles if-vectorTile if-otherStyles trailer-0 font-size--1"\x3e\r\n          \x3cp class\x3d"js-otherStyles-label trailer-0"\x3e\x3c/p\x3e\r\n        \x3c/span\x3e\r\n        \x3cp class\x3d"if-resultCreatingIn trailer-0 font-size--1 js-resultCreatingIn"\x3e${i18n.itemProperties.creatingDataIn}\x3c/p\x3e\r\n        \x3cp class\x3d"if-resultVisualizations trailer-0 font-size--1"\x3e${i18n.itemProperties.publishedTo}\x3c/p\x3e\r\n        \x3cul class\x3d"if-resultVisualizations other-views trailer-0 font-size--1 js-relationshipsVisualizedTo"\x3e\x3c/ul\x3e\r\n        \x3cp class\x3d"if-resultDataViews trailer-0 font-size--1"\x3e${i18n.itemProperties.dataViews}\x3c/p\x3e\r\n        \x3cul class\x3d"if-resultDataViews other-views trailer-0 font-size--1 js-relationshipsDataViews"\x3e\x3c/ul\x3e\r\n        \x3cp class\x3d"if-appBuilderPlatform trailer-0 font-size--1"\x3e\r\n          ${i18n.itemProperties.applicable} ${item.typeKeywords:_formatApplicable}\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--1 js-dataUpdatedLast hide"\x3e\x3c/p\x3e\r\n        \x3cp class\x3d"js-item-size trailer-0 font-size--1"\x3e${i18n.itemProperties.sizeLabel} ${item.size:_formatSize}\x3c/p\x3e\r\n        \x3cp class\x3d"js-item-attachments-size trailer-0 font-size--1 if-has-attachments"\x3e\r\n          ${i18n.itemProperties.attachmentsSize} ${item.subInfo:_formatSize}\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"js-item-image-count trailer-0 font-size--1 if-has-image-count"\x3e\r\n          ${i18n.itemProperties.imageCount} ${item.subInfo:_formatNumber}\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--1 if-web if-mobile if-platform js-app-api"\x3e${item.typeKeywords:_formatAppApi}\x3c/p\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--1 if-web if-mobile if-platform js-app-purpose"\x3e\r\n          ${item.typeKeywords:_formatAppPurpose}\r\n        \x3c/p\x3e\r\n        \x3cp class\x3d"js-rating font-size--3 trailer-half leader-quarter"\x3e\r\n          \x3cspan class\x3d"js-update-ratings"\x3e\x3c/span\x3e\r\n        \x3c/p\x3e\r\n        \x3cdiv class\x3d"trailer-0 leader-half inline-block if-can-share-social"\x3e\r\n          \x3cdiv class\x3d"tablet-hide"\x3e\r\n            \x3ca\r\n              target\x3d"_blank"\r\n              href\x3d"${item.type:_formatFacebookLink}"\r\n              class\x3d"icon-social-facebook js-open-facebook js-action-shareSocial"\r\n              aria-label\x3d"Facebook"\r\n              data-action\x3d"shareSocial"\r\n            \x3e\r\n              \x3csvg\r\n                xmlns\x3d"http://www.w3.org/2000/svg"\r\n                width\x3d"30"\r\n                height\x3d"30"\r\n                viewBox\x3d"0 0 30 30"\r\n                class\x3d"high-contrast-only"\r\n              \x3e\r\n                \x3cpath\r\n                  fill\x3d"currentColor"\r\n                  d\x3d"M22.117 7H7.883A.883.883 0 0 0 7 7.883v14.234c0 .487.396.883.883.883H15v-7h-3v-2h3v-.992c0-2.066 1.277-3.192 3.121-3.192.883 0 1.879.066 1.879.096V12h-1.764c-1.002 0-1.236.148-1.236.848V14h2.73l-.911 2H17v7h5.117a.884.884 0 0 0 .883-.883V7.883A.883.883 0 0 0 22.117 7z"\r\n                /\x3e\r\n              \x3c/svg\x3e\r\n            \x3c/a\x3e\r\n            \x3ca\r\n              target\x3d"_blank"\r\n              href\x3d"${item.type:_formatTwitterLink}"\r\n              class\x3d"margin-left-quarter icon-social-twitter js-action-shareSocial js-open-twitter"\r\n              aria-label\x3d"Twitter"\r\n              data-action\x3d"shareSocial"\r\n            \x3e\r\n              \x3csvg\r\n                xmlns\x3d"http://www.w3.org/2000/svg"\r\n                width\x3d"30"\r\n                height\x3d"30"\r\n                viewBox\x3d"0 0 30 30"\r\n                class\x3d"high-contrast-only"\r\n              \x3e\r\n                \x3cpath\r\n                  fill\x3d"currentColor"\r\n                  d\x3d"M23.156 11.495c.007.158.012.319.012.479 0 4.878-3.717 10.505-10.508 10.505-2.085 0-4.027-.61-5.66-1.658a7.41 7.41 0 0 0 5.466-1.529 3.695 3.695 0 0 1-3.449-2.564 3.621 3.621 0 0 0 1.667-.062 3.697 3.697 0 0 1-2.962-3.621v-.048a3.683 3.683 0 0 0 1.672.463 3.693 3.693 0 0 1-1.143-4.93 10.486 10.486 0 0 0 7.611 3.858 3.691 3.691 0 0 1 6.292-3.367 7.458 7.458 0 0 0 2.345-.896 3.699 3.699 0 0 1-1.624 2.043 7.427 7.427 0 0 0 2.123-.582 7.545 7.545 0 0 1-1.842 1.909z"\r\n                /\x3e\r\n              \x3c/svg\x3e\r\n            \x3c/a\x3e\r\n            \x3cdiv class\x3d"dropdown js-dropdown shorten-url if-online js-shorten-url"\x3e\r\n              \x3ca\r\n                href\x3d"#"\r\n                id\x3d"shorten-url"\r\n                class\x3d"margin-left-quarter icon-social-share js-dropdown-toggle js-shorten-url-link"\r\n                aria-label\x3d"Copy URL"\r\n              \x3e\r\n                \x3csvg\r\n                  xmlns\x3d"http://www.w3.org/2000/svg"\r\n                  width\x3d"30"\r\n                  height\x3d"30"\r\n                  viewBox\x3d"0 0 30 30"\r\n                  class\x3d"high-contrast-only"\r\n                \x3e\r\n                  \x3cpath\r\n                    fill\x3d"currentColor"\r\n                    d\x3d"M19.8 7h-9.6A3.21 3.21 0 0 0 7 10.2v9.6c0 1.761 1.44 3.2 3.2 3.2h9.6c1.761 0 3.2-1.439 3.2-3.2v-9.6C23 8.44 21.561 7 19.8 7zm.35 4.593a2.06 2.06 0 0 1-2.058 2.058h-.186c-.357 0-.708-.095-1.021-.276L13.634 15l3.252 1.626a2.037 2.037 0 0 1 1.021-.276h.186a2.06 2.06 0 0 1 2.058 2.058v.186a2.06 2.06 0 0 1-2.058 2.058h-.186a2.06 2.06 0 0 1-2.058-2.058v-.186c0-.118.013-.237.038-.366l-3.234-1.617a2.064 2.064 0 0 1-1.561.727h-.186a2.06 2.06 0 0 1-2.058-2.058v-.186a2.06 2.06 0 0 1 2.058-2.058h.186c.598 0 1.17.269 1.561.727l3.234-1.617a1.915 1.915 0 0 1-.038-.367v-.186a2.06 2.06 0 0 1 2.058-2.058h.186a2.06 2.06 0 0 1 2.058 2.058v.186z"\r\n                  /\x3e\r\n                \x3c/svg\x3e\r\n              \x3c/a\x3e\r\n              \x3cdiv class\x3d"dropdown-menu dropdown-right leader-quarter trailer-quarter" role\x3d"menu"\x3e\r\n                \x3clabel class\x3d"padding-trailer-quarter leader-quarter padding-left-1 padding-right-1"\x3e\r\n                  ${i18n.itemProperties.shortUrl}\r\n                  \x3cdiv id\x3d"copyToClipBoardShortURL"\x3e\x3c/div\x3e\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"hide js-image-service-details"\x3e\r\n          \x3ch5 class\x3d"leader-1 padding-leader-half trailer-half"\x3e${i18n.itemProperties.imageProperties}\x3c/h5\x3e\r\n          \x3cp class\x3d"js-image-properties-source-type trailer-0 font-size--1"\x3e\x3c/p\x3e\r\n          \x3cp class\x3d"js-image-properties-pixel-type trailer-0 font-size--1"\x3e\x3c/p\x3e\r\n          \x3cp class\x3d"js-image-properties-bands trailer-0 font-size--1"\x3e\x3c/p\x3e\r\n          \x3cp class\x3d"js-image-properties-cell-size trailer-0 font-size--1"\x3e\x3c/p\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Sharing --\x3e\r\n        \x3cdiv class\x3d"position-relative"\x3e\r\n          \x3ch5 class\x3d"leader-1 padding-leader-half trailer-half"\x3e\r\n            ${i18n.GroupWidget.share}\r\n            \x3cbutton\r\n              class\x3d"btn-link btn-link-darker-gray if-can-share font-size--3 right js-action-share"\r\n              data-action\x3d"share"\r\n            \x3e\r\n              ${icons.inline.edit.16}${i18n.common.edit}\r\n            \x3c/button\x3e\r\n          \x3c/h5\x3e\r\n          \x3cdiv class\x3d"js-item-share-summary"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Change Owner --\x3e\r\n        \x3cdiv class\x3d"position-relative"\x3e\r\n          \x3ch5 class\x3d"leader-1 padding-leader-half trailer-half"\x3e\r\n            ${i18n.itemProperties.owner}\r\n            \x3cbutton\r\n              class\x3d"btn-link btn-link-darker-gray if-can-change-owner font-size--3 right js-action-reassignItem"\r\n              data-action\x3d"reassignItem"\r\n            \x3e\r\n              ${icons.inline.user.16}${i18n.itemProperties.reassign}\r\n            \x3c/button\x3e\r\n          \x3c/h5\x3e\r\n          \x3cdiv class\x3d"js-owner-info"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Move to folder --\x3e\r\n        \x3cdiv class\x3d"if-admin"\x3e\r\n          \x3csection class\x3d"position-relative"\x3e\r\n            \x3cheader class\x3d"leader-1 padding-leader-half"\x3e\r\n              \x3ch5\x3e\r\n                ${i18n.itemProperties.folder}\r\n                \x3cbutton\r\n                  data-action\x3d"moveItem"\r\n                  class\x3d"js-folder-open btn-link btn-link-darker-gray font-size--3 right js-action-moveItem"\r\n                  aria-label\x3d"${i18n.itemProperties.moveToFolder}"\r\n                \x3e\r\n                  ${icons.inline.folder-move.16}${i18n.itemProperties.moveTo}\r\n                \x3c/button\x3e\r\n              \x3c/h5\x3e\r\n            \x3c/header\x3e\r\n            \x3cp class\x3d"leader-quarter js-folder-title break-word"\x3e\x3c/p\x3e\r\n          \x3c/section\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"js-category-section"\x3e\r\n          \x3c!-- Container for Categories InlineEdit --\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"js-tags-section"\x3e\r\n          \x3c!-- Container for Tags InlineEdit --\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"item-accessInformation leader-1 padding-leader-half"\x3e\r\n          \x3cdiv class\x3d"js-accessInformation-section"\x3e\r\n            \x3c!-- Container for Credits(Attribution) InlineEdit --\x3e\r\n            \x3ch5 class\x3d"trailer-half"\x3e${i18n.itemProperties.credits}\x3c/h5\x3e\r\n            \x3cspan class\x3d"if-no-accessInformation text-darker-gray trailer-half"\x3e\r\n              \x3cspan class\x3d"if-viewer"\x3e${i18n.itemProperties.creditsUnavailable}\x3c/span\x3e\r\n              \x3cbutton class\x3d"btn-link js-inline-edit if-can-update text-left"\x3e${i18n.itemProperties.noCredits}\x3c/button\x3e\r\n            \x3c/span\x3e\r\n            \x3cp class\x3d"if-accessInformation js-view"\x3e\x3c/p\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"if-route-layer leader-1 padding-leader-half navigator-button-desktop"\x3e\r\n          \x3clabel for\x3d"navUrl"\x3e\r\n            \x3ch5 class\x3d"trailer-half flex"\x3e\r\n              \x3cimg data-dojo-attach-point\x3d"_img" alt\x3d"" class\x3d"margin-right-quarter overview-app-icon"\r\n              src\x3d${basePath}/css/images/app-icons/navigator.png\x3e\r\n              \x3cspan class\x3d"flex-end"\x3e${i18n.itemProperties.navigatorLink}\x3c/span\x3e\r\n            \x3c/h5\x3e\r\n            \x3cdiv id\x3d"copyToClipBoardNavURL"\x3e\x3c/div\x3e\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"if-url if-documentUrl if-hide-insights leader-1 padding-leader-half"\x3e\r\n          \x3clabel for\x3d"shortUrl"\x3e\r\n            \x3ch5 class\x3d"trailer-half"\x3e\r\n              ${i18n.itemProperties.url}\r\n              \x3ca href\x3d"${item.viewUrl}" target\x3d"_blank" class\x3d"js-view-url font-size--3 link-darker-gray right"\x3e\r\n                ${icons.inline.launch.16}${i18n.itemProperties.metadataView}\r\n              \x3c/a\x3e\r\n            \x3c/h5\x3e\r\n            \x3cdiv id\x3d"copyToClipBoardURL"\x3e\x3c/div\x3e\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n      \x3c/section\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"js-sublayer-pane item-pane item-pane--right"\x3e\r\n    \x3cdiv class\x3d"js-sublayer"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\r\n  \x3c!-- For tile layer auto cache case --\x3e\r\n  \x3ccalcite-alert\r\n    placement\x3d"top"\r\n    icon\r\n    label\x3d${i18n.itemProperties.buildingTileAutoHeader}\r\n    class\x3d"tile-layer-auto-cache-alert"\r\n  \x3e\r\n    \x3cdiv slot\x3d"title"\x3e${i18n.itemProperties.buildingTileAutoHeader}\x3c/div\x3e\r\n    \x3cdiv slot\x3d"message"\x3e${i18n.itemProperties.buildingTileAutoDescription}\x3c/div\x3e\r\n  \x3c/calcite-alert\x3e\r\n\x3c/main\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_solutionContent.html":'\x3ctr class\x3d\'js-solution-row\'\x3e\r\n  \x3ctd\x3e\r\n    \x3csection class\x3d"accordion-section"\x3e\r\n      \x3ch4 class\x3d"accordion-title filters--accordion--title filters--accordion--title__override" role\x3d"tab" tabindex\x3d"0"\x3e\r\n        ${icons.chevron-down.16}\r\n        \x3cspan class\x3d"margin-right-half" alt\x3d"${type}" title\x3d"${type}"\x3e\r\n          \x3cimg class\x3d"item-type-icon" style\x3d"vertical-align: text-top;" src\x3d"${source}" width\x3d"16" height\x3d"16" alt\x3d""\x3e\r\n        \x3c/span\x3e\r\n        ${title}\r\n      \x3c/h4\x3e\r\n\r\n      \x3cdiv class\x3d"accordion-content margin-left-1 margin-right-1"\x3e\r\n        \x3cdiv class\x3d"padding-left-1 padding-right-1 js-no-categories-action"\x3e\r\n          \x3ch5 class\x3d"font-size-0 avenir-regular trailer-0"\x3e${child}\x3c/h5\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/section\x3e\r\n  \x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_solutionItem.html":'\x3cul class\x3d"solution-list"\x3e\r\n  \x3cli\x3e\r\n    \x3cspan class\x3d"margin-right-half" alt\x3d"${type}" title\x3d"${type}"\x3e\r\n      \x3cimg class\x3d"item-type-icon padding-trailer-half item-type-icon__vertical" src\x3d"${source}" width\x3d"16" height\x3d"16" alt\x3d""\x3e\r\n    \x3c/span\x3e\r\n    \x3cspan\x3e\r\n      ${titleOrLink}\r\n    \x3c/span\x3e\r\n    ${childList}\r\n  \x3c/li\x3e\r\n\x3c/ul\x3e\r\n',"url:arcgisonline/pages/item/widgets/templates/_workflowContent.html":'\x3ctr\x3e\r\n  \x3ctd\x3e\r\n    \x3ca target\x3d"_blank" href\x3d"item.html?id\x3d${id}"\x3e${title}\x3c/a\x3e\r\n  \x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_visualize.html":'\x3cmain class\x3d"fullscreen flex-column ie9-height-100 ie9-width-100"\x3e\r\n  \x3cdiv\x3e\r\n    \x3cdiv class\x3d"js-viz-controls clearfix padding-left-1 padding-right-1 border-box padding-leader-half full-width"\x3e\r\n      \x3clabel class\x3d"js-featureLayers hide if-featureLayers column-12 tablet-column-6 trailer-half"\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"layerSelectLabel" class\x3d"inline-block padding-right-1"\x3e${i18n.openMapDlg.layerLabel}\x3c/span\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"layerSelect" class\x3d"inline-block leader-0"\x3e\x3c/select\x3e\r\n      \x3c/label\x3e\r\n      \x3cdiv class\x3d"inline-block right padding-trailer-half"\x3e\r\n        \x3cbutton data-dojo-attach-point\x3d"saveAsBtn" class\x3d"btn btn-clear btn-two right if-can-create-items"\x3e${i18n.common.saveLayerAs}\x3c/button\x3e\r\n        \x3cbutton data-dojo-attach-point\x3d"saveBtn" class\x3d"btn right btn-disabled if-can-update"\x3e${i18n.common.saveLayer}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ciframe class\x3d"item-iframe flex-1" title\x3d"${i18n.itemProperties.mapViewerLbl}" name\x3d"viewer" frameborder\x3d"0" border\x3d"0" cellspacing\x3d"0" scrolling\x3d"no" data-dojo-attach-point\x3d"viewer" id\x3d"main-content-area"\x3e\x3c/iframe\x3e\r\n\x3c/main\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_imageManagement.html":'\x3cmain class\x3d"fullscreen flex-column ie9-height-100 ie9-width-100"\x3e\r\n  \x3ciframe class\x3d"item-iframe flex-1" title\x3d"${i18n.itemProperties.imageManagementLbl}" name\x3d"viewer" frameborder\x3d"0" border\x3d"0" cellspacing\x3d"0" scrolling\x3d"no" data-dojo-attach-point\x3d"divImageManagement" id\x3d"main-content-area"\x3e\x3c/iframe\x3e\r\n\x3c/main\x3e\r\n',"url:esri/dijit/templates/ExpressionEditor.html":'\x3cdiv class\x3d"modal"\x3e\r\n  \x3cdiv class\x3d"modal-content"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_expressionEditorLoading" class\x3d"throb-loading" style\x3d"border:none;height:100%;"\x3e\x3c/div\x3e\r\n    \x3ciframe data-dojo-attach-point\x3d"_expressionEditor" scrolling\x3d"auto" style\x3d"border:none;width:100%;height:100%;visibility:hidden;"\x3e\x3c/iframe\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/templates/CalculateField.html":'\x3cdiv class\x3d"${_css.base}"\x3e\r\n  \x3cdiv class\x3d"esriFloatLeading esriCalcHelp" data-dojo-attach-point\x3d"_helpNode"\x3e\r\n    \x3ca href\x3d"#" data-dojo-attach-point\x3d"_helpurlNode" target\x3d\'_help\' class\x3d""\x3e${i18n.learnMore}\x3c/a\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-attach-point\x3d"_headerPane" style\x3d"width:99%;margin-top:0.5em; margin-bottom: 0.5em;"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_header" class\x3d"${_css.titleLabel}"\x3e\r\n       \x3cdiv class\x3d"esriAlignLeading"\x3e${i18n.expBuilderTitle}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.titleDividerLine}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e  \r\n  \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"_expressionForm" style\x3d"height:100%;width:99%;"\x3e\r\n    \x3cdiv class\x3d"esriFloatLeading" data-dojo-attach-point\x3d"_selCalcFieldDiv" style\x3d"width:100%;padding-bottom:0.5em;"\x3e\r\n      \x3cdiv\x3e\x3clabel class\x3d"esriLeadingMargin1"\x3e${i18n.selectCalField}\x3c/label\x3e\x3c/div\x3e\r\n      \x3cselect class\x3d"esriLeadingMargin1 ${_css.selectField}" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_selCalcField"\x3e\x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"width:100%;padding-bottom:0.5em;" class\x3d"esriFloatLeading"\x3e\r\n      \x3clabel class\x3d"esriLeadingMargin1" data-dojo-attach-point\x3d"_calcFieldLabel"\x3e\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cinput class\x3d"esriFloatLeading esriLeadingMargin1 ${_css.expressionBox}" dir\x3d"ltr" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-attach-point\x3d"_exprBox" data-dojo-props\x3d"rows:${expressionBoxRows} ,cols:${expressionBoxCols},required:true,intermediateChanges:true"\x3e\x3c/input\x3e\r\n    \x3cdiv class\x3d"esriFloatLeading ${_css.actionBtnContainer}"\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading esriLeadingMargin1" style\x3d"width:70%;padding-bottom:0.5em;" dir\x3d"ltr" data-dojo-attach-point\x3d"_operatorCtr"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"${_css.actionButton} esriFloatTrailing esriTrailingMargin1" data-dojo-props\x3d"label:\'${i18n.remove}\',iconClass:\'${_css.clearIcon}\',showLabel: false, disabled:true" data-dojo-attach-event\x3d"onClick:_handleRemoveBtnClick" data-dojo-attach-point\x3d"_removeBtn"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"${_css.actionButton} esriFloatTrailing esriTrailingMargin1" data-dojo-props\x3d"label:\'${i18n.validate}\',iconClass:\'${_css.validateIcon}\',showLabel: false, disabled:true" data-dojo-attach-event\x3d"onClick:_handleValidationBtnClick" data-dojo-attach-point\x3d"_validateBtn"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.fieldFunctionContainer}"\x3e\r\n      \x3cdiv class\x3d"esriFloatLeading ${_css.fieldContainer}"\x3e\r\n        \x3cdiv class\x3d"${_css.fieldLabelDiv}"\x3e\x3clabel class\x3d"esriLeadingMargin1 ${_css.titleLabel}"\x3e${i18n.fields}\x3c/label\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"${_css.fieldTypeContainer}"\x3e\r\n          \x3clabel class\x3d"esriLeadingMargin1 esriSelectLabel"\x3e\r\n            \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_strRadioBtn" data-dojo-props\x3d"\'class\':\'esriSelectLabel\'" name\x3d"functionType" value\x3d"StrType"/\x3e\r\n            ${i18n.stringLabel}\r\n          \x3c/label\x3e\r\n          \x3clabel class\x3d"esriLeadingMargin1 esriSelectLabel"\x3e\r\n            \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_numRadioBtn" data-dojo-props\x3d"\'class\':\'esriSelectLabel\'" name\x3d"functionType" value\x3d"NumType"/\x3e \r\n            ${i18n.numeric}\r\n          \x3c/label\x3e\r\n          \x3clabel class\x3d"esriLeadingMargin1 esriSelectLabel"\x3e\r\n            \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"_dateRadioBtn"  data-dojo-props\x3d"\'class\':\'esriSelectLabel\'" name\x3d"functionType" value\x3d"DateType"/\x3e\r\n            ${i18n.dateLabel}\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriLeadingMargin1 ${_css.fieldListContainer}" dir\x3d"ltr" data-dojo-attach-point\x3d"_attributeListCtr"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriFloatTrailing ${_css.functionContainer}"\x3e\r\n        \x3cdiv class\x3d"${_css.functionLabelDiv}"\x3e\r\n          \x3clabel class\x3d"${_css.titleLabel}"\x3e${i18n.functions}\x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"_helpersListCtr" dir\x3d"ltr" class\x3d"${_css.functionListContainer}"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriLeadingMargin05 ${_css.formWarning} esriRoundedBox" data-dojo-attach-point\x3d"_errorMessagePane" style\x3d"clear:both;display:none;"\x3e\r\n      \x3ca href\x3d"#" title\x3d"${i18n.close}" class\x3d"esriFloatTrailing esri-icon-close" title\x3d\'${i18n.close}\' data-dojo-attach-event\x3d"onclick:_handleCloseMsg"\x3e\r\n      \x3c/a\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"_bodyNode" style\x3d"width:100%;height:100%;"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.actionDividerLine}"\x3e\x3c/div\x3e\r\n    \x3cdiv  class\x3d"esriFloatTrailing esriTrailingMargin2 esriCalcFieldActionCtr" data-dojo-attach-point\x3d"_buttonCtr"\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Button"  class\x3d"${_css.addButton}" data-dojo-attach-point\x3d"_addBtn" data-dojo-attach-event\x3d"onClick:_handleAddButtonClick"\x3e\r\n        ${calculateLabel}\r\n      \x3c/div\x3e\r\n       \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"esriLeadingMargin05 ${_css.closeButton}" data-dojo-attach-point\x3d"_closeBtn" data-dojo-attach-event\x3d"onClick:_handleCloseButtonClick"\x3e\r\n        ${i18n.close}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"_arcadeExpressionEditorDlg"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"dijitDialogUnderlayWrapper" data-dojo-attach-point\x3d"_underlay" style\x3d"position:absolute;z-index:949;display:none;top:0px;left:0px;width:100%;height:100%;"\x3e\r\n    \x3cdiv class\x3d"dijitDialogUnderlay" tabindex\x3d"-1" style\x3d"width:100%;height:100%"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.loadingIcon}" style\x3d"height:100%;"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e  \r\n',
"url:esri/dijit/FeatureAttachments/templates/FeatureAttachments.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${_css.contentContainer}"\x3e\r\n    \x3cdiv class\x3d"${_css.tabContainer}" data-dojo-attach-point\x3d "_tabContainer" data-dojo-type\x3d"dijit/layout/TabContainer"\x3e\r\n      \x3cdiv class\x3d"${_css.viewPane}" data-dojo-attach-point\x3d "_viewPane" data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${_i18nStrings.view}" data-dojo-props\x3d"selected:true"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"${_css.addPane}" data-dojo-attach-point\x3d "_addPane" data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${_i18nStrings.add}" data-dojo-props\x3d"disabled:true"\x3e\r\n        \x3cdiv class\x3d"${_css.addPaneContent}" data-dojo-attach-point\x3d "_addPaneContent"\x3e\r\n          \x3cinput class\x3d"${_css.dragDrop}" type\x3d"file" name\x3d"ft_attachment_input" size\x3d"40" data-dojo-attach-point\x3d"_fileInput"\x3e\x3c/input\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${_css.menuContainer}"\x3e\r\n      \x3cbutton class\x3d\'${_css.formButton} ${_css.uploadButton} ${_css.hidden}\' data-dojo-attach-point\x3d"_uploadButton" data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"disabled:true"\x3e${_i18nStrings.upload}\x3c/button\x3e\r\n      \x3cdiv class\x3d"${_css.feedbackNode}" data-dojo-attach-point\x3d "_feedbackNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"${_css.loadingIndicator} ${_css.hidden}" data-dojo-attach-point\x3d"_loadingIndicator"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/layout/templates/TabContainer.html":'\x3cdiv class\x3d"dijitTabContainer"\x3e\r\n\t\x3cdiv class\x3d"dijitTabListWrapper" data-dojo-attach-point\x3d"tablistNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"tablistSpacer" class\x3d"dijitTabSpacer ${baseClass}-spacer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTabPaneWrapper ${baseClass}-container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:dijit/layout/templates/_TabButton.html":'\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"titleNode,innerDiv,tabContent" class\x3d"dijitTabInner dijitTabContent"\x3e\r\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTabButtonIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3cspan data-dojo-attach-point\x3d\'containerNode,focusNode\' class\x3d\'tabLabel\'\x3e\x3c/span\x3e\r\n\t\x3cspan class\x3d"dijitInline dijitTabCloseButton dijitTabCloseIcon" data-dojo-attach-point\x3d\'closeNode\'\r\n\t\t  role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d\'closeText\' class\x3d\'dijitTabCloseText\'\x3e[x]\x3c/span\r\n\t\t\t\t\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/layout/templates/ScrollingTabController.html":'\x3cdiv class\x3d"dijitTabListContainer-${tabPosition}" style\x3d"visibility:hidden"\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerMenuButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_menuBtn"\r\n\t\t data-dojo-props\x3d"containerId: \'${containerId}\', iconClass: \'dijitTabStripMenuIcon\',\r\n\t\t\t\t\tdropDownPosition: [\'below-alt\', \'above-alt\']"\r\n\t\t data-dojo-attach-point\x3d"_menuBtn" showLabel\x3d"false" title\x3d""\x3e\x26#9660;\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_leftBtn"\r\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideLeftIcon\', showLabel:false, title:\'\'"\r\n\t\t data-dojo-attach-point\x3d"_leftBtn" data-dojo-attach-event\x3d"onClick: doSlideLeft"\x3e\x26#9664;\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_rightBtn"\r\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideRightIcon\', showLabel:false, title:\'\'"\r\n\t\t data-dojo-attach-point\x3d"_rightBtn" data-dojo-attach-event\x3d"onClick: doSlideRight"\x3e\x26#9654;\x3c/div\x3e\r\n\t\x3cdiv class\x3d\'dijitTabListWrapper\' data-dojo-attach-point\x3d\'tablistWrapper\'\x3e\r\n\t\t\x3cdiv role\x3d\'tablist\' data-dojo-attach-event\x3d\'onkeydown:onkeydown\'\r\n\t\t\t data-dojo-attach-point\x3d\'containerNode\' class\x3d\'nowrapTabStrip\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/layout/templates/_ScrollingTabControllerButton.html":'\x3cdiv data-dojo-attach-event\x3d"ondijitclick:_onClick" class\x3d"dijitTabInnerDiv dijitTabContent dijitButtonContents"  data-dojo-attach-point\x3d"focusNode" role\x3d"button"\x3e\r\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitTabStripIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3cspan data-dojo-attach-point\x3d"containerNode,titleNode" class\x3d"dijitButtonText"\x3e\x3c/span\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/FeatureTable/templates/Grid.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.borderContainer}" data-dojo-attach-point\x3d "_gridBorderContainerNode" data-dojo-type\x3d"dijit/layout/BorderContainer" gutters\x3d"false"\x3e\r\n    \x3cdiv class\x3d"${css.contentPane} ${css.menu}" data-dojo-attach-point\x3d "_gridHeaderNode" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region: \'top\'"\x3e\r\n      \x3cdiv class\x3d"${css.menuItem} ${css.loadingIndicator} ${css.hidden}" data-dojo-attach-point\x3d "_gridLoadingIndicatorNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.menuItem} ${css.menuOptions}" data-dojo-attach-point\x3d "_menuNode" \x3e\r\n        \x3cdiv data-dojo-attach-point\x3d "_gridMenuNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.menuItem} ${css.title}" data-dojo-attach-point\x3d "_gridTitleNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.contentPane}" data-dojo-attach-point\x3d "_gridContentPaneNode" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region: \'center\'"\x3e\r\n      \x3cdiv class\x3d"${css.grid}" data-dojo-attach-point\x3d"_gridNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/FeatureTable/templates/FeatureTable.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.borderContainer}" data-dojo-attach-point\x3d "_gridBorderContainerNode" data-dojo-type\x3d"dijit/layout/BorderContainer" gutters\x3d"false"\x3e\r\n    \x3cdiv class\x3d"${css.contentPane}" data-dojo-attach-point\x3d "_leadingPaneNode" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region: \'leading\'"\x3e\r\n      \x3cdiv class\x3d"${css.grid}" data-dojo-attach-point\x3d"_gridNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.contentPane} ${css.hidden}" data-dojo-attach-point\x3d "_centerPaneNode" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region: \'center\'"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.contentPane} ${css.hidden}" data-dojo-attach-point\x3d "_trailingPaneNode" data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-props\x3d"region: \'trailing\'"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/Histogram/templates/Histogram.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.container}" data-dojo-attach-point\x3d"_containerNode"\x3e\r\n    \x3cdiv class\x3d"${css.topLabel}" data-dojo-attach-point\x3d"_topLabelNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.svgContainer}" data-dojo-attach-point\x3d"_svgContainer"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.bottomLabel}" data-dojo-attach-point\x3d"_bottomLabelNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:arcgisonline/pages/dijit/FilterSingle/templates/FilterSingle.html":'\x3cul class\x3d"filter-tree" role\x3d"listbox"\x3e${list}\x3c/ul\x3e\r\n\r\n',
"url:arcgisonline/pages/dijit/FilterSingle/templates/FilterOption.html":'\x3cli class\x3d"filter-tree-item filter-tree-item-single ${selected} js-filter-item" data-value\x3d"${value}"\x3e\r\n  \x3ca role\x3d"option" aria-selected\x3d"false" href\x3d"#" title\x3d"${label}" class\x3d"filter-tree-link js-filter-link" data-param\x3d"${param}" data-value\x3d"${value}"\x3e${label} \x3cspan class\x3d"js-filter-link-count filter-tree-count margin-left-quarter inline-block no-pointer" data-value\x3d"${value}"\x3e\x3c/span\x3e\x3c/a\x3e\r\n\x3c/li\x3e\r\n',
"url:arcgisonline/pages/dijit/FilterSingle/templates/ClearAll.html":'\x3cbutton class\x3d"js-clear-filter btn-link btn-link-off-black font-size--3 right ${hide}" data-filter-param\x3d"${param}"\x3e${i18n.groupSelector.clear}\x3c/button\x3e\r\n',"url:arcgisonline/pages/dijit/FilterStatus/templates/FilterStatus.html":'\x3cdiv class\x3d"padding-left-1 inline-block flex-1 filter-chip-wrap hide" data-dojo-attach-point\x3d"filterChipWrap"\x3e\r\n    \x3cspan class\x3d"font-size--2 margin-right-half filter-chips-label"\x3e${i18n.GroupWidget.filters}\x3c/span\x3e\r\n    \x3cspan class\x3d"margin-right-half break-word filter-chips" data-dojo-attach-point\x3d"filterChips"\x3e\x3c/span\x3e\r\n    \x3cbutton class\x3d"btn-link btn-link-off-black font-size--2 filter-clear-all" data-dojo-attach-point\x3d"clearAll"\x3e${i18n.GroupWidget.clearAll}\x3c/a\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/dijit/FilterStatus/templates/FilterChip.html":'\x3cspan class\x3d"filter-chip margin-right-half js-filter-chip" data-filter\x3d"${filter.param}" data-value\x3d"${selected.value}"\x3e\r\n  \x3cspan class\x3d"filter-chip-text"\x3e${filter.chipText} ${selected.label}\x3c/span\x3e\r\n  \x3cbutton\r\n    class\x3d"filter-chip--remove js-filter-chip-remove"\r\n    data-filter\x3d"${filter.param}"\r\n    data-value\x3d"${selected.value}"\r\n    aria-label\x3d"${i18n.FilterDlg.removeFilterBtn}: \'${filter.chipText} ${selected.simpleLabel}\'"\r\n  \x3e${icons.x.16}\r\n  \x3c/button\x3e\r\n\x3c/span\x3e\r\n',
"url:arcgisonline/pages/dijit/SearchInput/SearchInput.html":'\x3cdiv class\x3d"full-width position-relative"\x3e\r\n  \x3cinput type\x3d"search" placeholder\x3d"${placeholder}" aria-label\x3d"${placeholder}" class\x3d"flex-1 input-minimal search-input ${cssTheme}" data-dojo-attach-point\x3d"searchInput"\x3e\r\n  \x3cbutton class\x3d"btn-link btn-link-darker-gray search-input__clear-btn hide" data-dojo-attach-point\x3d"clearBtn"\x3e${!icons.x.16}\x3c/button\x3e\r\n\x3c/div\x3e\r\n',"url:arcgisonline/pages/organization/widgets/templates/members/SearchDropdown.html":'\x3cdiv class\x3d"control-bar__action js-dropdown control-bar--search-dropdown"\x3e\r\n    \x3cbutton class\x3d"control-bar__btn js-toggle-search-dropdown js-dropdown-toggle" aria-label\x3d"${i18n.myOrganization.membersTab.searchMembersBy}" aria-controls\x3d"sortmenu" data-dojo-attach-point\x3d"_toggleLink" tabindex\x3d"0" aria-haspopup\x3d"true" aria-expanded\x3d"false"\x3e\r\n        \x3cspan class\x3d"control-bar__btn-text js-search-label" data-dojo-attach-point\x3d"_searchLabel"\x3e${i18n.myOrganization.membersTab.fullName}\x3c/span\x3e${!icons.inline-end.chevron-down.16}\r\n    \x3c/button\x3e\r\n    \x3cdiv class\x3d"control-bar__overlay"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"control-bar__dropdown-menu dropdown-menu js-control-bar-search-dropdown" role\x3d"menu" id\x3d"searchmenu" aria-labelledby\x3d"searchmenutitle"\x3e\r\n        \x3ch3 class\x3d"control-bar__dropdown-menu__title" id\x3d"searchmenutitle"\x3e\r\n            ${i18n.myOrganization.membersTab.searchMembersBy}\r\n            \x3cbutton class\x3d"js-dropdown-toggle control-bar__dropdown-menu__close control-bar__btn right" aria-label\x3d"${i18n.common.close}"\x3e\r\n                ${!icons.x.24}\r\n            \x3c/button\x3e\r\n        \x3c/h3\x3e\r\n        \x3cnav class\x3d"js-search-options"\x3e\r\n            \x3cbutton class\x3d"js-search-dropdown-property control-bar__dropdown-item is-active"  role\x3d"menuitem" data-property\x3d"fullname"\x3e\r\n                \x3cspan class\x3d"control-bar__dropdown-item__label"\x3e${i18n.myOrganization.membersTab.fullName}\x3c/span\x3e\r\n            \x3c/button\x3e\r\n            \x3cbutton class\x3d"js-search-dropdown-property control-bar__dropdown-item" role\x3d"menuitem" data-property\x3d"username"\x3e\r\n                \x3cspan class\x3d"control-bar__dropdown-item__label"\x3e${i18n.myOrganization.membersTab.username}\x3c/span\x3e\r\n            \x3c/button\x3e\r\n            \x3cbutton class\x3d"js-search-dropdown-property control-bar__dropdown-item" role\x3d"menuitem" data-property\x3d"firstname"\x3e\r\n                \x3cspan class\x3d"control-bar__dropdown-item__label"\x3e${i18n.myOrganization.membersTab.firstName}\x3c/span\x3e\r\n            \x3c/button\x3e\r\n            \x3cbutton class\x3d"js-search-dropdown-property control-bar__dropdown-item" role\x3d"menuitem" data-property\x3d"lastname"\x3e\r\n                \x3cspan class\x3d"control-bar__dropdown-item__label"\x3e${i18n.myOrganization.membersTab.lastName}\x3c/span\x3e\r\n            \x3c/button\x3e\r\n        \x3c/nav\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/ControlBar/templates/ControlBar.html":'\x3cdiv class\x3d"control-bar ${hideActionClass} ${hideRightClass} ${marginClass} ${positionAbsoluteClass}"\x3e\r\n  \x3cdiv class\x3d"grid-container"\x3e\r\n    \x3cdiv class\x3d"column-24 flex"\x3e\r\n      \x3cdiv class\x3d"js-control-bar-actions control-bar__section control-bar__section--left flex flex-center flex-0"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"control-bar__search ${searchActionClass} flex-1 flex js-control-bar-search-wrap"\x3e\r\n        \x3cspan class\x3d"control-bar__search-icon"\x3e${!icons.search-f.24}\x3c/span\x3e\r\n        \x3cdiv class\x3d"js-control-bar-search"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"control-bar__search-dropdown js-control-bar-search-dropdown hide"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"control-bar__search__error input-error-message js-control-bar-search-error"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"control-bar__section control-bar__section--right flex flex-center js-control-bar-right-section"\x3e\r\n        \x3cdiv class\x3d"js-control-bar-view-dropdown"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"js-control-bar-sort-dropdown"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"js-control-bar-filter-toggle ${hideFilterClass}"\x3e\r\n          \x3cbutton class\x3d"control-bar__btn ${filterActiveClass} js-toggle-filters" aria-controls\x3d"view-filters-wrap"\x3e\r\n            ${!icons.inline.sliders.16}\x3cspan class\x3d"control-bar__btn-text"\x3e${i18n.controlBar.filter}\x3c/span\x3e\r\n          \x3c/button\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"js-control-bar-refresh control-bar__refresh hide"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/ControlBar/templates/Filters.html":'\x3cdiv class\x3d"view--filters js-filters-mobile-wrap" id\x3d"view-filters-wrap"\x3e\r\n  \x3cdiv class\x3d"control-bar__overlay"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"view--filters--wrap flex-column"\x3e\r\n    \x3cdiv class\x3d"view--filters--header clearfix flex-0"\x3e\r\n      \x3ch3 class\x3d"trailer-0 font-size-1"\x3e\r\n        ${i18n.controlBar.filter}\r\n        \x3cbutton class\x3d"js-collapse-filters-button control-bar__dropdown-menu__close control-bar__dropdown-menu__close--flush control-bar__btn right" aria-label\x3d"${i18n.common.close}"\x3e\r\n          ${icons.x.32}\r\n        \x3c/button\x3e\r\n      \x3c/h3\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"js-filters-insert flex-1 view--filters--content leader-quarter"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"view--filters--footer flex-0"\x3e\r\n      \x3cbutton class\x3d"btn display-block margin-auto js-collapse-filters-button js-view-filter-results-button"\x3e${i18n.controlBar.viewResults}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/Favorite/Favorite.html":'\x3cspan\x3e\r\n  \x3cbutton class\x3d"card-action tooltip tooltip-bottom-right" aria-label\x3d"${i18n.common.favorite}" data-dojo-attach-point\x3d"button"\x3e\r\n  \x3c/button\x3e\r\n\x3c/span\x3e\r\n',"url:arcgisonline/pages/dijit/Card/Card.html":'\x3cdiv class\x3d"js-card card ${selectCardClass} ${selectedClass} ${removedClass} ${imageClass} block trailer-1 position-relative" data-id\x3d"${item.id}"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"dragHandle" class\x3d"card-drag-handle flex-center tooltip" tabindex\x3d"0" title\x3d"${i18n.orgHomePageSetup.content.reorder}" aria-label\x3d"${i18n.orgHomePageSetup.content.reorder}"\x3e\r\n    ${!icons.drag.16}\r\n  \x3c/div\x3e\r\n  \x3clabel class\x3d"card-select-check-mark js-card-select-check-mark-wrap tooltip" aria-label\x3d"${selectItem}"\x3e\r\n    \x3cinput type\x3d"checkbox" class\x3d"checkbox-custom-input js-card-select-check-mark" value\x3d"${item.id}" data-id\x3d"${item.id}" ${checked}\x3e\r\n    \x3cspan class\x3d"checkbox-custom checkbox-custom--large checkbox-custom--on-dark"\x3e\r\n      \x3csvg viewBox\x3d"0 0 16 16" class\x3d"checkbox-custom-icon checkbox-custom-icon--checked"\x3e\x3cpath d\x3d"M12.753 3l-7.319 7.497L3.252 8.31 2 9.373l3.434 3.434L14 4.24z"/\x3e\x3c/svg\x3e\r\n      \x3csvg viewBox\x3d"0 0 16 16" class\x3d"checkbox-custom-icon checkbox-custom-icon--mixed"\x3e\x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M4 7h8v2H4z"/\x3e\x3c/svg\x3e\r\n    \x3c/span\x3e\r\n  \x3c/label\x3e\r\n\r\n  \x3ca href\x3d"${item.defaultOpenUrl:empty}" class\x3d"card-image-wrap card-last js-default-open" aria-label\x3d"${!item.title}: ${item.defaultOpenText:empty}"\x3e\r\n    \x3cspan class\x3d"card-image-overlay no-pointer"\x3e\r\n      \x3cspan class\x3d"font-size--1 link-white text-center thumbnail-icon card-image-open"\x3e${!item.defaultOpenSvg:empty}${item.defaultOpenText:empty}\x3c/span\x3e\r\n    \x3c/span\x3e\r\n    \x3cimg class\x3d"card-image js-card-image no-pointer ${isImage:show}" src\x3d"${item.largeThumbnailUrl}" alt\x3d""\x3e\r\n    \x3cspan class\x3d"card-image-wrap__center-image ${isImage:hide}"\x3e\r\n      \x3cimg class\x3d"card-image js-card-image no-pointer" src\x3d"${item.largeThumbnailUrl}" alt\x3d""\x3e\r\n    \x3c/span\x3e\r\n  \x3c/a\x3e\r\n  \x3cdiv class\x3d"card-content card-content-no-padding"\x3e\r\n    \x3cdiv class\x3d"padding-leader-half padding-half padding-left-half padding-right-half card-content-auto-top"\x3e\r\n      \x3ch4 class\x3d"card-title font-size--1 trailer-0 text-ellipsis"\x3e\x3ca class\x3d"card-title-link" href\x3d"item.html?id\x3d${item.id}" title\x3d"${item.title}"\x3e${!item.title}\x3c/a\x3e\x3c/h4\x3e\r\n      \x3cp class\x3d"font-size--2 trailer-quarter flex"\x3e\r\n        \x3cspan class\x3d"js-layers-tables font-size--2"\x3e\x3c/span\x3e\r\n        \x3cspan class\x3d"js-layers-tables-toggle text-darkest-gray"\x3e\r\n          \x3cspan class\x3d"flex-0 ${showSource:show}"\x3e\x3cimg width\x3d"16" src\x3d"${item.svgIconUrl16}" alt\x3d"${item.sourceLabel}" class\x3d"icon-inline icon-inline--on-left"\x3e${item.displayName:formatDisplayName}\x3c/span\x3e\r\n          \x3cspan class\x3d"flex-0 ${showSource:hide} tooltip tooltip--data" data-tooltip\x3d"${item.sourceLabel}"\x3e\x3cimg width\x3d"16" src\x3d"${item.svgIconUrl16}" alt\x3d"${item.sourceLabel}" class\x3d"icon-inline icon-inline--on-left"\x3e${item.displayName:formatDisplayName}\x3c/span\x3e\r\n        \x3c/span\x3e\r\n      \x3c/p\x3e\r\n      \x3cp class\x3d"font-size--3 trailer-0 text-darker-gray card-created" title\x3d"${i18n.contentPage.createdLabel} ${item.created:completeDate}"\x3e${i18n.contentPage.created} ${item.created:fullDate}\x3c/p\x3e\r\n      \x3cp class\x3d"font-size--3 trailer-0 text-darker-gray" title\x3d"${i18n.itemProperties.lastModified} ${item.modified:completeDate}"\x3e${i18n.contentPage.modified} ${item.modified:fullDate}\x3c/p\x3e\r\n      \x3cp class\x3d"font-size--3 trailer-0 text-darker-gray"\x3e${item:formatViewsLabel} ${item.numViews:formatNumViews}\x3c/p\x3e\r\n      \x3cdiv class\x3d"flex-0 card-badges js-card-badges"\x3e${!item.badges}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"card-action-bar flex flex-center leader-quarter"\x3e\r\n      \x3cspan class\x3d"js-card-owner-text flex-1 text-ellipsis font-size--2 inline-block"\x3e${!item.ownerText}\x3c/span\x3e\r\n      \x3cdiv class\x3d"flex-0 flex flex-center flex-justify-end card-actions"\x3e\r\n        \x3cspan class\x3d"js-share-summary"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"js-favorites-container inline-block"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"js-open-dropdown-container inline-block dropdown-up"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/Card/OpenDropdown.html":'\x3cdiv class\x3d"display-block dropdown js-dropdown"\x3e\r\n  \x3cbutton class\x3d"card-action js-dropdown-toggle" tabindex\x3d"0" aria-haspopup\x3d"true" aria-expanded\x3d"false" aria-label\x3d"${i18n.siteHeader.moreOptions}"\x3e\r\n    ${icons.ellipsis-f.16}\r\n  \x3c/button\x3e\r\n  \x3cnav class\x3d"dropdown-menu dropdown-menu-constrained dropdown-right" role\x3d"menu"\x3e\r\n    \x3c!-- Primary Item Actions --\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"item.html?id\x3d${item.id}${telemetryParams:empty}" class\x3d"dropdown-link"\x3e${i18n.itemLinks.viewDetails}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.downloadUrl:empty}" class\x3d"dropdown-link if-pdf js-action" data-action\x3d"download"\x3e${i18n.itemLinks.open}\x3c/a\x3e\r\n    \x3cbutton role\x3d"menuitem" class\x3d"dropdown-link js-item-categorize if-allow-categorization"\x3e${i18n.items.categorize}\x3c/button\x3e\r\n\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.downloadUrl:empty}" class\x3d"dropdown-link if-file if-download js-action" data-action\x3d"download"\x3e${i18n.itemLinks.download}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.downloadUrl:empty}" class\x3d"dropdown-link if-explorer js-action" data-action\x3d"download"\x3e${i18n.itemLinks.openExplorer}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.downloadStyleUrl:empty}" class\x3d"dropdown-link if-resources"\x3e${i18n.itemLinks.downloadStyle}\x3c/a\x3e\r\n\r\n    \x3cdiv class\x3d"if-map-viewer-classic"\x3e\r\n      \x3cdiv class\x3d"if-map-viewer-beta"\x3e\r\n        \x3ca role\x3d"menuitem" href\x3d"${item.newMapViewerUrl:empty}" class\x3d"dropdown-link if-can-openInNewMapViewer"\x3e${i18n.itemLinks.openMapViewerBetaLabel}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"hide-if-no-legacy-viewer-support"\x3e\r\n        \x3ca role\x3d"menuitem" href\x3d"${item.mapViewerUrl:empty}" data-href\x3d"${item.mapViewerUrl:empty}" class\x3d"dropdown-link if-map if-featureCollection if-vectorTile if-2d if-table js-action" data-action\x3d"newMapViewer"\x3e${i18n.itemLinks.openMapViewer}\x3c/a\x3e\r\n        \x3ca role\x3d"menuitem" href\x3d"${item.mapNewViewerUrl:empty}" data-href\x3d"${item.mapNewViewerUrl:empty}" class\x3d"dropdown-link if-featureCollection if-vectorTile if-2d if-table js-action" data-action\x3d"newMapViewer"\x3e${i18n.itemLinks.addToNewViewer}\x3c/a\x3e\r\n        \x3ca role\x3d"menuitem" href\x3d"${item.mapViewerWithEditUrl:empty}" data-href\x3d"${item.mapViewerWithEditUrl:empty}" class\x3d"dropdown-link if-can-edit-service js-action" data-action\x3d"newMapViewer"\x3e${i18n.itemProperties.openViewerFullEditingRole}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"if-map-viewer-modern"\x3e\r\n      \x3cdiv class\x3d"if-map-viewer-beta"\x3e\r\n        \x3ca role\x3d"menuitem" href\x3d"${item.newMapViewerUrl:empty}" class\x3d"dropdown-link if-can-openInNewMapViewer"\x3e${i18n.itemLinks.openMapViewerBetaLabel}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"hide-if-no-legacy-viewer-support"\x3e\r\n        \x3ca role\x3d"menuitem" href\x3d"${item.mapViewerUrl:empty}" data-href\x3d"${item.mapViewerUrl:empty}" class\x3d"dropdown-link if-map if-featureCollection if-vectorTile if-2d if-table js-action" data-action\x3d"newMapViewer"\x3e${i18n.itemLinks.openMapViewer}\x3c/a\x3e\r\n        \x3ca role\x3d"menuitem" href\x3d"${item.mapViewerWithEditUrl:empty}" data-href\x3d"${item.mapViewerWithEditUrl:empty}" class\x3d"dropdown-link if-can-edit-service js-action" data-action\x3d"newMapViewer"\x3e${i18n.itemLinks.openMapViewerWithControl}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"if-geoBIM"\x3e\r\n      \x3ca role\x3d"menuitem" href\x3d"${item.geoBIMUrl:empty}" class\x3d"dropdown-link if-create-GeoBIM"\x3e${i18n.itemLinks.openGeoBIM}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.sceneViewerUrl:empty}" class\x3d"dropdown-link if-scene if-3d"\x3e${i18n.itemLinks.openSceneViewer}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.url:empty}" target\x3d"_blank" class\x3d"dropdown-link if-app"\x3e${i18n.itemLinks.viewApp}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.appViewerUrl:empty}" target\x3d"_blank" class\x3d"dropdown-link if-mobile"\x3e${i18n.itemLinks.getApp}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.appViewerUrl:empty}" target\x3d"_blank" class\x3d"dropdown-link if-link"\x3e${i18n.itemLinks.open}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.workforceViewerUrl:empty}" class\x3d"dropdown-link if-workforceProject-and-not-blocked"\x3e${i18n.itemLinks.openWorkforce}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.workflowViewerUrl:empty}"  class\x3d"dropdown-link if-workflow"\x3e${i18n.itemLinks.openWorkflow}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.surveyViewerUrl:empty}" class\x3d"dropdown-link if-surveyFormBrowser-and-not-blocked"\x3e${i18n.itemLinks.openSurveyBrowser}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.surveyAppUrl:empty}" class\x3d"dropdown-link if-surveyForm-and-not-blocked"\x3e${i18n.itemLinks.openSurveyApp}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.surveyManageUrl:empty}" class\x3d"dropdown-link if-can-edit-surveyForm js-open-surveyViewer "\x3e${i18n.itemLinks.manageSurveyApp}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.surveyEditUrl:empty}" class\x3d"dropdown-link if-can-edit-surveyForm js-open-surveyViewer "\x3e${i18n.itemLinks.editSurveyApp}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.insightsViewerUrl:empty}" class\x3d"dropdown-link if-insights-and-not-blocked"\x3e${i18n.itemLinks.openInsights}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.urbanViewerUrl:empty}" class\x3d"dropdown-link if-urbanModel"\x3e${i18n.itemLinks.openUrbanModel}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.orthoMakerUrl:empty}" class\x3d"dropdown-link if-orthoMaker"\x3e${i18n.itemLinks.openOrthoMaker}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.missionViewerUrl:empty}" class\x3d"dropdown-link if-mission"\x3e${i18n.itemLinks.openMission}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.geoAIStudioUrl:empty}" class\x3d"dropdown-link if-geoAIStudioProject"\x3e${i18n.itemLinks.openGeoAIStudio}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.hubInitiativeUrl:empty}" class\x3d"dropdown-link if-hubInitiative-and-not-blocked"\x3e${i18n.itemLinks.openHubInitiative}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.hubEventUrl:empty}" class\x3d"dropdown-link if-hubEvent-and-not-blocked"\x3e${i18n.itemLinks.viewInHub}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.hubProjectUrl:empty}" class\x3d"dropdown-link if-hubProject-and-not-blocked"\x3e${i18n.itemLinks.openHubInitiative}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.hubProjectEditUrl:empty}" class\x3d"dropdown-link if-hubProject-and-not-blocked"\x3e${i18n.itemLinks.editHubProject}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.iotViewerUrl:empty}" class\x3d"dropdown-link if-bigDataAnalytic if-realTimeAnalytic"\x3e${i18n.itemLinks.openAnalyticsIoT}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.iotFeedUrl:empty}" class\x3d"dropdown-link if-feedLayer"\x3e${i18n.itemLinks.openAnalyticsIoT}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.vrExperienceUrl:empty}" class\x3d"dropdown-link if-vrExperience-and-not-blocked js-hide-portal"\x3e${i18n.itemLinks.openVRExperience}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.cityEngineViewerUrl:empty}" class\x3d"dropdown-link if-city-engine"\x3e${i18n.itemLinks.viewApp}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.excaliburViewerUrl:empty}" class\x3d"dropdown-link if-excaliburProject"\x3e${i18n.itemLinks.openExcalibur}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.excaliburProjectUrl:empty}" class\x3d"dropdown-link if-excaliburProject"\x3e${i18n.itemLinks.viewExcaliburProject}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.excaliburMediaUrl:empty}" class\x3d"dropdown-link if-excaliburMedia"\x3e${i18n.itemLinks.openExcalibur}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.dashboardUrl:empty}" target\x3d"_blank" class\x3d"dropdown-link if-dashboard-and-not-blocked"\x3e${i18n.itemLinks.dashboardView}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.dashboardEditUrl:empty}" class\x3d"dropdown-link if-can-edit-dashboard"\x3e${i18n.itemLinks.dashboardEdit}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.fieldMapsUrl:empty}" class\x3d"dropdown-link if-fieldMaps"\x3e${i18n.itemLinks.fieldMaps}\x3c/a\x3e\r\n    \x3cdiv class\x3d"if-notebookServer-enabled"\x3e\r\n      \x3cspan class\x3d"if-can-create-notebooks"\x3e\r\n        \x3ca role\x3d"menuitem" href\x3d"${item.notebookViewerUrl:empty}" target\x3d"_blank" class\x3d"dropdown-link if-notebook"\x3e${i18n.itemLinks.openNotebook}\x3c/a\x3e\r\n      \x3c/span\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3c!-- Web Experience Actions ---\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.webExperienceUrl:empty}" class\x3d"dropdown-link if-published-webExperience-and-not-blocked" target\x3d"_blank" rel\x3d"noopener noreferrer"\x3e${i18n.itemLinks.view}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.webExperienceEditUrl:empty}" class\x3d"dropdown-link if-can-edit-webExperience"\x3e${i18n.common.edit}\x3c/a\x3e\r\n\r\n    \x3c!-- Web Experience Template Actions ---\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.webExperienceUrl:empty}" class\x3d"dropdown-link if-published-webExperienceTemplate-and-not-blocked"\x3e${i18n.itemLinks.view}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.webExperienceEditUrl:empty}" class\x3d"dropdown-link if-can-edit-webExperienceTemplate"\x3e${i18n.common.edit}\x3c/a\x3e\r\n    \x3cspan class\x3d"if-published-webExperienceTemplate-and-not-blocked"\x3e\r\n      \x3ca href\x3d"${item.webExperienceCreateUrl:empty}" class\x3d"dropdown-link if-can-create-webExperienceTemplate if-published-webExperienceTemplate-and-not-blocked if-no-public-user js-open-btn"\x3e${i18n.itemLinks.createWebExperience}\x3c/a\x3e\r\n    \x3c/span\x3e\r\n\r\n    \x3c!-- Secondary Item Actions --\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.wabEditUrl:empty}" class\x3d"dropdown-link if-can-edit-wab-and-not-blocked"\x3e${i18n.itemLinks.editApp}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.sceneViewerUrl:empty}" class\x3d"dropdown-link if-scene-2"\x3e${i18n.itemLinks.openSceneViewer}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.openDesktop:empty}" class\x3d"dropdown-link js-action if-desktop" data-action\x3d"openDesktop" data-type\x3d"arcmap"\x3e${i18n.itemLinks.openDesktop}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.openDesktop:empty}" class\x3d"dropdown-link js-action if-desktop if-desktopPro" data-action\x3d"openDesktop" data-type\x3d"arcmap"\x3e${i18n.itemLinks.openArcMap}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.openDesktop:empty}" class\x3d"dropdown-link js-action if-pro if-desktopPro" data-action\x3d"openDesktop" data-type\x3d"pro"\x3e${i18n.itemLinks.openPro}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.createPresentationUrl:empty}" class\x3d"dropdown-link if-no-presentation if-map"\x3e${i18n.siteHeader.createPresentation}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.openPresentationUrl:empty}" class\x3d"dropdown-link if-presentation"\x3e${i18n.siteHeader.viewPresentation}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.createPresentationUrl:empty}" class\x3d"dropdown-link if-create-presentation"\x3e${i18n.siteHeader.editPresentation}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.configureUrl:empty}" class\x3d"dropdown-link if-can-configure"\x3e${i18n.itemProperties.configureApp}\x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.viewStyleUrl:empty}" target\x3d"_blank" class\x3d"dropdown-link if-vectorTile if-viewStyle"\x3e${i18n.itemLinks.viewStyle}\x3c/a\x3e\r\n\r\n    \x3c!-- Storymap Actions --\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.configureStoryMapUrl:empty}" class\x3d"dropdown-link if-editable-storymap-and-not-blocked"\x3e\r\n      \x3cspan class\x3d"if-storymap-item"\x3e${i18n.itemLinks.editStorymap}\x3c/span\x3e\r\n      \x3cspan class\x3d"if-storymap-collection"\x3e${i18n.itemLinks.editStorymapCollection}\x3c/span\x3e\r\n    \x3c/a\x3e\r\n    \x3ca role\x3d"menuitem" href\x3d"${item.storyMapViewerUrl:empty}" class\x3d"dropdown-link if-published-storymap-and-not-blocked"\x3e\r\n      \x3cspan class\x3d"if-storymap-item"\x3e${i18n.itemLinks.viewStorymap}\x3c/span\x3e\r\n      \x3cspan class\x3d"if-storymap-collection"\x3e${i18n.itemLinks.viewStorymapCollection}\x3c/span\x3e\r\n    \x3c/a\x3e\r\n\r\n    \x3cdiv class\x3d"if-published-storymap-theme"\x3e\r\n      \x3ca\r\n        class\x3d"dropdown-link"\r\n        href\x3d"${item.newStoryMapFromThemeUrl:empty}"\r\n      \x3e\r\n        ${i18n.itemLinks.newStoryFromTheme}\r\n      \x3c/a\x3e\r\n      \x3ca role\x3d"menuitem" href\x3d"${item.newStoryMapCollectionFromThemeUrl:empty}" class\x3d"dropdown-link"\x3e\r\n        ${i18n.itemLinks.newCollectionFromTheme}\r\n      \x3c/a\x3e\r\n    \x3c/div\x3e\r\n    \x3ca\r\n      href\x3d"${item.configureStoryMapThemeUrl:empty}"\r\n      class\x3d"dropdown-link if-editable-storymap-theme"\r\n    \x3e\r\n      ${i18n.itemLinks.editStorymapTheme}\r\n    \x3c/a\x3e\r\n  \x3c/nav\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/Card/MinimalCard.html":'\x3cdiv class\x3d"js-card card ${selectCardClass} ${selectedClass} ${removedClass} ${imageClass} block trailer-1 position-relative" data-id\x3d"${item.id}" tabindex\x3d"0"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"dragHandle" class\x3d"card-drag-handle flex-center" tabindex\x3d"0"\x3e\r\n    ${!icons.drag.16}\r\n  \x3c/div\x3e\r\n  \x3ca data-dojo-attach-point\x3d"thumbLink" href\x3d"${item.defaultOpenUrl:empty}" class\x3d"card-image-wrap card-last js-default-open" aria-label\x3d"${!item.title}: ${item.defaultOpenText:empty}"\x3e\r\n    \x3cspan class\x3d"card-image-overlay no-pointer"\x3e\r\n      \x3cspan class\x3d"font-size--1 link-white text-center thumbnail-icon card-image-open"\x3e${!item.defaultOpenSvg:empty}${item.defaultOpenText:empty}\x3c/span\x3e\r\n    \x3c/span\x3e\r\n    \x3cimg class\x3d"card-image js-card-image no-pointer ${isImage:show}" src\x3d"${item.largeThumbnailUrl}" alt\x3d""\x3e\r\n    \x3cspan class\x3d"card-image-wrap__center-image ${isImage:hide}"\x3e\r\n      \x3cimg class\x3d"card-image js-card-image no-pointer" src\x3d"${item.largeThumbnailUrl}" alt\x3d""\x3e\r\n    \x3c/span\x3e\r\n  \x3c/a\x3e\r\n  \x3cdiv class\x3d"card-content card-content-no-padding"\x3e\r\n    \x3cdiv class\x3d"padding-leader-half padding-half padding-left-half padding-right-half card-content-auto-top"\x3e\r\n      \x3ch4 class\x3d"card-title font-size-0 leader-quarter trailer-quarter text-ellipsis avenir-bold"\x3e\x3ca data-dojo-attach-point\x3d"titleLink" class\x3d"card-title-link minimal-card__title-link display-block text-ellipsis" href\x3d"item.html?id\x3d${item.id}" title\x3d"${item.title}"\x3e${item.title}\x3c/a\x3e\x3c/h4\x3e\r\n      \x3cp class\x3d"font-size--2"\x3e${item.displayName:formatDisplayName}\x3c/p\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/CardMobile/CardMobile.html":'\x3ca href\x3d"item.html?id\x3d${item.id}" class\x3d"js-card block card card-mobile trailer-half" data-id\x3d"${item.id}"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"dragHandle" class\x3d"card-drag-handle flex-center tooltip" tabindex\x3d"0" title\x3d"${i18n.orgHomePageSetup.content.reorder}" aria-label\x3d"${i18n.orgHomePageSetup.content.reorder}"\x3e\r\n    ${!icons.drag.16}\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"card-content"\x3e\r\n    \x3ch4 class\x3d"trailer-0 font-size-1"\x3e${item.title}\x3c/h4\x3e\r\n    \x3cp class\x3d"font-size--2 trailer-half flex"\x3e\r\n      \x3cspan class\x3d"flex-0"\x3e\r\n        \x3cimg width\x3d"16" src\x3d"${item.svgIconUrl16}" alt\x3d"${item.sourceLabel}" class\x3d"icon-inline icon-inline--on-left"\x3e${item.displayName:formatDisplayName}\r\n      \x3c/span\x3e\r\n      \x3cspan class\x3d"margin-left-quarter margin-right-quarter flex-0"\x3e${i18n.itemProperties.by}\x3c/span\x3e\r\n      \x3cspan class\x3d"flex-1 text-ellipsis"\x3e${!item.ownerText}\x3c/span\x3e\r\n    \x3c/p\x3e\r\n    \x3cdiv class\x3d"clearfix"\x3e\r\n      \x3cspan class\x3d"left inline-block margin-right-1 margin-left-0 font-size--3 text-darker-gray"\x3e\r\n        \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 16 16" width\x3d"16" class\x3d"icon-inline icon-inline--on-left"\x3e\r\n          \x3cpath fill\x3d"currentColor" d\x3d"M8 7h3v1H7V3h1zm4.803 5.803a7.5 7.5 0 1 1 0-10.606 7.5 7.5 0 0 1 0 10.606zm-.636-9.97A6.591 6.591 0 0 0 .927 7H2v1H.927A6.567 6.567 0 0 0 7 14.073v-1.38h1v1.38a6.591 6.591 0 0 0 4.167-11.24z"/\x3e\r\n        \x3c/svg\x3e\r\n        ${item.modified:fullDate}\r\n      \x3c/span\x3e\r\n      \x3cdiv class\x3d"right inline-block card-badges js-card-badges"\x3e${!item.badges}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/a\x3e\r\n',
"url:arcgisonline/pages/dijit/CardWide/CardWide.html":'\x3cdiv\r\n  class\x3d"js-card block card ${selectCardClass} ${selectedClass} ${removedClass} ${imageClass} card-wide trailer-1"\r\n  data-id\x3d"${item.id}"\r\n\x3e\r\n  \x3clabel class\x3d"card-select-check-mark js-card-select-check-mark-wrap"\x3e\r\n    \x3cinput\r\n      type\x3d"checkbox"\r\n      class\x3d"checkbox-custom-input js-card-select-check-mark"\r\n      value\x3d"${item.id}"\r\n      aria-label\x3d"${selectItem}"\r\n      data-id\x3d"${item.id}"\r\n      ${checked}\r\n    /\x3e\r\n    \x3cspan class\x3d"checkbox-custom checkbox-custom--large checkbox-custom--on-dark"\x3e\r\n      \x3csvg viewBox\x3d"0 0 16 16" class\x3d"checkbox-custom-icon checkbox-custom-icon--checked"\x3e\r\n        \x3cpath d\x3d"M12.753 3l-7.319 7.497L3.252 8.31 2 9.373l3.434 3.434L14 4.24z" /\x3e\r\n      \x3c/svg\x3e\r\n      \x3csvg viewBox\x3d"0 0 16 16" class\x3d"checkbox-custom-icon checkbox-custom-icon--mixed"\x3e\r\n        \x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M4 7h8v2H4z" /\x3e\r\n      \x3c/svg\x3e\r\n    \x3c/span\x3e\r\n  \x3c/label\x3e\r\n  \x3ca\r\n    class\x3d"card-wide-image-wrap card-wide-image-wrap--static js-default-open"\r\n    href\x3d"${item.defaultOpenUrl:empty}"\r\n    aria-label\x3d"${!item.title}: ${item.defaultOpenText:empty}"\r\n  \x3e\r\n    \x3cspan class\x3d"card-image-overlay no-pointer"\x3e\r\n      \x3cspan class\x3d"font-size--1 text-center thumbnail-icon"\r\n        \x3e${!item.defaultOpenSvg:empty}${item.defaultOpenText:empty}\x3c/span\r\n      \x3e\r\n    \x3c/span\x3e\r\n    \x3cimg class\x3d"card-image--static js-card-image no-pointer" src\x3d"${item.largeThumbnailUrl}" alt\x3d"" /\x3e\r\n  \x3c/a\x3e\r\n  \x3cdiv class\x3d"card-content card-content-no-padding card-content--static"\x3e\r\n    \x3cdiv class\x3d"padding-left-half padding-right-half padding-leader-half card-last"\x3e\r\n      \x3ch4 class\x3d"trailer-quarter font-size-1"\x3e\r\n        \x3ca class\x3d"card-title-link js-card-title-link" href\x3d"item.html?id\x3d${item.id}"\x3e${!item.title}\x3c/a\x3e\r\n      \x3c/h4\x3e\r\n      \x3cdiv class\x3d"js-layers-tables font-size--2"\x3e\x3c/div\x3e\r\n      \x3cp class\x3d"font-size--2 trailer-half flex ${hasSublayers:show}"\x3e\r\n        \x3cspan class\x3d"js-layers-tables-toggle"\x3e\r\n          \x3cspan class\x3d"flex-0 ${showSource:show}"\x3e\x3cimg width\x3d"16" src\x3d"${item.svgIconUrl16}" alt\x3d"${item.sourceLabel}" class\x3d"icon-inline icon-inline--on-left"\x3e${item.displayName:formatDisplayName}\x3c/span\x3e\r\n          \x3cspan class\x3d"flex-0 ${showSource:hide} tooltip tooltip--data" data-tooltip\x3d"${item.sourceLabel}"\x3e\x3cimg width\x3d"16" src\x3d"${item.svgIconUrl16}" alt\x3d"${item.sourceLabel}" class\x3d"icon-inline icon-inline--on-left"\x3e${item.displayName:formatDisplayName}\x3c/span\x3e\r\n        \x3c/span\x3e\r\n      \x3c/p\x3e\r\n      \x3cp class\x3d"font-size--2 trailer-half leader-quarter"\x3e${item.snippet}\x3c/p\x3e\r\n      \x3cp class\x3d"font-size--3 trailer-half leader-quarter text-darker-gray"\x3e\r\n        \x3cspan\r\n          class\x3d"inline-block margin-right-1 card-created"\r\n          title\x3d"${i18n.contentPage.createdLabel} ${item.created:completeDate}"\r\n          \x3e${i18n.contentPage.created} ${item.created:fullDate}\x3c/span\r\n        \x3e\r\n        \x3cspan\r\n          class\x3d"inline-block margin-right-1"\r\n          title\x3d"${i18n.itemProperties.lastModified} ${item.modified:completeDate}"\r\n          \x3e${i18n.contentPage.modified} ${item.modified:fullDate}\x3c/span\r\n        \x3e\r\n        \x3cspan class\x3d"inline-block margin-right-1"\x3e${item:formatViewsLabel} ${item.numViews:formatNumViews}\x3c/span\x3e\r\n      \x3c/p\x3e\r\n      \x3cdiv class\x3d"js-sublayers"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"flex-1 card-badges js-card-badges trailer-half"\x3e${!item.badges}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"card-action-bar flex flex-center clearfix"\x3e\r\n      \x3cdiv class\x3d"flex-1"\x3e\r\n        \x3cspan class\x3d"js-card-owner-text flex-1 text-ellipsis"\x3e${!item.ownerText}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"flex-0 flex flex-center card-actions"\x3e\r\n        \x3cspan class\x3d"js-share-summary"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"js-favorites-container inline-block"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"js-open-dropdown-container inline-block dropdown-up"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/TableRow/templates/TableRow.html":'\x3cdiv class\x3d"table-select-row ${activeRow} ${removedRow}" role\x3d"row"\x3e\r\n  \x3clabel class\x3d"table-select-cell table-select-checkbox ${selectClass}" role\x3d"cell"\x3e\r\n    \x3cinput type\x3d"checkbox" class\x3d"js-table-select-checkbox" aria-label\x3d"${i18n.GroupWidget.selectItem}" ${checked}\x3e\r\n  \x3c/label\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-extra-wide" role\x3d"cell"\x3e\r\n    \x3cspan class\x3d"flex"\x3e\r\n      \x3cspan class\x3d"table-select-title flex flex-1"\x3e\r\n        \x3ca href\x3d"./item.html?id\x3d${item.id}" class\x3d"flex-1 overflow-hidden"\x3e${!item.title}\x3c/a\x3e\r\n      \x3c/span\x3e\r\n      \x3cspan class\x3d"padding-left-half padding-right-half table-select-item-type full-width"\x3e\r\n        \x3cspan class\x3d"flex-1"\x3e\r\n          \x3cspan class\x3d"js-layers-tables"\x3e\x3c/span\x3e\r\n          \x3cspan class\x3d"js-layers-tables-toggle display-block text-ellipsis" title\x3d"${item.displayName:formatDisplayName}"\x3e\r\n            \x3cimg src\x3d"${item.svgIconUrl16}" width\x3d"16" height\x3d"16" alt\x3d"${item.displayName}" class\x3d"icon-inline icon-inline--on-left"\x3e\r\n            \x3cspan class\x3d"margin-left-quarter"\x3e${item.displayName:formatDisplayName}\x3c/span\x3e\r\n          \x3c/span\x3e\r\n        \x3c/span\x3e\r\n        \x3cspan class\x3d"table-select-item-type--badges"\x3e${!item.badges}\x3c/span\x3e\r\n      \x3c/span\x3e\r\n      \x3cspan class\x3d"js-share-summary"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"js-favorites-container inline-block"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"js-open-dropdown-container ${dropdownClass}"\x3e\x3c/span\x3e\r\n    \x3c/span\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell" role\x3d"cell" title\x3d"${i18n.itemProperties.lastModified} ${item.modified:completeDate}"\x3e${item.modified:fullDate}\x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell" role\x3d"cell"\x3e${!item.ownerText}\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/View/templates/tableHeader.html":'\x3cdiv class\x3d"table-select-row table-select-row-header" role\x3d"row"\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-checkbox ${selectClass}"  role\x3d"columnheader"\x3e\r\n    \x3clabel class\x3d"table-select-cell-sort table-select-check-all"\x3e\r\n      \x3cinput type\x3d"checkbox" aria-label\x3d"${i18n.filters.selectAll}" class\x3d"js-select-all"\x3e\r\n    \x3c/label\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"title" data-sort-order\x3d"asc"\x3e${i18n.filters.titleHeader}\x3c/button\x3e\x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-cell-medium" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"modified" data-sort-order\x3d"desc"\x3e${i18n.filters.modifiedHeader}\x3c/button\x3e\x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-cell-medium" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"owner" data-sort-order\x3d"asc"\x3e${i18n.filters.owner}\x3c/button\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/View/templates/empty.html":'\x3cdiv class\x3d"js-empty-view text-center"\x3e\r\n    \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 256 256" width\x3d"256"\x3e\x3cpath fill\x3d"#ccc" d\x3d"M149.375 182.444l56.463-56.471-25.376-25.376 5.523-14.541-59.827-22.726L110.828 48H56v124h18.365l12.437 4.724 34.182 34.101 15.33-15.294 7.07 2.686 5.164-13.597zm50.806-56.472l-47.34 47.35 26.064-68.626zM112 54.828L141.172 84H112zM60 52h48v36h36v80H60zm60.984 153.17L95.95 180.199l36.263 13.775zm20.081-12.113L85.632 172H148V85.172L133.059 70.23l47.766 18.144-34.628 91.171z"/\x3e\x3c/svg\x3e\r\n    \x3ch3\x3e${i18n.GroupWidget.noItemsYet}\x3c/h3\x3e\r\n    \x3cp class\x3d"font-size--2 text-constrain margin-auto"\x3e${i18n.GroupWidget.noItemsYetExplanation}\x3c/p\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/View/templates/none.html":'\x3cdiv class\x3d"text-center leader-1 text-constrain margin-auto"\x3e${i18n.GroupWidget.noItems}\x3c/div\x3e',"url:arcgisonline/pages/dijit/View/templates/View.html":'\x3cdiv\x3e\r\n  \x3c!-- Table View --\x3e\r\n  \x3cdiv class\x3d"hide content-table-view js-table-wrap table-select js-view" role\x3d"table"\x3e\r\n    \x3cdiv class\x3d"table-select-head js-table-header" role\x3d"rowgroup"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"table-select-rows js-table-rows js-view" role\x3d"rowgroup"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3c!-- Grid View --\x3e\r\n  \x3cdiv\r\n    class\x3d"hide content-grid-view block-group block-group-4-up laptop-block-group-3-up tablet-block-group-2-up phone-block-group-1-up js-grid-wrap js-view"\r\n  \x3e\x3c/div\x3e\r\n\r\n  \x3c!-- Mobile View --\x3e\r\n  \x3cdiv class\x3d"hide content-mobile-view block-group block-group-1-up js-mobile-wrap js-view"\x3e\x3c/div\x3e\r\n\r\n  \x3c!-- List View --\x3e\r\n  \x3cdiv class\x3d"hide content-list_view block-group block-group-1-up js-list-wrap js-view"\x3e\x3c/div\x3e\r\n\r\n  \x3c!-- Empty View (no results) --\x3e\r\n  \x3cdiv class\x3d"hide js-empty-wrap js-view"\x3e\x3c/div\x3e\r\n\r\n  \x3c!-- None View (tabula rasa) --\x3e\r\n  \x3cdiv class\x3d"hide js-none-wrap js-view"\x3e\x3c/div\x3e\r\n\r\n  \x3c!-- Loader --\x3e\r\n  \x3cdiv class\x3d"hide js-loader-wrap js-view"\x3e\x3c/div\x3e\r\n\r\n  \x3c!-- Gallery Grid View --\x3e\r\n  \x3cdiv\r\n    class\x3d"hide block-group block-group-4-up laptop-block-group-3-up tablet-block-group-2-up phone-block-group-1-up gallery-card-wrap js-gallery-wrap js-view"\r\n  \x3e\x3c/div\x3e\r\n\r\n  \x3c!-- Gallery List View --\x3e\r\n  \x3cdiv class\x3d"hide block-group block-group-1-up  gallery-list-wrap js-gallery-list-wrap js-view"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"hide js-search-feedback"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/DomainOverlay/templates/DomainOverlay.html":'\x3cdiv class\x3d"grid-container"\x3e\r\n  \x3cdiv class\x3d"loader loader-domains is-active hide"\x3e\r\n    \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"loader-text"\x3e${i18n.common.loading}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"js-domain-wrapper"\x3e\r\n    \x3cdiv class\x3d"column-16 pre-1 leader-1 trailer-1"\x3e\r\n      \x3cform action\x3d"" class\x3d"js-manage-domain-form" data-edit-id\x3d"manageDomainForm"\x3e\r\n        \x3cdiv class\x3d"js-coded-value"\x3e\r\n          \x3c!-- hidden button needed, so on "Enter" new entry is added --\x3e\r\n          \x3cbutton class\x3d"hide js-btn-add-coded-value"\x3e${i18n.domainOverlay.codedValueAddMore}\x3c/button\x3e\r\n          \x3clabel class\x3d"label-coded-value-description"\x3e${i18n.domainOverlay.codedValueDescription}\x3c/label\x3e\r\n          \x3clabel class\x3d"label-coded-value-code"\x3e${i18n.domainOverlay.codedValueCode}\x3c/label\x3e\r\n          \x3cdiv class\x3d"js-manage-domain-coded-value"\x3e\x3c/div\x3e\r\n          \x3cbutton class\x3d"js-btn-add-coded-value btn-add-coded-value btn-link btn-link-darker-gray"\x3e${icons.inline.plus.16}${i18n.domainOverlay.codedValueAddMore}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"js-coded-range hide" value\x3d"actualRangeValues"\x3e\r\n          \x3cdiv class\x3d"flex phone-flex-column"\x3e\r\n            \x3cdiv class\x3d"flex-1 margin-right-2 full-width js-coded-range-input-wrap"\x3e\r\n              \x3clabel class\x3d"js-range-min trailer-quarter" for\x3d"domain-range-min"\x3e${i18n.domainOverlay.rangeMin}\x3c/label\x3e\r\n              \x3cinput id\x3d"domain-range-min" type\x3d"text" class\x3d"inline-block js-template-range-key input-template-range-key" name\x3d"rangeMinimum"\x3e\r\n              \x3cdiv class\x3d"js-domain-range-error input-error-message"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"flex-1 margin-right-2 full-width phone-leader-1 js-coded-range-input-wrap"\x3e\r\n              \x3clabel class\x3d"js-range-max trailer-quarter" for\x3d"domain-range-max"\x3e${i18n.domainOverlay.rangeMax}\x3c/label\x3e\r\n              \x3cinput id\x3d"domain-range-max" type\x3d"text" class\x3d"inline-block js-template-range-value input-template-range-value" name\x3d"rangeMaximum"\x3e\r\n              \x3cdiv class\x3d"js-domain-range-error input-error-message"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"js-domain-validation-message alert alert-red"\x3e\r\n          ${i18n.domainOverlay.errors.defaultValidationFailed}\r\n          \x3cbutton class\x3d"alert-close js-domain-validation-close btn-link btn-link-black"\x3e${icons.x.24}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n      \x3c/form\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"column-6 leader-1 padding-leader-half js-category-edit-explanation"\x3e\r\n      \x3clabel class\x3d\'js-domain-explanation\'\x3e\x3c/label\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/DomainOverlay/templates/CodedValueTemplate.html":'\x3cdiv class\x3d"template-div js-template-div ${id} flex"\x3e\r\n  \x3cdiv class\x3d"inline-block input-template-code-value"\x3e\r\n    \x3cinput type\x3d"text" name\x3d"${id}" class\x3d"js-template-code-value" placeholder\x3d"${i18n.domainOverlay.codedValueValuePlaceholder}" value\x3d"${codedValues.name}"\x3e\r\n    \x3cdiv class\x3d"js-domain-coded-error-value input-error-message input-value-error-message"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv  class\x3d"inline-block input-template-code-key"\x3e\r\n    \x3cinput type\x3d"text" name\x3d"${id}" class\x3d"js-template-code-key" placeholder\x3d"${i18n.domainOverlay.codedValueKeyPlaceholder}" value\x3d"${codedValues.code}"\x3e\r\n    \x3cdiv class\x3d"js-domain-coded-error input-error-message input-key-error-message"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e  \r\n  \x3cbutton class\x3d"tooltip tooltip-right coded-value-delete-item inline-block js-template-delete button${id}" name\x3d"${id}" aria-label\x3d"${i18n.domainOverlay.codedValueDelete}"\x3e\r\n    \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 16 16" width\x3d"16" height\x3d"16"\x3e\x3cpath fill\x3d"#de2900" d\x3d"M2 4l1 12h9l1-12zm9.08 11H3.92L3.087 5h8.826zM5 6.4a.46.46 0 0 1 .5-.4.46.46 0 0 1 .5.4v7.2a.46.46 0 0 1-.5.4.46.46 0 0 1-.5-.4zm2 0a.46.46 0 0 1 .5-.4.46.46 0 0 1 .5.4v7.2a.46.46 0 0 1-.5.4.46.46 0 0 1-.5-.4zm2 0a.512.512 0 0 1 1 0v7.2a.512.512 0 0 1-1 0zM11 2V0H4v2H1v1h13V2zm-1 0H5V1h5z"/\x3e\x3c/svg\x3e\r\n  \x3c/button\x3e\r\n  \x3cmark class\x3d"label inline-block modifier-class js-template-code-count label-template-code-count"\x3e${codedValues.count}\x3c/mark\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/dijit/DomainOverlay/templates/_generateOrDelete.html":'\x3cnav class\x3d"leader-quarter left margin-left-1"\x3e\r\n  \x3cbutton class\x3d"js-domain-generate-button btn"\x3e${i18n.domainOverlay.generateDefault}\x3c/button\x3e\r\n  \x3cbutton class\x3d"js-domain-delete-button btn btn-red"\x3e${i18n.domainOverlay.deleteDefault}\x3c/button\x3e\r\n\x3c/nav\x3e',"url:arcgisonline/pages/dijit/AttributeFieldDetails/templates/AttributeFieldDetails.html":'\x3cdiv class\x3d"js-attributes-details trailer-half"\x3e\r\n\r\n  \x3c!-- display name - label --\x3e\r\n  \x3cdiv class\x3d"field-details-header flex"\x3e\r\n    \x3cdiv class\x3d"flex-1 padding-leader-half padding-left-1 padding-trailer-half"\x3e\r\n      \x3cdiv class\x3d"js-attribute-title-edit"\x3e\r\n        \x3c!-- Container for title InlineEdit --\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cbutton class\x3d"js-close-attribute-details flex-0 btn btn-transparent focus-inset btn-link-black right"\x3e${!icons.x.32}\x3c/button\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3caside class\x3d"flex tablet-flex-column padding-trailer-1 padding-leader-1"\x3e\r\n    \x3cdiv class\x3d"flex-1 padding-left-1 padding-right-1"\x3e\r\n      \x3cdiv class\x3d"js-description-section"\x3e\r\n        \x3c!-- Container for description InlineEdit --\x3e\r\n        \x3ch3 class\x3d"leader-0"\x3e\r\n          ${i18n.attributeFieldDetails.description}\r\n        \x3c/h3\x3e\r\n        \x3cp class\x3d"trailer-half break-word"\x3e\r\n          \x3cspan class\x3d"js-view js-fieldDescription break-word"\x3e\x3c/span\x3e\r\n          \x3cspan class\x3d"js-noFieldDescription text-darker-gray trailer-half"\x3e\r\n            \x3cspan\x3e${i18n.itemProperties.summaryUnavailable}\x3c/span\x3e\r\n            \x3c!-- \x3ca href\x3d"#" class\x3d"js-inline-edit field-admin-owner-view" data-edit-id\x3d"description"\x3e${i18n.itemProperties.noSummary}\x3c/a\x3e --\x3e\r\n          \x3c/span\x3e\r\n        \x3c/p\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"js-fieldValueType-section"\x3e\r\n        \x3c!-- Container for fieldValueType InlineEdit --\x3e\r\n        \x3ch3 class\x3d"leader-half" data-dojo-attach-point\x3d"fieldValueTypeText"\x3e\x3c/h3\x3e\r\n        \x3cp class\x3d"trailer-half break-word"\x3e\r\n          \x3cspan class\x3d"js-view js-fieldValueType break-word"\x3e\x3c/span\x3e\r\n          \x3cspan class\x3d"js-noFieldValueType text-darker-gray trailer-half"\x3e\r\n            \x3cspan\x3e${i18n.attributeFieldDetails.contentUnavailable}\x3c/span\x3e\r\n            \x3c!-- \x3ca href\x3d"#" class\x3d"js-inline-edit field-admin-owner-view" data-edit-id\x3d"contentType"\x3e${i18n.attributeFieldDetails.contentUnavailable}\x3c/a\x3e --\x3e\r\n          \x3c/span\x3e\r\n        \x3c/p\x3e\r\n      \x3c/div\x3e\r\n      \x3ch3 class\x3d"trailer-half"\x3e${i18n.attributeFieldDetails.serviceSettings}\x3c/h3\x3e\r\n      \x3ctable class\x3d"feature-service-settings-table table"\x3e\r\n        \x3c!-- nullable --\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e${i18n.attributeFieldDetails.nullable}\x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel class\x3d\'label-settings-text\' data-dojo-attach-point\x3d"serviceNullable"\x3e\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3c!-- editable --\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e${i18n.attributeFieldDetails.editable}\x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel class\x3d\'label-settings-text\' data-dojo-attach-point\x3d"fieldEditable"\x3e\x3c/label\x3e\r\n            \x3cbutton class\x3d\'js-old-inline-edit btn-inline-edit btn-link btn-link-darker-gray font-size--3 right field-admin-owner-view js-portal-view\'\r\n              data-edit-id\x3d"fieldEditable"\x3e${!icons.inline.edit.16}${i18n.common.edit}\x3c/button\x3e\r\n          \x3c/td\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"js-inline-edit-form hide" data-edit-id\x3d"fieldEditable"\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3cform action\x3d"" class\x3d"js-inline-edit-form js-editable-form form-index" data-edit-id\x3d"fieldEditable"\x3e\r\n              \x3cfieldset class\x3d"fieldset-checkbox-index"\x3e\r\n                \x3clabel for\x3d"service-editable-checkbox-input" \x3e\r\n                  \x3cinput  id\x3d"service-editable-checkbox-input" type\x3d"checkbox" class\x3d"js-fieldEditable-input" name\x3d"fieldEditable" data-dojo-attach-point\x3d"fieldEditableEdit"\x3e\r\n                  \x3cb\x3e${i18n.attributeFieldDetails.allowAttributeEditing}\x3c/b\x3e\x3cbr /\x3e\r\n                \x3c/label\x3e\r\n              \x3c/fieldset\x3e\r\n              \x3cdiv class\x3d"text-right"\x3e\r\n                \x3cbutton class\x3d"btn js-editable-form-submit" disabled\x3e${i18n.common.save}\x3c/button\x3e\r\n                \x3cbutton class\x3d"js-cancel-inline-edit btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n              \x3c/div\x3e\r\n            \x3c/form\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3c!-- default value --\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e${i18n.attributeFieldDetails.defaultValue}\x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel class\x3d\'label-settings-text\' data-dojo-attach-point\x3d"serviceDefaultValue"\x3e\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3c!-- Length --\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e${i18n.attributeFieldDetails.length}\x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel class\x3d\'label-settings-text\' data-dojo-attach-point\x3d"serviceLength"\x3e\x3c/label\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n\r\n        \x3c!-- range, min max --\x3e\r\n        \x3ctr class\x3d"js-range-field-details hide"\x3e\r\n          \x3ctd\x3e${i18n.attributeFieldDetails.rangeMinMax}\x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel class\x3d\'label-settings-text\' data-dojo-attach-point\x3d"rangeMinMax"\x3e\x3c/label\x3e\r\n            \x3cbutton class\x3d\'js-range-domain-edit btn-inline-edit btn-link btn-link-darker-gray font-size--3 right field-admin-owner-view field-view\'\r\n              data-edit-id\x3d"rangeMinMax"\x3e${!icons.inline.edit.16}${i18n.common.edit}\x3c/button\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n\r\n        \x3c!-- Unique Index --\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e${i18n.attributeFieldDetails.unique}\x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3clabel class\x3d\'label-settings-text\' data-dojo-attach-point\x3d"serviceIndex"\x3e\x3c/label\x3e\r\n            \x3cbutton class\x3d\'js-old-inline-edit btn-inline-edit btn-link btn-link-darker-gray font-size--3 right field-admin-owner-view field-view\'\r\n              data-edit-id\x3d"serviceIndex"\x3e${!icons.inline.edit.16}${i18n.common.edit}\x3c/button\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"js-inline-edit-form hide" data-edit-id\x3d"serviceIndex"\x3e\r\n          \x3ctd colspan\x3d"2"\x3e\r\n            \x3cform action\x3d"" class\x3d"js-inline-edit-form js-index-form form-index" data-edit-id\x3d"serviceIndex"\x3e\r\n              \x3cfieldset class\x3d"fieldset-checkbox-index"\x3e\r\n                \x3clabel for\x3d"service-index-checkbox-input" \x3e\r\n                  \x3cinput  id\x3d"service-index-checkbox-input" type\x3d"checkbox" class\x3d"js-serviceIndex-input" name\x3d"serviceIndex" data-dojo-attach-point\x3d"serviceIndexEdit"\x3e\r\n                  \x3cb\x3e${i18n.itemProperties.uniqueCheckbox}\x3c/b\x3e\x3cbr /\x3e\r\n                  \x3cp\x3e${i18n.itemProperties.uniqueCheckboxMessage}\x3c/p\x3e\r\n                \x3c/label\x3e\r\n              \x3c/fieldset\x3e\r\n              \x3cdiv class\x3d"text-right"\x3e\r\n                \x3cbutton class\x3d"btn js-index-form-submit" disabled\x3e${i18n.common.save}\x3c/button\x3e\r\n                \x3cbutton class\x3d"js-cancel-inline-edit btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n              \x3c/div\x3e\r\n            \x3c/form\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n\r\n      \x3c/table\x3e\r\n\r\n      \x3c!-- coded value table --\x3e\r\n      \x3cdiv class\x3d"js-coded-value-field-details hide"\x3e\r\n        \x3ch3 class\x3d"domain-settings-text" data-dojo-attach-point\x3d"codedValueDomainText"\x3e\x3c/h3\x3e\r\n        \x3cdiv class\x3d"btn-domain-group right"\x3e\r\n          \x3cbutton class\x3d\'js-domain-edit btn-link btn-link-darker-gray font-size--3 field-admin-owner-view field-view\'\x3e${!icons.inline.edit.16}${i18n.common.edit}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n        \x3ctable class\x3d"table table-coded-value"\x3e\r\n          \x3ctbody class\x3d"js-coded-value-table"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"flex-0 padding-left-1 padding-right-1"\x3e\r\n      \x3cbutton class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear js-domain-btn field-admin-owner-view field-view hide"\x3e${i18n.attributeFieldDetails.createDomains}\x3c/button\x3e\r\n      \x3cbutton class\x3d"text-ellipsis trailer-half btn btn-fill btn-red js-delete-btn field-admin-owner-view field-view"\x3e${i18n.attributeFieldDetails.delete}\x3c/button\x3e\r\n      \x3csection\x3e\r\n        \x3ch3\x3e${i18n.attributeFieldDetails.details}\x3c/h3\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--1"\x3e\x3cspan\x3e${i18n.attributeFieldDetails.detailsType}\x3c/span\x3e\x3cspan\r\n            data-dojo-attach-point\x3d"detailsType"\x3e\x3c/span\x3e\x3c/p\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--1"\x3e\x3cspan\x3e${i18n.attributeFieldDetails.detailsName}\x3c/span\x3e\x3cspan\r\n            data-dojo-attach-point\x3d"detailsName"\x3e\x3c/span\x3e\x3c/p\x3e\r\n        \x3cp class\x3d"js-details-properties hide trailer-0 font-size--1"\x3e\x3cspan\x3e${i18n.attributeFieldDetails.properties}\x3c/span\x3e\x3cspan\r\n            data-dojo-attach-point\x3d"detailsProperties"\x3e\x3c/span\x3e\r\n            \x3cspan class\x3d"tooltip tooltip-multiline tooltip-left" aria-label\x3d"" data-dojo-attach-point\x3d"detailsPropertiesInfo"\x3e\r\n              \x3ci class\x3d"icon-ui-notice-round font-size--1"\x3e\x3c/i\x3e\x3c/span\x3e\r\n        \x3c/p\x3e\r\n        \x3cbutton class\x3d"js-details-properties js-details-reset-btn hide btn btn-link btn-small"\x3e${i18n.attributeFieldDetails.resetToSource}\x3c/button\x3e\r\n      \x3c/section\x3e\r\n    \x3c/div\x3e\r\n  \x3c/aside\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/AttributesView/templates/attributeCard.html":'\x3cdiv class\x3d"panel panel-white block card card-mobile trailer-half ${selectCardClass} ${selectedClass} ${removedClass}"\r\n  data-id\x3d"${item.name}"\x3e\r\n  \x3cdiv class\x3d"flex"\x3e\r\n    \x3cdiv class\x3d"flex-0 margin-right-half leader-quarter"\x3e\r\n      \x3clabel class\x3d"tooltip trailer-0" data-dojo-attach-point\x3d"_checkboxWrap" aria-label\x3d"${selectItem}"\x3e\r\n        \x3cinput type\x3d"checkbox" class\x3d"checkbox-custom-input" value\x3d"${item.name}" data-id\x3d"${item.name}"\r\n          data-dojo-attach-point\x3d"_checkboxBtn" ${checked}\x3d""\x3e\r\n        \x3cspan class\x3d"checkbox-custom checkbox-custom--large"\x3e\r\n          \x3csvg viewBox\x3d"0 0 16 16" class\x3d"checkbox-custom-icon checkbox-custom-icon--checked"\x3e\r\n            \x3cpath d\x3d"M12.753 3l-7.319 7.497L3.252 8.31 2 9.373l3.434 3.434L14 4.24z"\x3e\x3c/path\x3e\r\n          \x3c/svg\x3e\r\n          \x3csvg viewBox\x3d"0 0 16 16" class\x3d"checkbox-custom-icon checkbox-custom-icon--mixed"\x3e\r\n            \x3cpath fill-rule\x3d"evenodd" clip-rule\x3d"evenodd" d\x3d"M4 7h8v2H4z"\x3e\x3c/path\x3e\r\n          \x3c/svg\x3e\r\n        \x3c/span\x3e\r\n      \x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"flex-1 margin-right-1"\x3e\r\n      \x3cdiv class\x3d"flex"\x3e\r\n        \x3cdiv class\x3d"flex-1"\x3e\r\n          \x3ch4 class\x3d"trailer-quarter"\x3e\r\n            \x3cbutton class\x3d"btn btn-large btn-link js-field-name-card text-left table-select-cell-wrap"\r\n              fieldname\x3d"${item.name}" ${item.disabled}\x3d""\x3e${item.alias}\x3c/button\x3e\r\n          \x3c/h4\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"flex-0 leader-quarter"\x3e\r\n          \x3cp class\x3d"font-size--3 margin-right-half" style\x3d"display: inline-flex"\x3e${item.name}\x3c/p\x3e\r\n          \x3cmark class\x3d"label margin-right-half" data-dojo-attach-point\x3d"_fieldValueType"\x3e\x3c/mark\x3e\r\n          \x3cmark class\x3d"label"\x3e${item.fieldType}\x3c/mark\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv\x3e\r\n        \x3cp class\x3d"trailer-0 font-size--2"\x3e${item.description.value}\x3c/p\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/AttributesView/templates/_attributesViewActions.html":'\x3cbutton data-action\x3d"addField" class\x3d"icon-ui-plus btn btn-fill btn-clear btn-small js-add-field-btn"\x3e\r\n  ${i18n.attributesView.addFieldButtonText}\r\n\x3c/button\x3e\r\n',"url:arcgisonline/pages/item/widgets/AttributesView/templates/_attributesView.html":'\x3cdiv class\x3d"js-attributes-view"\x3e\r\n  \x3cdiv class\x3d"js-field-search-bar"\x3e\r\n    \x3cdiv class\x3d"js-control-bar"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3csection class\x3d"grid-container padding-trailer-2"\x3e\r\n    \x3cdiv class\x3d"column-24 flex js-field-main-body"\x3e\r\n      \x3c!-- Left Side --\x3e\r\n      \x3cdiv class\x3d"js-filter-wrap"\x3e\r\n        \x3ch4 class\x3d"trailer-half font-size--1 avenir-demi tablet-hide"\x3e${i18n.GroupWidget.filters}\x3c/h4\x3e\r\n        \x3c!-- Filters --\x3e\r\n        \x3cdiv class\x3d"js-filters"\x3e\r\n          \x3cdiv class\x3d"accordion filters--accordion js-accordion"\x3e\r\n            \x3c!-- Field type --\x3e\r\n            \x3csection class\x3d"accordion-section is-active"\x3e\r\n              \x3ch4 class\x3d"accordion-title filters--accordion--title"\x3e${!icons.chevron-down.16}${i18n.attributesView.fieldType}\x3c/h4\x3e\r\n              \x3cdiv class\x3d"accordion-content filters--accordion--content"\x3e\r\n                \x3cdiv class\x3d"js-filter-field-type"\x3e\x3c/div\x3e\r\n              \x3c/div\x3e              \r\n            \x3c/section\x3e\r\n             \x3c!-- Field value type --\x3e\r\n             \x3csection class\x3d"accordion-section"\x3e\r\n                \x3ch4 class\x3d"accordion-title filters--accordion--title"\x3e${!icons.chevron-down.16}${i18n.attributesView.fieldValueType}\x3c/h4\x3e\r\n                \x3cdiv class\x3d"accordion-content filters--accordion--content"\x3e\r\n                  \x3cdiv class\x3d"js-filter-field-value-type"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e              \r\n              \x3c/section\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3c!-- Main --\x3e\r\n      \x3cmain class\x3d"view-wrap js-view-wrap"\x3e\r\n\r\n        \x3c!-- Hide if items are selected --\x3e\r\n        \x3cdiv class\x3d"clearfix padding-trailer-quarter hide-if-selected flex break-word" data-dojo-attach-point\x3d"statusBar"\x3e\r\n          \x3cdiv class\x3d"font-size--1 inline-block flex-1 flex flex-align-center filter-status-wrap"\x3e\r\n            \x3cspan class\x3d"padding-right-1 padding-leader-quarter padding-trailer-quarter font-size--2 flex-0 nowrap"\x3e\r\n                \x3cspan data-dojo-attach-point\x3d"_totalFields"\x3e\x3c/span\x3e\r\n            \x3c/span\x3e\r\n            \x3c!-- Filter Status --\x3e\r\n            \x3cdiv class\x3d"inline-block js-filter-status"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Show if fields are selected --\x3e\r\n        \x3cdiv class\x3d"clearfix padding-trailer-half show-if-selected hide" data-dojo-attach-point\x3d"selectedWrap"\x3e\r\n          \x3cspan class\x3d"label label-green margin-right-1"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"selectedCount"\x3e0\x3c/span\x3e${i18n.attributesView.selected}\x3c/span\x3e\r\n          \x3cbutton class\x3d"js-deselect btn-link btn-link-black"\x3e${i18n.attributesView.clearSelection}\x3c/button\x3e\r\n          \x3cnav class\x3d"right"\x3e\r\n            \x3c!-- \x3cbutton data-action\x3d"groupFields"\r\n                class\x3d"btn-link btn-link-darker-gray margin-right-1 icon-ui-group font-size--2 js-action-groupFields"\r\n                data-dojo-attach-point\x3d"_groupFields"\x3eGroup\x3c/button\x3e\r\n            \x3cbutton data-action\x3d"summarizeFields"\r\n                class\x3d"btn-link btn-link-darker-gray margin-right-1 icon-ui-collection font-size--2 js-action-summarizeFields"\r\n                data-dojo-attach-point\x3d"_summarizeFields"\x3eSummarize\x3c/button\x3e --\x3e\r\n            \x3cbutton data-action\x3d"deleteFields"\r\n                class\x3d"btn-link btn-link-black margin-right-1 font-size--2 js-delete-multiple-fields"\r\n                data-dojo-attach-point\x3d"_deleteFields"\x3e${!icons.inline.trash.16}${i18n.attributesView.deleteFieldButtonText}\x3c/button\x3e\r\n          \x3c/nav\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- populated by View component --\x3e\r\n        \x3cdiv class\x3d"js-views"\x3e\x3c/div\x3e\r\n\r\n      \x3c/main\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3c!-- attributes details --\x3e\r\n    \x3cdiv class\x3d"clearfix leader-1 panel-white flex js-attributes-details-info hide"\x3e\r\n      \x3cdiv class\x3d"js-attribute-field-only div-attribute-field-only flex-0 overflow-auto"\x3e\r\n        \x3cdiv class\x3d"div-search-border"\x3e\r\n          \x3cinput type\x3d"search" class\x3d"js-field-only-search filters--accordion--input" placeholder\x3d"${i18n.attributesView.searchPlaceholder}" aria-label\x3d"${i18n.attributesView.searchPlaceholder}"\x3e\r\n        \x3c/div\x3e\r\n        \x3ctable class\x3d"js-attribute-field-only-table table table-plain"\x3e\r\n          \x3ctbody class\x3d"js-attributes-details-body table-attributes-details-body"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"js-attribute-field-details div-attribute-field-details flex-1 overflow-auto"\x3e\r\n        \x3cdiv class\x3d"js-attributes-details"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/section\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/AttributesView/templates/tableHead.html":'\x3cdiv class\x3d"table-select-row table-select-row-header" role\x3d"row"\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-checkbox field-admin-owner-view field-view" role\x3d"columnheader"\x3e\r\n    \x3clabel class\x3d"table-select-cell-sort table-select-check-all"\x3e\r\n      \x3cinput type\x3d"checkbox" aria-label\x3d"Select all" class\x3d"js-select-all"\x3e\r\n    \x3c/label\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"fieldAlias" data-sort-order\x3d"asc"\x3e${i18n.attributesView.fieldAlias}\x3c/button\x3e\x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"fieldName" data-sort-order\x3d"asc"\x3e${i18n.attributesView.fieldName}\x3c/button\x3e\x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th" role\x3d"columnheader"\x3e\x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" data-sort\x3d"fieldType" data-sort-order\x3d"asc"\x3e${i18n.attributesView.fieldType}\x3c/button\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/AttributesView/templates/tableRow.html":'\x3cdiv class\x3d"table-select-row flex table-select-row-avatar ${activeRow}" role\x3d"row"\x3e\r\n  \x3clabel class\x3d"table-select-cell table-select-checkbox flex-0 field-admin-owner-view field-view ${selectClass}" role\x3d"cell"\x3e\r\n    \x3cinput type\x3d"checkbox" aria-label\x3d"${i18n.filters.selectPage}" class\x3d"js-table-select-checkbox" data-username\x3d"${item.name}" ${checked}\x3e\r\n  \x3c/label\x3e\r\n  \x3cspan class\x3d"table-select-cell flex-1" role\x3d"cell"\x3e\x3cbutton class\x3d\'btn btn-transparent btn-small js-field-name text-left btn-field-name table-select-cell-wrap\' fieldName\x3d"${item.name}" ${item.disabled}\x3e${item.alias}\x3c/button\x3e\x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell flex-1" role\x3d"cell"\x3e${item.name}\x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell flex-1" role\x3d"cell"\x3e${item.fieldType}\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/AttributesView/templates/empty.html":'\x3cdiv class\x3d"js-empty-view text-center"\x3e\r\n  \x3ch3\x3e${i18n.attributesView.emptyText}\x3c/h3\x3e\r\n\x3c/div\x3e',"url:arcgisonline/pages/item/widgets/AttributesView/templates/none.html":'\x3cdiv class\x3d"text-center leader-1 text-constrain margin-auto"\x3e${i18n.attributesView.noneText}\x3c/div\x3e',"url:arcgisonline/pages/dijit/ArcadeCalculatorDlg/templates/ArcadeCalculatorDlg.html":'\x3cdiv class\x3d"${baseClass} arcadeCalculator-wrapper"\x3e\r\n  \x3cdiv class\x3d"js-arcade-calculatorDlg arcade-calculator-modal"\x3e\r\n    \x3cdiv class\x3d"arcade-calculator-modal-content"\x3e\r\n      \x3ciframe\r\n        data-dojo-attach-point\x3d"expressionEditor"\r\n        style\x3d"border:none;width:100%;height:100%;visibility:hidden;"\r\n      \x3e\x3c/iframe\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"js-arcade-statusDlg arcade-status hide"\x3e\r\n    \x3csection class\x3d"arcade-status__section font-size--1 padding-leader-2"\x3e\r\n      \x3ch5 class\x3d"padding-leader-half trailer-half"\x3e${i18n.arcadeCalculatorDlg.calculatingRecords}\x3c/h5\x3e\r\n      \x3cdiv class\x3d"progress-bar arcade-status__progress-bar"\x3e\r\n        \x3cdiv\r\n          class\x3d"progress-bar-fill progress-bar-fill--blue"\r\n          data-dojo-attach-point\x3d"progressBar"\r\n          style\x3d"width: 0%"\r\n        \x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cp class\x3d"progress-bar__counts font-size--3 leading-quarter trailer-half hide js-progress-bar-counts"\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"completedRecords"\x3e${i18n.arcadeCalculatorDlg.zero}\x3c/span\x3e /\r\n        \x3cspan data-dojo-attach-point\x3d"totalRecords"\x3e${i18n.arcadeCalculatorDlg.zero}\x3c/span\x3e\r\n      \x3c/p\x3e\r\n    \x3c/section\x3e\r\n    \x3cdiv class\x3d"js-show-error arcade-status__section--centered leader-1 hide"\x3e\r\n      \x3cdiv class\x3d"arcade-status__error trailer-1"\x3e\r\n        \x3ch4\r\n          class\x3d"font-size--1 arcade-status-error__heading trailer-0"\r\n          data-dojo-attach-point\x3d"reviewErrorHeading"\r\n        \x3e\x3c/h4\x3e\r\n        \x3cdiv class\x3d"arcade-status-error__body"\x3e\r\n          \x3cdiv class\x3d"arcade-status-error__body-cell"\x3e\r\n            \x3ch5\r\n              class\x3d"arcade-status-error-cell__heading trailer-0 text-dark-gray font-size--2"\r\n              data-dojo-attach-point\x3d"reviewErrorFid"\r\n            \x3e\r\n              ${i18n.arcadeCalculatorDlg.displayCalculatedValue}\r\n            \x3c/h5\x3e\r\n            \x3cp class\x3d"arcade-status-error-cell__body trailer-0 leader-0 text-black"\x3e\r\n              \x3cb data-dojo-attach-point\x3d"reviewErrorFidValue"\x3e\x3c/b\x3e\r\n            \x3c/p\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"arcade-status-error__body-cell"\x3e\r\n            \x3ch5 class\x3d"arcade-status-error-cell__heading trailer-0 text-dark-gray font-size--2"\x3e\r\n              ${i18n.arcadeCalculatorDlg.displayCalculatedValue}\r\n            \x3c/h5\x3e\r\n            \x3cp class\x3d"arcade-status-error-cell__body trailer-0 leader-0 text-black"\x3e\r\n              \x3cb data-dojo-attach-point\x3d"reviewErrorValue"\x3e\x3c/b\x3e\r\n            \x3c/p\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cp class\x3d"arcade-status__message font-size-0"\x3e\r\n        ${i18n.arcadeCalculatorDlg.reviewExplainText}\r\n      \x3c/p\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"arcade-status__footer"\x3e\r\n      \x3cbutton class\x3d"btn calcite blue js-review-button arcade-review-button hide"\x3e\r\n        ${i18n.arcadeCalculatorDlg.reviewButton}\r\n      \x3c/button\x3e\r\n      \x3cbutton class\x3d"btn calcite btn-clear js-cancel-button arcade-cancel-button"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!-- Loader --\x3e\r\n  \x3cdiv class\x3d"loader loader-arcadeCalculator throb-loading is-active hide padding-leader-3 padding-trailer-3"\x3e\r\n    \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"loader-text throb-loading-text"\x3e${i18n.arcadeCalculatorDlg.defaultLoading}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/CalculateWithOptionsDlg/templates/CalculateWithOptionsDlg.html":'\x3cdiv class\x3d"${baseClass} calculateWithOptions-wrapper"\x3e\r\n  \x3cp class\x3d"trailer-half font-size--1 text-darker-gray"\x3e${i18n.calculateSQLArcadeDlg.whatLanguage}\x3c/p\x3e\r\n\r\n  \x3cdiv class\x3d"calculate-with-options block-group block-group-2-up trailer-half"\x3e\r\n\r\n    \x3cdiv class\x3d"card block"\x3e\r\n\r\n      \x3cdiv class\x3d"card-content calculate-with-options__card-content"\x3e\r\n\r\n        \x3ch4 class\x3d"trailer-half padding-trailer-quarter calculate-option__header"\x3e${i18n.calculateSQLArcadeDlg.arcade}\r\n        \x3c/h4\x3e\r\n        \x3cp class\x3d"trailer-quarter"\x3e${i18n.calculateSQLArcadeDlg.idealFor}\x3c/p\x3e\r\n\r\n        \x3cul\x3e\r\n          \x3cli\x3e${i18n.calculateSQLArcadeDlg.arcadePart1}\x3c/li\x3e\r\n          \x3cli\x3e${i18n.calculateSQLArcadeDlg.arcadePart2}\x3c/li\x3e\r\n        \x3c/ul\x3e\r\n\r\n        \x3cdiv class\x3d"calculate-option__card-footer"\x3e\r\n          \x3ca class\x3d"btn calcite blue btn-half calculate-option__button js-arcade-button"\x3e${i18n.calculateSQLArcadeDlg.arcade}\x3c/a\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"panel panel-arcade-disabled js-panel-arcade-disabled modifier-class hide"\x3e\r\n        \x3cp class\x3d"trailer-0 text-darker-gray js-disabled-text"\x3e${i18n.calculateSQLArcadeDlg.arcadeDisabledInfo}\r\n          \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"arcadeDisabledHelpUrl"\x3e${i18n.addItemFrm.learnMore}\x3c/a\x3e\r\n        \x3c/p\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"card block"\x3e\r\n\r\n      \x3cdiv class\x3d"card-content calculate-with-options__card-content"\x3e\r\n        \x3ch4 class\x3d"trailer-half padding-trailer-quarter calculate-option__header"\x3e${i18n.calculateSQLArcadeDlg.sql}\x3c/h4\x3e\r\n        \x3cp class\x3d"trailer-quarter"\x3e${i18n.calculateSQLArcadeDlg.idealFor}\x3c/p\x3e\r\n\r\n        \x3cul\x3e\r\n          \x3cli\x3e${i18n.calculateSQLArcadeDlg.sqlPart1}\x3c/li\x3e\r\n          \x3cli\x3e${i18n.calculateSQLArcadeDlg.sqlPart2}\x3c/li\x3e\r\n          \x3cli\x3e${i18n.calculateSQLArcadeDlg.sqlPart3}\x3c/li\x3e\r\n        \x3c/ul\x3e\r\n\r\n        \x3cdiv class\x3d"calculate-option__card-footer"\x3e\r\n          \x3ca class\x3d"btn calcite blue btn-half calculate-option__button js-sql-button"\x3e${i18n.calculateSQLArcadeDlg.sql}\x3c/a\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"calculate-with-options__footer"\x3e\r\n\r\n    \x3ca target\x3d"_blank"\r\n      data-dojo-attach-point\x3d"docUrl"\r\n      class\x3d"font-size--1"\x3e${i18n.addItemFrm.learnMore}\r\n      ${!icons.inline-end.launch.16}\r\n    \x3c/a\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/TableAddFieldDlg.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${_css.container}" data-dojo-type\x3d"dijit/Dialog" data-dojo-attach-point\x3d"_dialog" data-dojo-props\x3d"title:\'${i18n.addFieldTitle}\'"\x3e\r\n      \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"_addForm"\x3e\r\n       \x3ctable class\x3d"${_css.table}" data-dojo-attach-point\x3d"_addTable" style\x3d"border-collapse:collapse;border-spacing:5px;" cellpadding\x3d"5px" cellspacing\x3d"5px"\x3e\r\n         \x3ctbody\x3e\r\n          \x3ctr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel\x3e${i18n.nameLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n              \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" class\x3d"${_css.leadingMargin1}" data-dojo-props\x3d"required:true" data-dojo-attach-point\x3d"_nameInput" value\x3d""\x3e\x3c/input\x3e\r\n             \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel\x3e${i18n.aliasLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" class\x3d"${_css.leadingMargin1}" data-dojo-attach-point\x3d"_aliasInput" value\x3d""\x3e\x3c/input\x3e\r\n             \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n           \x3ctr\x3e\r\n            \x3ctd\x3e\r\n              \x3clabel\x3e${i18n.typeLabel}\x3c/label\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n              \x3cselect class\x3d"${_css.typeSelect} ${_css.leadingMargin1} ${_css.longInput} ${_css.longLabel}" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"_typeSelect" data-dojo-attach-event\x3d"onChange:_handleTypeChange" data-dojo-props\x3d"value:\'esriFieldTypeString\'"\x3e\r\n                \x3coption value\x3d"esriFieldTypeDate"\x3e${i18n.dateLabel}\x3c/option\x3e\r\n                \x3coption value\x3d"esriFieldTypeDouble"\x3e${i18n.doubleLabel}\x3c/option\x3e\r\n                \x3coption value\x3d"esriFieldTypeInteger"\x3e${i18n.integerLabel}\x3c/option\x3e\r\n                \x3coption value\x3d"esriFieldTypeString"\x3e${i18n.stringLabel}\x3c/option\x3e\r\n              \x3c/select\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n            \x3ctr data-dojo-attach-point\x3d"_lengthRow"\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel data-dojo-attach-point\x3d"_lengthLabel"\x3e${i18n.lengthLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" class\x3d"${_css.leadingMargin1}" data-dojo-attach-point\x3d"_lengthInput" data-dojo-props\x3d"value:256" /\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"${_css.defaultLabelContainer}"\x3e\x3clabel data-dojo-attach-point\x3d"_defaultLabel"\x3e${i18n.defaultValueLabel}\x3c/label\x3e\x3c/div\x3e\r\n                \x3cdiv class\x3d"${_css.optionLabelContainer} defaultValOptional" id\x3d"defaultValOptional"\x3e\x3clabel data-dojo-attach-point\x3d"_optionLabel"\x3e${i18n.optional}\x3c/label\x3e\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" class\x3d"${_css.leadingMargin1}" data-dojo-props\x3d"required:false" data-dojo-attach-point\x3d"_defaultStrInput" /\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" class\x3d"${_css.leadingMargin1}" required\x3d"false" data-dojo-props\x3d"constraints:{places:0}" data-dojo-attach-point\x3d"_defaultNumInput" /\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" class\x3d"${_css.leadingMargin1}" required\x3d"false" data-dojo-attach-point\x3d"_defaultDblInput" /\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/DateTextBox" class\x3d"${_css.leadingMargin1}" required\x3d"false" data-dojo-attach-point\x3d"_defaultDateInput" /\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/TimeTextBox" class\x3d"${_css.leadingMargin1}" required\x3d"false" data-dojo-attach-point\x3d"_defaultTimeInput" /\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \r\n            \x3ctr id\x3d"nullableRow" class\x3d"nullable-row"\x3e\r\n              \x3ctd\x3e\r\n                \x3clabel data-dojo-attach-point\x3d"_lengthLabel"\x3e${i18n.nullableLabel}\x3c/label\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"${_css.leadingMargin1}"\x3e\r\n                  \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"_nullable" checked /\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n         \x3c/table\x3e\r\n         \x3cdiv class\x3d"${_css.buttonContainer} ${_css.trailing}"\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"${_css.button}" data-dojo-attach-point\x3d"_addBtn" data-dojo-attach-event\x3d"onClick:_handleAddButtonClick"\x3e${i18n.addNewField}\x3c/div\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/form/Button" class\x3d"${_css.closeButton}" data-dojo-attach-point\x3d"_cancelBtn" data-dojo-attach-event\x3d"onClick:_handleCancelButtonClick"\x3e${i18n.cancel}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/item/widgets/templates/_data.html":'\x3cmain class\x3d"flex-column flex-1 ie9-height-100 trailer-half"\x3e\r\n  \x3cdiv class\x3d"padding-leader-half padding-trailer-half clearfix panel-white"\x3e\r\n    \x3cdiv class\x3d"overflow-auto grid-container"\x3e\r\n      \x3cdiv class\x3d"column-16 tablet-column-6 phone-trailer-half flex"\x3e\r\n        \x3cdiv class\x3d"js-featureLayers hide flex-0 margin-right-2"\x3e\r\n          \x3clabel class\x3d"if-layers trailer-0 layer-drop-down"\x3e\r\n            \x3cspan class\x3d"inline-block padding-right-1"\x3e${i18n.openMapDlg.layerLabel}\x3c/span\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"layerSelect" class\x3d"inline-block leader-0"\x3e\x3c/select\x3e\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3clabel class\x3d"js-subtype-group-layers trailer-0 layer-drop-down hide column-16 tablet-column-6 phone-trailer-half"\x3e\r\n          \x3cspan class\x3d"js-subtype-group-layers-label inline-block padding-right-1"\x3e${i18n.itemProperties.assetGroup}\x3c/span\x3e\r\n          \x3cselect class\x3d"js-subtype-group-layers-select inline-block leader-0"\x3e\x3c/select\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"column-8 tablet-column-6 right"\x3e\r\n        \x3cfieldset class\x3d"radio-group trailer-0 js-data-attributes margin-right-quarter right"\x3e\r\n          \x3cinput\r\n            class\x3d"radio-group-input js-data-aspect js-dataView"\r\n            value\x3d"data"\r\n            type\x3d"radio"\r\n            id\x3d"attributeData"\r\n            name\x3d"data_aspect"\r\n            checked\r\n          /\x3e\r\n          \x3clabel class\x3d"radio-group-label trailer-0 leader-0" for\x3d"attributeData"\r\n            \x3e${i18n.itemProperties.attributeDataTab}\x3c/label\r\n          \x3e\r\n          \x3cinput\r\n            class\x3d"radio-group-input js-data-aspect js-attributesView"\r\n            value\x3d"attributes"\r\n            type\x3d"radio"\r\n            id\x3d"attributeFields"\r\n            name\x3d"data_aspect"\r\n          /\x3e\r\n          \x3clabel class\x3d"radio-group-label trailer-0 leader-0" for\x3d"attributeFields"\r\n            \x3e${i18n.itemProperties.attributeFieldsTab}\x3c/label\r\n          \x3e\r\n        \x3c/fieldset\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"grid-container leader-quarter js-feature-table"\x3e\r\n    \x3cdiv class\x3d"left leader-quarter if-can-edit-service js-feature-table"\x3e${i18n.itemProperties.dataTabHelpMsg}\x3c/div\x3e\r\n    \x3cdiv class\x3d"right leader-quarter js-dataUpdatedLast right text-right hide js-feature-table"\x3e\x3c/div\x3e\r\n    \x3c!--\x3cdiv class\x3d"js-hide-on-error column-8 action-bar action-bar-right if-can-update"\x3e--\x3e\r\n    \x3c!--\x3ca data-dojo-attach-point\x3d"saveBtn" href\x3d"" class\x3d"btn action-bar-btn right btn-disabled"\x3e${i18n.common.save}\x3c/a\x3e--\x3e\r\n    \x3c!--\x3c/div\x3e--\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv\r\n    class\x3d"grid-container leader-half flex-1 position-relative ie9-height-90 flex js-feature-table"\r\n    id\x3d"main-content-area"\r\n  \x3e\r\n    \x3cdiv class\x3d"column-24 hide"\x3e\r\n      \x3ch4 data-dojo-attach-point\x3d"fieldViewTopTitleTablet" class\x3d"field-view-title"\x3e\x3c/h4\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"wrapper" class\x3d"flex-1 position-relative ie9-height-90 js-feature-table"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"fieldViewTop" class\x3d"column-19 field-view-top right hide"\x3e\r\n        \x3cdiv class\x3d"field-view-top-title-container"\x3e\r\n          \x3ch4 data-dojo-attach-point\x3d"fieldViewTopTitle" class\x3d"field-view-top-title left"\x3e\x3c/h4\x3e\r\n          \x3c!-- \x3cbutton data-dojo-attach-point\x3d"fieldViewTopTitleEditBtn" class\x3d"field-view-top-title-edit-btn btn-link btn-link-darker-gray icon-ui-edit if-can-update"\x3eEdit\x3c/button\x3e --\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv\r\n          data-dojo-attach-point\x3d"fieldViewTopCloseBtn"\r\n          class\x3d"field-view-top-close-btn right padding-right-half padding-left-half"\r\n          tabindex\x3d"0"\r\n        \x3e\r\n          ${!icons.x.24}\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3caside data-dojo-attach-point\x3d"fieldViewContainer" class\x3d"column-19 right field-view-container hide tablet-hide"\x3e\r\n        \x3cdiv class\x3d"column-14 padding-left-1 field-view-content"\x3e\r\n          \x3ch5\x3e${i18n.itemProperties.summary}\x3c/h5\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"fieldViewSummaryContainer" class\x3d"field-view-summary-container"\x3e\x3c/div\x3e\r\n          \x3ch5\x3e${i18n.itemProperties.settings}\x3c/h5\x3e\r\n          \x3ctable class\x3d"settingsTable table"\x3e\x3c/table\x3e\r\n          \x3cform class\x3d"index-form hide"\x3e\r\n            \x3cfieldset class\x3d"fieldset-checkbox"\x3e\r\n              \x3clabel for\x3d"item-properties-unique-input"\x3e\r\n                \x3cinput id\x3d"item-properties-unique-input" type\x3d"checkbox" class\x3d"unique-index-checkbox" /\x3e \x3cb\x3e${i18n.itemProperties.uniqueCheckbox}\x3c/b\r\n                \x3e\x3cbr /\x3e\r\n                \x3cp\x3e${i18n.itemProperties.uniqueCheckboxMessage}\x3c/p\x3e\r\n              \x3c/label\x3e\r\n            \x3c/fieldset\x3e\r\n            \x3cdiv class\x3d"text-right"\x3e\r\n              \x3cbutton class\x3d"btn index-form-submit" disabled\x3d"true"\x3e${i18n.common.save}\x3c/button\x3e\r\n              \x3cbutton class\x3d"cancel-index-form btn btn-clear btn-two"\x3e${i18n.common.cancel}\x3c/button\x3e\r\n            \x3c/div\x3e\r\n          \x3c/form\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"column-5 padding-left-1 field-view-side"\x3e\r\n          \x3ca\r\n            data-dojo-attach-point\x3d"calculateFieldButton"\r\n            class\x3d"text-ellipsis trailer-half btn btn-fill btn-clear js-open-btn hide"\r\n            \x3e${i18n.itemProperties.calculateField}\x3c/a\r\n          \x3e\r\n          \x3ca\r\n            data-dojo-attach-point\x3d"deleteFieldButton"\r\n            class\x3d"text-ellipsis trailer-half btn btn-fill btn-red js-open-btn trailer-2 hide"\r\n            \x3e${i18n.itemProperties.deleteField}\x3c/a\r\n          \x3e\r\n          \x3csection class\x3d"column-5"\x3e\r\n            \x3ch5\x3e${i18n.itemProperties.details}\x3c/h5\x3e\r\n            \x3cp class\x3d"trailer-0 font-size--1"\x3e\r\n              \x3cspan\x3e${i18n.itemProperties.detailType} \x3c/span\x3e\x3cspan data-dojo-attach-point\x3d"fieldViewFieldType"\x3e\x3c/span\x3e\r\n            \x3c/p\x3e\r\n            \x3cp class\x3d"font-size--1"\x3e\r\n              \x3cspan\x3e${i18n.itemProperties.detailName} \x3c/span\x3e\x3cspan data-dojo-attach-point\x3d"fieldViewFieldName"\x3e\x3c/span\x3e\r\n            \x3c/p\x3e\r\n          \x3c/section\x3e\r\n        \x3c/div\x3e\r\n      \x3c/aside\x3e\r\n      \x3cdiv id\x3d"grid"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!-- attributes view --\x3e\r\n  \x3cdiv class\x3d"clearfix padding-trailer-2 js-attributes-view"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"alert alert-red js-data-error leader-4 margin-auto"\x3e\r\n    ${i18n.common.errors.genericError.message}\r\n  \x3c/div\x3e\r\n\x3c/main\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_usage.html":'\x3cmain class\x3d"${baseClass} grid-container"\x3e\r\n    \x3cdiv class\x3d"column-24 padding-leader-2" id\x3d"main-content-area"\x3e\r\n        \x3cdiv class\x3d"flex panel panel-white"\x3e\r\n            \x3cdiv class\x3d"flex-1"\x3e\r\n                \x3ch3 id\x3d"uTitle" class\x3d"trailer-0 avenir-regular"\x3e\x26nbsp;\x3c/h3\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"leader-1 flex-0"\x3e\r\n                \x3cselect id\x3d"${id}-dateSelect" name\x3d"dateSelect" class\x3d"right" aria-label\x3d"${custDateRngTitle}"\x3e\r\n                    \x3coption id\x3d"last24Hours" value\x3d"last24Hours"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"last7Days" value\x3d"last7Days"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"last14Days" value\x3d"last14Days"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"last30Days" value\x3d"last30Days"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"last45Days" value\x3d"last45Days"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"last60Days" value\x3d"last60Days"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"last6Months" value\x3d"last6Months"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"last12Months" value\x3d"last12Months"\x3e\x3c/option\x3e\r\n                    \x3coption id\x3d"dsCustomRng" value\x3d"dsCustomRng"\x3e\x3c/option\x3e\r\n                \x3c/select\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"column-24"\x3e\r\n        \x3cdiv id\x3d"datePickerDiv" class\x3d"datePickerDiv overflow-hidden panel panel-white" tabindex\x3d"0"\x3e\r\n            \x3ch4 class\x3d"trailer-half text-center avenir-regular leader-1"\x3e${custDateRngTitle}\x3c/h4\x3e\r\n            \x3cdiv class\x3d"flex flex-justify-center phone-flex-column"\x3e\r\n                \x3clabel for\x3d"dsStart" class\x3d"trailer-0 margin-right-1 phone-trailer-1"\x3e${dateFromLbl}\r\n                    \x3cinput id\x3d"dsStart" /\x3e\r\n                \x3c/label\x3e\r\n                \x3clabel for\x3d"dsEnd" class\x3d"trailer-0 margin-right-1 phone-trailer-1"\x3e${dateToLbl}\r\n                    \x3cinput id\x3d"dsEnd"  /\x3e\r\n                \x3c/label\x3e\r\n                \x3cdiv class\x3d"margin-auto-top"\x3e\r\n                    \x3cbutton class\x3d"btn flex-0" data-dojo-attach-point\x3d"qDateRngBtn"\x3e${qDateLbl}\x3c/button\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"column-24"\x3e\r\n        \x3cdiv id\x3d"customDateErrorDiv" class\x3d"alert alert-red leader-half trailer-half margin-auto"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"column-24"\x3e\r\n        \x3cdiv class\x3d"panel panel-white"\x3e\r\n            \x3cdiv class\x3d"flex phone-flex-column clearfix"\x3e\r\n                \x3cdiv class\x3d"flex-1 ie9-half text-center text-darkest-gray"\x3e\r\n                    \x3ch4 id\x3d"totReqCountLbl" class\x3d"trailer-half avenir-regular font-size-0"\x3e${totReqCountTitle}\x3c/h4\x3e\r\n                    \x3cp id\x3d"totReqCountVal" class\x3d"trailer-0 avenir-regular font-size-4 text-green js-total-requests"\x3e${totReqCountVal}\x3c/p\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"flex-1 ie9-half text-center text-darkest-gray phone-leader-1"\x3e\r\n                    \x3ch4 id\x3d"avgCountPerDayLbl" class\x3d"trailer-half avenir-regular font-size-0"\x3e${avgCountPerDayTitle}\x3c/h4\x3e\r\n                    \x3cp id\x3d"avgCountPerDayVal" class\x3d"trailer-0 avenir-regular font-size-4 text-green js-average-requests"\x3e${avgCountPerDayVal}\x3c/p\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"flex-1 ie9-half text-center phone-leader-1 hide" id\x3d"creditsUsedLbl"\x3e\r\n                    \x3ch4 class\x3d"trailer-half avenir-regular font-size-0 text-darkest-gray"\x3e${creditsUsedTitle}\x3c/h4\x3e\r\n                    \x3cp id\x3d"creditsUsedVal" class\x3d"trailer-0 avenir-regular font-size-4 text-green js-average-bandwidth"\x3e${creditsUsedVal}\x3c/p\x3e\r\n                \x3c/div\x3e\r\n\r\n              \x3cdiv class\x3d"flex-1 ie9-half text-center phone-leader-1 hide" id\x3d"loginsValLbl"\x3e\r\n                \x3ch4 class\x3d"trailer-half avenir-regular font-size-0 text-darkest-gray"\x3e${loginsTitle}\x3c/h4\x3e\r\n                \x3cp id\x3d"loginsVal" class\x3d"trailer-0 avenir-regular font-size-4 text-green js-average-bandwidth"\x3e${loginsVal}\x3c/p\x3e\r\n              \x3c/div\x3e\r\n\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"column-24"\x3e\r\n        \x3cdiv class\x3d"panel panel-white"\x3e\r\n            \x3ch4 id\x3d"countChartTitle" class\x3d"avenir-regular"\x3e${countChartTitle}\x3c/h4\x3e\r\n            \x3cdiv id\x3d"cntChartDiv" class\x3d"js-requests-chart ct-double-octave hide" tabindex\x3d"0" style\x3d"max-height: 350px; min-height: 315px;"\x3e\x3c/div\x3e\r\n            \x3cdiv id\x3d"cntChartEmptyDiv" class\x3d"hide" style\x3d"max-height: 350px; min-height: 315px;"\x3e\x3c/div\x3e\r\n            \x3cdiv id\x3d"chartLoaderDiv" class\x3d"loader-bars leader-3 trailer-3" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n            \x3cp id\x3d"tzMsg" class\x3d"font-size--3 text-center"\x3e\x3c/p\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n\x3c/main\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_usage-empty.html":'\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 256 256" width\x3d"256"\x3e\x3cpath fill\x3d"#e0e0e0" class\x3d"cls-1" d\x3d"M56 200.105h148v4H56V216h-4v-12H40v-4h12V68h4zM156 216h4v-8h-4zm32 0h4v-8h-4zm-64 0h4v-8h-4zm-32 0h4v-8h-4zm-44-56h-8v4h8zm0-40h-8v4h8zm0-40h-8v4h8zm18.084 81.5H65v-4h2.116l25.255 13.966 32.95-48.532 26.032 13.616a8.598 8.598 0 1 1-1.748 3.601l-22.978-12.02-32.998 48.602zM153.4 142a4.6 4.6 0 1 0 4.6-4.6 4.605 4.605 0 0 0-4.6 4.6zm51.414-77.05l-3.509-1.92-4.058 7.416 3.508 1.92zM188.58 94.617l-3.51-1.92-4.058 7.417 3.509 1.92zm8.117-14.834l-3.509-1.92-4.059 7.417 3.51 1.92zm-24.352 44.503l-3.51-1.92-4.058 7.417 3.51 1.92zm8.117-14.835l-3.509-1.92-4.058 7.418 3.508 1.92z"/\x3e\x3c/svg\x3e',
"url:arcgisonline/pages/item/widgets/templates/_preview.html":'\x3cmain class\x3d"grid-container leader-1 notebook-preview-container"\x3e\r\n  \x3cdiv class\x3d"loader padding-leader-3 padding-trailer-3" data-dojo-attach-point\x3d"loader"\x3e\r\n    \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"loader-text"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"flex-center"\x3e\r\n    \x3cdiv class\x3d"column-12 alert alert-red alert-inline break-word leader-2 trailer-2" data-dojo-attach-point\x3d"error"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ciframe\r\n    frameborder\x3d"0"\r\n    id\x3d"notebook-preview-iframe"\r\n    data-dojo-attach-point\x3d"notebookFrame"\r\n    sandbox\x3d"allow-same-origin"\r\n    scrolling\x3d"no"\r\n  \x3e\x3c/iframe\x3e\r\n\x3c/main\x3e\r\n',
"url:arcgisonline/pages/dijit/Pagination/templates/Number.html":'\x3cli\x3e\x3ca href\x3d"#" class\x3d"js-btn btn btn-small pagination-btn ${is-active}" data-page\x3d"${pageNum}" aria-label\x3d"${label}" ${current}\x3e${pageNum}\x3c/a\x3e\x3c/li\x3e\r\n',"url:arcgisonline/pages/dijit/Pagination/templates/Ellipsis.html":'\x3cli\x3e\x3cspan class\x3d"avenir-light text-light-gray btn-small pagination-btn--inactive"\x3e${pageNum}\x3c/span\x3e\x3c/li\x3e\r\n',"url:arcgisonline/pages/dijit/Pagination/templates/Pagination.html":'\x3cdiv class\x3d"text-center trailer-1 padding-leader-1" data-dojo-attach-point\x3d"pagination"\x3e\r\n  \x3cdiv class\x3d"alert alert-yellow margin-auto trailer-1 js-over-limit"\x3e${i18n.contentPage.errors.overItemLimit}\x3c/div\x3e\r\n  \x3cdiv class\x3d"flex phone-flex-column"\x3e\r\n    \x3cdiv class\x3d"flex-1"\x3e\r\n      \x3cnav class\x3d"pagination margin-auto" data-dojo-attach-point\x3d"navigation" role\x3d"navigation" aria-label\x3d"${i18n.contentPage.paginationLabel}"\x3e\r\n          \x3ca href\x3d"#" aria-label\x3d"${i18n.contentPage.paginationPrevious}" class\x3d"js-btn-previous js-btn pagination-btn btn btn-small btn-transparent btn-disabled" data-dojo-attach-point\x3d"previous"\x3e${i18n.common.previous}\x3c/a\x3e\r\n          \x3cspan class\x3d"js-pagination-links pagination-links" data-dojo-attach-point\x3d"pageLinks"\x3e\x3c/span\x3e\r\n          \x3ca href\x3d"#" aria-label\x3d"${i18n.contentPage.paginationNext}" class\x3d"js-btn-next js-btn pagination-btn btn btn-small btn-transparent btn-disabled" data-dojo-attach-point\x3d"next"\x3e${i18n.common.next}\x3c/a\x3e\r\n      \x3c/nav\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"flex-0" data-dojo-attach-point\x3d"_pageDropdown"\x3e\r\n      \x3cdiv class\x3d"dropdown dropdown-up js-dropdown padding-leader-quarter right full-width phone-leader-half"\x3e\r\n        \x3c!-- extends side-nav --\x3e\r\n        \x3cbutton class\x3d"btn-link font-size--2 btn-link-black js-dropdown-toggle" tabindex\x3d"0" aria-haspopup\x3d"true" aria-expanded\x3d"false"\x3e\r\n          \x3cspan data-dojo-attach-point\x3d"_pageNumLabel"\x3e\x3c/span\x3e${!icons.inline-end.chevron-down.16}\r\n        \x3c/button\x3e\r\n        \x3cnav class\x3d"dropdown-menu dropdown-right" role\x3d"menu"\x3e\r\n          \x3cbutton class\x3d"js-page-num-link dropdown-link is-active" role\x3d"menuitem" data-num\x3d"20"\x3e20\x3c/button\x3e\r\n          \x3cbutton class\x3d"js-page-num-link dropdown-link" role\x3d"menuitem" data-num\x3d"60"\x3e60\x3c/button\x3e\r\n          \x3cbutton class\x3d"js-page-num-link dropdown-link" role\x3d"menuitem" data-num\x3d"100"\x3e100\x3c/button\x3e\r\n        \x3c/nav\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/CreateFolder.html":'\x3cdiv data-dojo-attach-point\x3d"contentNode"\x3e\r\n    \x3cform data-dojo-attach-point\x3d"_createFolderForm"\x3e\r\n        \x3clabel for\x3d"create-new-folder"\x3e${i18n.folderDlg.folderName}\x3cinput id\x3d"create-new-folder" name\x3d"folder" type\x3d"text" data-dojo-attach-point\x3d"_input" maxlength\x3d"125"/\x3e\x3c/label\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e\r\n',"url:arcgisonline/sharing/dijit/dialog/templates/CreateLayersDlg.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"trailer-1 step-indicator-container"\x3e\r\n    \x3cdiv class\x3d"add-datastore-step active" id\x3d"step1"\x3e\r\n      \x3cdiv class\x3d"step-text"\x3e${i18n.step1}\x3c/div\x3e\r\n      \x3cdiv class\x3d"step-label"\x3e${i18n.step1Description}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"add-datastore-step" id\x3d"step2"\x3e\r\n      \x3cdiv class\x3d"step-text"\x3e${i18n.step2}\x3c/div\x3e\r\n      \x3cdiv class\x3d"step-label"\x3e${i18n.step2Description}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cform\r\n    data-dojo-attach-point\x3d"containerNode"\r\n    class\x3d"data-store-form"\r\n    enctype\x3d"multipart/form-data"\r\n    action\x3d""\r\n    method\x3d"POST"\r\n    autocomplete\x3d"off"\r\n    data-dojo-attach-event\x3d"onsubmit:onSubmit"\r\n  \x3e\r\n    \x3cdiv class\x3d"clearfix"\x3e\r\n      \x3cdiv class\x3d"step-container step-1"\x3e\r\n        \x3cdiv class\x3d"folder-container"\x3e\r\n          \x3clabel for\x3d"folder" class\x3d"trailer-0"\x3e ${i18n.saveInFolder} \x3c/label\x3e\r\n          \x3cdiv class\x3d"flex"\x3e\r\n            \x3cselect\r\n              id\x3d"layers_tab__portalFolderSelect"\r\n              data-dojo-type\x3d"dijit/form/Select"\r\n              style\x3d"width: 100% !important;"\r\n              class\x3d"folderDropdownSelect folderDropdown create-layers-dropdown"\r\n              data-dojo-attach-point\x3d"_folders"\r\n            \x3e\x3c/select\x3e\r\n            \x3cbutton class\x3d"btn btn-clear btn-create" data-dojo-attach-point\x3d"createButton"\x3e${i18n.createNew}\x3c/button\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"step-container step-2 hide"\x3e\r\n        \x3cdiv\x3e\r\n          \x3cp class\x3d"trailer-half"\x3e${i18n.serverInformation}\x3c/p\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"serversGridContainer" class\x3d"servers-grid-container"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"leader-1"\x3e\r\n          \x3clabel for\x3d"serverFolder" class\x3d"trailer-half"\x3e ${i18n.serverFolder} \x3c/label\x3e\r\n          \x3cfieldset class\x3d"fieldset-radio"\x3e\r\n            \x3clabel\r\n              \x3e\x3cinput\r\n                type\x3d"radio"\r\n                name\x3d"serverFolderRadio"\r\n                checked\x3d"checked"\r\n                value\x3d"sameAsPortalFolder"\r\n              /\x3e${i18n.sameAsPortalFolder}\x3c/label\r\n            \x3e\r\n            \x3clabel\x3e\x3cinput type\x3d"radio" name\x3d"serverFolderRadio" value\x3d"newFolder" /\x3e${i18n.newFolder}\x3c/label\x3e\r\n          \x3c/fieldset\x3e\r\n          \x3cdiv class\x3d"flex"\x3e\r\n            \x3cinput\r\n              type\x3d"text"\r\n              data-dojo-attach-point\x3d"serverFolder"\r\n              disabled\r\n              placeholder\x3d"${i18n.serverFolderPlaceholder}"\r\n            /\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"leader-quarter text-light font-size--2 hide" data-dojo-attach-point\x3d"exampleUrlContainer"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"errorNode" class\x3d"alert alert-red leader-half"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"loader padding-leader-3 padding-trailer-2" data-dojo-attach-point\x3d"loader"\x3e\r\n        \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"loader-text"\x3e${i18n.loading}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"action-buttons leader-1"\x3e\r\n      \x3cspan class\x3d"right"\x3e\r\n        \x3cbutton class\x3d"btn btn-clear hide" id\x3d"back-button" name\x3d"backButton" data-dojo-attach-point\x3d"backButton"\x3e\r\n          ${i18n.backButton}\r\n        \x3c/button\x3e\r\n        \x3cbutton class\x3d"btn hide" id\x3d"start-button" name\x3d"addButton" type\x3d"submit" data-dojo-attach-point\x3d"startButton"\x3e\r\n          ${i18n.startButton}\r\n        \x3c/button\x3e\r\n        \x3cbutton class\x3d"btn" id\x3d"next-button" name\x3d"nextButton" data-dojo-attach-point\x3d"nextButton"\x3e\r\n          ${i18n.nextButton}\r\n        \x3c/button\x3e\r\n      \x3c/span\x3e\r\n      \x3cbutton class\x3d"btn btn-transparent" id\x3d"cancel-button" name\x3d"cancelButton" data-dojo-attach-point\x3d"cancelButton"\x3e\r\n        ${i18n.cancelButton}\r\n      \x3c/button\x3e\r\n    \x3c/div\x3e\r\n  \x3c/form\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/sharing/dijit/dialog/templates/SyncLayersDlg.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"sync-layers-content"\x3e\r\n    \x3cp\x3e\r\n      ${i18n.itemProperties.syncLayersMessage}\r\n    \x3c/p\x3e\r\n    \x3clabel class\x3d"toggle-switch"\x3e\r\n      \x3cinput type\x3d"checkbox" class\x3d"toggle-switch-input" data-dojo-attach-point\x3d"syncOptionCheckbox" checked\x3d"true" /\x3e\r\n      \x3cspan class\x3d"toggle-switch-track margin-right-1"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"toggle-switch-label"\x3e\r\n        \x3cspan class\x3d"tooltip tooltip-multiline tooltip-top" aria-label\x3d"${i18n.itemProperties.syncLayersOptionTooltipText}" id\x3d"syncLayersOptionTooltip"\x3e${i18n.itemProperties.syncLayersOptionTooltip}\x3c/span\x3e\x26nbsp;${i18n.itemProperties.syncLayersOptionMessage}\r\n      \x3c/span\x3e\r\n    \x3c/label\x3e\r\n    \x3cp\x3e\r\n      ${i18n.itemProperties.syncLayersMessageConfirm}\r\n    \x3c/p\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"sync-layers-actions right"\x3e\r\n    \x3cbutton class\x3d"btn" data-dojo-attach-point\x3d"okButton"\x3e${i18n.common.yesLabel}\x3c/button\x3e\r\n    \x3cbutton class\x3d"btn btn-clear" data-dojo-attach-point\x3d"cancelButton"\x3e${i18n.itemProperties.cancel}\x3c/button\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_layers.html":'\x3cdiv class\x3d"layers-tab"\x3e\r\n  \x3c!-- control bar section --\x3e\r\n  \x3csection class\x3d"hide trailer-half" data-dojo-attach-point\x3d"_controlBarContainer"\x3e\r\n    \x3cdiv class\x3d"js-control-bar"\x3e\x3c/div\x3e\r\n  \x3c/section\x3e\r\n\r\n  \x3c!-- error section --\x3e\r\n  \x3csection class\x3d"grid-container trailer-half leader-half hide" data-dojo-attach-point\x3d"_errorContainer"\x3e\r\n    \x3cdiv class\x3d"alert alert-full alert-red is-active leader-1" data-dojo-attach-point\x3d"_errorMessage"\x3e\x3c/div\x3e\r\n  \x3c/section\x3e\r\n\r\n  \x3c!-- notification section --\x3e\r\n  \x3csection class\x3d"grid-container trailer-half leader-half hide" data-dojo-attach-point\x3d"_notificationContainer"\x3e\r\n    \x3cdiv class\x3d"column-24 layer-notification"\x3e\r\n      \x3cdiv class\x3d"notification-left"\x3e\r\n          \x3cdiv class\x3d"status-item-container" data-dojo-attach-point\x3d"_statusIconContainer"\x3e\r\n              \x3c!-- job in progress --\x3e\r\n              \x3ci class\x3d"icon-ui" data-dojo-attach-point\x3d"_iconJobRunning" class\x3d"hide"\x3e\r\n                \x3cimg src\x3d"./js/arcgisonline/css/images/LoadingAnimation_circle24blue.gif" /\x3e\r\n              \x3c/i\x3e\r\n      \r\n              \x3c!-- job complete --\x3e\r\n              \x3ci data-dojo-attach-point\x3d"_iconJobCompleted" class\x3d"hide"\x3e\r\n                \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"32" height\x3d"32" viewBox\x3d"0 0 32 32" class\x3d"svg-icon"\x3e\x3cpath fill\x3d"#5a9359" d\x3d"M11.927 22l-6.882-6.883-3 3L11.927 28 31.204 8.728l-3.001-3.001z"/\x3e\x3c/svg\x3e\r\n              \x3c/i\x3e\r\n      \r\n              \x3c!-- job error --\x3e\r\n              \x3ci class\x3d"icon-ui icon-ui-error hide" data-dojo-attach-point\x3d"_iconJobError"\x3e\x3c/i\x3e\r\n      \r\n              \x3c!-- job unknown status --\x3e\r\n              \x3ci class\x3d"icon-ui icon-ui-notice-round hide" data-dojo-attach-point\x3d"_iconJobUnknownStatus"\x3e\x3c/i\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"status-item-container" data-dojo-attach-point\x3d"_statusTextContainer"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"status-action-container" data-dojo-attach-point\x3d"_statuActionContainer"\x3e\r\n        \x3cbutton class\x3d"btn btn-transparent hide" data-dojo-attach-point\x3d"_dismissBtn"\x3e\r\n          ${i18n.itemProperties.dismiss}\r\n        \x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/section\x3e\r\n\r\n  \x3c!-- create layers section --\x3e\r\n  \x3csection class\x3d"grid-container hide" data-dojo-attach-point\x3d"_createLayersContainer"\x3e\r\n    \x3cdiv class\x3d"column-24"\x3e\r\n      \x3cdiv class\x3d"empty-view text-center leader-2"\x3e\r\n        \x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 256 256" width\x3d"256"\x3e\r\n          \x3cpath\r\n            fill\x3d"#ccc"\r\n            d\x3d"M149.375 182.444l56.463-56.471-25.376-25.376 5.523-14.541-59.827-22.726L110.828 48H56v124h18.365l12.437 4.724 34.182 34.101 15.33-15.294 7.07 2.686 5.164-13.597zm50.806-56.472l-47.34 47.35 26.064-68.626zM112 54.828L141.172 84H112zM60 52h48v36h36v80H60zm60.984 153.17L95.95 180.199l36.263 13.775zm20.081-12.113L85.632 172H148V85.172L133.059 70.23l47.766 18.144-34.628 91.171z"\r\n          /\x3e\r\n        \x3c/svg\x3e\r\n        \x3ch3\x3e${i18n.itemProperties.noLayers}\x3c/h3\x3e\r\n        \x3cp class\x3d"font-size--2 text-constrain margin-auto" data-dojo-attach-point\x3d"_createLayersMessage"\x3e\x3c/p\x3e\r\n        \x3cbutton class\x3d"btn" data-dojo-attach-point\x3d"_createLayersBtn"\x3e${i18n.itemProperties.createLayers}\x3c/button\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/section\x3e\r\n\r\n  \x3c!-- layers list container --\x3e\r\n  \x3csection class\x3d"grid-container hide" data-dojo-attach-point\x3d"_layersListContainer"\x3e\r\n    \x3cdiv class\x3d"column-24 flex"\x3e\r\n      \x3cdiv class\x3d"view-wrap js-view-wrap"\x3e\r\n        \x3c!--\r\n          left side\r\n          \x3cdiv class\x3d"js-filter-wrap"\x3e\x3c/div\x3e\r\n        --\x3e\r\n        \x3cdiv class\x3d"clearfix padding-trailer-half flex break-word"\x3e\r\n          \x3cdiv class\x3d"font-size--1 inline-block flex-1 flex flex-align-center filter-status-wrap"\x3e\r\n            \x3c!-- Current/Total counts --\x3e\r\n            \x3cspan\r\n              class\x3d"padding-left-0 font-size--2 flex-0 break-word border-box text-ellipsis range-text"\r\n              data-dojo-attach-point\x3d"_rangeText"\r\n            \x3e\r\n              \x3cspan data-dojo-attach-point\x3d"_pageRange"\x3e\x3c/span\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan class\x3d"folder-container hide" data-dojo-attach-point\x3d"_folderContainer"\x3e \x3c/span\x3e\r\n            \x3cspan\x3e\r\n              \x3cbutton class\x3d"btn btn-transparent btn-red-transparent hide" data-dojo-attach-point\x3d"_deleteBtn"\x3e\r\n                \x3ci class\x3d"icon-ui-trash"\x3e \x3c/i\x3e ${i18n.itemProperties.deleteAllLayers}\r\n              \x3c/button\x3e\r\n            \x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Content Views --\x3e\r\n        \x3cdiv class\x3d"clearfix padding-trailer-half js-content js-views"\x3e\x3c/div\x3e\r\n\r\n        \x3c!-- Pagination --\x3e\r\n        \x3cdiv class\x3d"clearfix padding-leader-half padding-trailer-half js-pagination"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/section\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/layers/_empty.html":'\x3cdiv class\x3d"datasets-empty"\x3e\r\n  \x3cdiv class\x3d"js-empty-view text-center"\x3e\r\n    \x3cp class\x3d"font-size--2 text-constrain margin-auto"\x3e\r\n      ${i18n.itemProperties.noLayersSearch}\r\n    \x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:arcgisonline/pages/item/widgets/templates/layers/_none.html":"\x3cdiv\x3enone\x3c/div\x3e","url:arcgisonline/pages/item/widgets/templates/layers/_tableHead.html":'\x3cdiv class\x3d"table-select-row table-select-row-header" role\x3d"row"\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-checkbox ${selectClass}" role\x3d"columnheader"\x3e\r\n    \x3clabel class\x3d"table-select-cell-sort table-select-check-all"\x3e\r\n      \x3cinput type\x3d"checkbox" aria-label\x3d"${i18n.filters.selectAll}" class\x3d"js-select-all" /\x3e\r\n    \x3c/label\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-cell-large"\x3e\r\n    \x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" role\x3d"columnheader" data-sort\x3d"layerName" data-sort-order\x3d"asc"\x3e${i18n.itemProperties.layerName1}\x3c/button\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-cell-medium"\x3e\r\n    \x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" role\x3d"columnheader" data-sort\x3d"layerType" data-sort-order\x3d"asc"\x3e\r\n      ${i18n.itemProperties.layerTypeLabel}\r\n    \x3c/button\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-cell-large"\x3e\r\n    \x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" role\x3d"columnheader" data-sort\x3d"datasetName" data-sort-order\x3d"asc"\x3e\r\n      ${i18n.itemProperties.datasetName}\r\n    \x3c/button\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell table-select-cell-th table-select-cell-medium"\x3e\r\n    \x3cbutton class\x3d"table-select-cell-sort js-table-sort-header" role\x3d"columnheader" data-sort\x3d"created" data-sort-order\x3d"desc"\x3e\r\n      ${i18n.itemProperties.layerCreated}\r\n    \x3c/button\x3e\r\n  \x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/layers/_tableRow.html":'\x3cdiv class\x3d"table-select-row flex table-select-row-avatar" role\x3d"row"\x3e\r\n  \x3cspan class\x3d"table-select-cell flex-1 layer-name" role\x3d"cell"\x3e\r\n    \x3cdiv class\x3d"flex-align-center"\x3e\r\n      \x3cimg\r\n        src\x3d"${item.iconUrl}"\r\n        alt\x3d"${item.layerType}"\r\n        title\x3d"${item.layerType}"\r\n        width\x3d"16"\r\n        height\x3d"16"\r\n        class\x3d"item-icon"\r\n      /\x3e\r\n      \x3ca href\x3d"${item.itemUrl}" target\x3d"_blank" class\x3d"layer-link"\x3e\r\n        ${item.layerName}\r\n        \x3csvg class\x3d"launch" xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 16 16"\x3e\r\n          \x3cpath d\x3d"M14 8h1v7H1V1h7v1H2v12h12zm-4-7v1h3.29L7.62 7.67l.71.71L14 2.71V6h1V1z" /\x3e\r\n        \x3c/svg\x3e\r\n      \x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell flex-1" title\x3d"${item.layerType}" role\x3d"cell"\x3e\r\n    ${item.layerType}\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell flex-1" title\x3d"${item.datasetName}" role\x3d"cell"\x3e\r\n    ${item.datasetName}\r\n  \x3c/span\x3e\r\n  \x3cspan class\x3d"table-select-cell flex-1" role\x3d"cell"\x3e ${item.createdDisplay} \x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/layers/_controlBarActions.html":'\x3cdiv class\x3d"flex full-width tooltip tooltip--data tooltip-multiline"\r\n  data-tooltip\x3d"${i18n.itemProperties.syncLayersTooltip}"\x3e\r\n  \x3cbutton id\x3d"syncLayersBtn" data-tooltip\x3d"${i18n.itemProperties.syncLayersTooltip}"\r\n    class\x3d"btn btn-clear btn-small flex-1 js-action-syncLayers" data-action\x3d"syncLayers"\x3e\r\n    ${i18n.itemProperties.syncLayers}\r\n  \x3c/button\x3e\r\n\x3c/div\x3e',
"url:arcgisonline/pages/dijit/SubNav/templates/_option.html":'\x3ca\r\n  href\x3d"#${id}"\r\n  data-tab\x3d"${id}"\r\n  data-logClick\x3d"${logClick}"\r\n  role\x3d"tab"\r\n  aria-selected\x3d"false"\r\n  class\x3d"js-subnav-link subnav-link ${isActive} ${show:hide} ${classes:empty}"\r\n  aria-controls\x3d"tabcontent"\x3e\r\n  \x3cspan class\x3d"subnav-link__text no-pointer"\x3e${label}\x3c/a\x3e\r\n',"url:arcgisonline/pages/dijit/SubNav/templates/_title.html":'\x3cdiv class\x3d"js-subnav-edit subnav-edit flex flex-column flex-1 flex-align-center break-word"\x3e\r\n  \x3ch1 class\x3d"subnav-title ${_titleTypeSize}" id\x3d"pagetitle"\x3e${titleText}\x3c/h1\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/dijit/SubNav/templates/_paths.html":'\x3cdiv class\x3d"flex flex-1 flex-align-center break-word"\x3e\r\n  \x3ch1 class\x3d"subnav-title flex flex-align-center margin-right-1 ${_titleTypeSize} js-subnav-paths" id\x3d"pagetitle"\x3e\r\n    ${paths}\r\n  \x3c/h1\x3e\r\n\x3c/div\x3e\r\n',"url:arcgisonline/pages/dijit/SubNav/templates/_path.html":'\x3ca href\x3d"#" class\x3d"subnav-breadcrumb js-subnav-path ${lastPath} text-ellipsis"\x3e\r\n  \x3cspan class\x3d"${showBack} inline-block padding-right-quarter subnav-breadcrumb-back"\x3e${icons.arrow-left.24}\x3c/span\x3e${title}\r\n\x3c/a\x3e\r\n',
"url:arcgisonline/pages/dijit/SubNav/templates/SubNav.html":'\x3cheader class\x3d"subnav" role\x3d"banner"\x3e\r\n  \x3cdiv class\x3d"subnav-wrap grid-container flex phone-flex-column js-subnav-wrap"\x3e\r\n    \x3cdiv class\x3d"flex flex-1 flex-align-center phone-flex-column ${_titleTypeSize}"\x3e\r\n      \x3cspan class\x3d"js-subnav-title-wrap flex-1 flex"\x3e${!titleHTML}\x3c/span\x3e\r\n      \x3cbutton class\x3d"js-subnav-expand subnav-expand ${hideLinks}"\x3e\r\n        \x3cspan class\x3d"js-subnav-current-label subnav-expand__current-label no-pointer inline-block margin-right-half margin-left-0"\x3e${activeLabel}\x3c/span\x3e\r\n        \x3csvg class\x3d"subnav-expand-icon no-pointer" xmlns\x3d"http://www.w3.org/2000/svg" width\x3d"16" height\x3d"16" viewBox\x3d"0 0 16 16"\x3e\r\n          \x3cpath fill\x3d"#FFF" d\x3d"M8 11.5l-7-7h14z"/\x3e\r\n        \x3c/svg\x3e\r\n      \x3c/button\x3e\r\n    \x3c/div\x3e\r\n    \x3cnav class\x3d"subnav-links ${hideLinks} js-subnav-links flex-0 flex" role\x3d"tablist" aria-labelledby\x3d"pagetitle"\x3e${!linksHTML}\x3c/nav\x3e\r\n  \x3c/div\x3e\r\n\x3c/header\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_item.html":'\x3cdiv class\x3d"flex-column flex-1"\x3e\r\n  \x3cdiv class\x3d"js-subnav-wrapper"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"alert alert-yellow alert-full alert-inline js-public-data-collection-alert"\x3e\r\n    \x3cdiv class\x3d"grid-container"\x3e\r\n      \x3cdiv class\x3d"column-24"\x3e\r\n        \x3cdiv class\x3d"flex flex-center"\x3e\r\n          \x3cdiv class\x3d"flex-0 margin-right-half"\x3e\r\n            ${icons.inline.exclamation-mark-triangle.16}\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"flex-1 font-size--2"\x3e\r\n            ${i18n.itemProperties.publicDataCollection.alertMessage}\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"flex-0"\x3e\r\n              \x3cbutton class\x3d"btn btn-transparent margin-left-half js-public-data-collection-enable"\x3e${i18n.itemProperties.publicDataCollection.allowDataCollection}\x3c/button\x3e\r\n              \x3cbutton class\x3d"btn btn-transparent margin-left-half js-public-data-collection-unshare"\x3e${i18n.itemProperties.publicDataCollection.unshare}\x3c/button\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv\r\n    class\x3d"js-item-content hide tab-content flex-column flex-1"\r\n    id\x3d"tabcontent"\r\n    aria-live\x3d"polite"\r\n    role\x3d"tabpanel"\r\n  \x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"js-item-loader"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:arcgisonline/pages/item/widgets/templates/_loader.html":'\x3cdiv class\x3d"loader is-active padding-leader-3 padding-trailer-3"\x3e\r\n  \x3cdiv class\x3d"loader-bars"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"loader-text"\x3e${i18n.common.loading}\x3c/div\x3e\r\n\x3c/div\x3e',"*now":function(e){e(['dojo/i18n!*preload*arcgisonline/pages/nls/item*["ar","bg","bs","ca","cs","da","de","de-ch","el","en-au","en-ca","en-gb","en-us","es","es-mx","et","fi","fr","fr-ch","he","hr","hu","id","it","it-ch","ja","ko","lt","lv","nl","nb","pl","pt","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw","ROOT"]'])},
"*noref":1}});
define("arcgisonline/pages/item","require exports tslib calcite-web/js/calcite-web taginsert/umd/taginsert moment/moment dojo/dom-attr dojo/dom-construct dojo/dom-class dojo/_base/lang dojo/_base/window dojo/_base/event dojo/has dojo/on dojo/query dojo/json dojo/promise/all dojo/Deferred dojo/when dojo/string dojo/hash dojo/topic esri/lang ../tsutils/declareDecorator ../sharing/dijit/dialog/_CreateItemUtilMixin ../sharing/dijit/dialog/ConfirmDialog ../sharing/util ../esriGeowConfig ../pages/basePage ./pageUtil ./utils/item ./utils/arrays ./utils/date ./utils/dom ./utils/icons ./utils/formatters ./utils/verified ./utils/notebook ./utils/number ./utils/strings ./serviceUtil ./statusUtil ./utils/alerts ./item/_Actions ./portal/PortalItem ./item/widgets/_settings ./item/widgets/_datasets ./item/widgets/_outputs ./item/widgets/_overview ./item/widgets/_visualize ./item/widgets/_imageManagement ./item/widgets/_data ./item/widgets/_usage ./item/widgets/_preview ./item/widgets/_layers ./item/widgets/_tasks ./item/widgets/_snapshots ./dijit/SubNav dojo/text!./item/widgets/templates/_item.html dojo/text!./item/widgets/templates/_loader.html dojo/i18n!../nls/arcgisonline ./utils/setItemUrls ./utils/search ./components/ManageBlockedApps/blocked-apps-service ../sharing/dijit/dialog/CreateAppDlg ./utils/mapViewer xstyle/css!./item/widgets/css/tasks.css".split(" "),function(e,
U,q,b,l,p,r,a,c,d,h,f,g,n,m,t,w,u,v,x,y,C,z,F,O,V,N,J,D,K,G,I,R,A,B,H,T,M,L,X,ba,ma,ta,Ea,wa,Q,Z,aa,ea,oa,ra,za,ya,Ha,ua,Y,da,ka,W,fa,ha,sa,Fa,Ma,Oa,Ra){b=q.__importDefault(b);l=q.__importDefault(l);p=q.__importDefault(p);r=q.__importDefault(r);a=q.__importDefault(a);c=q.__importDefault(c);d=q.__importDefault(d);h=q.__importDefault(h);f=q.__importDefault(f);g=q.__importDefault(g);n=q.__importDefault(n);m=q.__importDefault(m);t=q.__importDefault(t);w=q.__importDefault(w);u=q.__importDefault(u);v=q.__importDefault(v);
x=q.__importDefault(x);y=q.__importDefault(y);C=q.__importDefault(C);z=q.__importDefault(z);F=q.__importDefault(F);O=q.__importDefault(O);V=q.__importDefault(V);N=q.__importDefault(N);J=q.__importDefault(J);D=q.__importDefault(D);K=q.__importDefault(K);G=q.__importDefault(G);I=q.__importDefault(I);R=q.__importDefault(R);A=q.__importDefault(A);B=q.__importDefault(B);H=q.__importDefault(H);T=q.__importDefault(T);M=q.__importDefault(M);L=q.__importDefault(L);X=q.__importDefault(X);ba=q.__importDefault(ba);
ma=q.__importDefault(ma);ta=q.__importDefault(ta);Ea=q.__importDefault(Ea);wa=q.__importDefault(wa);Q=q.__importDefault(Q);Z=q.__importDefault(Z);aa=q.__importDefault(aa);ea=q.__importDefault(ea);oa=q.__importDefault(oa);ra=q.__importDefault(ra);za=q.__importDefault(za);ya=q.__importDefault(ya);Ha=q.__importDefault(Ha);ua=q.__importDefault(ua);Y=q.__importDefault(Y);da=q.__importDefault(da);ka=q.__importDefault(ka);W=q.__importDefault(W);fa=q.__importDefault(fa);ha=q.__importDefault(ha);sa=q.__importDefault(sa);
Ma=q.__importDefault(Ma);Oa=q.__importDefault(Oa);return function(){function Da(){this.baseClass="item flex-1 flex-column view-background";this.skipToContent="main-content-area";this.i18n=ha["default"];this.blockedApps=[]}Da.prototype.construtor=function(){};Da.prototype.postCreate=function(){this.inherited(arguments);var E=a["default"].create("input");this._supportsFormValidation=!g["default"]("safari")&&"required"in E&&"pattern"in E;this.i18n.itemLinks.openNotebook=M["default"].notebooksBetaFormatter(this.i18n.itemLinks.openNotebook)};
Da.prototype.startup=function(){var E=this;this.inherited(arguments);var S=K["default"].getQueryParams(),ia=Fa.semanticSearchEnabled(this.portal,this.portalUser)?"enriched":"";this.telemetry&&S.fromSearch&&(this.telemetry.endWorkflow("search",{details:S.searchTerm,position:parseInt(S.searchPosition,10),facetValue:S.searchFacet,attribute:ia}),K["default"].removeQueryParams(["fromSearch","searchPosition","searchTerm","searchFacet"]));this.getMemberDefaults().then(function(){return E.getHomePageConfig()}).then(function(){return E.fetchItem()}).then(function(na){return E.fetchSubLayer(na,
S)}).then(function(na){var qa,xa=na.item;E.sublayer=na.sublayer;E.sublayer&&(null===(qa=E.subnav)||void 0===qa?void 0:qa.domNode.querySelector('a[data-tab\x3d"settings"]').classList.add("hide"));return E.renderPage(xa)}).then(function(){E.emit("ready")},function(na){E.emit("error",na)})};Da.prototype.destroy=function(){var E;this._destroyTab();null===(E=this.subnav)||void 0===E?void 0:E.destroy();this.inherited(arguments)};Da.prototype.refreshItemLayers=function(){this._item.serviceInfo=void 0;this._item.sourceData=
void 0;this._item.relatedItems={};this.processItem(this._item).then(function(){C["default"].publish("item-layers/refreshed")})};Da.prototype._setActionUrlsAttr=function(E){var S;null===(S=E.openIn)||void 0===S?void 0:S.forEach(function(ia){return Ea["default"][ia](E)})};Da.prototype._setAttributeCssClassesAttr=function(E){var S=this,ia,na,qa;E.attributes=[];"url snippet description commentsEnabled numComments spatialReference accessInformation extent licenseInfo operationalLayers baseMapLayers featureLayers elevationLayers tools tables codeAttachment projectContent presentation screenshots tags resultData resultVisualizations resultDataViews sourceData serviceLink scoreCompleteness solutionContent workflowContent".split(" ").forEach(function(xa){!z["default"].isDefined(E[xa])||
!E[xa]||"presentation"===xa&&S.portal.isPortal||E.attributes.push("has-"+xa)});E.attributes.push(E.hasMetadata?"has-metadata":"has-no-metadata");E.attributes.push(I["default"].includes(E.typeKeywords,"Involved Lookup")?"has-geocodeReview":"has-no-geocodeReview");this.portal.isPortal&&E.isHostedService&&"Feature Service"===E.type&&(E.attributes.push(I["default"].includes(E.typeKeywords,"providerSDS")?"":"has-arcobjects"),E.attributes.push(I["default"].includes(E.typeKeywords,"providerBDS")?"has-elastic":
""),E.attributes.push(E.isSpatiotemporal?"has-spatiotemporal":""));E.attributes.push(E.hasResources?"has-resources":"");E.attributes.push(E.hasViewStyle?"has-viewStyle":"");E.attributes.push((null===(ia=E.openIn)||void 0===ia?0:ia.length)||I["default"].includes(E.types,"is-download")||I["default"].includes(E.types,"is-file")||I["default"].includes(E.types,"is-desktop")||I["default"].includes(E.types,"is-pdf")||E.defaultOpenText?"has-defaultOpen":"");E.attributes.push(("Form"===E.type||"QuickCapture Project"===
E.type)&&(null===(na=E.relatedService)||void 0===na?0:na.length)?"has-formContent":"");E.attributes.push("Solution"===E.type&&E.itemData&&Array.isArray(E.itemData.templates)&&0<E.itemData.templates.length?"has-solutionContent":"");E.attributes.push("Workflow"===E.type&&(null===(qa=E.itemData)||void 0===qa?0:qa.workflowLocations)?"has-workflowContent":"");E.attributes.push(I["default"].includes(E.typeKeywords,"HTML")||I["default"].includes(E.typeKeywords,"HTML3D")?"has-appBuilderPlatform":"");E.attributes.push(I["default"].includes(E.typeKeywords,
"Cloud Drive")?"has-cloudDriveData":"")};Da.prototype._setBodyCssClassesAttr=function(E){var S,ia,na,qa=!!this.portalUser,xa=g["default"]("trident"),Ca=qa&&(null===(S=this.portalUser)||void 0===S?void 0:S.isOrgUser);S=[qa?"is-signed-in":"is-signed-out"];var Ga=document.body.className.split(" ").filter(function(la){return 0===(null===la||void 0===la?void 0:la.indexOf("dj_"))||-1<(null===la||void 0===la?void 0:la.indexOf("-blocked"))}),Na=!this.portal.isPortal&&E.isHostedService&&"Feature Service"===
E.type&&0<=E.subInfo,Ba=!this.portal.isPortal&&E.isHostedService&&"Image Service"===E.type&&!I["default"].includes(E.typeKeywords,"Tiled Imagery Layer")&&!I["default"].includes(E.typeKeywords,"Elevation 3D Layer")&&0<=E.subInfo,P=I["default"].includes(E.typeKeywords,"usesSnapshot"),ca="Scene Service"===E.type&&I["default"].includes(E.typeKeywords,"Voxel"),ja=!!E.origin;S.push(this.sublayer?"":"is-parent-item");S.push(this.portal.isPortal?"is-on-premise":"is-online");S.push(Ca?"":"is-public-user");
S.push(E.canUpdate?"can-update":"is-viewer");S.push(this.canDeleteItem(E)?"can-delete":"");S.push(E.isOwner?" is-owner":"");S.push(E.isAdmin?" is-admin":"");S.push(this.portal.metadataEditable?"is-metadata-enabled":"is-metadata-disabled");S.push(J["default"].webExperienceEnabled&&(null===(ia=this.portalUser)||void 0===ia?0:ia.isOrgUser)?"is-webExperience-enabled":"");S.push(E.canShowSocialMediaLinks?"can-share-social":"");S.push(E.hasKMLItemData?"is-update":"");S.push(E.canChangeOwner?"can-change-owner":
"");S.push("Dashboard"===E.type&&E.isSupportedBrowser&&(qa&&Ca&&this.portalUser.canCreateItems&&!E.isViewOnly||E.isAdmin)?"can-copy-dashboard":"");S.push(J["default"].sceneViewerEnabled?"is-sceneViewer-enabled":"");S.push(E.isAdmin&&E.canAppendData?"can-appendData":"");S.push(E.contentStatus?"deprecated"===E.contentStatus?"is-deprecated":"is-authoritative":"has-no-contentStatus");S.push(this.isAdminAndItemBelongsToOrg(E)||E.isOwner&&Ca||E.isOwner&&this.isEsriPublicAccount(E.owner)?"can-edit-contentStatus":
"");S.push(this.isAdminAndItemBelongsToOrg(E)?"can-edit-authoritative-status":"");S.push(J["default"].webAppBuilderEnabled&&Ca?"is-wab-enabled":"");S.push(M["default"].notebookServerConfigured()?"has-notebookServer-enabled":"");S.push(J["default"].replaceLayerEnabled||this.portal.isPortal&&!this.portal.isKubernetes()?"is-replaceLayer-enabled":"");S.push("Notebook"===E.type&&Ca?"is-notebook":"");S.push(I["default"].includes(E.typeKeywords,"Route Layer")?"is-route-layer":"");S.push(Ca&&this.portalUser.userRole.canCreateNotebooks()?
"can-create-notebooks":"");S.push(Ca&&this.portalUser.userRole.canPublishNotebooks()?"can-publish-notebooks":"");S.push(Ca&&this.portalUser.userRole.canCreateAdvancedNotebooks()?"can-use-arcpy-notebooks":"");S.push(P?"uses-snapshot":"");S.push(ca?"is-voxel":"");S.push(ja?"is-from-collaboration":"");ia=-1<(null===(na=E.openIn)||void 0===na?void 0:na.indexOf("mapViewer"));S.push(ia&&!xa?"is-map-viewer-beta":"");S.push(Na?"has-attachments":"");S.push(Ba?"has-image-count":"");S.push(this.portal.defaultMapViewer===
Ra.MapViewerType.Modern?"is-map-viewer-modern":"is-map-viewer-classic");c["default"].contains(h["default"].body(),"can-schedule-notebooks")&&S.push("can-schedule-notebooks");this._item.addBlockClasses(this._item.attributes);c["default"].replace(h["default"].body(),S.concat(this._item.privileges||[]).concat(this._item.types||[]).concat(this._item.attributes||[]).concat(Ga||[]));M["default"].canScheduleNotebooks(this.portalUser,E)};Da.prototype._setTypeKeywordFlagsAttr=function(E){var S,ia,na,qa=null===
(S=this.portalUser)||void 0===S?void 0:S.userRole;S=null===qa||void 0===qa?void 0:qa.canReassignOwnItems();qa=(null===(ia=this.portalUser)||void 0===ia?void 0:ia.isOrgAdmin)||((null===qa||void 0===qa?void 0:qa.canReassignOrgItems())&&qa.canViewOrgItems()||S)&&qa.canViewOrgUsers();ia=this.portalUser&&(null===(na=E.itemOwner)||void 0===na?void 0:na.orgId)===this.portalUser.orgId;na=!I["default"].includes(E.typeKeywords,"Offline Map Areas");S="Map Area"!==E.type&&!I["default"].includes(E.typeKeywords,
"MapAreaPackage");E.canChangeOwner=this.portalUser&&qa&&ia&&na&&S||!1;E.setTypeKeywordFlags()};Da.prototype.invalidInputHelper=function(E,S){var ia=this,na=function(Ca,Ga){ia._supportsFormValidation?Ca.setCustomValidity(Ga):(r["default"].set(Ca,"data-customValidity",Ga),""===Ga&&ia.hideErrors())},qa=function(Ca,Ga,Na){return"function"===typeof Ca?Ca.apply(Ga,Na):Ca},xa=function(){var Ca,Ga=(null===(Ca=E.value)||void 0===Ca?void 0:Ca.trim())||"";Ca=r["default"].get(E,"pattern");var Na=r["default"].has(E,
"required"),Ba="TEXTAREA"!==E.nodeName;Ga&&""!==Ga||!Na?ia._supportsFormValidation&&Ba||!Ca?na(E,""):(new RegExp(Ca)).test(Ga)?na(E,""):na(E,qa(S.invalidText,window,[E])):na(E,qa(S.emptyText,window,[E]))};this._supportsFormValidation&&E.setCustomValidity(qa(S.defaultText||"",window,[E]));this.own(n["default"](E,"change",xa),n["default"](E,"input",xa),n["default"](E,"invalid",function(){var Ca,Ga,Na,Ba,P,ca=(null===(Ca=E.value)||void 0===Ca?void 0:Ca.trim())||"";ca&&""!==ca?(null===(Ga=E.validity)||
void 0===Ga?0:Ga.patternMismatch)||(null===(Na=E.validity)||void 0===Na?0:Na.badInput)||(null===(Ba=E.validity)||void 0===Ba?0:Ba.typeMismatch)||(null===(P=E.validity)||void 0===P?0:P.customError)?na(E,qa(S.invalidText,window,[E])):na(E,""):na(E,qa(S.emptyText,window,[E]))}))};Da.prototype.loadEventHandlers=function(){var E=this;window.addEventListener("popstate",function(S){var ia;S="#"===window.location.hash.charAt(0)?window.location.hash.substring(1):window.location.hash;!K["default"].getQueryParams().sublayer&&
E.sublayer?"overview"===E._currentView?null===(ia=E.tabDijit)||void 0===ia?void 0:ia.toggleSubLayer():(delete E.sublayer,E.updateTab("overview")):E.updateTab(S||"overview")});this.own(m["default"](".js-subnav-link",this.contentWrapper).on("click",function(S){null===S||void 0===S?void 0:S.preventDefault();(S=null===S||void 0===S?void 0:S.target)&&y["default"](S.getAttribute("href").split("-")[0],!0)}),n["default"](this.domNode,".js-alert .is-active:click",function(S){f["default"].stop(S);a["default"].empty(m["default"](".js-alert").shift())}),
C["default"].subscribe("/dojo/hashchange",function(S){(g["default"]("ie")||g["default"]("trident")||g["default"]("edge"))&&E.updateTab(S)}),C["default"].subscribe("thumbnail/update",function(){return E.getThumbnail(!0)}),C["default"].subscribe("item/replaceLayerSuccess",function(){return E.handleReplaceLayerSuccess()}),this._item.watch(this._itemChangeHandler.bind(this)),C["default"].subscribe("imagery/update",function(S){E._checkForJobUpdate=!S.completed}),C["default"].subscribe("inlineEdit/title/done",
function(){E.subnav.updateText(E._item.title)}),m["default"](".js-public-data-collection-enable",this.domNode).on("click",function(){E.updateTab("settings-general",!0).then(function(S){E.subnav.updateActiveTab("settings");S=S.domNode.querySelector(".js-public-data-collection-container");window.scrollTo({top:S.offsetTop-40,behavior:"smooth"});S.classList.add("fieldset-checkbox--hightlight")})}),m["default"](".js-public-data-collection-unshare",this.domNode).on("click",function(S){Ea["default"].share({evt:S,
item:E._item,user:E.portalUser,page:E.page,portal:E.portal})}),this._item.watch("sharing",this.showPublicDataCollectionWarning.bind(this)),this._item.watch("typeKeywords",this.showPublicDataCollectionWarning.bind(this)),C["default"].subscribe("settings/update/serviceInfo",function(S){E.showPublicDataCollectionWarning(null===S||void 0===S?void 0:S.capabilities)}),C["default"].subscribe("item-layers/refresh",function(){E.refreshItemLayers()}))};Da.prototype._itemChangeHandler=function(E,S,ia){"typeKeywords"===
E&&(this._item.typeKeywords=X["default"].stringToArray(ia,",",!1));"text"===E&&(this._item.itemData=t["default"].parse(ia));"size"===E&&m["default"](".js-item-size").attr("innerHTML",this.i18n.itemProperties.sizeLabel+" "+this._formatSize(this._item.size));"subInfo"===E&&"Image Service"===this._item.type&&m["default"](".js-item-image-count").attr("innerHTML",this.i18n.itemProperties.imageCount+" "+this._formatNumber(this._item.subInfo));"url"!==E&&"scoreCompleteness"!==E&&m["default"](".if-"+E,this.contentWrapper).attr("innerHTML",
"tags"===E?this._formatTags(ia):"accessInformation"===E||"snippet"===E?this._linkify(ia):ia);"title"===E&&(m["default"](".js-title-input").attr("value",this._item.title),this.set("pageTitle",this._item.title));!this._item.isConfigurableApp||"folderId"!==E&&"typeKeywords"!==E||(this.set("actionUrls",this._item),m["default"](".js-action-configure").attr("href",this._item.configureUrl));this.set("typeKeywordFlags",this._item);this.set("attributeCssClasses",this._item);this.set("bodyCssClasses",this._item);
"codeAttachmentChanged"===E&&!0===ia&&this.refreshCodeAttachment();"styleChanged"===E&&!0===ia&&this.getThumbnail(!0);"serviceChanged"===E&&!0===ia&&(this._item.set("maxAgeCheck",!0),this.refreshServiceInfo());"maxAgeCheck"===E&&!0===ia&&this._item.ignoreCache&&this._item.ignoreCache()};Da.prototype.renderPage=function(E){var S=this;a["default"].place(x["default"].substitute(W["default"],{i18n:ha["default"],icons:B["default"]}),this.domNode);var ia=this.domNode.querySelector(".js-item-loader");ia.innerHTML=
x["default"].substitute(fa["default"],{i18n:ha["default"]});this._loader=ia.querySelector(".loader");this._content=this.domNode.querySelector(".js-item-content");this.own(this._item.watch("isLoaded",function(){var na,qa,xa;S._queryStringParams.jobid&&(K["default"].replaceCurrentLocation(K["default"].removeUrlQueryParameter(location.href,"jobid")),delete S._queryStringParams.jobid,N["default"].request({url:S._item.itemUrl}).then(function(Ca){var Ga,Na,Ba=new wa["default"](d["default"].mixin(Ca,{portal:S.portal}));
E.set({scoreCompleteness:null!==(Ga=Ba.scoreCompleteness)&&void 0!==Ga?Ga:S._item.scoreCompleteness,thumbnail:Ba.thumbnail||S._item.thumbnail,thumbnailUrl:Ba.thumbnailUrl||S._item.thumbnailUrl,size:null!==(Na=Ba.size)&&void 0!==Na?Na:S._item.size,extent:K["default"].extentToString(Ca&&Ca.extent||S._item.extent),description:Ba.description||S._item.description,snippet:Ba.snippet||S._item.snippet,tags:Ba.tags||S._item.tags});S.getThumbnail(!0).then(function(){S._destinationTab&&y["default"](S._destinationTab,
!0)})}));"Feature Service"===S._item.type&&(E.canUpdate||-1<(null===(qa=null===(na=S._item.serviceInfo)||void 0===na?void 0:na.capabilities)||void 0===qa?void 0:qa.indexOf("Query")))&&(S._item.types=S._item.types.concat(["is-data"]),S.subnav&&S.subnav.showTab("data"),S._item.isTable||(S._item.types=S._item.types.concat(["is-layer"]),null===(xa=S.subnav)||void 0===xa?void 0:xa.showTab("visualize")));S.showPublicDataCollectionWarning();"template"===K["default"].getQueryParams().createWebApp&&"Web Map"===
E.type&&(K["default"].removeQueryParams(["createWebApp"]),(new Oa["default"]({item:S._item})).showWizard());S.canManageImageCollection()&&S.subnav&&(S.subnav.showTab("imageManagement"),S.updateImageManagementTabState());S.showWhatsNew()}));return this.processItem(E).then(function(na){var qa,xa,Ca,Ga,Na,Ba;S.canShareItem(na)&&S._item.privileges.push("can-share");S.canDeleteItem(na)&&(S._item.canDelete=!0,S._item.privileges.push("can-delete"));S.portalUser&&S.portalUser.canCreateItems&&S._item.privileges.push("can-create-items");
(null===(xa=null===(qa=S.portalUser)||void 0===qa?void 0:qa.userRole)||void 0===xa?0:xa.canUpdateOrgItems())&&S._item.privileges.push("can-update-org-items");!N["default"].couldHaveArcGISDesktop()&&I["default"].includes(S._item.types,"is-desktop")&&S._item.types.splice(S._item.types.indexOf("is-desktop"),1);if(na.url||na.itemDataUrl)qa=-1<(null===(Ca=na.typeKeywords)||void 0===Ca?void 0:Ca.indexOf("Service Proxy"))?(-1<na.url.indexOf("?")?"\x26":"?")+"f\x3dpjson":"",Ca="WFS"===na.type&&-1===(null===
(Ga=na.url)||void 0===Ga?void 0:Ga.toLowerCase().indexOf("getcapabilities"))?(-1<na.url.indexOf("?")?"\x26":"?")+"request\x3dgetcapabilities":"",S.portal.isPortal?na.viewUrl=encodeURI(na.url?na.url+qa+Ca:na.itemDataUrl):(Ga="public"!==na.access?K["default"].needsToken(na,na.url):na.url,na.viewUrl=encodeURI(Ga?Ga+qa+Ca:na.itemDataUrl));(!S.portal.isPortal||S.portal.isPortal&&"public"===S.portal.access&&"public"===S._item.access)&&l["default"]({item:na,mapping:{w3c:{image_src:"thumbnailUrl"},twitter:{image:"thumbnailUrl"},
og:{image:"thumbnailUrl"}},noindex:function(P){return I["default"].includesAll(P.robots,["noindex","nofollow"])}});S.set("pageTitle",na.title);S.set("actionUrls",na);S.set("attributeCssClasses",na);S.set("bodyCssClasses",na);Ga=("#"===window.location.hash.charAt(0)?window.location.hash.substring(1):window.location.hash)||"overview";Ca=I["default"].includes(na.typeKeywords,"Requires Subscription")&&(!S.portalUser||!(null===(Na=S.portalUser)||void 0===Na?0:Na.isOrgUser))||na.isMapNotes||na.isMarkup;
Na=9>=g["default"]("ie");Na={active:K["default"].splitHashParts(Ga)[0],telemetry:S.telemetry,titleText:na.title,links:[{id:"overview",label:ha["default"].itemProperties.overview,logClick:!0},{id:"data",label:ha["default"].itemProperties.data,logClick:!0,show:I["default"].includes(S._item.types,"is-data")&&!Ca,classes:"js-status-disable"},{id:"imageManagement",label:ha["default"].itemProperties.imageManagement,logClick:!0,show:I["default"].includes(S._item.types,"is-imageManagement")&&S.canManageImageCollection()},
{id:"visualize",label:ha["default"].itemProperties.visualization,logClick:!0,show:I["default"].includesSome(S._item.types,["is-layer","is-featureCollection","is-streamLayer","is-feedLayer"])&&!Ca&&!Na,classes:"js-status-disable"},{id:"preview",label:ha["default"].itemProperties.preview,logClick:!0,show:I["default"].includes(S._item.types,"is-notebook")},{id:"tasks",label:ha["default"].itemProperties.tasks,logClick:!0,show:S.canViewNotebookTasks(S._item),classes:"if-can-schedule-notebooks"},{id:"snapshots",
label:ha["default"].itemProperties.snapshots,logClick:!0,show:I["default"].includes(S._item.types,"is-notebook"),classes:"if-owner"},{id:"layers",label:ha["default"].itemProperties.layers,logClick:!0,show:S.isDatastoreAndIsOwner(S._item)&&I["default"].includes(S._item.typeKeywords,"egdb")&&!I["default"].includesSome(S._item.typeKeywords,["BDAW","bigquery","CDW","snowflake","redshift"])},{id:"usage",label:ha["default"].itemProperties.itemUsage,logClick:!0,show:(S._item.isAdmin||S._item.isOwner||S._item.canUpdate)&&
(null===(Ba=S.portalUser)||void 0===Ba?void 0:Ba.isOrgUser)&&!S.portal.isPortal&&S.itemCanShowDataTab(S._item),classes:"if-parent-item"},{id:"datasets",label:ha["default"].itemProperties.datasets,logClick:!0,show:J["default"].bdfsEnabled&&"Big Data File Share"===S._item.type},{id:"outputs",label:ha["default"].itemProperties.outputs,logClick:!0,show:J["default"].bdfsEnabled&&"Big Data File Share"===S._item.type},{id:"settings",label:ha["default"].itemProperties.settings,logClick:!0,show:S.itemCanShowSettingsTab(S._item),
classes:"js-status-disable"}]};na.canUpdate&&!S.sublayer&&(Na.edit={baseClass:"subnav-edit flex flex-1 flex-align-center break-word",editButtonClasses:"btn-link-white",prop:"title",value:na.title,required:!0,pattern:"^[^\x3c|\x3e]+$",emptyText:ha["default"].itemProperties.error.needTitle,invalidText:ha["default"].itemProperties.error.badCharacter});S.subnav||(S.subnav=new ka["default"](Na,S.domNode.querySelector(".js-subnav-wrapper")),S.updateTab());S.loadEventHandlers();return na})};Da.prototype.toggleSubLayer=
function(E,S){var ia=[{href:"#",title:this._item.title,id:"item",classes:"js-item-title-",onPathClick:function(){return K["default"].removeQueryParams(["sublayer"],!0)},edit:this._item.canUpdate&&{baseClass:"subnav-edit flex flex-1 flex-align-center break-word",titleClass:"subnav-breadcrumb flex flex-align-center",editButtonClasses:"btn-link-white",prop:"title",value:this._item.title,required:!0,pattern:"^[^\x3c|\x3e]+$",emptyText:ha["default"].itemProperties.error.needTitle,invalidText:ha["default"].itemProperties.error.badCharacter}}];
if(E){var na=this._item;this.sublayer=E;na={href:"#",title:E.name,isActive:!0,id:"sublayer",edit:!na.isLocationTrackingService&&na.canUpdate&&na.isHostedService&&{inputType:"layerRenameSubnav",prop:"layerRename",value:E.name,layerUrl:E.url,layerId:E.id,required:!0,pattern:"^[^\x3c|\x3e]+$",emptyText:this.i18n.itemProperties.error.needTitle,invalidText:this.i18n.itemProperties.error.badCharacter,showLoader:N["default"].isPortal()}};ia.push(na);this.subnav.updateBreadCrumbs(ia);this.subnav.domNode.querySelector('a[data-tab\x3d"settings"]').classList.add("hide");
K["default"].updateQueryParams({id:this._item.id,sublayer:this.sublayer.id},S)}else this.sublayer=null,ia[0].isActive=!0,this.subnav.updateBreadCrumbs(ia),this.itemCanShowSettingsTab(this._item)&&this.subnav.domNode.querySelector('a[data-tab\x3d"settings"]').classList.remove("hide"),K["default"].removeQueryParams(["sublayer"])};Da.prototype.canViewNotebookTasks=function(E){return E.isOwner&&I["default"].includes(this._item.types,"is-notebook")&&this.portalUser.userRole.canScheduleNotebooks()};Da.prototype.isDatastoreAndIsOwner=
function(E){var S;return I["default"].includes(E.types,"is-data-store")&&(E.isOwner||(null===(S=this.portalUser)||void 0===S?void 0:S.isOrgAdmin))};Da.prototype.canShareItem=function(E){return!E.isRetired&&G["default"].canShareItem(E,this.portalUser)};Da.prototype.canDeleteItem=function(E){return G["default"].canDeleteItem(E,this.portalUser)};Da.prototype.canReplaceLayer=function(E){return I["default"].includes([""],E.type)};Da.prototype.isAdminAndItemBelongsToOrg=function(E){var S,ia;return(null===
(S=this.portalUser)||void 0===S?void 0:S.isOrgAdmin)&&(null===(ia=E.itemOwner)||void 0===ia?void 0:ia.orgId)===this.portalUser.orgId};Da.prototype.isEsriPublicAccount=function(E){return E.startsWith("esri_")};Da.prototype.itemCanShowDataTab=function(E){return"API Key"!==E.type};Da.prototype.itemCanShowSettingsTab=function(E){return(E.canUpdate||E.canDelete)&&(!I["default"].includes(E.types,"is-data-store")||this.isDatastoreAndIsOwner(E))};Da.prototype.normalizeTab=function(E){var S=E;S=I["default"].includes(["settings-general",
"settings-options"],E)?"settings":E;return I["default"].includes("overview settings usage imageManagement visualize data layers preview tasks datasets outputs snapshots".split(" "),S)?S:"overview"};Da.prototype.updateTab=function(E,S){var ia=this;void 0===E&&(E=window.location.hash.split("#")[1]);var na=new u["default"],qa,xa=this._item,Ca=K["default"].splitHashParts(E),Ga=this._queryStringParams.jobid,Na="true"===this._queryStringParams.showAppUsage,Ba=this.normalizeTab((null===Ca||void 0===Ca?void 0:
Ca[0])||this.hashParts[0]||this._currentView||"overview");this.hideErrors();if(Ba!==this._currentView||S){!Na||"layer"!==xa.classification&&"app"!==xa.classification||(Ba="layer"===xa.classification?"usage":"settings");if(!(xa.canUpdate||"settings"!==Ba&&"usage"!==Ba||xa.canDelete)&&"settings"===Ba||"layer"===xa.classification&&Ga&&"settings"===Ba||"layers"===Ba&&!this.isDatastoreAndIsOwner(this._item))this._destinationTab=y["default"](),Ba="overview",y["default"](Ba,!0);this._destroyTab().then(function(){ia._currentView=
Ba;ia._checkForJobUpdate&&ma["default"].checkStatus(xa).then(function(){return ia._checkForJobUpdate=!1});ia.subnav.hideEditLink();var P=!0;switch(Ba){case "settings":qa=Q["default"];break;case "usage":qa=ya["default"];break;case "visualize":qa=oa["default"];P=!1;break;case "imageManagement":qa=ra["default"];P=!1;break;case "data":qa=za["default"];break;case "preview":qa=Ha["default"];break;case "tasks":qa=Y["default"];break;case "layers":qa=ua["default"];break;case "datasets":qa=Z["default"];break;
case "outputs":qa=aa["default"];break;case "snapshots":qa=da["default"];break;default:qa=ea["default"],P=!1,ia.subnav.showEditLink()}ia.canManageImageCollection()&&ia.updateImageManagementTabState();c["default"].toggle(ia.domNode,"view-background",P);ia.showTab(ia._item,qa).then(function(ca){var ja;b["default"].sticky();na.resolve(ca);xa.isLoaded&&ia._item.set("isLoaded",!0);null===(ja=ia.domNode.querySelector('.js-subnav-link[data-tab\x3d"'+Ba+'"]'))||void 0===ja?void 0:ja.classList.add("is-active")})});
return na}};Da.prototype.showTab=function(E,S){var ia=this,na=this.tabDijit=new S({page:this,item:E,i18n:this.i18n,portalUser:this.portalUser,sublayer:this.sublayer},a["default"].create("div",{},this._content)),qa=new u["default"];na.startup().then(function(xa){xa&&ia.hideLoader();qa.resolve(na)});return qa};Da.prototype.updateImageManagementTabState=function(){var E,S;if(this.subnav){var ia=-1<(null===(S=null===(E=this._item.properties)||void 0===E?void 0:E.jobUrl)||void 0===S?void 0:S.indexOf("RasterAnalysisTools/GPServer/CreateImageCollection"))&&
"completed"!==this._item.status;m["default"]('[data-tab\x3d"imageManagement"]',this.subnav.domNode).toggleClass("btn-disabled",ia)}};Da.prototype.canManageImageCollection=function(){var E,S;return"Image Service"===this._item.type&&-1<this._item.typeKeywords.indexOf("Managed Image Collection")&&(null===(S=null===(E=this.portalUser)||void 0===E?void 0:E.userRole)||void 0===S?void 0:S.canPublishDynamicImagery())&&(this._item.isAdmin||this._item.isOwner||this._item.canUpdate)};Da.prototype.showWhatsNew=
function(){this.portal.isPortal||Ea["default"].whatsNew({endDate:new Date("July 31, 2016"),key:"itemPage",redirectUrl:"https://blogs.esri.com/esri/arcgis/2016/05/26/introducing-a-new-experience-for-working-with-items-in-arcgis-online"})};Da.prototype.fetchItemResult=function(){return this._request({url:this.portal.portalUrl+"content/items/"+this._queryStringParams.id})};Da.prototype.fetchItem=function(E){var S=this,ia=new u["default"],na=this._queryStringParams.id;this._items=this._items||[];this._items[na]&&
!E?ia.resolve(this._items[na]):this.fetchItemResult().then(function(qa){var xa=new wa["default"](d["default"].mixin(qa,{portal:S.portal}));xa.commentsRssUrl=xa.itemUrl+"/comments?f\x3drss";w["default"]({itemOwner:S.getItemOwner(xa)}).then(function(Ca){var Ga;xa.set(Ca);Ca={comments:S.fetchComments(xa),isFavorite:K["default"].isFavorite(xa),sharing:K["default"].getItemSharing(xa),verified:T["default"].getVerifiedInfo(xa),blockedApps:(null===(Ga=S.portalUser)||void 0===Ga?0:Ga.orgId)?S.checkBlockedApps():
null};w["default"](Ca).then(function(Na){xa.removeBlockedTypes(S.blockedApps);xa.set(Na);xa.set("ownerText",H["default"].formatOwnerText(xa));S.set("typeKeywordFlags",xa);xa.displayName=S._formatDisplayName(xa);S._items[na]=xa;S._item=xa;S.getThumbnail(!S._item.thumbnail&&!S._queryStringParams.jobid&&!S.portal.isPortal);ia.resolve(S._item)})})});return ia};Da.prototype.checkBlockedApps=function(){var E=this,S=new u["default"];Ma["default"].getBlockedApps().then(function(ia){E.blockedApps=ia||[];S.resolve()},
function(){S.resolve()});return S};Da.prototype.fetchSubLayer=function(E,S){var ia=new u["default"],na=K["default"].getNeededToken(E);if(z["default"].isDefined(S.sublayer)){var qa=E.url+"/"+S.sublayer,xa=q.__assign({url:qa},na&&{content:{token:na}});this._request(xa,na?void 0:{addToken:!1}).then(function(Ca){Ca.url=qa;ia.resolve({item:E,sublayer:Ca})},function(Ca){ia.resolve({item:E})})}else ia.resolve({item:E});return ia};Da.prototype.fetchItemData=function(){var E=this,S=new u["default"];v["default"](this.fetchItem(!1),
function(ia){E._request({url:ia.itemUrl+"/data"}).then(function(na){return S.resolve(na||!1)},function(){return S.resolve(null)})});return S};Da.prototype.fetchRelatedItems=function(E,S,ia){var na=new u["default"];E.getRelatedItems(S,ia).then(function(qa){return na.resolve(qa)},function(qa){return na.resolve([])});return na};Da.prototype.toPortalItem=function(E){return E?new wa["default"](d["default"].mixin(E,{portal:this.portal,title:E.title||""})):null};Da.prototype._fetchServiceInfo=function(E){var S=
this,ia,na,qa=new u["default"],xa=E.type,Ca={token:E.serverToken||null};Ca=K["default"].includeTimestampInRequest(Ca);E.hasServiceInfo&&E.url?(E.url=E.isHostedService?K["default"].needsSSL(E,E.url):E.url,this._request({url:E.url,content:Ca},{disableIdentityLookup:E.isServiceProxy||E.isPremium&&((null===(ia=E.portal)||void 0===ia?void 0:ia.isPortal)&&!E.isHostedService||!this.portalUser||!(null===(na=this.portalUser)||void 0===na?0:na.isOrgUser)),addToken:K["default"].addToken(E)}).then(function(Ga){qa.resolve(Ga)},
function(Ga){var Na,Ba=(null===(Na=Ga.details)||void 0===Na?0:Na.length)?Ga.details.shift():"";403===(null===Ga||void 0===Ga?void 0:Ga.httpCode)&&-1<Ba.indexOf("SSL Required")?(E.set("url",E.url.replace("http:","https:")),S._fetchServiceInfo(E).then(function(P){return qa.resolve(P)})):(E.isLoaded=!0,qa.resolve({error:Ga}))})):"Feature Collection"===xa||"Route Layer"===xa?(E.url=E.itemUrl+"/data",v["default"](E.itemData||this.fetchItemData(),function(Ga){return qa.resolve(Ga)},function(){return qa.resolve(null)})):
qa.resolve(null);return qa};Da.prototype.fetchAdminServiceInfo=function(E){var S=this,ia,na,qa=new u["default"],xa="Feature Service;Map Service;Vector Tile Service;Scene Service;Image Service;Knowledge Graph".split(";"),Ca=null===(ia=E.portal)||void 0===ia?void 0:ia.isPortal;ia={token:E.adminServerToken||(null===(na=this.portalUser)||void 0===na?void 0:na.credential.token)||null,_ts:null};na=Ca?ba["default"].encodeServiceName(E.adminUrl,E.isSDS):E.adminUrl;Ca=-1<E.typeKeywords.indexOf("usesSnapshot");
ia=K["default"].includeTimestampInRequest(ia);E.isHostedService&&"Feature Service"===E.type&&(ia._ts=(new Date).getTime());(E.canUpdate||E.canDelete)&&(E.isHostedService&&I["default"].includes(xa,E.type)||Ca)?this._request({url:na,content:ia},{useProxy:N["default"].shouldUseProxy(na)}).then(function(Ga){ba["default"].cacheMaxAgeCheck(S._item,Ga);qa.resolve(Ga)},function(){return qa.resolve(null)}):qa.resolve(null);return qa};Da.prototype.fetchServiceLayers=function(E){var S=this,ia,na,qa,xa=new u["default"],
Ca=null===(ia=E.url)||void 0===ia?void 0:ia.match(/Server\/(\d+)/i),Ga=E.serviceInfo||{},Na=[],Ba=[],P={};ia=K["default"].getNeededToken(E);var ca,ja;if(!E.isFeatureCollection&&(I["default"].includes(E.types,"is-feature")||I["default"].includes(E.types,"is-tile")||I["default"].includes(E.types,"is-table")))if(!Ca&&E.url){var la=q.__assign({url:E.url+"/layers"},ia&&{content:{token:ia}});this._request(la,ia?void 0:{addToken:!1}).then(function(pa){var Aa;pa.currentVersion?S.fetchIndividualLayers(E).then(function(va){return xa.resolve(va)}):
(E=d["default"].mixin(E,{tables:S.fixLayers(E,pa.tables,"Table"),featureLayers:(null===(Aa=pa.layers)||void 0===Aa?0:Aa.length)?S.fixLayers(E,pa.layers,"Feature Layer"):pa.layers?null:[].concat(pa),reviewTable:S.findReviewTable(E,pa.tables||[])}),xa.resolve([].concat(E.featureLayers||[]).concat(E.tables||[])))},function(pa){S.fetchIndividualLayers(E).then(function(Aa){return xa.resolve(Aa)})})}else E.url?(P[E.isTable?"tables":"featureLayers"]=[].concat(d["default"].mixin({},Ga,{url:K["default"].needsToken(E,
E.url),name:null!==(la=Ga.name)&&void 0!==la?la:K["default"].getServiceNameFromUrl(E)})),E=d["default"].mixin(E,P),xa.resolve(E.isTable?E.tables:E.featureLayers)):xa.resolve(E);else I["default"].includes(E.types,"is-tool")&&10.6<=Ga.currentVersion?(E=d["default"].mixin(E,{tools:this.fixToolLayers(E,Ga.tasks||[])}),xa.resolve([].concat(E.tools||[]))):I["default"].includes(E.types,"is-service")&&"Map Service"===E.type&&((null===(na=null===Ga||void 0===Ga?void 0:Ga.tables)||void 0===na?0:na.length)||
(null===(qa=null===Ga||void 0===Ga?void 0:Ga.layers)||void 0===qa?0:qa.length))?(E=d["default"].mixin(E,{featureLayers:Ga.layers.map(function(pa){return q.__assign(q.__assign({},pa),{url:K["default"].needsToken(E,E.url+"/"+pa.id)})}),tables:Ga.tables.map(function(pa){return q.__assign(q.__assign({},pa),{url:K["default"].needsToken(E,E.url+"/"+pa.id)})})}),xa.resolve([].concat(E.featureLayers).concat(E.tables))):I["default"].includes(E.types,"is-service")?(E=d["default"].mixin(E,{featureLayers:[].concat(d["default"].mixin({},
Ga,{url:K["default"].needsToken(E,E.url),name:K["default"].getServiceNameFromUrl(E)}))}),xa.resolve(E.featureLayers)):!E.isFeatureCollection||E.isMapNotes||E.isMarkup?xa.resolve(null):((Ga.layers||[]).forEach(function(pa){ja=(ca=pa.layerDefinition)&&"Table"===ca.type?Ba:Na;ca&&ja.push(ca)}),E=d["default"].mixin(E,{tables:this.fixLayers(E,Ba,"Table"),featureLayers:(null===Na||void 0===Na?0:Na.length)?this.fixLayers(E,Na,"Feature Layer"):Ga.layers?null:[].concat(void 0)}),xa.resolve([].concat(E.featureLayers||
[]).concat(E.tables||[])));return xa};Da.prototype.fetchIndividualLayers=function(E){var S=this,ia=new u["default"],na=E.serviceInfo||{},qa=K["default"].getNeededToken(E),xa=qa?void 0:{addToken:!1},Ca=w["default"]((na.layers||[]).map(function(Ga){Ga=q.__assign({url:E.url+"/"+Ga.id},qa&&{content:{token:qa}});return S._request(Ga,xa)}));na=w["default"]((na.table||[]).map(function(Ga){Ga=q.__assign({url:E.url+"/"+Ga.id},qa&&{content:{token:qa}});return S._request(Ga,xa)}));w["default"]({tables:na,layers:Ca}).then(function(Ga){var Na;
E=d["default"].mixin(E,{tables:S.fixLayers(E,Ga.tables,"Table"),featureLayers:(null===(Na=Ga.layers)||void 0===Na?0:Na.length)?S.fixLayers(E,Ga.layers,"Feature Layer"):Ga.layers?null:[].concat(Ga),reviewTable:S.findReviewTable(E,Ga.tables||[])});ia.resolve([].concat(E.featureLayers||[]).concat(E.tables||[]))},function(){return ia.resolve(null)});return ia};Da.prototype.checkImageryExportAvailablity=function(E){var S,ia,na=new u["default"],qa=E.portal,xa=E.isOwner,Ca=E.isHostedService,Ga=E.type,Na=
E.typeKeywords;xa=E.isAdmin||xa;var Ba=null===(ia=null===(S=qa.getPortalUser())||void 0===S?void 0:S.userRole)||void 0===ia?void 0:ia.canPublishTiledImagery();if(!(!qa.isPortal&&"Image Service"===Ga&&Ca&&I["default"].includes(null!==Na&&void 0!==Na?Na:[],"Tiled Imagery")&&xa&&Ba))return na.resolve(!1),na;this._request({url:J["default"].self.helperServices.rasterAnalytics.url+"/ExportToTilePackage",content:{f:"json"}},{disableIdentityLookup:!0,addToken:K["default"].addToken(E)}).then(function(P){return na.resolve("ExportToTilePackage"===
(null===P||void 0===P?void 0:P.name))},function(){return na.resolve(!1)});return na};Da.prototype.fixLayers=function(E,S,ia){var na=this,qa,xa,Ca="Table"!==ia&&(null===(xa=null===(qa=E.itemData)||void 0===qa?void 0:qa.layers)||void 0===xa?0:xa.length)?E.itemData.layers:S,Ga=E.isFeatureCollection;S=null===S||void 0===S?void 0:S.filter(function(Na){return"Table"===ia&&"Review"===Na.name?!1:(Ca||[]).some(function(Ba){Ba=Ba&&z["default"].isDefined(Ba.id)?Ba:Ba.layerDefinition||Ba||{};return Na.id===Ba.id})}).map(function(Na){return d["default"].mixin(Na,
{name:na.fixTitle(Na.name),type:Na.type||ia,url:Ga?null:K["default"].needsToken(E,E.url+(!Ga&&z["default"].isDefined(Na.id)?"/"+Na.id:""))})});return(null===S||void 0===S?0:S.length)?S:null};Da.prototype.fixToolLayers=function(E,S){var ia=this;return S.map(function(na){return d["default"].mixin({},{name:ia.fixTitle(na),url:K["default"].needsToken(E,E.url+"/"+na)})})};Da.prototype.findReviewTable=function(E,S){var ia,na=S.filter(function(qa){return"Table"===qa.type&&"Review"===qa.name}).map(function(qa){return d["default"].mixin(qa,
{url:K["default"].needsToken(E,E.url+z["default"].isDefined(qa.id)?"/"+qa.id:"")})});return null!==(ia=null===na||void 0===na?void 0:na[0])&&void 0!==ia?ia:null};Da.prototype.fetchMapLayers=function(E){var S=this,ia=new u["default"],na,qa=[],xa="Web Scene"===E.type;I["default"].includes(E.types,"is-map")||I["default"].includes(E.types,"is-scene")?this.fetchItemData().then(function(Ca){E.itemData=Ca;var Ga=d["default"].clone(Ca);if(Ga){Ca=Ga.baseMap||{};var Na=Ga.operationalLayers,Ba=Ca.baseMapLayers,
P=Ca.elevationLayers,ca=Ga.tables;E=d["default"].mixin(E,{baseMapLayers:Ba,operationalLayers:Na,elevationLayers:P,tables:ca,presentation:I["default"].includes(E.types,"is-scene")?null:Ga.presentation});Ga=[].concat(Na||[]).concat(P||[]).concat(Ba||[]).concat(ca||[]);for(Na=0;Na<Ga.length;++Na){Ba=Ga[Na];if(xa)for(na=[].concat(Ba.layers||[]),P=0;P<na.length;++P)S.setLayerProps(na[P],Ca);qa.push(d["default"].mixin(Ba,S.setLayerProps(Ba,Ca),{subLayers:na||null}))}}ia.resolve(qa)}):ia.resolve(null);return ia};
Da.prototype.fetchTypeKeywords=function(E){var S=new u["default"];N["default"].request({url:E.itemUrl}).then(function(ia){E.set({typeKeywords:(null===ia||void 0===ia?void 0:ia.typeKeywords)||E.typeKeywords});"Image Service"===(null===ia||void 0===ia?void 0:ia.type)&&ia.size!==E.size&&E.set({size:ia.size,subInfo:ia.subInfo});S.resolve(E.typeKeywords)});return S};Da.prototype.setLayerProps=function(E,S){var ia=E.url||E.styleUrl,na=E.type||E.layerType,qa=E.itemId?"item.html?id\x3d"+E.itemId:null,xa=
E.wmtsInfo;xa?(E.title=xa.layerIdentifier||E.title,E.url=xa.url):"VectorTileLayer"===na&&E.styleUrl?qa=this.getVectorTileItemUrl(qa,E):E.url="OpenStreetMap"===na?"//www.openstreetmap.org/":ia;S&&(E.baseMapTitle=S.title);return d["default"].mixin(E,{url:E.url,itemUrl:qa,type:na,name:E.title?this.fixTitle(E.title):K["default"].getServiceNameFromUrl({url:E.url,title:S.title})})};Da.prototype.fixTitle=function(E){E=N["default"].htmlEncode(E);try{E=decodeURI(E)}catch(S){}return E};Da.prototype.getVectorTileItemUrl=
function(E,S){var ia=S.styleUrl;if(E){var na=N["default"].parseUrl(E),qa=N["default"].parseUrl(ia),xa=-1<ia.indexOf(".arcgis.com");ia=-1<ia.indexOf("cdn.arcgis.com")||xa&&(null===S||void 0===S?0:S.itemId)&&ia.match(/tile.*.arcgis.com/i)?!0:!1;return"//"+(!xa||ia?na.host+na.relative:qa.host+na.relative.substr(na.relative.indexOf("/home/")))}return ia};Da.prototype.geocodeReview=function(E){var S=new u["default"],ia=E.typeKeywords||[],na=I["default"].includes(ia,"showUnmatchedAddresses"),qa=E.userItemUrl;
E.canUpdate&&na?w["default"]({typeKeywords:N["default"].request({url:qa+"/update",content:{typeKeywords:I["default"].filterOut(ia,["showUnmatchedAddresses"]).join(",")}},{usePost:!0}),geocodeCountResults:ba["default"].queryGeocodeCounts(E)}).then(function(xa){E.set("typeKeywords",ia);S.resolve(E);if(xa.geocodeCountResults){xa=xa.geocodeCountResults;xa=x["default"].substitute(ha["default"].itemProperties[xa.successful!==xa.total?"invalidGeocodeMsg":"validGeocodeMsg"],xa);var Ca=new V["default"]({buttonOkLabel:ha["default"].common.yesLabel,
buttonCancelLabel:ha["default"].common.noLabel,style:{width:"400px",height:"auto"}});Ca.show({message:xa,title:ha["default"].geocodePanel.geocodePanelTitle}).then(function(Ga){"onOk"===Ga&&Ca.hide().then(function(){window.location.href="./webmap/viewer.html?layers\x3d"+E.id+"\x26review\x3dtrue"})})}}):S.resolve(E);return S};Da.prototype.updateItem=function(E,S){var ia=this,na=new u["default"];this._item.canUpdate?O["default"].updateItem(d["default"].mixin({},E,{id:this._item.id,folderId:this._item.folderId,
owner:this._item.owner}),this.portal).then(function(){var qa,xa;delete E.clearEmptyFields;E.serviceProxyFilter&&E.url&&delete E.url;var Ca=E.url&&ia._item.url&&E.url!==ia._item.url;S||(ia._item.set(E),Ca&&(sa["default"].appViewer(ia._item),Ca=-1<(null===(qa=ia._item.typeKeywords)||void 0===qa?void 0:qa.indexOf("Service Proxy"))?(-1<ia._item.url.indexOf("?")?"\x26":"?")+"f\x3dpjson":"",qa="WFS"===ia._item.type&&-1===(null===(xa=ia._item.url)||void 0===xa?void 0:xa.toLowerCase().indexOf("getcapabilities"))?
(-1<ia._item.url.indexOf("?")?"\x26":"?")+"request\x3dgetcapabilities":"",ia._item.viewUrl=ia.portal.isPortal?encodeURI(ia._item.url?ia._item.url+Ca+qa:ia._item.itemDataUrl):encodeURI(ia._item.url&&!ia.portal.isPortal?K["default"].needsToken(ia._item,ia._item.url)+Ca+qa:ia._item.itemDataUrl)),E.advancedSettings&&ia._item.set("advancedSettings",JSON.parse(E.advancedSettings)));na.resolve(ia._item)},function(qa){ia._showError(d["default"].clone(qa));na.reject(qa)}):na.resolve(this._item);return na};
Da.prototype.fetchComments=function(E){var S=new u["default"];E.getComments().then(function(ia){ia=ia.map(function(na){return na.getReplies()});return w["default"](ia)}).then(function(){return S.resolve(E.comments)});return S};Da.prototype.processItem=function(E){switch(E.classification){case "layer":E=this.processLayer(E);break;case "map":E=this.processMap(E);break;case "app":E=this.processApp(E);break;case "file":E=this.processFile(E);break;case "notebook":E=this.processFile(E);break;case "solution":E=
this.processSolution(E);break;default:E=this.processGeneric(E)}return E};Da.prototype.processHostedLayer=function(E){var S=this,ia=new u["default"],na=1<E.typeKeywords.indexOf("usesSnapshot");E.isHostedService&&(E.types.push("is-hosted"),E.url=K["default"].needsSSL(E,E.url));if((E.canUpdate||E.canDelete)&&(E.isHostedService||na)){var qa={serverToken:ba["default"].fetchServerToken(E)};this.portal.isPortal?(na="Knowledge Graph"===E.type?this.portal.getFederatedServerByFunction("KnowledgeServer"):this.portal.getHostedFederatedServers(),
v["default"](this._hostedFederatedServer||na,function(xa){S._hostedFederatedServer=xa;N["default"].onFederatedServer(E.url)?(E.adminUrl=ba["default"].fetchItemAdminUrl(E,S._hostedFederatedServer),qa=d["default"].mixin(qa,{adminServerToken:ba["default"].fetchServerToken(E,E.adminUrl)}),w["default"](qa).then(function(Ca){E=d["default"].mixin(E,Ca);ia.resolve(E)})):(E.adminUrl=ba["default"].fetchItemAdminUrl(E,null),qa=d["default"].mixin(qa,{adminServerToken:ba["default"].fetchServerToken(E,E.adminUrl)}),
w["default"](qa).then(function(Ca){return ia.resolve(d["default"].mixin(E,Ca))}))})):(E.adminUrl=ba["default"].fetchItemAdminUrl(E,null),qa=d["default"].mixin(qa,{adminServerToken:ba["default"].fetchServerToken(E,E.adminUrl)}),w["default"](qa).then(function(xa){return ia.resolve(d["default"].mixin(E,xa))}))}else ia.resolve(E);return ia};Da.prototype.processLayer=function(E){var S=this,ia=new u["default"],na=!1,qa="Feature Service;Map Service;Vector Tile Service;Scene Service;Image Service;WFS;OGCFeatureServer;Knowledge Graph".split(";"),
xa=1<E.typeKeywords.indexOf("usesSnapshot");E.watch("status",function(){var Ca,Ga;"completed"===E.status&&(null===(Ca=E.serviceInfo)||void 0===Ca?0:Ca.error)&&(E.serviceInfo=void 0);if(!E.serviceInfo&&"completed"===E.status)w["default"]({itemData:"Feature Service"===E.type||E.isFeatureCollection?S.fetchItemData():null,typeKeywords:S.fetchTypeKeywords(E)}).then(function(Ba){E.resetTypeKeywordInfo();E.set("displayName",S._formatDisplayName());"Image Service"===S._item.type&&S.processCompletedImageryLayerItem();
S._item=d["default"].mixin(S._item,Ba);S.portal.isPortal&&S._item.adminUrl&&(Ba=ba["default"].fetchItemAdminUrl(E,S._hostedFederatedServer),S._item.adminUrl=Ba,E.adminUrl=Ba);w["default"]({serviceInfo:S._fetchServiceInfo(E),isExportableTiledImagery:S.checkImageryExportAvailablity(E)}).then(function(P){var ca=P.isExportableTiledImagery;delete P.isExportableTiledImagery;S._item=d["default"].mixin(S._item,P);na=(null===P||void 0===P?void 0:P.serviceInfo)&&P.serviceInfo.error;P={layers:na?null:S.fetchServiceLayers(E),
hasResources:ba["default"].checkForResources(E)};(E.canUpdate||E.canDelete)&&(E.isHostedService&&I["default"].includes(qa,E.type)||xa)&&(P=d["default"].mixin(P,{adminServiceInfo:S.fetchAdminServiceInfo(E)}));S.canManageImageCollection()&&S.updateImageManagementTabState();w["default"](P).then(function(ja){S._item=d["default"].mixin(S._item,ja);ba["default"].cacheMaxAgeCheck(S._item,ja.adminServiceInfo);S._item.isMultipatchFeatureService=K["default"].isMultipatchFeatureService(E);w["default"]({isExportableByUser:K["default"].isExportableByUser(E),
isOverwriteSupported:K["default"].isOverwriteableService(E,!1),isOverwriteCloudSupported:K["default"].isOverwriteableCloudService(E),canPublishTileService:K["default"].canPublishTileServiceFromFeatureService(E),canPublishVectorTileService:K["default"].canPublishVectorTileServiceFromFeatureService(E),canPublishWFSService:K["default"].canPublishWFSServiceFromFeatureService(E),canPublishOGCFeatureServer:K["default"].canPublishOGCFeatureServerFromFeatureService(E),canPublishSceneService:K["default"].canPublishSceneServiceFromFeatureService(E),
canPublishViewService:K["default"].canPublishViewServiceFromFeatureService(E),canPublishDynamicImagerService:K["default"].canPublishImageServiceAsDynamic(E),canPublishTiledImagerService:K["default"].canPublishImageServiceAsTiled(E),canExportImagery:ca&&K["default"].canExportImagery(E),isFilePublishableByUser:I["default"].includes(E.types,"is-featureCollection")?K["default"].isFilePublishableByUser(E):null,isEditableByUser:K["default"].isServiceEditableByUser(E),canEnableAttachments:K["default"].canEnableAttachments(E),
canAppendData:K["default"].canAppendData(E),isTiledImageryLayer:K["default"].isTiledImageryService(E)}).then(function(la){var pa=d["default"].mixin(S._item,la),Aa=S._item.types||[],va=S._item.privileges||[],Ja=la.isFilePublishableByUser||la.canPublishTileService||la.canPublishWFSService||la.canPublishOGCFeatureServer||la.canPublishSceneService||la.canPublishViewService||la.canPublishDynamicImagerService||la.canPublishTiledImagerService,Ka=I["default"].includes(Aa,"is-scene-2")&&!I["default"].includes(pa.typeKeywords,
"HasOnlyMultipatchGeometries");Aa=I["default"][la.isOverwriteSupported?"concatUnique":"filterOut"](Aa,["is-overwrite"]);Aa=I["default"][la.isOverwriteCloudSupported?"concatUnique":"filterOut"](Aa,["is-overwriteCloud"]);Aa=I["default"][K["default"].isMultipatchFeatureService(pa)?"concatUnique":"filterOut"](Aa,["is-multipatch"]);Aa=I["default"][S._item.isTiledImageryLayer?"concatUnique":"filterOut"](Aa,["is-tiled-imagery"]);Aa=I["default"][S._item.isVelocity()?"concatUnique":"filterOut"](Aa,["is-velocity"]);
va=I["default"][la.canPublishTileService?"concatUnique":"filterOut"](va,["can-publish-tiles"]);va=I["default"][la.canPublishWFSService?"concatUnique":"filterOut"](va,["can-publish-wfs"]);va=I["default"][la.canPublishOGCFeatureServer?"concatUnique":"filterOut"](va,["can-publish-ogcfeatures"]);va=I["default"][la.canPublishSceneService?"concatUnique":"filterOut"](va,["can-publish-scenes"]);va=I["default"][la.canPublishViewService?"concatUnique":"filterOut"](va,["can-publish-views"]);va=I["default"][pa.isEditableByUser&&
"Feature Service"===S._item.type?"concatUnique":"filterOut"](va,["can-edit-service"]);va=I["default"][la.canPublishVectorTileService?"concatUnique":"filterOut"](va,["can-publish-vectorTiles"]);va=I["default"][pa.isExportableByUser?"concatUnique":"filterOut"](va,["can-export"]);va=I["default"][la.canExportImagery?"concatUnique":"filterOut"](va,["can-export-imagery"]);va=I["default"][la.canPublishTiledImagerService?"concatUnique":"filterOut"](va,["can-publish-imagery-tiles"]);va=I["default"][la.canPublishDynamicImagerService?
"concatUnique":"filterOut"](va,["can-publish-imagery-dynamic"]);va=I["default"][pa.isLocationTrackingService?"concatUnique":"filterOut"](va,["is-location-tracking"]);va=I["default"][la.canEnableAttachments?"concatUnique":"filterOut"](va,["can-enableAttachments"]);va=I["default"][la.isFilePublishableByUser?"concatUnique":"filterOut"](va,["can-publish"]);va=I["default"][la.canAppendData?"concatUnique":"filterOut"](va,["can-appendData"]);Aa=I["default"][Ka?"concatUnique":"filterOut"](Aa,["is-scene-2"]);
Aa=I["default"][S._item.typeKeywords.includes("ExtractedCache")||!I["default"].includes(S._item.types,"is-vectorTile")||S._item.isHostedService?"filterOut":"concatUnique"](Aa,["is-update"]);Aa=I["default"][Ja?"concatUnique":"filterOut"](Aa,["is-publish"]);S._item.set({types:Aa,privileges:va});S._item.hasResources&&(S.set("actionUrls",pa),m["default"](".js-open-viewStyle").attr("href",pa.viewStyleUrl),m["default"](".js-open-downloadStyle").attr("href",pa.downloadStyleUrl));S._item.isHostedService&&
"WFS"===S._item.type&&S._item.set("url",S._item.url+"?service\x3dwfs\x26request\x3dgetcapabilities");S._item.canUpdate&&S._item.isHostedService&&!I["default"].includes(S._item.typeKeywords,"View Service")?ba["default"].setFeatureServiceScaleRanges(pa).then(function(){S._item.set("isLoaded",!0);ia.resolve(S._item)}):(S._item.set("isLoaded",!0),ia.resolve(S._item))})})})});else if("failed"===E.status&&E.statusError){var Na=ha["default"].common.errors.genericError.message;Na=E.statusError.split(".")[0].split(":")[1]+
".";S.portal.isKubernetes()&&-1!==(null===(Ga=E.statusError)||void 0===Ga?void 0:Ga.indexOf("Publishing from ArcMap to ArcGIS Enterprise on Kubernetes is not supported."))&&(Na+=" Publishing from ArcMap to ArcGIS Enterprise on Kubernetes is not supported.");setTimeout(function(){var Ba;ta["default"].showAlert("error",Na);S.itemCanShowSettingsTab(E)&&A["default"].disableNode(null===(Ba=S.subnav)||void 0===Ba?void 0:Ba.domNode.querySelector('a[data-tab\x3d"settings"]'),!1)},500)}});E.watch("readyForGeocodeReview",
function(){if(S._item.canUpdate&&S._item.isHostedService&&S._item.readyForGeocodeReview&&-1<S._item.typeKeywords.indexOf("showUnmatchedAddresses"))var Ca=setInterval(function(){S._item.isLoaded&&(clearInterval(Ca),S.geocodeReview(S._item))},1E3)});this.processHostedLayer(E).then(function(Ca){w["default"]({sourceData:!I["default"].includes(Ca.typeKeywords,"Cloud Drive")&&I["default"].includes(qa,Ca.type)||I["default"].includes(Ca.typeKeywords,"Bulk Published Service")||"Route Layer"===Ca.displayName?
Ca.getSourceData():null,resultData:"Feature Service"===Ca.type||Ca.isFeatureCollection||"Feed"===Ca.type?Ca.getResultData():null}).then(function(Ga){S._item=d["default"].mixin(S._item,Ga);ma["default"].checkStatus(S._item).then(function(Na){S._item=d["default"].mixin(S._item,Na);setTimeout(function(){ia.resolve(Ca)},300)})})});return ia};Da.prototype.processMap=function(E){var S=this,ia=new u["default"];w["default"]({layers:this.fetchMapLayers(E),isApplicationCreateableFromItem:K["default"].isApplicationCreateableFromItem(E)}).then(function(na){S._item=
d["default"].mixin(S._item,na);S._item.set("isLoaded",!0);S._item.canUpdate&&!S.portal.isPortal&&S._item.privileges.push("can-create-presentation");ia.resolve(S._item)});return ia};Da.prototype.processApp=function(E){var S=this,ia=new u["default"];w["default"]({itemData:E.hasItemData?this.fetchItemData():null,codeAttachment:this.fetchRelatedItems(E,"Mobile Application"===E.type?"MobileApp2Code":"WMA2Code","forward"),isApplicationCreateableFromItem:K["default"].isApplicationCreateableFromItem(E),relatedService:"Form"===
E.type?this.fetchRelatedItems(E,"Survey2Service","forward"):"QuickCapture Project"===E.type?this.fetchRelatedItems(E,"QuickCaptureProject2Service","forward"):null}).then(function(na){S._item=d["default"].mixin(S._item,na);S._hideErrors=!0;K["default"].isConfigurableApplication(E).then(function(qa){var xa,Ca,Ga,Na;S._hideErrors=!1;S._item.isConfigurableApp=qa;S._item.isConfigurableApp&&!S._item.origin&&S._item.privileges.push("can-configure");I["default"].includes(E.typeKeywords,"Web AppBuilder")&&
(E.codeAttachment=S._item.isAdmin?E.codeAttachment:null,E.types.push("is-dataUrl"),E.canUpdate&&!S._item.origin&&(E.privileges.push("can-edit-wab"),E.removeBlockedTypes(S.blockedApps)));if((null===(xa=na.itemData)||void 0===xa?0:xa.workerWebMapId)||(null===(Ca=na.itemData)||void 0===Ca?0:Ca.dispatcherWebMapId))S._item.projectContent=na.itemData;if(null===(Ga=na.itemData)||void 0===Ga?0:Ga.workflowLocations)S._item.workflowContent=na.itemData;(null===(Na=S.portalUser)||void 0===Na?0:Na.isOrgUser)&&
"Form"===E.type&&(E.types.push("is-surveyForm"),E.removeBlockedTypes(S.blockedApps));S._item.set("isLoaded",!0);ia.resolve(S._item)})});return ia};Da.prototype.processFile=function(E){var S=this,ia=new u["default"];w["default"]({isPublishableByUser:K["default"].isFilePublishableByUser(E),resultData:E.getResultData()}).then(function(na){var qa;S._item=d["default"].mixin(S._item,na);na=(null===(qa=null===na||void 0===na?void 0:na.resultData)||void 0===qa?void 0:qa[0])||na.resultData;S._item.isPublishableByUser&&
S._item.privileges.push("can-publish");na&&I["default"].includes(S._item.types,"is-publish")&&S._item.types.splice(S._item.types.indexOf("is-publish"),1);S._item.set("isLoaded",!0);ia.resolve(S._item)});return ia};Da.prototype.processSolution=function(E){var S=this,ia=new u["default"];w["default"]({itemData:E.hasItemData?this.fetchItemData():null}).then(function(na){S._item=d["default"].mixin(S._item,na);S._item.set("isLoaded",!0);ia.resolve(S._item)});return ia};Da.prototype.processGeneric=function(E){var S=
new u["default"];this._item.set("isLoaded",!0);S.resolve(E);return S};Da.prototype.processCompletedImageryLayerItem=function(){var E,S=this._item;"Image Service"===S.type&&"completed"===S.status&&(null===(E=S.properties)||void 0===E?0:E.jobUrl)&&(S.isAdmin||S.isOwner||S.canUpdate)&&(S.isHostedService||I["default"].includes(S.typeKeywords,"Managed Image Collection"))&&(E=S.properties,delete E.jobId,delete E.jobUrl,delete E.jobStatus,delete E.jobType,this.updateItem({properties:JSON.stringify(E)}),
S.set("properties",E))};Da.prototype.getThumbnail=function(E){var S=this,ia=new u["default"],na=this._item;na.getThumbnail(E).then(function(qa){E&&-1===qa.indexOf("token")?S.updateItem({thumbnailUrl:qa}).then(function(){N["default"].request({url:na.itemUrl}).then(function(xa){na.thumbnail=qa;na.setScoreCompleteness(xa.scoreCompleteness);na.set("thumbnailUrl",qa);ia.resolve(qa)})}):ia.resolve(qa)});return ia};Da.prototype.getItemOwner=function(E){var S=new u["default"];E.getOwnerProfile(!0,!0).then(function(ia){E.set("itemOwner",
ia);S.resolve(ia)});return S};Da.prototype.showPublicDataCollectionWarning=function(E){var S,ia=this._item;E=E||(null===(S=ia.serviceInfo)||void 0===S?void 0:S.capabilities)||[];S=this.domNode.querySelector(".js-public-data-collection-alert");"Feature Service"===ia.type&&ia.canUpdate&&"public"===ia.access&&-1<E.indexOf("Editing")&&-1===ia.typeKeywords.indexOf("Public Data Collection")&&-1<ia.typeKeywords.indexOf("Hosted Service")?S.classList.add("is-active"):S.classList.remove("is-active")};Da.prototype.refreshServiceInfo=
function(){var E=this,S={};z["default"].isDefined(this._item.serviceInfo)&&(S.serviceInfo=this._fetchServiceInfo(this._item));z["default"].isDefined(this._item.adminServiceInfo)&&(S.adminServiceInfo=this.fetchAdminServiceInfo(this._item));z["default"].isDefined(this._item.layers)&&(S.layers=this.fetchServiceLayers(this._item));K["default"].isEmptyObject(S)||w["default"](S).then(function(ia){var na;E._item=d["default"].mixin(E._item,ia);E.sublayer&&(null===(na=ia.layers)||void 0===na?0:na[E.sublayer.id])&&
(E.sublayer=ia.layers[E.sublayer.id]);E.emit("service-info-change")})};Da.prototype.storeCacheJobInfo=function(E){var S=this,ia=this._item.properties,na=E.jobId;E=E.jobUrl;if(na||E)ia=q.__assign(q.__assign({},ia),{cacheJobId:na,cacheJobUrl:E}),this.updateItem({properties:JSON.stringify(ia)}).then(function(){S._item.set("properties",ia)})};Da.prototype.dropCacheJobInfo=function(){var E=this,S,ia=null===(S=this._item)||void 0===S?void 0:S.properties;if((null===ia||void 0===ia?0:ia.cacheJobId)||(null===
ia||void 0===ia?0:ia.cacheJobUrl))(null===ia||void 0===ia?0:ia.cacheJobId)&&delete ia.cacheJobId,(null===ia||void 0===ia?0:ia.cacheJobUrl)&&delete ia.cacheJobUrl,S=ia?JSON.stringify(ia):"{}",this.updateItem({properties:S}).then(function(){E._item.set("properties",ia)})};Da.prototype.refreshCodeAttachment=function(){var E=this,S=new u["default"],ia="Mobile Application"===this._item.type?"MobileApp2Code":"WMA2Code";this._item.relatedItems[ia+"_forward"]=null;w["default"]({codeAttachment:this.fetchRelatedItems(this._item,
ia,"forward")}).then(function(na){E._item=d["default"].mixin(E._item,na);I["default"].includes(E._item.typeKeywords,"Web AppBuilder")&&!E._item.canUpdate?E._item.set("codeAttachment",null):E._item.set("codeAttachment",E._item.codeAttachment);S.resolve(E._item)});return S};Da.prototype._formatCommentDate=function(E){return this.i18n.itemProperties.commented+" "+p["default"](E).fromNow()};Da.prototype._formatDate=function(E){!1===E instanceof Date&&(E=new Date(E));return E?R["default"].format(E,"long-month-day-year"):
""};Da.prototype._formatTime=function(E){!1===E instanceof Date&&(E=new Date(E));return E?R["default"].format(E,"short-time"):""};Da.prototype._formatDateTime=function(E){!1===E instanceof Date&&(E=new Date(E));return E?R["default"].format(E,"day-short-month-year-short-time"):""};Da.prototype._formatTags=function(E){E=E&&"string"===typeof E?E.split(","):E||[];var S="settings-tab"===this._currentView;return E.map(function(ia){var na=N["default"].htmlEncode(ia);return S?ia:'\x3ca href\x3d"search.html?t\x3dcontent\x26q\x3dtags:'+
na+'"\x3e'+na+"\x3c/a\x3e"}).join(", ")};Da.prototype._formatSharing=function(E){var S=this,ia=ha["default"].itemProperties,na=E.access;E=E.groups;var qa;"private"===na?qa=ia.itemNotShared:"public"===na?qa=ia.everyone:"org"===na?qa=ia.organization:"shared"===na&&(qa=(null===E||void 0===E?0:E.length)?null:ia.itemNotShared);if(null===E||void 0===E?0:E.length)E=E.map(function(xa){var Ca=N["default"].htmlEncode(xa.title);xa="group.html?owner\x3d"+xa.owner+"\x26title\x3d"+encodeURIComponent(xa.title);
return x["default"].substitute('\x3ca href\x3d"${url}" alt\x3d"${i18n.itemProperties.groupDetails}" title\x3d"${i18n.itemProperties.groupDetails}"\x3e${title}\x3c/a\x3e',{url:xa,title:Ca,i18n:S.i18n})}),qa=(qa?qa+", ":"")+E.join(", ");return qa};Da.prototype._formatServiceLink=function(E){E=this._item||E;var S=E.type,ia=I["default"].includes(E.typeKeywords,"Service")&&"Service Definition"!==S||"Feature Collection"===S,na=K["default"].needsToken(E,E.url);S=ia?'\x3ca target\x3d"_blank" href\x3d"'+("Feature Collection"===
S?E.itemDataUrl:na)+'"\x3e'+S+"\x3c/a\x3e":null;E.set("serviceLink",S);return S||""};Da.prototype._formatDisplayName=function(E,S){void 0===E&&(E=this._item);var ia=E.typeKeywords,na="Feature Service"===E.type,qa="Data Store"===E.type,xa=E.displayName,Ca="";"Scene Service"===E.type&&(I["default"].includes(ia,"IntegratedMesh")?Ca="Integrated Mesh":I["default"].includes(ia,"3DObject")?Ca="3D Object":I["default"].includes(ia,"Point")?Ca="Point":I["default"].includes(ia,"PointCloud")?Ca="Point Cloud":
I["default"].includes(ia,"Building")?Ca="Building Scene Layer":I["default"].includes(ia,"Voxel")&&(Ca="Voxel Scene Layer"),Ca.length&&(xa+=" - "+Ca));if(I["default"].includes(ia,"EditExtensionIndoorsSpaces"))return"Indoors Spaces Feature Layer";!E.canUpdate&&!E.canDelete||E.isUtilityNetwork||(E.isHostedService?xa+=" ("+(E.isDataView?this.i18n.viewsWidget.hostedView:na?this.i18n.viewsWidget.hostedData:this.i18n.viewsWidget.hostedService)+")":E.isLocatorView?xa+=" ("+this.i18n.viewsWidget.locatorView+
")":E.isPhotoLocations&&(xa+=" ("+this.i18n.viewsWidget.photoLocations+")"));qa&&(xa=K["default"].formatDataStoreItem(xa,ia));return xa};Da.prototype._formatSize=function(E){return E?1024>=E?"1 \x3csmall class\x3d'font-size--3'\x3eKB\x3c/small\x3e":1048576>E?L["default"].format(E/1024)+" \x3csmall class\x3d'font-size--3'\x3eKB\x3c/small\x3e":L["default"].format(E/1048576)+" \x3csmall class\x3d'font-size--3'\x3eMB\x3c/small\x3e":"0 \x3csmall class\x3d'font-size--3'\x3eKB\x3c/small\x3e"};Da.prototype._formatRating=
function(E){return""+E||"0.0"};Da.prototype._formatCount=function(E){return""+E||"0"};Da.prototype._formatViews=function(){var E="file"!==this._item.classification||I["default"].includes(this._item.types,"is-views")||I["default"].includes(this._item.types,"is-pdf")?"views":"downloads";return this.i18n.itemProperties[E]};Da.prototype._formatNumber=function(E){return L["default"].format(E)};Da.prototype._formatRatingsViewsDownloads=function(E){E=this._item.codeAttachment;var S=L["default"].format(this._item.numRatings||
0),ia=L["default"].format(this._item.numViews||0);return x["default"].substitute("${i18n.viewsWidget.startBracket}${numRatings}${i18n.viewsWidget.endBracket} \x3cspan class\x3d'margin-left-1 text-darkest-gray'\x3e${numViews}\x3c/span\x3e"+(E?", ${numDownloads} ${i18n.itemProperties.downloads}":""),{item:this._item,numRatings:S,numViews:x["default"].substitute(ha["default"].viewsWidget.universalViewsMsgAlone,{viewcount:ia}),numDownloads:L["default"].format((null===E||void 0===E?void 0:E.numViews)||
0),i18n:this.i18n},null,this)};Da.prototype._formatItemTypeSearch=function(E){return encodeURI('search.html?t\x3dcontent\x26q\x3dtype:"'+E+'"')};Da.prototype._formatSocialLink=function(E){return x["default"].substitute("socialnetwork.html?t\x3d${title}\x26n\x3d${socialNetwork}\x26u\x3d${url}",{title:N["default"].socialNetworkTitle(this._item.title),url:window.location.href,socialNetwork:E})};Da.prototype._formatTwitterLink=function(){return this._formatSocialLink("tw")};Da.prototype._formatFacebookLink=
function(){return this._formatSocialLink("fb")};Da.prototype._formatAppApi=function(){var E=this._item.types,S=K["default"].getAppApi(this._item);E=I["default"].includes(E,"is-mobile")?this.i18n.itemProperties.sdkLbl:I["default"].includes(E,"is-platform")?this.i18n.itemProperties.platformLbl:this.i18n.itemProperties.apiLbl;return S?x["default"].substitute("${label} ${api}",{label:E,api:S}):""};Da.prototype._formatAppPurpose=function(){var E=K["default"].getAppPurpose(this._item);return E?x["default"].substitute("${i18n.itemProperties.purposeLbl} ${purpose}",
{i18n:this.i18n,purpose:E}):""};Da.prototype._formatApplicable=function(E){return I["default"].includes(this._item.typeKeywords,"HTML3D")?this.i18n.addItemFrm["3d"]:this.i18n.addItemFrm["2d"]};Da.prototype._formatWellDone=function(E){return this._item.canUpdate&&100<=E?x["default"].substitute(this.i18n.itemCompleteness.wellDone,{threshold:"100%",nominateLink:"https://www.esri.com"}):""};Da.prototype._formatMapViewerPrimaryLink=function(E){var S=E.mapViewerUrl,ia=E.newMapViewerUrl,na="modern"===E.portal.defaultMapViewer,
qa="OGCFeatureServer"===E.type;return E.canOpenInNewMapViewer&&na||qa?ia:S};Da.prototype._formatMapViewerPrimaryLabel=function(E){var S="modern"===E.portal.defaultMapViewer,ia="OGCFeatureServer"===E.type,na=ha["default"].itemLinks;return E.canOpenInNewMapViewer&&S||ia?na.openMapViewerBeta:na.openMapViewer};Da.prototype._formatMapViewerSecondaryLink=function(E){var S=E.mapViewerUrl,ia=E.newMapViewerUrl,na="modern"===E.portal.defaultMapViewer;return E.canOpenInNewMapViewer&&na?S:ia};Da.prototype._formatMapViewerSecondaryLabel=
function(E){var S=E.canOpenInNewMapViewer,ia=ha["default"].itemLinks;return"modern"===E.portal.defaultMapViewer&&S?ia.openMapViewer:ia.openMapViewerBetaLabel};Da.prototype._showDataLastUpdated=function(E){var S=this,ia,na,qa;(null===(ia=E.layers)||void 0===ia?0:ia.length)&&"Feature Service"===E.type&&I["default"].includes(E.typeKeywords,"Hosted Service")&&(E.layers.forEach(function(xa){var Ca;(na=(null===(Ca=xa.editingInfo)||void 0===Ca?void 0:Ca.lastEditDate)||void 0)&&(!qa||qa<na)&&(qa=na)},this),
qa?m["default"](".js-dataUpdatedLast").forEach(function(xa){r["default"].set(xa,"innerHTML",S.i18n.itemProperties.dataLastModified+" "+S._formatDateTime(qa));A["default"].showNode(xa)}):m["default"](".js-dataUpdatedLast").forEach(function(xa){r["default"].set(xa,"innerHTML","");A["default"].hideNode(xa)}))};Da.prototype._htmlEncode=function(E){return N["default"].htmlEncode(E)};Da.prototype._linkify=function(E){void 0===E&&(E="");return K["default"].linkify(E)};Da.prototype.handleReplaceLayerSuccess=
function(){window.location.reload()};return Da=q.__decorate([F["default"](D["default"])],Da)}()});