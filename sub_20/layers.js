//>>built
require({cache:{"app/widgets/panels/MapMaker/LayerList":function(){define("require exports tslib esri/core/accessorSupport/decorators esri/widgets/support/widget esri/widgets/Widget esri/core/watchUtils esri/core/reactiveUtils esri/core/domUtils ./itembrowsers/AddLayer ./EditTitle ./MoveToGroup ../../../utils/mapUtils/canSaveMap ../../../utils/mapUtils/canSaveLayer esri/core/Collection esri/core/CollectionFlattener esri/widgets/LayerList esri/widgets/LayerList/support/layerListUtils esri/intl/substitute ../../../utils/topic ../../../utils/layerUtils ../../../utils/signin esri/layers/GroupLayer ../../../utils/project ../../../utils/closeBtn ../../../utils/mapUtils/errorUtils ../../../utils/getUniqueLayerId ../../../utils/anonymous ./savelayer/copyLayer".split(" "),
function(T,e,a,u,q,y,t,k,v,x,f,h,l,w,F,Q,N,W,A,G,H,Y,M,C,D,X,ba,ia,L){Object.defineProperty(e,"__esModule",{value:!0});y=a.__importDefault(y);t=a.__importStar(t);k=a.__importStar(k);v=a.__importStar(v);x=a.__importDefault(x);f=a.__importDefault(f);h=a.__importDefault(h);F=a.__importDefault(F);Q=a.__importDefault(Q);N=a.__importDefault(N);W=a.__importStar(W);A=a.__importStar(A);G=a.__importDefault(G);H=a.__importStar(H);Y=a.__importDefault(Y);M=a.__importDefault(M);T=function(J){function c(d){d=J.call(this,
d)||this;d.canSave=!1;d.showTableAction=!1;d.layerActions=[];d.isLayerSaving=!1;return d}a.__extends(c,J);c.prototype.postInitialize=function(){var d=this.state,g=d.mapView;d=d.portal;this.map=g.map;this.layerActions=this.getLayerActionInfos();this.canSave=l.canSave(g,d);this.addEventListeners();this.addCloseBtn=D.addCloseBtn.bind(this,this.panel,this.action)};c.prototype.destroy=function(){this.itemBrowser&&this.itemBrowser.destroy();this.action&&(this.action.active=!1);this.editTitle&&!this.editTitle.destroyed&&
this.editTitle.destroy();this.moveToGroup&&!this.moveToGroup.destroyed&&this.moveToGroup.destroy();this.popover&&v.remove(this.popover);this.layerList&&!this.layerList.destroyed&&this.layerList.destroy();(this.handles||[]).forEach(function(d){return null===d||void 0===d?void 0:d.remove()})};c.prototype.addCloseBtn=function(d){};c.prototype.addEventListeners=function(){var d=this,g=this.map;this.state.mapView.when(function(){d.own([g.allLayers.on("change",function(r){return d.onLayersChange(r)}),G.default.subscribe("layerswitcher-selected",
d.onLayerSwitcherChange.bind(d)),G.default.subscribe("layer-save-start",d.onLayerSave.bind(d)),G.default.subscribe("mapView_changed",function(r){d.layerList&&d.layerList.set("view",r)})])})};c.prototype.toViewableLayers=function(d){return d?d.filter(function(g){return"hide"!==W.findLayerListMode(g)}):[]};c.prototype.onLayerSave=function(){var d=this;this.isLayerSaving=!0;var g=G.default.subscribe("layer-save-done",function(){g.remove();d.isLayerSaving=!1})};c.prototype.onLayersChange=function(d){var g=
this;if(!this.isLayerSaving){var r=d.added;d=d.removed;var K=r&&r.slice(0).shift();r=d&&d.slice(0).shift();var V=this.isTimeEnabled(K);K&&"hide"!==K.listMode?K.when(function(){var O=g.layerList;O?(O=O.get("operationalItems"),(O=g.findItem(K.id,{children:{items:O.items}}))?(g.selectedAction=V?"timeslider":null,g.addToSelection(O)):G.default.publish("layer-selected",{layer:K,firstLayer:V})):((g.selectedLayers||(g.selectedLayers=new F.default)).add(K.id),G.default.publish("layer-selected",{layer:K,firstLayer:V}))}):
r&&this.unselectLayer(r)}};c.prototype.isTimeEnabled=function(d){var g=this,r,K;return"group"===(null===d||void 0===d?void 0:d.type)&&(null===(r=d.layers)||void 0===r?0:r.length)?d.layers.some(function(V){return g.isTimeEnabled(V)}):(null===d||void 0===d?0:d.useViewTime)&&(null===(K=null===d||void 0===d?void 0:d.timeInfo)||void 0===K?0:K.fullTimeExtent)?!0:!1};c.prototype.onTriggerAction=function(d){if(!d||d&&(!d.key||"Enter"===d.key||" "===d.key||"Spacebar"===d.key)){var g=d.item;g=void 0===g?{}:
g;var r=d.currentTarget;r=void 0===r?{}:r;var K=g.layer;switch((d.action||r["data-action"]).id){case "layer-remove":this.removeLayer(g);break;case "layer-zoomto":this.zoomTo(K);g.actionsOpen=!1;document.querySelector('.esri-layer-list ul li[data-layer-uid\x3d"'+(g&&g.layer&&g.layer.uid)+'"]');break;case "layer-rename":g.actionsOpen=!1;this.renameLayer(d);break;case "layer-copy":g.actionsOpen=!1;this.copyLayer(g);break;case "layer-save-as":g.actionsOpen=!1;this.saveLayerAs(g);break;case "layer-save":g.actionsOpen=
!1;this.saveLayer(g);break;case "layer-options":this.selectedAction="layerproperties";this.addToSelection(g,"layerproperties");g.actionsOpen=!1;break;case "layer-sketch":g.actionsOpen=!1;this.addToSelection(g,"sketch");break;case "layer-addtobasemap":this.addLayerToBasemap(g);g.actionsOpen=!1;break;case "group-add":this.addLayerToGroup(g);g.actionsOpen=!1;break;case "group-move":this.moveLayerToGroup(d);g.actionsOpen=!1;break;case "group-remove":this.removeGroup(g);g.actionsOpen=!1;break;case "group-ungroup":this.unGroup(g);
g.actionsOpen=!1;break;case "sign-in":Y.default(this.state);break;case "addlayer":this.createItemBrowser();break;case "table-show":this.showTable(g);g.actionsOpen=!1;break;case "directions-show":g.actionsOpen=!1;this.addToSelection(g,"directions");break;case "directions-recalculate":this.recalculateDirections(g);g.actionsOpen=!1;break;default:G.default.publish("trigger-action",d)}}};c.prototype.unselectLayer=function(d){var g=this.layerList;if(g&&d){var r=d.layer;d=g.get("selectedItems");(g=d.filter(function(K){return K&&
K.layer&&K.layer.id===(null===r||void 0===r?void 0:r.id)}))&&g.length&&(d.removeAll(),G.default.publish("layer-deselected",r))}};c.prototype.copyLayer=function(d){return a.__awaiter(this,void 0,void 0,function(){var g,r;return a.__generator(this,function(K){switch(K.label){case 0:return g=this.state.mapView,r=d.layer,[4,L.duplicate(r,g)];case 1:return K.sent(),[2]}})})};c.prototype.saveLayerAs=function(d){return a.__awaiter(this,void 0,void 0,function(){var g;return a.__generator(this,function(r){switch(r.label){case 0:return g=
d.layer,[4,L.saveLayerAs(g,this.state)];case 1:return r.sent(),this.onGetLayerActions({item:d}),[2]}})})};c.prototype.saveLayer=function(d){return a.__awaiter(this,void 0,void 0,function(){var g;return a.__generator(this,function(r){switch(r.label){case 0:return g=d.layer,[4,L.saveLayer(g,this.state.mapView,this.state.portal)];case 1:return r.sent(),[2]}})})};c.prototype.removeLayer=function(d){var g=d.layer,r=d.parent;r=null===r||void 0===r?void 0:r.layer;var K=this.map;g&&g.layer?this.removeSublayer(d):
r?r.layers.remove(g):K.layers.remove(g);this.unselectLayer(d);G.default.publish("layer-removed")};c.prototype.removeSublayer=function(d){var g=this.map,r=d.layer,K=d.parent.children,V=r&&r.parent;V&&V.sublayers&&(V.sublayers.remove(r),K&&K.length&&(K.remove(d),!K.length&&V&&g.layers.remove(V)))};c.prototype.renameLayer=function(d){var g=this;d=d.item;var r=this.findReferenceElement(d);if(r){var K=r.closest("calcite-panel");K.disabled=!0;var V=this.popover=document.createElement("calcite-popover");
document.body.appendChild(V);V.referenceElement=r;V.setAttribute("y-offset",-10);V.placement="bottom-start";V.label="";V.disablePointer=!0;var O=document.createElement("div"),ja=this.editTitle=new f.default({layerInfo:d,container:V,referenceElement:r});V.appendChild(O);V.open=!0;var pa=ja.on("done",function(){pa.remove();V.open=!1;K.disabled=!1;ja.destroy();g.editTitle=null;v.remove(V)})}};c.prototype.findReferenceElement=function(d){var g=this.container;d=d.uid;var r=g.querySelector("li[data-layer-uid\x3d'"+
d+"'] .esri-layer-list__item-container");r||(r=g.querySelector("li[aria-labelledby*\x3d'"+d+"'] .esri-layer-list__item-container"));return r};c.prototype.sketchLayer=function(d){var g=this.app.contextualPanel;"sketch"!==g.activeActionName&&g.processAction("sketch",null===d||void 0===d?void 0:d.layer)};c.prototype.showTable=function(d){this.isSelected(d)||this.addToSelection(d);setTimeout(function(){G.default.publish("action-click",{name:"table",payload:d.layer})},250)};c.prototype.recalculateDirections=
function(d){var g,r;return a.__awaiter(this,void 0,void 0,function(){var K,V,O,ja,pa,wa,ka;return a.__generator(this,function(ra){switch(ra.label){case 0:return K=this.state,V=K.mapView,O=K.portal,ja=d.layer,pa=null===(r=null===(g=null===O||void 0===O?void 0:O.helperServices)||void 0===g?void 0:g.route)||void 0===r?void 0:r.url,ja.url=pa||ja.url,[4,ja.solve()];case 1:return wa=ra.sent(),ja.update(wa),[4,C.getExtent(ja,V,!0)];case 2:return ka=ra.sent(),V.goTo(ka),[2]}})})};c.prototype.zoomTo=function(d){var g=
this,r=this.state.mapView;C.getExtent(d,r,!0).then(function(K){return a.__awaiter(g,void 0,void 0,function(){return a.__generator(this,function(V){switch(V.label){case 0:return[4,r.goTo({target:K})];case 1:return V.sent(),0<d.minScale&&r.scale>d.minScale&&(r.scale=d.minScale,r.scale>d.minScale&&(r.zoom+=1)),[2]}})})})};c.prototype.getLayerActionInfos=function(){return[[{id:"layer-zoomto",title:this.messages.zoomTo,className:"esri-icon-zoom-in-magnifying-glass"},{id:"layer-options",title:this.messagesCommon.showProperties,
className:"esri-icon-description"},{id:"directions-show",title:this.messages.launchDirections,className:"esri-icon-calcite-road-sign"},{id:"directions-recalculate",title:this.messages.recalculate,className:"esri-icon-calcite-redo"},{id:"table-show",title:this.messages.showTable,className:"esri-icon-table"},{id:"layer-sketch",title:this.messagesActions.sketch,className:"esri-icon-calcite-pencil-mark"}],[{id:"layer-rename",title:this.messagesCommon.rename,className:"esri-icon-edit"},{id:"layer-save",
title:this.messagesLayerList.save,className:"esri-icon-calcite-save"},{id:"layer-save-as",title:this.messagesLayerList.saveAs,className:"esri-icon-calcite-save"},{id:"layer-copy",title:this.messagesCommon.duplicate,className:"esri-icon-calcite-duplicate"},{id:"layer-remove",title:this.messages.removeLayer,className:"esri-icon-trash"}],[{id:"layer-addtobasemap",title:this.messagesCommon.moveToBasemap},{id:"group-add",title:this.messages.addGroup},{id:"group-move",title:this.messages.moveGroup},{id:"group-remove",
title:this.messages.removeGroup},{id:"group-ungroup",title:this.messages.unGroup}]]};c.prototype.onCanDrop=function(d){var g,r=d.to;d=d.selected;var K=r?this.getItemDepth(r):0;return!r||"group"!==(null===d||void 0===d?void 0:d.layer.type)||"group"===(null===(g=r.layer)||void 0===g?void 0:g.type)&&3>=K};c.prototype.onGetLayerActions=function(d){var g,r,K;return a.__awaiter(this,void 0,void 0,function(){var V,O,ja,pa,wa,ka,ra,za,ua,la,Da,Ea,Aa,Z;return a.__generator(this,function(ha){switch(ha.label){case 0:V=
d.item;O=V.layer;ja=V.parent;if(O.loaded)return[3,4];ha.label=1;case 1:return ha.trys.push([1,3,,4]),[4,null===O||void 0===O?void 0:O.load()];case 2:return ha.sent(),[3,4];case 3:return ha.sent(),[3,4];case 4:pa=this.getGroupLayers(V);wa=this.getItemDepth(V);ka=this.isValidMapImageLayer(O);ra="group"===(null===(g=null===ja||void 0===ja?void 0:ja.layer)||void 0===g?void 0:g.type);za=O&&O.layer?O.layer.type:null;ua=w.canSaveLayer(O,this.state.portal);la=[[],[],[]];V&&(!ja||ka||ra)&&(la=[this.layerActions[0].slice(0),
this.layerActions[1]?this.layerActions[1].slice():[],this.layerActions[2]?this.layerActions[2].slice():[]]);la&&(O&&"stream"===O.type||ka&&ja)&&(la[0]=la[0].filter(function(ea){return"layer-zoomto"!==ea.id}));la&&O&&"route"===O.type?(Da=["table-show","layer-copy"],this.canUseDirection(),this.canUseDirection()?O.routeInfo||Da.push("directions-recalculate"):Da=Da.concat(["directions-show","directions-recalculate"]),la[0]=la[0].filter(function(ea){return-1===Da.indexOf(ea.id)}),la[1]=la[1].filter(function(ea){return-1===
Da.indexOf(ea.id)})):(Ea=["directions-show","directions-recalculate"],la[0]=la[0].filter(function(ea){return-1===Ea.indexOf(ea.id)}));la&&O&&"tile"===za&&(la[1]=la[1].filter(function(ea){return"layer-remove"!==ea.id&&"layer-rename"!==ea.id}));if(la&&"map-notes"!==(null===O||void 0===O?void 0:O.type)||"map-notes"===(null===O||void 0===O?void 0:O.type)&&this.isClassicMapNotesLayer(O))la[0]=la[0].filter(function(ea){return"layer-sketch"!==ea.id});la&&O&&"group"===O.type&&(la[1]=la[1].filter(function(ea){return"layer-rename"===
ea.id||"layer-remove"===ea.id}),la[0]=la[0].filter(function(ea){return"layer-options"===ea.id}));if("feature"!==O.type||"feature"===O.type&&!O.url)la[1]=la[1].filter(function(ea){return"layer-copy"!==ea.id});ua.save||(la[1]=la[1].filter(function(ea){return"layer-save"!==ea.id}));ua.saveas||(la[1]=la[1].filter(function(ea){return"layer-save-as"!==ea.id}));la&&(null===O||void 0===O?0:O.layer)&&(Aa=[],H.isDynamicLayer(O)||Aa.push("layer-rename","layer-remove"),la[0]=la[0].filter(function(ea){return-1===
Aa.indexOf(ea.id)}),la[1]=la[1].filter(function(ea){return-1===Aa.indexOf(ea.id)}));Z="feature"!==(null===O||void 0===O?void 0:O.type)&&"csv"!==(null===O||void 0===O?void 0:O.type)&&!ka&&(null===O||void 0===O?void 0:O.layer)&&!(null===O||void 0===O?0:O.fields)||!(null===O||void 0===O?0:O.get("capabilities.operations.supportsQuery"))||(null===(r=null===O||void 0===O?void 0:O.sublayers)||void 0===r?void 0:r.length)||"imagery-tile"===(null===O||void 0===O?void 0:O.type)||"ogc-feature"===(null===O||void 0===
O?void 0:O.type);la&&Z&&(la[0]=la[0].filter(function(ea){return"table-show"!==ea.id}));if(la[2]){la&&(ja||!ja&&!this.isValidBasemapType(O))&&(la[2]=la[2].filter(function(ea){return"layer-addtobasemap"!==ea.id}));if(ja&&"group"!==ja.layer.type||"group"===O.type&&2>pa||!ja&&"group"!==O.type&&!pa)la[2]=la[2].filter(function(ea){return"group-move"!==ea.id});if(3<wa||ja&&"group"!==(null===ja||void 0===ja?void 0:ja.layer.type))la[2]=la[2].filter(function(ea){return"group-add"!==ea.id});la[2]=la[2].filter(function(ea){return"group-remove"!==
ea.id});"group"===O.type&&("group"!==O.type||null!==(K=V.children)&&void 0!==K&&K.length)||(la[2]=la[2].filter(function(ea){return"group-ungroup"!==ea.id}))}V.actionsSections=la;return[2]}})})};c.prototype.isClassicMapNotesLayer=function(d){return"map-notes"===(null===d||void 0===d?void 0:d.type)&&!(null===d||void 0===d?0:d.get("capabilities.operations.supportsMapNotesEditing"))};c.prototype.canUseDirection=function(){var d,g,r=this.state.portal,K=r.user;K=null===K||void 0===K?void 0:K.userRole;var V=
(null===(g=null===(d=null===r||void 0===r?void 0:r.helperServices)||void 0===d?void 0:d.route)||void 0===g?void 0:g.url)||!1;d=r.urlKey&&r.customBaseUrl||r.isPortal?!0:!1;return V&&d&&(null===K||void 0===K?void 0:K.canUseNetworkAnalysis())};c.prototype.getGroupLayers=function(d){var g=(this.state.mapView.map.allLayers||[]).filter(function(r){return"group"===r.type});d=this.getChildGroupLayersCount(d);return g.length-d};c.prototype.getChildGroupLayersCount=function(d){var g=this;return("group"===d.layer.type?
1:0)+Math.max.apply(Math,a.__spreadArray([0],(d.children.items||[]).map(function(r){return g.getChildGroupLayersCount(r)})))};c.prototype.getItemDepth=function(d){var g,r=this.getDepthFromRoot(d);d=this.getDepth((null===(g=d.children)||void 0===g?void 0:g.items)||[]);return r+d-1};c.prototype.getDepthFromRoot=function(d){return 1+Math.max(0,d.parent?this.getDepthFromRoot(d.parent):0)};c.prototype.getDepth=function(d){var g=this;return 1+Math.max.apply(Math,a.__spreadArray([0],d.map(function(r){r=
r.children;return g.getDepth((null===r||void 0===r?void 0:r.items)||[])})))};c.prototype.findItem=function(d,g){var r;if(d===(null===(r=g.layer)||void 0===r?void 0:r.id))return g;if(g.children.items.length){var K=r=void 0;for(r=0;null==K&&r<g.children.items.length;r++)K=this.findItem(d,g.children.items[r]);return K}return null};c.prototype.isValidMapImageLayer=function(d){return H.isMapImageLayer(d)};c.prototype.isValidBasemapType=function(d){if(d){var g=d.type,r={"map-image":!0,imagery:!0,"imagery-tile":!0,
"vector-tile":!0,wms:!0,wmts:!0};return g&&g.toLowerCase()in r||d.tileInfo||!1}return!1};c.prototype.addLayerToBasemap=function(d){return a.__awaiter(this,void 0,void 0,function(){var g,r,K,V,O,ja,pa,wa,ka,ra;return a.__generator(this,function(za){switch(za.label){case 0:g=this.state;r=g.mapView;K=g.hideTypes;V=r.map;O=V.basemap;ja=O.baseLayers;pa=d.layer;wa=pa.type;pa.type in K&&(pa.listMode="hide-children");if("map-image"!==wa&&"imagery-tile"!==wa&&"imagery"!==wa&&!H.isSameSpatialReference(pa,r.spatialReference))return[3,
1];ja&&ja.length||(ja=new F.default,O.set("baseLayers",ja));ja.add(pa);this.removeLayer(d);G.default.publish("basemap-updated");return[2,Promise.resolve(pa)];case 1:return[4,this.canUseLayerAsBasemap(pa)];case 2:return ra=(ka=za.sent())?"basemap:spatial-reference-incompatible":"basemap:spatial-reference-incompatible-layers",X.showError({name:ra},pa),[2,Promise.reject({error:{name:ra}})]}})})};c.prototype.canUseLayerAsBasemap=function(d){return a.__awaiter(this,void 0,void 0,function(){var g,r,K,V;
return a.__generator(this,function(O){g=this.state.mapView;r=g.map;K=r.layers;V=d.tileInfo&&K&&K.length?K.every(function(ja){return H.isSameSpatialReference(d,null===ja||void 0===ja?void 0:ja.spatialReference)}):!0;return[2,V]})})};c.prototype.addLayerToGroup=function(d){var g,r;return a.__awaiter(this,void 0,void 0,function(){var K,V,O,ja;return a.__generator(this,function(pa){switch(pa.label){case 0:return K=d.layer,V=this.map,O=this.getGroupLayerTitle(this.messages.groupLayer,0),ja=new M.default({layers:[K],
visibilityMode:"independent",title:O}),"group"===(null===(r=null===(g=d.parent)||void 0===g?void 0:g.layer)||void 0===r?void 0:r.type)?d.parent.layer.add(ja):V.layers.add(ja),[4,ja.loadAll()];case 1:return pa.sent(),G.default.publish("layer-updated"),[2]}})})};c.prototype.getGroupLayerTitle=function(d,g){return 0<this.getGroupLayerTitleCount(d)?(d=A.substitute(this.messages.groupLayerWithNumber,{title:this.messages.groupLayer,num:g+1}),this.getGroupLayerTitle(d,g+1)):d};c.prototype.getGroupLayerTitleCount=
function(d){var g=this.state.mapView.map.allLayers.filter(function(r){return r.title===d});return(null===g||void 0===g?void 0:g.length)||0};c.prototype.moveLayerToGroup=function(d){var g=this,r=this.state.mapView;d=d.item;var K=this.findReferenceElement(d);if(K){var V=K.closest("calcite-panel");V.disabled=!0;var O=this.popover=document.createElement("calcite-popover");document.body.appendChild(O);O.referenceElement=K;O.setAttribute("y-offset",-10);O.placement="bottom-start";O.label="";O.disablePointer=
!0;var ja=document.createElement("div"),pa=this.moveToGroup=new h.default({mapView:r,layerInfo:d,container:O,referenceElement:K});O.appendChild(ja);O.open=!0;var wa=pa.on("done",function(){var ka;null===(ka=g.layerList.viewModel)||void 0===ka?void 0:ka._compileList();wa.remove();O.open=!1;V.disabled=!1;pa.destroy();g.moveToGroup=null;v.remove(O)})}};c.prototype.removeGroup=function(d){var g;this.map.layers.add(d.layer);null===(g=this.layerList.viewModel)||void 0===g?void 0:g._compileList()};c.prototype.unGroup=
function(d){var g,r=d.layer,K=r.layers;if(r=null===r||void 0===r?void 0:r.parent)r.addMany(K),this.removeLayer(d);null===(g=this.layerList.viewModel)||void 0===g?void 0:g._compileList()};c.prototype.createLayerList=function(d){var g=this,r=this.selectedLayers,K=this.state.mapView,V=this.toViewableLayers(K.map.layers).length,O=this.onGetLayerActions.bind(this),ja=this.onCanDrop.bind(this),pa=this.onTriggerAction.bind(this);this.layerList&&(this.layerList.destroy(),this.layerList=null);if(V){this.layerList=
new N.default({view:K,selectionEnabled:!0,editingEnabled:!0,errorsVisible:!0,uiStrings:{openActions:this.messagesLayerList.openActions,closeActions:this.messagesLayerList.closeActions,layerIncompatible:this.messagesLayerList.layerIncompatible},container:d,listItemCreatedFunction:O,listItemCanReceiveFunction:ja});if(r&&r.length)var wa=t.on(this.layerList,"operationalItems","change",function(ka){var ra;wa.remove();ka=g.layerList.get("operationalItems");var za=(null===(ra=r.items)||void 0===ra?0:ra.length)?
r.items[0]:[];(ra=g.findLayerById(za,ka))&&g.layerList.set("selectedItems",new F.default([ra]))});this.own([t.on(this.layerList,"selectedItems","change",function(ka){return a.__awaiter(g,void 0,void 0,function(){var ra,za,ua,la;return a.__generator(this,function(Da){switch(Da.label){case 0:return ra=ka.added&&ka.added.shift(),za=ka.removed&&ka.removed.shift(),ua=ra||za,this.isTimeEnabled(ua.layer),la=this.selectedAction,za&&(this.showTableAction||G.default.publish("layer-deselected",ua.layer)),ra?
ua.layer.loaded||!ua.layer.load?[3,2]:[4,ua.layer.load()]:[3,3];case 1:Da.sent(),Da.label=2;case 2:this.showTableAction?G.default.publish("layer-selected",{layer:ua.layer,action:la,showPanel:!1}):G.default.publish("layer-selected",{layer:ua.layer,action:la}),Da.label=3;case 3:return this.selectedAction=null,this.showTableAction=!1,[2]}})})}),this.layerList.on("trigger-action",pa)]);K.when(function(){g.own(K.map.allLayers.on("change",function(){return g.scheduleRender()}))});this.own([k.on(function(){return g.layerList.get("operationalItems")},
"change",function(){return g.onListItemsChange()})])}return this.layerList};c.prototype.onListItemsChange=function(){this.watchLayerPropertiesForChanges();this.updateAllLayerActions()};c.prototype.updateAllLayerActions=function(){var d=this;this.getListItems().forEach(function(g){return d.onGetLayerActions({item:g})})};c.prototype.watchLayerPropertiesForChanges=function(){var d=this,g=this.state.mapView;(this.handles||[]).forEach(function(r){return null===r||void 0===r?void 0:r.remove()});this.handles=
g.map.allLayers.map(function(r){return k.watch(function(){return r.get("visible")},function(){return G.default.publish("layer-updated")})});this.handles.concat(g.map.allLayers.filter(function(r){return"route"===r.type}).map(function(r){return k.watch(function(){return r.get("routeInfo")},function(){return d.updateAllLayerActions()})}))};c.prototype.getListItems=function(){var d=this.layerList.get("operationalItems");return new Q.default({getCollections:function(){return[d]},getChildrenFunction:function(g){return"children"in
g?g.children:null}})};c.prototype.selectFirstLayer=function(){var d=this;this.selectedLayers||setTimeout(function(){var g,r=(null===(g=d.layerList)||void 0===g?void 0:g.get("operationalItems")).items[0];d.addToSelection(r)},250)};c.prototype.filterNonEditableLayerActions=function(){var d=this.layerActions,g="layer-rename layer-save-as layer-save layer-copy group-add group-move group-remove".split(" ");this.canSave||(d[0]=d[0].filter(function(r){return-1===g.indexOf(r.id)}),d[1]=d[1].filter(function(r){return-1===
g.indexOf(r.id)}),d[2]=d[2].filter(function(r){return-1===g.indexOf(r.id)}),this.layerActions=d)};c.prototype.isEditableLayer=function(d){return!0===d.get("capabilities.operations.supportsEditing")};c.prototype.render=function(){var d=this.map;d=this.toViewableLayers(null===d||void 0===d?void 0:d.layers).length;return q.tsx("div",null,d?this.getLayers():this.getEmpty())};c.prototype.getLayers=function(){return q.tsx("calcite-panel",{key:"layers",heading:this.messages.layers,"intl-back":this.messagesCommon.back,
bind:this,afterCreate:this.addCloseBtn},ia.getAnonymousInfoElement(this.state,this.messages),q.tsx("div",{bind:this,afterCreate:this.createLayerList,class:"webviewer-layer-list"}),this.getAddLayerBtn())};c.prototype.getAnonymous=function(){var d=this.state.portal.isPortal?this.messagesLayerList.tips[1].content:this.messagesLayerList.tips[0].content;return q.tsx("calcite-panel",{key:"layers-anon",heading:this.messages.layers,"intl-back":this.messagesCommon.back,bind:this,afterCreate:this.addCloseBtn},
q.tsx("section",null,q.tsx("div",{class:"text-center"},q.tsx("span",{class:this.classes("esri-icon-layers esri-layers-list")})),q.tsx("calcite-tip",{nonDismissible:!0,heading:this.messagesLayerList.tips[0].title},q.tsx("p",null,d)),q.tsx("div",{class:"text-center"},q.tsx("calcite-button",{bind:this,"data-action":{id:"sign-in"},onclick:this.onTriggerAction,class:"mapviewer-btn-signin",color:"blue",appearance:"clear",width:"half",text:this.messagesCommon.signin},this.messagesCommon.signin))))};c.prototype.getEmpty=
function(){var d=this.messages;return q.tsx("calcite-panel",{key:"layers-empty",heading:d.layers,"intl-back":this.messagesCommon.back,bind:this,afterCreate:this.addCloseBtn},ia.getAnonymousInfoElement(this.state,d),q.tsx("div",{class:"text-center"},q.tsx("span",{class:this.classes("esri-icon-layers esri-layers-list")})),q.tsx("calcite-tip",{nonDismissible:!0},q.tsx("article",null,this.messages.noLayersSnippet)),this.getAddLayerBtn())};c.prototype.getAddLayerBtn=function(){return q.tsx("calcite-fab",
{bind:this,slot:"fab","data-action":{id:"addlayer"},onclick:this.onTriggerAction,icon:"plus",label:this.messages.addLayer,text:this.messages.addLayer,textEnabled:!0,class:"calcite-theme-light",appearance:"outline",color:"blue",scale:"m"})};c.prototype.createItemBrowser=function(){var d=document.getElementById("layer-list-flow"),g=this.messagesActions,r=document.createElement("calcite-panel");r.setAttribute("heading",g.addLayer);r.setAttribute("intl-back",this.messagesCommon.back);g=this.getItemBrowser();
r.appendChild(g.container);d.appendChild(r)};c.prototype.getItemBrowser=function(){var d=this.state;if(this.itemBrowser)this.itemBrowser.reset();else{var g=document.querySelector(".js-top-banner"),r=document.createElement("div");r.classList.add(g?"esri-full-height-banner":"esri-full-height");d=new x.default({state:d,messages:this.messages,messagesCommon:this.messagesCommon,container:r});d.createItemBrowser();this.itemBrowser=d}return this.itemBrowser};c.prototype.onLayerSwitcherChange=function(d){var g=
this.layerList;if(g){var r=g.get("operationalItems");(d=this.findLayerById(ba.getUniqueLayerId(d),r))?this.layerList.set("selectedItems",new F.default([d])):g.set("selectedItems",new F.default)}};c.prototype.findLayerById=function(d,g){var r=this;return g.items.reduce(function(K,V){if(K)return K;if(d===ba.getUniqueLayerId(V.layer))return V;if(V.children)return r.findLayerById(d,V.children)},null)};c.prototype.isSelected=function(d){return-1<this.layerList.selectedItems.indexOf(d)};c.prototype.addToSelection=
function(d,g){var r=this;setTimeout(function(){var K=r.layerList.selectedItems;r.isSelected(d)?(r.isTimeEnabled(d.layer),G.default.publish("layer-selected",{layer:d.layer,action:g})):(K.removeAll(),K.add(d))},250)};a.__decorate([u.property(),q.messageBundle("mapviewer/common")],c.prototype,"messagesCommon",void 0);a.__decorate([u.property(),q.messageBundle("mapviewer/mapMaker")],c.prototype,"messages",void 0);a.__decorate([u.property(),q.messageBundle("mapviewer/layerList")],c.prototype,"messagesLayerList",
void 0);a.__decorate([u.property(),q.messageBundle("mapviewer/actions")],c.prototype,"messagesActions",void 0);return c=a.__decorate([u.subclass("")],c)}(y.default);e.default=T})},"app/widgets/panels/MapMaker/itembrowsers/AddLayer":function(){define(["require","exports","tslib","./AddAnything","../../../../utils/mapUtils/addToMap"],function(T,e,a,u,q){Object.defineProperty(e,"__esModule",{value:!0});u=a.__importDefault(u);q=a.__importStar(q);T=function(y){function t(){var k=null!==y&&y.apply(this,
arguments)||this;k.customActions=[{name:k.messages.useAsBasemap,allowed:function(v){return q.canAddPortalItemAsBasemap(v)},asynchronous:!0,onAction:function(v){return a.__awaiter(k,void 0,void 0,function(){var x;return a.__generator(this,function(f){switch(f.label){case 0:return[4,q.toLayer(v,this.isItemFromArcGISOnline(),this.state)];case 1:return x=f.sent(),[2,q.addLayerAsBasemap(x,this.state)]}})})}}];return k}a.__extends(t,y);t.prototype.getConfig=function(){var k=this;return{baseSections:this.getBaseSections(),
customSections:this.getCustomSections(),dialogTitle:this.messages.searchLayers,searchPlaceholderText:this.messages.searchLayers,mainActionTitle:this.messages.addToMap,hideEllipses:!0,showBackBtn:!1,layoutMode:"confined",detailsPaneType:"flyover",showSubmitButton:!1,enableMapAreaFilter:!0,asynchronousItemSelect:!0,onSelect:function(v){return a.__awaiter(k,void 0,void 0,function(){var x;return a.__generator(this,function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),[4,this.processItems(v)];
case 1:return f.sent(),[2,Promise.resolve(!0)];case 2:return x=f.sent(),[2,Promise.reject(x)];case 3:return[2]}})})},onDeselect:this.removeItems.bind(this),addQueryParameters:this.addQueryParameters.bind(this),allowedItemTypes:[],availableItemTypeFilters:["layers","featureLayers","tileLayers","mapImageLayers","imageryLayers"],disableItemTypeFilters:!1,customActions:this.customActions}};t.prototype.addQueryParameters=function(){var k,v=this.state.portal,x=v.user;x=void 0===x?{}:x;v=v.isPortal;var f=
x.orgId,h=['-type:"Feature Collection Template"','-type:"Stream Service"','-typekeywords:"Elevation 3D Layer"','-typekeywords:"Table"','-type:"Feed"'];x&&(void 0===f?0:f)||h.push('-typekeywords:"Requires Subscription"');v||(null===(k=null===x||void 0===x?void 0:x.userRole)||void 0===k?0:k.canUseDemographics())||h.push('-typekeywords:"Requires Credits"');return'((type:"Map Service" OR type:"Image Service" OR type:"Feature Service" OR type:"Vector Tile Service" OR type:"OGCFeatureServer" OR type:"WMS" OR type:"WFS" OR type:"WMTS" OR type:"KML" OR type:"Table" OR (type:"Feature Collection" AND typekeywords:"Route Layer"^0.1))  AND ('+
h.join(" AND ")+"))"};return t}(u.default);e.default=T})},"app/widgets/panels/MapMaker/itembrowsers/AddAnything":function(){define("require exports tslib ../../../../utils/topic ./ItemBrowser ../../../../utils/mapUtils/errorUtils ../../../../utils/mapUtils/addToMap esri/core/promiseUtils esri/core/CollectionFlattener".split(" "),function(T,e,a,u,q,y,t,k,v){Object.defineProperty(e,"__esModule",{value:!0});u=a.__importDefault(u);q=a.__importDefault(q);t=a.__importStar(t);k=a.__importStar(k);v=a.__importDefault(v);
T=function(x){function f(){return null!==x&&x.apply(this,arguments)||this}a.__extends(f,x);f.prototype.getConfig=function(){var h=this;return{baseSections:this.getBaseSections(),customSections:this.getCustomSections(),dialogTitle:this.messages.searchLayers,searchPlaceholderText:this.messages.searchLayers,mainActionTitle:this.messages.addToMap,hideEllipses:!0,showBackBtn:!1,layoutMode:"confined",detailsPaneType:"flyover",showSubmitButton:!1,enableMapAreaFilter:!0,asynchronousItemSelect:!0,onSelect:function(l){return a.__awaiter(h,
void 0,void 0,function(){var w;return a.__generator(this,function(F){switch(F.label){case 0:return F.trys.push([0,2,,3]),[4,this.processItems(l)];case 1:return[2,F.sent()];case 2:return w=F.sent(),[2,Promise.reject(w)];case 3:return[2]}})})},onDeselect:this.removeItems.bind(this),addQueryParameters:this.addQueryParameters.bind(this),availableItemTypeFilters:"layers featureLayers tileLayers tables mapImageLayers imageryLayers".split(" "),disableItemTypeFilters:!1,customActions:[{name:this.messages.useAsBasemap,
allowed:function(l){return t.canAddPortalItemAsBasemap(l)},asynchronous:!0,onAction:function(l){return a.__awaiter(h,void 0,void 0,function(){var w;return a.__generator(this,function(F){switch(F.label){case 0:return[4,t.toLayer(l,this.isItemFromArcGISOnline(),this.state)];case 1:return w=F.sent(),[2,t.addLayerAsBasemap(w,this.state)]}})})}}]}};f.prototype.addQueryParameters=function(){var h,l=this.state.portal,w=l.user;w=void 0===w?{}:w;l=l.isPortal;var F=w.orgId,Q='-type:"Feature Collection Template";-type:"Stream Service";-type:"Feature Collection";-typekeywords:"Elevation 3D Layer";-type:"Feed";-typekeywords:"Route Layer"'.split(";");
w&&(void 0===F?0:F)||Q.push('-typekeywords:"Requires Subscription"');l||(null===(h=null===w||void 0===w?void 0:w.userRole)||void 0===h?0:h.canUseDemographics())||Q.push('-typekeywords:"Requires Credits"');return" ("+Q.join(" AND ")+")"};f.prototype.processItems=function(h){return a.__awaiter(this,void 0,void 0,function(){var l,w,F,Q,N,W,A,G=this;return a.__generator(this,function(H){switch(H.label){case 0:return H.trys.push([0,7,,8]),l=this.isItemFromArcGISOnline(),[4,Promise.all(h.map(function(Y){return t.toLayer(Y,
l,G.state)}))];case 1:return w=H.sent(),w=w.filter(function(Y){return Y}),null!==w&&void 0!==w&&w.length?[4,t.addLayers(w,this.state)]:[2,Promise.reject(!1)];case 2:return w=H.sent(),[4,this.checkForErrors(w)];case 3:if(F=H.sent())return[3,6];Q=this.state.mapView;return(N=this.findFirstLayer(w))?[4,t.getExtent(N,this.state)]:[3,5];case 4:W=H.sent(),Q.goTo({target:W}),0<N.minScale&&Q.scale>N.minScale&&(Q.scale=N.minScale,Q.scale>N.minScale&&(Q.zoom+=1)),H.label=5;case 5:this.publishComplete(),H.label=
6;case 6:return[2,Promise.resolve(w)];case 7:return(A=H.sent())&&y.showError(A,null===A||void 0===A?void 0:A.item),[2,Promise.reject(A)];case 8:return[2]}})})};f.prototype.findFirstLayer=function(h){return(new v.default({getCollections:function(){return[h]},getChildrenFunction:function(l){return"layers"in l?l.layers:null}})).toArray().filter(function(l){return!l.isTable}).reverse()[0]};f.prototype.checkForErrors=function(h){return a.__awaiter(this,void 0,void 0,function(){var l,w=this;return a.__generator(this,
function(F){l=this.state.mapView;return[2,k.eachAlways(h.map(function(Q){return l.whenLayerView(Q)})).then(function(Q){return Q.filter(function(N){return N.error&&"view:no-layerview-for-layer"!==N.error.name})}).then(function(Q){return Q&&Q.length?(w.processErrors(Q),Promise.reject(Q)):!1})]})})};f.prototype.processErrors=function(h){var l=this;(h||[]).forEach(function(w){return l.processError(w)});return!1};f.prototype.processError=function(h){var l=this.state.view.map,w=(h&&h.error||{}).details;
w=w&&w.layer||{};w.id&&l.layers.remove(w);y.showError(h,w)};f.prototype.publishComplete=function(){};f.prototype.removeItems=function(h){(h&&h.length?h:[]).forEach(this.removeItem.bind(this));u.default.publish("layer-removed")};f.prototype.removeItem=function(h){var l=this.state.mapView.map,w=l.layers;l=l.tables;var F=(w||[]).reverse().find(function(Q){return Q&&Q.portalItem&&Q.portalItem.id===h.id});F||(F=(l||[]).reverse().find(function(Q){return Q&&Q.portalItem&&Q.portalItem.id===h.id}),this.removeFromMap(F,
l));F&&this.removeFromMap(F,w)};f.prototype.removeFromMap=function(h,l){h&&l.remove(h)};f.prototype.saveCurrentBasemap=function(){this.currentBasemap=this.state.map.webMap.basemap.clone()};f.prototype.resetBasemap=function(){return a.__awaiter(this,void 0,void 0,function(){var h,l,w;return a.__generator(this,function(F){switch(F.label){case 0:return F.trys.push([0,2,,3]),h=this.currentBasemap,[4,t.addAsBasemap(h,this.state)];case 1:return l=F.sent(),[2,l];case 2:return w=F.sent(),[2,Promise.reject(w)];
case 3:return[2]}})})};return f}(q.default);e.default=T})},"app/utils/topic":function(){define(["require","exports","tslib","esri/core/Evented"],function(T,e,a,u){Object.defineProperty(e,"__esModule",{value:!0});u=a.__importDefault(u);T=function(){function q(){}q.publish=function(y,t){return this.hub.emit.apply(this.hub,arguments)};q.subscribe=function(y,t){return this.hub.on.apply(this.hub,arguments)};q.hub=new u.default;return q}();e.default=T})},"app/utils/mapUtils/errorUtils":function(){define("require exports tslib ../topic esri/intl/substitute esri/layers/support/arcgisLayerUrl ../messageBundleLoader".split(" "),
function(T,e,a,u,q,y,t){function k(f){var h=f&&f.type||"error";var l=f.name;l=void 0===l?"":l;var w=f.details,F=f.type;w=f.item||w&&w.layer||w&&w.item||{title:""};F="warning"===(void 0===F?"error":F)?e.messagesErrors.genericWarningTitle:e.messagesErrors.genericErrorTitle;-1<l.indexOf("layerview:create-error")?F=q.substitute(e.messagesErrors.failedToAddLayer,w):"request:server"===l||"identity-manager:not-authorized"===l?(l=w&&w.title||v(f)||"",F=q.substitute(e.messagesErrors.failedToAddLayer,{title:l})):
"webmap:save"===l?F=e.messagesErrors.failedToSaveMap:"csv"===l&&(F=q.substitute(e.messagesErrors.unableToAdd,{type:"CSV"}));l=F;F=f&&f.message||e.messagesErrors.genericError;w=f&&f.name;f&&f.details?(F=(F=f.details)&&F.errors||F&&F.error||[],w=f.item||f.details.layer||f.details.item||{title:""},F=F&&F.name?x(a.__assign(a.__assign({},F),{item:w})):F.length?x(a.__assign(a.__assign({},F.shift()),{item:w})):x(f)):w?F=x(f):F&&-1<F.toLowerCase().indexOf("you do not have access to this resource")&&(F=x({name:"webmap:no-permission",
message:F}));return{type:h,title:l,message:F}}function v(f){return(f=(f=(f=(null===f||void 0===f?void 0:f.details)||"")&&f.url)&&y.parse(f))&&f.title||""}function x(f){var h=f.name,l=f.details,w=f.item||l&&(l.layer||l.item)||{},F=null===l||void 0===l?void 0:l.messageCode;if(w){var Q=w.portal;Q=null===Q||void 0===Q?void 0:Q.user}else Q=null;w.title=w.title||v(f)||"";var N=f&&f.message||e.messagesErrors.genericError;if(w&&"layerview:spatial-reference-incompatible"===h)N=q.substitute(e.messagesErrors.spatialReference,
w);else if(w&&"featurelayerview:table-not-supported"===h)N=q.substitute(e.messagesErrors.tableNotSupported,w);else if(w&&"layer:unsupported-layer-type"===h)f=w&&w.resourceInfo||{type:""},N=q.substitute(e.messagesErrors.unsupportedLayerType,a.__assign(a.__assign({},w),f));else if(w&&"url:unknown-item-type"===h)N=q.substitute(e.messagesErrors.unsupportedUrlType,{});else if(w&&"imageserverraster:open"===h||"imagery-layer:fetch-service-info"===h)N=e.messagesErrors.unsupportedLayer;else if("request:server"===
h&&(-1<(null===N||void 0===N?void 0:N.indexOf("Unexpected token \x3c in JSON at position 0"))||-1<(null===N||void 0===N?void 0:N.indexOf("JSON.parse: unexpected character"))))N=0===l.httpStatus?e.messagesErrors.layerNotOGCFeatures:e.messagesErrors.layerNotAdded;else if("request:server"!==h||"CONT_0155"!==F)"request:server"===h&&400===l.httpStatus||"wmtslayer:unsupported-service-data"===h?N=(null===w||void 0===w?0:w.title)?q.substitute(e.messagesErrors.layerNotAddedSecure,w):e.messagesErrors.layerNotAdded:
"request:server"===h&&0===l.httpStatus&&"GeoJSON"===(null===l||void 0===l?void 0:l.type)?N=e.messagesErrors.layerNotGeoJSON:"request:server"===h&&(503===l.httpStatus||500===l.httpStatus||400===l.httpStatus||404===l.httpStatus||301===l.httpStatus&&"GeoJSON"===(null===l||void 0===l?void 0:l.type))?N=(null===w||void 0===w?0:w.title)?q.substitute(e.messagesErrors.layerNotAddedItem,w):e.messagesErrors.layerNotAdded:"TypeError"===h?N=e.messagesErrors.layerNotAdded:"request:not-secure"===h?N=e.messagesErrors.httpNotAllowed:
"webmap:save"===h?N=q.substitute(e.messagesErrors.layerNotSaved,w):"web-document-write:property-required"===h?N=q.substitute(e.messagesErrors.webMapPropRequired,l):"webmap:unsupported-version"===h?N=q.substitute(e.messagesErrors.webMapUnsupportedVersion,w):"webmap:no-permission"===h?N=q.substitute(e.messagesErrors.webMapNoPermission,w):"basemap:spatial-reference-incompatible"===h?N=q.substitute(e.messagesErrors.basemapIncompatibleSR,w):"basemap:spatial-reference-incompatible-layers"===h?N=q.substitute(e.messagesErrors.basemapLayersIncompatibleSR,
w):"basemap:spatial-reference-incompatible-basemap"===h?N=q.substitute(e.messagesErrors.basemapIncompatible,w):"basemap:arcgis-layers:url-mismatch"===h?N=e.messagesErrors.basemapNotAvailable:"feature-layer-source:unsupported-type"===h||"ogc-feature-layer:missing-property"===h?(f=w&&w.title||v(f),N=q.substitute(e.messagesErrors.unsupportedLayerType,{type:f||"Layer"})):"identity-manager:not-authorized"===h||"request:server"===h&&403===l.httpStatus?(w=(null===w||void 0===w?void 0:w.portalItem)||w,w=
null===w||void 0===w?void 0:w.typeKeywords,w=-1<(null===w||void 0===w?void 0:w.indexOf("Requires Subscription"))||-1<(null===w||void 0===w?void 0:w.indexOf("Requires Credits"))||!1,f=v(f),N=w?q.substitute((null===Q||void 0===Q?0:Q.isOrgUser)?e.messagesErrors.subscriptionContentOrg:e.messagesErrors.subscriptionContentPublic,{title:f||""}):q.substitute(e.messagesErrors.failedToAddLayer,{title:f||""})):-1<(null===N||void 0===N?void 0:N.indexOf("Unable to identify latitudeField and/or longitudeField from"))?
N=e.messagesErrors.unableToAddCSV:"shortcut:invalid"===h?N=q.substitute(e.messagesErrors.shortcutInvalid,{name:f.currentCommand.alias}):"forms:missingRequiredField"===h?N=e.messagesErrors.missingRequiredField:"csv-layer:location-fields-not-found"===h?N=e.messagesErrors.csvLayerLocationFieldsNotFound:"wfs-layer:kvp-encoding-not-supported"===h?N=e.messagesErrors.wfsEncodingNotSupported:"web-document-write:unsupported-feature-effect"===h&&(N=e.tempErrorMessage);return N}Object.defineProperty(e,"__esModule",
{value:!0});e.getErrorInfo=e.showError=e.fetchErrorMessages=e.messagesErrors=e.tempErrorMessage=void 0;u=a.__importDefault(u);q=a.__importStar(q);y=a.__importStar(y);e.tempErrorMessage="Close the Filter pane before saving.";e.fetchErrorMessages=function(){return a.__awaiter(this,void 0,void 0,function(){var f;return a.__generator(this,function(h){switch(h.label){case 0:return[4,t.fetchMessageBundles(["mapviewer/errors"])];case 1:return f=h.sent()[0],e.messagesErrors=f,[2]}})})};e.showError=function(f,
h){f=k(a.__assign(a.__assign({},f&&f.error||f),{item:h}));u.default.publish("alert/show",f)};e.getErrorInfo=k})},"app/utils/messageBundleLoader":function(){define(["require","exports","tslib","esri/intl","esri/request"],function(T,e,a,u,q){function y(k,v){return a.__awaiter(this,void 0,void 0,function(){var x,f;return a.__generator(this,function(h){switch(h.label){case 0:x=u.normalizeMessageBundleLocale(v),h.label=1;case 1:return h.trys.push([1,3,,5]),[4,t("./js/app/"+k+"_"+x.toLowerCase()+".json")];
case 2:return f=h.sent(),[2,f];case 3:return h.sent(),[4,t("./js/app/"+k+"_en.json")];case 4:return f=h.sent(),[2,f];case 5:return[2]}})})}function t(k){return a.__awaiter(this,void 0,void 0,function(){var v,x;return a.__generator(this,function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),[4,q.default(""+k,{responseType:"json"})];case 1:return v=f.sent(),[2,(null===v||void 0===v?void 0:v.data)||{}];case 2:throw x=f.sent(),console.error("Error loading locale: "+k,x),Error(x);case 3:return[2]}})})}
Object.defineProperty(e,"__esModule",{value:!0});e.fetchMessageBundles=e.createMessageBundleLoader=e.isLoadingLocale=void 0;u=a.__importStar(u);q=a.__importDefault(q);e.isLoadingLocale=!1;e.createMessageBundleLoader=function(k){return a.__awaiter(this,void 0,void 0,function(){var v,x,f;return a.__generator(this,function(h){f=/^mapviewer\/(.+)/;u.registerMessageBundleLoader({pattern:f,fetchMessageBundle:function(l,w){return a.__awaiter(this,void 0,void 0,function(){var F,Q;return a.__generator(this,
function(N){switch(N.label){case 0:e.isLoadingLocale&&setTimeout(function(){return e.isLoadingLocale=!1},250);if(w===v)return[3,2];e.isLoadingLocale=!0;return[4,y("t9n/app",w)];case 1:x=N.sent(),v=w,N.label=2;case 2:return F=f.exec(l)[1],"all"!==F?[3,3]:[2,x];case 3:return x[F]?[2,x[F]]:[3,4];case 4:return[4,y(F,w)];case 5:return Q=N.sent(),[2,Q]}})})}});return[2]})})};e.fetchMessageBundles=function(k,v){return a.__awaiter(this,void 0,void 0,function(){var x;return a.__generator(this,function(f){x=
k.map(function(h){return u.fetchMessageBundle(h)});return[2,Promise.all(x)]})})}})},"app/utils/mapUtils/addToMap":function(){define("require exports tslib esri/layers/MapImageLayer esri/Basemap ./errorUtils esri/layers/Layer ../../utils/LayerUtil ../../utils/project ../../utils/layerUtils ../../utils/appUtils esri/layers/support/arcgisLayerUrl ../../utils/topic esri/core/Collection esri/portal/PortalItem esri/core/urlUtils esri/geometry/projection esri/support/basemapUtils esri/geometry/support/spatialReferenceUtils esri/geometry/SpatialReference esri/core/reactiveUtils".split(" "),
function(T,e,a,u,q,y,t,k,v,x,f,h,l,w,F,Q,N,W,A,G,H){function Y(z){return!!/^(https?:\/\/)?((([a-z\d]([a-z\d-]*[a-z\d])*)\.)+[a-z]{2,}|((\d{1,3}\.){3}\d{1,3}))(\:\d+)?(\/[-a-z\d%_.~+]*)*(\?[;&a-z\d%_.~+=-]*)?(\#[-a-z\d_]*)?$/i.test(z)}function M(z){z=z.trim();var aa=Y(z);z=f.parseUrl(z);return!aa||"https"===(null===z||void 0===z?void 0:z.protocol)}function C(z,aa){return a.__awaiter(this,void 0,void 0,function(){var R,P,E;return a.__generator(this,function(U){switch(U.label){case 0:return U.trys.push([0,
8,,9]),[4,D(z,aa)];case 1:return(R=U.sent())?null!==R&&void 0!==R&&R.loadAll?[4,R.loadAll()]:[3,3]:[3,6];case 2:return P=U.sent(),[3,5];case 3:return[4,R.load()];case 4:P=U.sent(),U.label=5;case 5:return P,[2,R];case 6:return[2,Promise.reject(!1)];case 7:return[3,9];case 8:return E=U.sent(),y.showError(E),[2,Promise.reject(E)];case 9:return[2]}})})}function D(z,aa){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(R){switch(R.label){case 0:return(null===z||void 0===
z?void 0:z.type)in{OGCFeatureServer:1,WFS:1}?[4,ea(z,aa)]:[3,2];case 1:return[2,R.sent()];case 2:return X(z)?[4,Ba(z)]:[3,4];case 3:return[2,R.sent()];case 4:return[4,t.default.fromPortalItem({portalItem:z})];case 5:return[2,R.sent()]}})})}function X(z){return f.includes((null===z||void 0===z?void 0:z.typeKeywords)||[],"Location Tracking Service")}function ba(z,aa,R){var P,E;R=R.config.urlParameters;var U=(null===z||void 0===z?void 0:z.allSubLayers)||(null===z||void 0===z?void 0:z.layers)||(null===
z||void 0===z?void 0:z.sublayers);if(!(R&&z&&U&&U.length)||z.isTable)return z;var p=(aa=aa.split("?layers\x3d")[1])&&-1<aa.indexOf("show:")&&aa.split(":")[1].split(",")||[],I=!R||(null===(P=R.layerIds)||void 0===P?0:P.length)&&1===(null===(E=null===R||void 0===R?void 0:R.layers)||void 0===E?void 0:E.length)?R.layerIds:null;if(!(p&&p.length||(null===I||void 0===I?0:I.length)))return z;p&&U.forEach(function(da){return da.visible=-1<p.indexOf(da.layerId+"")||-1<p.indexOf(da.id+"")});if(null===I||void 0===
I?0:I.length)z.layers=new w.default(U.filter(function(da){return-1===I.indexOf(da.layerId)}));return z}function ia(z,aa,R){return a.__awaiter(this,void 0,void 0,function(){var P,E,U;return a.__generator(this,function(p){switch(p.label){case 0:return[4,z.load()];case 1:return p.sent(),P=z&&z.portalItem||{},E=z&&"group"===z.type&&!P.isFeatureCollection&&!X(P),U=aa.hideTypes,z.type in U&&(z.listMode="hide-children"),E?R?[3,3]:[4,K(z,aa)]:[3,6];case 2:return p.sent(),[3,5];case 3:return[4,V(z,aa)];case 4:p.sent(),
p.label=5;case 5:return[3,8];case 6:return[4,d(z,aa)];case 7:p.sent(),p.label=8;case 8:return[2,z]}})})}function L(z,aa){return a.__awaiter(this,void 0,void 0,function(){var R,P,E,U;return a.__generator(this,function(p){switch(p.label){case 0:return R=aa.mapView,P=R.map,E=P.tables||new w.default,[4,Da(z,!1,aa)];case 1:return U=p.sent(),E.add(U),R.map.tables=E,l.default.publish("table-added"),[2,Promise.resolve(!0)]}})})}function J(z){var aa=[];null===z||void 0===z?void 0:z.forEach(function(R){var P,
E=R&&R.portalItem||{};E="group"===(null===R||void 0===R?void 0:R.type)&&(null===(P=null===R||void 0===R?void 0:R.tables)||void 0===P?void 0:P.length)&&!E.isFeatureCollection;aa=aa.concat(E?((null===R||void 0===R?void 0:R.layers.items)||[]).concat((null===R||void 0===R?void 0:R.tables.items)||[]):[R])});return aa||[]}function c(z){var aa,R=[];R=z&&z.portalItem||{};R="group"===(null===z||void 0===z?void 0:z.type)&&(null===(aa=null===z||void 0===z?void 0:z.tables)||void 0===aa?0:aa.length)&&!R.isFeatureCollection?
null===z||void 0===z?void 0:z.tables.items.slice():[];z.tables=null;return R||[]}function d(z,aa){var R;return a.__awaiter(this,void 0,void 0,function(){var P,E,U,p,I,da,na,ma;return a.__generator(this,function(oa){switch(oa.label){case 0:P=aa.mapView,E=P.map,U=z.type,oa.label=1;case 1:return oa.trys.push([1,10,,11]),[4,ka(z)];case 2:oa.sent();x.checkPopup(z);if(!z.isTable)return[3,3];g(z,E);return[3,9];case 3:if("imagery-tile"!==U&&"imagery"!==U&&"web-tile"!==U&&!x.isSameSpatialReference(z,null===
P||void 0===P?void 0:P.spatialReference))return[3,4];E.layers.add(z);return[3,9];case 4:return!x.supportsExportMap(z)||x.isTilesOnly(z)?[3,6]:[4,r(z,E)];case 5:return oa.sent(),[3,9];case 6:p=E.basemap;I=null===p||void 0===p?void 0:p.baseLayers;da=null===p||void 0===p?void 0:p.referenceLayers;na=null===(R=E.allLayers)||void 0===R?void 0:R.filter(function(Ga){return!(null===I||void 0===I?0:I.includes(Ga))&&!da.includes(Ga)});if(null===na||void 0===na||!na.length)return[3,7];y.showError({name:"basemap:spatial-reference-incompatible"},
z);return[2,Promise.reject({error:{name:"basemap:spatial-reference-incompatible"},item:z})];case 7:return[4,O(z,aa)];case 8:oa.sent(),oa.label=9;case 9:return[2,z];case 10:return ma=oa.sent(),[2,Promise.reject(ma)];case 11:return[2]}})})}function g(z,aa){var R=aa.tables||new w.default;R.add(z);aa.tables=R}function r(z,aa){return a.__awaiter(this,void 0,void 0,function(){var R,P;return a.__generator(this,function(E){switch(E.label){case 0:if("map-image"!==(null===z||void 0===z?void 0:z.type))return[3,
1];P=z;return[3,3];case 1:return[4,Aa(z)];case 2:P=E.sent(),E.label=3;case 3:return R=P,aa.layers.add(R),[2,R]}})})}function K(z,aa){return a.__awaiter(this,void 0,void 0,function(){var R,P,E,U,p,I,da,na,ma;return a.__generator(this,function(oa){switch(oa.label){case 0:return R=aa.mapView,P=aa.config,E=P.urlParameters,U=R.map,p=z.layers,[4,z.loadAll()];case 1:oa.sent();I=c(z);da=I.filter(function(Ga){return pa(Ga,E)});U.tables.addMany(da);na=p.filter(function(Ga){return!Ga.isTable&&pa(Ga,E)});if(!(1<
na.length))return[3,2];na.forEach(function(Ga){return x.checkPopup(Ga)});z.layers=na;U.layers.add(z);return[3,4];case 2:if(!na.length)return[3,4];ma=na.shift();return[4,ma.load()];case 3:oa.sent(),x.checkPopup(ma),U.layers.add(ma),oa.label=4;case 4:return[2]}})})}function V(z,aa){return a.__awaiter(this,void 0,void 0,function(){var R,P,E,U,p,I,da,na;return a.__generator(this,function(ma){switch(ma.label){case 0:return R=aa.mapView,P=aa.config,E=P.urlParameters,U=R.map,p=z.layers,[4,z.loadAll()];case 1:return ma.sent(),
I=c(z),da=I.filter(function(oa){return pa(oa,E)}),U.tables.addMany(da),[4,Promise.all(p.toArray().map(function(oa){return oa.load()}))];case 2:return na=ma.sent(),na.filter(function(oa){return pa(oa,E)}).forEach(function(oa){x.checkPopup(oa);U.layers.add(wa(z,oa))}),[2]}})})}function O(z,aa){return a.__awaiter(this,void 0,void 0,function(){var R,P;return a.__generator(this,function(E){switch(E.label){case 0:return"not-loaded"!==z.loadStatus?[3,2]:[4,z.load()];case 1:E.sent(),E.label=2;case 2:return R=
aa.mapView,[4,ua(z,R)];case 3:return P=E.sent(),[2,ja(P,aa)]}})})}function ja(z,aa){return a.__awaiter(this,void 0,void 0,function(){var R,P,E,U,p,I;return a.__generator(this,function(da){switch(da.label){case 0:R=aa.mapView,P=aa.map,E=P.webMap,U=E.basemap,da.label=1;case 1:return da.trys.push([1,4,,5]),p=W.findSpatialReference(R,z).spatialReference,!p||A.equals(R.spatialReference,p)||N.isLoaded()||N.canProjectWithoutEngine(R.spatialReference,p)?[3,3]:[4,N.load()];case 2:da.sent(),da.label=3;case 3:return E.basemap=
z,p&&!A.equals(R.spatialReference,p)&&(R.spatialReference=p),l.default.publish("basemaplayer-added"),aa.mapView=R,[2,z];case 4:return I=da.sent(),y.showError(I,U),[3,5];case 5:return[2]}})})}function pa(z,aa){var R,P,E;if(!z||!aa||"group"===(null===z||void 0===z?void 0:z.type))return!0;var U=!aa||(null===(R=aa.layerIds)||void 0===R?0:R.length)&&1===(null===(P=null===aa||void 0===aa?void 0:aa.layers)||void 0===P?void 0:P.length)?aa.layerIds:null;return-1<(aa.layers||[]).indexOf(null===(E=z.portalItem)||
void 0===E?void 0:E.id)&&(null===U||void 0===U?0:U.length)&&-1===U.indexOf(z.layerId)?!1:!0}function wa(z,aa){aa.title=z.title+" - "+aa.title;return aa}function ka(z){return a.__awaiter(this,void 0,void 0,function(){var aa;return a.__generator(this,function(R){switch(R.label){case 0:return(aa=x.isDynamicLayer(z))&&z.loadAll?[4,z.loadAll()]:[3,2];case 1:return R.sent(),[2,z];case 2:return[2,Promise.resolve(z)]}})})}function ra(z,aa){var R;aa=aa.map;var P=aa.basemap,E=null===P||void 0===P?void 0:P.baseLayers,
U=null===P||void 0===P?void 0:P.referenceLayers;return(aa=null===(R=aa.allLayers)||void 0===R?void 0:R.filter(function(p){return!(null===E||void 0===E?0:E.includes(p))&&!U.includes(p)}))&&aa.length?aa.every(function(p){return(null===p||void 0===p?0:p.tileInfo)&&"imagery-tile"!==(null===p||void 0===p?void 0:p.type)&&"imagery"!==(null===p||void 0===p?void 0:p.type)?x.isSameSpatialReference(z,null===p||void 0===p?void 0:p.spatialReference):!0}):!0}function za(z,aa){return a.__awaiter(this,void 0,void 0,
function(){var R,P,E,U,p,I,da,na;return a.__generator(this,function(ma){switch(ma.label){case 0:return R=aa.map,P=aa.mapView,E=R.webMap,U=E.basemap,p=U.baseLayers,I=(z||[]).every(function(oa){return p.includes(oa)}),da=z.some(function(oa){return oa.isTable}),na=z.some(function(oa){return!oa.isTable}),P.updating?[4,H.whenOnce(function(){return!P.updating})]:[3,2];case 1:ma.sent(),ma.label=2;case 2:return da&&l.default.publish("table-added"),na&&!I&&l.default.publish("layer-added"),[2]}})})}function ua(z,
aa){return a.__awaiter(this,void 0,void 0,function(){var R,P,E,U;return a.__generator(this,function(p){switch(p.label){case 0:var I=z.title;var da=z.type;var na=z.supportedSpatialReferences,ma=z.spatialReferences,oa=aa.spatialReference;"wmts"===da&&(null===na||void 0===na?0:na.length)?da=na[0]:"wms"===da&&(null===ma||void 0===ma?0:ma.length)?(da=la(oa,ma),z.spatialReference=da):da=z.spatialReference;R={baseLayers:[z],title:I,spatialReference:da};p.label=1;case 1:return p.trys.push([1,6,,7]),P=new q.default(R),
null!==P&&void 0!==P&&P.loadAll?[4,P.loadAll()]:[3,3];case 2:return E=p.sent(),[3,5];case 3:return[4,P.load()];case 4:E=p.sent(),p.label=5;case 5:return E,[2,P];case 6:return U=p.sent(),y.showError(U,z),[3,7];case 7:return[2]}})})}function la(z,aa){return aa.find(function(R){return A.equals(z,new G.default({wkid:R}))})||(null===aa||void 0===aa?0:aa.length)?aa[0]:z}function Da(z,aa,R){return a.__awaiter(this,void 0,void 0,function(){var P,E,U;return a.__generator(this,function(p){switch(p.label){case 0:return p.trys.push([0,
6,,7]),aa?[3,2]:[4,C(z,R)];case 1:return E=p.sent(),[3,4];case 2:return[4,Ea(z)];case 3:E=p.sent(),p.label=4;case 4:return P=E,[4,P.load()];case 5:return p.sent(),[2,P];case 6:return(U=p.sent())&&y.showError(U,z),[3,7];case 7:return[2]}})})}function Ea(z){return a.__awaiter(this,void 0,void 0,function(){var aa,R,P,E;return a.__generator(this,function(U){switch(U.label){case 0:return aa={portal:{url:"https://www.arcgis.com"},id:z.id},R=new F.default(aa),[4,R.load()];case 1:return U.sent(),[4,C(R)];
case 2:return P=U.sent(),P.portalItem=null,"group"===P.type&&(E=(P.allLayers||[]).concat(P.allTables||[]),(E||[]).forEach(function(p){return p.portalItem=null})),[2,P]}})})}function Aa(z){return a.__awaiter(this,void 0,void 0,function(){var aa,R;return a.__generator(this,function(P){switch(P.label){case 0:return P.trys.push([0,2,,3]),aa=new u.default({url:z.url}),[4,aa.load()];case 1:return P.sent(),[2,aa];case 2:return R=P.sent(),y.showError(R,z),[3,3];case 3:return[2]}})})}function Z(z){var aa,
R;return a.__awaiter(this,void 0,void 0,function(){var P,E,U,p,I;return a.__generator(this,function(da){switch(da.label){case 0:return da.trys.push([0,6,,7]),P=ha(z),[4,k.fromUrl(P.path)];case 1:E=da.sent();if(null===(aa=P.query)||void 0===aa?0:aa.where)E.definitionExpression=null===(R=P.query)||void 0===R?void 0:R.where;return null!==E&&void 0!==E&&E.loadAll?[4,E.loadAll()]:[3,3];case 2:return U=da.sent(),[3,5];case 3:return[4,E.load()];case 4:U=da.sent(),da.label=5;case 5:return U,[2,E];case 6:return p=
da.sent(),I=(null===p||void 0===p?void 0:p.details)||{},I.url=z,p.details=I,y.showError(p),[2,Promise.reject(p)];case 7:return[2]}})})}function ha(z){var aa=Q.urlToObject(z),R=null===z||void 0===z?void 0:z.indexOf("/query?");aa&&-1<R&&(aa.path=z.substring(0,R));return aa||{path:z}}function ea(z,aa){switch(z.type){case "OGCFeatureServer":var R=va(z);break;case "WFS":R=ta(z,aa);break;default:console.log("Unknown OGC Layer Type")}return R}function va(z){var aa=this;return new Promise(function(R,P){return a.__awaiter(aa,
void 0,void 0,function(){var E,U,p;return a.__generator(this,function(I){switch(I.label){case 0:return[4,(new Promise(function(da,na){T(["../../widgets/panels/MapMaker/itembrowsers/OGCLayerModal"],da,na)})).then(a.__importStar)];case 1:return E=I.sent(),U=(null===z||void 0===z?0:z.loaded)?z:new F.default(z),[4,U.load()];case 2:return I.sent(),p=new E.default({item:U}),p.on("close",function(da){return R(da)}),[2]}})})})}function ta(z,aa){var R=this;return new Promise(function(P,E){return a.__awaiter(R,
void 0,void 0,function(){var U,p,I;return a.__generator(this,function(da){switch(da.label){case 0:return[4,(new Promise(function(na,ma){T(["../../widgets/panels/MapMaker/itembrowsers/OGCWFSLayerModal"],na,ma)})).then(a.__importStar)];case 1:return U=da.sent(),p=(null===z||void 0===z?0:z.loaded)?z:new F.default(z),[4,p.load()];case 2:return da.sent(),I=new U.default({item:p,state:aa}),I.on("close",function(na){return P(na)}),[2]}})})})}function Ba(z){var aa=this;return new Promise(function(R){return a.__awaiter(aa,
void 0,void 0,function(){var P,E;return a.__generator(this,function(U){switch(U.label){case 0:return[4,(new Promise(function(p,I){T(["../../utils/trackViewLayer"],p,I)})).then(a.__importStar)];case 1:return P=U.sent(),[4,P.toTrackViewLayer(z)];case 2:return E=U.sent(),R(E),[2]}})})})}Object.defineProperty(e,"__esModule",{value:!0});e.getExtent=e.toTrackViewLayer=e.toWFSLayer=e.toOGCAPILayer=e.toOGCLayer=e.layerUrlToObject=e.toLayerFromUrl=e.toMapImageLayer=e.toLayerFromAGOL=e.toLayer=e.toBasemap=
e.isLayerCompatible=e.addAsBasemap=e.addLayerAsBasemap=e.addLayerToBasemap=e.addAsMapImageLayer=e.addLayersAsBasemap=e.addTables=e.addLayers=e.filterSublayers=e.getLayerFromId=e.getLayerFromUrl=e.isSecureUrl=e.validURL=e.canAddPortalItemAsBasemap=void 0;u=a.__importDefault(u);q=a.__importDefault(q);t=a.__importDefault(t);k=a.__importStar(k);x=a.__importStar(x);f=a.__importStar(f);h=a.__importStar(h);l=a.__importDefault(l);w=a.__importDefault(w);F=a.__importDefault(F);Q=a.__importStar(Q);N=a.__importStar(N);
W=a.__importStar(W);A=a.__importStar(A);G=a.__importDefault(G);H=a.__importStar(H);e.canAddPortalItemAsBasemap=function(z){z=z.type;return(null===z||void 0===z?void 0:z.toLowerCase())in{"image service":!0,"imagery-tile":!0,"map service":!0,"vector tile service":!0,wms:!0,wmts:!0}||!1};e.validURL=Y;e.isSecureUrl=M;e.getLayerFromUrl=function(z,aa){return a.__awaiter(this,void 0,void 0,function(){var R,P;return a.__generator(this,function(E){switch(E.label){case 0:return E.trys.push([0,2,,3]),E=z.split("?layers\x3d")[0],
!M(z)&&h.isHostedAgolService(E)&&(E=E.replace("http:","https:")),[4,Z(E)];case 1:return R=E.sent(),ba(R,z,aa),[2,R];case 2:return P=E.sent(),y.showError(P),[2,Promise.reject(P)];case 3:return[2]}})})};e.getLayerFromId=C;e.filterSublayers=ba;e.addLayers=function(z,aa,R){return a.__awaiter(this,void 0,void 0,function(){var P,E,U,p,I,da,na;return a.__generator(this,function(ma){switch(ma.label){case 0:return P=null===aa||void 0===aa?void 0:aa.config,E=null===P||void 0===P?void 0:P.urlParameters,U=z.filter(function(oa){return pa(oa,
E)}),p=aa.mapView,I=p.map,da=[],na=[I.layers.on("change",function(oa){return da=da.concat(oa.added||[])}),I.tables.on("change",function(oa){return da=da.concat(oa.added||[])})],[4,Promise.all(U.map(function(oa){return ia(oa,aa,R)}))];case 1:return ma.sent(),na.forEach(function(oa){return oa.remove()}),za(da,aa),[2,da]}})})};e.addTables=function(z,aa){return a.__awaiter(this,void 0,void 0,function(){var R,P;return a.__generator(this,function(E){switch(E.label){case 0:return R=J(z&&z.length?z:[]),P=
R.map(function(U){return L(U,aa)}),[4,Promise.all(P)];case 1:return[2,E.sent()]}})})};e.addLayersAsBasemap=function(z,aa){return a.__awaiter(this,void 0,void 0,function(){var R;return a.__generator(this,function(P){switch(P.label){case 0:return R=z.map(function(E){return O(E,aa)}),[4,Promise.all(R)];case 1:return[2,P.sent()]}})})};e.addAsMapImageLayer=r;e.addLayerToBasemap=function(z,aa){return a.__awaiter(this,void 0,void 0,function(){var R,P,E,U,p,I,da;return a.__generator(this,function(na){switch(na.label){case 0:R=
aa.mapView;P=R.map;E=P.basemap;U=E.baseLayers;p=z.type;if("map-image"!==p&&"imagery-tile"!==p&&"imagery"!==p&&!x.isSameSpatialReference(z,R.spatialReference))return[3,1];U.add(z);return[2,Promise.resolve(z)];case 1:return[4,ra(z,R)];case 2:return da=(I=na.sent())?"basemap:spatial-reference-incompatible":"basemap:spatial-reference-incompatible-layers",y.showError({name:da},z),[2,Promise.reject({error:{name:da}})]}})})};e.addLayerAsBasemap=O;e.addAsBasemap=ja;e.isLayerCompatible=ra;e.toBasemap=ua;e.toLayer=
Da;e.toLayerFromAGOL=Ea;e.toMapImageLayer=Aa;e.toLayerFromUrl=Z;e.layerUrlToObject=ha;e.toOGCLayer=ea;e.toOGCAPILayer=va;e.toWFSLayer=ta;e.toTrackViewLayer=Ba;e.getExtent=function(z,aa){var R=aa.mapView;return v.getExtent(z,R,(null===z||void 0===z?0:z.portalItem)?!1:!0).then(function(P){var E=R.extent,U=P&&P.intersection(E),p=P&&P.intersects(E);if(p){U=U.get("width")*U.get("height");var I=E.get("width")*E.get("height");U<I/200?p=!1:P.get("width")*P.get("height")<I/1E3&&(p=!1)}return p?E:P})}})},"esri/layers/MapImageLayer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../request ../TimeExtent ../core/Error ../core/HandleOwner ../core/loadAll ../core/maybe ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ../core/accessorSupport/PropertyOrigin ../geometry/Extent ../geometry/support/scaleUtils ./Layer ./mixins/APIKeyMixin ./mixins/ArcGISMapService ./mixins/ArcGISService ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/SublayersOwner ./mixins/TemporalLayer ./support/commonProperties ./support/ExportImageParameters ./support/Sublayer ./support/sublayerUtils ./support/versionUtils".split(" "),
function(T,e,a,u,q,y,t,k,v,x,f,h,l,w,F,Q,N,W,A,G,H,Y,M,C,D,X,ba,ia,L,J,c,d,g,r,K,V,O){y=function(ja){function pa(...ka){ka=ja.call(this,...ka)||this;ka.datesInUnknownTimezone=!1;ka.dpi=96;ka.gdbVersion=null;ka.imageFormat="png24";ka.imageMaxHeight=2048;ka.imageMaxWidth=2048;ka.imageTransparency=!0;ka.isReference=null;ka.labelsVisible=!1;ka.operationalLayerType="ArcGISMapServiceLayer";ka.sourceJSON=null;ka.sublayers=null;ka.type="map-image";ka.url=null;return ka}T._inheritsLoose(pa,ja);var wa=pa.prototype;
wa.normalizeCtorArgs=function(ka,ra){return"string"===typeof ka?{url:ka,...ra}:ka};wa.load=function(ka){const ra=k.isSome(ka)?ka.signal:null;this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},ka).catch(x.throwIfAbortError).then(()=>this._fetchService(ra)));return Promise.resolve(this)};wa.readImageFormat=function(ka,ra){return(ka=ra.supportedImageFormatTypes)&&ka.includes("PNG32")?"png32":"png24"};wa.writeSublayers=function(ka,ra,za,ua){if(this.loaded&&ka){ka=ka.slice().reverse().flatten(({sublayers:Aa})=>
Aa&&Aa.toArray().reverse()).toArray();za=!1;if(this.capabilities&&this.capabilities.operations.supportsExportMap&&this.capabilities.exportMap.supportsDynamicLayers){const Aa=W.nameToId(ua.origin);Aa===W.OriginId.PORTAL_ITEM?(za=this.createSublayersForOrigin("service").sublayers,za=V.shouldWriteSublayerStructure(ka,za,W.OriginId.SERVICE)):Aa>W.OriginId.PORTAL_ITEM&&(za=this.createSublayersForOrigin("portal-item"),za=V.shouldWriteSublayerStructure(ka,za.sublayers,W.nameToId(za.origin)))}var la=[],Da=
{writeSublayerStructure:za,...ua},Ea=za;ka.forEach(Aa=>{const Z=Aa.write({},Da);la.push(Z);Ea=Ea||"user"===Aa.originOf("visible")});la.some(Aa=>1<Object.keys(Aa).length)&&(ra.layers=la);Ea&&(ra.visibleLayers=ka.filter(Aa=>Aa.visible).map(Aa=>Aa.id))}};wa.createExportImageParameters=function(ka,ra,za,ua){var la=ua&&ua.pixelRatio||1;ka&&10<=this.version&&(ka=ka.clone().shiftCentralMeridian());var Da=new r.ExportImageParameters({layer:this,floors:null==ua?void 0:ua.floors,scale:G.getScale({extent:ka,
width:ra})*la});const Ea=Da.toJSON();Da.destroy();Da=!ua||!ua.rotation||10.3>this.version?{}:{rotation:-ua.rotation};var Aa=ka&&ka.spatialReference;Aa=Aa.wkid||JSON.stringify(Aa.toJSON());Ea.dpi*=la;la={};if(null!=ua&&ua.timeExtent){const {start:Z,end:ha}=ua.timeExtent.toJSON();la.time=Z&&ha&&Z===ha?""+Z:`${null==Z?"null":Z},${null==ha?"null":ha}`}else this.timeInfo&&!this.timeInfo.hasLiveData&&(la.time="null,null");return{bbox:ka&&ka.xmin+","+ka.ymin+","+ka.xmax+","+ka.ymax,bboxSR:Aa,imageSR:Aa,
size:ra+","+za,...Ea,...Da,...la}};wa.fetchImage=function(){var ka=T._asyncToGenerator(function*(ra,za,ua,la){var Da;ra={responseType:"image",signal:null!=(Da=null==la?void 0:la.signal)?Da:null,query:{...this.parsedUrl.query,...this.createExportImageParameters(ra,za,ua,la),f:"image",...this.refreshParameters,...this.customParameters,token:this.apiKey}};const Ea=this.parsedUrl.path+"/export";if(null!=ra.query.dynamicLayers&&!this.capabilities.exportMap.supportsDynamicLayers)throw new q("mapimagelayer:dynamiclayer-not-supported",
`service ${this.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`,{query:ra.query});return a(Ea,ra).then(Aa=>Aa.data).catch(Aa=>{if(x.isAbortError(Aa))throw Aa;throw new q("mapimagelayer:image-fetch-error",`Unable to load image: ${Ea}`,{error:Aa});})});return function(ra,za,ua,la){return ka.apply(this,arguments)}}();wa.fetchRecomputedExtents=function(){var ka=T._asyncToGenerator(function*(ra={}){({data:ra}=yield a(this.url,
{...ra,query:{returnUpdates:!0,f:"json",...this.customParameters,token:this.apiKey}}));const {extent:za,fullExtent:ua,timeExtent:la}=ra;ra=za||ua;return{fullExtent:ra&&A.fromJSON(ra),timeExtent:la&&u.fromJSON({start:la[0],end:la[1]})}});return function(){return ka.apply(this,arguments)}}();wa.loadAll=function(){return t.loadAll(this,ka=>{ka(this.allSublayers)})};wa.serviceSupportsSpatialReference=function(ka){return O.serviceSupportsSpatialReference(this,ka)};wa._fetchService=function(){var ka=T._asyncToGenerator(function*(ra){if(this.sourceJSON)this.read(this.sourceJSON,
{origin:"service",url:this.parsedUrl});else{var {data:za,ssl:ua}=yield a(this.parsedUrl.path,{query:{f:"json",...this.parsedUrl.query,...this.customParameters,token:this.apiKey},signal:ra});ua&&(this.url=this.url.replace(/^http:/i,"https:"));this.sourceJSON=za;this.read(za,{origin:"service",url:this.parsedUrl})}});return function(ra){return ka.apply(this,arguments)}}();return pa}(D.BlendLayer(d.TemporalLayer(J.ScaleRangeLayer(c.SublayersOwner(M.ArcGISMapService(C.ArcGISService(ba.OperationalLayer(ia.PortalLayer(v.MultiOriginJSONMixin(L.RefreshableLayer(Y.APIKeyMixin(X.CustomParametersMixin(y.HandleOwnerMixin(H))))))))))))));
e.__decorate([f.property({type:Boolean})],y.prototype,"datesInUnknownTimezone",void 0);e.__decorate([f.property()],y.prototype,"dpi",void 0);e.__decorate([f.property()],y.prototype,"gdbVersion",void 0);e.__decorate([f.property()],y.prototype,"imageFormat",void 0);e.__decorate([F.reader("imageFormat",["supportedImageFormatTypes"])],y.prototype,"readImageFormat",null);e.__decorate([f.property({json:{origins:{service:{read:{source:"maxImageHeight"}}}}})],y.prototype,"imageMaxHeight",void 0);e.__decorate([f.property({json:{origins:{service:{read:{source:"maxImageWidth"}}}}})],
y.prototype,"imageMaxWidth",void 0);e.__decorate([f.property()],y.prototype,"imageTransparency",void 0);e.__decorate([f.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],y.prototype,"isReference",void 0);e.__decorate([f.property({json:{read:!1,write:!1}})],y.prototype,"labelsVisible",void 0);e.__decorate([f.property({type:["ArcGISMapServiceLayer"]})],y.prototype,"operationalLayerType",void 0);e.__decorate([f.property({json:{read:!1,write:!1}})],y.prototype,
"popupEnabled",void 0);e.__decorate([f.property()],y.prototype,"sourceJSON",void 0);e.__decorate([f.property({json:{write:{ignoreOrigin:!0}}})],y.prototype,"sublayers",void 0);e.__decorate([N.writer("sublayers",{layers:{type:[K]},visibleLayers:{type:[w.Integer]}})],y.prototype,"writeSublayers",null);e.__decorate([f.property({type:["show","hide","hide-children"]})],y.prototype,"listMode",void 0);e.__decorate([f.property({json:{read:!1},readOnly:!0,value:"map-image"})],y.prototype,"type",void 0);e.__decorate([f.property(g.url)],
y.prototype,"url",void 0);return y=e.__decorate([Q.subclass("esri.layers.MapImageLayer")],y)})},"esri/geometry/support/scaleUtils":function(){define(["exports","../../core/unitUtils"],function(T,e){function a(u,q){q=e.getMetersPerUnitForSR(q);return u/(q*e.inchesPerMeter*96)}T.getExtentForScale=function(u,q){const y=u.extent;u=u.width;q=a(q,y.spatialReference);return y.clone().expand(q*u/y.width)};T.getResolutionForScale=a;T.getScale=function(u,q){q=q||u.extent;u=u.width;const y=e.getMetersPerUnitForSR(q&&
q.spatialReference);return q&&u?q.width/u*y*e.inchesPerMeter*96:0};T.getScaleForResolution=function(u,q){q=e.getMetersPerUnitForSR(q);return u*q*e.inchesPerMeter*96};Object.defineProperties(T,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/mixins/ArcGISMapService":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/promiseUtils ../../core/urlUtils ../../core/Version ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ../support/commonProperties".split(" "),
function(T,e,a,u,q,y,t,k,v,x,f,h,l,w,F,Q){T.ArcGISMapService=N=>{N=function(W){function A(){var H=W.apply(this,arguments)||this;H.capabilities=void 0;H.copyright=null;H.fullExtent=null;H.legendEnabled=!0;H.spatialReference=null;H.version=void 0;return H}e._inheritsLoose(A,W);var G=A.prototype;G.readCapabilities=function(H,Y){var M,C,D=Y.capabilities&&Y.capabilities.split(",").map(K=>K.toLowerCase().trim());if(!D)return{operations:{supportsExportMap:!1,supportsExportTiles:!1,supportsIdentify:!1,supportsQuery:!1,
supportsTileMap:!1},exportMap:null,exportTiles:null};var X=this.type;H=D.includes("data");const ba=D.includes("query"),ia=D.includes("map"),L=!!Y.exportTilesAllowed;D=D.includes("tilemap");const J="tile"!==X&&!!Y.supportsDynamicLayers,c="tile"!==X&&(!Y.tileInfo||J),d="tile"!==X&&(!Y.tileInfo||J);X="tile"!==X;const g=Y.cimVersion&&t.Version.parse(Y.cimVersion),r=null!=(M=null==g?void 0:g.since(1,4))?M:!1;M=null!=(C=null==g?void 0:g.since(2,0))?C:!1;return{operations:{supportsExportMap:ia,supportsExportTiles:L,
supportsIdentify:ba,supportsQuery:H,supportsTileMap:D},exportMap:ia?{supportsArcadeExpressionForLabeling:r,supportsSublayersChanges:X,supportsDynamicLayers:J,supportsSublayerVisibility:c,supportsSublayerDefinitionExpression:d,supportsCIMSymbols:M}:null,exportTiles:L?{maxExportTilesCount:+Y.maxExportTilesCount}:null}};G.readVersion=function(H,Y){(H=Y.currentVersion)||(H=Y.hasOwnProperty("capabilities")||Y.hasOwnProperty("tables")?10:Y.hasOwnProperty("supportedImageFormatTypes")?9.31:9.3);return H};
G.fetchSublayerInfo=function(){var H=e._asyncToGenerator(function*(Y,M){yield this.fetchAllLayersAndTables(M);return this._allLayersAndTablesMap.get(Y)});return function(Y,M){return H.apply(this,arguments)}}();G.fetchAllLayersAndTables=function(){var H=e._asyncToGenerator(function*(Y){yield this.load(Y);this._allLayersAndTablesPromise||(this._allLayersAndTablesPromise=u(y.urlToObject(this.url).path+"/layers",{responseType:"json",query:{f:"json",...this.customParameters,token:this.apiKey}}).then(C=>
{this._allLayersAndTablesMap=new Map;for(const D of C.data.layers)this._allLayersAndTablesMap.set(D.id,D);return{result:C.data}},C=>({error:C})));const M=yield this._allLayersAndTablesPromise;q.throwIfAborted(Y);if("result"in M)return M.result;throw M.error;});return function(Y){return H.apply(this,arguments)}}();return A}(N);a.__decorate([k.property({readOnly:!0})],N.prototype,"capabilities",void 0);a.__decorate([h.reader("service","capabilities",["capabilities","exportTilesAllowed","maxExportTilesCount",
"supportsDynamicLayers","tileInfo"])],N.prototype,"readCapabilities",null);a.__decorate([k.property({json:{read:{source:"copyrightText"}}})],N.prototype,"copyright",void 0);a.__decorate([k.property({type:w})],N.prototype,"fullExtent",void 0);a.__decorate([k.property(Q.id)],N.prototype,"id",void 0);a.__decorate([k.property({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],N.prototype,"legendEnabled",void 0);a.__decorate([k.property(Q.popupEnabled)],
N.prototype,"popupEnabled",void 0);a.__decorate([k.property({type:F})],N.prototype,"spatialReference",void 0);a.__decorate([k.property({readOnly:!0})],N.prototype,"version",void 0);a.__decorate([h.reader("version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],N.prototype,"readVersion",null);return N=a.__decorate([l.subclass("esri.layers.mixins.ArcGISMapService")],N)};Object.defineProperties(T,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/Version":function(){define(["exports",
"./Error"],function(T,e){let a=function(){function u(y,t,k=""){this.major=y;this.minor=t;this._context=k}var q=u.prototype;q.lessThan=function(y,t){return this.major<y||y===this.major&&this.minor<t};q.since=function(y,t){return!this.lessThan(y,t)};q.validate=function(y){if(this.major!==y.major)throw new e((this._context&&this._context+":")+"unsupported-version",`Required major ${this._context&&this._context+" "}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:y});
};q.clone=function(){return new u(this.major,this.minor,this._context)};u.parse=function(y,t=""){const [k,v]=y.split(".");var x=/^\s*\d+\s*$/;if(!k||!k.match||!k.match(x))throw new e((t&&t+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:y});if(!v||!v.match||!v.match(x))throw new e((t&&t+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:y});y=parseInt(k,10);x=parseInt(v,10);return new u(y,x,t)};return u}();T.Version=
a;Object.defineProperties(T,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/mixins/SublayersOwner":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/CollectionFlattener ../../core/Error ../../core/Logger ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/utils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/PropertyOrigin ../support/Sublayer ../support/sublayerUtils".split(" "),
function(T,e,a,u,q,y,t,k,v,x,f,h,l,w,F,Q,N){function W(Y,M){const C=[],D={};if(!Y)return C;Y.forEach(X=>{const ba=new Q;ba.read(X,M);D[ba.id]=ba;null!=X.parentLayerId&&-1!==X.parentLayerId?(X=D[X.parentLayerId],X.sublayers||(X.sublayers=[]),X.sublayers.unshift(ba)):C.unshift(ba)});return C}function A(Y,M){Y&&Y.forEach(C=>{M(C);C.sublayers&&C.sublayers.length&&A(C.sublayers,M)})}const G=t.getLogger("esri.layers.TileLayer"),H=u.ofType(Q);T.SublayersOwner=Y=>{Y=function(M){function C(...X){var ba=M.call(this,
...X)||this;ba.allSublayers=new q({getCollections:()=>[ba.sublayers],getChildrenFunction(ia){return ia.sublayers}});ba.sublayersSourceJSON={[F.OriginId.SERVICE]:{},[F.OriginId.PORTAL_ITEM]:{},[F.OriginId.WEB_SCENE]:{},[F.OriginId.WEB_MAP]:{}};ba.own(k.watch(()=>ba.sublayers,(ia,L)=>ba._handleSublayersChange(ia,L),k.sync));return ba}e._inheritsLoose(C,M);var D=C.prototype;D.readSublayers=function(X,ba){if(ba&&X){var {sublayersSourceJSON:ia}=this,L=F.nameToId(ba.origin);if(!(L<F.OriginId.SERVICE||(ia[L]=
{context:ba,visibleLayers:X.visibleLayers||ia[L].visibleLayers,layers:X.layers||ia[L].layers},L>F.OriginId.SERVICE))){this._set("serviceSublayers",this.createSublayersForOrigin("service").sublayers);var {sublayers:J,origin:c}=this.createSublayersForOrigin("web-document");X=h.getProperties(this);X.setDefaultOrigin(c);this._set("sublayers",new H(J));X.setDefaultOrigin("user")}}};D.findSublayerById=function(X){return this.allSublayers.find(ba=>ba.id===X)};D.createServiceSublayers=function(){return this.createSublayersForOrigin("service").sublayers};
D.createSublayersForOrigin=function(X){const ba="web-document"===X?F.nameToId("web-map"):F.nameToId(X);let ia=F.OriginId.SERVICE;X=this.sublayersSourceJSON[F.OriginId.SERVICE].layers;let L=this.sublayersSourceJSON[F.OriginId.SERVICE].context,J=null;var c=[F.OriginId.PORTAL_ITEM,F.OriginId.WEB_SCENE,F.OriginId.WEB_MAP].filter(O=>O<=ba);for(var d of c)c=this.sublayersSourceJSON[d],N.isSublayerOverhaul(c.layers)&&(ia=d,X=c.layers,L=c.context,c.visibleLayers&&(J={visibleLayers:c.visibleLayers,context:c.context}));
d=[F.OriginId.PORTAL_ITEM,F.OriginId.WEB_SCENE,F.OriginId.WEB_MAP].filter(O=>O>ia&&O<=ba);let g=null;for(var r of d){const {layers:O,visibleLayers:ja,context:pa}=this.sublayersSourceJSON[r];O&&(g={layers:O,context:pa});ja&&(J={visibleLayers:ja,context:pa})}r=W(X,L);const K=new Map,V=new Set;if(g)for(const O of g.layers)K.set(O.id,O);if(J)for(const O of J.visibleLayers)V.add(O);A(r,O=>{g&&O.read(K.get(O.id),g.context);J&&O.read({defaultVisibility:V.has(O.id)},J.context)});return{origin:F.idToName(ia),
sublayers:new H({items:r})}};D.read=function(X,ba){M.prototype.read.call(this,X,ba);this.readSublayers(X,ba)};D._handleSublayersChange=function(X,ba){ba&&(ba.forEach(ia=>{ia.parent=null;ia.layer=null}),this.handles.remove("sublayers-owner"));X&&(X.forEach(ia=>{ia.parent=this;ia.layer=this}),this.handles.add([X.on("after-add",({item:ia})=>{ia.parent=this;ia.layer=this}),X.on("after-remove",({item:ia})=>{ia.parent=null;ia.layer=null})],"sublayers-owner"),"tile"===this.type&&this.handles.add(X.on("before-changes",
ia=>{G.error(new y("tilelayer:sublayers-non-modifiable","ISublayer can't be added, moved, or removed from the layer's sublayers",{layer:this}));ia.preventDefault()}),"sublayers-owner"))};return C}(Y);a.__decorate([v.property({readOnly:!0})],Y.prototype,"allSublayers",void 0);a.__decorate([v.property({readOnly:!0,type:u.ofType(Q)})],Y.prototype,"serviceSublayers",void 0);a.__decorate([v.property({value:null,type:H,json:{read:!1,write:{allowNull:!0,ignoreOrigin:!0}}})],Y.prototype,"sublayers",void 0);
a.__decorate([v.property({readOnly:!0})],Y.prototype,"sublayersSourceJSON",void 0);return Y=a.__decorate([w.subclass("esri.layers.mixins.SublayersOwner")],Y)};T.forEachSublayer=A;Object.defineProperties(T,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/Sublayer":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../PopupTemplate ../../renderers/ClassBreaksRenderer ../../renderers/DictionaryRenderer ../../renderers/DotDensityRenderer ../../renderers/HeatmapRenderer ../../renderers/PieChartRenderer ../../renderers/Renderer ../../renderers/SimpleRenderer ../../renderers/UniqueValueRenderer ../../renderers/support/jsonUtils ../../renderers/support/types ../../request ../../symbols ../../core/Collection ../../core/Error ../../core/HandleOwner ../../core/Identifiable ../../core/lang ../../core/Loadable ../../core/Logger ../../core/maybe ../../core/MultiOriginJSONSupport ../../core/sql ../../core/urlUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/utils ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../core/accessorSupport/PropertyOrigin ./arcgisLayerUrl ./FeatureType ./Field ./FieldsIndex ./LabelClass ./LayerFloorInfo ./source/DataLayerSource ./source/MapLayerSource ../../rest/support/Query ../../support/popupUtils ../../geometry/Extent".split(" "),
function(T,e,a,u,q,y,t,k,v,x,f,h,l,w,F,Q,N,W,A,G,H,Y,M,C,D,X,ba,ia,L,J,c,d,g,r,K,V,O,ja,pa,wa,ka,ra,za,ua,la,Da,Ea){function Aa(P){return P&&"esriSMS"===P.type}function Z(P,E,U){var p;P=this.originIdOf(E)>=V.nameToId(U.origin);return{ignoreOrigin:!0,allowNull:P,enabled:U?"map-image"===(null==(p=U.layer)?void 0:p.type)&&(U.writeSublayerStructure||P):!1}}function ha(P,E,U){var p;return{enabled:U?"tile"===(null==(p=U.layer)?void 0:p.type)&&this._isOverridden(E):!1}}function ea(P,E,U){return{ignoreOrigin:!0,
enabled:U&&U.writeSublayerStructure||!1}}function va(P,E,U){return{ignoreOrigin:!0,enabled:U?U.writeSublayerStructure||this.originIdOf(E)>=V.nameToId(U.origin):!1}}const ta=P=>Object.freeze(Object.defineProperty({__proto__:null,default:P},Symbol.toStringTag,{value:"Module"}));var Ba;const z=C.getLogger("esri.layers.support.Sublayer");let aa=0;const R=new Set;R.add("layer");R.add("parent");R.add("loaded");R.add("loadStatus");R.add("loadError");R.add("loadWarnings");u=Ba=function(P){function E(p){p=
P.call(this,p)||this;p.capabilities=void 0;p.fields=null;p.fullExtent=null;p.globalIdField=null;p.legendEnabled=!0;p.objectIdField=null;p.popupEnabled=!0;p.popupTemplate=null;p.sourceJSON=null;p.title=null;p.typeIdField=null;p.types=null;return p}e._inheritsLoose(E,P);var U=E.prototype;U.load=function(){var p=e._asyncToGenerator(function*(I){var da=this;this.addResolvingPromise(e._asyncToGenerator(function*(){var na;if(!da.layer&&!da.url)throw new A("sublayer:missing-layer","Sublayer can't be loaded without being part of a layer",
{sublayer:da});let ma=null;if(!da.layer||da.originIdOf("url")>V.OriginId.SERVICE||"data-layer"===(null==(na=da.source)?void 0:na.type))ma=(yield Q(da.url,{responseType:"json",query:{f:"json"},...I})).data;else{var oa;na=da.id;"map-layer"===(null==(oa=da.source)?void 0:oa.type)&&(na=da.source.mapLayerId);ma=yield da.layer.fetchSublayerInfo(na,I)}ma&&(da.sourceJSON=ma,da.read({layerDefinition:ma},{origin:"service"}))})());return this});return function(I){return p.apply(this,arguments)}}();U.readCapabilities=
function(p,I){I=I.layerDefinition||I;p=(p=I.capabilities||p)?p.toLowerCase().split(",").map(na=>na.trim()):[];const da=this.url?O.parse(this.url):null;p=p.includes(D.isSome(da)&&"MapServer"===da.serverType?"data":"query");return{exportMap:{supportsModification:!!I.canModifyLayer},operations:{supportsQuery:p}}};U.readGlobalIdFieldFromService=function(p,I){I=I.layerDefinition||I;if(I.globalIdField)return I.globalIdField;if(I.fields)for(const da of I.fields)if("esriFieldTypeGlobalID"===da.type)return da.name};
U.writeLabelingInfo=function(p,I,da,na){p&&p.length&&(I.layerDefinition={drawingInfo:{labelingInfo:p.map(ma=>ma.write({},na))}})};U.readMinScale=function(p,I){return I.minScale||I.layerDefinition&&I.layerDefinition.minScale||0};U.readMaxScale=function(p,I){return I.maxScale||I.layerDefinition&&I.layerDefinition.maxScale||0};U.readObjectIdFieldFromService=function(p,I){I=I.layerDefinition||I;if(I.objectIdField)return I.objectIdField;if(I.fields)for(const da of I.fields)if("esriFieldTypeOID"===da.type)return da.name};
U.readOpacity=function(p,I){p=I.layerDefinition;return 1-.01*(null!=p.transparency?p.transparency:p.drawingInfo.transparency)};U.writeOpacity=function(p,I,da,na){I.layerDefinition={drawingInfo:{transparency:100-100*p}}};U.writeParent=function(p,I){I.parentLayerId=this.parent&&this.parent!==this.layer?K.ensureInteger(this.parent.id):-1};U.castSublayers=function(p){return K.ensureType(W.ofType(Ba),p)};U.writeSublayers=function(p,I,da){this.get("sublayers.length")&&(I[da]=this.sublayers.map(na=>na.id).toArray().reverse())};
U.readTypeIdField=function(p,I){I=I.layerDefinition||I;let da=I.typeIdField;da&&I.fields&&(da=da.toLowerCase(),p=I.fields.find(na=>na.name.toLowerCase()===da))&&(da=p.name);return null};U.writeVisible=function(p,I,da,na){I[da]=this.getAtOrigin("defaultVisibility","service")||p};U.clone=function(){const {store:p}=J.getProperties(this),I=new Ba;J.getProperties(I).store=p.clone(R);this.commitProperty("url");I._lastParsedUrl=this._lastParsedUrl;return I};U.createPopupTemplate=function(p){return Da.createPopupTemplate(this,
p)};U.createQuery=function(){return new la({returnGeometry:!0,where:this.definitionExpression||"1\x3d1"})};U.createFeatureLayer=function(){var p=e._asyncToGenerator(function*(){var I,da;if(this.hasOwnProperty("sublayers"))return null;const na=null==(I=this.layer)?void 0:I.parsedUrl;I=new (yield new Promise((ma,oa)=>T(["../FeatureLayer"],Ga=>ma(ta(Ga)),oa))).default({url:na.path});na&&this.source&&("map-layer"===this.source.type?I.layerId=this.source.mapLayerId:I.dynamicDataSource=this.source);null!=
this.layer.refreshInterval&&(I.refreshInterval=this.layer.refreshInterval);this.definitionExpression&&(I.definitionExpression=this.definitionExpression);this.floorInfo&&(I.floorInfo=Y.clone(this.floorInfo));this.originIdOf("labelingInfo")>V.OriginId.SERVICE&&(I.labelingInfo=Y.clone(this.labelingInfo));this.originIdOf("labelsVisible")>V.OriginId.DEFAULTS&&(I.labelsVisible=this.labelsVisible);this.originIdOf("legendEnabled")>V.OriginId.DEFAULTS&&(I.legendEnabled=this.legendEnabled);this.originIdOf("visible")>
V.OriginId.DEFAULTS&&(I.visible=this.visible);this.originIdOf("minScale")>V.OriginId.DEFAULTS&&(I.minScale=this.minScale);this.originIdOf("maxScale")>V.OriginId.DEFAULTS&&(I.maxScale=this.maxScale);this.originIdOf("opacity")>V.OriginId.DEFAULTS&&(I.opacity=this.opacity);this.originIdOf("popupTemplate")>V.OriginId.DEFAULTS&&(I.popupTemplate=Y.clone(this.popupTemplate));this.originIdOf("renderer")>V.OriginId.SERVICE&&(I.renderer=Y.clone(this.renderer));"data-layer"===(null==(da=this.source)?void 0:
da.type)&&(I.dynamicDataSource=this.source.clone());this.originIdOf("title")>V.OriginId.DEFAULTS&&(I.title=this.title);"map-image"===this.layer.type&&this.layer.originIdOf("customParameters")>V.OriginId.DEFAULTS&&(I.customParameters=this.layer.customParameters);"tile"===this.layer.type&&this.layer.originIdOf("customParameters")>V.OriginId.DEFAULTS&&(I.customParameters=this.layer.customParameters);return I});return function(){return p.apply(this,arguments)}}();U.getField=function(p){return this.fieldsIndex.get(p)};
U.getFeatureType=function(p){const {typeIdField:I,types:da}=this;if(!I||!p)return null;const na=p.attributes?p.attributes[I]:void 0;if(null==na)return null;let ma=null;da.some(oa=>{const {id:Ga}=oa;if(null==Ga)return!1;Ga.toString()===na.toString()&&(ma=oa);return!!ma});return ma};U.getFieldDomain=function(p,I){return(I=this.getFeatureType(I&&I.feature))&&(I=I.domains&&I.domains[p])&&"inherited"!==I.type?I:this._getLayerDomain(p)};U.queryFeatures=function(){var p=e._asyncToGenerator(function*(I=this.createQuery(),
da){var na,ma,oa,Ga,Ma,Za;yield this.load();if(null==(na=this.capabilities)||null==(ma=na.operations)||!ma.supportsQuery)throw new A("Sublayer.queryFeatures","this layer doesn't support queries.");const [{executeQuery:Ta},{default:cb}]=yield Promise.all([new Promise((Ia,Ua)=>T(["../../rest/query/operations/query"],Ia,Ua)),new Promise((Ia,Ua)=>T(["../../rest/support/FeatureSet"],db=>Ia(ta(db)),Ua))]);I=yield Ta(this.url,la.from(I),null!=(oa=null==(Ga=this.layer)?void 0:Ga.spatialReference)?oa:null,
{...da,query:{...null==(Ma=this.layer)?void 0:Ma.customParameters,token:null==(Za=this.layer)?void 0:Za.apiKey}});oa=cb.fromJSON(I.data);if(null!=oa&&oa.features)for(const Ia of oa.features)Ia.sourceLayer=this;return oa});return function(){return p.apply(this,arguments)}}();U.toExportImageJSON=function(p){var I;const da={id:this.id,source:(null==(I=this.source)?void 0:I.toJSON())||{mapLayerId:this.id,type:"mapLayer"}};p=ba.sqlAnd(p,this.definitionExpression);D.isSome(p)&&(da.definitionExpression=
p);const na=["renderer","labelingInfo","opacity","labelsVisible"].reduce((ma,oa)=>{ma[oa]=this.originIdOf(oa);return ma},{});Object.keys(na).some(ma=>na[ma]>V.OriginId.SERVICE)&&(p=da.drawingInfo={},na.renderer>V.OriginId.SERVICE&&(p.renderer=this.renderer?this.renderer.toJSON():null),na.labelsVisible>V.OriginId.SERVICE&&(p.showLabels=this.labelsVisible),this.labelsVisible&&na.labelingInfo>V.OriginId.SERVICE&&(p.labelingInfo=this.labelingInfo?this.labelingInfo.map(ma=>ma.write({},{origin:"service",
layer:this.layer})):null,p.showLabels=!0),na.opacity>V.OriginId.SERVICE&&(p.transparency=100-100*this.opacity),this._assignDefaultSymbolColors(p.renderer));return da};U._assignDefaultSymbolColors=function(p){this._forEachSimpleMarkerSymbols(p,I=>{I.color||"esriSMSX"!==I.style&&"esriSMSCross"!==I.style||(I.color=I.outline&&I.outline.color?I.outline.color:[0,0,0,0])})};U._forEachSimpleMarkerSymbols=function(p,I){if(p){const da="uniqueValueInfos"in p?p.uniqueValueInfos:"classBreakInfos"in p?p.classBreakInfos:
[];for(const na of da)Aa(na.symbol)&&I(na.symbol);"symbol"in p&&Aa(p.symbol)&&I(p.symbol);"defaultSymbol"in p&&Aa(p.defaultSymbol)&&I(p.defaultSymbol)}};U._setAndNotifyLayer=function(p,I){const da=this.layer,na=this._get(p);let ma,oa;switch(p){case "definitionExpression":case "floorInfo":ma="supportsSublayerDefinitionExpression";case "minScale":case "maxScale":case "visible":ma="supportsSublayerVisibility";break;case "labelingInfo":case "labelsVisible":case "opacity":case "renderer":case "source":ma=
"supportsDynamicLayers",oa="supportsModification"}const Ga=J.getProperties(this).getDefaultOrigin();if("service"!==Ga){if(ma&&!1===this.get(`layer.capabilities.exportMap.${ma}`)){this._logLockedError(p,`capability not available 'layer.capabilities.exportMap.${ma}'`);return}if(oa&&!1===this.get(`capabilities.exportMap.${oa}`)){this._logLockedError(p,`capability not available 'capabilities.exportMap.${oa}'`);return}}"source"===p&&"not-loaded"!==this.loadStatus?this._logLockedError(p,"'source' can't be changed after calling sublayer.load()"):
(this._set(p,I),"service"!==Ga&&na!==I&&da&&da.emit&&da.emit("sublayer-update",{propertyName:p,target:this}))};U._handleSublayersChange=function(p,I){I&&(I.forEach(da=>{da.parent=null;da.layer=null}),this.handles.removeAll());p&&(p.forEach(da=>{da.parent=this;da.layer=this.layer}),this.handles.add([p.on("after-add",({item:da})=>{da.parent=this;da.layer=this.layer}),p.on("after-remove",({item:da})=>{da.parent=null;da.layer=null}),p.on("before-changes",da=>{const na=this.get("layer.capabilities.exportMap.supportsSublayersChanges");
null==na||na||(z.error(new A("sublayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{sublayer:this,layer:this.layer})),da.preventDefault())})]))};U._logLockedError=function(p,I){z.error(new A("sublayer:locked",`Property '${String(p)}' can't be changed on Sublayer from the layer '${this.layer.id}'`,{reason:I,sublayer:this,layer:this.layer}))};U._getLayerDomain=function(p){return(p=this.fieldsIndex.get(p))?p.domain:null};e._createClass(E,[{key:"definitionExpression",
set:function(p){this._setAndNotifyLayer("definitionExpression",p)}},{key:"fieldsIndex",get:function(){return new wa(this.fields||[])}},{key:"floorInfo",set:function(p){this._setAndNotifyLayer("floorInfo",p)}},{key:"id",get:function(){const p=this._get("id");return null==p?aa++:p},set:function(p){this._get("id")!==p&&(!1===this.get("layer.capabilities.exportMap.supportsDynamicLayers")?this._logLockedError("id","capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'"):this._set("id",
p))}},{key:"labelingInfo",set:function(p){this._setAndNotifyLayer("labelingInfo",p)}},{key:"labelsVisible",set:function(p){this._setAndNotifyLayer("labelsVisible",p)}},{key:"layer",set:function(p){this._set("layer",p);this.sublayers&&this.sublayers.forEach(I=>I.layer=p)}},{key:"listMode",set:function(p){this._set("listMode",p)}},{key:"minScale",set:function(p){this._setAndNotifyLayer("minScale",p)}},{key:"maxScale",set:function(p){this._setAndNotifyLayer("maxScale",p)}},{key:"effectiveScaleRange",
get:function(){const {minScale:p,maxScale:I}=this;return{minScale:p,maxScale:I}}},{key:"opacity",set:function(p){this._setAndNotifyLayer("opacity",p)}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"renderer",set:function(p){if(p)for(const I of p.getSymbols())if(N.isSymbol3D(I)){z.warn("Sublayer renderer should use 2D symbols");break}this._setAndNotifyLayer("renderer",p)}},{key:"source",get:function(){return this._get("source")||new ua.MapLayerSource({mapLayerId:this.id})},
set:function(p){this._setAndNotifyLayer("source",p)}},{key:"sublayers",set:function(p){this._handleSublayersChange(p,this._get("sublayers"));this._set("sublayers",p)}},{key:"url",get:function(){var p,I;const da=null!=(p=null==(I=this.layer)?void 0:I.parsedUrl)?p:this._lastParsedUrl;p=this.source;if(!da)return null;this._lastParsedUrl=da;if("map-layer"===(null==p?void 0:p.type))return`${da.path}/${p.mapLayerId}`;p={layer:JSON.stringify({source:this.source})};return`${da.path}/dynamicLayer?${ia.objectToQuery(p)}`},
set:function(p){p?this._override("url",p):this._clearOverride("url")}},{key:"visible",set:function(p){this._setAndNotifyLayer("visible",p)}}]);return E}(G.HandleOwnerMixin(X.MultiOriginJSONMixin(H.IdentifiableMixin(M))));u.test={isMapImageLayerOverridePolicy:P=>P===ea||P===Z,isTileImageLayerOverridePolicy:P=>P===ha};a.__decorate([L.property({readOnly:!0})],u.prototype,"capabilities",void 0);a.__decorate([d.reader("service","capabilities",["layerDefinition.canModifyLayer","layerDefinition.capabilities"])],
u.prototype,"readCapabilities",null);a.__decorate([L.property({type:String,value:null,json:{name:"layerDefinition.definitionExpression",write:{allowNull:!0,overridePolicy:Z}}})],u.prototype,"definitionExpression",null);a.__decorate([L.property({type:[pa],json:{origins:{service:{read:{source:"layerDefinition.fields"}}}}})],u.prototype,"fields",void 0);a.__decorate([L.property({readOnly:!0})],u.prototype,"fieldsIndex",null);a.__decorate([L.property({type:ra,value:null,json:{name:"layerDefinition.floorInfo",
read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo",overridePolicy:Z},origins:{"web-scene":{read:!1,write:!1}}}})],u.prototype,"floorInfo",null);a.__decorate([L.property({type:Ea,json:{read:{source:"layerDefinition.extent"}}})],u.prototype,"fullExtent",void 0);a.__decorate([L.property({type:String})],u.prototype,"globalIdField",void 0);a.__decorate([d.reader("service","globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],u.prototype,"readGlobalIdFieldFromService",
null);a.__decorate([L.property({type:K.Integer,json:{write:{ignoreOrigin:!0}}})],u.prototype,"id",null);a.__decorate([L.property({value:null,type:[ka],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo"},write:{target:"layerDefinition.drawingInfo.labelingInfo",overridePolicy:ea}}})],u.prototype,"labelingInfo",null);a.__decorate([r.writer("labelingInfo")],u.prototype,"writeLabelingInfo",null);a.__decorate([L.property({type:Boolean,value:!0,json:{read:{source:"layerDefinition.drawingInfo.showLabels"},
write:{target:"layerDefinition.drawingInfo.showLabels",overridePolicy:ea}}})],u.prototype,"labelsVisible",null);a.__decorate([L.property({value:null})],u.prototype,"layer",null);a.__decorate([L.property({type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend",overridePolicy:va}}})],u.prototype,"legendEnabled",void 0);a.__decorate([L.property({type:["show","hide","hide-children"],value:"show",json:{read:!1,write:!1,origins:{"web-scene":{read:!0,
write:!0}}}})],u.prototype,"listMode",null);a.__decorate([L.property({type:Number,value:0,json:{write:{overridePolicy:ea}}})],u.prototype,"minScale",null);a.__decorate([d.reader("minScale",["minScale","layerDefinition.minScale"])],u.prototype,"readMinScale",null);a.__decorate([L.property({type:Number,value:0,json:{write:{overridePolicy:ea}}})],u.prototype,"maxScale",null);a.__decorate([d.reader("maxScale",["maxScale","layerDefinition.maxScale"])],u.prototype,"readMaxScale",null);a.__decorate([L.property({readOnly:!0})],
u.prototype,"effectiveScaleRange",null);a.__decorate([L.property({type:String})],u.prototype,"objectIdField",void 0);a.__decorate([d.reader("service","objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],u.prototype,"readObjectIdFieldFromService",null);a.__decorate([L.property({type:Number,value:1,json:{write:{target:"layerDefinition.drawingInfo.transparency",overridePolicy:ea}}})],u.prototype,"opacity",null);a.__decorate([d.reader("opacity",["layerDefinition.drawingInfo.transparency",
"layerDefinition.transparency"])],u.prototype,"readOpacity",null);a.__decorate([r.writer("opacity")],u.prototype,"writeOpacity",null);a.__decorate([L.property({json:{type:K.Integer,write:{target:"parentLayerId",writerEnsuresNonNull:!0,overridePolicy:ea}}})],u.prototype,"parent",void 0);a.__decorate([r.writer("parent")],u.prototype,"writeParent",null);a.__decorate([L.property({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader(P,E){return!E.disablePopup}},write:{target:"disablePopup",overridePolicy:va,
writer(P,E,U){E[U]=!P}}}})],u.prototype,"popupEnabled",void 0);a.__decorate([L.property({type:q,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:va}}})],u.prototype,"popupTemplate",void 0);a.__decorate([L.property({readOnly:!0})],u.prototype,"defaultPopupTemplate",null);a.__decorate([L.property({types:F.rendererTypes,value:null,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:ea},origins:{"web-scene":{types:F.webSceneRendererTypes,name:"layerDefinition.drawingInfo.renderer",
write:{overridePolicy:ea}}}}})],u.prototype,"renderer",null);a.__decorate([L.property({types:{key:"type",base:null,typeMap:{"data-layer":za.DataLayerSource,"map-layer":ua.MapLayerSource}},cast(P){if(P){if("mapLayerId"in P)return K.ensureClass(ua.MapLayerSource,P);if("dataSource"in P)return K.ensureClass(za.DataLayerSource,P)}return P},json:{name:"layerDefinition.source",write:{overridePolicy:ea}}})],u.prototype,"source",null);a.__decorate([L.property()],u.prototype,"sourceJSON",void 0);a.__decorate([L.property({value:null,
json:{type:[K.Integer],write:{target:"subLayerIds",allowNull:!0,overridePolicy:ea}}})],u.prototype,"sublayers",null);a.__decorate([c.cast("sublayers")],u.prototype,"castSublayers",null);a.__decorate([r.writer("sublayers")],u.prototype,"writeSublayers",null);a.__decorate([L.property({type:String,json:{name:"name",write:{overridePolicy:va}}})],u.prototype,"title",void 0);a.__decorate([L.property({type:String})],u.prototype,"typeIdField",void 0);a.__decorate([d.reader("typeIdField",["layerDefinition.typeIdField"])],
u.prototype,"readTypeIdField",null);a.__decorate([L.property({type:[ja],json:{origins:{service:{read:{source:"layerDefinition.types"}}}}})],u.prototype,"types",void 0);a.__decorate([L.property({type:String,json:{read:{source:"layerUrl"},write:{target:"layerUrl",overridePolicy:ha}}})],u.prototype,"url",null);a.__decorate([L.property({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"},write:{target:"defaultVisibility",overridePolicy:ea}}})],u.prototype,"visible",null);a.__decorate([r.writer("visible")],
u.prototype,"writeVisible",null);return u=Ba=a.__decorate([g.subclass("esri.layers.support.Sublayer")],u)})},"esri/layers/support/sublayerUtils":function(){define(["exports","../../core/maybe","../../core/accessorSupport/PropertyOrigin"],function(T,e,a){function u(q,y){if(!q||!q.length||e.isNone(y))return!0;y=y.slice().reverse().flatten(({sublayers:v})=>v&&v.toArray().reverse()).map(v=>v.id).toArray();if(q.length>y.length)return!1;let t=0;const k=y.length;for(const {id:v}of q){for(;t<k&&y[t]!==v;)t++;
if(t>=k)return!1}return!0}T.isExportDynamic=function(q,y,t){return q.some(k=>{const v=k.source;return!(!v||"map-layer"===v.type&&v.mapLayerId===k.id&&(e.isNone(v.gdbVersion)||v.gdbVersion===t))||k.originIdOf("renderer")>a.OriginId.SERVICE||k.originIdOf("labelingInfo")>a.OriginId.SERVICE||k.originIdOf("opacity")>a.OriginId.SERVICE||k.originIdOf("labelsVisible")>a.OriginId.SERVICE})?!0:!u(q,y)};T.isSublayerOverhaul=function(q){return!!q&&q.some(y=>null!=y.minScale||y.layerDefinition&&null!=y.layerDefinition.minScale)};
T.shouldWriteSublayerStructure=function(q,y,t){return y.flatten(({sublayers:k})=>k).length!==q.length||q.some(k=>k.originIdOf("minScale")>t||k.originIdOf("maxScale")>t||k.originIdOf("renderer")>t||k.originIdOf("labelingInfo")>t||k.originIdOf("opacity")>t||k.originIdOf("labelsVisible")>t||k.originIdOf("source")>t)?!0:!u(q,y)};Object.defineProperties(T,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/sql ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./commonProperties ./floorFilterUtils ./sublayerUtils".split(" "),
function(T,e,a,u,q,y,t,k,v,x,f,h,l,w,F){const Q={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};T.ExportImageParameters=function(N){function W(G){G=N.call(this,G)||this;G.floors=null;G.scale=0;return G}e._inheritsLoose(W,N);var A=W.prototype;A.destroy=function(){this.layer=null};A.toJSON=
function(){var G=this.layer;G={dpi:G.dpi,format:G.imageFormat,transparent:G.imageTransparency,gdbVersion:G.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?G.dynamicLayers=this.dynamicLayers:G={...G,layers:this.layers,layerDefs:this.layerDefs};return G};e._createClass(W,[{key:"dynamicLayers",get:function(){if(!this.hasDynamicLayers)return null;const G=this.visibleSublayers.map(H=>{const Y=w.getLayerFloorFilterClause(this.floors,H);return H.toExportImageJSON(Y)});return G.length?JSON.stringify(G):
null}},{key:"hasDynamicLayers",get:function(){return this.layer&&F.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}},{key:"layer",set:function(G){this._get("layer")!==G&&(this._set("layer",G),this.handles.remove("layer"),G&&this.handles.add([G.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),G.on("sublayer-update",H=>this.notifyChange(Q[H.propertyName]))],"layer"))}},{key:"layers",get:function(){const G=this.visibleSublayers;return G?G.length?
"show:"+G.map(H=>H.id).join(","):"show:-1":null}},{key:"layerDefs",get:function(){var G;const H=!(null==(G=this.floors)||!G.length);G=this.visibleSublayers.filter(Y=>null!=Y.definitionExpression||H&&null!=Y.floorInfo);return G.length?JSON.stringify(G.reduce((Y,M)=>{var C=w.getLayerFloorFilterClause(this.floors,M);C=t.sqlAnd(C,M.definitionExpression);y.isSome(C)&&(Y[M.id]=C);return Y},{})):null}},{key:"version",get:function(){this.commitProperty("layers");this.commitProperty("layerDefs");this.commitProperty("dynamicLayers");
this.commitProperty("timeExtent");const G=this.layer;G&&(G.commitProperty("dpi"),G.commitProperty("imageFormat"),G.commitProperty("imageTransparency"),G.commitProperty("gdbVersion"));return(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){const G=[];if(!this.layer)return G;var H=this.layer.sublayers;const Y=M=>{const C=this.scale,D=0===M.minScale||C<=M.minScale,X=0===M.maxScale||C>=M.maxScale;M.visible&&(0===C||D&&X)&&(M.sublayers?M.sublayers.forEach(Y):G.unshift(M))};H&&H.forEach(Y);
H=this._get("visibleSublayers");return!H||H.length!==G.length||H.some((M,C)=>G[C]!==M)?G:H}}]);return W}(q.HandleOwnerMixin(u));a.__decorate([k.property({readOnly:!0})],T.ExportImageParameters.prototype,"dynamicLayers",null);a.__decorate([k.property()],T.ExportImageParameters.prototype,"floors",void 0);a.__decorate([k.property({readOnly:!0})],T.ExportImageParameters.prototype,"hasDynamicLayers",null);a.__decorate([k.property()],T.ExportImageParameters.prototype,"layer",null);a.__decorate([k.property({readOnly:!0})],
T.ExportImageParameters.prototype,"layers",null);a.__decorate([k.property({readOnly:!0})],T.ExportImageParameters.prototype,"layerDefs",null);a.__decorate([k.property({type:Number})],T.ExportImageParameters.prototype,"scale",void 0);a.__decorate([k.property(l.combinedViewLayerTimeExtentProperty)],T.ExportImageParameters.prototype,"timeExtent",void 0);a.__decorate([k.property({readOnly:!0})],T.ExportImageParameters.prototype,"version",null);a.__decorate([k.property({readOnly:!0})],T.ExportImageParameters.prototype,
"visibleSublayers",null);T.ExportImageParameters=a.__decorate([h.subclass("esri.layers.mixins.ExportImageParameters")],T.ExportImageParameters);Object.defineProperties(T,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(T){function e(a,u){if(null==a||!a.length)return null;a=a.filter(q=>""!==q).map(q=>`'${q}'`);a.push("''");return`${u} IN (${a.join(",")}) OR ${u} IS NULL`}T.getFloorFilterClause=function(a){var u;
const q=a.layer;return"floorInfo"in q&&null!=(u=q.floorInfo)&&u.floorField&&"floors"in a.view?e(a.view.floors,q.floorInfo.floorField):null};T.getLayerFloorFilterClause=function(a,u){var q;return"floorInfo"in u&&null!=(q=u.floorInfo)&&q.floorField?e(a,u.floorInfo.floorField):null};Object.defineProperties(T,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"app/utils/LayerUtil":function(){define("require exports tslib esri/layers/Layer esri/request esri/layers/support/arcgisLayerUrl".split(" "),
function(T,e,a,u,q,y){function t(M){return a.__awaiter(this,void 0,void 0,function(){var C;return a.__generator(this,function(D){switch(D.label){case 0:return D.trys.push([0,2,,4]),[4,u.default.fromArcGISServerUrl(M)];case 1:return C=D.sent(),[3,4];case 2:return D.sent(),[4,v(null===M||void 0===M?void 0:M.url)];case 3:return C=D.sent(),[3,4];case 4:return[2,C]}})})}function k(M,C,D){return a.__awaiter(this,void 0,void 0,function(){var X;return a.__generator(this,function(ba){try{return X=x(M,C).then(f).then(function(ia){var L=
a.__assign(a.__assign(a.__assign({},ia.properties),{url:ia.url||C}),D);return Promise.resolve(new ia.constructor(L))}),[2,X]}catch(ia){return[2,Promise.reject(ia)]}})})}function v(M,C,D){return a.__awaiter(this,void 0,void 0,function(){var X,ba,ia;return a.__generator(this,function(L){switch(L.label){case 0:return(ba="csv"===C)?[3,2]:[4,W(M)];case 1:ba=L.sent(),L.label=2;case 2:if(!ba)return[3,3];X="csv";return[3,10];case 3:(L="wfs"===C)||(L=M.toLowerCase().endsWith("/wfsserver")||-1<M.toLowerCase().lastIndexOf("/wfs"));
if(!L)return[3,4];X="wfs";return[3,10];case 4:(L="wms"===C)||(L=M.toLowerCase().endsWith("/wmsserver")||-1<M.toLowerCase().lastIndexOf("/wms")||M.toLowerCase().endsWith("/ows"));if(!L)return[3,5];X="wms";return[3,10];case 5:if(!("wmts"===C||-1<M.toLowerCase().lastIndexOf("/wmts")))return[3,6];X="wmts";return[3,10];case 6:(L="geojson"===C)||(L=A(M,"geojson")||A(M,"json"));if(!L)return[3,7];X="geojson";return[3,10];case 7:return(ia="kml"===C)?[3,9]:[4,N(M)];case 8:ia=L.sent(),L.label=9;case 9:if(ia)X=
"kml";else{var J;(J="georss"===C)||(J=A(M,"rss")||A(M,"xml")||-1<M.toLowerCase().lastIndexOf("/rss"));J&&(X="georss")}L.label=10;case 10:return[2,k(X,M,D)]}})})}function x(M,C){switch(M){case "csv":return Promise.resolve({className:"CSVLayer"});case "wms":return h(C);case "wfs":return w(C);case "wmts":return l(C);case "geojson":return Promise.resolve({className:"GeoJSONLayer"});case "kml":return Promise.resolve({className:"KMLLayer"});case "georss":return Promise.resolve({className:"GeoRSSLayer"});
default:return Promise.reject({error:{name:"url:unknown-item-type"}})}}function f(M){return Promise.all([(new Promise(function(C,D){T(["esri/layers/"+M.className],C,D)})).then(a.__importStar)]).then(function(C){var D;return{constructor:null===(D=C[0])||void 0===D?void 0:D.default,properties:M.properties||{},url:M.url}})}function h(M){return a.__awaiter(this,void 0,void 0,function(){var C;return a.__generator(this,function(D){C={className:"WMSLayer"};return[2,C]})})}function l(M){return a.__awaiter(this,
void 0,void 0,function(){var C;return a.__generator(this,function(D){C={className:"WMTSLayer"};return[2,C]})})}function w(M){return a.__awaiter(this,void 0,void 0,function(){var C,D;return a.__generator(this,function(X){switch(X.label){case 0:return C={className:"WFSLayer"},[4,F(M)];case 1:return(D=X.sent())?[2,D]:[2,C]}})})}function F(M){return a.__awaiter(this,void 0,void 0,function(){var C,D,X,ba,ia,L;return a.__generator(this,function(J){switch(J.label){case 0:C=/\/arcgis\/services\//gi;D=M.replace(C,
"/arcgis/rest/services/");X=y.isArcGISUrl(D);if(!X)return[3,5];ba=y.parse(D);ia=ba.serverType;L=ba.url;J.label=1;case 1:return J.trys.push([1,3,,4]),[4,Y(L.path)];case 2:return J.sent(),[2,Promise.resolve({className:Q(ia.toLowerCase()),url:L.path})];case 3:return J.sent(),[2,Promise.resolve(null)];case 4:return[3,6];case 5:return[2,Promise.resolve(null)];case 6:return[2]}})})}function Q(M){switch(M){case "imageserver":return"ImageryLayer";case "mapserver":return"MapImageLayer"}}function N(M){return a.__awaiter(this,
void 0,void 0,function(){var C;return a.__generator(this,function(D){switch(D.label){case 0:return A(M,"kml")||A(M,"kmz")?[2,!0]:[3,1];case 1:if(!M.endsWith("/data")||!G(M))return[3,6];D.label=2;case 2:return D.trys.push([2,4,,5]),[4,H(M)];case 3:return C=D.sent(),[2,"KML"===C.type];case 4:return D.sent(),[2,!1];case 5:return[3,7];case 6:return[2,!1];case 7:return[2]}})})}function W(M){return a.__awaiter(this,void 0,void 0,function(){var C;return a.__generator(this,function(D){switch(D.label){case 0:return-1<
(null===M||void 0===M?void 0:M.indexOf("?format\x3dcsv"))?[2,!0]:[3,1];case 1:return A(M,"csv")?[2,!0]:[3,2];case 2:if(!M.endsWith("/data")||!G(M))return[3,7];D.label=3;case 3:return D.trys.push([3,5,,6]),[4,H(M)];case 4:return C=D.sent(),[2,"CSV"===(null===C||void 0===C?void 0:C.type)];case 5:return D.sent(),[2,!1];case 6:return[3,8];case 7:return[2,!1];case 8:return[2]}})})}function A(M,C){return M.split(".").pop().split(/#|\?/)[0].toLowerCase()===C}function G(M){return/^(.*?)\b\/sharing\/rest\/content\/items\/[a-f\d]{32}\b/gi.test(M)}
function H(M){return a.__awaiter(this,void 0,void 0,function(){var C,D,X,ba;return a.__generator(this,function(ia){switch(ia.label){case 0:return ia.trys.push([0,2,,3]),C=/^(.*?)\b\/sharing\/rest\/content\/items\/[a-f\d]{32}\b/gi,D=M.match(C)[0],[4,Y(D)];case 1:return X=ia.sent(),[2,X];case 2:return ba=ia.sent(),[2,Promise.reject(ba)];case 3:return[2]}})})}function Y(M){return a.__awaiter(this,void 0,void 0,function(){var C;return a.__generator(this,function(D){switch(D.label){case 0:return[4,q.default(M,
{responseType:"json",query:{f:"json"}})];case 1:return C=D.sent(),[2,C.data]}})})}Object.defineProperty(e,"__esModule",{value:!0});e.isSupported=e.parseServiceUrl=e.fromType=e.fromUrl=void 0;u=a.__importDefault(u);q=a.__importDefault(q);y=a.__importStar(y);e.fromUrl=function(M,C,D){return a.__awaiter(this,void 0,void 0,function(){var X,ba,ia,L,J,c,d,g;return a.__generator(this,function(r){switch(r.label){case 0:ba=y.isArcGISUrl(M),r.label=1;case 1:return r.trys.push([1,7,,8]),!C||ba&&"wmts"!==C&&
"wms"!==C?[4,t({url:M,properties:a.__assign({},D)})]:[3,3];case 2:return ia=r.sent(),[3,5];case 3:return[4,v(M,C,D)];case 4:ia=r.sent(),r.label=5;case 5:return X=ia,[4,X.load()];case 6:return r.sent(),L=this.isSupported(X),L.isSupported?[2,X]:[2,Promise.reject(L.error)];case 7:return J=r.sent(),c=M,d=ba?y.parse(c):{},d.type=(null===X||void 0===X?void 0:X.title)||C||"",d.url=c,g=a.__assign(a.__assign({},J.details||{}),d),[2,Promise.reject(a.__assign(a.__assign({},J),{details:g}))];case 8:return[2]}})})};
e.fromType=k;e.parseServiceUrl=function(M){var C=M.match(/^(.*?)\b\/arcgis\/rest\/services\//gi);return C&&C.length?C[0]:M};e.isSupported=function(M){var C=M.url,D=M.type,X=C&&y.isArcGISUrl(C)?y.parse(C):{};X.type=M.title;X.url=C;return{isSupported:D in{"imagery-tile":1,imagery:1,tile:1,feature:1,"vector-tile":1,group:1,csv:1,kml:1,"geo-rss":1,geojson:1,"map-image":1,wms:1,wmts:1}?!0:!1,error:{name:"feature-layer-source:unsupported-type",details:a.__assign({},X)}}}})},"app/utils/project":function(){define("require exports tslib esri/config esri/geometry/Extent esri/geometry/support/webMercatorUtils esri/rest/geometryService esri/rest/support/ProjectParameters".split(" "),
function(T,e,a,u,q,y,t,k){var v=this;Object.defineProperty(e,"__esModule",{value:!0});e.getExtent=e.project=void 0;u=a.__importDefault(u);q=a.__importDefault(q);y=a.__importStar(y);t=a.__importStar(t);k=a.__importDefault(k);e.project=function(h,l){l=l.spatialReference;var w=u.default.geometryServiceUrl;if(y.canProject(h,l))return h=y.project(h,l),Promise.resolve(h);var F=new k.default;F.geometries=[h];F.outSpatialReference=l;return t.project(w,F).then(function(Q){return Q[0]})};e.getExtent=function(h,
l,w){return a.__awaiter(v,void 0,void 0,function(){var F,Q,N,W,A,G,H,Y,M,C;return a.__generator(this,function(D){switch(D.label){case 0:return"route"!==(null===h||void 0===h?void 0:h.type)?[3,1]:[2,null===(M=h.routeInfo.geometry)||void 0===M?void 0:M.extent];case 1:return F=h.portalItem,Q=!F||!(null===F||void 0===F?0:F.extent)||x(F),[4,e.project(new q.default({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:{wkid:4326}}),l)];case 2:return N=D.sent(),Q&&F&&F.extent?[4,e.project(F.extent,l)]:[3,
4];case 3:return A=D.sent(),[3,5];case 4:A=null,D.label=5;case 5:return W=A,(G=(null===h||void 0===h?void 0:h.layers)&&((null===F||void 0===F?void 0:F.typeKeywords)||[]).find(function(X){return"Location Tracking Service"===X})||!1)&&(h=(null===(C=null===h||void 0===h?void 0:h.layers)||void 0===C?void 0:C.getItemAt(0))||h),Q?[3,6]:[2,Promise.resolve(N)];case 6:return w||!W?[3,7]:[2,Promise.resolve(W)];case 7:if(!h.createQuery||!h.queryExtent)return[3,8];H=h.createQuery();H.outSpatialReference=l.spatialReference;
return[2,h.queryExtent(H).then(function(X){return X&&X.extent||h.fullExtent||N},function(){return h.fullExtent||N})];case 8:return h.fullExtent?[4,e.project(h.fullExtent,l)]:[3,10];case 9:return Y=D.sent(),[3,11];case 10:Y=N,D.label=11;case 11:return[2,Y]}})})};var x=function(h){if(h&&h.extent){var l=y.geographicToWebMercator(h.extent).extent;h=l.xmax;var w=l.ymax;l=y.xyToLngLat(l.xmin,l.ymin);h=y.xyToLngLat(h,w);return f(l[0],-180,180)||f(h[0],-180,180)||f(l[1],-90,90)||f(h[1],-90,90)?!0:!1}return!1},
f=function(h,l,w){return h>=l&&h<=w}})},"app/utils/layerUtils":function(){define(["require","exports","tslib","esri/request","esri/layers/support/arcgisLayerUrl"],function(T,e,a,u,q){function y(f,h){return(f.supportedSpatialReferences||[]).find(function(l){return l.equals(h)})?!0:!1}function t(f){var h=f.layers,l=f.popupTemplate;f.popupEnabled&&!l&&f.createPopupTemplate&&(f.popupTemplate=f.createPopupTemplate());(null===h||void 0===h?0:h.length)&&h.forEach(function(w){return t(w)})}function k(f){var h,
l,w={geojson:1,csv:1},F=(null===f||void 0===f?void 0:f.layer)||f;F=F&&F.url&&"Feature Layer"===(null===(h=null===F||void 0===F?void 0:F.sourceJSON)||void 0===h?void 0:h.type);h=null===f||void 0===f?void 0:f.isTable;var Q=(null===(l=null===f||void 0===f?void 0:f.layer)||void 0===l?void 0:l.type)||(null===f||void 0===f?void 0:f.type);return f.url&&Q in w||F||h}function v(f){return(f=(f&&f.layer||f).type)&&("map-layer"===f||"map-image"===f||"tile"===f)}function x(f){return f&&f.get&&f.get("capabilities.exportMap.supportsDynamicLayers")||
!1}Object.defineProperty(e,"__esModule",{value:!0});e.isSupportedChartsLayer=e.fetchUpdates=e.isImageryLayerRF=e.isImageryLayer=e.isMapImageLayer=e.supportsData=e.supportsExportTiles=e.supportsEditing=e.supportsModification=e.supportsExportMap=e.supportsQuery=e.isTilesOnly=e.hasLiveData=e.canCluster=e.isTrackViewLayer=e.isBasemapLayer=e.isLikeFeatureLayer=e.isDynamicLayer=e.getCacheMaxAge=e.checkPopup=e.checkWMTSSpatialReferences=e.isSameSpatialReference=void 0;u=a.__importDefault(u);q=a.__importStar(q);
e.isSameSpatialReference=function(f,h){var l=(f||{}).tileInfo,w={};return"wmts"===f.type&&y(f,h)?!0:!(f.type in w)&&h&&(null===l||void 0===l?0:l.spatialReference)?h.equals(l.spatialReference):"map-image"!==f.type&&"imagery"!==f.type&&"wmts"!==f.type||!f.spatialReference?!0:h.equals(f.spatialReference)};e.checkWMTSSpatialReferences=y;e.checkPopup=t;e.getCacheMaxAge=function(f){var h=f.sourceJSON,l=f.portalItem;f=null===l||void 0===l?void 0:l.isHostedService;l=(null===l||void 0===l?void 0:l.advancedSettings)||
{};h=(h=(null===h||void 0===h?void 0:h.cacheMaxAge)||(null===l||void 0===l?void 0:l.cacheMaxAge))?parseInt(h):f?30:6;return Math.ceil(h/60*100)/100};e.isDynamicLayer=function(f){var h=f&&f.layer;return v(f)?h?x(h):x(f):!1};e.isLikeFeatureLayer=k;e.isBasemapLayer=function(f,h){h=h.basemap;return h.baseLayers.concat(h.referenceLayers).flatten(function(l){return(null===l||void 0===l?void 0:l.allSublayers)||(null===l||void 0===l?void 0:l.sublayers)||(null===l||void 0===l?void 0:l.layers)}).includes(f)};
e.isTrackViewLayer=function(f){return(f=f.portalItem)&&((null===f||void 0===f?void 0:f.typeKeywords)||[]).find(function(h){return"Location Tracking Service"===h})||!1};e.canCluster=function(f){var h=f.geometryType,l=f.type,w=f.renderer;w=w&&w.type;return!("feature"===l&&!f.url)&&"point"===h&&"stream"!==l&&"heatmap"!==w&&"pie-chart"!==w};e.hasLiveData=function(f){var h;return(null===(h=null===f||void 0===f?void 0:f.timeInfo)||void 0===h?0:h.hasLiveData)?!0:!1};e.isTilesOnly=function(f){var h;f=f.sourceJSON;
return-1<(null===(h=null===f||void 0===f?void 0:f.capabilities)||void 0===h?void 0:h.toLowerCase().split(",").map(function(l){return l.trim()}).indexOf("tilesonly"))||!1};e.supportsQuery=function(f){return(f=f&&f.layer||f)&&(f&&f.get&&f.get("capabilities.operations.supportsQuery")||!1)};e.supportsExportMap=function(f){return f&&(f&&f.get&&f.get("capabilities.operations.supportsExportMap")||!1)};e.supportsModification=function(f){return f&&(f&&f.get?f.get("capabilities.exportMap.supportsModification"):
!0)};e.supportsEditing=function(f){return f&&(f&&f.get&&f.get("capabilities.operations.supportsEditing")||!1)};e.supportsExportTiles=function(f){return f&&f.get&&f.get("capabilities.exportTiles")||!1};e.supportsData=function(f){return f&&f.get&&f.get("capabilities.operations.supportsIdentify")||!1};e.isMapImageLayer=v;e.isImageryLayer=function(f){var h={imagery:1,"imagery-tile":1};return(f=(f&&f.layer||f).type)&&f in h};e.isImageryLayerRF=function(f){var h={imagery:1};return(f=(f&&f.layer||f).type)&&
f in h};e.fetchUpdates=function(f){return u.default(f.url,{responseType:"json",query:{returnUpdates:!0,f:"json"}}).then(function(h){return h.data})};e.isSupportedChartsLayer=function(f){var h,l,w,F,Q,N,W,A=(null===(h=null===f||void 0===f?void 0:f.layer)||void 0===h?void 0:h.type)||(null===f||void 0===f?void 0:f.type);A=f.url&&"csv"===A;h=!0===(null===(w=null===(l=f.portalItem)||void 0===l?void 0:l.typeKeywords)||void 0===w?void 0:w.includes("Location Tracking Service"));w=void 0!==f.url&&!0===q.isHostedAgolService(f.url);
l=!!w&&void 0===(null===(F=null===f||void 0===f?void 0:f.sourceJSON)||void 0===F?void 0:F.sqlParserVersion)&&10.91<=f.version;F=w&&void 0===(null===(Q=null===f||void 0===f?void 0:f.sourceJSON)||void 0===Q?void 0:Q.sqlParserVersion)||10.91<=f.version&&!0===(null===(W=null===(N=null===f||void 0===f?void 0:f.sourceJSON)||void 0===N?void 0:N.sqlParserVersion)||void 0===W?void 0:W.includes("PG_"));Q=k(f)&&!A&&(F||l);return void 0!==f&&Q&&!h}})},"app/utils/appUtils":function(){define(["require","exports"],
function(T,e){Object.defineProperty(e,"__esModule",{value:!0});e.clamp=e.isRTL=e.find=e.isNodeVisible=e.toggleNode=e.hideNode=e.showNode=e.parseUrl=e.concatUnique=e.filterOut=e.includes=e.objectToArray=e.stripStringTags=e.urlToObject=void 0;e.urlToObject=function(){var a=this,u={};(window.location.search||"?").substr(1).replace(/([^&=]+)=?([^&]*)(?:&+|$)/g,function(q,y,t){u[y]=a.stripStringTags(decodeURIComponent(t));return""});return u};e.stripStringTags=function(a){return a.replace(/<\/?[^>]+>/g,
"")};e.objectToArray=function(a){return Object.keys(a).map(function(u){return a[u]})};e.includes=function(a,u){return-1<a.indexOf(u)};e.filterOut=function(a,u){return a.filter(function(q){return-1===u.indexOf(q)})};e.concatUnique=function(a,u){var q=[].concat(a||[]);u.forEach(function(y){y&&-1===q.indexOf(y)&&q.push(y)});return q};e.parseUrl=function(a){var u=document.createElement("a");u.href=a;for(var q=u.protocol.replace(":",""),y=u.hostname||window.location.host,t=u.port,k=u.search,v={},x=u.search.replace(/^\?/,
"").split("\x26"),f=x.length,h=0,l;h<f;h++)x[h]&&(l=x[h].split("\x3d"),v[l[0]]=l[1]);return{source:a,protocol:q,host:y,port:t,query:k,params:v,file:(u.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:u.hash.replace("#",""),path:u.pathname.replace(/^([^\/])/,"/$1"),relative:(u.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:u.pathname.replace(/^\//,"").split("/")}};e.showNode=function(a){(a="string"===typeof a?document.querySelector(a):a)&&a.classList.remove("hide")};e.hideNode=function(a){(a=
"string"===typeof a?document.querySelector(a):a)&&a.classList.add("hide")};e.toggleNode=function(a){this[a&&a.classList.contains("hide")?"showNode":"hideNode"](a)};e.isNodeVisible=function(a){return a&&a.classList.contains("hide")?!1:!0};e.find=function(a,u){for(var q,y=0;y<a.length;y++)if(q=a[y],u(q))return q;return null};e.isRTL=function(){return"rtl"===document.getElementsByTagName("html")[0].getAttribute("dir")};e.clamp=function(a,u,q){return Math.min(Math.max(a,u),q)}})},"app/widgets/panels/MapMaker/EditTitle":function(){define("require exports tslib esri/core/accessorSupport/decorators esri/widgets/support/widget esri/widgets/Widget ../../../utils/topic".split(" "),
function(T,e,a,u,q,y,t){Object.defineProperty(e,"__esModule",{value:!0});y=a.__importDefault(y);t=a.__importDefault(t);T=function(k){function v(x){x=k.call(this,x)||this;x.useTempTitle=!1;return x}a.__extends(v,k);v.prototype.postInitialize=function(){var x=this;this.onCancel=this.onCancel.bind(this);this.editTitleSubmit=this.editTitleSubmit.bind(this);this.storeEditInput=this.storeEditInput.bind(this);setTimeout(function(){return x.focusEditInput()},125)};v.prototype.onTitleChange=function(x){var f;
x.preventDefault();this.tempTitle=(x=this.editInputNode)&&(null===(f=x.value)||void 0===f?void 0:f.trim());this.isValid()&&(this.useTempTitle=!0)};v.prototype.editTitleSubmit=function(x){x.preventDefault();if(this.isValid()){var f=this.editInputNode;x=this.layerInfo.layer;if(f=f&&f.value.trim())x.set("title",f),this.emit("done",{title:f}),t.default.publish("layer-title-change")}};v.prototype.isValid=function(){var x,f=this.editInputNode,h=(null===(x=null===f||void 0===f?void 0:f.value)||void 0===
x?0:x.trim())?!0:!1;f.status=h?"valid":"invalid";x=f.closest("calcite-label");x.status=h?"valid":"invalid";x.querySelector("calcite-input-message").active=!h;h||this.focusEditInput();return h};v.prototype.onCancel=function(){this.emit("done",{})};v.prototype.storeEditInput=function(x){this.editInputNode=x;this.focusEditInput()};v.prototype.focusEditInput=function(){var x=this;this.editInputNode&&setTimeout(function(){return x.editInputNode.setFocus()},125)};v.prototype.render=function(){var x=this,
f=this.layerInfo.layer;return q.tsx("div",null,q.tsx("calcite-panel",{dismissible:!1,"height-scale":"m","width-scale":"m",class:"edit-title-panel"},q.tsx("form",{name:"edit-layer-title",class:"esri-title__authoring-form",onsubmit:this.editTitleSubmit},q.tsx("calcite-label",null,this.messages.title,q.tsx("calcite-input",{name:"title",value:this.useTempTitle?this.tempTitle:f.title,afterCreate:function(h){return x.storeEditInput(h)},onCalciteInputChange:function(h){return x.onTitleChange(h)}}),q.tsx("calcite-input-message",
{status:"invalid",icon:!0},this.messages.layerTitleEmpty)),q.tsx("calcite-button",{class:"js-cancel",slot:"footer-actions",width:"half",appearance:"outline",onclick:this.onCancel},this.messagesCommon.cancel),q.tsx("calcite-button",{class:"js-save",slot:"footer-actions",width:"half",disabled:!1,value:"ok",type:"submit"},this.messagesCommon.ok))))};a.__decorate([u.property(),q.messageBundle("mapviewer/common")],v.prototype,"messagesCommon",void 0);a.__decorate([u.property(),q.messageBundle("mapviewer/mapMaker")],
v.prototype,"messages",void 0);return v=a.__decorate([u.subclass("")],v)}(y.default);e.default=T})},"app/widgets/panels/MapMaker/MoveToGroup":function(){define("require exports tslib esri/core/accessorSupport/decorators esri/widgets/support/widget esri/widgets/Widget ../../../utils/topic".split(" "),function(T,e,a,u,q,y,t){Object.defineProperty(e,"__esModule",{value:!0});y=a.__importDefault(y);t=a.__importDefault(t);T=function(k){function v(x){return k.call(this,x)||this}a.__extends(v,k);v.prototype.postInitialize=
function(){this.onCancel=this.onCancel.bind(this);this.groupLayers=this.getGroupLayers(this.layerInfo)};v.prototype.moveToGroupSubmit=function(x){var f=this;x.preventDefault();var h=this.layerInfo;x=this.groupLayers;h=h.layer||h;"no-group"!==this.selectedGroupName?(x=x.find(function(l){return l.id===f.selectedGroupName}),null===x||void 0===x?void 0:x.add(h),null===x||void 0===x?void 0:x.loadAll(),this.emit("done",{layer:x})):(this.mapView.map.layers.add(h),this.emit("done",{layer:h}));t.default.publish("group-layer-move")};
v.prototype.onCancel=function(){this.emit("done",{})};v.prototype.getGroupLayers=function(x){var f=this.mapView.map.allLayers,h=this.getExcludedGroupLayers(x);return(f||[]).filter(function(l){return-1===h.indexOf(l.id)&&"group"===l.type})};v.prototype.getExcludedGroupLayers=function(x){var f,h=[];"group"===x.layer.type?h.push(x.layer.id):(null===(f=x.parent)||void 0===f?0:f.layer)&&h.push(x.parent.layer.id);this.getChildGroupLayers(x,h);return h};v.prototype.getChildGroupLayers=function(x,f){var h=
this;(x.children||[]).forEach(function(l){h.getChildGroupLayers(l,f);"group"===l.layer.type&&f.push(l.layer.id)})};v.prototype.addGroupLayers=function(x){var f=this,h=this.groupLayers,l=document.createElement("calcite-radio-button-group");l.layout="vertical";l.name="grouplayers";l.scale="s";if(this.layerInfo.parent){var w=this.getGroup({title:this.messages.noGroup,id:"no-group"},-1).label;this.selectedGroupName="no-group";l.appendChild(w)}h.forEach(function(F,Q){Q=f.getGroup(F,Q);var N=Q.label;f.selectedGroupName=
Q.element.checked?F.id:f.selectedGroupName;l.appendChild(N)});x.appendChild(l)};v.prototype.getGroup=function(x,f){var h=this,l=x.title;x=x.id;var w=document.createElement("calcite-label");w.alignment="start";w.layout="inline";l=document.createTextNode(l);var F=document.createElement("calcite-radio-button");F.value=x;F.name="groupLayers";F.checked=-1===f||0===f;F.addEventListener("calciteRadioButtonChange",function(Q){return h.onChangeGroup(Q)});w.appendChild(F);w.appendChild(l);return{label:w,element:F}};
v.prototype.onChangeGroup=function(x){x=x.currentTarget;this.selectedGroupName=null===x||void 0===x?void 0:x.value};v.prototype.render=function(){return q.tsx("div",null,q.tsx("calcite-panel",{dismissible:!1,"height-scale":"m","width-scale":"m"},q.tsx("form",{class:"esri-move-to-group__form",onsubmit:this.moveToGroupSubmit,bind:this},q.tsx("div",{class:"group-layer",bind:this,afterCreate:this.addGroupLayers}),q.tsx("calcite-button",{class:"js-cancel",slot:"footer-actions",width:"half",appearance:"outline",
onclick:this.onCancel},this.messagesCommon.cancel),q.tsx("calcite-button",{class:"js-save",slot:"footer-actions",width:"half",disabled:!1,value:"ok",type:"submit"},this.messagesCommon.ok))))};a.__decorate([u.property(),q.messageBundle("mapviewer/common")],v.prototype,"messagesCommon",void 0);a.__decorate([u.property(),q.messageBundle("mapviewer/mapMaker")],v.prototype,"messages",void 0);return v=a.__decorate([u.subclass("")],v)}(y.default);e.default=T})},"app/utils/mapUtils/canSaveMap":function(){define(["require",
"exports"],function(T,e){function a(q,y){q=q.map;var t=y.user;y=t&&t.isViewOnly||!1;q=null===q||void 0===q?void 0:q.portalItem;t=!y&&t&&t.canCreateItems;return(!y&&q&&(q.canSaveCopy||q.isAdmin)||!q)&&t}function u(q,y){q=q.map;return(q=null===q||void 0===q?void 0:q.portalItem)&&q.canUpdate}Object.defineProperty(e,"__esModule",{value:!0});e.canSave=e.canUpdate=e.canCopy=void 0;e.canCopy=a;e.canUpdate=u;e.canSave=function(q,y){return a(q,y)||u(q,y)}})},"app/utils/mapUtils/canSaveLayer":function(){define(["require",
"exports","tslib","../../portal/Role"],function(T,e,a,u){function q(t){var k=t.user,v=!1;k&&(t=t.urlKey&&t.customBaseUrl||t.isPortal?!0:!1,k=new u.default({portalUser:k}),v=!t||k.canCreateItem());return v}function y(t){var k=t.owner,v=t.itemControl,x=t.portal.user;k=x&&k===x.username;if(x){if(!(x=k)){x=!1;x=t.owner;var f=t.portal;t=(t=t.itemControl)&&-1<t.indexOf("admin");var h=["esri_livingatlas","esri_demographics","esri_boundaries"];x=f.isPortal&&k&&t&&-1<x.indexOf("esri_")&&!h.indexOf(x)?!1:!!t}k=
x}else k=!1;return k||v&&-1<v.indexOf("update")}Object.defineProperty(e,"__esModule",{value:!0});e.canSaveLayer=void 0;u=a.__importDefault(u);e.canSaveLayer=function(t,k){var v=t.portalItem,x=t.type,f={save:!1,saveas:!1},h="route"===x;"feature"===x&&!t.url||"feature"!==x?h&&(t=t.routeInfo,f.save=t&&v&&y(v),f.saveas=t&&q(k)):(f.save=v&&y(v),f.saveas=q(k));return f}})},"app/portal/Role":function(){define(["require","exports","tslib","esri/core/accessorSupport/decorators","./LevelAware"],function(T,
e,a,u,q){Object.defineProperty(e,"__esModule",{value:!0});q=a.__importDefault(q);T=function(y){function t(k){var v=y.call(this)||this;v.id=null;v.baseRole=null;v.name=null;v.description=null;v.privileges=[];v.privilegeObj={portal:{admin:{inviteUsers:!1,disableUsers:!1,viewUsers:!1,updateUsers:!1,deleteUsers:!1,changeUserRoles:!1,viewGroups:!1,updateGroups:!1,deleteGroups:!1,reassignGroups:!1,assignToGroups:!1,manageEnterpriseGroups:!1,viewItems:!1,updateItems:!1,deleteItems:!1,reassignItems:!1,manageLicenses:!1,
shareToGroup:!1,shareToOrg:!1,shareToPublic:!1,createUpdateCapableGroup:!1,updateItemCategorySchema:!1,manageCollaborations:!1,manageSecurity:!1,manageWebsite:!1,manageRoles:!1,manageServers:!1,manageUtilityServices:!1,manageCredits:!1},publisher:{publishFeatures:!1,publishTiles:!1,publishScenes:!1,publishServerServices:!1,publishServerGPServices:!1,registerDataStores:!1,bulkPublishFromDataStores:!1,enumerateDataStores:!1},user:{createGroup:!1,joinGroup:!1,joinNonOrgGroup:!1,createItem:!1,shareToGroup:!1,
shareToOrg:!1,shareToPublic:!1,shareGroupToOrg:!1,shareGroupToPublic:!1,viewOrgUsers:!1,viewOrgItems:!1,viewOrgGroups:!1,viewTracks:!1}},features:{user:{edit:!1,fullEdit:!1}},opendata:{user:{openDataAdmin:!1,designateGroup:!1}},premium:{user:{geocode:!1,networkanalysis:!1,spatialanalysis:!1,geoenrichment:!1,demographics:!1,featurereport:!1},publisher:{geoanalytics:!1,rasteranalysis:!1,createNotebooks:!1,scheduleNotebooks:!1,publishNotebooks:!1,createAdvancedNotebooks:!1}},marketplace:{admin:{manage:!1,
purchase:!1,startTrial:!1}}};k=k||{};var x=k.portalUser;x?(v.id=x.roleId?x.roleId:x.role,v.baseRole=x.role,v.setPrivileges(x.privileges)):(v.id=k.id,v.baseRole=k.role,v.name=k.name,v.description=k.description,k.privileges&&v.setPrivileges(k.privileges));return v}a.__extends(t,y);t.prototype.isViewer=function(){return this.id&&this.id===this.SYSTEM_ROLES.VIEWER};t.prototype.isUser=function(){return this.id&&("org_user"===this.id||"account_user"===this.id)};t.prototype.isPublisher=function(){return this.id&&
("org_publisher"===this.id||"account_publisher"===this.id)};t.prototype.isAdmin=function(){return this.id&&("org_admin"===this.id||"account_admin"===this.id)};t.prototype.isBasedOnUser=function(){return this.isUser()||this.baseRole&&("org_user"===this.baseRole||"account_user"===this.baseRole)};t.prototype.isBasedOnPublisher=function(){return this.isPublisher()||this.baseRole&&("org_publisher"===this.baseRole||"account_publisher"===this.baseRole)};t.prototype.isBasedOnAdmin=function(){return this.isAdmin()||
this.baseRole&&("org_admin"===this.baseRole||"account_admin"===this.baseRole)};t.prototype.isCustom=function(){return!this.isUser()&&!this.isPublisher()&&!this.isAdmin()&&this.id&&0<this.id.length};t.prototype.canInviteUsers=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.inviteUsers};t.prototype.canDisableUsers=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.disableUsers};t.prototype.canViewUsers=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewUsers};
t.prototype.canUpdateUsers=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateUsers};t.prototype.canDeleteUsers=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteUsers};t.prototype.canChangeUserRoles=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.changeUserRoles};t.prototype.canViewOrgGroups=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewGroups};t.prototype.canUpdateOrgGroups=function(){return this.privilegeObj&&
this.privilegeObj.portal.admin.updateGroups};t.prototype.canDeleteOrgGroups=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteGroups};t.prototype.canReassignOrgGroups=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignGroups};t.prototype.canAssignUsersToOrgGroups=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.assignToGroups};t.prototype.canManageEnterpriseGroups=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageEnterpriseGroups};
t.prototype.canViewOrgItems=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewItems};t.prototype.canUpdateOrgItems=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateItems};t.prototype.canDeleteOrgItems=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteItems};t.prototype.canReassignOrgItems=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignItems};t.prototype.canManageItems=function(){return this.isAdmin()||
this.canViewUsers()&&this.canViewOrgItems()&&(this.canUpdateOrgItems()||this.canDeleteOrgItems()||this.canReassignOrgItems())};t.prototype.canManageLicenses=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageLicenses};t.prototype.canShareOthersItemsToGroup=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.shareToGroup};t.prototype.canShareOthersItemsToOrg=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.shareToOrg};t.prototype.canShareOthersItemsToPublic=
function(){return this.privilegeObj&&this.privilegeObj.portal.admin.shareToPublic};t.prototype.canCreateUpdateCapableGroup=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.createUpdateCapableGroup};t.prototype.canUpdateItemCategories=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateItemCategorySchema};t.prototype.canManageCollaborations=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageCollaborations};t.prototype.canManageSecurity=
function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageSecurity};t.prototype.canManageWebsite=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageWebsite};t.prototype.canManageRoles=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageRoles};t.prototype.canManageServers=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageServers};t.prototype.canManageUtilityServices=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageUtilityServices};
t.prototype.canManageCredits=function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageCredits};t.prototype.canCreateGroup=function(){return this.privilegeObj&&this.privilegeObj.portal.user.createGroup};t.prototype.canJoinOrgGroup=function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinGroup};t.prototype.canJoinNonOrgGroup=function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinNonOrgGroup};t.prototype.canPublishFeatures=function(){return this.privilegeObj&&
this.privilegeObj.portal.publisher.publishFeatures};t.prototype.canPublishTiles=function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishTiles};t.prototype.canPublishScenes=function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishScenes};t.prototype.canPublishServerServices=function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishServerServices};t.prototype.canPublishServerGPServices=function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishServerGPServices};
t.prototype.canPublishVectorTiles=function(){return!0};t.prototype.canPublishImageCollection=function(){return this.canPublishServerServices()};t.prototype.canCreateItem=function(){return this.privilegeObj&&this.privilegeObj.portal.user.createItem};t.prototype.canShareItemToGroup=function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToGroup};t.prototype.canShareItemToOrg=function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToOrg};t.prototype.canShareItemToPublic=
function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToPublic};t.prototype.canShareGroupToOrg=function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToOrg};t.prototype.canShareGroupToPublic=function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToPublic};t.prototype.canViewOrgUsers=function(){return this.privilegeObj&&this.privilegeObj.portal.user.viewOrgUsers};t.prototype.canViewOrgUserContent=function(){return this.privilegeObj&&this.privilegeObj.portal.user.viewOrgItems};
t.prototype.canViewOrgUserGroups=function(){return this.privilegeObj&&this.privilegeObj.portal.user.viewOrgGroups};t.prototype.canViewTracks=function(){return this.privilegeObj&&this.privilegeObj.portal.user.viewTracks};t.prototype.canEditFeatures=function(){return this.privilegeObj&&this.privilegeObj.features.user.edit};t.prototype.canEditFeaturesFullControl=function(){return this.privilegeObj&&this.privilegeObj.features.user.fullEdit};t.prototype.canManageOpenData=function(){return this.privilegeObj&&
this.privilegeObj.opendata.user.openDataAdmin};t.prototype.canDesignateOpenDataGroups=function(){return this.privilegeObj&&this.privilegeObj.opendata.user.designateGroup};t.prototype.canUseGeocode=function(){return this.privilegeObj&&this.privilegeObj.premium.user.geocode};t.prototype.canUseNetworkAnalysis=function(){return this.privilegeObj&&this.privilegeObj.premium.user.networkanalysis};t.prototype.canUseSpatialAnalysis=function(){return this.privilegeObj&&this.privilegeObj.premium.user.spatialanalysis};
t.prototype.canUseGeoenrichment=function(){return this.privilegeObj&&this.privilegeObj.premium.user.geoenrichment};t.prototype.canUseDemographics=function(){return this.privilegeObj&&this.privilegeObj.premium.user.demographics};t.prototype.canUseFeatureReport=function(){return this.privilegeObj&&this.privilegeObj.premium.user.featurereport};t.prototype.canUseGeoanalytics=function(){return this.privilegeObj&&this.privilegeObj.premium.publisher.geoanalytics};t.prototype.canUseRasterAnalysis=function(){return this.privilegeObj&&
this.privilegeObj.premium.publisher.rasteranalysis};t.prototype.canPurchaseMarketplace=function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.purchase};t.prototype.canManageMarketplace=function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.manage};t.prototype.canTrialMarketplace=function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.startTrial};t.prototype.canCreateNotebooks=function(){return this.privilegeObj&&this.privilegeObj.premium.publisher.createNotebooks};
t.prototype.canScheduleNotebooks=function(){return this.privilegeObj&&this.privilegeObj.premium.publisher.scheduleNotebooks};t.prototype.canPublishNotebooks=function(){return this.privilegeObj&&this.privilegeObj.premium.publisher.publishNotebooks};t.prototype.canCreateAdvancedNotebooks=function(){return this.privilegeObj&&this.privilegeObj.premium.publisher.createAdvancedNotebooks};t.prototype.canBulkPublishFromDataStores=function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.bulkPublishFromDataStores};
t.prototype.canEnumerateDataStores=function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.enumerateDataStores};t.prototype.canRegisterDataStores=function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.registerDataStores};t.prototype.setPrivileges=function(k){this.privileges=k;this._initPrivilegesObject();k&&this._readPrivileges(k)};t.prototype._initPrivilegesObject=function(){this._applyToAll(!1)};t.prototype._readPrivileges=function(k){var v=this;k&&k instanceof Array&&
k.forEach(function(x){v._readPrivilege(x)})};t.prototype._readPrivilege=function(k){this._applyEffectToAction(!0,k)};t.prototype._applyEffectToAction=function(k,v){switch(v){case "portal:admin:inviteUsers":this.privilegeObj.portal.admin.inviteUsers=k;break;case "portal:admin:disableUsers":this.privilegeObj.portal.admin.disableUsers=k;break;case "portal:admin:viewUsers":this.privilegeObj.portal.admin.viewUsers=k;break;case "portal:admin:updateUsers":this.privilegeObj.portal.admin.updateUsers=k;break;
case "portal:admin:deleteUsers":this.privilegeObj.portal.admin.deleteUsers=k;break;case "portal:admin:changeUserRoles":this.privilegeObj.portal.admin.changeUserRoles=k;break;case "portal:admin:viewGroups":this.privilegeObj.portal.admin.viewGroups=k;break;case "portal:admin:updateGroups":this.privilegeObj.portal.admin.updateGroups=k;break;case "portal:admin:deleteGroups":this.privilegeObj.portal.admin.deleteGroups=k;break;case "portal:admin:reassignGroups":this.privilegeObj.portal.admin.reassignGroups=
k;break;case "portal:admin:assignToGroups":this.privilegeObj.portal.admin.assignToGroups=k;break;case "portal:admin:manageEnterpriseGroups":this.privilegeObj.portal.admin.manageEnterpriseGroups=k;break;case "portal:admin:viewItems":this.privilegeObj.portal.admin.viewItems=k;break;case "portal:admin:updateItems":this.privilegeObj.portal.admin.updateItems=k;break;case "portal:admin:deleteItems":this.privilegeObj.portal.admin.deleteItems=k;break;case "portal:admin:reassignItems":this.privilegeObj.portal.admin.reassignItems=
k;break;case "portal:admin:manageLicenses":this.privilegeObj.portal.admin.manageLicenses=k;break;case "portal:admin:shareToGroup":this.privilegeObj.portal.admin.shareToGroup=k;break;case "portal:admin:shareToOrg":this.privilegeObj.portal.admin.shareToOrg=k;break;case "portal:admin:shareToPublic":this.privilegeObj.portal.admin.shareToPublic=k;break;case "portal:admin:createUpdateCapableGroup":this.privilegeObj.portal.admin.createUpdateCapableGroup=k;break;case "portal:admin:updateItemCategorySchema":this.privilegeObj.portal.admin.updateItemCategorySchema=
k;break;case "portal:admin:manageCollaborations":this.privilegeObj.portal.admin.manageCollaborations=k;break;case "portal:admin:manageSecurity":this.privilegeObj.portal.admin.manageSecurity=k;break;case "portal:admin:manageWebsite":this.privilegeObj.portal.admin.manageWebsite=k;break;case "portal:admin:manageRoles":this.privilegeObj.portal.admin.manageRoles=k;break;case "portal:admin:manageServers":this.privilegeObj.portal.admin.manageServers=k;break;case "portal:admin:manageUtilityServices":this.privilegeObj.portal.admin.manageUtilityServices=
k;break;case "portal:admin:manageCredits":this.privilegeObj.portal.admin.manageCredits=k;break;case "portal:publisher:publishFeatures":this.privilegeObj.portal.publisher.publishFeatures=k;break;case "portal:publisher:publishTiles":this.privilegeObj.portal.publisher.publishTiles=k;break;case "portal:publisher:publishScenes":this.privilegeObj.portal.publisher.publishScenes=k;break;case "portal:publisher:publishServerServices":this.privilegeObj.portal.publisher.publishServerServices=k;break;case "portal:publisher:publishServerGPServices":this.privilegeObj.portal.publisher.publishServerGPServices=
k;break;case "portal:publisher:bulkPublishFromDataStores":this.privilegeObj.portal.publisher.bulkPublishFromDataStores=k;break;case "portal:publisher:enumerateDataStores":this.privilegeObj.portal.publisher.enumerateDataStores=k;break;case "portal:publisher:registerDataStores":this.privilegeObj.portal.publisher.registerDataStores=k;break;case "portal:user:createGroup":this.privilegeObj.portal.user.createGroup=k;break;case "portal:user:joinGroup":this.privilegeObj.portal.user.joinGroup=k;break;case "portal:user:joinNonOrgGroup":this.privilegeObj.portal.user.joinNonOrgGroup=
k;break;case "portal:user:createItem":this.privilegeObj.portal.user.createItem=k;break;case "portal:user:shareToGroup":this.privilegeObj.portal.user.shareToGroup=k;break;case "portal:user:shareToOrg":this.privilegeObj.portal.user.shareToOrg=k;break;case "portal:user:shareToPublic":this.privilegeObj.portal.user.shareToPublic=k;break;case "portal:user:shareGroupToOrg":this.privilegeObj.portal.user.shareGroupToOrg=k;break;case "portal:user:shareGroupToPublic":this.privilegeObj.portal.user.shareGroupToPublic=
k;break;case "portal:user:viewOrgUsers":this.privilegeObj.portal.user.viewOrgUsers=k;break;case "portal:user:viewOrgItems":this.privilegeObj.portal.user.viewOrgItems=k;break;case "portal:user:viewOrgGroups":this.privilegeObj.portal.user.viewOrgGroups=k;break;case "portal:user:viewTracks":this.privilegeObj.portal.user.viewTracks=k;break;case "features:user:edit":this.privilegeObj.features.user.edit=k;break;case "features:user:fullEdit":this.privilegeObj.features.user.fullEdit=k;break;case "opendata:user:openDataAdmin":this.privilegeObj.opendata.user.openDataAdmin=
k;break;case "opendata:user:designateGroup":this.privilegeObj.opendata.user.designateGroup=k;break;case "premium:user:geocode":this.privilegeObj.premium.user.geocode=k;break;case "premium:user:networkanalysis":this.privilegeObj.premium.user.networkanalysis=k;break;case "premium:user:spatialanalysis":this.privilegeObj.premium.user.spatialanalysis=k;break;case "premium:user:geoenrichment":this.privilegeObj.premium.user.geoenrichment=k;break;case "premium:user:demographics":this.privilegeObj.premium.user.demographics=
k;break;case "premium:user:featurereport":this.privilegeObj.premium.user.featurereport=k;break;case "premium:publisher:geoanalytics":this.privilegeObj.premium.publisher.geoanalytics=k;break;case "premium:publisher:rasteranalysis":this.privilegeObj.premium.publisher.rasteranalysis=k;break;case "marketplace:admin:purchase":this.privilegeObj.marketplace.admin.purchase=k;break;case "marketplace:admin:manage":this.privilegeObj.marketplace.admin.manage=k;break;case "marketplace:admin:startTrial":this.privilegeObj.marketplace.admin.startTrial=
k;break;case "premium:publisher:createNotebooks":this.privilegeObj.premium.publisher.createNotebooks=k;break;case "premium:publisher:scheduleNotebooks":this.privilegeObj.premium.publisher.scheduleNotebooks=k;break;case "premium:publisher:publishNotebooks":this.privilegeObj.premium.publisher.publishNotebooks=k;break;case "premium:publisher:createAdvancedNotebooks":this.privilegeObj.premium.publisher.createAdvancedNotebooks=k}};t.prototype._applyToAll=function(k){this.privilegeObj.portal.admin.inviteUsers=
k;this.privilegeObj.portal.admin.disableUsers=k;this.privilegeObj.portal.admin.viewUsers=k;this.privilegeObj.portal.admin.updateUsers=k;this.privilegeObj.portal.admin.deleteUsers=k;this.privilegeObj.portal.admin.changeUserRoles=k;this.privilegeObj.portal.admin.viewGroups=k;this.privilegeObj.portal.admin.updateGroups=k;this.privilegeObj.portal.admin.deleteGroups=k;this.privilegeObj.portal.admin.reassignGroups=k;this.privilegeObj.portal.admin.assignToGroups=k;this.privilegeObj.portal.admin.manageEnterpriseGroups=
k;this.privilegeObj.portal.admin.viewItems=k;this.privilegeObj.portal.admin.updateItems=k;this.privilegeObj.portal.admin.deleteItems=k;this.privilegeObj.portal.admin.reassignItems=k;this.privilegeObj.portal.admin.manageLicenses=k;this.privilegeObj.portal.admin.shareToGroup=k;this.privilegeObj.portal.admin.shareToOrg=k;this.privilegeObj.portal.admin.shareToPublic=k;this.privilegeObj.portal.admin.createUpdateCapableGroup=k;this.privilegeObj.portal.admin.updateItemCategorySchema=k;this.privilegeObj.portal.admin.manageCollaborations=
k;this.privilegeObj.portal.admin.manageSecurity=k;this.privilegeObj.portal.admin.manageWebsite=k;this.privilegeObj.portal.admin.manageRoles=k;this.privilegeObj.portal.admin.manageServers=k;this.privilegeObj.portal.admin.manageUtilityServices=k;this.privilegeObj.portal.admin.manageCredits=k;this.privilegeObj.portal.publisher.publishFeatures=k;this.privilegeObj.portal.publisher.publishTiles=k;this.privilegeObj.portal.publisher.publishScenes=k;this.privilegeObj.portal.publisher.publishServerServices=
k;this.privilegeObj.portal.publisher.publishServerGPServices=k;this.privilegeObj.portal.user.createGroup=k;this.privilegeObj.portal.user.joinGroup=k;this.privilegeObj.portal.user.joinNonOrgGroup=k;this.privilegeObj.portal.user.createItem=k;this.privilegeObj.portal.user.shareToGroup=k;this.privilegeObj.portal.user.shareToOrg=k;this.privilegeObj.portal.user.shareToPublic=k;this.privilegeObj.portal.user.shareGroupToOrg=k;this.privilegeObj.portal.user.shareGroupToPublic=k;this.privilegeObj.portal.user.viewOrgUsers=
k;this.privilegeObj.portal.user.viewOrgItems=k;this.privilegeObj.portal.user.viewOrgGroups=k;this.privilegeObj.portal.user.viewTracks=k;this.privilegeObj.features.user.edit=k;this.privilegeObj.opendata.user.openDataAdmin=k;this.privilegeObj.opendata.user.designateGroup=k;this.privilegeObj.premium.user.geocode=k;this.privilegeObj.premium.user.networkanalysis=k;this.privilegeObj.premium.user.spatialanalysis=k;this.privilegeObj.premium.user.geoenrichment=k;this.privilegeObj.premium.user.demographics=
k;this.privilegeObj.premium.user.featurereport=k;this.privilegeObj.premium.publisher.geoanalytics=k;this.privilegeObj.premium.publisher.rasteranalysis=k;this.privilegeObj.marketplace.admin.purchase=k;this.privilegeObj.marketplace.admin.manage=k;this.privilegeObj.marketplace.admin.startTrial=k;this.privilegeObj.premium.publisher.createNotebooks=k;this.privilegeObj.premium.publisher.scheduleNotebooks=k;this.privilegeObj.premium.publisher.publishNotebooks=k;this.privilegeObj.premium.publisher.createAdvancedNotebooks=
k};return t=a.__decorate([u.subclass("")],t)}(q.default);e.default=T})},"app/portal/LevelAware":function(){define(["require","exports"],function(T,e){Object.defineProperty(e,"__esModule",{value:!0});T=function(){return function(){this.SYSTEM_ROLES={VIEWER:"iAAAAAAAAAAAAAAA",DATA_EDITOR:"iBBBBBBBBBBBBBBB"};this.LICENSE_LEVELS={ONE:"1",ONE_PLUS_EDIT:"11",TWO:"2"}}}();e.default=T})},"esri/widgets/LayerList":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Collection ../core/events ../core/Handles ../core/has ../core/reactiveUtils ../core/accessorSupport/decorators/aliasOf ../core/arrayUtils ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ./Widget ./LayerList/LayerListViewModel ./LayerList/ListItem ./LayerList/support/layerListUtils ./support/decorators/accessibleHandler ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ./support/widgetUtils ../chunks/sortable.esm".split(" "),
function(T,e,a,u,q,y,t,k,v,x,f,h,l,w,F,Q,N,W,A,G,H,Y,M){function C(ia){const {actionsOpen:L,children:J}=ia;L&&(ia.actionsOpen=!1);J.forEach(c=>C(c))}const D=u.ofType(Q),X={exclusive:"exclusive",inherited:"inherited",independent:"independent"},ba={statusIndicators:!0};u=function(ia){function L(c,d){var g=ia.call(this,c,d)||this;g._handles=new y;g._sortableNodes=new Map;g._sortableMap=new Map;g._focusSortUid=null;g._newUI=t("esri-layerlist-new-ui");g._tooltipReferenceMap=new Map;g.visibleItems=null;
g.iconClass="esri-icon-layers";g.label=void 0;g.listItemCanGiveFunction=null;g.listItemCanReceiveFunction=null;g.listItemCreatedFunction=null;g.messages=null;g.messagesCommon=null;g.multipleSelectionEnabled=!1;g.operationalItems=null;g.selectionEnabled=!1;g.selectedItems=new D;g.view=null;g.viewModel=new F;g.visibleElements={...ba};g._onSortableSort=({to:r,from:K,item:V,newIndex:O})=>{K&&r&&(K===r?g._sortLayers(g._sortableMap.get(K.dataset.group)):g._moveLayerFromChildList({to:r,from:K,item:V,newIndex:O}))};
g._sortableCanSort=(r,K)=>!(!r.el.dataset.group||!K.el.dataset.group);g._sortableCanPull=(r,K,V)=>{const {listItemCanGiveFunction:O}=e._assertThisInitialized(g);V={selected:V["data-item"],from:K.el["data-item"],to:r.el["data-item"]};return g._sortableCanSort(r,K)&&"function"===typeof O?O.call(null,V):!0};g._sortableCanPut=(r,K,V)=>{const {listItemCanReceiveFunction:O}=e._assertThisInitialized(g);V={selected:V["data-item"],from:K.el["data-item"],to:r.el["data-item"]};return g._sortableCanSort(r,K)&&
"function"===typeof O?O.call(null,V):!0};g._onSortableEnd=({oldIndex:r,from:K,to:V,item:O})=>{K!==V&&K.insertBefore(O,K.children[r])};return g}e._inheritsLoose(L,ia);var J=L.prototype;J.initialize=function(){const c=this.operationalItems;this._setVisibleItems(c);this.own([k.on(()=>this.operationalItems,"change",()=>this._itemsChanged(c)),k.watch(()=>this.errorsVisible,()=>this._itemsChanged(c)),k.watch(()=>this.selectionEnabled,()=>this._toggleAllSorting(),k.initial)])};J.loadDependencies=function(){return Promise.all([new Promise((c,
d)=>T(["../chunks/calcite-tooltip"],c,d))])};J.destroy=function(){this._destroySortables();this._tooltipReferenceMap.clear();this._handles.destroy();this._handles=null};J.castVisibleElements=function(c){return{...ba,...c}};J.triggerAction=function(c,d){this.viewModel.triggerAction(c,d)};J.render=function(){var c;const {visibleItems:d,_newUI:g}=this;var r=null==(c=this.viewModel)?void 0:c.state;c={["esri-layer-list--new-ui"]:g,["esri-hidden"]:"loading"===r,["esri-disabled"]:"disabled"===r};r=this.renderItemTooltips();
const K=this.renderItems();return H.tsx("div",{class:this.classes("esri-layer-list esri-widget esri-widget--panel",c)},null!=d&&d.length?[r,K]:this.renderNoItems())};J.renderItemTooltip=function(c){const {_tooltipReferenceMap:d,messages:g}=this;return c?H.tsx("calcite-tooltip",{label:g.layerIncompatible,referenceElement:d.get(c.uid)},g.layerIncompatibleTooltip):null};J.renderItemTooltipNodes=function(c){const {incompatible:d,children:g}=c;return[d?this.renderItemTooltip(c):null,...d?[]:null==g?void 0:
g.toArray().map(r=>this.renderItemTooltipNodes(r))]};J.renderItemTooltips=function(){return this.visibleItems.toArray().map(c=>this.renderItemTooltipNodes(c))};J.renderNoItems=function(){return H.tsx("div",{class:"esri-layer-list__no-items"},this.messages.noItemsToDisplay)};J.renderItems=function(){const {visibleItems:c,selectionEnabled:d,messages:g}=this;return H.tsx("ul",{"aria-label":g.widgetLabel,role:d?"listbox":void 0,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,
"data-group":"root",bind:this,class:this.classes("esri-layer-list__list","esri-layer-list__list--root","esri-layer-list__list--independent")},null==c?void 0:c.map(r=>this.renderItem(r,null)).toArray())};J.renderActionsMenuIcon=function(c,d){const {messagesCommon:g}=this;return H.tsx("div",{key:"actions-menu-toggle","data-item":c,bind:this,onclick:this._toggleActionsOpen,onkeydown:this._toggleActionsOpen,class:this.classes("esri-layer-list__item-actions-menu-item",{["esri-layer-list__item-actions-menu-item--active"]:c.actionsOpen}),
tabindex:"0",role:"button","aria-controls":d,"aria-label":g.options,title:g.options},H.tsx("span",{"aria-hidden":"true",class:"esri-icon-handle-horizontal"}))};J.renderActionsMenu=function(c,d,g,r){var {panel:K}=c;K=K&&K.visible?this.renderPanelButton(K):null;const V=(d=1===g&&this._getSingleActionButton(d))?this.renderAction({item:c,action:d,singleAction:!0}):null;return(c=!d&&g?this.renderActionsMenuIcon(c,r):null)||K||d?H.tsx("div",{key:"actions-menu",class:"esri-layer-list__item-actions-menu"},
K,V,c):null};J.renderChildList=function(c,d){var g;const {selectionEnabled:r}=this,{visibilityMode:K,children:V}=c,O=this._hasChildren(c),ja=!O&&r&&"group"===(null==(g=c.layer)?void 0:g.type),{exclusive:pa,inherited:wa}=X;g={["esri-layer-list__list--exclusive"]:K===pa,["esri-layer-list__list--inherited"]:K===wa,["esri-layer-list__list--independent"]:K!==wa&&K!==pa};return O||ja?H.tsx("ul",{bind:this,key:"list-items",id:d,"data-group":c.uid,"data-item":c,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,
afterRemoved:this._sortNodeRemoved,class:this.classes("esri-layer-list__list",g),"aria-expanded":c.open?"true":"false",role:r?"listbox":K===pa?"radiogroup":"group",hidden:c.open||ja?null:!0},null==V?void 0:V.map(ka=>this.renderItem(ka,c)).toArray()):null};J.renderChildrenToggle=function(c,d){var {messagesCommon:g}=this;const r=this._hasChildren(c),K={["esri-layer-list__child-toggle--open"]:c.open};g=c.open?g.collapse:g.expand;return r?H.tsx("span",{onclick:this._toggleChildrenClick,onkeydown:this._toggleChildrenClick,
"data-item":c,key:"toggle-children",class:this.classes("esri-layer-list__child-toggle",K),tabindex:"0",role:"button","aria-controls":d,"aria-label":g,title:g},H.tsx("span",{"aria-hidden":"true",class:this.classes("esri-layer-list__child-toggle-icon--closed","esri-icon-right-triangle-arrow")}),H.tsx("span",{"aria-hidden":"true",class:this.classes("esri-layer-list__child-toggle-icon--opened","esri-icon-down-arrow")}),H.tsx("span",{"aria-hidden":"true",class:this.classes("esri-layer-list__child-toggle-icon--closed-rtl",
"esri-icon-left-triangle-arrow")})):null};J.renderItemMessage=function(c){return c.error?H.tsx("div",{key:"esri-layer-list__error",class:"esri-layer-list__item-message",role:"alert"},H.tsx("span",{"aria-hidden":"true",class:"esri-icon-notice-triangle"}),this.messages.layerError):c.incompatible?H.tsx("div",{key:"esri-layer-list__incompatible",class:"esri-layer-list__item-message",role:"alert"},H.tsx("span",{bind:this,tabIndex:0,"aria-hidden":"true",class:"esri-icon-notice-triangle",afterCreate:d=>
this._setTooltipReference(d,c)}),this.messages.layerIncompatible):null};J.renderItemContent=function(c,d,g){var {id:r}=this,K=`${r}_${c.uid}`;r=`${K}_actions`;K=`${K}__list`;const {panel:V}=c,O=this._filterActions(c.actionsSections),ja=this._countActions(O);return[H.tsx("div",{key:"list-item-container",class:"esri-layer-list__item-container"},this.renderChildrenToggle(c,K),this.renderLabel(c,d,g),this.renderActionsMenu(c,O,ja,r)),this.renderItemMessage(c),ja?this.renderActionsSections(c,O,r):null,
V&&V.open?V.render():null,this.renderChildList(c,K)]};J.renderItem=function(c,d){const {_newUI:g,id:r,selectionEnabled:K,selectedItems:V,visibleElements:O}=this,ja=`${`${r}_${c.uid}`}__title`;var pa=this._hasMessage(c);pa={["esri-layer-list__item--has-children"]:this._hasChildren(c),["esri-layer-list__item--has-message"]:!!pa,["esri-layer-list__item--updating"]:c.updating&&!d&&O.statusIndicators,["esri-layer-list__item--invisible"]:g&&!c.visible,["esri-layer-list__item--invisible-at-scale"]:!c.visibleAtCurrentScale,
["esri-layer-list__item--selectable"]:K};if(K){var wa;const ka={["data-layer-uid"]:null==(wa=c.layer)?void 0:wa.uid,["data-sort-filter"]:(!c.sortable).toString()};return H.tsx("li",{key:`item-with-selection-${c.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes("esri-layer-list__item",pa),"aria-labelledby":ja,onclick:this._toggleSelection,onkeydown:this._selectionKeydown,"data-item":c,"data-group":d?d.uid:"root",tabIndex:0,"aria-selected":N.findSelectedItem(c,
V)?"true":"false",role:"option",...ka},this.renderItemContent(c,d,ja))}return H.tsx("li",{key:`item-no-selection-${c.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes("esri-layer-list__item",pa),"aria-labelledby":ja},this.renderItemContent(c,d,ja))};J.renderItemConnectionStatus=function(c){({connectionStatus:c}=c);return c?H.tsx("span",{class:this.classes({["esri-layer-list__connection-status"]:!0,["esri-layer-list__connection-status--disconnected"]:"disconnected"===
c,["esri-layer-list__connection-status--connected"]:"connected"===c}),key:"layer-connection-status"}):null};J.renderItemTitle=function(c,d){const {messages:g}=this;if(!c)return null;const r=c.title||g.untitledLayer;c=c.visibleAtCurrentScale?r:`${r} (${g.layerInvisibleAtScale})`;return H.tsx("span",{key:"layer-title-container",id:d,title:c,"aria-label":c,class:"esri-layer-list__item-title"},r)};J.renderItemToggleIcon=function(c,d){const {_newUI:g}=this,{exclusive:r}=X;d=d&&d.visibilityMode;return H.tsx("span",
{key:"item-toggle-icon",class:this.classes({["esri-layer-list__item-toggle-icon"]:g,["esri-layer-list__item-toggle-icon"]:g&&d!==r,["esri-layer-list__item-radio-icon"]:g&&d===r,["esri-icon-radio-checked"]:d===r&&c.visible,["esri-icon-radio-unchecked"]:d===r&&!c.visible,["esri-icon-visible"]:d!==r&&c.visible,["esri-icon-non-visible"]:d!==r&&!c.visible}),"aria-hidden":"true"})};J.renderItemToggle=function(c,d,g){const {selectionEnabled:r,messages:K}=this,{exclusive:V}=X,O=d&&d.visibilityMode;return r?
H.tsx("span",{key:"item-toggle-selection-enabled",class:"esri-layer-list__item-toggle",bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":c,"data-parent-visibility":O,tabIndex:0,title:c.visible?K.hideLayer:K.showLayer,"aria-checked":c.visible?"true":"false",role:O===V?"radio":"switch","aria-labelledby":g},this.renderItemToggleIcon(c,d)):H.tsx("span",{key:"item-toggle",class:"esri-layer-list__item-toggle"},this.renderItemToggleIcon(c,d))};J.renderLabel=function(c,
d,g){const {selectionEnabled:r,_newUI:K,messages:V}=this,{inherited:O,exclusive:ja}=X,pa=null==d?void 0:d.visibilityMode;var wa=pa===ja?"radio":"switch";d=[this.renderItemToggle(c,d,g),this.renderItemConnectionStatus(c),this.renderItemTitle(c,g)];K&&d.reverse();wa=r?H.tsx("div",{key:`item-label-no-selection-${c.uid}`,class:"esri-layer-list__item-label"},d):H.tsx("div",{key:`item-label-with-selection-${c.uid}`,class:"esri-layer-list__item-label",bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,
"data-item":c,"data-parent-visibility":pa,tabIndex:0,"aria-checked":c.visible?"true":"false",title:c.visible?V.hideLayer:V.showLayer,role:wa,"aria-labelledby":g},d);return pa===O||c.error?H.tsx("div",{key:`item-label-container-${c.uid}`,class:"esri-layer-list__item-label"},this.renderItemTitle(c,g)):wa};J.renderPanelButton=function(c){const {className:d,open:g,title:r,image:K}=c,V=K||d?d:"esri-icon-default-action",O=this._getIconImageStyles(c),ja={["esri-layer-list__item-actions-menu-item--active"]:g},
pa={["esri-layer-list__item-action-image"]:!!O["background-image"]};V&&(pa[V]=!!V);return H.tsx("div",{key:`panel-${c.uid}`,bind:this,"data-panel":c,onclick:this._triggerPanel,onkeydown:this._triggerPanel,class:this.classes("esri-layer-list__item-actions-menu-item",ja),role:"button",tabindex:"0",title:r,"aria-label":r},H.tsx("span",{class:this.classes(pa),styles:O}))};J.renderActionsSections=function(c,d,g){d=d.toArray().map((r,K)=>H.tsx("ul",{key:`${c}-action-section-${K}`,class:"esri-layer-list__item-actions-list"},
this.renderActionSection(c,r)));return H.tsx("div",{role:"group","aria-expanded":c.actionsOpen?"true":"false",key:"actions-section",id:g,class:"esri-layer-list__item-actions",hidden:c.actionsOpen?null:!0},d)};J.renderActionSection=function(c,d){return(d&&d.toArray()).map(g=>this.renderAction({item:c,action:g}))};J.renderActionIcon=function(c){const {active:d,className:g}=c,r=this._getIconImageStyles(c);c="button"!==c.type||c.image||g?g:"esri-icon-default-action";const K={["esri-layer-list__item-action-image"]:!d&&
!!r["background-image"],["esri-icon-loading-indicator"]:d,["esri-rotating"]:d};c&&!d&&(K[c]=!0);return H.tsx("span",{key:"action-icon","aria-hidden":"true",class:this.classes("esri-layer-list__item-action-icon",K),styles:r})};J.renderActionTitle=function(c,d){return d?null:H.tsx("span",{key:"action-title",class:"esri-layer-list__item-action-title"},c)};J.renderAction=function(c){const {item:d,action:g,singleAction:r}=c,{active:K,disabled:V,title:O}=g;c={["esri-layer-list__item-actions-menu-item"]:r&&
"button"===g.type,["esri-layer-list__item-action"]:K||!r&&"toggle"!==g.type,["esri-layer-list__action-toggle"]:!K&&"toggle"===g.type,["esri-layer-list__action-toggle--on"]:!K&&"toggle"===g.type&&g.value,["esri-disabled-element"]:V};const ja=[this.renderActionIcon(g),this.renderActionTitle(O,r)];return r?H.tsx("div",{bind:this,"data-item":d,"data-action":g,role:"button",key:`single-action-${g.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:c,tabindex:"0",title:O,"aria-label":O},
ja):H.tsx("li",{bind:this,"data-item":d,"data-action":g,key:`action-${g.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:c,tabindex:"0",role:"button",title:O,"aria-label":O},ja)};J._setTooltipReference=function(c,d){this._tooltipReferenceMap.set(d.uid,c);this.scheduleRender()};J._hasMessage=function(c){return!!c.error||c.incompatible};J._hasChildren=function(c){return!!c.children.length&&!this._hasMessage(c)};J._sortNodeRemoved=function(c){const {_sortableMap:d}=this;c=c.dataset.group;
const g=d.get(c);g&&g.destroy();d.delete(c)};J._destroySortables=function(){const {_sortableMap:c,_sortableNodes:d}=this;c.forEach(g=>g&&g.destroy());c.clear();d.clear()};J._moveLayerFromChildList=function({to:c,from:d,item:g,newIndex:r}){this.viewModel.moveListItem(g["data-item"],d["data-item"],c["data-item"],r)};J._sortLayers=function(c){if(c){var d=c.el["data-item"];c=c.toArray();if(d)N.sortChildLayersToIds(d,c);else{var g,r;N.sortLayersToIds(null==(g=this.view)?void 0:null==(r=g.map)?void 0:r.layers,
c)}}};J._toggleSorting=function(c,d){const {_sortableMap:g,selectionEnabled:r}=this,K=g.get(d);var V=c["data-item"];V=("root"===d?!0:V.childrenSortable&&N.canSortSublayers(V))&&r;K?K.option("disabled",!V):V&&(c=M.Sortable.create(c,{dataIdAttr:"data-layer-uid",group:{name:d,pull:this._sortableCanPull,put:this._sortableCanPut},filter:'[data-sort-filter\x3d"true"]',fallbackTolerance:4,onSort:this._onSortableSort,onEnd:this._onSortableEnd,disabled:!V,chosenClass:"esri-layer-list--chosen"}),g.set(d,c))};
J._toggleAllSorting=function(){this._sortableNodes.forEach((c,d)=>this._toggleSorting(c,d))};J._sortNodeCreated=function(c){const d=c.dataset.group;d&&(this._sortableNodes.set(d,c),this._toggleSorting(c,d))};J._setVisibleItems=function(c){this.visibleItems=null==c?void 0:c.filter(d=>!d.hidden&&(this.errorsVisible||!d.error))};J._getSingleActionButton=function(c){return c.reduce(d=>d).filter(d=>d&&"button"===d.type).getItemAt(0)};J._focusListItem=function(c){var d;const {_focusSortUid:g}=this;c&&g&&
(null==(d=c["data-item"].layer)?void 0:d.uid)===g&&(c.focus(),this._focusSortUid=null)};J._watchActionSectionChanges=function(c,d){const g="action-section"+d;this._handles.add(c.on("change",this.scheduleRender.bind(this)),g);c.forEach(r=>this._renderOnActionChanges(r,d))};J._renderOnActionChanges=function(c,d){d="actions"+d;"toggle"===c.type?this._handles.add(k.watch(()=>[null==c?void 0:c.className,null==c?void 0:c.image,null==c?void 0:c.id,null==c?void 0:c.title,null==c?void 0:c.visible,null==c?
void 0:c.value],()=>this.scheduleRender(),k.initial),d):"slider"===c.type?this._handles.add(k.watch(()=>[null==c?void 0:c.className,null==c?void 0:c.id,null==c?void 0:c.title,null==c?void 0:c.visible,null==c?void 0:c.value,null==c?void 0:c.displayValueEnabled,null==c?void 0:c.max,null==c?void 0:c.min,null==c?void 0:c.step],()=>this.scheduleRender(),k.initial),d):this._handles.add(k.watch(()=>[null==c?void 0:c.className,null==c?void 0:c.image,null==c?void 0:c.id,null==c?void 0:c.title,null==c?void 0:
c.visible],()=>this.scheduleRender(),k.initial),d)};J._renderOnItemChanges=function(c){const d=c.uid,g="items"+d;this._handles.add([k.watch(()=>{var r,K,V;return[null==c?void 0:c.actionsOpen,null==c?void 0:c.visible,null==c?void 0:c.open,null==c?void 0:c.updating,null==c?void 0:c.title,null==c?void 0:c.visibleAtCurrentScale,null==c?void 0:c.error,null==c?void 0:c.visibilityMode,null==c?void 0:c.panel,null==c?void 0:null==(r=c.panel)?void 0:r.title,null==c?void 0:null==(K=c.panel)?void 0:K.content,
null==c?void 0:null==(V=c.panel)?void 0:V.className,null==c?void 0:c.sortable,null==c?void 0:c.childrenSortable]},()=>this.scheduleRender(),k.syncAndInitial),k.watch(()=>[null==c?void 0:c.hidden,null==c?void 0:c.error],()=>this._setVisibleItems(this.operationalItems)),c.actionsSections.on("change",()=>this.scheduleRender()),c.children.on("change",()=>this.scheduleRender())],g);c.children.forEach(r=>this._renderOnItemChanges(r));c.actionsSections.forEach(r=>this._watchActionSectionChanges(r,d))};J._itemsChanged=
function(c){this._handles.removeAll();c.forEach(d=>this._renderOnItemChanges(d));this._tooltipReferenceMap.clear();this._setVisibleItems(c);this.scheduleRender()};J._filterActions=function(c){return c.map(d=>d.filter(g=>g.visible))};J._countActions=function(c){return c.reduce((d,g)=>d+g.length,0)};J._getIconImageStyles=function(c){c="esri.widgets.LayerList.ListItemPanel"===c.declaredClass||"esri.support.Action.ActionButton"===c.declaredClass||"esri.support.Action.ActionToggle"===c.declaredClass?c.image:
null;return{"background-image":c?`url("${c}")`:null}};J._selectionKeydown=function(c){var d=q.eventKey(c);if(["ArrowDown","ArrowUp"].includes(d)){c.stopPropagation();var g=c.currentTarget,r=g["data-item"],{_sortableMap:K,selectedItems:V}=this;if(g=K.get(g.dataset.group)){var O=N.findSelectedItem(r,V),ja=g.toArray();c=ja.indexOf(c.target.dataset.layerUid);if(-1!==c){if("ArrowDown"===d){const za=c+1;if(za>=ja.length)return;if(O){var pa;ja.splice(za,0,ja.splice(c,1)[0]);g.sort(ja);this._sortLayers(g);
this._focusSortUid=null==(pa=r.layer)?void 0:pa.uid}else{var wa;this._focusSortUid=null==(wa=r.layer)?void 0:wa.uid;this.scheduleRender()}}if("ArrowUp"===d&&(d=c-1,!(-1>=d)))if(O){var ka;ja.splice(d,0,ja.splice(c,1)[0]);g.sort(ja);this._sortLayers(g);this._focusSortUid=null==(ka=r.layer)?void 0:ka.uid}else{var ra;this._focusSortUid=null==(ra=r.layer)?void 0:ra.uid;this.scheduleRender()}}}}else this._toggleSelection(c)};J._toggleActionsOpen=function(c){const d=c.currentTarget["data-item"];var {actionsOpen:g}=
d;(g=!g)&&this.operationalItems.forEach(r=>C(r));d.actionsOpen=g;c.stopPropagation()};J._triggerPanel=function(c){const d=c.currentTarget["data-panel"];d&&(d.open=!d.open);c.stopPropagation()};J._triggerAction=function(c){var d=c.currentTarget;const g=d["data-action"];d=d["data-item"];"toggle"===g.type&&(g.value=!g.value);this.triggerAction(g,d);c.stopPropagation()};J._toggleVisibility=function(c){var d=c.currentTarget;const g=d.getAttribute("data-parent-visibility");d=d["data-item"];g===X.exclusive&&
d.visible||(d.visible=!d.visible);c.stopPropagation()};J._toggleChildrenClick=function(c){const d=c.currentTarget["data-item"];d.open=!d.open;c.stopPropagation()};J._toggleSelection=function(c){c.stopPropagation();const {multipleSelectionEnabled:d,selectedItems:g}=this;c=c.currentTarget["data-item"];const r=N.findSelectedItem(c,g),{length:K}=g,V=r&&1===K;d?r?null==g.remove?void 0:g.remove(r):g.add(c):K&&!V?(g.removeAll(),g.add(c)):r?null==g.remove?void 0:g.remove(r):g.add(c)};return L}(w);a.__decorate([h.property()],
u.prototype,"visibleItems",void 0);a.__decorate([h.property()],u.prototype,"iconClass",void 0);a.__decorate([h.property()],u.prototype,"errorsVisible",void 0);a.__decorate([h.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],u.prototype,"label",void 0);a.__decorate([h.property()],u.prototype,"listItemCanGiveFunction",void 0);a.__decorate([h.property()],u.prototype,"listItemCanReceiveFunction",void 0);a.__decorate([v.aliasOf("viewModel.listItemCreatedFunction")],u.prototype,"listItemCreatedFunction",
void 0);a.__decorate([h.property(),A.messageBundle("esri/widgets/LayerList/t9n/LayerList")],u.prototype,"messages",void 0);a.__decorate([h.property(),A.messageBundle("esri/t9n/common")],u.prototype,"messagesCommon",void 0);a.__decorate([h.property()],u.prototype,"multipleSelectionEnabled",void 0);a.__decorate([v.aliasOf("viewModel.operationalItems")],u.prototype,"operationalItems",void 0);a.__decorate([h.property()],u.prototype,"selectionEnabled",void 0);a.__decorate([h.property()],u.prototype,"selectedItems",
void 0);a.__decorate([v.aliasOf("viewModel.view")],u.prototype,"view",void 0);a.__decorate([G.vmEvent("trigger-action"),h.property({type:F})],u.prototype,"viewModel",void 0);a.__decorate([h.property()],u.prototype,"visibleElements",void 0);a.__decorate([f.cast("visibleElements")],u.prototype,"castVisibleElements",null);a.__decorate([v.aliasOf("viewModel.triggerAction")],u.prototype,"triggerAction",null);a.__decorate([W.accessibleHandler()],u.prototype,"_toggleActionsOpen",null);a.__decorate([W.accessibleHandler()],
u.prototype,"_triggerPanel",null);a.__decorate([W.accessibleHandler()],u.prototype,"_triggerAction",null);a.__decorate([W.accessibleHandler()],u.prototype,"_toggleVisibility",null);a.__decorate([W.accessibleHandler()],u.prototype,"_toggleChildrenClick",null);a.__decorate([W.accessibleHandler()],u.prototype,"_toggleSelection",null);return u=a.__decorate([l.subclass("esri.widgets.LayerList")],u)})},"esri/widgets/LayerList/LayerListViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/Handles ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ListItem ./support/layerListUtils".split(" "),
function(T,e,a,u,q,y,t,k,v,x,f,h,l){const w=a.ofType(h);a=function(F){function Q(W){W=F.call(this,W)||this;W._handles=new q;W.listItemCreatedFunction=null;W.operationalItems=new w;W.view=null;return W}T._inheritsLoose(Q,F);var N=Q.prototype;N.initialize=function(){this._handles.add([y.watch(()=>{var W;return[this.view,null==(W=this.view)?void 0:W.ready]},()=>this._viewHandles(),y.initial),y.watch(()=>this.listItemCreatedFunction,()=>this._listItemCreatedFunctionChanged())],"view")};N.destroy=function(){this._handles.destroy();
this.view=this._handles=null;this.operationalItems.removeAll()};N.triggerAction=function(W,A){W&&!W.disabled&&this.emit("trigger-action",{action:W,item:A})};N.moveListItem=function(W,A,G,H){var Y,M;const C=null==W?void 0:W.layer;if(C){var D=null==(Y=this.view)?void 0:null==(M=Y.map)?void 0:M.layers;Y=A?l.getItemLayers(A):D;D=G?l.getItemLayers(G):D;Y&&D&&({operationalItems:M}=this,A=(null==A?void 0:A.children)||M,M=(null==G?void 0:G.children)||M,H=D.length-H,W.parent=G||null,A.includes(W)&&A.remove(W),
Y.includes(C)&&Y.remove(C),M.includes(W)||M.add(W,H),D.includes(C)||D.add(C,H))}};N._createLayerViewHandles=function(W){const {_handles:A}=this;A.remove("layer-views");this._compileList();W&&A.add(W.on("change",()=>this._compileList()),"layer-views")};N._createMapLayerHandles=function(W){const {_handles:A}=this;A.remove("map-layers");this._compileList();W&&A.add(W.on("change",()=>this._compileList()),"map-layers")};N._createListItem=function(W){const {view:A,listItemCreatedFunction:G}=this;return new h({layer:W,
listItemCreatedFunction:G,view:A})};N._removeAllItems=function(){const {_handles:W,operationalItems:A}=this;A.forEach(G=>{W.remove(`${"children"}-${G.uid}`)});A.removeAll()};N._getViewableLayers=function(W){if(W)return W.filter(A=>"hide"!==l.findLayerListMode(A))};N._watchLayersListMode=function(W){const {_handles:A}=this;A.remove("layer-list-mode");W&&W.forEach(G=>{"listMode"in G&&A.add(y.watch(()=>G.listMode,()=>this._compileList()),"layer-list-mode")})};N._compileList=function(){var W=this.get("view.map.layers");
this._watchLayersListMode(W);(W=this._getViewableLayers(W))&&W.length?(this._createNewItems(W),this._removeItems(W),this._sortItems(W)):this._removeAllItems()};N._createNewItems=function(W){const {operationalItems:A}=this;W.forEach(G=>{A.find(H=>H.layer===G)||A.add(this._createListItem(G))})};N._removeItems=function(W){const {_handles:A,operationalItems:G}=this,H=[];G.forEach(Y=>{Y&&W&&W.includes(Y.layer)||(A.remove(`${"children"}-${Y.uid}`),H.push(Y))});G.removeMany(H)};N._sortItems=function(W){const {operationalItems:A}=
this;A.sort((G,H)=>{G=W.indexOf(G.layer);H=W.indexOf(H.layer);return G>H?-1:G<H?1:0})};N._listItemCreatedFunctionChanged=function(){this._removeAllItems();this._compileList()};N._viewHandles=function(){const {_handles:W,view:A}=this;W.remove(["map-layers","layer-views","view-layers"]);this._compileList();A&&A.ready&&W.add([y.watch(()=>{var G,H;return null==(G=this.view)?void 0:null==(H=G.map)?void 0:H.allLayers},G=>this._createMapLayerHandles(G),y.initial),y.watch(()=>{var G;return null==(G=this.view)?
void 0:G.allLayerViews},G=>this._createLayerViewHandles(G),y.initial)],"view-layers")};T._createClass(Q,[{key:"state",get:function(){const W=this.get("view");return this.get("view.ready")?"ready":W?"loading":"disabled"}}]);return Q}(u.EventedAccessor);e.__decorate([t.property()],a.prototype,"listItemCreatedFunction",void 0);e.__decorate([t.property({type:w})],a.prototype,"operationalItems",void 0);e.__decorate([t.property({readOnly:!0})],a.prototype,"state",null);e.__decorate([t.property()],a.prototype,
"view",void 0);return a=e.__decorate([f.subclass("esri.widgets.LayerList.LayerListViewModel")],a)})},"esri/widgets/LayerList/ListItem":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/HandleOwner ../../core/Identifiable ../../core/reactiveUtils ../../core/accessorSupport/decorators/aliasOf ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionSlider ../../support/actions/ActionToggle ./ListItemPanel ./support/layerListUtils".split(" "),
function(T,e,a,u,q,y,t,k,v,x,f,h,l,w,F,Q,N,W,A){var G;v=u.ofType({key:"type",defaultKeyValue:"button",base:w,typeMap:{button:F,toggle:N,slider:Q}});const H=u.ofType(v);a=G=function(Y){function M(D){D=Y.call(this,D)||this;D.actionsSections=new H;D.actionsOpen=!1;D.children=new (u.ofType(G));D.childrenSortable=!0;D.error=null;D.hidden=!1;D.layer=null;D.layerView=null;D.listItemCreatedFunction=null;D.open=!1;D.panel=null;D.parent=null;D.sortable=!0;D.view=null;D.visible=null;return D}T._inheritsLoose(M,
Y);var C=M.prototype;C.initialize=function(){this.handles.add([t.watch(()=>this.layer,D=>this._watchLayerProperties(D),t.initial),t.watch(()=>this.view,D=>this._updateChildren(D),t.initial),t.watch(()=>this.panel,D=>this._setListItemOnPanel(D),t.initial),t.watch(()=>[this.layer,this.view],()=>this._getLayerView(),t.initial)]);"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,{item:this})};C.destroy=function(){this.view=null};C.castPanel=function(D){this.get("panel.open")&&
!D.hasOwnProperty("open")&&(D.open=!0);return D?new W(D):null};C.clone=function(){return new G({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,children:this.children.clone(),layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})};C._setListItemOnPanel=function(D){D&&(D.listItem=this)};C._updateChildren=function(D){const X=this.children;X&&X.forEach(ba=>ba.view=D)};C._addChildren=
function(D){this.handles.remove("child-list-mode");this.children.removeAll();if(D){D.forEach(ba=>{this.handles.add(t.watch(()=>ba.listMode,()=>this._addChildren(D)),"child-list-mode")});var X=D.filter(ba=>"hide"!==A.findLayerListMode(ba));this.children.addMany(this._makeChildren(X))}};C._watchSublayerChanges=function(D){D&&this.handles.add(D.on("change",()=>{this._addChildren(D)}),"layer")};C._initializeChildLayers=function(D){this._addChildren(D);this._watchSublayerChanges(D)};C._makeChildren=function(D){return D.map(X=>
A.canDisplayLayer(X)?new G({layer:X,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null).reverse()};C._watchLayerProperties=function(D){if(this.handles&&(this.handles.remove("layer"),this.handles.remove("child-list-mode"),D))if(this.handles.add(t.watch(()=>D.listMode,()=>this._watchLayerProperties(D)),"layer"),"hide-children"===A.findLayerListMode(D))this.children.removeAll();else{var X=A.getNormalizedChildLayerProperty(D);X&&this.handles.add(t.watch(()=>D[X],()=>
{D.hasOwnProperty(X)&&this._initializeChildLayers(D[X])},t.initial),"layer")}};C._getLayerView=function(){var D=T._asyncToGenerator(function*(){const {layer:X,view:ba}=this;if(X&&ba)try{const ia=yield ba.whenLayerView(X);ia.layer===this.layer&&this._set("layerView",ia)}catch{}});return function(){return D.apply(this,arguments)}}();C._isLayerUpdating=function(D){return D&&"loading"===D.loadStatus};T._createClass(M,[{key:"connectionStatus",get:function(){const {layerView:D}=this;if(D&&"connectionStatus"in
D)return D.connectionStatus}},{key:"incompatible",get:function(){const {layerView:D}=this;return D&&"spatialReferenceSupported"in D?!D.spatialReferenceSupported:!1}},{key:"title",get:function(){const D=this.get("layer.layer");return(!D||D&&this.get("layer.layer.loaded"))&&this.get("layer.title")||this.get("layer.attributes.title")||""},set:function(D){void 0===D?this._clearOverride("title"):this._override("title",D)}},{key:"updating",get:function(){const {layerView:D,connectionStatus:X}=this;return X?
!1:D?D.updating:this._isLayerUpdating(this.layer)}},{key:"visibleAtCurrentScale",get:function(){return!A.isLayerOutsideScaleRange(this.layer,this.get("view.scale"))}},{key:"visibilityMode",get:function(){return A.findLayerVisibilityMode(this.layer)}}]);return M}(y.IdentifiableMixin(q.HandleOwnerMixin(a)));e.__decorate([h.property({type:H})],a.prototype,"actionsSections",void 0);e.__decorate([h.property()],a.prototype,"actionsOpen",void 0);e.__decorate([h.property({type:u})],a.prototype,"children",
void 0);e.__decorate([h.property()],a.prototype,"childrenSortable",void 0);e.__decorate([h.property({readOnly:!0})],a.prototype,"connectionStatus",null);e.__decorate([k.aliasOf("layer.loadError?")],a.prototype,"error",void 0);e.__decorate([h.property()],a.prototype,"hidden",void 0);e.__decorate([h.property({readOnly:!0})],a.prototype,"incompatible",null);e.__decorate([h.property()],a.prototype,"layer",void 0);e.__decorate([h.property({readOnly:!0})],a.prototype,"layerView",void 0);e.__decorate([h.property()],
a.prototype,"listItemCreatedFunction",void 0);e.__decorate([h.property()],a.prototype,"open",void 0);e.__decorate([h.property({type:W})],a.prototype,"panel",void 0);e.__decorate([f.cast("panel")],a.prototype,"castPanel",null);e.__decorate([h.property()],a.prototype,"parent",void 0);e.__decorate([h.property()],a.prototype,"sortable",void 0);e.__decorate([h.property()],a.prototype,"title",null);e.__decorate([h.property({readOnly:!0})],a.prototype,"updating",null);e.__decorate([h.property({value:null})],
a.prototype,"view",void 0);e.__decorate([k.aliasOf("layer.visible")],a.prototype,"visible",void 0);e.__decorate([h.property({readOnly:!0})],a.prototype,"visibleAtCurrentScale",null);e.__decorate([h.property({readOnly:!0})],a.prototype,"visibilityMode",null);return a=G=e.__decorate([l.subclass("esri.widgets.LayerList.ListItem")],a)})},"esri/support/actions/ActionSlider":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./ActionBase".split(" "),
function(T,e,a,u,q,y,t,k){var v;u=v=function(x){function f(h){h=x.call(this,h)||this;h.displayValueEnabled=!1;h.max=1;h.min=0;h.step=.1;h.type="slider";h.value=null;return h}T._inheritsLoose(f,x);f.prototype.clone=function(){return new v({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})};return f}(k);e.__decorate([a.property()],
u.prototype,"displayValueEnabled",void 0);e.__decorate([a.property()],u.prototype,"max",void 0);e.__decorate([a.property()],u.prototype,"min",void 0);e.__decorate([a.property()],u.prototype,"step",void 0);e.__decorate([a.property()],u.prototype,"value",void 0);return u=v=e.__decorate([t.subclass("esri.support.Action.ActionSlider")],u)})},"esri/widgets/LayerList/ListItemPanel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Handles ../../core/Identifiable ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../Widget ./support/layerListUtils ../support/widget ../support/jsxFactory".split(" "),
function(T,e,a,u,q,y,t,k,v,x,f,h,l,w,F){q=function(Q){function N(A,G){A=Q.call(this,A,G)||this;A._legend=null;A._handles=new u;A.content=null;A.image=null;A.listItem=null;A.open=!1;A.visible=!0;return A}e._inheritsLoose(N,Q);var W=N.prototype;W.initialize=function(){this.own([y.watch(()=>this.content,A=>this._createLegend(A),y.initial)])};W.destroy=function(){const {_legend:A}=this;A&&A.destroy();this._legend=null};W.render=function(){return F.tsx("div",{class:"esri-layer-list-panel"},this._renderContents())};
W._renderContent=function(A){const {_legend:G,listItem:H}=this;return A?"legend"===A?H&&H.view&&H.layer&&G?F.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--legend"),key:G},G.render()):null:"string"===typeof A?F.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--string"),key:A,innerHTML:A}):w.isWidget(A)?F.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--widget"),
key:A},A.render()):A instanceof HTMLElement?F.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--html-element"),key:A,bind:A,afterCreate:this._attachToNode}):null:null};W._renderContents=function(){const {content:A}=this;return Array.isArray(A)?A.map(G=>this._renderContent(G)):this._renderContent(A)};W._getLegendOptions=function(){const {listItem:A}=this;if(!A)return{};const {layer:G,view:H}=A;return G&&H?{view:H,layerInfos:[l.getLegendLayerInfo(G)]}:{}};
W._createLegend=function(A){this._hasLegend(A)&&!this._legend&&(new Promise((G,H)=>T(["../Legend"],Y=>G(Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"}))),H))).then(({default:G})=>{const {_handles:H,listItem:Y}=this,M=new G(this._getLegendOptions());this._legend=M;this.notifyChange("className");this.notifyChange("title");G=y.watch(()=>{var C,D;return[null==Y?void 0:Y.view,null==Y?void 0:Y.layer,null==Y?void 0:null==(C=Y.layer)?void 0:C.source,null==
Y?void 0:null==(D=Y.layer)?void 0:D.parent]},()=>this._updateLegend(M),y.initial);H.add(G,"legends");this.scheduleRender()})};W._hasLegend=function(A){return"legend"===A?!0:Array.isArray(A)?A.includes("legend"):!1};W._attachToNode=function(A){A.appendChild(this)};W._updateLegend=function(A){A.set(this._getLegendOptions());this.scheduleRender()};W._getWidget=function(A){return"legend"===A?this._legend:w.isWidget(A)?A:null};W._getFirstWidget=function(){const {content:A}=this;if(Array.isArray(A)){let G=
null;A.some(H=>{(H=this._getWidget(H))&&(G=H);return!!H});return G}return this._getWidget(A)};e._createClass(N,[{key:"className",get:function(){const {image:A}=this,G=this._getFirstWidget();return this._get("className")||!A&&G?G.iconClass:""},set:function(A){void 0===A?this._clearOverride("className"):this._override("className",A)}},{key:"title",get:function(){const A=this._getFirstWidget();return this._get("title")||A?A.label:""},set:function(A){void 0===A?this._clearOverride("title"):this._override("title",
A)}}]);return N}(q.IdentifiableMixin(h));a.__decorate([t.property()],q.prototype,"className",null);a.__decorate([t.property()],q.prototype,"content",void 0);a.__decorate([t.property()],q.prototype,"image",void 0);a.__decorate([t.property()],q.prototype,"listItem",void 0);a.__decorate([t.property()],q.prototype,"title",null);a.__decorate([t.property()],q.prototype,"open",void 0);a.__decorate([t.property()],q.prototype,"visible",void 0);return q=a.__decorate([f.subclass("esri.widgets.LayerList.ListItemPanel")],
q)})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["exports"],function(T){function e(v){if(v)return null!=v.listMode?v.listMode:void 0}function a(v){if(v)return null!=v.minScale?v.minScale:void 0}function u(v){if(v)return null!=v.maxScale?v.maxScale:void 0}function q(v){if(v){if(!("type"in v))return"sublayers";if(v.listMode!==k.hideChildren&&"wmts"!==v.type)switch(v.type){case "group":return"layers";default:return"sublayers"}}}function y(v,x){v&&v.sort((f,h)=>{f=x.indexOf(f.uid);
h=x.indexOf(h.uid);return f>h?-1:f<h?1:0})}function t(v){return!(null==v||!v.layer)}const k={hide:"hide",hideChildren:"hide-children"};T.canDisplayLayer=function(v){return e(v)!==k.hide};T.canSortSublayers=function(v){v=v&&(v.get("layer.layer")||v.layer);if(!v)return!1;v=v.get("capabilities.exportMap.supportsDynamicLayers");return"boolean"===typeof v?v:!0};T.findLayerListMode=e;T.findLayerMaxScale=u;T.findLayerMinScale=a;T.findLayerVisibilityMode=function(v){if(!v)return"inherited";var x=v.get("layer.capabilities.exportMap.supportsSublayerVisibility");
if("boolean"===typeof x)return x?"independent":"inherited";x=v.get("capabilities.exportMap.supportsSublayerVisibility");return"boolean"===typeof x?x?"independent":"inherited":null!=v.visibilityMode?v.visibilityMode:"independent"};T.findSelectedItem=function(v,x){var f;const h=null==(f=v.layer)?void 0:f.uid;return h&&x.find(l=>{var w;return(null==(w=l.layer)?void 0:w.uid)===h})};T.getItemLayers=function(v){return(v=null==v?void 0:v.layer)&&"group"===v.type?v.layers:null};T.getLegendLayerInfo=function(v){var x=
t(v)?v:null;const f=null==v?void 0:v.parent;return(x="map-image"===(null==f?void 0:f.type)&&x.source)&&f?{layer:f,title:"",sublayerIds:[x.mapLayerId]}:{layer:v,title:""}};T.getNormalizedChildLayerProperty=q;T.isLayerOutsideScaleRange=function(v,x){if(!v||isNaN(x))return!1;var f=a(v);v=u(v);f=!isNaN(f)&&0<f&&x>f;x=!isNaN(v)&&0<v&&x<v;return f||x};T.isSublayer=t;T.sortChildLayersToIds=function(v,x){if(v=null==v?void 0:v.layer){var f=q(v);f&&(v=v.get(f),y(v,x))}};T.sortLayersToIds=y;Object.defineProperties(T,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/chunks/sortable.esm":function(){define(["exports"],function(T){function e(b,m){var n=Object.keys(b);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(b);m&&(B=B.filter(function(S){return Object.getOwnPropertyDescriptor(b,S).enumerable}));n.push.apply(n,B)}return n}function a(b){for(var m=1;m<arguments.length;m++){var n=null!=arguments[m]?arguments[m]:{};m%2?e(Object(n),!0).forEach(function(B){var S=n[B];B in
b?Object.defineProperty(b,B,{value:S,enumerable:!0,configurable:!0,writable:!0}):b[B]=S}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach(function(B){Object.defineProperty(b,B,Object.getOwnPropertyDescriptor(n,B))})}return b}function u(b){"@babel/helpers - typeof";u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(m){return typeof m}:function(m){return m&&"function"===typeof Symbol&&m.constructor===Symbol&&
m!==Symbol.prototype?"symbol":typeof m};return u(b)}function q(){q=Object.assign||function(b){for(var m=1;m<arguments.length;m++){var n=arguments[m],B;for(B in n)Object.prototype.hasOwnProperty.call(n,B)&&(b[B]=n[B])}return b};return q.apply(this,arguments)}function y(b,m){if(null==b)return{};if(null==b)var n={};else{n={};var B=Object.keys(b),S;for(S=0;S<B.length;S++){var ca=B[S];0<=m.indexOf(ca)||(n[ca]=b[ca])}}if(Object.getOwnPropertySymbols)for(S=Object.getOwnPropertySymbols(b),ca=0;ca<S.length;ca++)B=
S[ca],0<=m.indexOf(B)||Object.prototype.propertyIsEnumerable.call(b,B)&&(n[B]=b[B]);return n}function t(b){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(b)}function k(b,m,n){b.addEventListener(m,n,!ua&&ha)}function v(b,m,n){b.removeEventListener(m,n,!ua&&ha)}function x(b,m){if(m){"\x3e"===m[0]&&(m=m.substring(1));if(b)try{if(b.matches)return b.matches(m);if(b.msMatchesSelector)return b.msMatchesSelector(m);if(b.webkitMatchesSelector)return b.webkitMatchesSelector(m)}catch(n){}return!1}}
function f(b,m,n,B){if(b){n=n||document;do{if(null!=m&&("\x3e"===m[0]?b.parentNode===n&&x(b,m):x(b,m))||B&&b===n)return b;if(b===n)break}while(b=b.host&&b!==document&&b.host.nodeType?b.host:b.parentNode)}return null}function h(b,m,n){if(b&&m)if(b.classList)b.classList[n?"add":"remove"](m);else{var B=(" "+b.className+" ").replace(ea," ").replace(" "+m+" "," ");b.className=(B+(n?" "+m:"")).replace(ea," ")}}function l(b,m,n){var B=b&&b.style;if(B){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?
n=document.defaultView.getComputedStyle(b,""):b.currentStyle&&(n=b.currentStyle),void 0===m?n:n[m];m in B||-1!==m.indexOf("webkit")||(m="-webkit-"+m);B[m]=n+("string"===typeof n?"":"px")}}function w(b,m){var n="";if("string"===typeof b)n=b;else{do{var B=l(b,"transform");B&&"none"!==B&&(n=B+" "+n)}while(!m&&(b=b.parentNode))}return(b=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix)&&new b(n)}function F(b,m,n){if(b){b=b.getElementsByTagName(m);m=0;var B=b.length;if(n)for(;m<
B;m++)n(b[m],m);return b}return[]}function Q(){var b=document.scrollingElement;return b?b:document.documentElement}function N(b,m,n,B,S){if(b.getBoundingClientRect||b===window){if(b!==window&&b.parentNode&&b!==Q()){var ca=b.getBoundingClientRect();var fa=ca.top;var qa=ca.left;var sa=ca.bottom;var xa=ca.right;var ya=ca.height;var Ca=ca.width}else qa=fa=0,sa=window.innerHeight,xa=window.innerWidth,ya=window.innerHeight,Ca=window.innerWidth;if((m||n)&&b!==window&&(S=S||b.parentNode,!ua)){do if(S&&S.getBoundingClientRect&&
("none"!==l(S,"transform")||n&&"static"!==l(S,"position"))){sa=S.getBoundingClientRect();fa-=sa.top+parseInt(l(S,"border-top-width"));qa-=sa.left+parseInt(l(S,"border-left-width"));sa=fa+ca.height;xa=qa+ca.width;break}while(S=S.parentNode)}B&&b!==window&&(B=(b=w(S||b))&&b.a,S=b&&b.d,b&&(fa/=S,qa/=B,Ca/=B,ya/=S,sa=fa+ya,xa=qa+Ca));return{top:fa,left:qa,bottom:sa,right:xa,width:Ca,height:ya}}}function W(b,m,n){var B=C(b,!0);for(b=N(b)[m];B;){m=N(B)[n];var S=void 0;S="top"===n||"left"===n?b>=m:b<=m;
if(!S)return B;if(B===Q())break;B=C(B,!1)}return!1}function A(b,m,n,B){for(var S=0,ca=0,fa=b.children;ca<fa.length;){if("none"!==fa[ca].style.display&&fa[ca]!==c.ghost&&(B||fa[ca]!==c.dragged)&&f(fa[ca],n.draggable,b,!1)){if(S===m)return fa[ca];S++}ca++}return null}function G(b,m){for(b=b.lastElementChild;b&&(b===c.ghost||"none"===l(b,"display")||m&&!x(b,m));)b=b.previousElementSibling;return b||null}function H(b,m){var n=0;if(!b||!b.parentNode)return-1;for(;b=b.previousElementSibling;)"TEMPLATE"===
b.nodeName.toUpperCase()||b===c.clone||m&&!x(b,m)||n++;return n}function Y(b){var m=0,n=0,B=Q();if(b){do{var S=w(b),ca=S.d;m+=b.scrollLeft*S.a;n+=b.scrollTop*ca}while(b!==B&&(b=b.parentNode))}return[m,n]}function M(b,m){for(var n in b)if(b.hasOwnProperty(n))for(var B in m)if(m.hasOwnProperty(B)&&m[B]===b[n][B])return Number(n);return-1}function C(b,m){if(!b||!b.getBoundingClientRect)return Q();var n=!1;do if(b.clientWidth<b.scrollWidth||b.clientHeight<b.scrollHeight){var B=l(b);if(b.clientWidth<b.scrollWidth&&
("auto"==B.overflowX||"scroll"==B.overflowX)||b.clientHeight<b.scrollHeight&&("auto"==B.overflowY||"scroll"==B.overflowY)){if(!b.getBoundingClientRect||b===document.body)break;if(n||m)return b;n=!0}}while(b=b.parentNode);return Q()}function D(b,m){return Math.round(b.top)===Math.round(m.top)&&Math.round(b.left)===Math.round(m.left)&&Math.round(b.height)===Math.round(m.height)&&Math.round(b.width)===Math.round(m.width)}function X(b,m){return function(){if(!va){var n=arguments;1===n.length?b.call(this,
n[0]):b.apply(this,n);va=setTimeout(function(){va=void 0},m)}}}function ba(b,m,n){b.scrollLeft+=m;b.scrollTop+=n}function ia(b){var m=window.Polymer,n=window.jQuery||window.Zepto;return m&&m.dom?m.dom(b).cloneNode(!0):n?n(b).clone(!0)[0]:b.cloneNode(!0)}function L(){var b=[],m;return{captureAnimationState:function(){b=[];this.options.animation&&[].slice.call(this.el.children).forEach(function(n){if("none"!==l(n,"display")&&n!==c.ghost){b.push({target:n,rect:N(n)});var B=a({},b[b.length-1].rect);if(n.thisAnimationDuration){var S=
w(n,!0);S&&(B.top-=S.f,B.left-=S.e)}n.fromRect=B}})},addAnimationState:function(n){b.push(n)},removeAnimationState:function(n){b.splice(M(b,{target:n}),1)},animateAll:function(n){var B=this;if(this.options.animation){var S=!1,ca=0;b.forEach(function(fa){var qa=0,sa=fa.target,xa=sa.fromRect,ya=N(sa),Ca=sa.prevFromRect,La=sa.prevToRect;fa=fa.rect;var Ja=w(sa,!0);Ja&&(ya.top-=Ja.f,ya.left-=Ja.e);sa.toRect=ya;sa.thisAnimationDuration&&D(Ca,ya)&&!D(xa,ya)&&(fa.top-ya.top)/(fa.left-ya.left)===(xa.top-ya.top)/
(xa.left-ya.left)&&(qa=Math.sqrt(Math.pow(Ca.top-fa.top,2)+Math.pow(Ca.left-fa.left,2))/Math.sqrt(Math.pow(Ca.top-La.top,2)+Math.pow(Ca.left-La.left,2))*B.options.animation);D(ya,xa)||(sa.prevFromRect=xa,sa.prevToRect=ya,qa||(qa=B.options.animation),B.animate(sa,fa,ya,qa));qa&&(S=!0,ca=Math.max(ca,qa),clearTimeout(sa.animationResetTimer),sa.animationResetTimer=setTimeout(function(){sa.animationTime=0;sa.prevFromRect=null;sa.fromRect=null;sa.prevToRect=null;sa.thisAnimationDuration=null},qa),sa.thisAnimationDuration=
qa)});clearTimeout(m);S?m=setTimeout(function(){"function"===typeof n&&n()},ca):"function"===typeof n&&n();b=[]}else clearTimeout(m),"function"===typeof n&&n()},animate:function(n,B,S,ca){if(ca){l(n,"transition","");l(n,"transform","");var fa=w(this.el),qa=(B.left-S.left)/(fa&&fa.a||1);B=(B.top-S.top)/(fa&&fa.d||1);n.animatingX=!!qa;n.animatingY=!!B;l(n,"transform","translate3d("+qa+"px,"+B+"px,0)");this.forRepaintDummy=n.offsetWidth;l(n,"transition","transform "+ca+"ms"+(this.options.easing?" "+
this.options.easing:""));l(n,"transform","translate3d(0,0,0)");"number"===typeof n.animated&&clearTimeout(n.animated);n.animated=setTimeout(function(){l(n,"transition","");l(n,"transform","");n.animated=!1;n.animatingX=!1;n.animatingY=!1},ca)}}}}function J(b){var m=a({putSortable:Ia,cloneEl:ma,targetEl:E,rootEl:I,oldIndex:Ga,oldDraggableIndex:Za,newIndex:Ma,newDraggableIndex:Ta},b);b=m.sortable;var n=m.rootEl,B=m.name,S=m.targetEl,ca=m.cloneEl,fa=m.toEl,qa=m.fromEl,sa=m.oldIndex,xa=m.newIndex,ya=
m.oldDraggableIndex,Ca=m.newDraggableIndex,La=m.originalEvent,Ja=m.putSortable,Na=m.extraEventProperties;if(b=b||n&&n[ta]){var Ha=b.options,Qa="on"+B.charAt(0).toUpperCase()+B.substr(1);!window.CustomEvent||ua||la?(m=document.createEvent("Event"),m.initEvent(B,!0,!0)):m=new CustomEvent(B,{bubbles:!0,cancelable:!0});m.to=fa||n;m.from=qa||n;m.item=S||n;m.clone=ca;m.oldIndex=sa;m.newIndex=xa;m.oldDraggableIndex=ya;m.newDraggableIndex=Ca;m.originalEvent=La;m.pullMode=Ja?Ja.lastPutMode:void 0;B=a(a({},
Na),aa.getEventProperties(B,b));for(var Ra in B)m[Ra]=B[Ra];n&&n.dispatchEvent(m);Ha[Qa]&&Ha[Qa].call(b,m)}}function c(b,m){if(!b||!b.nodeType||1!==b.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(b));this.el=b;this.options=m=q({},m);b[ta]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(b.nodeName)?"\x3eli":"\x3e*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Bb(b,
this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(ca,fa){ca.setData("Text",fa.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,
y:0},supportPointer:!1!==c.supportPointer&&"PointerEvent"in window&&!Ea,emptyInsertThreshold:5};aa.initializePlugins(this,b,n);for(var B in n)B in m||(m[B]=n[B]);Cb(m);for(var S in this)"_"===S.charAt(0)&&"function"===typeof this[S]&&(this[S]=this[S].bind(this));if(this.nativeDraggable=m.forceFallback?!1:Lb)this.options.touchStartThreshold=1;m.supportPointer?k(b,"pointerdown",this._onTapStart):(k(b,"mousedown",this._onTapStart),k(b,"touchstart",this._onTapStart));this.nativeDraggable&&(k(b,"dragover",
this),k(b,"dragenter",this));kb.push(this.el);m.store&&m.store.get&&this.sort(m.store.get(this)||[]);q(this,L())}function d(b,m,n,B,S,ca,fa,qa){var sa=b[ta],xa=sa.options.onMove,ya;if(!window.CustomEvent||ua||la){var Ca=document.createEvent("Event");Ca.initEvent("move",!0,!0)}else Ca=new CustomEvent("move",{bubbles:!0,cancelable:!0});Ca.to=m;Ca.from=b;Ca.dragged=n;Ca.draggedRect=B;Ca.related=S||m;Ca.relatedRect=ca||N(m);Ca.willInsertAfter=qa;Ca.originalEvent=fa;b.dispatchEvent(Ca);xa&&(ya=xa.call(sa,
Ca,fa));return ya}function g(b){b.draggable=!1}function r(){sb=!1}function K(b,m,n){n=N(A(n.el,0,n.options,!0));return m?b.clientX<n.left-10||b.clientY<n.top&&b.clientX<n.right:b.clientY<n.top-10||b.clientY<n.bottom&&b.clientX<n.left}function V(b,m,n){n=N(G(n.el,n.options.draggable));return m?b.clientX>n.right+10||b.clientX<=n.right&&b.clientY>n.bottom&&b.clientX>=n.left:b.clientX>n.right&&b.clientY>n.top||b.clientX<=n.right&&b.clientY>n.bottom+10}function O(b,m,n,B,S,ca,fa,qa){b=B?b.clientY:b.clientX;
var sa=B?n.height:n.width,xa=B?n.top:n.left;n=B?n.bottom:n.right;B=!1;if(!fa)if(qa&&lb<sa*S)if(!gb&&(1===hb?b>xa+sa*ca/2:b<n-sa*ca/2)&&(gb=!0),gb)B=!0;else{if(1===hb?b<xa+lb:b>n-lb)return-hb}else if(b>xa+sa*(1-S)/2&&b<n-sa*(1-S)/2)return m=H(E)<H(m)?1:-1,m;if(B||fa)if(b<xa+sa*ca/2||b>n-sa*ca/2)return b>xa+sa/2?1:-1;return 0}function ja(b){b=b.tagName+b.className+b.src+b.href+b.textContent;for(var m=b.length,n=0;m--;)n+=b.charCodeAt(m);return n.toString(36)}function pa(b){mb.length=0;b=b.getElementsByTagName("input");
for(var m=b.length;m--;){var n=b[m];n.checked&&mb.push(n)}}function wa(b){return setTimeout(b,0)}function ka(){Ka.forEach(function(b){clearInterval(b.pid)});Ka=[]}function ra(){}function za(){}var ua=t(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),la=t(/Edge/i),Da=t(/firefox/i),Ea=t(/safari/i)&&!t(/chrome/i)&&!t(/android/i),Aa=t(/iP(ad|od|hone)/i),Z=t(/chrome/i)&&t(/android/i),ha={capture:!1,passive:!1},ea=/\s+/g,va,ta="Sortable"+(new Date).getTime(),Ba=[],z={initializeByDefault:!0},aa=
{mount:function(b){for(var m in z)!z.hasOwnProperty(m)||m in b||(b[m]=z[m]);Ba.forEach(function(n){if(n.pluginName===b.pluginName)throw"Sortable: Cannot mount plugin ".concat(b.pluginName," more than once");});Ba.push(b)},pluginEvent:function(b,m,n){var B=this;this.eventCanceled=!1;n.cancel=function(){B.eventCanceled=!0};var S=b+"Global";Ba.forEach(function(ca){if(m[ca.pluginName]){if(m[ca.pluginName][S])m[ca.pluginName][S](a({sortable:m},n));if(m.options[ca.pluginName]&&m[ca.pluginName][b])m[ca.pluginName][b](a({sortable:m},
n))}})},initializePlugins:function(b,m,n,B){Ba.forEach(function(ca){var fa=ca.pluginName;if(b.options[fa]||ca.initializeByDefault)ca=new ca(b,m,b.options),ca.sortable=b,ca.options=b.options,b[fa]=ca,q(n,ca.defaults)});for(var S in b.options)b.options.hasOwnProperty(S)&&(B=this.modifyOption(b,S,b.options[S]),"undefined"!==typeof B&&(b.options[S]=B))},getEventProperties:function(b,m){var n={};Ba.forEach(function(B){"function"===typeof B.eventProperties&&q(n,B.eventProperties.call(m[B.pluginName],b))});
return n},modifyOption:function(b,m,n){var B;Ba.forEach(function(S){b[S.pluginName]&&S.optionListeners&&"function"===typeof S.optionListeners[m]&&(B=S.optionListeners[m].call(b[S.pluginName],n))});return B}},R=["evt"],P=function(b,m){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},B=n.evt;n=y(n,R);aa.pluginEvent.bind(c)(b,m,a({dragEl:E,parentEl:U,ghostEl:p,rootEl:I,nextEl:da,lastDownEl:na,cloneEl:ma,cloneHidden:oa,dragStarted:ib,putSortable:Ia,activeSortable:c.active,originalEvent:B,
oldIndex:Ga,oldDraggableIndex:Za,newIndex:Ma,newDraggableIndex:Ta,hideGhostForTarget:Db,unhideGhostForTarget:Eb,cloneNowHidden:function(){oa=!0},cloneNowShown:function(){oa=!1},dispatchSortableEvent:function(S){J({sortable:m,name:S,originalEvent:B})}},n))},E,U,p,I,da,na,ma,oa,Ga,Ma,Za,Ta,cb,Ia,Ua=!1,db=!1,kb=[],ab,Sa,tb,ub,Fb,Gb,ib,eb,hb,gb=!1,nb=!1,lb,Oa,vb=[],sb=!1,mb=[],ob="undefined"!==typeof document,Hb=la||ua?"cssFloat":"float",Lb=ob&&!Z&&!Aa&&"draggable"in document.createElement("div"),Ib=
function(){if(ob){if(ua)return!1;var b=document.createElement("x");b.style.cssText="pointer-events:auto";return"auto"===b.style.pointerEvents}}(),Bb=function(b,m){var n=l(b),B=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),S=A(b,0,m);b=A(b,1,m);var ca=S&&l(S);m=b&&l(b);var fa=ca&&parseInt(ca.marginLeft)+parseInt(ca.marginRight)+N(S).width,qa=m&&parseInt(m.marginLeft)+parseInt(m.marginRight)+N(b).width;return"flex"===n.display?
"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal":"grid"===n.display?1>=n.gridTemplateColumns.split(" ").length?"vertical":"horizontal":S&&ca["float"]&&"none"!==ca["float"]?(n="left"===ca["float"]?"left":"right",!b||"both"!==m.clear&&m.clear!==n?"horizontal":"vertical"):S&&("block"===ca.display||"flex"===ca.display||"table"===ca.display||"grid"===ca.display||fa>=B&&"none"===n[Hb]||b&&"none"===n[Hb]&&fa+qa>B)?"vertical":"horizontal"},Mb=function(b,m,n){var B=n?
b.left:b.top,S=n?b.right:b.bottom;b=n?b.width:b.height;var ca=n?m.left:m.top,fa=n?m.right:m.bottom;m=n?m.width:m.height;return B===ca||S===fa||B+b/2===ca+m/2},Nb=function(b,m){var n;kb.some(function(B){var S=B[ta].options.emptyInsertThreshold;if(S&&!G(B)){var ca=N(B),fa=m>=ca.top-S&&m<=ca.bottom+S;if(b>=ca.left-S&&b<=ca.right+S&&fa)return n=B}});return n},Cb=function(b){function m(S,ca){return function(fa,qa,sa,xa){var ya=fa.options.group.name&&qa.options.group.name&&fa.options.group.name===qa.options.group.name;
if(null==S&&(ca||ya))return!0;if(null==S||!1===S)return!1;if(ca&&"clone"===S)return S;if("function"===typeof S)return m(S(fa,qa,sa,xa),ca)(fa,qa,sa,xa);fa=(ca?fa:qa).options.group.name;return!0===S||"string"===typeof S&&S===fa||S.join&&-1<S.indexOf(fa)}}var n={},B=b.group;B&&"object"==u(B)||(B={name:B});n.name=B.name;n.checkPull=m(B.pull,!0);n.checkPut=m(B.put);n.revertClone=B.revertClone;b.group=n},Db=function(){!Ib&&p&&l(p,"display","none")},Eb=function(){!Ib&&p&&l(p,"display","")};ob&&!Z&&document.addEventListener("click",
function(b){if(db)return b.preventDefault(),b.stopPropagation&&b.stopPropagation(),b.stopImmediatePropagation&&b.stopImmediatePropagation(),db=!1},!0);var bb=function(b){if(E){b=b.touches?b.touches[0]:b;var m=Nb(b.clientX,b.clientY);if(m){var n={},B;for(B in b)b.hasOwnProperty(B)&&(n[B]=b[B]);n.target=n.rootEl=m;n.preventDefault=void 0;n.stopPropagation=void 0;m[ta]._onDragOver(n)}}},Ob=function(b){E&&E.parentNode[ta]._isOutsideThisEl(b.target)};c.prototype={constructor:c,_isOutsideThisEl:function(b){this.el.contains(b)||
b===this.el||(eb=null)},_getDirection:function(b,m){return"function"===typeof this.options.direction?this.options.direction.call(this,b,m,E):this.options.direction},_onTapStart:function(b){if(b.cancelable){var m=this,n=this.el,B=this.options,S=B.preventOnFilter,ca=b.type,fa=b.touches&&b.touches[0]||b.pointerType&&"touch"===b.pointerType&&b,qa=(fa||b).target,sa=b.target.shadowRoot&&(b.path&&b.path[0]||b.composedPath&&b.composedPath()[0])||qa,xa=B.filter;pa(n);if(!(E||/mousedown|pointerdown/.test(ca)&&
0!==b.button||B.disabled||sa.isContentEditable||!this.nativeDraggable&&Ea&&qa&&"SELECT"===qa.tagName.toUpperCase()||(qa=f(qa,B.draggable,n,!1),qa&&qa.animated||na===qa))){Ga=H(qa);Za=H(qa,B.draggable);if("function"===typeof xa){if(xa.call(this,b,qa,this)){J({sortable:m,rootEl:sa,name:"filter",targetEl:qa,toEl:n,fromEl:n});P("filter",m,{evt:b});S&&b.cancelable&&b.preventDefault();return}}else if(xa&&(xa=xa.split(",").some(function(ya){if(ya=f(sa,ya.trim(),n,!1))return J({sortable:m,rootEl:ya,name:"filter",
targetEl:qa,fromEl:n,toEl:n}),P("filter",m,{evt:b}),!0}))){S&&b.cancelable&&b.preventDefault();return}B.handle&&!f(sa,B.handle,n,!1)||this._prepareDragStart(b,fa,qa)}}},_prepareDragStart:function(b,m,n){var B=this,S=B.el,ca=B.options,fa=S.ownerDocument;if(n&&!E&&n.parentNode===S){var qa=N(n);I=S;E=n;U=E.parentNode;da=E.nextSibling;na=n;cb=ca.group;c.dragged=E;ab={target:E,clientX:(m||b).clientX,clientY:(m||b).clientY};Fb=ab.clientX-qa.left;Gb=ab.clientY-qa.top;this._lastX=(m||b).clientX;this._lastY=
(m||b).clientY;E.style["will-change"]="all";n=function(){P("delayEnded",B,{evt:b});c.eventCanceled?B._onDrop():(B._disableDelayedDragEvents(),!Da&&B.nativeDraggable&&(E.draggable=!0),B._triggerDragStart(b,m),J({sortable:B,name:"choose",originalEvent:b}),h(E,ca.chosenClass,!0))};ca.ignore.split(",").forEach(function(sa){F(E,sa.trim(),g)});k(fa,"dragover",bb);k(fa,"mousemove",bb);k(fa,"touchmove",bb);k(fa,"mouseup",B._onDrop);k(fa,"touchend",B._onDrop);k(fa,"touchcancel",B._onDrop);Da&&this.nativeDraggable&&
(this.options.touchStartThreshold=4,E.draggable=!0);P("delayStart",this,{evt:b});!ca.delay||ca.delayOnTouchOnly&&!m||this.nativeDraggable&&(la||ua)?n():c.eventCanceled?this._onDrop():(k(fa,"mouseup",B._disableDelayedDrag),k(fa,"touchend",B._disableDelayedDrag),k(fa,"touchcancel",B._disableDelayedDrag),k(fa,"mousemove",B._delayedDragTouchMoveHandler),k(fa,"touchmove",B._delayedDragTouchMoveHandler),ca.supportPointer&&k(fa,"pointermove",B._delayedDragTouchMoveHandler),B._dragStartTimer=setTimeout(n,
ca.delay))}},_delayedDragTouchMoveHandler:function(b){b=b.touches?b.touches[0]:b;Math.max(Math.abs(b.clientX-this._lastX),Math.abs(b.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){E&&g(E);clearTimeout(this._dragStartTimer);this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var b=this.el.ownerDocument;v(b,"mouseup",this._disableDelayedDrag);v(b,"touchend",
this._disableDelayedDrag);v(b,"touchcancel",this._disableDelayedDrag);v(b,"mousemove",this._delayedDragTouchMoveHandler);v(b,"touchmove",this._delayedDragTouchMoveHandler);v(b,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(b,m){m=m||"touch"==b.pointerType&&b;!this.nativeDraggable||m?this.options.supportPointer?k(document,"pointermove",this._onTouchMove):m?k(document,"touchmove",this._onTouchMove):k(document,"mousemove",this._onTouchMove):(k(E,"dragend",this),k(I,"dragstart",
this._onDragStart));try{document.selection?wa(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(n){}},_dragStarted:function(b,m){Ua=!1;if(I&&E){P("dragStarted",this,{evt:m});this.nativeDraggable&&k(document,"dragover",Ob);var n=this.options;!b&&h(E,n.dragClass,!1);h(E,n.ghostClass,!0);c.active=this;b&&this._appendGhost();J({sortable:this,name:"start",originalEvent:m})}else this._nulling()},_emulateDragOver:function(){if(Sa){this._lastX=Sa.clientX;this._lastY=Sa.clientY;
Db();for(var b=document.elementFromPoint(Sa.clientX,Sa.clientY),m=b;b&&b.shadowRoot;){b=b.shadowRoot.elementFromPoint(Sa.clientX,Sa.clientY);if(b===m)break;m=b}E.parentNode[ta]._isOutsideThisEl(b);if(m){do{if(m[ta]){var n=void 0;if((n=m[ta]._onDragOver({clientX:Sa.clientX,clientY:Sa.clientY,target:b,rootEl:m}))&&!this.options.dragoverBubble)break}b=m}while(m=m.parentNode)}Eb()}},_onTouchMove:function(b){if(ab){var m=this.options,n=m.fallbackTolerance,B=m.fallbackOffset;m=b.touches?b.touches[0]:b;
var S=p&&w(p,!0),ca=p&&S&&S.a,fa=p&&S&&S.d,qa=Aa&&Oa&&Y(Oa);ca=(m.clientX-ab.clientX+B.x)/(ca||1)+(qa?qa[0]-vb[0]:0)/(ca||1);B=(m.clientY-ab.clientY+B.y)/(fa||1)+(qa?qa[1]-vb[1]:0)/(fa||1);if(!c.active&&!Ua){if(n&&Math.max(Math.abs(m.clientX-this._lastX),Math.abs(m.clientY-this._lastY))<n)return;this._onDragStart(b,!0)}p&&(S?(S.e+=ca-(tb||0),S.f+=B-(ub||0)):S={a:1,b:0,c:0,d:1,e:ca,f:B},n="matrix(".concat(S.a,",").concat(S.b,",").concat(S.c,",").concat(S.d,",").concat(S.e,",").concat(S.f,")"),l(p,
"webkitTransform",n),l(p,"mozTransform",n),l(p,"msTransform",n),l(p,"transform",n),tb=ca,ub=B,Sa=m);b.cancelable&&b.preventDefault()}},_appendGhost:function(){if(!p){var b=this.options.fallbackOnBody?document.body:I,m=N(E,!0,Aa,!0,b),n=this.options;if(Aa){for(Oa=b;"static"===l(Oa,"position")&&"none"===l(Oa,"transform")&&Oa!==document;)Oa=Oa.parentNode;Oa!==document.body&&Oa!==document.documentElement?(Oa===document&&(Oa=Q()),m.top+=Oa.scrollTop,m.left+=Oa.scrollLeft):Oa=Q();vb=Y(Oa)}p=E.cloneNode(!0);
h(p,n.ghostClass,!1);h(p,n.fallbackClass,!0);h(p,n.dragClass,!0);l(p,"transition","");l(p,"transform","");l(p,"box-sizing","border-box");l(p,"margin",0);l(p,"top",m.top);l(p,"left",m.left);l(p,"width",m.width);l(p,"height",m.height);l(p,"opacity","0.8");l(p,"position",Aa?"absolute":"fixed");l(p,"zIndex","100000");l(p,"pointerEvents","none");c.ghost=p;b.appendChild(p);l(p,"transform-origin",Fb/parseInt(p.style.width)*100+"% "+Gb/parseInt(p.style.height)*100+"%")}},_onDragStart:function(b,m){var n=
this,B=b.dataTransfer,S=n.options;P("dragStart",this,{evt:b});c.eventCanceled?this._onDrop():(P("setupClone",this),c.eventCanceled||(ma=ia(E),ma.removeAttribute("id"),ma.draggable=!1,ma.style["will-change"]="",this._hideClone(),h(ma,this.options.chosenClass,!1),c.clone=ma),n.cloneId=wa(function(){P("clone",n);c.eventCanceled||(n.options.removeCloneOnHide||I.insertBefore(ma,E),n._hideClone(),J({sortable:n,name:"clone"}))}),!m&&h(E,S.dragClass,!0),m?(db=!0,n._loopId=setInterval(n._emulateDragOver,50)):
(v(document,"mouseup",n._onDrop),v(document,"touchend",n._onDrop),v(document,"touchcancel",n._onDrop),B&&(B.effectAllowed="move",S.setData&&S.setData.call(n,B,E)),k(document,"drop",n),l(E,"transform","translateZ(0)")),Ua=!0,n._dragStartId=wa(n._dragStarted.bind(n,m,b)),k(document,"selectstart",n),ib=!0,Ea&&l(document.body,"user-select","none"))},_onDragOver:function(b){function m($a,pb){P($a,Ha,a({evt:b,isOwner:La,axis:Ra?"vertical":"horizontal",revert:sa,dragRect:Va,targetRect:qa,canSort:Ja,fromSortable:Na,
target:fa,completed:B,onMove:function(Jb,Pb){return d(I,ca,E,Va,Jb,N(Jb),b,Pb)},changed:S},pb))}function n(){m("dragOverAnimationCapture");Ha.captureAnimationState();Ha!==Na&&Na.captureAnimationState()}function B($a){m("dragOverCompleted",{insertion:$a});$a&&(La?Ca._hideClone():Ca._showClone(Ha),Ha!==Na&&(h(E,Ia?Ia.options.ghostClass:Ca.options.ghostClass,!1),h(E,xa.ghostClass,!0)),Ia!==Ha&&Ha!==c.active?Ia=Ha:Ha===c.active&&Ia&&(Ia=null),Na===Ha&&(Ha._ignoreWhileAnimating=fa),Ha.animateAll(function(){m("dragOverAnimationComplete");
Ha._ignoreWhileAnimating=null}),Ha!==Na&&(Na.animateAll(),Na._ignoreWhileAnimating=null));if(fa===E&&!E.animated||fa===ca&&!fa.animated)eb=null;xa.dragoverBubble||b.rootEl||fa===document||(E.parentNode[ta]._isOutsideThisEl(b.target),!$a&&bb(b));!xa.dragoverBubble&&b.stopPropagation&&b.stopPropagation();return Qa=!0}function S(){Ma=H(E);Ta=H(E,xa.draggable);J({sortable:Ha,name:"change",toEl:ca,newIndex:Ma,newDraggableIndex:Ta,originalEvent:b})}var ca=this.el,fa=b.target,qa,sa,xa=this.options,ya=xa.group,
Ca=c.active,La=cb===ya,Ja=xa.sort,Na=Ia||Ca,Ha=this,Qa=!1;if(!sb){void 0!==b.preventDefault&&b.cancelable&&b.preventDefault();fa=f(fa,xa.draggable,ca,!0);m("dragOver");if(c.eventCanceled)return Qa;if(E.contains(b.target)||fa.animated&&fa.animatingX&&fa.animatingY||Ha._ignoreWhileAnimating===fa)return B(!1);db=!1;if(Ca&&!xa.disabled&&(La?Ja||(sa=U!==I):Ia===this||(this.lastPutMode=cb.checkPull(this,Ca,E,b))&&ya.checkPut(this,Ca,E,b))){var Ra="vertical"===this._getDirection(b,fa);var Va=N(E);m("dragOverValid");
if(c.eventCanceled)return Qa;if(sa)return U=I,n(),this._hideClone(),m("revert"),c.eventCanceled||(da?I.insertBefore(E,da):I.appendChild(E)),B(!0);ya=G(ca,xa.draggable);if(!ya||V(b,Ra,this)&&!ya.animated){if(ya===E)return B(!1);ya&&ca===b.target&&(fa=ya);fa&&(qa=N(fa));if(!1!==d(I,ca,E,Va,fa,qa,b,!!fa))return n(),ya&&ya.nextSibling?ca.insertBefore(E,ya.nextSibling):ca.appendChild(E),U=ca,S(),B(!0)}else if(ya&&K(b,Ra,this)){var Wa=A(ca,0,xa,!0);if(Wa===E)return B(!1);fa=Wa;qa=N(fa);if(!1!==d(I,ca,E,
Va,fa,qa,b,!1))return n(),ca.insertBefore(E,Wa),U=ca,S(),B(!0)}else if(fa.parentNode===ca){qa=N(fa);var Fa=0;Fa=E.parentNode!==ca;var Pa=!Mb(E.animated&&E.toRect||Va,fa.animated&&fa.toRect||qa,Ra);ya=Ra?"top":"left";var Ya=W(fa,"top","top")||W(E,"top","top"),qb=Ya?Ya.scrollTop:void 0;eb!==fa&&(Wa=qa[ya],gb=!1,nb=!Pa&&xa.invertSwap||Fa);Fa=O(b,fa,qa,Ra,Pa?1:xa.swapThreshold,null==xa.invertedSwapThreshold?xa.swapThreshold:xa.invertedSwapThreshold,nb,eb===fa);if(0!==Fa){Pa=H(E);do{Pa-=Fa;var Xa=U.children[Pa]}while(Xa&&
("none"===l(Xa,"display")||Xa===p))}if(0===Fa||Xa===fa)return B(!1);eb=fa;hb=Fa;Xa=fa.nextElementSibling;Pa=!1;Pa=1===Fa;Fa=d(I,ca,E,Va,fa,qa,b,Pa);if(!1!==Fa){if(1===Fa||-1===Fa)Pa=1===Fa;sb=!0;setTimeout(r,30);n();Pa&&!Xa?ca.appendChild(E):fa.parentNode.insertBefore(E,Pa?Xa:fa);Ya&&ba(Ya,0,qb-Ya.scrollTop);U=E.parentNode;void 0===Wa||nb||(lb=Math.abs(Wa-N(fa)[ya]));S();return B(!0)}}if(ca.contains(E))return B(!1)}return!1}},_ignoreWhileAnimating:null,_offMoveEvents:function(){v(document,"mousemove",
this._onTouchMove);v(document,"touchmove",this._onTouchMove);v(document,"pointermove",this._onTouchMove);v(document,"dragover",bb);v(document,"mousemove",bb);v(document,"touchmove",bb)},_offUpEvents:function(){var b=this.el.ownerDocument;v(b,"mouseup",this._onDrop);v(b,"touchend",this._onDrop);v(b,"pointerup",this._onDrop);v(b,"touchcancel",this._onDrop);v(document,"selectstart",this)},_onDrop:function(b){var m=this.el,n=this.options;Ma=H(E);Ta=H(E,n.draggable);P("drop",this,{evt:b});U=E&&E.parentNode;
Ma=H(E);Ta=H(E,n.draggable);if(!c.eventCanceled&&(gb=nb=Ua=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),clearTimeout(this.cloneId),clearTimeout(this._dragStartId),this.nativeDraggable&&(v(document,"drop",this),v(m,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Ea&&l(document.body,"user-select",""),l(E,"transform",""),b&&(ib&&(b.cancelable&&b.preventDefault(),!n.dropBubble&&b.stopPropagation()),p&&p.parentNode&&p.parentNode.removeChild(p),(I===U||Ia&&
"clone"!==Ia.lastPutMode)&&ma&&ma.parentNode&&ma.parentNode.removeChild(ma),E&&(this.nativeDraggable&&v(E,"dragend",this),g(E),E.style["will-change"]="",ib&&!Ua&&h(E,Ia?Ia.options.ghostClass:this.options.ghostClass,!1),h(E,this.options.chosenClass,!1),J({sortable:this,name:"unchoose",toEl:U,newIndex:null,newDraggableIndex:null,originalEvent:b}),I!==U?(0<=Ma&&(J({rootEl:U,name:"add",toEl:U,fromEl:I,originalEvent:b}),J({sortable:this,name:"remove",toEl:U,originalEvent:b}),J({rootEl:U,name:"sort",toEl:U,
fromEl:I,originalEvent:b}),J({sortable:this,name:"sort",toEl:U,originalEvent:b})),Ia&&Ia.save()):Ma!==Ga&&0<=Ma&&(J({sortable:this,name:"update",toEl:U,originalEvent:b}),J({sortable:this,name:"sort",toEl:U,originalEvent:b})),c.active)))){if(null==Ma||-1===Ma)Ma=Ga,Ta=Za;J({sortable:this,name:"end",toEl:U,originalEvent:b});this.save()}this._nulling()},_nulling:function(){P("nulling",this);I=E=U=p=da=ma=na=oa=ab=Sa=ib=Ma=Ta=Ga=Za=eb=hb=Ia=cb=c.dragged=c.ghost=c.clone=c.active=null;mb.forEach(function(b){b.checked=
!0});mb.length=tb=ub=0},handleEvent:function(b){switch(b.type){case "drop":case "dragend":this._onDrop(b);break;case "dragenter":case "dragover":E&&(this._onDragOver(b),b.dataTransfer&&(b.dataTransfer.dropEffect="move"),b.cancelable&&b.preventDefault());break;case "selectstart":b.preventDefault()}},toArray:function(){for(var b=[],m,n=this.el.children,B=0,S=n.length,ca=this.options;B<S;B++)m=n[B],f(m,ca.draggable,this.el,!1)&&b.push(m.getAttribute(ca.dataIdAttr)||ja(m));return b},sort:function(b,m){var n=
{},B=this.el;this.toArray().forEach(function(S,ca){ca=B.children[ca];f(ca,this.options.draggable,B,!1)&&(n[S]=ca)},this);m&&this.captureAnimationState();b.forEach(function(S){n[S]&&(B.removeChild(n[S]),B.appendChild(n[S]))});m&&this.animateAll()},save:function(){var b=this.options.store;b&&b.set&&b.set(this)},closest:function(b,m){return f(b,m||this.options.draggable,this.el,!1)},option:function(b,m){var n=this.options;if(void 0===m)return n[b];var B=aa.modifyOption(this,b,m);n[b]="undefined"!==typeof B?
B:m;"group"===b&&Cb(n)},destroy:function(){P("destroy",this);var b=this.el;b[ta]=null;v(b,"mousedown",this._onTapStart);v(b,"touchstart",this._onTapStart);v(b,"pointerdown",this._onTapStart);this.nativeDraggable&&(v(b,"dragover",this),v(b,"dragenter",this));Array.prototype.forEach.call(b.querySelectorAll("[draggable]"),function(m){m.removeAttribute("draggable")});this._onDrop();this._disableDelayedDragEvents();kb.splice(kb.indexOf(this.el),1);this.el=b=null},_hideClone:function(){oa||(P("hideClone",
this),c.eventCanceled||(l(ma,"display","none"),this.options.removeCloneOnHide&&ma.parentNode&&ma.parentNode.removeChild(ma),oa=!0))},_showClone:function(b){"clone"!==b.lastPutMode?this._hideClone():oa&&(P("showClone",this),c.eventCanceled||(E.parentNode!=I||this.options.group.revertClone?da?I.insertBefore(ma,da):I.appendChild(ma):I.insertBefore(ma,E),this.options.group.revertClone&&this.animate(E,ma),l(ma,"display",""),oa=!1))}};ob&&k(document,"touchmove",function(b){(c.active||Ua)&&b.cancelable&&
b.preventDefault()});c.utils={on:k,off:v,css:l,find:F,is:function(b,m){return!!f(b,m,b,!1)},extend:function(b,m){if(b&&m)for(var n in m)m.hasOwnProperty(n)&&(b[n]=m[n]);return b},throttle:X,closest:f,toggleClass:h,clone:ia,index:H,nextTick:wa,cancelNextTick:function(b){return clearTimeout(b)},detectDirection:Bb,getChild:A};c.get=function(b){return b[ta]};c.mount=function(){for(var b=arguments.length,m=Array(b),n=0;n<b;n++)m[n]=arguments[n];m[0].constructor===Array&&(m=m[0]);m.forEach(function(B){if(!B.prototype||
!B.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(B));B.utils&&(c.utils=a(a({},c.utils),B.utils));aa.mount(B)})};c.create=function(b,m){return new c(b,m)};c.version="1.15.0";var Ka=[],jb,wb,xb=!1,yb,zb,rb,fb,Ab=X(function(b,m,n,B){if(m.scroll){var S=(b.touches?b.touches[0]:b).clientX,ca=(b.touches?b.touches[0]:b).clientY,fa=m.scrollSensitivity,qa=m.scrollSpeed,sa=Q(),xa=!1;if(wb!==n){wb=n;ka();jb=m.scroll;var ya=m.scrollFn;!0===jb&&
(jb=C(n,!0))}n=0;var Ca=jb;do{var La=Ca,Ja=N(La),Na=Ja.top,Ha=Ja.bottom,Qa=Ja.left,Ra=Ja.right,Va=Ja.width;Ja=Ja.height;var Wa=void 0,Fa=void 0,Pa=La.scrollWidth,Ya=La.scrollHeight;Fa=l(La);var qb=La.scrollLeft,Xa=La.scrollTop;La===sa?(Wa=Va<Pa&&("auto"===Fa.overflowX||"scroll"===Fa.overflowX||"visible"===Fa.overflowX),Fa=Ja<Ya&&("auto"===Fa.overflowY||"scroll"===Fa.overflowY||"visible"===Fa.overflowY)):(Wa=Va<Pa&&("auto"===Fa.overflowX||"scroll"===Fa.overflowX),Fa=Ja<Ya&&("auto"===Fa.overflowY||
"scroll"===Fa.overflowY));Qa=Wa&&(Math.abs(Ra-S)<=fa&&qb+Va<Pa)-(Math.abs(Qa-S)<=fa&&!!qb);Na=Fa&&(Math.abs(Ha-ca)<=fa&&Xa+Ja<Ya)-(Math.abs(Na-ca)<=fa&&!!Xa);if(!Ka[n])for(Ha=0;Ha<=n;Ha++)Ka[Ha]||(Ka[Ha]={});if(Ka[n].vx!=Qa||Ka[n].vy!=Na||Ka[n].el!==La)if(Ka[n].el=La,Ka[n].vx=Qa,Ka[n].vy=Na,clearInterval(Ka[n].pid),0!=Qa||0!=Na)xa=!0,Ka[n].pid=setInterval(function(){B&&0===this.layer&&c.active._onTouchMove(rb);var $a=Ka[this.layer].vy?Ka[this.layer].vy*qa:0,pb=Ka[this.layer].vx?Ka[this.layer].vx*
qa:0;"function"===typeof ya&&"continue"!==ya.call(c.dragged.parentNode[ta],pb,$a,b,rb,Ka[this.layer].el)||ba(Ka[this.layer].el,pb,$a)}.bind({layer:n}),24);n++}while(m.bubbleScroll&&Ca!==sa&&(Ca=C(Ca,!1)));xb=xa}},30),Kb=function(b){var m=b.originalEvent,n=b.putSortable,B=b.dragEl,S=b.activeSortable,ca=b.dispatchSortableEvent,fa=b.hideGhostForTarget;b=b.unhideGhostForTarget;m&&(S=n||S,fa(),m=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:m,m=document.elementFromPoint(m.clientX,m.clientY),
b(),S&&!S.el.contains(m)&&(ca("spill"),this.onSpill({dragEl:B,putSortable:n})))};ra.prototype={startIndex:null,dragStart:function(b){this.startIndex=b.oldDraggableIndex},onSpill:function(b){var m=b.dragEl;b=b.putSortable;this.sortable.captureAnimationState();b&&b.captureAnimationState();var n=A(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(m,n):this.sortable.el.appendChild(m);this.sortable.animateAll();b&&b.animateAll()},drop:Kb};q(ra,{pluginName:"revertOnSpill"});
za.prototype={onSpill:function(b){var m=b.dragEl;b=b.putSortable||this.sortable;b.captureAnimationState();m.parentNode&&m.parentNode.removeChild(m);b.animateAll()},drop:Kb};q(za,{pluginName:"removeOnSpill"});c.mount(new function(){function b(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var m in this)"_"===m.charAt(0)&&"function"===typeof this[m]&&(this[m]=this[m].bind(this))}b.prototype={dragStarted:function(m){m=m.originalEvent;this.sortable.nativeDraggable?
k(document,"dragover",this._handleAutoScroll):this.options.supportPointer?k(document,"pointermove",this._handleFallbackAutoScroll):m.touches?k(document,"touchmove",this._handleFallbackAutoScroll):k(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(m){m=m.originalEvent;this.options.dragOverBubble||m.rootEl||this._handleAutoScroll(m)},drop:function(){this.sortable.nativeDraggable?v(document,"dragover",this._handleAutoScroll):(v(document,"pointermove",this._handleFallbackAutoScroll),
v(document,"touchmove",this._handleFallbackAutoScroll),v(document,"mousemove",this._handleFallbackAutoScroll));clearInterval(fb);ka();clearTimeout(va);va=void 0},nulling:function(){rb=wb=jb=xb=fb=yb=zb=null;Ka.length=0},_handleFallbackAutoScroll:function(m){this._handleAutoScroll(m,!0)},_handleAutoScroll:function(m,n){var B=this,S=(m.touches?m.touches[0]:m).clientX,ca=(m.touches?m.touches[0]:m).clientY,fa=document.elementFromPoint(S,ca);rb=m;if(n||this.options.forceAutoScrollFallback||la||ua||Ea){Ab(m,
this.options,fa,n);var qa=C(fa,!0);!xb||fb&&S===yb&&ca===zb||(fb&&clearInterval(fb),fb=setInterval(function(){var sa=C(document.elementFromPoint(S,ca),!0);sa!==qa&&(qa=sa,ka());Ab(m,B.options,sa,n)},10),yb=S,zb=ca)}else this.options.bubbleScroll&&C(fa,!0)!==Q()?Ab(m,this.options,C(fa,!1),!1):ka()}};return q(b,{pluginName:"scroll",initializeByDefault:!0})});c.mount(za,ra);T.Sortable=c})},"esri/layers/GroupLayer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/CollectionFlattener ../core/loadAll ../core/maybe ../core/MultiOriginJSONSupport ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/utils ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ./Layer ./mixins/BlendLayer ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ../support/collectionUtils ../support/LayersMixin ../support/TablesMixin ../webdoc/support/writeUtils".split(" "),
function(T,e,a,u,q,y,t,k,v,x,f,h,l,w,F,Q,N,W,A,G,H,Y,M){y=function(C){function D(ba){var ia=C.call(this,ba)||this;ia._visibilityHandles={};ia.allLayers=new a({getCollections:()=>[ia.layers],getChildrenFunction:L=>"layers"in L?L.layers:null});ia.allTables=G.createFlattenedTablesCollection(T._assertThisInitialized(ia));ia.fullExtent=void 0;ia.operationalLayerType="GroupLayer";ia.spatialReference=void 0;ia.type="group";return ia}T._inheritsLoose(D,C);var X=D.prototype;X.initialize=function(){this._enforceVisibility(this.visibilityMode,
this.visible);this.own(t.watch(()=>this.visible,this._onVisibilityChange.bind(this),t.sync))};X._writeLayers=function(ba,ia,L,J){const c=[];if(!ba)return c;ba.forEach(d=>{d=M.getLayerJSON(d,J.webmap?J.webmap.getLayerJSONFromResourceInfo(d):null,J);q.isSome(d)&&d.layerType&&c.push(d)});ia.layers=c};X.load=function(ba){this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Scene Service"]},ba));return Promise.resolve(this)};X.loadAll=function(){return u.loadAll(this,
ba=>{ba(this.layers,this.tables)})};X.layerAdded=function(ba){ba.visible&&"exclusive"===this.visibilityMode?this._turnOffOtherLayers(ba):"inherited"===this.visibilityMode&&(ba.visible=this.visible);this._visibilityHandles[ba.uid]=t.watch(()=>ba.visible,ia=>this._onChildVisibilityChange(ba,ia),t.sync)};X.layerRemoved=function(ba){const ia=this._visibilityHandles[ba.uid];ia&&(ia.remove(),delete this._visibilityHandles[ba.uid]);this._enforceVisibility(this.visibilityMode,this.visible)};X._turnOffOtherLayers=
function(ba){this.layers.forEach(ia=>{ia!==ba&&(ia.visible=!1)})};X._enforceVisibility=function(ba,ia){if(f.getProperties(this).initialized){var L=this.layers,J=L.find(c=>c.visible);switch(ba){case "exclusive":L.length&&!J&&(J=L.getItemAt(0),J.visible=!0);this._turnOffOtherLayers(J);break;case "inherited":L.forEach(c=>{c.visible=ia})}}};X._onVisibilityChange=function(ba){"inherited"===this.visibilityMode&&this.layers.forEach(ia=>{ia.visible=ba})};X._onChildVisibilityChange=function(ba,ia){switch(this.visibilityMode){case "exclusive":ia?
this._turnOffOtherLayers(ba):this._isAnyLayerVisible()||(ba.visible=!0);break;case "inherited":ba.visible=this.visible}};X._isAnyLayerVisible=function(){return this.layers.some(ba=>ba.visible)};T._createClass(D,[{key:"portalItem",set:function(ba){this._set("portalItem",ba)}},{key:"visibilityMode",set:function(ba){const ia=this._get("visibilityMode")!==ba;this._set("visibilityMode",ba);ia&&this._enforceVisibility(ba,this.visible)}}]);return D}(Q.BlendLayer(A.ScaleRangeLayer(N.OperationalLayer(W.PortalLayer(Y.TablesMixin(H.LayersMixin(y.MultiOriginJSONMixin(F))))))));
e.__decorate([k.property({readOnly:!0,dependsOn:[]})],y.prototype,"allLayers",void 0);e.__decorate([k.property({readOnly:!0})],y.prototype,"allTables",void 0);e.__decorate([k.property()],y.prototype,"fullExtent",void 0);e.__decorate([k.property({json:{read:!1,write:{ignoreOrigin:!0}}})],y.prototype,"layers",void 0);e.__decorate([w.writer("layers")],y.prototype,"_writeLayers",null);e.__decorate([k.property({type:["GroupLayer"]})],y.prototype,"operationalLayerType",void 0);e.__decorate([k.property({json:{origins:{"web-document":{read:!1,
write:!1}}}})],y.prototype,"portalItem",null);e.__decorate([k.property()],y.prototype,"spatialReference",void 0);e.__decorate([k.property({json:{read:!1},readOnly:!0,value:"group"})],y.prototype,"type",void 0);e.__decorate([k.property({type:["independent","inherited","exclusive"],value:"independent",json:{write:!0,origins:{"web-map":{read:!1,write:!1}}}})],y.prototype,"visibilityMode",null);return y=e.__decorate([l.subclass("esri.layers.GroupLayer")],y)})},"app/utils/closeBtn":function(){define(["require",
"exports"],function(T,e){Object.defineProperty(e,"__esModule",{value:!0});e.addCloseBtn=void 0;e.addCloseBtn=function(a,u,q){q.dismissible=!0}})},"app/utils/getUniqueLayerId":function(){define(["require","exports"],function(T,e){Object.defineProperty(e,"__esModule",{value:!0});e.getUniqueLayerId=void 0;e.getUniqueLayerId=function(a){var u=a.layer;a=a.id;return Number.isInteger(a)?(u?u.id+"#":"")+a:a}})},"app/utils/anonymous":function(){define(["require","exports","esri/widgets/support/widget","../utils/learnMoreLink"],
function(T,e,a,u){Object.defineProperty(e,"__esModule",{value:!0});e.getAnonymousInfoElement=void 0;e.getAnonymousInfoElement=function(q,y){var t,k=q.portal.user,v=!(null===(t=q.hideInfos)||void 0===t?0:t.layerList);t=u.getLearnMoreUrl("120002907",q);return v&&!k?a.tsx("article",{class:"anonymous-notice"},a.tsx("calcite-notice",{scale:"s",width:"full",dismissible:!0,active:!0,onCalciteNoticeClose:function(){q.hideInfos={layerList:!0}}},a.tsx("div",{slot:"title"},y.anonymousInfoTitle),a.tsx("div",
{slot:"message"},a.tsx("article",{class:"trailer-half"},y.anonymousInfoMessage1),a.tsx("calcite-link",{target:"_blank",href:t},y.learnMoreMapViewer)))):null}})},"app/utils/learnMoreLink":function(){define(["require","exports","tslib","esri/intl/substitute"],function(T,e,a,u){Object.defineProperty(e,"__esModule",{value:!0});e.getLearnMoreUrl=e.getLearnMoreLink=void 0;u=a.__importStar(u);e.getLearnMoreLink=function(q,y,t){q=e.getLearnMoreUrl(q,t);return u.substitute(y,q)};e.getLearnMoreUrl=function(q,
y){y=y.portal;var t=y.helpMap;return y.helpBase+(t&&(t[q]||t[120002710])||"")}})},"app/widgets/panels/MapMaker/savelayer/copyLayer":function(){define("require exports tslib esri/intl/substitute esri/portal/PortalItem esri/layers/support/layerOriginUtils esri/layers/save/featureLayerUtils ../../../../utils/messageBundleLoader ../../../../utils/topic ../../../../utils/mapUtils/errorUtils".split(" "),function(T,e,a,u,q,y,t,k,v,x){function f(A,G){var H=this;return new Promise(function(Y){return a.__awaiter(H,
void 0,void 0,function(){var M,C,D,X,ba,ia=this;return a.__generator(this,function(L){switch(L.label){case 0:return M=G.portal,C=-1<window.location.href.indexOf("visualization.html"),[4,(new Promise(function(J,c){T(["./SaveLayerAs"],J,c)})).then(a.__importStar)];case 1:return D=L.sent(),X={infoElement:!C},ba=new D.default({sourceLayer:A,visibleElements:X,portal:M}),ba.on("save",function(J){return a.__awaiter(ia,void 0,void 0,function(){var c,d,g,r,K,V;return a.__generator(this,function(O){switch(O.label){case 0:return O.trys.push([0,
3,,4]),c=J.itemProps,(null===(r=c.ownerFolder)||void 0===r?void 0:r.username)===(null===(K=c.ownerFolder)||void 0===K?void 0:K.id)?c.ownerFolder=null:c.ownerFolder=(null===(V=c.ownerFolder)||void 0===V?void 0:V.id)||null,[4,W(G)];case 1:return O.sent(),d=new q.default(c),[4,A.saveAs(d,{folder:c.ownerFolder})];case 2:return O.sent(),ba.close(),w(A),[3,4];case 3:return g=O.sent(),x.showError(g,A.portalItem),ba.close(),[3,4];case 4:return[2]}})})}),ba.on("cancel",function(){return Y(null)}),ba.on("done",
function(){return Y(A)}),[2]}})})})}function h(A,G,H){var Y=this;return new Promise(function(M){return a.__awaiter(Y,void 0,void 0,function(){var C,D,X,ba;return a.__generator(this,function(ia){switch(ia.label){case 0:C=N(A,G);if(!(1<(null===C||void 0===C?void 0:C.length)))return[3,2];D={save:!1,saveas:!1};return[4,(new Promise(function(L,J){T(["./UpdateLayer"],L,J)})).then(a.__importStar)];case 1:return X=ia.sent(),ba=new X.default({portal:H,view:G,layer:A,layers:C}),ba.on("save",function(){D={update:!0,
save:!1};ba.close()}),ba.on("saveas",function(){D={saveas:!0,save:!1};ba.close()}),ba.on("done",function(){return M(D)}),[3,3];case 2:M({save:!0}),ia.label=3;case 3:return[2]}})})})}function l(A,G){var H=this;return new Promise(function(Y){return a.__awaiter(H,void 0,void 0,function(){var M,C,D=this;return a.__generator(this,function(X){switch(X.label){case 0:return M=G.map,C=Q(A,G),[4,Promise.all(C.map(function(ba){return a.__awaiter(D,void 0,void 0,function(){var ia,L,J,c,d;return a.__generator(this,
function(g){switch(g.label){case 0:return ia=ba.clone(),[4,ia.load()];case 1:return g.sent(),ia.id=ba.id,J=(L="group"===(null===(d=ba.parent)||void 0===d?void 0:d.type)?ba.parent:null)?L.layers:M.layers,c=J.indexOf(ba),M.layers.remove(ba),J.add(ia,c),[2]}})})}))];case 1:return X.sent(),Y(!0),[2]}})})})}function w(A){v.default.publish("layer-save-done");v.default.publish("layer-updated");F(A,"saveSuccessMsg")}function F(A,G){return a.__awaiter(this,void 0,void 0,function(){var H,Y;return a.__generator(this,
function(M){switch(M.label){case 0:return[4,k.fetchMessageBundles(["mapviewer/saveLayer"])];case 1:return H=M.sent()[0],Y=u.substitute(H[G],A),v.default.publish("alert/show",{type:"success",message:Y}),[2]}})})}function Q(A,G){return N(A,G).filter(function(H){var Y;if(Y=H.id!==A.id)H=y.getLayerOriginInfo(H,"web-map"),Y="source"===H.status||"mixed"===H.status;return Y})}function N(A,G){var H=A.portalItem.id,Y=A.url+"/"+A.layerId;return(G.map.allLayers||[]).filter(function(M){var C;return"feature"===
M.type&&(null===(C=M.portalItem)||void 0===C?void 0:C.id)===H&&M.url+"/"+M.layerId===Y})}function W(A){return a.__awaiter(this,void 0,void 0,function(){var G,H,Y,M,C;return a.__generator(this,function(D){switch(D.label){case 0:G=A.config.app.contextualPanel;H=G.activeWidget;Y=G.activeActionName;if("layerfilter"!==Y)return[3,2];M=null===G||void 0===G?void 0:G.actionBar;C=M.findAction("layerfilter");return C.active?[4,H.done()]:[3,2];case 1:D.sent(),D.label=2;case 2:return[2]}})})}Object.defineProperty(e,
"__esModule",{value:!0});e.saveLayer=e.saveAllLayers=e.saveLayerAs=e.duplicate=void 0;u=a.__importStar(u);q=a.__importDefault(q);y=a.__importStar(y);t=a.__importStar(t);v=a.__importDefault(v);e.duplicate=function(A,G){return a.__awaiter(this,void 0,void 0,function(){var H,Y;return a.__generator(this,function(M){switch(M.label){case 0:if(!A||!A.clone)return[3,3];H=A.clone();return[4,H.load()];case 1:return M.sent(),[4,k.fetchMessageBundles(["mapviewer/mapMaker"])];case 2:Y=M.sent()[0];H.title=u.substitute(Y.saveAsCopy,
{title:A.title});M=H;var C,D=G.map,X="group"===(null===(C=A.parent)||void 0===C?void 0:C.type)?A.parent:null;C=X?X.layers:(null===M||void 0===M?0:M.isTable)?D.tables:D.layers;D=C.indexOf(A);C.add(M,D+1);v.default.publish("layer-updated");return[2,H];case 3:return[2]}})})};e.saveLayerAs=f;e.saveAllLayers=function(A,G){return a.__awaiter(this,void 0,void 0,function(){var H,Y,M;return a.__generator(this,function(C){switch(C.label){case 0:H=A[0].portalItem,C.label=1;case 1:return C.trys.push([1,4,,5]),
[4,F(H,"saveInProcessMsg")];case 2:return C.sent(),[4,t.saveAll(A)];case 3:return Y=C.sent(),w(H),[2,Y];case 4:return M=C.sent(),x.showError(M,H),[2,Promise.resolve(H)];case 5:return[2]}})})};e.saveLayer=function(A,G,H){return a.__awaiter(this,void 0,void 0,function(){var Y,M;return a.__generator(this,function(C){switch(C.label){case 0:return C.trys.push([0,8,,9]),[4,h(A,G,H)];case 1:return Y=C.sent(),Y.save||Y.update?[4,F(A,"saveInProcessMsg")]:[3,6];case 2:return C.sent(),[4,A.save()];case 3:C.sent();
if(!Y.update)return[3,5];v.default.publish("layer-save-start");return[4,l(A,G)];case 4:C.sent(),C.label=5;case 5:return w(A),[3,7];case 6:if(Y.saveas)return[2,f(A,H)];C.label=7;case 7:return[2,Promise.resolve(A)];case 8:return M=C.sent(),x.showError(M,A.portalItem),[2,Promise.reject(A)];case 9:return[2]}})})}})},"esri/layers/support/layerOriginUtils":function(){define(["exports","../../core/accessorSupport/PropertyOrigin","./layerUtils"],function(T,e,a){function u(x){return v[x.type].propertyGroups.filter(f=>
!f.predicate||f.predicate(x))}function q(x){x=u(x);const f=[];for(const h of x)f.push(...h.properties);return f}function y(x,f,h){const l=e.writableNameToId(h),{id:w,properties:F}=f;f=F.map(Q=>x.originIdOf(Q)<l?"source":"overridden").reduce((Q,N)=>Q===N?Q:"overridden");return{id:w,properties:[...F],status:f}}function t(x){const f=v[x.type];return!(!f||f.predicate&&!f.predicate(x))}const k=x=>"feature"===x.type&&!x.isTable,v={feature:{predicate:a.isFeatureServiceLayer,propertyGroups:[{id:"blend-mode",
properties:["blendMode"],predicate:k},{id:"charts",properties:["charts"]},{id:"custom-parameters",properties:["customParameters"]},{id:"definition-expression",properties:["definitionExpression"]},{id:"effect",properties:["effect","featureEffect"],predicate:k},{id:"feature-reduction",properties:["featureReduction"],predicate:k},{id:"floor-info",properties:["floorInfo"],predicate:k},{id:"form-template",properties:["formTemplate"]},{id:"labels",properties:["labelingInfo","labelsVisible"],predicate:k},
{id:"legend-enabled",properties:["legendEnabled"],predicate:k},{id:"opacity",properties:["opacity"],predicate:k},{id:"order-by",properties:["orderBy"],predicate:k},{id:"popup",properties:["popupTemplate","popupEnabled"]},{id:"refresh-interval",properties:["refreshInterval"]},{id:"renderer",properties:["renderer"],predicate:k},{id:"scale-range",properties:["minScale","maxScale"],predicate:k},{id:"use-view-time",properties:["useViewTime"]}]}};T.clearOverrides=function(x,f){if(t(x)){var h=q(x);for(const w of h){{h=
x;var l=w;const F=e.writableNameToId(f);h.revert(l,e.idToReadableName(F-1))}}}};T.disconnectFromSource=function(x,f){if(t(x)){var h=q(x);for(const w of h){{var l=x;h=w;const F=e.writableNameToId(f),Q=l.originIdOf(h);Q<F&&Q!==e.OriginId.COMPUTED&&l.updateOrigin(h,e.idToWritableName(F))}}}};T.getLayerOriginInfo=function(x,f){if(t(x)){var h=u(x).map(l=>y(x,l,f));return{propertyGroupOriginInfos:h,status:h.map(l=>l.status).reduce((l,w)=>l===w?l:"mixed")}}};T.isSupportedLayer=t;Object.defineProperties(T,
{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/save/featureLayerUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/arrayUtils ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/accessorSupport/originUtils ../FeatureLayer ../support/arcgisLayers ../support/arcgisLayerUrl ../support/layerUtils ../../portal/Portal ../../portal/PortalItem ../../portal/support/jsonContext ../../portal/support/portalItemUtils".split(" "),
function(T,e,a,u,q,y,t,k,v,x,f,h,l,w,F,Q){function N(Z,ha){return`Layer (title: ${Z.title}, id: ${Z.id}) of type '${Z.declaredClass}' ${ha}`}function W(Z,ha){if("Feature Service"!==ha.type)throw new u("feature-layer:portal-item-wrong-type",N(Z,'should have portal item of type "Feature Service"'));}function A(Z){return G.apply(this,arguments)}function G(){G=e._asyncToGenerator(function*(Z){yield Z.load();if(h.isFeatureCollectionLayer(Z))throw new u("feature-layer:save",N(Z,"using an in-memory source cannot be saved to a portal item"));
});return G.apply(this,arguments)}function H(Z,ha){Z=Z.messages.filter(({type:ea})=>"error"===ea).map(({name:ea,message:va,details:ta})=>new u(ea,va,ta));null!=ha&&ha.ignoreUnsupported&&(Z=Z.filter(({name:ea})=>"layer:unsupported"!==ea&&"symbol:unsupported"!==ea&&"symbol-layer:unsupported"!==ea&&"property:unsupported"!==ea&&"url:unsupported"!==ea));if(0<Z.length)throw new u("feature-layer:save","Failed to save feature layer due to unsupported or invalid content. See 'details.errors' for more detailed information",
{errors:Z});}function Y(Z,ha,ea){return M.apply(this,arguments)}function M(){M=e._asyncToGenerator(function*(Z,ha,ea){"beforeSave"in Z&&"function"===typeof Z.beforeSave&&(yield Z.beforeSave());Z=Z.write({},ha);H(ha,ea);return Z});return M.apply(this,arguments)}function C(Z){const {layer:ha,layerJSON:ea}=Z;return ha.isTable?{layers:[],tables:[ea]}:{layers:[ea],tables:[]}}function D(Z){Q.addTypeKeyword(Z,Q.TypeKeyword.JSAPI);Z.typeKeywords&&(Z.typeKeywords=Z.typeKeywords.filter((ha,ea,va)=>va.indexOf(ha)===
ea))}function X(Z,ha){return ba.apply(this,arguments)}function ba(){ba=e._asyncToGenerator(function*(Z,ha){return/\/\d+\/?$/.test(Z.url)?C(ha[0]):ia(Z,ha)});return ba.apply(this,arguments)}function ia(Z,ha){return L.apply(this,arguments)}function L(){L=e._asyncToGenerator(function*(Z,ha){const {layer:{url:ea,customParameters:va,apiKey:ta}}=ha[0];(Z=yield Z.fetchData("json"))&&null!=Z.layers&&null!=Z.tables||(Z=yield J(Z,{url:ea,customParameters:va,apiKey:ta},ha.map(Ba=>Ba.layer.layerId)));for(const Ba of ha)K(Ba.layer,
Ba.layerJSON,Z);return Z});return L.apply(this,arguments)}function J(Z,ha,ea){return c.apply(this,arguments)}function c(){c=e._asyncToGenerator(function*(Z,ha,ea){var va,ta;Z||(Z={});(va=Z).layers||(va.layers=[]);(ta=Z).tables||(ta.tables=[]);const {url:Ba,customParameters:z,apiKey:aa}=ha,{serviceJSON:R,layersJSON:P}=yield x.fetchFeatureService(Ba,{customParameters:z,apiKey:aa});ha=d(Z.layers,R.layers,ea);ea=d(Z.tables,R.tables,ea);Z.layers=ha.itemResources;Z.tables=ea.itemResources;ea=[...ha.added,
...ea.added];ha=P?[...P.layers,...P.tables]:[];yield g(Z,ea,Ba,ha);return Z});return c.apply(this,arguments)}function d(Z,ha,ea){const va=a.difference(Z,ha,(ta,Ba)=>ta.id===Ba.id);Z=Z.filter(ta=>!va.removed.some(Ba=>Ba.id===ta.id));ha=va.added.map(({id:ta})=>({id:ta}));ha.forEach(({id:ta})=>{Z.push({id:ta})});return{itemResources:Z,added:ha.filter(({id:ta})=>!ea.includes(ta))}}function g(Z,ha,ea,va){return r.apply(this,arguments)}function r(){r=e._asyncToGenerator(function*(Z,ha,ea,va){ha=ha.map(({id:ta})=>
new v({url:ea,layerId:ta,sourceJSON:va.find(({id:Ba})=>Ba===ta)}));yield t.eachAlways(ha.map(ta=>ta.load()));ha.forEach(ta=>{const {layerId:Ba,loaded:z,defaultPopupTemplate:aa}=ta;if(z&&!y.isNone(aa)){var R={id:Ba,popupInfo:aa.toJSON()};K(ta,R,Z)}})});return r.apply(this,arguments)}function K(Z,ha,ea){Z.isTable?V(ea.tables,ha):V(ea.layers,ha)}function V(Z,ha){const ea=Z.findIndex(({id:va})=>va===ha.id);-1===ea?Z.push(ha):Z[ea]=ha}function O(Z){const {portalItem:ha}=Z;return h.isFeatureServiceLayer(Z)&&
!Z.dynamicDataSource&&!(null==ha||!ha.loaded)&&"Feature Service"===ha.type}function ja(Z){return pa.apply(this,arguments)}function pa(){pa=e._asyncToGenerator(function*(Z){if(null==Z||!Z.length)throw new u("feature-layer-utils-saveall:missing-parameters","'layers' array should contain at least one feature layer");yield Promise.all(Z.map(ea=>ea.load()));for(var ha of Z)if(!O(ha))throw new u("feature-layer-utils-saveall:invalid-parameters",`'layers' array should only contain layers or tables in a feature service loaded from 'Feature Service' item. ${N(ha,
"does not conform")}`,{layer:ha});ha=Z.map(ea=>ea.portalItem.id);if(1<(new Set(ha)).size)throw new u("feature-layer-utils-saveall:invalid-parameters","All layers in the 'layers' array should be loaded from the same portal item");Z=Z.map(ea=>ea.layerId);if((new Set(Z)).size!==Z.length)throw new u("feature-layer-utils-saveall:invalid-parameters","'layers' array should contain only one instance each of layer or table in a feature service");});return pa.apply(this,arguments)}function wa(Z,ha){return ka.apply(this,
arguments)}function ka(){ka=e._asyncToGenerator(function*(Z,ha){const {url:ea,layerId:va,title:ta,fullExtent:Ba,isTable:z}=Z;Z=f.parse(ea);Z=y.isSome(Z)&&"FeatureServer"===Z.serverType;ha.url=Z?ea:`${ea}/${va}`;ha.title||(ha.title=ta);ha.extent=null;!z&&y.isSome(Ba)&&(ha.extent=yield Q.getWGS84ExtentForItem(Ba));Q.removeTypeKeyword(ha,Q.TypeKeyword.METADATA);Q.removeTypeKeyword(ha,Q.TypeKeyword.MULTI_LAYER);Q.addTypeKeyword(ha,Q.TypeKeyword.SINGLE_LAYER);z&&Q.addTypeKeyword(ha,Q.TypeKeyword.TABLE);
D(ha)});return ka.apply(this,arguments)}function ra(Z,ha,ea){return za.apply(this,arguments)}function za(){za=e._asyncToGenerator(function*(Z,ha,ea){const va=Z.portal;yield va._signIn();yield va.user.addItem({item:Z,data:ha,folder:null==ea?void 0:ea.folder})});return za.apply(this,arguments)}function ua(){ua=e._asyncToGenerator(function*(Z,ha){yield A(Z);var ea=Z.portalItem;if(!ea)throw Da.error("save: requires the portalItem property to be set"),new u("feature-layer:portal-item-not-set",N(Z,"requires the portalItem property to be set"));
if(!ea.loaded)throw new u("feature-layer:portal-item-not-loaded",N(Z,"cannot be saved to a portal item that does not exist or is inaccessible"));W(Z,ea);ea=Z.portalItem;const va=F.createForItemWrite(ea);ha=yield Y(Z,va,ha);Z=yield X(ea,[{layer:Z,layerJSON:ha}]);D(ea);yield ea.update({data:Z});k.updateOrigins(va);return ea});return ua.apply(this,arguments)}function la(){la=e._asyncToGenerator(function*(Z,ha,ea){yield A(Z);var va,ta,Ba,z;ha=w.from(ha);ha.id&&(ha=ha.clone(),ha.id=null);null!=(ta=(va=
ha).type)?ta:va.type="Feature Service";null!=(z=(Ba=ha).portal)?z:Ba.portal=l.getDefault();W(Z,ha);va=ha;ta=F.createForItemWrite(va);Ba=yield Y(Z,ta,ea);Ba=C({layer:Z,layerJSON:Ba});yield wa(Z,va);yield ra(va,Ba,ea);Z.portalItem=va;k.updateOrigins(ta);return va});return la.apply(this,arguments)}const Da=q.getLogger("esri.layers.FeatureLayer");q=t.debounce(function(Z,ha){return ua.apply(this,arguments)});var Ea=function(){var Z=e._asyncToGenerator(function*(ha,ea){yield ja(ha);const va=ha[0].portalItem,
ta=F.createForItemWrite(va),Ba=yield Promise.all(ha.map(aa=>Y(aa,ta,ea))),z=yield X(va,ha.map((aa,R)=>({layer:aa,layerJSON:Ba[R]})));D(va);yield va.update({data:z});yield Promise.all(ha.slice(1).map(aa=>aa.portalItem.reload()));k.updateOrigins(ta);return va.clone()});return function(ha,ea){return Z.apply(this,arguments)}}();Ea=t.debounce(Ea);const Aa=t.debounce(function(Z,ha,ea){return la.apply(this,arguments)});T.save=q;T.saveAll=Ea;T.saveAs=Aa;Object.defineProperties(T,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},
"esri/core/accessorSupport/originUtils":function(){define(["exports","../multiOriginJSONSupportUtils"],function(T,e){T.updateOrigins=function(a){a&&a.writtenProperties&&a.writtenProperties.forEach(({target:u,propName:q,newOrigin:y})=>{e.isMultiOriginJSONMixin(u)&&y&&u.originOf(q)!==y&&u.updateOrigin(q,y)})};Object.defineProperties(T,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/multiOriginJSONSupportUtils":function(){define(["exports"],function(T){T.isMultiOriginJSONMixin=
function(e){return e&&"getAtOrigin"in e&&"originOf"in e};Object.defineProperties(T,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/arcgisLayers":function(){define("require exports ../../chunks/_rollupPluginBabelHelpers ../../request ../../core/Error ../../core/maybe ../../core/urlUtils ./arcgisLayerUrl ./lazyLayerLoader".split(" "),function(T,e,a,u,q,y,t,k,v){function x(){x=a._asyncToGenerator(function*(L){var J,c=null==(J=L.properties)?void 0:J.customParameters;
J=yield l(L.url,c);L={...L.properties,url:L.url};if(!J.sublayerIds)return null!=J.layerOrTableId&&(L.layerId=J.layerOrTableId,L.sourceJSON=J.sourceJSON),new J.Constructor(L);c=new (yield new Promise((d,g)=>T(["../GroupLayer"],r=>d(Object.freeze(Object.defineProperty({__proto__:null,default:r},Symbol.toStringTag,{value:"Module"}))),g))).default({title:J.parsedUrl.title});h(c,J,L);return c});return x.apply(this,arguments)}function f(L,J){return L?L.find(c=>c.id===J):null}function h(L,J,c){function d(g,
r){g={...c,layerId:g,sublayerTitleMode:"service-name"};y.isSome(r)&&(g.sourceJSON=r);return new J.Constructor(g)}J.sublayerIds.forEach(g=>{g=d(g,f(J.sublayerInfos,g));L.add(g)});J.tableIds.forEach(g=>{g=d(g,f(J.tableInfos,g));L.tables.add(g)})}function l(L,J){return w.apply(this,arguments)}function w(){w=a._asyncToGenerator(function*(L,J){var c=k.parse(L);y.isNone(c)&&(c=yield F(L,J));if(y.isNone(c))throw new q("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:L});
const {serverType:d,sublayer:g}=c;var r={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"};switch(d){case "MapServer":var K=null!=g?"FeatureLayer":D(L,J).then(ja=>ja?"TileLayer":"MapImageLayer");break;case "ImageServer":K=ba(L,{customParameters:J}).then(ja=>{const pa=ja.tileInfo&&ja.tileInfo.format;return ja.tileInfo?"LERC"!==(null==pa?void 0:pa.toUpperCase())||ja.cacheType&&"elevation"!==ja.cacheType.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer"});
break;case "SceneServer":K=ba(c.url.path,{customParameters:J}).then(ja=>{if(ja){if("Voxel"===(null==ja?void 0:ja.layerType))return"VoxelLayer";if(null!=ja&&ja.layers&&Array.isArray(ja.layers)&&0<ja.layers.length){var pa;const wa={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};ja=null==(pa=ja.layers[0])?void 0:pa.layerType;if(null!=wa[ja])return wa[ja]}}return"SceneLayer"});break;default:K=r[d]}r="FeatureServer"===
d;c={parsedUrl:c,Constructor:null,layerOrTableId:r?g:null,sublayerIds:null,tableIds:null};K=yield K;if({FeatureLayer:!0,SceneLayer:!0}[K]&&null==g)if(L=yield W(L,d,J),r&&(c.sublayerInfos=L.layerInfos,c.tableInfos=L.tableInfos),1!==L.layerIds.length+L.tableIds.length)c.sublayerIds=L.layerIds,c.tableIds=L.tableIds;else if(r){var V,O;c.layerOrTableId=null!=(V=L.layerIds[0])?V:L.tableIds[0];c.sourceJSON=null!=(O=L.layerInfos[0])?O:L.tableInfos[0]}c.Constructor=yield M(K);return c});return w.apply(this,
arguments)}function F(L,J){return Q.apply(this,arguments)}function Q(){Q=a._asyncToGenerator(function*(L,J){var c;J=yield ba(L,{customParameters:J});let d=null,g=null;const r=J.type;"Feature Layer"===r||"Table"===r?(d="FeatureServer",g=J.id):"indexedVector"===r?d="VectorTileServer":J.hasOwnProperty("mapName")?d="MapServer":J.hasOwnProperty("bandCount")&&J.hasOwnProperty("pixelSizeX")?d="ImageServer":J.hasOwnProperty("maxRecordCount")&&J.hasOwnProperty("allowGeometryUpdates")?d="FeatureServer":J.hasOwnProperty("streamUrls")?
d="StreamServer":N(J)?(d="SceneServer",g=J.id):J.hasOwnProperty("layers")&&N(null==(c=J.layers)?void 0:c[0])&&(d="SceneServer");if(!d)return null;c=null!=g?k.parseNonStandardSublayerUrl(L):null;return{title:y.isSome(c)&&J.name||t.getFilename(L),serverType:d,sublayer:g,url:{path:y.isSome(c)?c.serviceUrl:t.urlToObject(L).path}}});return Q.apply(this,arguments)}function N(L){return(null==L?void 0:L.hasOwnProperty("store"))&&L.hasOwnProperty("id")&&"number"===typeof L.id}function W(L,J,c){return A.apply(this,
arguments)}function A(){A=a._asyncToGenerator(function*(L,J,c){var d,g;let r=!1;"FeatureServer"===J?(L=yield H(L,{customParameters:c}),r=!!L.layersJSON,J=L.layersJSON||L.serviceJSON):J=yield ba(L,{customParameters:c});L=null==(d=J)?void 0:d.layers;d=null==(g=J)?void 0:g.tables;return{layerIds:(null==L?void 0:L.map(K=>K.id).reverse())||[],tableIds:(null==d?void 0:d.map(K=>K.id).reverse())||[],layerInfos:r?L:[],tableInfos:r?d:[]}});return A.apply(this,arguments)}function G(L){return!L.type||"Feature Layer"===
L.type}function H(L,J){return Y.apply(this,arguments)}function Y(){Y=a._asyncToGenerator(function*(L,J){var c,d;let g=yield ba(L,J);g=g||{};g.layers=(null==(c=g.layers)?void 0:c.filter(G))||[];c={serviceJSON:g};if(10.5>g.currentVersion)return c;L=yield ba(L+"/layers",J);c.layersJSON={layers:(null==L?void 0:null==(d=L.layers)?void 0:d.filter(G))||[],tables:(null==L?void 0:L.tables)||[]};return c});return Y.apply(this,arguments)}function M(L){return C.apply(this,arguments)}function C(){C=a._asyncToGenerator(function*(L){return(0,v.layerLookupMap[L])()});
return C.apply(this,arguments)}function D(L,J){return X.apply(this,arguments)}function X(){X=a._asyncToGenerator(function*(L,J){return(yield ba(L,{customParameters:J})).tileInfo});return X.apply(this,arguments)}function ba(L,J){return ia.apply(this,arguments)}function ia(){ia=a._asyncToGenerator(function*(L,J){return(yield u(L,{responseType:"json",query:{f:"json",...null==J?void 0:J.customParameters,token:null==J?void 0:J.apiKey}})).data});return ia.apply(this,arguments)}e.fetchFeatureService=H;e.fromUrl=
function(L){return x.apply(this,arguments)};Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"app/widgets/panels/MapMaker/savelayer/SaveLayerAs":function(){define("require exports tslib esri/core/accessorSupport/decorators esri/widgets/support/widget esri/widgets/Widget esri/core/domUtils ../../../../utils/waitFor ../../../../utils/learnMoreLink esri/intl/substitute".split(" "),function(T,e,a,u,q,y,t,k,v,x){Object.defineProperty(e,"__esModule",{value:!0});
y=a.__importDefault(y);t=a.__importStar(t);x=a.__importStar(x);T=function(f){function h(l){l=f.call(this,l)||this;l.isTable=!1;return l}a.__extends(h,f);h.prototype.postInitialize=function(){var l;return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(w){this.close=this.close.bind(this);this.onSave=this.onSave.bind(this);this.onCancel=this.onCancel.bind(this);this.onDone=this.onDone.bind(this);this.onSetInitalFocus=this.onSetInitalFocus.bind(this);this.isTable=null===
(l=this.sourceLayer)||void 0===l?void 0:l.isTable;this.createContainer();this.open();this.initItemProps();this.overrideFocus();return[2]})})};h.prototype.destroy=function(){this.modal&&(t.remove(this.itemPropertiesElement),t.remove(this.modal),this.modal=null)};h.prototype.open=function(){var l=this.modal;setTimeout(function(){return l.active=!0},250)};h.prototype.close=function(){this.modal.active=!1};h.prototype.disable=function(l){var w=this.modal;w.querySelector(".js-save").loading=l;w.querySelector(".js-cancel").disabled=
l;w.querySelector(".js-content").classList[l?"add":"remove"]("disabled")};h.prototype.onSave=function(){this.disable(!0);this.emit("save",{itemProps:this.itemProps})};h.prototype.onCancel=function(){this.emit("cancel");this.close()};h.prototype.onChange=function(l){this.itemProps[l.prop]=l.value||"";this.validate()};h.prototype.onDone=function(){var l=this;this.emit("done");return new Promise(function(w){w(!0);setTimeout(function(){return l.destroy()},250)})};h.prototype.onSetInitalFocus=function(l){var w,
F,Q;return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(N){switch(N.label){case 0:return null===l||void 0===l?void 0:l.preventDefault(),null===(w=this.actionElement)||void 0===w?void 0:w.removeEventListener("focus",this.onSetInitalFocus),null===(F=this.cancelBtn)||void 0===F?void 0:F.removeEventListener("focus",this.onSetInitalFocus),null===(Q=this.infoElement)||void 0===Q?void 0:Q.removeEventListener("focus",this.onSetInitalFocus),[4,this.modal.setFocus("close-button")];
case 1:return N.sent(),[2]}})})};h.prototype.initItemProps=function(){return a.__awaiter(this,void 0,void 0,function(){var l,w,F,Q,N,W;return a.__generator(this,function(A){switch(A.label){case 0:return l=this,w=l.sourceLayer,F=l.portal,Q=this.portalItem=null===w||void 0===w?void 0:w.portalItem,N=this.getUpdatedTitle(w),Q?[4,F.getUniqueItemTitle(N,Q.ownerFolder,Q.type)]:[3,2];case 1:return W=A.sent(),this.itemProps={title:W},this.itemProps.ownerFolder=this.findFolder(Q.ownerFolder),this.itemProps.categories=
Q.categories,this.itemProps.tags=Q.tags,this.itemProps.snippet=Q.snippet,[3,3];case 2:this.itemProps={title:N},A.label=3;case 3:return[2]}})})};h.prototype.getUpdatedTitle=function(l){return l.title};h.prototype.validate=function(){var l=this;setTimeout(function(){return a.__awaiter(l,void 0,void 0,function(){var w,F;return a.__generator(this,function(Q){switch(Q.label){case 0:return[4,this.titleInput.getErrorMessage()];case 1:return w=Q.sent(),F=this.modal.querySelector(".js-save"),F.disabled=w?
!0:!1,[2]}})})},850)};h.prototype.createContainer=function(){var l=this.modal=document.createElement("calcite-modal");l.setAttribute("area-labeledby","modal-title");l.size="s";l.width="s";l.intlClose=this.messagesCommon.close;l.disableOutsideClose=!0;l.disableEscape=!0;l.beforeClose=this.onDone;document.body.appendChild(l);this.container=l};h.prototype.findFolder=function(l){return this.portal.user.folders.find(function(w){return w.id===l})};h.prototype.overrideFocus=function(){return a.__awaiter(this,
void 0,void 0,function(){var l,w,F,Q,N,W,A=this;return a.__generator(this,function(G){switch(G.label){case 0:return w=this,[4,k.waitForElement("calcite-button.js-cancel",this.modal)];case 1:return l=w.cancelBtn=G.sent(),l.addEventListener("focus",this.onSetInitalFocus),Q=this,[4,k.waitForElement("arcgis-title-input",this.modal)];case 2:F=Q.actionElement=G.sent();F.addEventListener("focus",this.onSetInitalFocus);if(!this.visibleElements.infoElement)return[3,4];W=this;return[4,k.waitForElement(".js-info",
this.modal)];case 3:N=W.infoElement=G.sent(),N.addEventListener("focus",this.onSetInitalFocus),G.label=4;case 4:return setTimeout(function(){return A.onSetInitalFocus()},400),[2]}})})};h.prototype.render=function(){return q.tsx("div",null,this.renderHeader(),this.renderContent(),this.renderFooter())};h.prototype.renderHeader=function(){return q.tsx("h3",{slot:"header",id:"modal-title"},this.messages.createItem)};h.prototype.renderContent=function(){var l=this,w=this.visibleElements,F=this.portalItem,
Q=this.itemProps,N=this.portal;F=(null===F||void 0===F?void 0:F.type)||"Feature Service";var W=Q||{},A=W.title,G=W.tags,H=W.categories,Y=W.snippet;W=W.ownerFolder;var M=N.user;return Q?q.tsx("div",{slot:"content",class:"save-layer js-content"},q.tsx("arcgis-item-properties",{scale:"m",portal:N,user:M,api:4,type:F||"Feature Service",afterCreate:function(C){return l.itemPropertiesElement=C}},q.tsx("arcgis-title-input",{scale:"m","item-title":A,currentFolder:W,onArcgisTitleInputChange:function(C){return l.onChange({prop:"title",
value:C.detail})},afterCreate:function(C){l.titleInput=C;l.validate()}}),q.tsx("arcgis-folder-picker",{scale:"m",folder:W,onArcgisFolderPickerChange:function(C){return l.onChange({prop:"ownerFolder",value:C.detail})}}),q.tsx("arcgis-categories-picker",{scale:"m",categories:H,onArcgisCategoriesPickerChange:function(C){return l.onChange({prop:"categories",value:C.detail})}}),q.tsx("arcgis-tags-picker",{scale:"m",activeTags:G,onArcgisTagsPickerChange:function(C){return l.onChange({prop:"tags",value:C.detail})}}),
q.tsx("arcgis-summary-input",{scale:"m",summary:Y,onArcgisSummaryInputChange:function(C){return l.onChange({prop:"snippet",value:C.detail})}})),w.infoElement?q.tsx("p",{class:"js-info",afterCreate:function(C){var D=v.getLearnMoreUrl("120003727",{portal:l.portal});C.innerHTML=x.substitute(l.isTable?l.messages.messageTable:l.messages.message,{url:D})}}):null):q.tsx("div",{slot:"content",class:"save-layer js-content"})};h.prototype.renderFooter=function(){return[q.tsx("calcite-button",{class:"js-cancel",
slot:"secondary",width:"full",appearance:"outline",onclick:this.onCancel},this.messagesCommon.cancel),q.tsx("calcite-button",{class:"js-save",slot:"primary",width:"full",disabled:!0,onclick:this.onSave},this.messagesCommon.save)]};a.__decorate([u.property(),q.messageBundle("mapviewer/saveLayer")],h.prototype,"messages",void 0);a.__decorate([u.property(),q.messageBundle("mapviewer/common")],h.prototype,"messagesCommon",void 0);a.__decorate([u.property()],h.prototype,"portal",void 0);a.__decorate([u.property()],
h.prototype,"sourceLayer",void 0);a.__decorate([u.property()],h.prototype,"portalItem",void 0);a.__decorate([u.property()],h.prototype,"itemProps",void 0);a.__decorate([u.property()],h.prototype,"visibleElements",void 0);return h=a.__decorate([u.subclass("")],h)}(y.default);e.default=T})},"app/utils/waitFor":function(){define(["require","exports","tslib"],function(T,e,a){var u=this;Object.defineProperty(e,"__esModule",{value:!0});e.waitForElement=void 0;e.waitForElement=function(q,y){return a.__awaiter(u,
void 0,void 0,function(){return a.__generator(this,function(t){return[2,new Promise(function(k){if(document.querySelector(q))return k(document.querySelector(q));var v=new MutationObserver(function(x){document.querySelector(q)&&(k(document.querySelector(q)),v.disconnect())});v.observe(y||document.body,{childList:!0,subtree:!0})})]})})}})},"app/widgets/panels/MapMaker/savelayer/UpdateLayer":function(){define("require exports tslib esri/core/accessorSupport/decorators esri/widgets/support/widget esri/widgets/Widget esri/core/domUtils esri/intl/substitute ../../../../utils/learnMoreLink ../../../../utils/waitFor".split(" "),
function(T,e,a,u,q,y,t,k,v,x){Object.defineProperty(e,"__esModule",{value:!0});y=a.__importDefault(y);t=a.__importStar(t);k=a.__importStar(k);T=function(f){function h(l){l=f.call(this,l)||this;l.isTable=!1;return l}a.__extends(h,f);h.prototype.postInitialize=function(){var l;return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(w){this.close=this.close.bind(this);this.onSave=this.onSave.bind(this);this.onSaveAs=this.onSaveAs.bind(this);this.onCancel=this.onCancel.bind(this);
this.onOpenDetails=this.onOpenDetails.bind(this);this.onDone=this.onDone.bind(this);this.onSetInitalFocus=this.onSetInitalFocus.bind(this);this.isTable=null===(l=this.layer)||void 0===l?void 0:l.isTable;this.createContainer();this.open();this.overrideFocus();return[2]})})};h.prototype.destroy=function(){this.modal&&(t.remove(this.modal),this.modal=null)};h.prototype.open=function(){var l=this.modal;setTimeout(function(){return l.active=!0},250)};h.prototype.close=function(){this.modal.active=!1};
h.prototype.disable=function(l){var w=this.modal;w.querySelector(".js-save").loading=l;w.querySelector(".js-cancel").disabled=l};h.prototype.onOpenDetails=function(){var l=this.portal&&this.portal.restUrl.replace("sharing/rest","home");window.open(l+"/item.html?id\x3d"+this.layer.portalItem.id)};h.prototype.onSave=function(){this.disable(!0);this.emit("save")};h.prototype.onSaveAs=function(){this.disable(!0);this.emit("saveas")};h.prototype.onCancel=function(){this.emit("cancel");this.close()};h.prototype.onDone=
function(){var l=this;this.emit("done");return new Promise(function(w){w(!0);setTimeout(function(){return l.destroy()},250)})};h.prototype.onSetInitalFocus=function(l){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(w){switch(w.label){case 0:return l.preventDefault(),[4,this.modal.setFocus("close-button")];case 1:return w.sent(),this.actionElement.removeEventListener("focus",this.onSetInitalFocus),[2]}})})};h.prototype.createContainer=function(){var l=this.modal=
document.createElement("calcite-modal");l.setAttribute("area-labeledby","modal-title");l.size="s";l.width="s";l.color="red";l.intlClose=this.messagesCommon.close;l.disableOutsideClose=!0;l.disableEscape=!0;l.beforeClose=this.onDone;document.body.appendChild(l);this.container=l};h.prototype.overrideFocus=function(){return a.__awaiter(this,void 0,void 0,function(){var l,w;return a.__generator(this,function(F){switch(F.label){case 0:return w=this,[4,x.waitForElement(".js-open-details",this.modal)];case 1:return l=
w.actionElement=F.sent(),l.addEventListener("focus",this.onSetInitalFocus),[2]}})})};h.prototype.render=function(){return q.tsx("div",null,this.renderHeader(),this.renderContent(),this.renderFooter())};h.prototype.renderHeader=function(){var l=this.isTable;return q.tsx("h3",{slot:"header",id:"modal-title"},q.tsx("calcite-icon",{class:"update-layer-icon",icon:"exclamation-mark-triangle"}),l?this.messages.saveTable:this.messages.save)};h.prototype.renderContent=function(){var l=this.layer,w=this.isTable,
F=l.portalItem,Q=k.substitute(w?this.messages.updateSourceSummaryTable:this.messages.updateSourceSummary,l);l=w?this.messages.updateSourceLayerDescriptionTable:this.messages.updateSourceLayerDescription;return q.tsx("div",{slot:"content",class:"update-layer js-content"},q.tsx("p",{afterCreate:function(N){return N.innerHTML=Q}}),q.tsx("calcite-label",{alignment:"start",scale:"m",layout:"default"},w?this.messages.sourceTable:this.messages.sourceLayer,q.tsx("calcite-tile",{class:"update-layer-tile",
description:F.displayName,heading:F.title,onclick:this.onOpenDetails},q.tsx("calcite-action",{slot:"content-end",class:"js-open-details",appearance:"solid",compact:!0,scale:"s",icon:"launch",text:w?this.messages.sourceTable:this.messages.sourceLayer,onClick:this.onOpenDetails}))),q.tsx("p",null,l," ",this.renderLearnMoreLink()),this.renderList())};h.prototype.renderLearnMoreLink=function(){var l=v.getLearnMoreUrl("120003727",{portal:this.portal});return q.tsx("calcite-link",{target:"_blank",href:l},
this.messagesCommon.learnMore)};h.prototype.renderList=function(){var l=this;return q.tsx("calcite-list",{class:"update-layer-list"},this.layers.items.map(function(w){return l.renderListItem(w)}))};h.prototype.renderListItem=function(l){var w=this.isTable;return q.tsx("calcite-list-item",{label:l.title,nonInteractive:!0},this.layer.id===l.id?q.tsx("calcite-chip",{slot:"content-end",appearance:"solid",color:"grey",scale:"s"},w?this.messages.currentTable:this.messages.currentLayer):null)};h.prototype.renderFooter=
function(){return[q.tsx("calcite-button",{class:"js-cancel",slot:"back",width:"full",appearance:"outline",onclick:this.onCancel},this.messagesCommon.cancel),q.tsx("calcite-button",{class:"js-save-as",slot:"secondary",width:"full",appearance:"outline",onclick:this.onSaveAs},this.messages.saveNewItem),q.tsx("calcite-button",{class:"js-save",slot:"primary",width:"full",onclick:this.onSave},this.messagesCommon.save)]};a.__decorate([u.property(),q.messageBundle("mapviewer/saveLayer")],h.prototype,"messages",
void 0);a.__decorate([u.property(),q.messageBundle("mapviewer/common")],h.prototype,"messagesCommon",void 0);a.__decorate([u.property()],h.prototype,"portal",void 0);a.__decorate([u.property()],h.prototype,"view",void 0);a.__decorate([u.property()],h.prototype,"layer",void 0);a.__decorate([u.property()],h.prototype,"layers",void 0);return h=a.__decorate([u.subclass("")],h)}(y.default);e.default=T})}}});
define(["require","exports","tslib","../LayerList"],function(T,e,a,u){Object.defineProperty(e,"__esModule",{value:!0});e.createWidget=void 0;u=a.__importDefault(u);e.createWidget=function(q){var y=q.app,t=q.selectedItems,k=q.action,v=q.panel,x=q.state;q=q.container||document.createElement("div");var f=document.createElement("calcite-flow");f.setAttribute("id","layer-list-flow");q.appendChild(f);k.indicator=!1;return new u.default({action:k,app:y,state:x,container:f,selectedLayers:t,panel:v})}});