webpackJsonp([9],{579:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(1),n=s.n(i),r=s(102),o=s(282),a=s(16),u=s(572),c=s(283),l=s(284),d=function(){function defineProperties(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,s){return t&&defineProperties(e.prototype,t),s&&defineProperties(e,s),e}}();var h="[js-hook-customise-times]",m="AfwezigheidsRoosterWrapper[WekelijksTerugkerendRooster][DuurInMinuten]",f="AfwezigheidsRoosterWrapper[WekelijksTerugkerendRooster][DatumTijdBegin]",p="AfwezigheidsRoosterWrapper[WekelijksTerugkerendRooster][DatumEind]",g="AfwezigheidsRoosterWrapper[WekelijksTerugkerendRooster][Adres][AdresseerbareAdresID]",k=document.querySelector("[js-hook-form-schedule-messages] [js-hook-time-errors]"),y=document.querySelector("[js-hook-form-schedule-messages] [js-hook-submit-errors]"),b=function(e){function AccountModalScheduleMessages(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AccountModalScheduleMessages);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(AccountModalScheduleMessages.__proto__||Object.getPrototypeOf(AccountModalScheduleMessages)).call(this,e));return t.action=t.element.getAttribute("action"),t.customiseTimesBlock=t.element.querySelector(h),a.a.$on("modal[modal-schedule-messages]::close",function(){t.steps.reset(),t.steps.loading=!1}),a.a.$on("form-steps[schedule-messages]::step-change",function(e,s){t.checkWeekdayValidity(s)}),t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(AccountModalScheduleMessages,o["default"]),d(AccountModalScheduleMessages,[{key:"formId",get:function get(){return"schedule-messages"}}]),d(AccountModalScheduleMessages,[{key:"onFormChange",value:function onFormChange(e){this.steps&&!this.steps.loading&&this.steps.isValid(),this.checkAddressValidity(),this.checkWeekdayValidity(this.steps.currentStep),"change"===e.eventType&&(this.state.fields["choose-times"].input.checked?(this.customiseTimes(!0),this.setDateTime(),this.state.fields["no-end-date"].input.checked?this.setNoEndDate(!0):this.setNoEndDate(!1)):(this.customiseTimes(!1),this.setIndefiniteTime()))}},{key:"onFormSubmit",value:function onFormSubmit(){var e=this;this.steps.loading=!0,this.formSubmitTimeout&&clearTimeout(this.formSubmitTimeout),this.formSubmitTimeout=setTimeout(function(){e.prepareScheduleCall(window.EnvironmentSettings.api.addAwayScheduleV2).then(function(t){Promise.all(t.map(function(t){return e.changeScheduleCall(t)})).then(function(t){e.steps.loading=!1,t.includes(!1)?Object(c.b)(y,window.messages.validationRequestFailed,"submit-errors"):(Object(c.a)("submit-errors"),a.a.$trigger("form-steps[schedule-messages]::next"))})})},500)}},{key:"prepareScheduleCall",value:function prepareScheduleCall(e){var t=this,s=Object.keys(this.inputs).reduce(function(e,s){return-1!==s.indexOf(g)&&t.inputs[s].checked&&e.push(s),e},[]);return new Promise(function(i){i(s.map(function(i){var n=new FormData(t.element);return n.set("method",e),n.delete("choose-times"),n.delete("DateBegin"),n.delete("DateEnd"),n.delete("TimeBegin"),n.delete("TimeEnd"),s.forEach(function(e){return n.delete(e)}),n.set(g,t.inputs[i].value),n}))})}},{key:"changeScheduleCall",value:function changeScheduleCall(e){return r.a.get(window.EnvironmentSettings.endpoint+Object(l.a)(e),{},!1,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){return!!e.data.success}).catch(function(){return!1})}},{key:"customiseTimes",value:function customiseTimes(e){[].concat(function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,s=Array(e.length);t<e.length;t++)s[t]=e[t];return s}return Array.from(e)}(this.customiseTimesBlock.querySelectorAll("input"))).forEach(function(t){e?t.removeAttribute("disabled"):t.setAttribute("disabled","")}),e?this.customiseTimesBlock.classList.remove("u-hidden"):this.customiseTimesBlock.classList.add("u-hidden")}},{key:"setDateTime",value:function setDateTime(){var e=n()(this.inputs.DateBegin.value+" "+this.inputs.TimeBegin.value,"DD-MM-YYYY HH:mm"),t=n()(this.inputs.DateEnd.value,"DD-MM-YYYY"),s=n()(this.inputs.TimeBegin.value,"HH:mm"),i=n()(this.inputs.TimeEnd.value,"HH:mm"),r=v(s,i);r>0?(Object(c.a)("time-errors"),this.inputs[m].value=r,this.inputs[f].value=e.format("YYYY-MM-DDTHH:mm:ss.SSS[Z]"),this.inputs[p].value=t.format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")):Object(c.b)(k,window.messages.validationTimeDifference,"time-errors")}},{key:"setIndefiniteTime",value:function setIndefiniteTime(){this.inputs[m].value=1440,this.inputs[f].value=n()().format(),this.inputs[p].value=n()().add(100,"years").format()}},{key:"setNoEndDate",value:function setNoEndDate(e){e?(this.inputs.DateEnd.setAttribute("disabled",""),this.inputs[p].value=n()().add(100,"years").format()):(this.inputs.DateEnd.removeAttribute("disabled"),this.setDateTime())}},{key:"checkAddressValidity",value:function checkAddressValidity(){Object(u.a)(this.state.fields,"AfwezigheidsRoosterWrapper[WekelijksTerugkerendRooster][Adres][AdresseerbareAdresID]")||(this.steps.disableStep=!0)}},{key:"checkWeekdayValidity",value:function checkWeekdayValidity(e){1!==e||Object(u.a)(this.state.fields,"AfwezigheidsRoosterWrapper[WekelijksTerugkerendRooster][WeekPatroon]")||(this.steps.disableStep=!0)}}]),AccountModalScheduleMessages}(),v=function convertTimeDiferenceToMinutes(e,t){return t.diff(e,"minutes")};t.default=b}});