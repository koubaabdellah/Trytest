$.fn.timeline=function(){function e(e){e.find(".timelineMajor.open").length>0?(e.$toggleAllBtns.text(e.attr("data-collapse")),e.$toggleAllBtns.addClass("panelsOpen")):(e.$toggleAllBtns.text(e.attr("data-expand")),e.$toggleAllBtns.removeClass("panelsOpen"))}function n(e,n){"open"===n?(e.$toggleBtn.attr("aria-expanded","true"),e.$panelContent.attr("aria-hidden","false")):(e.$toggleBtn.attr("aria-expanded","false"),e.$panelContent.attr("aria-hidden","true"))}function t(n,t,l,a){if("open"===l){if(t.$panelContent.hasClass("timelineEvent"))(s=t.$elm.find(".thumb")).length>0&&s.addClass("hideImg");t.$panelContent.slideDown(250,function(){t.$elm.addClass("open"),e(n),a&&t.$panelContent.focus()});var i=t.$panelContent.find("video");i.length>0&&i[0].player.setPlayerSize();var o=t.$panelContent.find("audio");o.length>0&&o[0].player.setPlayerSize()}else{var s;if(t.$panelContent.hasClass("timelineEvent"))(s=t.$elm.find(".thumb")).length>0&&s.removeClass("hideImg"),$("video,audio").trigger("pause");t.$panelContent.slideUp(250,function(){t.$elm.removeClass("open"),e(n)})}}return this.each(function(){var l=function(e){return e.panels=[],e.$toggleAllBtns=e.find(".timelineToggle"),e.find(".timelineMajor, .timelineMinor").each(function(){var n=$(this).find("a[aria-controls]").first(),t=$("#"+n.attr("aria-controls")),l={$elm:$(this),$toggleBtn:n,$panelContent:t};e.panels.push(l)}),e}($(this));!function(t){$.each(t.panels,function(){this.$elm.hasClass("open")?n(this,"open"):n(this,"closed")}),e(t)}(l),function(e){$.each(e.panels,function(){var l=this;l.$toggleBtn.on("click",function(a){a.preventDefault(),l.$elm.hasClass("open")?(n(l,"close"),t(e,l,"close",!0)):(n(l,"open"),t(e,l,"open",!0))})}),e.$toggleAllBtns.on("click",function(l){l.preventDefault(),$(this).hasClass("panelsOpen")?$.each(e.panels,function(){n(this,"close"),t(e,this,"close",!1)}):($.each(e.panels,function(){n(this,"open"),t(e,this,"open",!1)}),$('a[aria-controls^="timeline-major-event-"]').first().trigger("focus"))})}(l)})},$(".timeline").timeline();