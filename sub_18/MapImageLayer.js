// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.24/esri/copyright.txt for details.//>>built
require({cache:{"esri/geometry/support/scaleUtils":function(){define(["exports","../../core/unitUtils"],function(p,m){function c(d,g){g=m.getMetersPerUnitForSR(g);return d/(g*m.inchesPerMeter*96)}p.getExtentForScale=function(d,g){const f=d.extent;d=d.width;g=c(g,f.spatialReference);return f.clone().expand(g*d/f.width)};p.getResolutionForScale=c;p.getScale=function(d,g){g=g||d.extent;d=d.width;const f=m.getMetersPerUnitForSR(g&&g.spatialReference);return g&&d?g.width/d*f*m.inchesPerMeter*96:0};p.getScaleForResolution=
function(d,g){g=m.getMetersPerUnitForSR(g);return d*g*m.inchesPerMeter*96};Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/mixins/ArcGISMapService":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/promiseUtils ../../core/urlUtils ../../core/Version ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ../support/commonProperties".split(" "),
function(p,m,c,d,g,f,x,n,G,da,P,ja,oa,ia,F,Z){p.ArcGISMapService=K=>{K=function(R){function S(){var u=R.apply(this,arguments)||this;u.capabilities=void 0;u.copyright=null;u.fullExtent=null;u.legendEnabled=!0;u.spatialReference=null;u.version=void 0;return u}m._inheritsLoose(S,R);var k=S.prototype;k.readCapabilities=function(u,l){var v,y,H=l.capabilities&&l.capabilities.split(",").map(W=>W.toLowerCase().trim());if(!H)return{operations:{supportsExportMap:!1,supportsExportTiles:!1,supportsIdentify:!1,
supportsQuery:!1,supportsTileMap:!1},exportMap:null,exportTiles:null};var q=this.type;u=H.includes("data");const z=H.includes("query"),A=H.includes("map"),r=!!l.exportTilesAllowed;H=H.includes("tilemap");const Q="tile"!==q&&!!l.supportsDynamicLayers,T="tile"!==q&&(!l.tileInfo||Q),U="tile"!==q&&(!l.tileInfo||Q);q="tile"!==q;const X=l.cimVersion&&x.Version.parse(l.cimVersion),Y=null!=(v=null==X?void 0:X.since(1,4))?v:!1;v=null!=(y=null==X?void 0:X.since(2,0))?y:!1;return{operations:{supportsExportMap:A,
supportsExportTiles:r,supportsIdentify:z,supportsQuery:u,supportsTileMap:H},exportMap:A?{supportsArcadeExpressionForLabeling:Y,supportsSublayersChanges:q,supportsDynamicLayers:Q,supportsSublayerVisibility:T,supportsSublayerDefinitionExpression:U,supportsCIMSymbols:v}:null,exportTiles:r?{maxExportTilesCount:+l.maxExportTilesCount}:null}};k.readVersion=function(u,l){(u=l.currentVersion)||(u=l.hasOwnProperty("capabilities")||l.hasOwnProperty("tables")?10:l.hasOwnProperty("supportedImageFormatTypes")?
9.31:9.3);return u};k.fetchSublayerInfo=function(){var u=m._asyncToGenerator(function*(l,v){yield this.fetchAllLayersAndTables(v);return this._allLayersAndTablesMap.get(l)});return function(l,v){return u.apply(this,arguments)}}();k.fetchAllLayersAndTables=function(){var u=m._asyncToGenerator(function*(l){yield this.load(l);this._allLayersAndTablesPromise||(this._allLayersAndTablesPromise=d(f.urlToObject(this.url).path+"/layers",{responseType:"json",query:{f:"json",...this.customParameters,token:this.apiKey}}).then(y=>
{this._allLayersAndTablesMap=new Map;for(const H of y.data.layers)this._allLayersAndTablesMap.set(H.id,H);return{result:y.data}},y=>({error:y})));const v=yield this._allLayersAndTablesPromise;g.throwIfAborted(l);if("result"in v)return v.result;throw v.error;});return function(l){return u.apply(this,arguments)}}();return S}(K);c.__decorate([n.property({readOnly:!0})],K.prototype,"capabilities",void 0);c.__decorate([ja.reader("service","capabilities",["capabilities","exportTilesAllowed","maxExportTilesCount",
"supportsDynamicLayers","tileInfo"])],K.prototype,"readCapabilities",null);c.__decorate([n.property({json:{read:{source:"copyrightText"}}})],K.prototype,"copyright",void 0);c.__decorate([n.property({type:ia})],K.prototype,"fullExtent",void 0);c.__decorate([n.property(Z.id)],K.prototype,"id",void 0);c.__decorate([n.property({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],K.prototype,"legendEnabled",void 0);c.__decorate([n.property(Z.popupEnabled)],
K.prototype,"popupEnabled",void 0);c.__decorate([n.property({type:F})],K.prototype,"spatialReference",void 0);c.__decorate([n.property({readOnly:!0})],K.prototype,"version",void 0);c.__decorate([ja.reader("version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],K.prototype,"readVersion",null);return K=c.__decorate([oa.subclass("esri.layers.mixins.ArcGISMapService")],K)};Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/core/Version":function(){define(["exports",
"./Error"],function(p,m){let c=function(){function d(f,x,n=""){this.major=f;this.minor=x;this._context=n}var g=d.prototype;g.lessThan=function(f,x){return this.major<f||f===this.major&&this.minor<x};g.since=function(f,x){return!this.lessThan(f,x)};g.validate=function(f){if(this.major!==f.major)throw new m((this._context&&this._context+":")+"unsupported-version",`Required major ${this._context&&this._context+" "}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:f});
};g.clone=function(){return new d(this.major,this.minor,this._context)};d.parse=function(f,x=""){const [n,G]=f.split(".");var da=/^\s*\d+\s*$/;if(!n||!n.match||!n.match(da))throw new m((x&&x+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:f});if(!G||!G.match||!G.match(da))throw new m((x&&x+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:f});f=parseInt(n,10);da=parseInt(G,10);return new d(f,da,x)};return d}();
p.Version=c;Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/mixins/SublayersOwner":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/CollectionFlattener ../../core/Error ../../core/Logger ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/utils ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/PropertyOrigin ../support/Sublayer ../support/sublayerUtils".split(" "),
function(p,m,c,d,g,f,x,n,G,da,P,ja,oa,ia,F,Z,K){function R(l,v){const y=[],H={};if(!l)return y;l.forEach(q=>{const z=new Z;z.read(q,v);H[z.id]=z;null!=q.parentLayerId&&-1!==q.parentLayerId?(q=H[q.parentLayerId],q.sublayers||(q.sublayers=[]),q.sublayers.unshift(z)):y.unshift(z)});return y}function S(l,v){l&&l.forEach(y=>{v(y);y.sublayers&&y.sublayers.length&&S(y.sublayers,v)})}const k=x.getLogger("esri.layers.TileLayer"),u=d.ofType(Z);p.SublayersOwner=l=>{l=function(v){function y(...q){var z=v.call(this,
...q)||this;z.allSublayers=new g({getCollections:()=>[z.sublayers],getChildrenFunction(A){return A.sublayers}});z.sublayersSourceJSON={[F.OriginId.SERVICE]:{},[F.OriginId.PORTAL_ITEM]:{},[F.OriginId.WEB_SCENE]:{},[F.OriginId.WEB_MAP]:{}};z.own(n.watch(()=>z.sublayers,(A,r)=>z._handleSublayersChange(A,r),n.sync));return z}m._inheritsLoose(y,v);var H=y.prototype;H.readSublayers=function(q,z){if(z&&q){var {sublayersSourceJSON:A}=this,r=F.nameToId(z.origin);if(!(r<F.OriginId.SERVICE||(A[r]={context:z,
visibleLayers:q.visibleLayers||A[r].visibleLayers,layers:q.layers||A[r].layers},r>F.OriginId.SERVICE))){this._set("serviceSublayers",this.createSublayersForOrigin("service").sublayers);var {sublayers:Q,origin:T}=this.createSublayersForOrigin("web-document");q=ja.getProperties(this);q.setDefaultOrigin(T);this._set("sublayers",new u(Q));q.setDefaultOrigin("user")}}};H.findSublayerById=function(q){return this.allSublayers.find(z=>z.id===q)};H.createServiceSublayers=function(){return this.createSublayersForOrigin("service").sublayers};
H.createSublayersForOrigin=function(q){const z="web-document"===q?F.nameToId("web-map"):F.nameToId(q);let A=F.OriginId.SERVICE;q=this.sublayersSourceJSON[F.OriginId.SERVICE].layers;let r=this.sublayersSourceJSON[F.OriginId.SERVICE].context,Q=null;var T=[F.OriginId.PORTAL_ITEM,F.OriginId.WEB_SCENE,F.OriginId.WEB_MAP].filter(O=>O<=z);for(var U of T)T=this.sublayersSourceJSON[U],K.isSublayerOverhaul(T.layers)&&(A=U,q=T.layers,r=T.context,T.visibleLayers&&(Q={visibleLayers:T.visibleLayers,context:T.context}));
U=[F.OriginId.PORTAL_ITEM,F.OriginId.WEB_SCENE,F.OriginId.WEB_MAP].filter(O=>O>A&&O<=z);let X=null;for(var Y of U){const {layers:O,visibleLayers:la,context:ka}=this.sublayersSourceJSON[Y];O&&(X={layers:O,context:ka});la&&(Q={visibleLayers:la,context:ka})}Y=R(q,r);const W=new Map,I=new Set;if(X)for(const O of X.layers)W.set(O.id,O);if(Q)for(const O of Q.visibleLayers)I.add(O);S(Y,O=>{X&&O.read(W.get(O.id),X.context);Q&&O.read({defaultVisibility:I.has(O.id)},Q.context)});return{origin:F.idToName(A),
sublayers:new u({items:Y})}};H.read=function(q,z){v.prototype.read.call(this,q,z);this.readSublayers(q,z)};H._handleSublayersChange=function(q,z){z&&(z.forEach(A=>{A.parent=null;A.layer=null}),this.handles.remove("sublayers-owner"));q&&(q.forEach(A=>{A.parent=this;A.layer=this}),this.handles.add([q.on("after-add",({item:A})=>{A.parent=this;A.layer=this}),q.on("after-remove",({item:A})=>{A.parent=null;A.layer=null})],"sublayers-owner"),"tile"===this.type&&this.handles.add(q.on("before-changes",A=>
{k.error(new f("tilelayer:sublayers-non-modifiable","ISublayer can't be added, moved, or removed from the layer's sublayers",{layer:this}));A.preventDefault()}),"sublayers-owner"))};return y}(l);c.__decorate([G.property({readOnly:!0})],l.prototype,"allSublayers",void 0);c.__decorate([G.property({readOnly:!0,type:d.ofType(Z)})],l.prototype,"serviceSublayers",void 0);c.__decorate([G.property({value:null,type:u,json:{read:!1,write:{allowNull:!0,ignoreOrigin:!0}}})],l.prototype,"sublayers",void 0);c.__decorate([G.property({readOnly:!0})],
l.prototype,"sublayersSourceJSON",void 0);return l=c.__decorate([ia.subclass("esri.layers.mixins.SublayersOwner")],l)};p.forEachSublayer=S;Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/Sublayer":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../PopupTemplate ../../renderers/ClassBreaksRenderer ../../renderers/DictionaryRenderer ../../renderers/DotDensityRenderer ../../renderers/HeatmapRenderer ../../renderers/PieChartRenderer ../../renderers/Renderer ../../renderers/SimpleRenderer ../../renderers/UniqueValueRenderer ../../renderers/support/jsonUtils ../../renderers/support/types ../../request ../../symbols ../../core/Collection ../../core/Error ../../core/HandleOwner ../../core/Identifiable ../../core/lang ../../core/Loadable ../../core/Logger ../../core/maybe ../../core/MultiOriginJSONSupport ../../core/sql ../../core/urlUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/utils ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../core/accessorSupport/PropertyOrigin ./arcgisLayerUrl ./FeatureType ./Field ./FieldsIndex ./LabelClass ./LayerFloorInfo ./source/DataLayerSource ./source/MapLayerSource ../../rest/support/Query ../../support/popupUtils ../../geometry/Extent".split(" "),
function(p,m,c,d,g,f,x,n,G,da,P,ja,oa,ia,F,Z,K,R,S,k,u,l,v,y,H,q,z,A,r,Q,T,U,X,Y,W,I,O,la,ka,aa,h,B,L,J,N,ea,ba){function C(E){return E&&"esriSMS"===E.type}function fa(E,V,t){var a;E=this.originIdOf(V)>=I.nameToId(t.origin);return{ignoreOrigin:!0,allowNull:E,enabled:t?"map-image"===(null==(a=t.layer)?void 0:a.type)&&(t.writeSublayerStructure||E):!1}}function ma(E,V,t){var a;return{enabled:t?"tile"===(null==(a=t.layer)?void 0:a.type)&&this._isOverridden(V):!1}}function ca(E,V,t){return{ignoreOrigin:!0,
enabled:t&&t.writeSublayerStructure||!1}}function qa(E,V,t){return{ignoreOrigin:!0,enabled:t?t.writeSublayerStructure||this.originIdOf(V)>=I.nameToId(t.origin):!1}}const ua=E=>Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"}));var ra;const sa=y.getLogger("esri.layers.support.Sublayer");let xa=0;const na=new Set;na.add("layer");na.add("parent");na.add("loaded");na.add("loadStatus");na.add("loadError");na.add("loadWarnings");d=ra=function(E){function V(a){a=
E.call(this,a)||this;a.capabilities=void 0;a.fields=null;a.fullExtent=null;a.globalIdField=null;a.legendEnabled=!0;a.objectIdField=null;a.popupEnabled=!0;a.popupTemplate=null;a.sourceJSON=null;a.title=null;a.typeIdField=null;a.types=null;return a}m._inheritsLoose(V,E);var t=V.prototype;t.load=function(){var a=m._asyncToGenerator(function*(b){var e=this;this.addResolvingPromise(m._asyncToGenerator(function*(){var w;if(!e.layer&&!e.url)throw new S("sublayer:missing-layer","Sublayer can't be loaded without being part of a layer",
{sublayer:e});let D=null;if(!e.layer||e.originIdOf("url")>I.OriginId.SERVICE||"data-layer"===(null==(w=e.source)?void 0:w.type))D=(yield Z(e.url,{responseType:"json",query:{f:"json"},...b})).data;else{var M;w=e.id;"map-layer"===(null==(M=e.source)?void 0:M.type)&&(w=e.source.mapLayerId);D=yield e.layer.fetchSublayerInfo(w,b)}D&&(e.sourceJSON=D,e.read({layerDefinition:D},{origin:"service"}))})());return this});return function(b){return a.apply(this,arguments)}}();t.readCapabilities=function(a,b){b=
b.layerDefinition||b;a=(a=b.capabilities||a)?a.toLowerCase().split(",").map(w=>w.trim()):[];const e=this.url?O.parse(this.url):null;a=a.includes(H.isSome(e)&&"MapServer"===e.serverType?"data":"query");return{exportMap:{supportsModification:!!b.canModifyLayer},operations:{supportsQuery:a}}};t.readGlobalIdFieldFromService=function(a,b){b=b.layerDefinition||b;if(b.globalIdField)return b.globalIdField;if(b.fields)for(const e of b.fields)if("esriFieldTypeGlobalID"===e.type)return e.name};t.writeLabelingInfo=
function(a,b,e,w){a&&a.length&&(b.layerDefinition={drawingInfo:{labelingInfo:a.map(D=>D.write({},w))}})};t.readMinScale=function(a,b){return b.minScale||b.layerDefinition&&b.layerDefinition.minScale||0};t.readMaxScale=function(a,b){return b.maxScale||b.layerDefinition&&b.layerDefinition.maxScale||0};t.readObjectIdFieldFromService=function(a,b){b=b.layerDefinition||b;if(b.objectIdField)return b.objectIdField;if(b.fields)for(const e of b.fields)if("esriFieldTypeOID"===e.type)return e.name};t.readOpacity=
function(a,b){a=b.layerDefinition;return 1-.01*(null!=a.transparency?a.transparency:a.drawingInfo.transparency)};t.writeOpacity=function(a,b,e,w){b.layerDefinition={drawingInfo:{transparency:100-100*a}}};t.writeParent=function(a,b){b.parentLayerId=this.parent&&this.parent!==this.layer?W.ensureInteger(this.parent.id):-1};t.castSublayers=function(a){return W.ensureType(R.ofType(ra),a)};t.writeSublayers=function(a,b,e){this.get("sublayers.length")&&(b[e]=this.sublayers.map(w=>w.id).toArray().reverse())};
t.readTypeIdField=function(a,b){b=b.layerDefinition||b;let e=b.typeIdField;e&&b.fields&&(e=e.toLowerCase(),a=b.fields.find(w=>w.name.toLowerCase()===e))&&(e=a.name);return null};t.writeVisible=function(a,b,e,w){b[e]=this.getAtOrigin("defaultVisibility","service")||a};t.clone=function(){const {store:a}=Q.getProperties(this),b=new ra;Q.getProperties(b).store=a.clone(na);this.commitProperty("url");b._lastParsedUrl=this._lastParsedUrl;return b};t.createPopupTemplate=function(a){return ea.createPopupTemplate(this,
a)};t.createQuery=function(){return new N({returnGeometry:!0,where:this.definitionExpression||"1\x3d1"})};t.createFeatureLayer=function(){var a=m._asyncToGenerator(function*(){var b,e;if(this.hasOwnProperty("sublayers"))return null;const w=null==(b=this.layer)?void 0:b.parsedUrl;b=new (yield new Promise((D,M)=>p(["../FeatureLayer"],ha=>D(ua(ha)),M))).default({url:w.path});w&&this.source&&("map-layer"===this.source.type?b.layerId=this.source.mapLayerId:b.dynamicDataSource=this.source);null!=this.layer.refreshInterval&&
(b.refreshInterval=this.layer.refreshInterval);this.definitionExpression&&(b.definitionExpression=this.definitionExpression);this.floorInfo&&(b.floorInfo=l.clone(this.floorInfo));this.originIdOf("labelingInfo")>I.OriginId.SERVICE&&(b.labelingInfo=l.clone(this.labelingInfo));this.originIdOf("labelsVisible")>I.OriginId.DEFAULTS&&(b.labelsVisible=this.labelsVisible);this.originIdOf("legendEnabled")>I.OriginId.DEFAULTS&&(b.legendEnabled=this.legendEnabled);this.originIdOf("visible")>I.OriginId.DEFAULTS&&
(b.visible=this.visible);this.originIdOf("minScale")>I.OriginId.DEFAULTS&&(b.minScale=this.minScale);this.originIdOf("maxScale")>I.OriginId.DEFAULTS&&(b.maxScale=this.maxScale);this.originIdOf("opacity")>I.OriginId.DEFAULTS&&(b.opacity=this.opacity);this.originIdOf("popupTemplate")>I.OriginId.DEFAULTS&&(b.popupTemplate=l.clone(this.popupTemplate));this.originIdOf("renderer")>I.OriginId.SERVICE&&(b.renderer=l.clone(this.renderer));"data-layer"===(null==(e=this.source)?void 0:e.type)&&(b.dynamicDataSource=
this.source.clone());this.originIdOf("title")>I.OriginId.DEFAULTS&&(b.title=this.title);"map-image"===this.layer.type&&this.layer.originIdOf("customParameters")>I.OriginId.DEFAULTS&&(b.customParameters=this.layer.customParameters);"tile"===this.layer.type&&this.layer.originIdOf("customParameters")>I.OriginId.DEFAULTS&&(b.customParameters=this.layer.customParameters);return b});return function(){return a.apply(this,arguments)}}();t.getField=function(a){return this.fieldsIndex.get(a)};t.getFeatureType=
function(a){const {typeIdField:b,types:e}=this;if(!b||!a)return null;const w=a.attributes?a.attributes[b]:void 0;if(null==w)return null;let D=null;e.some(M=>{const {id:ha}=M;if(null==ha)return!1;ha.toString()===w.toString()&&(D=M);return!!D});return D};t.getFieldDomain=function(a,b){return(b=this.getFeatureType(b&&b.feature))&&(b=b.domains&&b.domains[a])&&"inherited"!==b.type?b:this._getLayerDomain(a)};t.queryFeatures=function(){var a=m._asyncToGenerator(function*(b=this.createQuery(),e){var w,D,
M,ha,va,wa;yield this.load();if(null==(w=this.capabilities)||null==(D=w.operations)||!D.supportsQuery)throw new S("Sublayer.queryFeatures","this layer doesn't support queries.");const [{executeQuery:ya},{default:za}]=yield Promise.all([new Promise((pa,ta)=>p(["../../rest/query/operations/query"],pa,ta)),new Promise((pa,ta)=>p(["../../rest/support/FeatureSet"],Aa=>pa(ua(Aa)),ta))]);b=yield ya(this.url,N.from(b),null!=(M=null==(ha=this.layer)?void 0:ha.spatialReference)?M:null,{...e,query:{...null==
(va=this.layer)?void 0:va.customParameters,token:null==(wa=this.layer)?void 0:wa.apiKey}});M=za.fromJSON(b.data);if(null!=M&&M.features)for(const pa of M.features)pa.sourceLayer=this;return M});return function(){return a.apply(this,arguments)}}();t.toExportImageJSON=function(a){var b;const e={id:this.id,source:(null==(b=this.source)?void 0:b.toJSON())||{mapLayerId:this.id,type:"mapLayer"}};a=z.sqlAnd(a,this.definitionExpression);H.isSome(a)&&(e.definitionExpression=a);const w=["renderer","labelingInfo",
"opacity","labelsVisible"].reduce((D,M)=>{D[M]=this.originIdOf(M);return D},{});Object.keys(w).some(D=>w[D]>I.OriginId.SERVICE)&&(a=e.drawingInfo={},w.renderer>I.OriginId.SERVICE&&(a.renderer=this.renderer?this.renderer.toJSON():null),w.labelsVisible>I.OriginId.SERVICE&&(a.showLabels=this.labelsVisible),this.labelsVisible&&w.labelingInfo>I.OriginId.SERVICE&&(a.labelingInfo=this.labelingInfo?this.labelingInfo.map(D=>D.write({},{origin:"service",layer:this.layer})):null,a.showLabels=!0),w.opacity>I.OriginId.SERVICE&&
(a.transparency=100-100*this.opacity),this._assignDefaultSymbolColors(a.renderer));return e};t._assignDefaultSymbolColors=function(a){this._forEachSimpleMarkerSymbols(a,b=>{b.color||"esriSMSX"!==b.style&&"esriSMSCross"!==b.style||(b.color=b.outline&&b.outline.color?b.outline.color:[0,0,0,0])})};t._forEachSimpleMarkerSymbols=function(a,b){if(a){const e="uniqueValueInfos"in a?a.uniqueValueInfos:"classBreakInfos"in a?a.classBreakInfos:[];for(const w of e)C(w.symbol)&&b(w.symbol);"symbol"in a&&C(a.symbol)&&
b(a.symbol);"defaultSymbol"in a&&C(a.defaultSymbol)&&b(a.defaultSymbol)}};t._setAndNotifyLayer=function(a,b){const e=this.layer,w=this._get(a);let D,M;switch(a){case "definitionExpression":case "floorInfo":D="supportsSublayerDefinitionExpression";case "minScale":case "maxScale":case "visible":D="supportsSublayerVisibility";break;case "labelingInfo":case "labelsVisible":case "opacity":case "renderer":case "source":D="supportsDynamicLayers",M="supportsModification"}const ha=Q.getProperties(this).getDefaultOrigin();
if("service"!==ha){if(D&&!1===this.get(`layer.capabilities.exportMap.${D}`)){this._logLockedError(a,`capability not available 'layer.capabilities.exportMap.${D}'`);return}if(M&&!1===this.get(`capabilities.exportMap.${M}`)){this._logLockedError(a,`capability not available 'capabilities.exportMap.${M}'`);return}}"source"===a&&"not-loaded"!==this.loadStatus?this._logLockedError(a,"'source' can't be changed after calling sublayer.load()"):(this._set(a,b),"service"!==ha&&w!==b&&e&&e.emit&&e.emit("sublayer-update",
{propertyName:a,target:this}))};t._handleSublayersChange=function(a,b){b&&(b.forEach(e=>{e.parent=null;e.layer=null}),this.handles.removeAll());a&&(a.forEach(e=>{e.parent=this;e.layer=this.layer}),this.handles.add([a.on("after-add",({item:e})=>{e.parent=this;e.layer=this.layer}),a.on("after-remove",({item:e})=>{e.parent=null;e.layer=null}),a.on("before-changes",e=>{const w=this.get("layer.capabilities.exportMap.supportsSublayersChanges");null==w||w||(sa.error(new S("sublayer:sublayers-non-modifiable",
"Sublayer can't be added, moved, or removed from the layer's sublayers",{sublayer:this,layer:this.layer})),e.preventDefault())})]))};t._logLockedError=function(a,b){sa.error(new S("sublayer:locked",`Property '${String(a)}' can't be changed on Sublayer from the layer '${this.layer.id}'`,{reason:b,sublayer:this,layer:this.layer}))};t._getLayerDomain=function(a){return(a=this.fieldsIndex.get(a))?a.domain:null};m._createClass(V,[{key:"definitionExpression",set:function(a){this._setAndNotifyLayer("definitionExpression",
a)}},{key:"fieldsIndex",get:function(){return new aa(this.fields||[])}},{key:"floorInfo",set:function(a){this._setAndNotifyLayer("floorInfo",a)}},{key:"id",get:function(){const a=this._get("id");return null==a?xa++:a},set:function(a){this._get("id")!==a&&(!1===this.get("layer.capabilities.exportMap.supportsDynamicLayers")?this._logLockedError("id","capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'"):this._set("id",a))}},{key:"labelingInfo",set:function(a){this._setAndNotifyLayer("labelingInfo",
a)}},{key:"labelsVisible",set:function(a){this._setAndNotifyLayer("labelsVisible",a)}},{key:"layer",set:function(a){this._set("layer",a);this.sublayers&&this.sublayers.forEach(b=>b.layer=a)}},{key:"listMode",set:function(a){this._set("listMode",a)}},{key:"minScale",set:function(a){this._setAndNotifyLayer("minScale",a)}},{key:"maxScale",set:function(a){this._setAndNotifyLayer("maxScale",a)}},{key:"effectiveScaleRange",get:function(){const {minScale:a,maxScale:b}=this;return{minScale:a,maxScale:b}}},
{key:"opacity",set:function(a){this._setAndNotifyLayer("opacity",a)}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"renderer",set:function(a){if(a)for(const b of a.getSymbols())if(K.isSymbol3D(b)){sa.warn("Sublayer renderer should use 2D symbols");break}this._setAndNotifyLayer("renderer",a)}},{key:"source",get:function(){return this._get("source")||new J.MapLayerSource({mapLayerId:this.id})},set:function(a){this._setAndNotifyLayer("source",a)}},{key:"sublayers",
set:function(a){this._handleSublayersChange(a,this._get("sublayers"));this._set("sublayers",a)}},{key:"url",get:function(){var a,b;const e=null!=(a=null==(b=this.layer)?void 0:b.parsedUrl)?a:this._lastParsedUrl;a=this.source;if(!e)return null;this._lastParsedUrl=e;if("map-layer"===(null==a?void 0:a.type))return`${e.path}/${a.mapLayerId}`;a={layer:JSON.stringify({source:this.source})};return`${e.path}/dynamicLayer?${A.objectToQuery(a)}`},set:function(a){a?this._override("url",a):this._clearOverride("url")}},
{key:"visible",set:function(a){this._setAndNotifyLayer("visible",a)}}]);return V}(k.HandleOwnerMixin(q.MultiOriginJSONMixin(u.IdentifiableMixin(v))));d.test={isMapImageLayerOverridePolicy:E=>E===ca||E===fa,isTileImageLayerOverridePolicy:E=>E===ma};c.__decorate([r.property({readOnly:!0})],d.prototype,"capabilities",void 0);c.__decorate([U.reader("service","capabilities",["layerDefinition.canModifyLayer","layerDefinition.capabilities"])],d.prototype,"readCapabilities",null);c.__decorate([r.property({type:String,
value:null,json:{name:"layerDefinition.definitionExpression",write:{allowNull:!0,overridePolicy:fa}}})],d.prototype,"definitionExpression",null);c.__decorate([r.property({type:[ka],json:{origins:{service:{read:{source:"layerDefinition.fields"}}}}})],d.prototype,"fields",void 0);c.__decorate([r.property({readOnly:!0})],d.prototype,"fieldsIndex",null);c.__decorate([r.property({type:B,value:null,json:{name:"layerDefinition.floorInfo",read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo",
overridePolicy:fa},origins:{"web-scene":{read:!1,write:!1}}}})],d.prototype,"floorInfo",null);c.__decorate([r.property({type:ba,json:{read:{source:"layerDefinition.extent"}}})],d.prototype,"fullExtent",void 0);c.__decorate([r.property({type:String})],d.prototype,"globalIdField",void 0);c.__decorate([U.reader("service","globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],d.prototype,"readGlobalIdFieldFromService",null);c.__decorate([r.property({type:W.Integer,json:{write:{ignoreOrigin:!0}}})],
d.prototype,"id",null);c.__decorate([r.property({value:null,type:[h],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo"},write:{target:"layerDefinition.drawingInfo.labelingInfo",overridePolicy:ca}}})],d.prototype,"labelingInfo",null);c.__decorate([Y.writer("labelingInfo")],d.prototype,"writeLabelingInfo",null);c.__decorate([r.property({type:Boolean,value:!0,json:{read:{source:"layerDefinition.drawingInfo.showLabels"},write:{target:"layerDefinition.drawingInfo.showLabels",overridePolicy:ca}}})],
d.prototype,"labelsVisible",null);c.__decorate([r.property({value:null})],d.prototype,"layer",null);c.__decorate([r.property({type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend",overridePolicy:qa}}})],d.prototype,"legendEnabled",void 0);c.__decorate([r.property({type:["show","hide","hide-children"],value:"show",json:{read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],d.prototype,"listMode",null);c.__decorate([r.property({type:Number,
value:0,json:{write:{overridePolicy:ca}}})],d.prototype,"minScale",null);c.__decorate([U.reader("minScale",["minScale","layerDefinition.minScale"])],d.prototype,"readMinScale",null);c.__decorate([r.property({type:Number,value:0,json:{write:{overridePolicy:ca}}})],d.prototype,"maxScale",null);c.__decorate([U.reader("maxScale",["maxScale","layerDefinition.maxScale"])],d.prototype,"readMaxScale",null);c.__decorate([r.property({readOnly:!0})],d.prototype,"effectiveScaleRange",null);c.__decorate([r.property({type:String})],
d.prototype,"objectIdField",void 0);c.__decorate([U.reader("service","objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],d.prototype,"readObjectIdFieldFromService",null);c.__decorate([r.property({type:Number,value:1,json:{write:{target:"layerDefinition.drawingInfo.transparency",overridePolicy:ca}}})],d.prototype,"opacity",null);c.__decorate([U.reader("opacity",["layerDefinition.drawingInfo.transparency","layerDefinition.transparency"])],d.prototype,"readOpacity",null);c.__decorate([Y.writer("opacity")],
d.prototype,"writeOpacity",null);c.__decorate([r.property({json:{type:W.Integer,write:{target:"parentLayerId",writerEnsuresNonNull:!0,overridePolicy:ca}}})],d.prototype,"parent",void 0);c.__decorate([Y.writer("parent")],d.prototype,"writeParent",null);c.__decorate([r.property({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader(E,V){return!V.disablePopup}},write:{target:"disablePopup",overridePolicy:qa,writer(E,V,t){V[t]=!E}}}})],d.prototype,"popupEnabled",void 0);c.__decorate([r.property({type:g,
json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:qa}}})],d.prototype,"popupTemplate",void 0);c.__decorate([r.property({readOnly:!0})],d.prototype,"defaultPopupTemplate",null);c.__decorate([r.property({types:F.rendererTypes,value:null,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:ca},origins:{"web-scene":{types:F.webSceneRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:ca}}}}})],d.prototype,"renderer",null);c.__decorate([r.property({types:{key:"type",
base:null,typeMap:{"data-layer":L.DataLayerSource,"map-layer":J.MapLayerSource}},cast(E){if(E){if("mapLayerId"in E)return W.ensureClass(J.MapLayerSource,E);if("dataSource"in E)return W.ensureClass(L.DataLayerSource,E)}return E},json:{name:"layerDefinition.source",write:{overridePolicy:ca}}})],d.prototype,"source",null);c.__decorate([r.property()],d.prototype,"sourceJSON",void 0);c.__decorate([r.property({value:null,json:{type:[W.Integer],write:{target:"subLayerIds",allowNull:!0,overridePolicy:ca}}})],
d.prototype,"sublayers",null);c.__decorate([T.cast("sublayers")],d.prototype,"castSublayers",null);c.__decorate([Y.writer("sublayers")],d.prototype,"writeSublayers",null);c.__decorate([r.property({type:String,json:{name:"name",write:{overridePolicy:qa}}})],d.prototype,"title",void 0);c.__decorate([r.property({type:String})],d.prototype,"typeIdField",void 0);c.__decorate([U.reader("typeIdField",["layerDefinition.typeIdField"])],d.prototype,"readTypeIdField",null);c.__decorate([r.property({type:[la],
json:{origins:{service:{read:{source:"layerDefinition.types"}}}}})],d.prototype,"types",void 0);c.__decorate([r.property({type:String,json:{read:{source:"layerUrl"},write:{target:"layerUrl",overridePolicy:ma}}})],d.prototype,"url",null);c.__decorate([r.property({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"},write:{target:"defaultVisibility",overridePolicy:ca}}})],d.prototype,"visible",null);c.__decorate([Y.writer("visible")],d.prototype,"writeVisible",null);return d=ra=c.__decorate([X.subclass("esri.layers.support.Sublayer")],
d)})},"esri/layers/support/sublayerUtils":function(){define(["exports","../../core/maybe","../../core/accessorSupport/PropertyOrigin"],function(p,m,c){function d(g,f){if(!g||!g.length||m.isNone(f))return!0;f=f.slice().reverse().flatten(({sublayers:G})=>G&&G.toArray().reverse()).map(G=>G.id).toArray();if(g.length>f.length)return!1;let x=0;const n=f.length;for(const {id:G}of g){for(;x<n&&f[x]!==G;)x++;if(x>=n)return!1}return!0}p.isExportDynamic=function(g,f,x){return g.some(n=>{const G=n.source;return!(!G||
"map-layer"===G.type&&G.mapLayerId===n.id&&(m.isNone(G.gdbVersion)||G.gdbVersion===x))||n.originIdOf("renderer")>c.OriginId.SERVICE||n.originIdOf("labelingInfo")>c.OriginId.SERVICE||n.originIdOf("opacity")>c.OriginId.SERVICE||n.originIdOf("labelsVisible")>c.OriginId.SERVICE})?!0:!d(g,f)};p.isSublayerOverhaul=function(g){return!!g&&g.some(f=>null!=f.minScale||f.layerDefinition&&null!=f.layerDefinition.minScale)};p.shouldWriteSublayerStructure=function(g,f,x){return f.flatten(({sublayers:n})=>n).length!==
g.length||g.some(n=>n.originIdOf("minScale")>x||n.originIdOf("maxScale")>x||n.originIdOf("renderer")>x||n.originIdOf("labelingInfo")>x||n.originIdOf("opacity")>x||n.originIdOf("labelsVisible")>x||n.originIdOf("source")>x)?!0:!d(g,f)};Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/sql ../../core/accessorSupport/decorators/property ../../core/arrayUtils ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./commonProperties ./floorFilterUtils ./sublayerUtils".split(" "),
function(p,m,c,d,g,f,x,n,G,da,P,ja,oa,ia,F){const Z={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};p.ExportImageParameters=function(K){function R(k){k=K.call(this,k)||this;k.floors=null;k.scale=0;return k}m._inheritsLoose(R,K);var S=R.prototype;S.destroy=function(){this.layer=null};S.toJSON=
function(){var k=this.layer;k={dpi:k.dpi,format:k.imageFormat,transparent:k.imageTransparency,gdbVersion:k.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?k.dynamicLayers=this.dynamicLayers:k={...k,layers:this.layers,layerDefs:this.layerDefs};return k};m._createClass(R,[{key:"dynamicLayers",get:function(){if(!this.hasDynamicLayers)return null;const k=this.visibleSublayers.map(u=>{const l=ia.getLayerFloorFilterClause(this.floors,u);return u.toExportImageJSON(l)});return k.length?JSON.stringify(k):
null}},{key:"hasDynamicLayers",get:function(){return this.layer&&F.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}},{key:"layer",set:function(k){this._get("layer")!==k&&(this._set("layer",k),this.handles.remove("layer"),k&&this.handles.add([k.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),k.on("sublayer-update",u=>this.notifyChange(Z[u.propertyName]))],"layer"))}},{key:"layers",get:function(){const k=this.visibleSublayers;return k?k.length?
"show:"+k.map(u=>u.id).join(","):"show:-1":null}},{key:"layerDefs",get:function(){var k;const u=!(null==(k=this.floors)||!k.length);k=this.visibleSublayers.filter(l=>null!=l.definitionExpression||u&&null!=l.floorInfo);return k.length?JSON.stringify(k.reduce((l,v)=>{var y=ia.getLayerFloorFilterClause(this.floors,v);y=x.sqlAnd(y,v.definitionExpression);f.isSome(y)&&(l[v.id]=y);return l},{})):null}},{key:"version",get:function(){this.commitProperty("layers");this.commitProperty("layerDefs");this.commitProperty("dynamicLayers");
this.commitProperty("timeExtent");const k=this.layer;k&&(k.commitProperty("dpi"),k.commitProperty("imageFormat"),k.commitProperty("imageTransparency"),k.commitProperty("gdbVersion"));return(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){const k=[];if(!this.layer)return k;var u=this.layer.sublayers;const l=v=>{const y=this.scale,H=0===v.minScale||y<=v.minScale,q=0===v.maxScale||y>=v.maxScale;v.visible&&(0===y||H&&q)&&(v.sublayers?v.sublayers.forEach(l):k.unshift(v))};u&&u.forEach(l);
u=this._get("visibleSublayers");return!u||u.length!==k.length||u.some((v,y)=>k[y]!==v)?k:u}}]);return R}(g.HandleOwnerMixin(d));c.__decorate([n.property({readOnly:!0})],p.ExportImageParameters.prototype,"dynamicLayers",null);c.__decorate([n.property()],p.ExportImageParameters.prototype,"floors",void 0);c.__decorate([n.property({readOnly:!0})],p.ExportImageParameters.prototype,"hasDynamicLayers",null);c.__decorate([n.property()],p.ExportImageParameters.prototype,"layer",null);c.__decorate([n.property({readOnly:!0})],
p.ExportImageParameters.prototype,"layers",null);c.__decorate([n.property({readOnly:!0})],p.ExportImageParameters.prototype,"layerDefs",null);c.__decorate([n.property({type:Number})],p.ExportImageParameters.prototype,"scale",void 0);c.__decorate([n.property(oa.combinedViewLayerTimeExtentProperty)],p.ExportImageParameters.prototype,"timeExtent",void 0);c.__decorate([n.property({readOnly:!0})],p.ExportImageParameters.prototype,"version",null);c.__decorate([n.property({readOnly:!0})],p.ExportImageParameters.prototype,
"visibleSublayers",null);p.ExportImageParameters=c.__decorate([ja.subclass("esri.layers.mixins.ExportImageParameters")],p.ExportImageParameters);Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(p){function m(c,d){if(null==c||!c.length)return null;c=c.filter(g=>""!==g).map(g=>`'${g}'`);c.push("''");return`${d} IN (${c.join(",")}) OR ${d} IS NULL`}p.getFloorFilterClause=function(c){var d;
const g=c.layer;return"floorInfo"in g&&null!=(d=g.floorInfo)&&d.floorField&&"floors"in c.view?m(c.view.floors,g.floorInfo.floorField):null};p.getLayerFloorFilterClause=function(c,d){var g;return"floorInfo"in d&&null!=(g=d.floorInfo)&&g.floorField?m(c,d.floorInfo.floorField):null};Object.defineProperties(p,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})}}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../request ../TimeExtent ../core/Error ../core/HandleOwner ../core/loadAll ../core/maybe ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/arrayUtils ../core/has ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ../core/accessorSupport/PropertyOrigin ../geometry/Extent ../geometry/support/scaleUtils ./Layer ./mixins/APIKeyMixin ./mixins/ArcGISMapService ./mixins/ArcGISService ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/SublayersOwner ./mixins/TemporalLayer ./support/commonProperties ./support/ExportImageParameters ./support/Sublayer ./support/sublayerUtils ./support/versionUtils".split(" "),function(p,
m,c,d,g,f,x,n,G,da,P,ja,oa,ia,F,Z,K,R,S,k,u,l,v,y,H,q,z,A,r,Q,T,U,X,Y,W,I,O){f=function(la){function ka(...h){h=la.call(this,...h)||this;h.datesInUnknownTimezone=!1;h.dpi=96;h.gdbVersion=null;h.imageFormat="png24";h.imageMaxHeight=2048;h.imageMaxWidth=2048;h.imageTransparency=!0;h.isReference=null;h.labelsVisible=!1;h.operationalLayerType="ArcGISMapServiceLayer";h.sourceJSON=null;h.sublayers=null;h.type="map-image";h.url=null;return h}p._inheritsLoose(ka,la);var aa=ka.prototype;aa.normalizeCtorArgs=
function(h,B){return"string"===typeof h?{url:h,...B}:h};aa.load=function(h){const B=n.isSome(h)?h.signal:null;this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},h).catch(da.throwIfAbortError).then(()=>this._fetchService(B)));return Promise.resolve(this)};aa.readImageFormat=function(h,B){return(h=B.supportedImageFormatTypes)&&h.includes("PNG32")?"png32":"png24"};aa.writeSublayers=function(h,B,L,J){if(this.loaded&&h){h=h.slice().reverse().flatten(({sublayers:C})=>C&&C.toArray().reverse()).toArray();
L=!1;if(this.capabilities&&this.capabilities.operations.supportsExportMap&&this.capabilities.exportMap.supportsDynamicLayers){const C=R.nameToId(J.origin);C===R.OriginId.PORTAL_ITEM?(L=this.createSublayersForOrigin("service").sublayers,L=I.shouldWriteSublayerStructure(h,L,R.OriginId.SERVICE)):C>R.OriginId.PORTAL_ITEM&&(L=this.createSublayersForOrigin("portal-item"),L=I.shouldWriteSublayerStructure(h,L.sublayers,R.nameToId(L.origin)))}var N=[],ea={writeSublayerStructure:L,...J},ba=L;h.forEach(C=>{const fa=
C.write({},ea);N.push(fa);ba=ba||"user"===C.originOf("visible")});N.some(C=>1<Object.keys(C).length)&&(B.layers=N);ba&&(B.visibleLayers=h.filter(C=>C.visible).map(C=>C.id))}};aa.createExportImageParameters=function(h,B,L,J){var N=J&&J.pixelRatio||1;h&&10<=this.version&&(h=h.clone().shiftCentralMeridian());var ea=new Y.ExportImageParameters({layer:this,floors:null==J?void 0:J.floors,scale:k.getScale({extent:h,width:B})*N});const ba=ea.toJSON();ea.destroy();ea=!J||!J.rotation||10.3>this.version?{}:
{rotation:-J.rotation};var C=h&&h.spatialReference;C=C.wkid||JSON.stringify(C.toJSON());ba.dpi*=N;N={};if(null!=J&&J.timeExtent){const {start:fa,end:ma}=J.timeExtent.toJSON();N.time=fa&&ma&&fa===ma?""+fa:`${null==fa?"null":fa},${null==ma?"null":ma}`}else this.timeInfo&&!this.timeInfo.hasLiveData&&(N.time="null,null");return{bbox:h&&h.xmin+","+h.ymin+","+h.xmax+","+h.ymax,bboxSR:C,imageSR:C,size:B+","+L,...ba,...ea,...N}};aa.fetchImage=function(){var h=p._asyncToGenerator(function*(B,L,J,N){var ea;
B={responseType:"image",signal:null!=(ea=null==N?void 0:N.signal)?ea:null,query:{...this.parsedUrl.query,...this.createExportImageParameters(B,L,J,N),f:"image",...this.refreshParameters,...this.customParameters,token:this.apiKey}};const ba=this.parsedUrl.path+"/export";if(null!=B.query.dynamicLayers&&!this.capabilities.exportMap.supportsDynamicLayers)throw new g("mapimagelayer:dynamiclayer-not-supported",`service ${this.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`,
{query:B.query});return c(ba,B).then(C=>C.data).catch(C=>{if(da.isAbortError(C))throw C;throw new g("mapimagelayer:image-fetch-error",`Unable to load image: ${ba}`,{error:C});})});return function(B,L,J,N){return h.apply(this,arguments)}}();aa.fetchRecomputedExtents=function(){var h=p._asyncToGenerator(function*(B={}){({data:B}=yield c(this.url,{...B,query:{returnUpdates:!0,f:"json",...this.customParameters,token:this.apiKey}}));const {extent:L,fullExtent:J,timeExtent:N}=B;B=L||J;return{fullExtent:B&&
S.fromJSON(B),timeExtent:N&&d.fromJSON({start:N[0],end:N[1]})}});return function(){return h.apply(this,arguments)}}();aa.loadAll=function(){return x.loadAll(this,h=>{h(this.allSublayers)})};aa.serviceSupportsSpatialReference=function(h){return O.serviceSupportsSpatialReference(this,h)};aa._fetchService=function(){var h=p._asyncToGenerator(function*(B){if(this.sourceJSON)this.read(this.sourceJSON,{origin:"service",url:this.parsedUrl});else{var {data:L,ssl:J}=yield c(this.parsedUrl.path,{query:{f:"json",
...this.parsedUrl.query,...this.customParameters,token:this.apiKey},signal:B});J&&(this.url=this.url.replace(/^http:/i,"https:"));this.sourceJSON=L;this.read(L,{origin:"service",url:this.parsedUrl})}});return function(B){return h.apply(this,arguments)}}();return ka}(H.BlendLayer(U.TemporalLayer(Q.ScaleRangeLayer(T.SublayersOwner(v.ArcGISMapService(y.ArcGISService(z.OperationalLayer(A.PortalLayer(G.MultiOriginJSONMixin(r.RefreshableLayer(l.APIKeyMixin(q.CustomParametersMixin(f.HandleOwnerMixin(u))))))))))))));
m.__decorate([P.property({type:Boolean})],f.prototype,"datesInUnknownTimezone",void 0);m.__decorate([P.property()],f.prototype,"dpi",void 0);m.__decorate([P.property()],f.prototype,"gdbVersion",void 0);m.__decorate([P.property()],f.prototype,"imageFormat",void 0);m.__decorate([F.reader("imageFormat",["supportedImageFormatTypes"])],f.prototype,"readImageFormat",null);m.__decorate([P.property({json:{origins:{service:{read:{source:"maxImageHeight"}}}}})],f.prototype,"imageMaxHeight",void 0);m.__decorate([P.property({json:{origins:{service:{read:{source:"maxImageWidth"}}}}})],
f.prototype,"imageMaxWidth",void 0);m.__decorate([P.property()],f.prototype,"imageTransparency",void 0);m.__decorate([P.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],f.prototype,"isReference",void 0);m.__decorate([P.property({json:{read:!1,write:!1}})],f.prototype,"labelsVisible",void 0);m.__decorate([P.property({type:["ArcGISMapServiceLayer"]})],f.prototype,"operationalLayerType",void 0);m.__decorate([P.property({json:{read:!1,write:!1}})],f.prototype,
"popupEnabled",void 0);m.__decorate([P.property()],f.prototype,"sourceJSON",void 0);m.__decorate([P.property({json:{write:{ignoreOrigin:!0}}})],f.prototype,"sublayers",void 0);m.__decorate([K.writer("sublayers",{layers:{type:[W]},visibleLayers:{type:[ia.Integer]}})],f.prototype,"writeSublayers",null);m.__decorate([P.property({type:["show","hide","hide-children"]})],f.prototype,"listMode",void 0);m.__decorate([P.property({json:{read:!1},readOnly:!0,value:"map-image"})],f.prototype,"type",void 0);m.__decorate([P.property(X.url)],
f.prototype,"url",void 0);return f=m.__decorate([Z.subclass("esri.layers.MapImageLayer")],f)});